var wD=Object.defineProperty;var bD=(n,e,t)=>e in n?wD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var hr=(n,e,t)=>bD(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var hy={exports:{}},Fp={},fy={exports:{}},Pn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N5;function xD(){if(N5)return Pn;N5=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;function m(J){return J===null||typeof J!="object"?null:(J=d&&J[d]||J["@@iterator"],typeof J=="function"?J:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function x(J,W,Q){this.props=J,this.context=W,this.refs=b,this.updater=Q||p}x.prototype.isReactComponent={},x.prototype.setState=function(J,W){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,W,"setState")},x.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function E(){}E.prototype=x.prototype;function T(J,W,Q){this.props=J,this.context=W,this.refs=b,this.updater=Q||p}var P=T.prototype=new E;P.constructor=T,y(P,x.prototype),P.isPureReactComponent=!0;var I=Array.isArray,D=Object.prototype.hasOwnProperty,U={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function C(J,W,Q){var ne,fe={},ve=null,we=null;if(W!=null)for(ne in W.ref!==void 0&&(we=W.ref),W.key!==void 0&&(ve=""+W.key),W)D.call(W,ne)&&!L.hasOwnProperty(ne)&&(fe[ne]=W[ne]);var Se=arguments.length-2;if(Se===1)fe.children=Q;else if(1<Se){for(var Ce=Array(Se),Fe=0;Fe<Se;Fe++)Ce[Fe]=arguments[Fe+2];fe.children=Ce}if(J&&J.defaultProps)for(ne in Se=J.defaultProps,Se)fe[ne]===void 0&&(fe[ne]=Se[ne]);return{$$typeof:n,type:J,key:ve,ref:we,props:fe,_owner:U.current}}function A(J,W){return{$$typeof:n,type:J.type,key:W,ref:J.ref,props:J.props,_owner:J._owner}}function M(J){return typeof J=="object"&&J!==null&&J.$$typeof===n}function k(J){var W={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(Q){return W[Q]})}var O=/\/+/g;function j(J,W){return typeof J=="object"&&J!==null&&J.key!=null?k(""+J.key):W.toString(36)}function X(J,W,Q,ne,fe){var ve=typeof J;(ve==="undefined"||ve==="boolean")&&(J=null);var we=!1;if(J===null)we=!0;else switch(ve){case"string":case"number":we=!0;break;case"object":switch(J.$$typeof){case n:case e:we=!0}}if(we)return we=J,fe=fe(we),J=ne===""?"."+j(we,0):ne,I(fe)?(Q="",J!=null&&(Q=J.replace(O,"$&/")+"/"),X(fe,W,Q,"",function(Fe){return Fe})):fe!=null&&(M(fe)&&(fe=A(fe,Q+(!fe.key||we&&we.key===fe.key?"":(""+fe.key).replace(O,"$&/")+"/")+J)),W.push(fe)),1;if(we=0,ne=ne===""?".":ne+":",I(J))for(var Se=0;Se<J.length;Se++){ve=J[Se];var Ce=ne+j(ve,Se);we+=X(ve,W,Q,Ce,fe)}else if(Ce=m(J),typeof Ce=="function")for(J=Ce.call(J),Se=0;!(ve=J.next()).done;)ve=ve.value,Ce=ne+j(ve,Se++),we+=X(ve,W,Q,Ce,fe);else if(ve==="object")throw W=String(J),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.");return we}function ue(J,W,Q){if(J==null)return J;var ne=[],fe=0;return X(J,ne,"","",function(ve){return W.call(Q,ve,fe++)}),ne}function ge(J){if(J._status===-1){var W=J._result;W=W(),W.then(function(Q){(J._status===0||J._status===-1)&&(J._status=1,J._result=Q)},function(Q){(J._status===0||J._status===-1)&&(J._status=2,J._result=Q)}),J._status===-1&&(J._status=0,J._result=W)}if(J._status===1)return J._result.default;throw J._result}var he={current:null},$={transition:null},le={ReactCurrentDispatcher:he,ReactCurrentBatchConfig:$,ReactCurrentOwner:U};function ae(){throw Error("act(...) is not supported in production builds of React.")}return Pn.Children={map:ue,forEach:function(J,W,Q){ue(J,function(){W.apply(this,arguments)},Q)},count:function(J){var W=0;return ue(J,function(){W++}),W},toArray:function(J){return ue(J,function(W){return W})||[]},only:function(J){if(!M(J))throw Error("React.Children.only expected to receive a single React element child.");return J}},Pn.Component=x,Pn.Fragment=t,Pn.Profiler=i,Pn.PureComponent=T,Pn.StrictMode=r,Pn.Suspense=u,Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=le,Pn.act=ae,Pn.cloneElement=function(J,W,Q){if(J==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+J+".");var ne=y({},J.props),fe=J.key,ve=J.ref,we=J._owner;if(W!=null){if(W.ref!==void 0&&(ve=W.ref,we=U.current),W.key!==void 0&&(fe=""+W.key),J.type&&J.type.defaultProps)var Se=J.type.defaultProps;for(Ce in W)D.call(W,Ce)&&!L.hasOwnProperty(Ce)&&(ne[Ce]=W[Ce]===void 0&&Se!==void 0?Se[Ce]:W[Ce])}var Ce=arguments.length-2;if(Ce===1)ne.children=Q;else if(1<Ce){Se=Array(Ce);for(var Fe=0;Fe<Ce;Fe++)Se[Fe]=arguments[Fe+2];ne.children=Se}return{$$typeof:n,type:J.type,key:fe,ref:ve,props:ne,_owner:we}},Pn.createContext=function(J){return J={$$typeof:s,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},J.Provider={$$typeof:o,_context:J},J.Consumer=J},Pn.createElement=C,Pn.createFactory=function(J){var W=C.bind(null,J);return W.type=J,W},Pn.createRef=function(){return{current:null}},Pn.forwardRef=function(J){return{$$typeof:a,render:J}},Pn.isValidElement=M,Pn.lazy=function(J){return{$$typeof:h,_payload:{_status:-1,_result:J},_init:ge}},Pn.memo=function(J,W){return{$$typeof:l,type:J,compare:W===void 0?null:W}},Pn.startTransition=function(J){var W=$.transition;$.transition={};try{J()}finally{$.transition=W}},Pn.unstable_act=ae,Pn.useCallback=function(J,W){return he.current.useCallback(J,W)},Pn.useContext=function(J){return he.current.useContext(J)},Pn.useDebugValue=function(){},Pn.useDeferredValue=function(J){return he.current.useDeferredValue(J)},Pn.useEffect=function(J,W){return he.current.useEffect(J,W)},Pn.useId=function(){return he.current.useId()},Pn.useImperativeHandle=function(J,W,Q){return he.current.useImperativeHandle(J,W,Q)},Pn.useInsertionEffect=function(J,W){return he.current.useInsertionEffect(J,W)},Pn.useLayoutEffect=function(J,W){return he.current.useLayoutEffect(J,W)},Pn.useMemo=function(J,W){return he.current.useMemo(J,W)},Pn.useReducer=function(J,W,Q){return he.current.useReducer(J,W,Q)},Pn.useRef=function(J){return he.current.useRef(J)},Pn.useState=function(J){return he.current.useState(J)},Pn.useSyncExternalStore=function(J,W,Q){return he.current.useSyncExternalStore(J,W,Q)},Pn.useTransition=function(){return he.current.useTransition()},Pn.version="18.3.1",Pn}var R5;function ab(){return R5||(R5=1,fy.exports=xD()),fy.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P5;function _D(){if(P5)return Fp;P5=1;var n=ab(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function s(a,u,l){var h,d={},m=null,p=null;l!==void 0&&(m=""+l),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(p=u.ref);for(h in u)r.call(u,h)&&!o.hasOwnProperty(h)&&(d[h]=u[h]);if(a&&a.defaultProps)for(h in u=a.defaultProps,u)d[h]===void 0&&(d[h]=u[h]);return{$$typeof:e,type:a,key:m,ref:p,props:d,_owner:i.current}}return Fp.Fragment=t,Fp.jsx=s,Fp.jsxs=s,Fp}var D5;function ED(){return D5||(D5=1,hy.exports=_D()),hy.exports}var se=ED(),$e=ab(),qg={},dy={exports:{}},js={},py={exports:{}},my={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L5;function SD(){return L5||(L5=1,(function(n){function e($,le){var ae=$.length;$.push(le);e:for(;0<ae;){var J=ae-1>>>1,W=$[J];if(0<i(W,le))$[J]=le,$[ae]=W,ae=J;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var le=$[0],ae=$.pop();if(ae!==le){$[0]=ae;e:for(var J=0,W=$.length,Q=W>>>1;J<Q;){var ne=2*(J+1)-1,fe=$[ne],ve=ne+1,we=$[ve];if(0>i(fe,ae))ve<W&&0>i(we,fe)?($[J]=we,$[ve]=ae,J=ve):($[J]=fe,$[ne]=ae,J=ne);else if(ve<W&&0>i(we,ae))$[J]=we,$[ve]=ae,J=ve;else break e}}return le}function i($,le){var ae=$.sortIndex-le.sortIndex;return ae!==0?ae:$.id-le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();n.unstable_now=function(){return s.now()-a}}var u=[],l=[],h=1,d=null,m=3,p=!1,y=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P($){for(var le=t(l);le!==null;){if(le.callback===null)r(l);else if(le.startTime<=$)r(l),le.sortIndex=le.expirationTime,e(u,le);else break;le=t(l)}}function I($){if(b=!1,P($),!y)if(t(u)!==null)y=!0,ge(D);else{var le=t(l);le!==null&&he(I,le.startTime-$)}}function D($,le){y=!1,b&&(b=!1,E(C),C=-1),p=!0;var ae=m;try{for(P(le),d=t(u);d!==null&&(!(d.expirationTime>le)||$&&!k());){var J=d.callback;if(typeof J=="function"){d.callback=null,m=d.priorityLevel;var W=J(d.expirationTime<=le);le=n.unstable_now(),typeof W=="function"?d.callback=W:d===t(u)&&r(u),P(le)}else r(u);d=t(u)}if(d!==null)var Q=!0;else{var ne=t(l);ne!==null&&he(I,ne.startTime-le),Q=!1}return Q}finally{d=null,m=ae,p=!1}}var U=!1,L=null,C=-1,A=5,M=-1;function k(){return!(n.unstable_now()-M<A)}function O(){if(L!==null){var $=n.unstable_now();M=$;var le=!0;try{le=L(!0,$)}finally{le?j():(U=!1,L=null)}}else U=!1}var j;if(typeof T=="function")j=function(){T(O)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,ue=X.port2;X.port1.onmessage=O,j=function(){ue.postMessage(null)}}else j=function(){x(O,0)};function ge($){L=$,U||(U=!0,j())}function he($,le){C=x(function(){$(n.unstable_now())},le)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){y||p||(y=!0,ge(D))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function($){switch(m){case 1:case 2:case 3:var le=3;break;default:le=m}var ae=m;m=le;try{return $()}finally{m=ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,le){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ae=m;m=$;try{return le()}finally{m=ae}},n.unstable_scheduleCallback=function($,le,ae){var J=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?J+ae:J):ae=J,$){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=ae+W,$={id:h++,callback:le,priorityLevel:$,startTime:ae,expirationTime:W,sortIndex:-1},ae>J?($.sortIndex=ae,e(l,$),t(u)===null&&$===t(l)&&(b?(E(C),C=-1):b=!0,he(I,ae-J))):($.sortIndex=W,e(u,$),y||p||(y=!0,ge(D))),$},n.unstable_shouldYield=k,n.unstable_wrapCallback=function($){var le=m;return function(){var ae=m;m=le;try{return $.apply(this,arguments)}finally{m=ae}}}})(my)),my}var M5;function AD(){return M5||(M5=1,py.exports=SD()),py.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O5;function CD(){if(O5)return js;O5=1;var n=ab(),e=AD();function t(c){for(var f="https://reactjs.org/docs/error-decoder.html?invariant="+c,g=1;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function o(c,f){s(c,f),s(c+"Capture",f)}function s(c,f){for(i[c]=f,c=0;c<f.length;c++)r.add(f[c])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,l=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},d={};function m(c){return u.call(d,c)?!0:u.call(h,c)?!1:l.test(c)?d[c]=!0:(h[c]=!0,!1)}function p(c,f,g,_){if(g!==null&&g.type===0)return!1;switch(typeof f){case"function":case"symbol":return!0;case"boolean":return _?!1:g!==null?!g.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function y(c,f,g,_){if(f===null||typeof f>"u"||p(c,f,g,_))return!0;if(_)return!1;if(g!==null)switch(g.type){case 3:return!f;case 4:return f===!1;case 5:return isNaN(f);case 6:return isNaN(f)||1>f}return!1}function b(c,f,g,_,R,V,K){this.acceptsBooleans=f===2||f===3||f===4,this.attributeName=_,this.attributeNamespace=R,this.mustUseProperty=g,this.propertyName=c,this.type=f,this.sanitizeURL=V,this.removeEmptyString=K}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){x[c]=new b(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var f=c[0];x[f]=new b(f,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){x[c]=new b(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){x[c]=new b(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){x[c]=new b(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){x[c]=new b(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){x[c]=new b(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){x[c]=new b(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){x[c]=new b(c,5,!1,c.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function T(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var f=c.replace(E,T);x[f]=new b(f,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var f=c.replace(E,T);x[f]=new b(f,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var f=c.replace(E,T);x[f]=new b(f,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){x[c]=new b(c,1,!1,c.toLowerCase(),null,!1,!1)}),x.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){x[c]=new b(c,1,!1,c.toLowerCase(),null,!0,!0)});function P(c,f,g,_){var R=x.hasOwnProperty(f)?x[f]:null;(R!==null?R.type!==0:_||!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(y(f,g,R,_)&&(g=null),_||R===null?m(f)&&(g===null?c.removeAttribute(f):c.setAttribute(f,""+g)):R.mustUseProperty?c[R.propertyName]=g===null?R.type===3?!1:"":g:(f=R.attributeName,_=R.attributeNamespace,g===null?c.removeAttribute(f):(R=R.type,g=R===3||R===4&&g===!0?"":""+g,_?c.setAttributeNS(_,f,g):c.setAttribute(f,g))))}var I=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),U=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),k=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),ue=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),he=Symbol.for("react.offscreen"),$=Symbol.iterator;function le(c){return c===null||typeof c!="object"?null:(c=$&&c[$]||c["@@iterator"],typeof c=="function"?c:null)}var ae=Object.assign,J;function W(c){if(J===void 0)try{throw Error()}catch(g){var f=g.stack.trim().match(/\n( *(at )?)/);J=f&&f[1]||""}return`
`+J+c}var Q=!1;function ne(c,f){if(!c||Q)return"";Q=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(f)if(f=function(){throw Error()},Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(Ue){var _=Ue}Reflect.construct(c,[],f)}else{try{f.call()}catch(Ue){_=Ue}c.call(f.prototype)}else{try{throw Error()}catch(Ue){_=Ue}c()}}catch(Ue){if(Ue&&_&&typeof Ue.stack=="string"){for(var R=Ue.stack.split(`
`),V=_.stack.split(`
`),K=R.length-1,ye=V.length-1;1<=K&&0<=ye&&R[K]!==V[ye];)ye--;for(;1<=K&&0<=ye;K--,ye--)if(R[K]!==V[ye]){if(K!==1||ye!==1)do if(K--,ye--,0>ye||R[K]!==V[ye]){var Ee=`
`+R[K].replace(" at new "," at ");return c.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",c.displayName)),Ee}while(1<=K&&0<=ye);break}}}finally{Q=!1,Error.prepareStackTrace=g}return(c=c?c.displayName||c.name:"")?W(c):""}function fe(c){switch(c.tag){case 5:return W(c.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return c=ne(c.type,!1),c;case 11:return c=ne(c.type.render,!1),c;case 1:return c=ne(c.type,!0),c;default:return""}}function ve(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case L:return"Fragment";case U:return"Portal";case A:return"Profiler";case C:return"StrictMode";case j:return"Suspense";case X:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case k:return(c.displayName||"Context")+".Consumer";case M:return(c._context.displayName||"Context")+".Provider";case O:var f=c.render;return c=c.displayName,c||(c=f.displayName||f.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case ue:return f=c.displayName||null,f!==null?f:ve(c.type)||"Memo";case ge:f=c._payload,c=c._init;try{return ve(c(f))}catch{}}return null}function we(c){var f=c.type;switch(c.tag){case 24:return"Cache";case 9:return(f.displayName||"Context")+".Consumer";case 10:return(f._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=f.render,c=c.displayName||c.name||"",f.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return f;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ve(f);case 8:return f===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f}return null}function Se(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function Ce(c){var f=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function Fe(c){var f=Ce(c)?"checked":"value",g=Object.getOwnPropertyDescriptor(c.constructor.prototype,f),_=""+c[f];if(!c.hasOwnProperty(f)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var R=g.get,V=g.set;return Object.defineProperty(c,f,{configurable:!0,get:function(){return R.call(this)},set:function(K){_=""+K,V.call(this,K)}}),Object.defineProperty(c,f,{enumerable:g.enumerable}),{getValue:function(){return _},setValue:function(K){_=""+K},stopTracking:function(){c._valueTracker=null,delete c[f]}}}}function qe(c){c._valueTracker||(c._valueTracker=Fe(c))}function Ne(c){if(!c)return!1;var f=c._valueTracker;if(!f)return!0;var g=f.getValue(),_="";return c&&(_=Ce(c)?c.checked?"true":"false":c.value),c=_,c!==g?(f.setValue(c),!0):!1}function Oe(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Qe(c,f){var g=f.checked;return ae({},f,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??c._wrapperState.initialChecked})}function te(c,f){var g=f.defaultValue==null?"":f.defaultValue,_=f.checked!=null?f.checked:f.defaultChecked;g=Se(f.value!=null?f.value:g),c._wrapperState={initialChecked:_,initialValue:g,controlled:f.type==="checkbox"||f.type==="radio"?f.checked!=null:f.value!=null}}function rt(c,f){f=f.checked,f!=null&&P(c,"checked",f,!1)}function zt(c,f){rt(c,f);var g=Se(f.value),_=f.type;if(g!=null)_==="number"?(g===0&&c.value===""||c.value!=g)&&(c.value=""+g):c.value!==""+g&&(c.value=""+g);else if(_==="submit"||_==="reset"){c.removeAttribute("value");return}f.hasOwnProperty("value")?He(c,f.type,g):f.hasOwnProperty("defaultValue")&&He(c,f.type,Se(f.defaultValue)),f.checked==null&&f.defaultChecked!=null&&(c.defaultChecked=!!f.defaultChecked)}function gt(c,f,g){if(f.hasOwnProperty("value")||f.hasOwnProperty("defaultValue")){var _=f.type;if(!(_!=="submit"&&_!=="reset"||f.value!==void 0&&f.value!==null))return;f=""+c._wrapperState.initialValue,g||f===c.value||(c.value=f),c.defaultValue=f}g=c.name,g!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,g!==""&&(c.name=g)}function He(c,f,g){(f!=="number"||Oe(c.ownerDocument)!==c)&&(g==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+g&&(c.defaultValue=""+g))}var ft=Array.isArray;function lt(c,f,g,_){if(c=c.options,f){f={};for(var R=0;R<g.length;R++)f["$"+g[R]]=!0;for(g=0;g<c.length;g++)R=f.hasOwnProperty("$"+c[g].value),c[g].selected!==R&&(c[g].selected=R),R&&_&&(c[g].defaultSelected=!0)}else{for(g=""+Se(g),f=null,R=0;R<c.length;R++){if(c[R].value===g){c[R].selected=!0,_&&(c[R].defaultSelected=!0);return}f!==null||c[R].disabled||(f=c[R])}f!==null&&(f.selected=!0)}}function Et(c,f){if(f.dangerouslySetInnerHTML!=null)throw Error(t(91));return ae({},f,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function pt(c,f){var g=f.value;if(g==null){if(g=f.children,f=f.defaultValue,g!=null){if(f!=null)throw Error(t(92));if(ft(g)){if(1<g.length)throw Error(t(93));g=g[0]}f=g}f==null&&(f=""),g=f}c._wrapperState={initialValue:Se(g)}}function En(c,f){var g=Se(f.value),_=Se(f.defaultValue);g!=null&&(g=""+g,g!==c.value&&(c.value=g),f.defaultValue==null&&c.defaultValue!==g&&(c.defaultValue=g)),_!=null&&(c.defaultValue=""+_)}function $t(c){var f=c.textContent;f===c._wrapperState.initialValue&&f!==""&&f!==null&&(c.value=f)}function Qt(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function an(c,f){return c==null||c==="http://www.w3.org/1999/xhtml"?Qt(f):c==="http://www.w3.org/2000/svg"&&f==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var qt,vt=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(f,g,_,R){MSApp.execUnsafeLocalFunction(function(){return c(f,g,_,R)})}:c})(function(c,f){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=f;else{for(qt=qt||document.createElement("div"),qt.innerHTML="<svg>"+f.valueOf().toString()+"</svg>",f=qt.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;f.firstChild;)c.appendChild(f.firstChild)}});function en(c,f){if(f){var g=c.firstChild;if(g&&g===c.lastChild&&g.nodeType===3){g.nodeValue=f;return}}c.textContent=f}var yt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dr=["Webkit","ms","Moz","O"];Object.keys(yt).forEach(function(c){dr.forEach(function(f){f=f+c.charAt(0).toUpperCase()+c.substring(1),yt[f]=yt[c]})});function mn(c,f,g){return f==null||typeof f=="boolean"||f===""?"":g||typeof f!="number"||f===0||yt.hasOwnProperty(c)&&yt[c]?(""+f).trim():f+"px"}function rn(c,f){c=c.style;for(var g in f)if(f.hasOwnProperty(g)){var _=g.indexOf("--")===0,R=mn(g,f[g],_);g==="float"&&(g="cssFloat"),_?c.setProperty(g,R):c[g]=R}}var un=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function On(c,f){if(f){if(un[c]&&(f.children!=null||f.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(f.dangerouslySetInnerHTML!=null){if(f.children!=null)throw Error(t(60));if(typeof f.dangerouslySetInnerHTML!="object"||!("__html"in f.dangerouslySetInnerHTML))throw Error(t(61))}if(f.style!=null&&typeof f.style!="object")throw Error(t(62))}}function Ot(c,f){if(c.indexOf("-")===-1)return typeof f.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bn=null;function Ht(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Jt=null,jn=null,Dt=null;function Gt(c){if(c=_c(c)){if(typeof Jt!="function")throw Error(t(280));var f=c.stateNode;f&&(f=Dh(f),Jt(c.stateNode,c.type,f))}}function Cn(c){jn?Dt?Dt.push(c):Dt=[c]:jn=c}function Mo(){if(jn){var c=jn,f=Dt;if(Dt=jn=null,Gt(c),f)for(c=0;c<f.length;c++)Gt(f[c])}}function ai(c,f){return c(f)}function As(){}var ui=!1;function Kt(c,f,g){if(ui)return c(f,g);ui=!0;try{return ai(c,f,g)}finally{ui=!1,(jn!==null||Dt!==null)&&(As(),Mo())}}function go(c,f){var g=c.stateNode;if(g===null)return null;var _=Dh(g);if(_===null)return null;g=_[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(c=c.type,_=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!_;break e;default:c=!1}if(c)return null;if(g&&typeof g!="function")throw Error(t(231,f,typeof g));return g}var Yi=!1;if(a)try{var li={};Object.defineProperty(li,"passive",{get:function(){Yi=!0}}),window.addEventListener("test",li,li),window.removeEventListener("test",li,li)}catch{Yi=!1}function vo(c,f,g,_,R,V,K,ye,Ee){var Ue=Array.prototype.slice.call(arguments,3);try{f.apply(g,Ue)}catch(ot){this.onError(ot)}}var Xn=!1,or=null,Rr=!1,Ei=null,Ks={onError:function(c){Xn=!0,or=c}};function Oo(c,f,g,_,R,V,K,ye,Ee){Xn=!1,or=null,vo.apply(Ks,arguments)}function Fo(c,f,g,_,R,V,K,ye,Ee){if(Oo.apply(this,arguments),Xn){if(Xn){var Ue=or;Xn=!1,or=null}else throw Error(t(198));Rr||(Rr=!0,Ei=Ue)}}function Vr(c){var f=c,g=c;if(c.alternate)for(;f.return;)f=f.return;else{c=f;do f=c,(f.flags&4098)!==0&&(g=f.return),c=f.return;while(c)}return f.tag===3?g:null}function yo(c){if(c.tag===13){var f=c.memoizedState;if(f===null&&(c=c.alternate,c!==null&&(f=c.memoizedState)),f!==null)return f.dehydrated}return null}function wo(c){if(Vr(c)!==c)throw Error(t(188))}function xa(c){var f=c.alternate;if(!f){if(f=Vr(c),f===null)throw Error(t(188));return f!==c?null:c}for(var g=c,_=f;;){var R=g.return;if(R===null)break;var V=R.alternate;if(V===null){if(_=R.return,_!==null){g=_;continue}break}if(R.child===V.child){for(V=R.child;V;){if(V===g)return wo(R),c;if(V===_)return wo(R),f;V=V.sibling}throw Error(t(188))}if(g.return!==_.return)g=R,_=V;else{for(var K=!1,ye=R.child;ye;){if(ye===g){K=!0,g=R,_=V;break}if(ye===_){K=!0,_=R,g=V;break}ye=ye.sibling}if(!K){for(ye=V.child;ye;){if(ye===g){K=!0,g=V,_=R;break}if(ye===_){K=!0,_=V,g=R;break}ye=ye.sibling}if(!K)throw Error(t(189))}}if(g.alternate!==_)throw Error(t(190))}if(g.tag!==3)throw Error(t(188));return g.stateNode.current===g?c:f}function cs(c){return c=xa(c),c!==null?hs(c):null}function hs(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var f=hs(c);if(f!==null)return f;c=c.sibling}return null}var _a=e.unstable_scheduleCallback,Xs=e.unstable_cancelCallback,Cs=e.unstable_shouldYield,Ys=e.unstable_requestPaint,Qn=e.unstable_now,cc=e.unstable_getCurrentPriorityLevel,Ka=e.unstable_ImmediatePriority,Qi=e.unstable_UserBlockingPriority,Qs=e.unstable_NormalPriority,Nu=e.unstable_LowPriority,Ea=e.unstable_IdlePriority,Sa=null,Ji=null;function xl(c){if(Ji&&typeof Ji.onCommitFiberRoot=="function")try{Ji.onCommitFiberRoot(Sa,c,void 0,(c.current.flags&128)===128)}catch{}}var Pr=Math.clz32?Math.clz32:pr,bo=Math.log,Bo=Math.LN2;function pr(c){return c>>>=0,c===0?32:31-(bo(c)/Bo|0)|0}var fs=64,Oi=4194304;function Tn(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function Is(c,f){var g=c.pendingLanes;if(g===0)return 0;var _=0,R=c.suspendedLanes,V=c.pingedLanes,K=g&268435455;if(K!==0){var ye=K&~R;ye!==0?_=Tn(ye):(V&=K,V!==0&&(_=Tn(V)))}else K=g&~R,K!==0?_=Tn(K):V!==0&&(_=Tn(V));if(_===0)return 0;if(f!==0&&f!==_&&(f&R)===0&&(R=_&-_,V=f&-f,R>=V||R===16&&(V&4194240)!==0))return f;if((_&4)!==0&&(_|=g&16),f=c.entangledLanes,f!==0)for(c=c.entanglements,f&=_;0<f;)g=31-Pr(f),R=1<<g,_|=c[g],f&=~R;return _}function Si(c,f){switch(c){case 1:case 2:case 4:return f+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function br(c,f){for(var g=c.suspendedLanes,_=c.pingedLanes,R=c.expirationTimes,V=c.pendingLanes;0<V;){var K=31-Pr(V),ye=1<<K,Ee=R[K];Ee===-1?((ye&g)===0||(ye&_)!==0)&&(R[K]=Si(ye,f)):Ee<=f&&(c.expiredLanes|=ye),V&=~ye}}function ds(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function Ru(){var c=fs;return fs<<=1,(fs&4194240)===0&&(fs=64),c}function _l(c){for(var f=[],g=0;31>g;g++)f.push(c);return f}function Xa(c,f,g){c.pendingLanes|=f,f!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,f=31-Pr(f),c[f]=g}function Ts(c,f){var g=c.pendingLanes&~f;c.pendingLanes=f,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=f,c.mutableReadLanes&=f,c.entangledLanes&=f,f=c.entanglements;var _=c.eventTimes;for(c=c.expirationTimes;0<g;){var R=31-Pr(g),V=1<<R;f[R]=0,_[R]=-1,c[R]=-1,g&=~V}}function Pu(c,f){var g=c.entangledLanes|=f;for(c=c.entanglements;g;){var _=31-Pr(g),R=1<<_;R&f|c[_]&f&&(c[_]|=f),g&=~R}}var An=0;function xo(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var Js,Du,El,Sl,Ya,ps=!1,Zi=[],ks=null,eo=null,jr=null,Qa=new Map,Xt=new Map,_o=[],hc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Aa(c,f){switch(c){case"focusin":case"focusout":ks=null;break;case"dragenter":case"dragleave":eo=null;break;case"mouseover":case"mouseout":jr=null;break;case"pointerover":case"pointerout":Qa.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xt.delete(f.pointerId)}}function ci(c,f,g,_,R,V){return c===null||c.nativeEvent!==V?(c={blockedOn:f,domEventName:g,eventSystemFlags:_,nativeEvent:V,targetContainers:[R]},f!==null&&(f=_c(f),f!==null&&Du(f)),c):(c.eventSystemFlags|=_,f=c.targetContainers,R!==null&&f.indexOf(R)===-1&&f.push(R),c)}function Ns(c,f,g,_,R){switch(f){case"focusin":return ks=ci(ks,c,f,g,_,R),!0;case"dragenter":return eo=ci(eo,c,f,g,_,R),!0;case"mouseover":return jr=ci(jr,c,f,g,_,R),!0;case"pointerover":var V=R.pointerId;return Qa.set(V,ci(Qa.get(V)||null,c,f,g,_,R)),!0;case"gotpointercapture":return V=R.pointerId,Xt.set(V,ci(Xt.get(V)||null,c,f,g,_,R)),!0}return!1}function Lu(c){var f=Wu(c.target);if(f!==null){var g=Vr(f);if(g!==null){if(f=g.tag,f===13){if(f=yo(g),f!==null){c.blockedOn=f,Ya(c.priority,function(){El(g)});return}}else if(f===3&&g.stateNode.current.memoizedState.isDehydrated){c.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Jn(c){if(c.blockedOn!==null)return!1;for(var f=c.targetContainers;0<f.length;){var g=Ia(c.domEventName,c.eventSystemFlags,f[0],c.nativeEvent);if(g===null){g=c.nativeEvent;var _=new g.constructor(g.type,g);Bn=_,g.target.dispatchEvent(_),Bn=null}else return f=_c(g),f!==null&&Du(f),c.blockedOn=g,!1;f.shift()}return!0}function Ja(c,f,g){Jn(c)&&g.delete(f)}function Al(){ps=!1,ks!==null&&Jn(ks)&&(ks=null),eo!==null&&Jn(eo)&&(eo=null),jr!==null&&Jn(jr)&&(jr=null),Qa.forEach(Ja),Xt.forEach(Ja)}function Vo(c,f){c.blockedOn===f&&(c.blockedOn=null,ps||(ps=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Al)))}function Ca(c){function f(R){return Vo(R,c)}if(0<Zi.length){Vo(Zi[0],c);for(var g=1;g<Zi.length;g++){var _=Zi[g];_.blockedOn===c&&(_.blockedOn=null)}}for(ks!==null&&Vo(ks,c),eo!==null&&Vo(eo,c),jr!==null&&Vo(jr,c),Qa.forEach(f),Xt.forEach(f),g=0;g<_o.length;g++)_=_o[g],_.blockedOn===c&&(_.blockedOn=null);for(;0<_o.length&&(g=_o[0],g.blockedOn===null);)Lu(g),g.blockedOn===null&&_o.shift()}var Fi=I.ReactCurrentBatchConfig,Zs=!0;function jo(c,f,g,_){var R=An,V=Fi.transition;Fi.transition=null;try{An=1,Ou(c,f,g,_)}finally{An=R,Fi.transition=V}}function Mu(c,f,g,_){var R=An,V=Fi.transition;Fi.transition=null;try{An=4,Ou(c,f,g,_)}finally{An=R,Fi.transition=V}}function Ou(c,f,g,_){if(Zs){var R=Ia(c,f,g,_);if(R===null)Nh(c,f,_,Ai,g),Aa(c,_);else if(Ns(R,c,f,g,_))_.stopPropagation();else if(Aa(c,_),f&4&&-1<hc.indexOf(c)){for(;R!==null;){var V=_c(R);if(V!==null&&Js(V),V=Ia(c,f,g,_),V===null&&Nh(c,f,_,Ai,g),V===R)break;R=V}R!==null&&_.stopPropagation()}else Nh(c,f,_,null,g)}}var Ai=null;function Ia(c,f,g,_){if(Ai=null,c=Ht(_),c=Wu(c),c!==null)if(f=Vr(c),f===null)c=null;else if(g=f.tag,g===13){if(c=yo(f),c!==null)return c;c=null}else if(g===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;c=null}else f!==c&&(c=null);return Ai=c,null}function ea(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cc()){case Ka:return 1;case Qi:return 4;case Qs:case Nu:return 16;case Ea:return 536870912;default:return 16}default:return 16}}var Bi=null,Rs=null,ms=null;function Cl(){if(ms)return ms;var c,f=Rs,g=f.length,_,R="value"in Bi?Bi.value:Bi.textContent,V=R.length;for(c=0;c<g&&f[c]===R[c];c++);var K=g-c;for(_=1;_<=K&&f[g-_]===R[V-_];_++);return ms=R.slice(c,1<_?1-_:void 0)}function Ta(c){var f=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&f===13&&(c=13)):c=f,c===10&&(c=13),32<=c||c===13?c:0}function Ci(){return!0}function gs(){return!1}function hi(c){function f(g,_,R,V,K){this._reactName=g,this._targetInst=R,this.type=_,this.nativeEvent=V,this.target=K,this.currentTarget=null;for(var ye in c)c.hasOwnProperty(ye)&&(g=c[ye],this[ye]=g?g(V):V[ye]);return this.isDefaultPrevented=(V.defaultPrevented!=null?V.defaultPrevented:V.returnValue===!1)?Ci:gs,this.isPropagationStopped=gs,this}return ae(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Ci)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Ci)},persist:function(){},isPersistent:Ci}),f}var to={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ka=hi(to),N=ae({},to,{view:0,detail:0}),H=hi(N),pe,be,ke,Xe=ae({},N,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:on,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==ke&&(ke&&c.type==="mousemove"?(pe=c.screenX-ke.screenX,be=c.screenY-ke.screenY):be=pe=0,ke=c),pe)},movementY:function(c){return"movementY"in c?c.movementY:be}}),et=hi(Xe),wt=ae({},Xe,{dataTransfer:0}),It=hi(wt),Zt=ae({},N,{relatedTarget:0}),Ft=hi(Zt),kn=ae({},to,{animationName:0,elapsedTime:0,pseudoElement:0}),mr=hi(kn),sr=ae({},to,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),w=hi(sr),B=ae({},to,{data:0}),q=hi(B),re={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Re={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ve={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function at(c){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(c):(c=Ve[c])?!!f[c]:!1}function on(){return at}var gr=ae({},N,{key:function(c){if(c.key){var f=re[c.key]||c.key;if(f!=="Unidentified")return f}return c.type==="keypress"?(c=Ta(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?Re[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:on,charCode:function(c){return c.type==="keypress"?Ta(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Ta(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),Nn=hi(gr),vr=ae({},Xe,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fi=hi(vr),no=ae({},N,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:on}),yr=hi(no),ro=ae({},to,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ps=hi(ro),Za=ae({},Xe,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),Eh=hi(Za),Eo=[9,13,27,32],ta=a&&"CompositionEvent"in window,Na=null;a&&"documentMode"in document&&(Na=document.documentMode);var Tf=a&&"TextEvent"in window&&!Na,vs=a&&(!ta||Na&&8<Na&&11>=Na),Fu=" ",fc=!1;function dc(c,f){switch(c){case"keyup":return Eo.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eu(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Ds=!1;function ys(c,f){switch(c){case"compositionend":return eu(f);case"keypress":return f.which!==32?null:(fc=!0,Fu);case"textInput":return c=f.data,c===Fu&&fc?null:c;default:return null}}function ws(c,f){if(Ds)return c==="compositionend"||!ta&&dc(c,f)?(c=Cl(),ms=Rs=Bi=null,Ds=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return vs&&f.locale!=="ko"?null:f.data;default:return null}}var Bu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ra(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f==="input"?!!Bu[c.type]:f==="textarea"}function tu(c,f,g,_){Cn(_),f=Df(f,"onChange"),0<f.length&&(g=new ka("onChange","change",null,g,_),c.push({event:g,listeners:f}))}var nu=null,Pa=null;function Ur(c){Th(c,0)}function Il(c){var f=Fl(c);if(Ne(f))return c}function Da(c,f){if(c==="change")return f}var na=!1;if(a){var Tl;if(a){var kl="oninput"in document;if(!kl){var pc=document.createElement("div");pc.setAttribute("oninput","return;"),kl=typeof pc.oninput=="function"}Tl=kl}else Tl=!1;na=Tl&&(!document.documentMode||9<document.documentMode)}function mc(){nu&&(nu.detachEvent("onpropertychange",ru),Pa=nu=null)}function ru(c){if(c.propertyName==="value"&&Il(Pa)){var f=[];tu(f,Pa,c,Ht(c)),Kt(Ur,f)}}function Vu(c,f,g){c==="focusin"?(mc(),nu=f,Pa=g,nu.attachEvent("onpropertychange",ru)):c==="focusout"&&mc()}function ju(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Il(Pa)}function Nl(c,f){if(c==="click")return Il(f)}function Uu(c,f){if(c==="input"||c==="change")return Il(f)}function Rl(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var Dr=typeof Object.is=="function"?Object.is:Rl;function Uo(c,f){if(Dr(c,f))return!0;if(typeof c!="object"||c===null||typeof f!="object"||f===null)return!1;var g=Object.keys(c),_=Object.keys(f);if(g.length!==_.length)return!1;for(_=0;_<g.length;_++){var R=g[_];if(!u.call(f,R)||!Dr(c[R],f[R]))return!1}return!0}function qn(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function tr(c,f){var g=qn(c);c=0;for(var _;g;){if(g.nodeType===3){if(_=c+g.textContent.length,c<=f&&_>=f)return{node:g,offset:f-c};c=_}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=qn(g)}}function Lr(c,f){return c&&f?c===f?!0:c&&c.nodeType===3?!1:f&&f.nodeType===3?Lr(c,f.parentNode):"contains"in c?c.contains(f):c.compareDocumentPosition?!!(c.compareDocumentPosition(f)&16):!1:!1}function Zr(){for(var c=window,f=Oe();f instanceof c.HTMLIFrameElement;){try{var g=typeof f.contentWindow.location.href=="string"}catch{g=!1}if(g)c=f.contentWindow;else break;f=Oe(c.document)}return f}function ra(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f&&(f==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||f==="textarea"||c.contentEditable==="true")}function Sh(c){var f=Zr(),g=c.focusedElem,_=c.selectionRange;if(f!==g&&g&&g.ownerDocument&&Lr(g.ownerDocument.documentElement,g)){if(_!==null&&ra(g)){if(f=_.start,c=_.end,c===void 0&&(c=f),"selectionStart"in g)g.selectionStart=f,g.selectionEnd=Math.min(c,g.value.length);else if(c=(f=g.ownerDocument||document)&&f.defaultView||window,c.getSelection){c=c.getSelection();var R=g.textContent.length,V=Math.min(_.start,R);_=_.end===void 0?V:Math.min(_.end,R),!c.extend&&V>_&&(R=_,_=V,V=R),R=tr(g,V);var K=tr(g,_);R&&K&&(c.rangeCount!==1||c.anchorNode!==R.node||c.anchorOffset!==R.offset||c.focusNode!==K.node||c.focusOffset!==K.offset)&&(f=f.createRange(),f.setStart(R.node,R.offset),c.removeAllRanges(),V>_?(c.addRange(f),c.extend(K.node,K.offset)):(f.setEnd(K.node,K.offset),c.addRange(f)))}}for(f=[],c=g;c=c.parentNode;)c.nodeType===1&&f.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<f.length;g++)c=f[g],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var gc=a&&"documentMode"in document&&11>=document.documentMode,iu=null,kf=null,vc=null,Nf=!1;function dp(c,f,g){var _=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Nf||iu==null||iu!==Oe(_)||(_=iu,"selectionStart"in _&&ra(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),vc&&Uo(vc,_)||(vc=_,_=Df(kf,"onSelect"),0<_.length&&(f=new ka("onSelect","select",null,f,g),c.push({event:f,listeners:_}),f.target=iu)))}function Ah(c,f){var g={};return g[c.toLowerCase()]=f.toLowerCase(),g["Webkit"+c]="webkit"+f,g["Moz"+c]="moz"+f,g}var Pl={animationend:Ah("Animation","AnimationEnd"),animationiteration:Ah("Animation","AnimationIteration"),animationstart:Ah("Animation","AnimationStart"),transitionend:Ah("Transition","TransitionEnd")},Dl={},pp={};a&&(pp=document.createElement("div").style,"AnimationEvent"in window||(delete Pl.animationend.animation,delete Pl.animationiteration.animation,delete Pl.animationstart.animation),"TransitionEvent"in window||delete Pl.transitionend.transition);function Ch(c){if(Dl[c])return Dl[c];if(!Pl[c])return c;var f=Pl[c],g;for(g in f)if(f.hasOwnProperty(g)&&g in pp)return Dl[c]=f[g];return c}var mp=Ch("animationend"),gp=Ch("animationiteration"),vp=Ch("animationstart"),yp=Ch("transitionend"),wp=new Map,bp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function La(c,f){wp.set(c,f),o(f,[c])}for(var yc=0;yc<bp.length;yc++){var So=bp[yc],Ls=So.toLowerCase(),Rf=So[0].toUpperCase()+So.slice(1);La(Ls,"on"+Rf)}La(mp,"onAnimationEnd"),La(gp,"onAnimationIteration"),La(vp,"onAnimationStart"),La("dblclick","onDoubleClick"),La("focusin","onFocus"),La("focusout","onBlur"),La(yp,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cg=new Set("cancel close invalid load scroll toggle".split(" ").concat(zu));function Ih(c,f,g){var _=c.type||"unknown-event";c.currentTarget=g,Fo(_,f,void 0,c),c.currentTarget=null}function Th(c,f){f=(f&4)!==0;for(var g=0;g<c.length;g++){var _=c[g],R=_.event;_=_.listeners;e:{var V=void 0;if(f)for(var K=_.length-1;0<=K;K--){var ye=_[K],Ee=ye.instance,Ue=ye.currentTarget;if(ye=ye.listener,Ee!==V&&R.isPropagationStopped())break e;Ih(R,ye,Ue),V=Ee}else for(K=0;K<_.length;K++){if(ye=_[K],Ee=ye.instance,Ue=ye.currentTarget,ye=ye.listener,Ee!==V&&R.isPropagationStopped())break e;Ih(R,ye,Ue),V=Ee}}}if(Rr)throw c=Ei,Rr=!1,Ei=null,c}function ar(c,f){var g=f[Wo];g===void 0&&(g=f[Wo]=new Set);var _=c+"__bubble";g.has(_)||(kh(f,c,2,!1),g.add(_))}function Pf(c,f,g){var _=0;f&&(_|=4),kh(g,c,_,f)}var wc="_reactListening"+Math.random().toString(36).slice(2);function Ll(c){if(!c[wc]){c[wc]=!0,r.forEach(function(g){g!=="selectionchange"&&(cg.has(g)||Pf(g,!1,c),Pf(g,!0,c))});var f=c.nodeType===9?c:c.ownerDocument;f===null||f[wc]||(f[wc]=!0,Pf("selectionchange",!1,f))}}function kh(c,f,g,_){switch(ea(f)){case 1:var R=jo;break;case 4:R=Mu;break;default:R=Ou}g=R.bind(null,f,g,c),R=void 0,!Yi||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(R=!0),_?R!==void 0?c.addEventListener(f,g,{capture:!0,passive:R}):c.addEventListener(f,g,!0):R!==void 0?c.addEventListener(f,g,{passive:R}):c.addEventListener(f,g,!1)}function Nh(c,f,g,_,R){var V=_;if((f&1)===0&&(f&2)===0&&_!==null)e:for(;;){if(_===null)return;var K=_.tag;if(K===3||K===4){var ye=_.stateNode.containerInfo;if(ye===R||ye.nodeType===8&&ye.parentNode===R)break;if(K===4)for(K=_.return;K!==null;){var Ee=K.tag;if((Ee===3||Ee===4)&&(Ee=K.stateNode.containerInfo,Ee===R||Ee.nodeType===8&&Ee.parentNode===R))return;K=K.return}for(;ye!==null;){if(K=Wu(ye),K===null)return;if(Ee=K.tag,Ee===5||Ee===6){_=V=K;continue e}ye=ye.parentNode}}_=_.return}Kt(function(){var Ue=V,ot=Ht(g),st=[];e:{var it=wp.get(c);if(it!==void 0){var mt=ka,Tt=c;switch(c){case"keypress":if(Ta(g)===0)break e;case"keydown":case"keyup":mt=Nn;break;case"focusin":Tt="focus",mt=Ft;break;case"focusout":Tt="blur",mt=Ft;break;case"beforeblur":case"afterblur":mt=Ft;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":mt=et;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":mt=It;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":mt=yr;break;case mp:case gp:case vp:mt=mr;break;case yp:mt=Ps;break;case"scroll":mt=H;break;case"wheel":mt=Eh;break;case"copy":case"cut":case"paste":mt=w;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":mt=fi}var Pt=(f&4)!==0,mi=!Pt&&c==="scroll",Le=Pt?it!==null?it+"Capture":null:it;Pt=[];for(var Te=Ue,Be;Te!==null;){Be=Te;var ut=Be.stateNode;if(Be.tag===5&&ut!==null&&(Be=ut,Le!==null&&(ut=go(Te,Le),ut!=null&&Pt.push(Rh(Te,ut,Be)))),mi)break;Te=Te.return}0<Pt.length&&(it=new mt(it,Tt,null,g,ot),st.push({event:it,listeners:Pt}))}}if((f&7)===0){e:{if(it=c==="mouseover"||c==="pointerover",mt=c==="mouseout"||c==="pointerout",it&&g!==Bn&&(Tt=g.relatedTarget||g.fromElement)&&(Wu(Tt)||Tt[io]))break e;if((mt||it)&&(it=ot.window===ot?ot:(it=ot.ownerDocument)?it.defaultView||it.parentWindow:window,mt?(Tt=g.relatedTarget||g.toElement,mt=Ue,Tt=Tt?Wu(Tt):null,Tt!==null&&(mi=Vr(Tt),Tt!==mi||Tt.tag!==5&&Tt.tag!==6)&&(Tt=null)):(mt=null,Tt=Ue),mt!==Tt)){if(Pt=et,ut="onMouseLeave",Le="onMouseEnter",Te="mouse",(c==="pointerout"||c==="pointerover")&&(Pt=fi,ut="onPointerLeave",Le="onPointerEnter",Te="pointer"),mi=mt==null?it:Fl(mt),Be=Tt==null?it:Fl(Tt),it=new Pt(ut,Te+"leave",mt,g,ot),it.target=mi,it.relatedTarget=Be,ut=null,Wu(ot)===Ue&&(Pt=new Pt(Le,Te+"enter",Tt,g,ot),Pt.target=Be,Pt.relatedTarget=mi,ut=Pt),mi=ut,mt&&Tt)t:{for(Pt=mt,Le=Tt,Te=0,Be=Pt;Be;Be=Ml(Be))Te++;for(Be=0,ut=Le;ut;ut=Ml(ut))Be++;for(;0<Te-Be;)Pt=Ml(Pt),Te--;for(;0<Be-Te;)Le=Ml(Le),Be--;for(;Te--;){if(Pt===Le||Le!==null&&Pt===Le.alternate)break t;Pt=Ml(Pt),Le=Ml(Le)}Pt=null}else Pt=null;mt!==null&&hg(st,it,mt,Pt,!1),Tt!==null&&mi!==null&&hg(st,mi,Tt,Pt,!0)}}e:{if(it=Ue?Fl(Ue):window,mt=it.nodeName&&it.nodeName.toLowerCase(),mt==="select"||mt==="input"&&it.type==="file")var Bt=Da;else if(Ra(it))if(na)Bt=Uu;else{Bt=ju;var tn=Vu}else(mt=it.nodeName)&&mt.toLowerCase()==="input"&&(it.type==="checkbox"||it.type==="radio")&&(Bt=Nl);if(Bt&&(Bt=Bt(c,Ue))){tu(st,Bt,g,ot);break e}tn&&tn(c,it,Ue),c==="focusout"&&(tn=it._wrapperState)&&tn.controlled&&it.type==="number"&&He(it,"number",it.value)}switch(tn=Ue?Fl(Ue):window,c){case"focusin":(Ra(tn)||tn.contentEditable==="true")&&(iu=tn,kf=Ue,vc=null);break;case"focusout":vc=kf=iu=null;break;case"mousedown":Nf=!0;break;case"contextmenu":case"mouseup":case"dragend":Nf=!1,dp(st,g,ot);break;case"selectionchange":if(gc)break;case"keydown":case"keyup":dp(st,g,ot)}var nn;if(ta)e:{switch(c){case"compositionstart":var fn="onCompositionStart";break e;case"compositionend":fn="onCompositionEnd";break e;case"compositionupdate":fn="onCompositionUpdate";break e}fn=void 0}else Ds?dc(c,g)&&(fn="onCompositionEnd"):c==="keydown"&&g.keyCode===229&&(fn="onCompositionStart");fn&&(vs&&g.locale!=="ko"&&(Ds||fn!=="onCompositionStart"?fn==="onCompositionEnd"&&Ds&&(nn=Cl()):(Bi=ot,Rs="value"in Bi?Bi.value:Bi.textContent,Ds=!0)),tn=Df(Ue,fn),0<tn.length&&(fn=new q(fn,c,null,g,ot),st.push({event:fn,listeners:tn}),nn?fn.data=nn:(nn=eu(g),nn!==null&&(fn.data=nn)))),(nn=Tf?ys(c,g):ws(c,g))&&(Ue=Df(Ue,"onBeforeInput"),0<Ue.length&&(ot=new q("onBeforeInput","beforeinput",null,g,ot),st.push({event:ot,listeners:Ue}),ot.data=nn))}Th(st,f)})}function Rh(c,f,g){return{instance:c,listener:f,currentTarget:g}}function Df(c,f){for(var g=f+"Capture",_=[];c!==null;){var R=c,V=R.stateNode;R.tag===5&&V!==null&&(R=V,V=go(c,g),V!=null&&_.unshift(Rh(c,V,R)),V=go(c,f),V!=null&&_.push(Rh(c,V,R))),c=c.return}return _}function Ml(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function hg(c,f,g,_,R){for(var V=f._reactName,K=[];g!==null&&g!==_;){var ye=g,Ee=ye.alternate,Ue=ye.stateNode;if(Ee!==null&&Ee===_)break;ye.tag===5&&Ue!==null&&(ye=Ue,R?(Ee=go(g,V),Ee!=null&&K.unshift(Rh(g,Ee,ye))):R||(Ee=go(g,V),Ee!=null&&K.push(Rh(g,Ee,ye)))),g=g.return}K.length!==0&&c.push({event:f,listeners:K})}var A1=/\r\n?/g,C1=/\u0000|\uFFFD/g;function fg(c){return(typeof c=="string"?c:""+c).replace(A1,`
`).replace(C1,"")}function Lf(c,f,g){if(f=fg(f),fg(c)!==f&&g)throw Error(t(425))}function bc(){}var Ph=null,Ol=null;function xp(c,f){return c==="textarea"||c==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var _p=typeof setTimeout=="function"?setTimeout:void 0,dg=typeof clearTimeout=="function"?clearTimeout:void 0,pg=typeof Promise=="function"?Promise:void 0,I1=typeof queueMicrotask=="function"?queueMicrotask:typeof pg<"u"?function(c){return pg.resolve(null).then(c).catch(T1)}:_p;function T1(c){setTimeout(function(){throw c})}function Ep(c,f){var g=f,_=0;do{var R=g.nextSibling;if(c.removeChild(g),R&&R.nodeType===8)if(g=R.data,g==="/$"){if(_===0){c.removeChild(R),Ca(f);return}_--}else g!=="$"&&g!=="$?"&&g!=="$!"||_++;g=R}while(g);Ca(f)}function Ao(c){for(;c!=null;c=c.nextSibling){var f=c.nodeType;if(f===1||f===3)break;if(f===8){if(f=c.data,f==="$"||f==="$!"||f==="$?")break;if(f==="/$")return null}}return c}function Ms(c){c=c.previousSibling;for(var f=0;c;){if(c.nodeType===8){var g=c.data;if(g==="$"||g==="$!"||g==="$?"){if(f===0)return c;f--}else g==="/$"&&f++}c=c.previousSibling}return null}var zo=Math.random().toString(36).slice(2),Ma="__reactFiber$"+zo,xc="__reactProps$"+zo,io="__reactContainer$"+zo,Wo="__reactEvents$"+zo,k1="__reactListeners$"+zo,N1="__reactHandles$"+zo;function Wu(c){var f=c[Ma];if(f)return f;for(var g=c.parentNode;g;){if(f=g[io]||g[Ma]){if(g=f.alternate,f.child!==null||g!==null&&g.child!==null)for(c=Ms(c);c!==null;){if(g=c[Ma])return g;c=Ms(c)}return f}c=g,g=c.parentNode}return null}function _c(c){return c=c[Ma]||c[io],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Fl(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function Dh(c){return c[xc]||null}var Sp=[],ou=-1;function ia(c){return{current:c}}function Zn(c){0>ou||(c.current=Sp[ou],Sp[ou]=null,ou--)}function nr(c,f){ou++,Sp[ou]=c.current,c.current=f}var qu={},Vi=ia(qu),qo=ia(!1),Bl=qu;function Ec(c,f){var g=c.type.contextTypes;if(!g)return qu;var _=c.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===f)return _.__reactInternalMemoizedMaskedChildContext;var R={},V;for(V in g)R[V]=f[V];return _&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=f,c.__reactInternalMemoizedMaskedChildContext=R),R}function Ho(c){return c=c.childContextTypes,c!=null}function Mf(){Zn(qo),Zn(Vi)}function mg(c,f,g){if(Vi.current!==qu)throw Error(t(168));nr(Vi,f),nr(qo,g)}function Ap(c,f,g){var _=c.stateNode;if(f=f.childContextTypes,typeof _.getChildContext!="function")return g;_=_.getChildContext();for(var R in _)if(!(R in f))throw Error(t(108,we(c)||"Unknown",R));return ae({},g,_)}function Vl(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||qu,Bl=Vi.current,nr(Vi,c),nr(qo,qo.current),!0}function gg(c,f,g){var _=c.stateNode;if(!_)throw Error(t(169));g?(c=Ap(c,f,Bl),_.__reactInternalMemoizedMergedChildContext=c,Zn(qo),Zn(Vi),nr(Vi,c)):Zn(qo),nr(qo,g)}var su=null,Lh=!1,v=!1;function S(c){su===null?su=[c]:su.push(c)}function F(c){Lh=!0,S(c)}function z(){if(!v&&su!==null){v=!0;var c=0,f=An;try{var g=su;for(An=1;c<g.length;c++){var _=g[c];do _=_(!0);while(_!==null)}su=null,Lh=!1}catch(R){throw su!==null&&(su=su.slice(c+1)),_a(Ka,z),R}finally{An=f,v=!1}}return null}var G=[],Y=0,Z=null,ee=0,ie=[],ce=0,_e=null,De=1,de="";function Ae(c,f){G[Y++]=ee,G[Y++]=Z,Z=c,ee=f}function Pe(c,f,g){ie[ce++]=De,ie[ce++]=de,ie[ce++]=_e,_e=c;var _=De;c=de;var R=32-Pr(_)-1;_&=~(1<<R),g+=1;var V=32-Pr(f)+R;if(30<V){var K=R-R%5;V=(_&(1<<K)-1).toString(32),_>>=K,R-=K,De=1<<32-Pr(f)+R|g<<R|_,de=V+c}else De=1<<V|g<<R|_,de=c}function Ke(c){c.return!==null&&(Ae(c,1),Pe(c,1,0))}function Me(c){for(;c===Z;)Z=G[--Y],G[Y]=null,ee=G[--Y],G[Y]=null;for(;c===_e;)_e=ie[--ce],ie[ce]=null,de=ie[--ce],ie[ce]=null,De=ie[--ce],ie[ce]=null}var We=null,Ge=null,Je=!1,Ze=null;function Lt(c,f){var g=ja(5,null,null,0);g.elementType="DELETED",g.stateNode=f,g.return=c,f=c.deletions,f===null?(c.deletions=[g],c.flags|=16):f.push(g)}function bt(c,f){switch(c.tag){case 5:var g=c.type;return f=f.nodeType!==1||g.toLowerCase()!==f.nodeName.toLowerCase()?null:f,f!==null?(c.stateNode=f,We=c,Ge=Ao(f.firstChild),!0):!1;case 6:return f=c.pendingProps===""||f.nodeType!==3?null:f,f!==null?(c.stateNode=f,We=c,Ge=null,!0):!1;case 13:return f=f.nodeType!==8?null:f,f!==null?(g=_e!==null?{id:De,overflow:de}:null,c.memoizedState={dehydrated:f,treeContext:g,retryLane:1073741824},g=ja(18,null,null,0),g.stateNode=f,g.return=c,c.child=g,We=c,Ge=null,!0):!1;default:return!1}}function gn(c){return(c.mode&1)!==0&&(c.flags&128)===0}function Ct(c){if(Je){var f=Ge;if(f){var g=f;if(!bt(c,f)){if(gn(c))throw Error(t(418));f=Ao(g.nextSibling);var _=We;f&&bt(c,f)?Lt(_,g):(c.flags=c.flags&-4097|2,Je=!1,We=c)}}else{if(gn(c))throw Error(t(418));c.flags=c.flags&-4097|2,Je=!1,We=c}}}function Rn(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;We=c}function Mr(c){if(c!==We)return!1;if(!Je)return Rn(c),Je=!0,!1;var f;if((f=c.tag!==3)&&!(f=c.tag!==5)&&(f=c.type,f=f!=="head"&&f!=="body"&&!xp(c.type,c.memoizedProps)),f&&(f=Ge)){if(gn(c))throw yn(),Error(t(418));for(;f;)Lt(c,f),f=Ao(f.nextSibling)}if(Rn(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,f=0;c;){if(c.nodeType===8){var g=c.data;if(g==="/$"){if(f===0){Ge=Ao(c.nextSibling);break e}f--}else g!=="$"&&g!=="$!"&&g!=="$?"||f++}c=c.nextSibling}Ge=null}}else Ge=We?Ao(c.stateNode.nextSibling):null;return!0}function yn(){for(var c=Ge;c;)c=Ao(c.nextSibling)}function xt(){Ge=We=null,Je=!1}function ct(c){Ze===null?Ze=[c]:Ze.push(c)}var zr=I.ReactCurrentBatchConfig;function ln(c,f,g){if(c=g.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(t(309));var _=g.stateNode}if(!_)throw Error(t(147,c));var R=_,V=""+c;return f!==null&&f.ref!==null&&typeof f.ref=="function"&&f.ref._stringRef===V?f.ref:(f=function(K){var ye=R.refs;K===null?delete ye[V]:ye[V]=K},f._stringRef=V,f)}if(typeof c!="string")throw Error(t(284));if(!g._owner)throw Error(t(290,c))}return c}function In(c,f){throw c=Object.prototype.toString.call(f),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":c))}function wr(c){var f=c._init;return f(c._payload)}function Ii(c){function f(Le,Te){if(c){var Be=Le.deletions;Be===null?(Le.deletions=[Te],Le.flags|=16):Be.push(Te)}}function g(Le,Te){if(!c)return null;for(;Te!==null;)f(Le,Te),Te=Te.sibling;return null}function _(Le,Te){for(Le=new Map;Te!==null;)Te.key!==null?Le.set(Te.key,Te):Le.set(Te.index,Te),Te=Te.sibling;return Le}function R(Le,Te){return Le=Dc(Le,Te),Le.index=0,Le.sibling=null,Le}function V(Le,Te,Be){return Le.index=Be,c?(Be=Le.alternate,Be!==null?(Be=Be.index,Be<Te?(Le.flags|=2,Te):Be):(Le.flags|=2,Te)):(Le.flags|=1048576,Te)}function K(Le){return c&&Le.alternate===null&&(Le.flags|=2),Le}function ye(Le,Te,Be,ut){return Te===null||Te.tag!==6?(Te=oy(Be,Le.mode,ut),Te.return=Le,Te):(Te=R(Te,Be),Te.return=Le,Te)}function Ee(Le,Te,Be,ut){var Bt=Be.type;return Bt===L?ot(Le,Te,Be.props.children,ut,Be.key):Te!==null&&(Te.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===ge&&wr(Bt)===Te.type)?(ut=R(Te,Be.props),ut.ref=ln(Le,Te,Be),ut.return=Le,ut):(ut=Og(Be.type,Be.key,Be.props,null,Le.mode,ut),ut.ref=ln(Le,Te,Be),ut.return=Le,ut)}function Ue(Le,Te,Be,ut){return Te===null||Te.tag!==4||Te.stateNode.containerInfo!==Be.containerInfo||Te.stateNode.implementation!==Be.implementation?(Te=sy(Be,Le.mode,ut),Te.return=Le,Te):(Te=R(Te,Be.children||[]),Te.return=Le,Te)}function ot(Le,Te,Be,ut,Bt){return Te===null||Te.tag!==7?(Te=zh(Be,Le.mode,ut,Bt),Te.return=Le,Te):(Te=R(Te,Be),Te.return=Le,Te)}function st(Le,Te,Be){if(typeof Te=="string"&&Te!==""||typeof Te=="number")return Te=oy(""+Te,Le.mode,Be),Te.return=Le,Te;if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case D:return Be=Og(Te.type,Te.key,Te.props,null,Le.mode,Be),Be.ref=ln(Le,null,Te),Be.return=Le,Be;case U:return Te=sy(Te,Le.mode,Be),Te.return=Le,Te;case ge:var ut=Te._init;return st(Le,ut(Te._payload),Be)}if(ft(Te)||le(Te))return Te=zh(Te,Le.mode,Be,null),Te.return=Le,Te;In(Le,Te)}return null}function it(Le,Te,Be,ut){var Bt=Te!==null?Te.key:null;if(typeof Be=="string"&&Be!==""||typeof Be=="number")return Bt!==null?null:ye(Le,Te,""+Be,ut);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case D:return Be.key===Bt?Ee(Le,Te,Be,ut):null;case U:return Be.key===Bt?Ue(Le,Te,Be,ut):null;case ge:return Bt=Be._init,it(Le,Te,Bt(Be._payload),ut)}if(ft(Be)||le(Be))return Bt!==null?null:ot(Le,Te,Be,ut,null);In(Le,Be)}return null}function mt(Le,Te,Be,ut,Bt){if(typeof ut=="string"&&ut!==""||typeof ut=="number")return Le=Le.get(Be)||null,ye(Te,Le,""+ut,Bt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case D:return Le=Le.get(ut.key===null?Be:ut.key)||null,Ee(Te,Le,ut,Bt);case U:return Le=Le.get(ut.key===null?Be:ut.key)||null,Ue(Te,Le,ut,Bt);case ge:var tn=ut._init;return mt(Le,Te,Be,tn(ut._payload),Bt)}if(ft(ut)||le(ut))return Le=Le.get(Be)||null,ot(Te,Le,ut,Bt,null);In(Te,ut)}return null}function Tt(Le,Te,Be,ut){for(var Bt=null,tn=null,nn=Te,fn=Te=0,lo=null;nn!==null&&fn<Be.length;fn++){nn.index>fn?(lo=nn,nn=null):lo=nn.sibling;var Yn=it(Le,nn,Be[fn],ut);if(Yn===null){nn===null&&(nn=lo);break}c&&nn&&Yn.alternate===null&&f(Le,nn),Te=V(Yn,Te,fn),tn===null?Bt=Yn:tn.sibling=Yn,tn=Yn,nn=lo}if(fn===Be.length)return g(Le,nn),Je&&Ae(Le,fn),Bt;if(nn===null){for(;fn<Be.length;fn++)nn=st(Le,Be[fn],ut),nn!==null&&(Te=V(nn,Te,fn),tn===null?Bt=nn:tn.sibling=nn,tn=nn);return Je&&Ae(Le,fn),Bt}for(nn=_(Le,nn);fn<Be.length;fn++)lo=mt(nn,Le,fn,Be[fn],ut),lo!==null&&(c&&lo.alternate!==null&&nn.delete(lo.key===null?fn:lo.key),Te=V(lo,Te,fn),tn===null?Bt=lo:tn.sibling=lo,tn=lo);return c&&nn.forEach(function(Lc){return f(Le,Lc)}),Je&&Ae(Le,fn),Bt}function Pt(Le,Te,Be,ut){var Bt=le(Be);if(typeof Bt!="function")throw Error(t(150));if(Be=Bt.call(Be),Be==null)throw Error(t(151));for(var tn=Bt=null,nn=Te,fn=Te=0,lo=null,Yn=Be.next();nn!==null&&!Yn.done;fn++,Yn=Be.next()){nn.index>fn?(lo=nn,nn=null):lo=nn.sibling;var Lc=it(Le,nn,Yn.value,ut);if(Lc===null){nn===null&&(nn=lo);break}c&&nn&&Lc.alternate===null&&f(Le,nn),Te=V(Lc,Te,fn),tn===null?Bt=Lc:tn.sibling=Lc,tn=Lc,nn=lo}if(Yn.done)return g(Le,nn),Je&&Ae(Le,fn),Bt;if(nn===null){for(;!Yn.done;fn++,Yn=Be.next())Yn=st(Le,Yn.value,ut),Yn!==null&&(Te=V(Yn,Te,fn),tn===null?Bt=Yn:tn.sibling=Yn,tn=Yn);return Je&&Ae(Le,fn),Bt}for(nn=_(Le,nn);!Yn.done;fn++,Yn=Be.next())Yn=mt(nn,Le,fn,Yn.value,ut),Yn!==null&&(c&&Yn.alternate!==null&&nn.delete(Yn.key===null?fn:Yn.key),Te=V(Yn,Te,fn),tn===null?Bt=Yn:tn.sibling=Yn,tn=Yn);return c&&nn.forEach(function(yD){return f(Le,yD)}),Je&&Ae(Le,fn),Bt}function mi(Le,Te,Be,ut){if(typeof Be=="object"&&Be!==null&&Be.type===L&&Be.key===null&&(Be=Be.props.children),typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case D:e:{for(var Bt=Be.key,tn=Te;tn!==null;){if(tn.key===Bt){if(Bt=Be.type,Bt===L){if(tn.tag===7){g(Le,tn.sibling),Te=R(tn,Be.props.children),Te.return=Le,Le=Te;break e}}else if(tn.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===ge&&wr(Bt)===tn.type){g(Le,tn.sibling),Te=R(tn,Be.props),Te.ref=ln(Le,tn,Be),Te.return=Le,Le=Te;break e}g(Le,tn);break}else f(Le,tn);tn=tn.sibling}Be.type===L?(Te=zh(Be.props.children,Le.mode,ut,Be.key),Te.return=Le,Le=Te):(ut=Og(Be.type,Be.key,Be.props,null,Le.mode,ut),ut.ref=ln(Le,Te,Be),ut.return=Le,Le=ut)}return K(Le);case U:e:{for(tn=Be.key;Te!==null;){if(Te.key===tn)if(Te.tag===4&&Te.stateNode.containerInfo===Be.containerInfo&&Te.stateNode.implementation===Be.implementation){g(Le,Te.sibling),Te=R(Te,Be.children||[]),Te.return=Le,Le=Te;break e}else{g(Le,Te);break}else f(Le,Te);Te=Te.sibling}Te=sy(Be,Le.mode,ut),Te.return=Le,Le=Te}return K(Le);case ge:return tn=Be._init,mi(Le,Te,tn(Be._payload),ut)}if(ft(Be))return Tt(Le,Te,Be,ut);if(le(Be))return Pt(Le,Te,Be,ut);In(Le,Be)}return typeof Be=="string"&&Be!==""||typeof Be=="number"?(Be=""+Be,Te!==null&&Te.tag===6?(g(Le,Te.sibling),Te=R(Te,Be),Te.return=Le,Le=Te):(g(Le,Te),Te=oy(Be,Le.mode,ut),Te.return=Le,Le=Te),K(Le)):g(Le,Te)}return mi}var ei=Ii(!0),Ir=Ii(!1),di=ia(null),Ti=null,Er=null,Ln=null;function Hn(){Ln=Er=Ti=null}function Sr(c){var f=di.current;Zn(di),c._currentValue=f}function Gn(c,f,g){for(;c!==null;){var _=c.alternate;if((c.childLanes&f)!==f?(c.childLanes|=f,_!==null&&(_.childLanes|=f)):_!==null&&(_.childLanes&f)!==f&&(_.childLanes|=f),c===g)break;c=c.return}}function Or(c,f){Ti=c,Ln=Er=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&f)!==0&&(Fs=!0),c.firstContext=null)}function Fr(c){var f=c._currentValue;if(Ln!==c)if(c={context:c,memoizedValue:f,next:null},Er===null){if(Ti===null)throw Error(t(308));Er=c,Ti.dependencies={lanes:0,firstContext:c}}else Er=Er.next=c;return f}var ur=null;function oo(c){ur===null?ur=[c]:ur.push(c)}function rr(c,f,g,_){var R=f.interleaved;return R===null?(g.next=g,oo(f)):(g.next=R.next,R.next=g),f.interleaved=g,lr(c,_)}function lr(c,f){c.lanes|=f;var g=c.alternate;for(g!==null&&(g.lanes|=f),g=c,c=c.return;c!==null;)c.childLanes|=f,g=c.alternate,g!==null&&(g.childLanes|=f),g=c,c=c.return;return g.tag===3?g.stateNode:null}var ti=!1;function ji(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Go(c,f){c=c.updateQueue,f.updateQueue===c&&(f.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function Wr(c,f){return{eventTime:c,lane:f,tag:0,payload:null,callback:null,next:null}}function qr(c,f,g){var _=c.updateQueue;if(_===null)return null;if(_=_.shared,($n&2)!==0){var R=_.pending;return R===null?f.next=f:(f.next=R.next,R.next=f),_.pending=f,lr(c,g)}return R=_.interleaved,R===null?(f.next=f,oo(_)):(f.next=R.next,R.next=f),_.interleaved=f,lr(c,g)}function so(c,f,g){if(f=f.updateQueue,f!==null&&(f=f.shared,(g&4194240)!==0)){var _=f.lanes;_&=c.pendingLanes,g|=_,f.lanes=g,Pu(c,g)}}function cr(c,f){var g=c.updateQueue,_=c.alternate;if(_!==null&&(_=_.updateQueue,g===_)){var R=null,V=null;if(g=g.firstBaseUpdate,g!==null){do{var K={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};V===null?R=V=K:V=V.next=K,g=g.next}while(g!==null);V===null?R=V=f:V=V.next=f}else R=V=f;g={baseState:_.baseState,firstBaseUpdate:R,lastBaseUpdate:V,shared:_.shared,effects:_.effects},c.updateQueue=g;return}c=g.lastBaseUpdate,c===null?g.firstBaseUpdate=f:c.next=f,g.lastBaseUpdate=f}function ao(c,f,g,_){var R=c.updateQueue;ti=!1;var V=R.firstBaseUpdate,K=R.lastBaseUpdate,ye=R.shared.pending;if(ye!==null){R.shared.pending=null;var Ee=ye,Ue=Ee.next;Ee.next=null,K===null?V=Ue:K.next=Ue,K=Ee;var ot=c.alternate;ot!==null&&(ot=ot.updateQueue,ye=ot.lastBaseUpdate,ye!==K&&(ye===null?ot.firstBaseUpdate=Ue:ye.next=Ue,ot.lastBaseUpdate=Ee))}if(V!==null){var st=R.baseState;K=0,ot=Ue=Ee=null,ye=V;do{var it=ye.lane,mt=ye.eventTime;if((_&it)===it){ot!==null&&(ot=ot.next={eventTime:mt,lane:0,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null});e:{var Tt=c,Pt=ye;switch(it=f,mt=g,Pt.tag){case 1:if(Tt=Pt.payload,typeof Tt=="function"){st=Tt.call(mt,st,it);break e}st=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=Pt.payload,it=typeof Tt=="function"?Tt.call(mt,st,it):Tt,it==null)break e;st=ae({},st,it);break e;case 2:ti=!0}}ye.callback!==null&&ye.lane!==0&&(c.flags|=64,it=R.effects,it===null?R.effects=[ye]:it.push(ye))}else mt={eventTime:mt,lane:it,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},ot===null?(Ue=ot=mt,Ee=st):ot=ot.next=mt,K|=it;if(ye=ye.next,ye===null){if(ye=R.shared.pending,ye===null)break;it=ye,ye=it.next,it.next=null,R.lastBaseUpdate=it,R.shared.pending=null}}while(!0);if(ot===null&&(Ee=st),R.baseState=Ee,R.firstBaseUpdate=Ue,R.lastBaseUpdate=ot,f=R.shared.interleaved,f!==null){R=f;do K|=R.lane,R=R.next;while(R!==f)}else V===null&&(R.shared.lanes=0);Bh|=K,c.lanes=K,c.memoizedState=st}}function Os(c,f,g){if(c=f.effects,f.effects=null,c!==null)for(f=0;f<c.length;f++){var _=c[f],R=_.callback;if(R!==null){if(_.callback=null,_=g,typeof R!="function")throw Error(t(191,R));R.call(_)}}}var oa={},ki=ia(oa),Hr=ia(oa),Hu=ia(oa);function au(c){if(c===oa)throw Error(t(174));return c}function Sc(c,f){switch(nr(Hu,f),nr(Hr,c),nr(ki,oa),c=f.nodeType,c){case 9:case 11:f=(f=f.documentElement)?f.namespaceURI:an(null,"");break;default:c=c===8?f.parentNode:f,f=c.namespaceURI||null,c=c.tagName,f=an(f,c)}Zn(ki),nr(ki,f)}function Oa(){Zn(ki),Zn(Hr),Zn(Hu)}function vg(c){au(Hu.current);var f=au(ki.current),g=an(f,c.type);f!==g&&(nr(Hr,c),nr(ki,g))}function Cp(c){Hr.current===c&&(Zn(ki),Zn(Hr))}var xr=ia(0);function sa(c){for(var f=c;f!==null;){if(f.tag===13){var g=f.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var Ip=[];function Tp(){for(var c=0;c<Ip.length;c++)Ip[c]._workInProgressVersionPrimary=null;Ip.length=0}var Of=I.ReactCurrentDispatcher,Ff=I.ReactCurrentBatchConfig,Fa=0,Ar=null,ni=null,Gr=null,Ac=!1,uu=!1,Cc=0,R1=0;function pi(){throw Error(t(321))}function Bf(c,f){if(f===null)return!1;for(var g=0;g<f.length&&g<c.length;g++)if(!Dr(c[g],f[g]))return!1;return!0}function Mh(c,f,g,_,R,V){if(Fa=V,Ar=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,Of.current=c===null||c.memoizedState===null?qP:HP,c=g(_,R),uu){V=0;do{if(uu=!1,Cc=0,25<=V)throw Error(t(301));V+=1,Gr=ni=null,f.updateQueue=null,Of.current=GP,c=g(_,R)}while(uu)}if(Of.current=_g,f=ni!==null&&ni.next!==null,Fa=0,Gr=ni=Ar=null,Ac=!1,f)throw Error(t(300));return c}function Ba(){var c=Cc!==0;return Cc=0,c}function aa(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gr===null?Ar.memoizedState=Gr=c:Gr=Gr.next=c,Gr}function bs(){if(ni===null){var c=Ar.alternate;c=c!==null?c.memoizedState:null}else c=ni.next;var f=Gr===null?Ar.memoizedState:Gr.next;if(f!==null)Gr=f,ni=c;else{if(c===null)throw Error(t(310));ni=c,c={memoizedState:ni.memoizedState,baseState:ni.baseState,baseQueue:ni.baseQueue,queue:ni.queue,next:null},Gr===null?Ar.memoizedState=Gr=c:Gr=Gr.next=c}return Gr}function Oh(c,f){return typeof f=="function"?f(c):f}function Vf(c){var f=bs(),g=f.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=c;var _=ni,R=_.baseQueue,V=g.pending;if(V!==null){if(R!==null){var K=R.next;R.next=V.next,V.next=K}_.baseQueue=R=V,g.pending=null}if(R!==null){V=R.next,_=_.baseState;var ye=K=null,Ee=null,Ue=V;do{var ot=Ue.lane;if((Fa&ot)===ot)Ee!==null&&(Ee=Ee.next={lane:0,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null}),_=Ue.hasEagerState?Ue.eagerState:c(_,Ue.action);else{var st={lane:ot,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null};Ee===null?(ye=Ee=st,K=_):Ee=Ee.next=st,Ar.lanes|=ot,Bh|=ot}Ue=Ue.next}while(Ue!==null&&Ue!==V);Ee===null?K=_:Ee.next=ye,Dr(_,f.memoizedState)||(Fs=!0),f.memoizedState=_,f.baseState=K,f.baseQueue=Ee,g.lastRenderedState=_}if(c=g.interleaved,c!==null){R=c;do V=R.lane,Ar.lanes|=V,Bh|=V,R=R.next;while(R!==c)}else R===null&&(g.lanes=0);return[f.memoizedState,g.dispatch]}function Gu(c){var f=bs(),g=f.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=c;var _=g.dispatch,R=g.pending,V=f.memoizedState;if(R!==null){g.pending=null;var K=R=R.next;do V=c(V,K.action),K=K.next;while(K!==R);Dr(V,f.memoizedState)||(Fs=!0),f.memoizedState=V,f.baseQueue===null&&(f.baseState=V),g.lastRenderedState=V}return[V,_]}function yg(){}function kp(c,f){var g=Ar,_=bs(),R=f(),V=!Dr(_.memoizedState,R);if(V&&(_.memoizedState=R,Fs=!0),_=_.queue,zf(bg.bind(null,g,_,c),[c]),_.getSnapshot!==f||V||Gr!==null&&Gr.memoizedState.tag&1){if(g.flags|=2048,xs(9,Np.bind(null,g,_,R,f),void 0,null),uo===null)throw Error(t(349));(Fa&30)!==0||wg(g,f,R)}return R}function wg(c,f,g){c.flags|=16384,c={getSnapshot:f,value:g},f=Ar.updateQueue,f===null?(f={lastEffect:null,stores:null},Ar.updateQueue=f,f.stores=[c]):(g=f.stores,g===null?f.stores=[c]:g.push(c))}function Np(c,f,g,_){f.value=g,f.getSnapshot=_,Ic(f)&&jf(c)}function bg(c,f,g){return g(function(){Ic(f)&&jf(c)})}function Ic(c){var f=c.getSnapshot;c=c.value;try{var g=f();return!Dr(c,g)}catch{return!0}}function jf(c){var f=lr(c,1);f!==null&&du(f,c,1,-1)}function Fh(c){var f=aa();return typeof c=="function"&&(c=c()),f.memoizedState=f.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oh,lastRenderedState:c},f.queue=c,c=c.dispatch=WP.bind(null,Ar,c),[f.memoizedState,c]}function xs(c,f,g,_){return c={tag:c,create:f,destroy:g,deps:_,next:null},f=Ar.updateQueue,f===null?(f={lastEffect:null,stores:null},Ar.updateQueue=f,f.lastEffect=c.next=c):(g=f.lastEffect,g===null?f.lastEffect=c.next=c:(_=g.next,g.next=c,c.next=_,f.lastEffect=c)),c}function lu(){return bs().memoizedState}function ua(c,f,g,_){var R=aa();Ar.flags|=c,R.memoizedState=xs(1|f,g,void 0,_===void 0?null:_)}function jl(c,f,g,_){var R=bs();_=_===void 0?null:_;var V=void 0;if(ni!==null){var K=ni.memoizedState;if(V=K.destroy,_!==null&&Bf(_,K.deps)){R.memoizedState=xs(f,g,V,_);return}}Ar.flags|=c,R.memoizedState=xs(1|f,g,V,_)}function Uf(c,f){return ua(8390656,8,c,f)}function zf(c,f){return jl(2048,8,c,f)}function xg(c,f){return jl(4,2,c,f)}function Wf(c,f){return jl(4,4,c,f)}function qf(c,f){if(typeof f=="function")return c=c(),f(c),function(){f(null)};if(f!=null)return c=c(),f.current=c,function(){f.current=null}}function T_(c,f,g){return g=g!=null?g.concat([c]):null,jl(4,4,qf.bind(null,f,c),g)}function P1(){}function k_(c,f){var g=bs();f=f===void 0?null:f;var _=g.memoizedState;return _!==null&&f!==null&&Bf(f,_[1])?_[0]:(g.memoizedState=[c,f],c)}function N_(c,f){var g=bs();f=f===void 0?null:f;var _=g.memoizedState;return _!==null&&f!==null&&Bf(f,_[1])?_[0]:(c=c(),g.memoizedState=[c,f],c)}function R_(c,f,g){return(Fa&21)===0?(c.baseState&&(c.baseState=!1,Fs=!0),c.memoizedState=g):(Dr(g,f)||(g=Ru(),Ar.lanes|=g,Bh|=g,c.baseState=!0),f)}function UP(c,f){var g=An;An=g!==0&&4>g?g:4,c(!0);var _=Ff.transition;Ff.transition={};try{c(!1),f()}finally{An=g,Ff.transition=_}}function P_(){return bs().memoizedState}function zP(c,f,g){var _=Rc(c);if(g={lane:_,action:g,hasEagerState:!1,eagerState:null,next:null},D_(c))L_(f,g);else if(g=rr(c,f,g,_),g!==null){var R=Es();du(g,c,_,R),M_(g,f,_)}}function WP(c,f,g){var _=Rc(c),R={lane:_,action:g,hasEagerState:!1,eagerState:null,next:null};if(D_(c))L_(f,R);else{var V=c.alternate;if(c.lanes===0&&(V===null||V.lanes===0)&&(V=f.lastRenderedReducer,V!==null))try{var K=f.lastRenderedState,ye=V(K,g);if(R.hasEagerState=!0,R.eagerState=ye,Dr(ye,K)){var Ee=f.interleaved;Ee===null?(R.next=R,oo(f)):(R.next=Ee.next,Ee.next=R),f.interleaved=R;return}}catch{}finally{}g=rr(c,f,R,_),g!==null&&(R=Es(),du(g,c,_,R),M_(g,f,_))}}function D_(c){var f=c.alternate;return c===Ar||f!==null&&f===Ar}function L_(c,f){uu=Ac=!0;var g=c.pending;g===null?f.next=f:(f.next=g.next,g.next=f),c.pending=f}function M_(c,f,g){if((g&4194240)!==0){var _=f.lanes;_&=c.pendingLanes,g|=_,f.lanes=g,Pu(c,g)}}var _g={readContext:Fr,useCallback:pi,useContext:pi,useEffect:pi,useImperativeHandle:pi,useInsertionEffect:pi,useLayoutEffect:pi,useMemo:pi,useReducer:pi,useRef:pi,useState:pi,useDebugValue:pi,useDeferredValue:pi,useTransition:pi,useMutableSource:pi,useSyncExternalStore:pi,useId:pi,unstable_isNewReconciler:!1},qP={readContext:Fr,useCallback:function(c,f){return aa().memoizedState=[c,f===void 0?null:f],c},useContext:Fr,useEffect:Uf,useImperativeHandle:function(c,f,g){return g=g!=null?g.concat([c]):null,ua(4194308,4,qf.bind(null,f,c),g)},useLayoutEffect:function(c,f){return ua(4194308,4,c,f)},useInsertionEffect:function(c,f){return ua(4,2,c,f)},useMemo:function(c,f){var g=aa();return f=f===void 0?null:f,c=c(),g.memoizedState=[c,f],c},useReducer:function(c,f,g){var _=aa();return f=g!==void 0?g(f):f,_.memoizedState=_.baseState=f,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:f},_.queue=c,c=c.dispatch=zP.bind(null,Ar,c),[_.memoizedState,c]},useRef:function(c){var f=aa();return c={current:c},f.memoizedState=c},useState:Fh,useDebugValue:P1,useDeferredValue:function(c){return aa().memoizedState=c},useTransition:function(){var c=Fh(!1),f=c[0];return c=UP.bind(null,c[1]),aa().memoizedState=c,[f,c]},useMutableSource:function(){},useSyncExternalStore:function(c,f,g){var _=Ar,R=aa();if(Je){if(g===void 0)throw Error(t(407));g=g()}else{if(g=f(),uo===null)throw Error(t(349));(Fa&30)!==0||wg(_,f,g)}R.memoizedState=g;var V={value:g,getSnapshot:f};return R.queue=V,Uf(bg.bind(null,_,V,c),[c]),_.flags|=2048,xs(9,Np.bind(null,_,V,g,f),void 0,null),g},useId:function(){var c=aa(),f=uo.identifierPrefix;if(Je){var g=de,_=De;g=(_&~(1<<32-Pr(_)-1)).toString(32)+g,f=":"+f+"R"+g,g=Cc++,0<g&&(f+="H"+g.toString(32)),f+=":"}else g=R1++,f=":"+f+"r"+g.toString(32)+":";return c.memoizedState=f},unstable_isNewReconciler:!1},HP={readContext:Fr,useCallback:k_,useContext:Fr,useEffect:zf,useImperativeHandle:T_,useInsertionEffect:xg,useLayoutEffect:Wf,useMemo:N_,useReducer:Vf,useRef:lu,useState:function(){return Vf(Oh)},useDebugValue:P1,useDeferredValue:function(c){var f=bs();return R_(f,ni.memoizedState,c)},useTransition:function(){var c=Vf(Oh)[0],f=bs().memoizedState;return[c,f]},useMutableSource:yg,useSyncExternalStore:kp,useId:P_,unstable_isNewReconciler:!1},GP={readContext:Fr,useCallback:k_,useContext:Fr,useEffect:zf,useImperativeHandle:T_,useInsertionEffect:xg,useLayoutEffect:Wf,useMemo:N_,useReducer:Gu,useRef:lu,useState:function(){return Gu(Oh)},useDebugValue:P1,useDeferredValue:function(c){var f=bs();return ni===null?f.memoizedState=c:R_(f,ni.memoizedState,c)},useTransition:function(){var c=Gu(Oh)[0],f=bs().memoizedState;return[c,f]},useMutableSource:yg,useSyncExternalStore:kp,useId:P_,unstable_isNewReconciler:!1};function cu(c,f){if(c&&c.defaultProps){f=ae({},f),c=c.defaultProps;for(var g in c)f[g]===void 0&&(f[g]=c[g]);return f}return f}function D1(c,f,g,_){f=c.memoizedState,g=g(_,f),g=g==null?f:ae({},f,g),c.memoizedState=g,c.lanes===0&&(c.updateQueue.baseState=g)}var Eg={isMounted:function(c){return(c=c._reactInternals)?Vr(c)===c:!1},enqueueSetState:function(c,f,g){c=c._reactInternals;var _=Es(),R=Rc(c),V=Wr(_,R);V.payload=f,g!=null&&(V.callback=g),f=qr(c,V,R),f!==null&&(du(f,c,R,_),so(f,c,R))},enqueueReplaceState:function(c,f,g){c=c._reactInternals;var _=Es(),R=Rc(c),V=Wr(_,R);V.tag=1,V.payload=f,g!=null&&(V.callback=g),f=qr(c,V,R),f!==null&&(du(f,c,R,_),so(f,c,R))},enqueueForceUpdate:function(c,f){c=c._reactInternals;var g=Es(),_=Rc(c),R=Wr(g,_);R.tag=2,f!=null&&(R.callback=f),f=qr(c,R,_),f!==null&&(du(f,c,_,g),so(f,c,_))}};function O_(c,f,g,_,R,V,K){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(_,V,K):f.prototype&&f.prototype.isPureReactComponent?!Uo(g,_)||!Uo(R,V):!0}function F_(c,f,g){var _=!1,R=qu,V=f.contextType;return typeof V=="object"&&V!==null?V=Fr(V):(R=Ho(f)?Bl:Vi.current,_=f.contextTypes,V=(_=_!=null)?Ec(c,R):qu),f=new f(g,V),c.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=Eg,c.stateNode=f,f._reactInternals=c,_&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=R,c.__reactInternalMemoizedMaskedChildContext=V),f}function B_(c,f,g,_){c=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(g,_),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(g,_),f.state!==c&&Eg.enqueueReplaceState(f,f.state,null)}function L1(c,f,g,_){var R=c.stateNode;R.props=g,R.state=c.memoizedState,R.refs={},ji(c);var V=f.contextType;typeof V=="object"&&V!==null?R.context=Fr(V):(V=Ho(f)?Bl:Vi.current,R.context=Ec(c,V)),R.state=c.memoizedState,V=f.getDerivedStateFromProps,typeof V=="function"&&(D1(c,f,V,g),R.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(f=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),f!==R.state&&Eg.enqueueReplaceState(R,R.state,null),ao(c,g,R,_),R.state=c.memoizedState),typeof R.componentDidMount=="function"&&(c.flags|=4194308)}function Hf(c,f){try{var g="",_=f;do g+=fe(_),_=_.return;while(_);var R=g}catch(V){R=`
Error generating stack: `+V.message+`
`+V.stack}return{value:c,source:f,stack:R,digest:null}}function M1(c,f,g){return{value:c,source:null,stack:g??null,digest:f??null}}function O1(c,f){try{console.error(f.value)}catch(g){setTimeout(function(){throw g})}}var $P=typeof WeakMap=="function"?WeakMap:Map;function V_(c,f,g){g=Wr(-1,g),g.tag=3,g.payload={element:null};var _=f.value;return g.callback=function(){Ng||(Ng=!0,Q1=_),O1(c,f)},g}function j_(c,f,g){g=Wr(-1,g),g.tag=3;var _=c.type.getDerivedStateFromError;if(typeof _=="function"){var R=f.value;g.payload=function(){return _(R)},g.callback=function(){O1(c,f)}}var V=c.stateNode;return V!==null&&typeof V.componentDidCatch=="function"&&(g.callback=function(){O1(c,f),typeof _!="function"&&(kc===null?kc=new Set([this]):kc.add(this));var K=f.stack;this.componentDidCatch(f.value,{componentStack:K!==null?K:""})}),g}function U_(c,f,g){var _=c.pingCache;if(_===null){_=c.pingCache=new $P;var R=new Set;_.set(f,R)}else R=_.get(f),R===void 0&&(R=new Set,_.set(f,R));R.has(g)||(R.add(g),c=aD.bind(null,c,f,g),f.then(c,c))}function z_(c){do{var f;if((f=c.tag===13)&&(f=c.memoizedState,f=f!==null?f.dehydrated!==null:!0),f)return c;c=c.return}while(c!==null);return null}function W_(c,f,g,_,R){return(c.mode&1)===0?(c===f?c.flags|=65536:(c.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(f=Wr(-1,1),f.tag=2,qr(g,f,1))),g.lanes|=1),c):(c.flags|=65536,c.lanes=R,c)}var KP=I.ReactCurrentOwner,Fs=!1;function _s(c,f,g,_){f.child=c===null?Ir(f,null,g,_):ei(f,c.child,g,_)}function q_(c,f,g,_,R){g=g.render;var V=f.ref;return Or(f,R),_=Mh(c,f,g,_,V,R),g=Ba(),c!==null&&!Fs?(f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~R,Ul(c,f,R)):(Je&&g&&Ke(f),f.flags|=1,_s(c,f,_,R),f.child)}function H_(c,f,g,_,R){if(c===null){var V=g.type;return typeof V=="function"&&!iy(V)&&V.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(f.tag=15,f.type=V,G_(c,f,V,_,R)):(c=Og(g.type,null,_,f,f.mode,R),c.ref=f.ref,c.return=f,f.child=c)}if(V=c.child,(c.lanes&R)===0){var K=V.memoizedProps;if(g=g.compare,g=g!==null?g:Uo,g(K,_)&&c.ref===f.ref)return Ul(c,f,R)}return f.flags|=1,c=Dc(V,_),c.ref=f.ref,c.return=f,f.child=c}function G_(c,f,g,_,R){if(c!==null){var V=c.memoizedProps;if(Uo(V,_)&&c.ref===f.ref)if(Fs=!1,f.pendingProps=_=V,(c.lanes&R)!==0)(c.flags&131072)!==0&&(Fs=!0);else return f.lanes=c.lanes,Ul(c,f,R)}return F1(c,f,g,_,R)}function $_(c,f,g){var _=f.pendingProps,R=_.children,V=c!==null?c.memoizedState:null;if(_.mode==="hidden")if((f.mode&1)===0)f.memoizedState={baseLanes:0,cachePool:null,transitions:null},nr($f,la),la|=g;else{if((g&1073741824)===0)return c=V!==null?V.baseLanes|g:g,f.lanes=f.childLanes=1073741824,f.memoizedState={baseLanes:c,cachePool:null,transitions:null},f.updateQueue=null,nr($f,la),la|=c,null;f.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=V!==null?V.baseLanes:g,nr($f,la),la|=_}else V!==null?(_=V.baseLanes|g,f.memoizedState=null):_=g,nr($f,la),la|=_;return _s(c,f,R,g),f.child}function K_(c,f){var g=f.ref;(c===null&&g!==null||c!==null&&c.ref!==g)&&(f.flags|=512,f.flags|=2097152)}function F1(c,f,g,_,R){var V=Ho(g)?Bl:Vi.current;return V=Ec(f,V),Or(f,R),g=Mh(c,f,g,_,V,R),_=Ba(),c!==null&&!Fs?(f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~R,Ul(c,f,R)):(Je&&_&&Ke(f),f.flags|=1,_s(c,f,g,R),f.child)}function X_(c,f,g,_,R){if(Ho(g)){var V=!0;Vl(f)}else V=!1;if(Or(f,R),f.stateNode===null)Ag(c,f),F_(f,g,_),L1(f,g,_,R),_=!0;else if(c===null){var K=f.stateNode,ye=f.memoizedProps;K.props=ye;var Ee=K.context,Ue=g.contextType;typeof Ue=="object"&&Ue!==null?Ue=Fr(Ue):(Ue=Ho(g)?Bl:Vi.current,Ue=Ec(f,Ue));var ot=g.getDerivedStateFromProps,st=typeof ot=="function"||typeof K.getSnapshotBeforeUpdate=="function";st||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ye!==_||Ee!==Ue)&&B_(f,K,_,Ue),ti=!1;var it=f.memoizedState;K.state=it,ao(f,_,K,R),Ee=f.memoizedState,ye!==_||it!==Ee||qo.current||ti?(typeof ot=="function"&&(D1(f,g,ot,_),Ee=f.memoizedState),(ye=ti||O_(f,g,ye,_,it,Ee,Ue))?(st||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount()),typeof K.componentDidMount=="function"&&(f.flags|=4194308)):(typeof K.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=_,f.memoizedState=Ee),K.props=_,K.state=Ee,K.context=Ue,_=ye):(typeof K.componentDidMount=="function"&&(f.flags|=4194308),_=!1)}else{K=f.stateNode,Go(c,f),ye=f.memoizedProps,Ue=f.type===f.elementType?ye:cu(f.type,ye),K.props=Ue,st=f.pendingProps,it=K.context,Ee=g.contextType,typeof Ee=="object"&&Ee!==null?Ee=Fr(Ee):(Ee=Ho(g)?Bl:Vi.current,Ee=Ec(f,Ee));var mt=g.getDerivedStateFromProps;(ot=typeof mt=="function"||typeof K.getSnapshotBeforeUpdate=="function")||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ye!==st||it!==Ee)&&B_(f,K,_,Ee),ti=!1,it=f.memoizedState,K.state=it,ao(f,_,K,R);var Tt=f.memoizedState;ye!==st||it!==Tt||qo.current||ti?(typeof mt=="function"&&(D1(f,g,mt,_),Tt=f.memoizedState),(Ue=ti||O_(f,g,Ue,_,it,Tt,Ee)||!1)?(ot||typeof K.UNSAFE_componentWillUpdate!="function"&&typeof K.componentWillUpdate!="function"||(typeof K.componentWillUpdate=="function"&&K.componentWillUpdate(_,Tt,Ee),typeof K.UNSAFE_componentWillUpdate=="function"&&K.UNSAFE_componentWillUpdate(_,Tt,Ee)),typeof K.componentDidUpdate=="function"&&(f.flags|=4),typeof K.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof K.componentDidUpdate!="function"||ye===c.memoizedProps&&it===c.memoizedState||(f.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ye===c.memoizedProps&&it===c.memoizedState||(f.flags|=1024),f.memoizedProps=_,f.memoizedState=Tt),K.props=_,K.state=Tt,K.context=Ee,_=Ue):(typeof K.componentDidUpdate!="function"||ye===c.memoizedProps&&it===c.memoizedState||(f.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ye===c.memoizedProps&&it===c.memoizedState||(f.flags|=1024),_=!1)}return B1(c,f,g,_,V,R)}function B1(c,f,g,_,R,V){K_(c,f);var K=(f.flags&128)!==0;if(!_&&!K)return R&&gg(f,g,!1),Ul(c,f,V);_=f.stateNode,KP.current=f;var ye=K&&typeof g.getDerivedStateFromError!="function"?null:_.render();return f.flags|=1,c!==null&&K?(f.child=ei(f,c.child,null,V),f.child=ei(f,null,ye,V)):_s(c,f,ye,V),f.memoizedState=_.state,R&&gg(f,g,!0),f.child}function Y_(c){var f=c.stateNode;f.pendingContext?mg(c,f.pendingContext,f.pendingContext!==f.context):f.context&&mg(c,f.context,!1),Sc(c,f.containerInfo)}function Q_(c,f,g,_,R){return xt(),ct(R),f.flags|=256,_s(c,f,g,_),f.child}var V1={dehydrated:null,treeContext:null,retryLane:0};function j1(c){return{baseLanes:c,cachePool:null,transitions:null}}function J_(c,f,g){var _=f.pendingProps,R=xr.current,V=!1,K=(f.flags&128)!==0,ye;if((ye=K)||(ye=c!==null&&c.memoizedState===null?!1:(R&2)!==0),ye?(V=!0,f.flags&=-129):(c===null||c.memoizedState!==null)&&(R|=1),nr(xr,R&1),c===null)return Ct(f),c=f.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((f.mode&1)===0?f.lanes=1:c.data==="$!"?f.lanes=8:f.lanes=1073741824,null):(K=_.children,c=_.fallback,V?(_=f.mode,V=f.child,K={mode:"hidden",children:K},(_&1)===0&&V!==null?(V.childLanes=0,V.pendingProps=K):V=Fg(K,_,0,null),c=zh(c,_,g,null),V.return=f,c.return=f,V.sibling=c,f.child=V,f.child.memoizedState=j1(g),f.memoizedState=V1,c):U1(f,K));if(R=c.memoizedState,R!==null&&(ye=R.dehydrated,ye!==null))return XP(c,f,K,_,ye,R,g);if(V){V=_.fallback,K=f.mode,R=c.child,ye=R.sibling;var Ee={mode:"hidden",children:_.children};return(K&1)===0&&f.child!==R?(_=f.child,_.childLanes=0,_.pendingProps=Ee,f.deletions=null):(_=Dc(R,Ee),_.subtreeFlags=R.subtreeFlags&14680064),ye!==null?V=Dc(ye,V):(V=zh(V,K,g,null),V.flags|=2),V.return=f,_.return=f,_.sibling=V,f.child=_,_=V,V=f.child,K=c.child.memoizedState,K=K===null?j1(g):{baseLanes:K.baseLanes|g,cachePool:null,transitions:K.transitions},V.memoizedState=K,V.childLanes=c.childLanes&~g,f.memoizedState=V1,_}return V=c.child,c=V.sibling,_=Dc(V,{mode:"visible",children:_.children}),(f.mode&1)===0&&(_.lanes=g),_.return=f,_.sibling=null,c!==null&&(g=f.deletions,g===null?(f.deletions=[c],f.flags|=16):g.push(c)),f.child=_,f.memoizedState=null,_}function U1(c,f){return f=Fg({mode:"visible",children:f},c.mode,0,null),f.return=c,c.child=f}function Sg(c,f,g,_){return _!==null&&ct(_),ei(f,c.child,null,g),c=U1(f,f.pendingProps.children),c.flags|=2,f.memoizedState=null,c}function XP(c,f,g,_,R,V,K){if(g)return f.flags&256?(f.flags&=-257,_=M1(Error(t(422))),Sg(c,f,K,_)):f.memoizedState!==null?(f.child=c.child,f.flags|=128,null):(V=_.fallback,R=f.mode,_=Fg({mode:"visible",children:_.children},R,0,null),V=zh(V,R,K,null),V.flags|=2,_.return=f,V.return=f,_.sibling=V,f.child=_,(f.mode&1)!==0&&ei(f,c.child,null,K),f.child.memoizedState=j1(K),f.memoizedState=V1,V);if((f.mode&1)===0)return Sg(c,f,K,null);if(R.data==="$!"){if(_=R.nextSibling&&R.nextSibling.dataset,_)var ye=_.dgst;return _=ye,V=Error(t(419)),_=M1(V,_,void 0),Sg(c,f,K,_)}if(ye=(K&c.childLanes)!==0,Fs||ye){if(_=uo,_!==null){switch(K&-K){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(_.suspendedLanes|K))!==0?0:R,R!==0&&R!==V.retryLane&&(V.retryLane=R,lr(c,R),du(_,c,R,-1))}return ry(),_=M1(Error(t(421))),Sg(c,f,K,_)}return R.data==="$?"?(f.flags|=128,f.child=c.child,f=uD.bind(null,c),R._reactRetry=f,null):(c=V.treeContext,Ge=Ao(R.nextSibling),We=f,Je=!0,Ze=null,c!==null&&(ie[ce++]=De,ie[ce++]=de,ie[ce++]=_e,De=c.id,de=c.overflow,_e=f),f=U1(f,_.children),f.flags|=4096,f)}function Z_(c,f,g){c.lanes|=f;var _=c.alternate;_!==null&&(_.lanes|=f),Gn(c.return,f,g)}function z1(c,f,g,_,R){var V=c.memoizedState;V===null?c.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:_,tail:g,tailMode:R}:(V.isBackwards=f,V.rendering=null,V.renderingStartTime=0,V.last=_,V.tail=g,V.tailMode=R)}function e5(c,f,g){var _=f.pendingProps,R=_.revealOrder,V=_.tail;if(_s(c,f,_.children,g),_=xr.current,(_&2)!==0)_=_&1|2,f.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=f.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Z_(c,g,f);else if(c.tag===19)Z_(c,g,f);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===f)break e;for(;c.sibling===null;){if(c.return===null||c.return===f)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}_&=1}if(nr(xr,_),(f.mode&1)===0)f.memoizedState=null;else switch(R){case"forwards":for(g=f.child,R=null;g!==null;)c=g.alternate,c!==null&&sa(c)===null&&(R=g),g=g.sibling;g=R,g===null?(R=f.child,f.child=null):(R=g.sibling,g.sibling=null),z1(f,!1,R,g,V);break;case"backwards":for(g=null,R=f.child,f.child=null;R!==null;){if(c=R.alternate,c!==null&&sa(c)===null){f.child=R;break}c=R.sibling,R.sibling=g,g=R,R=c}z1(f,!0,g,null,V);break;case"together":z1(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Ag(c,f){(f.mode&1)===0&&c!==null&&(c.alternate=null,f.alternate=null,f.flags|=2)}function Ul(c,f,g){if(c!==null&&(f.dependencies=c.dependencies),Bh|=f.lanes,(g&f.childLanes)===0)return null;if(c!==null&&f.child!==c.child)throw Error(t(153));if(f.child!==null){for(c=f.child,g=Dc(c,c.pendingProps),f.child=g,g.return=f;c.sibling!==null;)c=c.sibling,g=g.sibling=Dc(c,c.pendingProps),g.return=f;g.sibling=null}return f.child}function YP(c,f,g){switch(f.tag){case 3:Y_(f),xt();break;case 5:vg(f);break;case 1:Ho(f.type)&&Vl(f);break;case 4:Sc(f,f.stateNode.containerInfo);break;case 10:var _=f.type._context,R=f.memoizedProps.value;nr(di,_._currentValue),_._currentValue=R;break;case 13:if(_=f.memoizedState,_!==null)return _.dehydrated!==null?(nr(xr,xr.current&1),f.flags|=128,null):(g&f.child.childLanes)!==0?J_(c,f,g):(nr(xr,xr.current&1),c=Ul(c,f,g),c!==null?c.sibling:null);nr(xr,xr.current&1);break;case 19:if(_=(g&f.childLanes)!==0,(c.flags&128)!==0){if(_)return e5(c,f,g);f.flags|=128}if(R=f.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),nr(xr,xr.current),_)break;return null;case 22:case 23:return f.lanes=0,$_(c,f,g)}return Ul(c,f,g)}var t5,W1,n5,r5;t5=function(c,f){for(var g=f.child;g!==null;){if(g.tag===5||g.tag===6)c.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},W1=function(){},n5=function(c,f,g,_){var R=c.memoizedProps;if(R!==_){c=f.stateNode,au(ki.current);var V=null;switch(g){case"input":R=Qe(c,R),_=Qe(c,_),V=[];break;case"select":R=ae({},R,{value:void 0}),_=ae({},_,{value:void 0}),V=[];break;case"textarea":R=Et(c,R),_=Et(c,_),V=[];break;default:typeof R.onClick!="function"&&typeof _.onClick=="function"&&(c.onclick=bc)}On(g,_);var K;g=null;for(Ue in R)if(!_.hasOwnProperty(Ue)&&R.hasOwnProperty(Ue)&&R[Ue]!=null)if(Ue==="style"){var ye=R[Ue];for(K in ye)ye.hasOwnProperty(K)&&(g||(g={}),g[K]="")}else Ue!=="dangerouslySetInnerHTML"&&Ue!=="children"&&Ue!=="suppressContentEditableWarning"&&Ue!=="suppressHydrationWarning"&&Ue!=="autoFocus"&&(i.hasOwnProperty(Ue)?V||(V=[]):(V=V||[]).push(Ue,null));for(Ue in _){var Ee=_[Ue];if(ye=R!=null?R[Ue]:void 0,_.hasOwnProperty(Ue)&&Ee!==ye&&(Ee!=null||ye!=null))if(Ue==="style")if(ye){for(K in ye)!ye.hasOwnProperty(K)||Ee&&Ee.hasOwnProperty(K)||(g||(g={}),g[K]="");for(K in Ee)Ee.hasOwnProperty(K)&&ye[K]!==Ee[K]&&(g||(g={}),g[K]=Ee[K])}else g||(V||(V=[]),V.push(Ue,g)),g=Ee;else Ue==="dangerouslySetInnerHTML"?(Ee=Ee?Ee.__html:void 0,ye=ye?ye.__html:void 0,Ee!=null&&ye!==Ee&&(V=V||[]).push(Ue,Ee)):Ue==="children"?typeof Ee!="string"&&typeof Ee!="number"||(V=V||[]).push(Ue,""+Ee):Ue!=="suppressContentEditableWarning"&&Ue!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ue)?(Ee!=null&&Ue==="onScroll"&&ar("scroll",c),V||ye===Ee||(V=[])):(V=V||[]).push(Ue,Ee))}g&&(V=V||[]).push("style",g);var Ue=V;(f.updateQueue=Ue)&&(f.flags|=4)}},r5=function(c,f,g,_){g!==_&&(f.flags|=4)};function Rp(c,f){if(!Je)switch(c.tailMode){case"hidden":f=c.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?c.tail=null:g.sibling=null;break;case"collapsed":g=c.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?f||c.tail===null?c.tail=null:c.tail.sibling=null:_.sibling=null}}function $o(c){var f=c.alternate!==null&&c.alternate.child===c.child,g=0,_=0;if(f)for(var R=c.child;R!==null;)g|=R.lanes|R.childLanes,_|=R.subtreeFlags&14680064,_|=R.flags&14680064,R.return=c,R=R.sibling;else for(R=c.child;R!==null;)g|=R.lanes|R.childLanes,_|=R.subtreeFlags,_|=R.flags,R.return=c,R=R.sibling;return c.subtreeFlags|=_,c.childLanes=g,f}function QP(c,f,g){var _=f.pendingProps;switch(Me(f),f.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $o(f),null;case 1:return Ho(f.type)&&Mf(),$o(f),null;case 3:return _=f.stateNode,Oa(),Zn(qo),Zn(Vi),Tp(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(c===null||c.child===null)&&(Mr(f)?f.flags|=4:c===null||c.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Ze!==null&&(ey(Ze),Ze=null))),W1(c,f),$o(f),null;case 5:Cp(f);var R=au(Hu.current);if(g=f.type,c!==null&&f.stateNode!=null)n5(c,f,g,_,R),c.ref!==f.ref&&(f.flags|=512,f.flags|=2097152);else{if(!_){if(f.stateNode===null)throw Error(t(166));return $o(f),null}if(c=au(ki.current),Mr(f)){_=f.stateNode,g=f.type;var V=f.memoizedProps;switch(_[Ma]=f,_[xc]=V,c=(f.mode&1)!==0,g){case"dialog":ar("cancel",_),ar("close",_);break;case"iframe":case"object":case"embed":ar("load",_);break;case"video":case"audio":for(R=0;R<zu.length;R++)ar(zu[R],_);break;case"source":ar("error",_);break;case"img":case"image":case"link":ar("error",_),ar("load",_);break;case"details":ar("toggle",_);break;case"input":te(_,V),ar("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!V.multiple},ar("invalid",_);break;case"textarea":pt(_,V),ar("invalid",_)}On(g,V),R=null;for(var K in V)if(V.hasOwnProperty(K)){var ye=V[K];K==="children"?typeof ye=="string"?_.textContent!==ye&&(V.suppressHydrationWarning!==!0&&Lf(_.textContent,ye,c),R=["children",ye]):typeof ye=="number"&&_.textContent!==""+ye&&(V.suppressHydrationWarning!==!0&&Lf(_.textContent,ye,c),R=["children",""+ye]):i.hasOwnProperty(K)&&ye!=null&&K==="onScroll"&&ar("scroll",_)}switch(g){case"input":qe(_),gt(_,V,!0);break;case"textarea":qe(_),$t(_);break;case"select":case"option":break;default:typeof V.onClick=="function"&&(_.onclick=bc)}_=R,f.updateQueue=_,_!==null&&(f.flags|=4)}else{K=R.nodeType===9?R:R.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Qt(g)),c==="http://www.w3.org/1999/xhtml"?g==="script"?(c=K.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof _.is=="string"?c=K.createElement(g,{is:_.is}):(c=K.createElement(g),g==="select"&&(K=c,_.multiple?K.multiple=!0:_.size&&(K.size=_.size))):c=K.createElementNS(c,g),c[Ma]=f,c[xc]=_,t5(c,f,!1,!1),f.stateNode=c;e:{switch(K=Ot(g,_),g){case"dialog":ar("cancel",c),ar("close",c),R=_;break;case"iframe":case"object":case"embed":ar("load",c),R=_;break;case"video":case"audio":for(R=0;R<zu.length;R++)ar(zu[R],c);R=_;break;case"source":ar("error",c),R=_;break;case"img":case"image":case"link":ar("error",c),ar("load",c),R=_;break;case"details":ar("toggle",c),R=_;break;case"input":te(c,_),R=Qe(c,_),ar("invalid",c);break;case"option":R=_;break;case"select":c._wrapperState={wasMultiple:!!_.multiple},R=ae({},_,{value:void 0}),ar("invalid",c);break;case"textarea":pt(c,_),R=Et(c,_),ar("invalid",c);break;default:R=_}On(g,R),ye=R;for(V in ye)if(ye.hasOwnProperty(V)){var Ee=ye[V];V==="style"?rn(c,Ee):V==="dangerouslySetInnerHTML"?(Ee=Ee?Ee.__html:void 0,Ee!=null&&vt(c,Ee)):V==="children"?typeof Ee=="string"?(g!=="textarea"||Ee!=="")&&en(c,Ee):typeof Ee=="number"&&en(c,""+Ee):V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&V!=="autoFocus"&&(i.hasOwnProperty(V)?Ee!=null&&V==="onScroll"&&ar("scroll",c):Ee!=null&&P(c,V,Ee,K))}switch(g){case"input":qe(c),gt(c,_,!1);break;case"textarea":qe(c),$t(c);break;case"option":_.value!=null&&c.setAttribute("value",""+Se(_.value));break;case"select":c.multiple=!!_.multiple,V=_.value,V!=null?lt(c,!!_.multiple,V,!1):_.defaultValue!=null&&lt(c,!!_.multiple,_.defaultValue,!0);break;default:typeof R.onClick=="function"&&(c.onclick=bc)}switch(g){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(f.flags|=4)}f.ref!==null&&(f.flags|=512,f.flags|=2097152)}return $o(f),null;case 6:if(c&&f.stateNode!=null)r5(c,f,c.memoizedProps,_);else{if(typeof _!="string"&&f.stateNode===null)throw Error(t(166));if(g=au(Hu.current),au(ki.current),Mr(f)){if(_=f.stateNode,g=f.memoizedProps,_[Ma]=f,(V=_.nodeValue!==g)&&(c=We,c!==null))switch(c.tag){case 3:Lf(_.nodeValue,g,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&Lf(_.nodeValue,g,(c.mode&1)!==0)}V&&(f.flags|=4)}else _=(g.nodeType===9?g:g.ownerDocument).createTextNode(_),_[Ma]=f,f.stateNode=_}return $o(f),null;case 13:if(Zn(xr),_=f.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(Je&&Ge!==null&&(f.mode&1)!==0&&(f.flags&128)===0)yn(),xt(),f.flags|=98560,V=!1;else if(V=Mr(f),_!==null&&_.dehydrated!==null){if(c===null){if(!V)throw Error(t(318));if(V=f.memoizedState,V=V!==null?V.dehydrated:null,!V)throw Error(t(317));V[Ma]=f}else xt(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;$o(f),V=!1}else Ze!==null&&(ey(Ze),Ze=null),V=!0;if(!V)return f.flags&65536?f:null}return(f.flags&128)!==0?(f.lanes=g,f):(_=_!==null,_!==(c!==null&&c.memoizedState!==null)&&_&&(f.child.flags|=8192,(f.mode&1)!==0&&(c===null||(xr.current&1)!==0?Ui===0&&(Ui=3):ry())),f.updateQueue!==null&&(f.flags|=4),$o(f),null);case 4:return Oa(),W1(c,f),c===null&&Ll(f.stateNode.containerInfo),$o(f),null;case 10:return Sr(f.type._context),$o(f),null;case 17:return Ho(f.type)&&Mf(),$o(f),null;case 19:if(Zn(xr),V=f.memoizedState,V===null)return $o(f),null;if(_=(f.flags&128)!==0,K=V.rendering,K===null)if(_)Rp(V,!1);else{if(Ui!==0||c!==null&&(c.flags&128)!==0)for(c=f.child;c!==null;){if(K=sa(c),K!==null){for(f.flags|=128,Rp(V,!1),_=K.updateQueue,_!==null&&(f.updateQueue=_,f.flags|=4),f.subtreeFlags=0,_=g,g=f.child;g!==null;)V=g,c=_,V.flags&=14680066,K=V.alternate,K===null?(V.childLanes=0,V.lanes=c,V.child=null,V.subtreeFlags=0,V.memoizedProps=null,V.memoizedState=null,V.updateQueue=null,V.dependencies=null,V.stateNode=null):(V.childLanes=K.childLanes,V.lanes=K.lanes,V.child=K.child,V.subtreeFlags=0,V.deletions=null,V.memoizedProps=K.memoizedProps,V.memoizedState=K.memoizedState,V.updateQueue=K.updateQueue,V.type=K.type,c=K.dependencies,V.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),g=g.sibling;return nr(xr,xr.current&1|2),f.child}c=c.sibling}V.tail!==null&&Qn()>Kf&&(f.flags|=128,_=!0,Rp(V,!1),f.lanes=4194304)}else{if(!_)if(c=sa(K),c!==null){if(f.flags|=128,_=!0,g=c.updateQueue,g!==null&&(f.updateQueue=g,f.flags|=4),Rp(V,!0),V.tail===null&&V.tailMode==="hidden"&&!K.alternate&&!Je)return $o(f),null}else 2*Qn()-V.renderingStartTime>Kf&&g!==1073741824&&(f.flags|=128,_=!0,Rp(V,!1),f.lanes=4194304);V.isBackwards?(K.sibling=f.child,f.child=K):(g=V.last,g!==null?g.sibling=K:f.child=K,V.last=K)}return V.tail!==null?(f=V.tail,V.rendering=f,V.tail=f.sibling,V.renderingStartTime=Qn(),f.sibling=null,g=xr.current,nr(xr,_?g&1|2:g&1),f):($o(f),null);case 22:case 23:return ny(),_=f.memoizedState!==null,c!==null&&c.memoizedState!==null!==_&&(f.flags|=8192),_&&(f.mode&1)!==0?(la&1073741824)!==0&&($o(f),f.subtreeFlags&6&&(f.flags|=8192)):$o(f),null;case 24:return null;case 25:return null}throw Error(t(156,f.tag))}function JP(c,f){switch(Me(f),f.tag){case 1:return Ho(f.type)&&Mf(),c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 3:return Oa(),Zn(qo),Zn(Vi),Tp(),c=f.flags,(c&65536)!==0&&(c&128)===0?(f.flags=c&-65537|128,f):null;case 5:return Cp(f),null;case 13:if(Zn(xr),c=f.memoizedState,c!==null&&c.dehydrated!==null){if(f.alternate===null)throw Error(t(340));xt()}return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 19:return Zn(xr),null;case 4:return Oa(),null;case 10:return Sr(f.type._context),null;case 22:case 23:return ny(),null;case 24:return null;default:return null}}var Cg=!1,Ko=!1,ZP=typeof WeakSet=="function"?WeakSet:Set,At=null;function Gf(c,f){var g=c.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(_){ri(c,f,_)}else g.current=null}function q1(c,f,g){try{g()}catch(_){ri(c,f,_)}}var i5=!1;function eD(c,f){if(Ph=Zs,c=Zr(),ra(c)){if("selectionStart"in c)var g={start:c.selectionStart,end:c.selectionEnd};else e:{g=(g=c.ownerDocument)&&g.defaultView||window;var _=g.getSelection&&g.getSelection();if(_&&_.rangeCount!==0){g=_.anchorNode;var R=_.anchorOffset,V=_.focusNode;_=_.focusOffset;try{g.nodeType,V.nodeType}catch{g=null;break e}var K=0,ye=-1,Ee=-1,Ue=0,ot=0,st=c,it=null;t:for(;;){for(var mt;st!==g||R!==0&&st.nodeType!==3||(ye=K+R),st!==V||_!==0&&st.nodeType!==3||(Ee=K+_),st.nodeType===3&&(K+=st.nodeValue.length),(mt=st.firstChild)!==null;)it=st,st=mt;for(;;){if(st===c)break t;if(it===g&&++Ue===R&&(ye=K),it===V&&++ot===_&&(Ee=K),(mt=st.nextSibling)!==null)break;st=it,it=st.parentNode}st=mt}g=ye===-1||Ee===-1?null:{start:ye,end:Ee}}else g=null}g=g||{start:0,end:0}}else g=null;for(Ol={focusedElem:c,selectionRange:g},Zs=!1,At=f;At!==null;)if(f=At,c=f.child,(f.subtreeFlags&1028)!==0&&c!==null)c.return=f,At=c;else for(;At!==null;){f=At;try{var Tt=f.alternate;if((f.flags&1024)!==0)switch(f.tag){case 0:case 11:case 15:break;case 1:if(Tt!==null){var Pt=Tt.memoizedProps,mi=Tt.memoizedState,Le=f.stateNode,Te=Le.getSnapshotBeforeUpdate(f.elementType===f.type?Pt:cu(f.type,Pt),mi);Le.__reactInternalSnapshotBeforeUpdate=Te}break;case 3:var Be=f.stateNode.containerInfo;Be.nodeType===1?Be.textContent="":Be.nodeType===9&&Be.documentElement&&Be.removeChild(Be.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ut){ri(f,f.return,ut)}if(c=f.sibling,c!==null){c.return=f.return,At=c;break}At=f.return}return Tt=i5,i5=!1,Tt}function Pp(c,f,g){var _=f.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var R=_=_.next;do{if((R.tag&c)===c){var V=R.destroy;R.destroy=void 0,V!==void 0&&q1(f,g,V)}R=R.next}while(R!==_)}}function Ig(c,f){if(f=f.updateQueue,f=f!==null?f.lastEffect:null,f!==null){var g=f=f.next;do{if((g.tag&c)===c){var _=g.create;g.destroy=_()}g=g.next}while(g!==f)}}function H1(c){var f=c.ref;if(f!==null){var g=c.stateNode;switch(c.tag){case 5:c=g;break;default:c=g}typeof f=="function"?f(c):f.current=c}}function o5(c){var f=c.alternate;f!==null&&(c.alternate=null,o5(f)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(f=c.stateNode,f!==null&&(delete f[Ma],delete f[xc],delete f[Wo],delete f[k1],delete f[N1])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function s5(c){return c.tag===5||c.tag===3||c.tag===4}function a5(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||s5(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function G1(c,f,g){var _=c.tag;if(_===5||_===6)c=c.stateNode,f?g.nodeType===8?g.parentNode.insertBefore(c,f):g.insertBefore(c,f):(g.nodeType===8?(f=g.parentNode,f.insertBefore(c,g)):(f=g,f.appendChild(c)),g=g._reactRootContainer,g!=null||f.onclick!==null||(f.onclick=bc));else if(_!==4&&(c=c.child,c!==null))for(G1(c,f,g),c=c.sibling;c!==null;)G1(c,f,g),c=c.sibling}function $1(c,f,g){var _=c.tag;if(_===5||_===6)c=c.stateNode,f?g.insertBefore(c,f):g.appendChild(c);else if(_!==4&&(c=c.child,c!==null))for($1(c,f,g),c=c.sibling;c!==null;)$1(c,f,g),c=c.sibling}var Co=null,hu=!1;function Tc(c,f,g){for(g=g.child;g!==null;)u5(c,f,g),g=g.sibling}function u5(c,f,g){if(Ji&&typeof Ji.onCommitFiberUnmount=="function")try{Ji.onCommitFiberUnmount(Sa,g)}catch{}switch(g.tag){case 5:Ko||Gf(g,f);case 6:var _=Co,R=hu;Co=null,Tc(c,f,g),Co=_,hu=R,Co!==null&&(hu?(c=Co,g=g.stateNode,c.nodeType===8?c.parentNode.removeChild(g):c.removeChild(g)):Co.removeChild(g.stateNode));break;case 18:Co!==null&&(hu?(c=Co,g=g.stateNode,c.nodeType===8?Ep(c.parentNode,g):c.nodeType===1&&Ep(c,g),Ca(c)):Ep(Co,g.stateNode));break;case 4:_=Co,R=hu,Co=g.stateNode.containerInfo,hu=!0,Tc(c,f,g),Co=_,hu=R;break;case 0:case 11:case 14:case 15:if(!Ko&&(_=g.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){R=_=_.next;do{var V=R,K=V.destroy;V=V.tag,K!==void 0&&((V&2)!==0||(V&4)!==0)&&q1(g,f,K),R=R.next}while(R!==_)}Tc(c,f,g);break;case 1:if(!Ko&&(Gf(g,f),_=g.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=g.memoizedProps,_.state=g.memoizedState,_.componentWillUnmount()}catch(ye){ri(g,f,ye)}Tc(c,f,g);break;case 21:Tc(c,f,g);break;case 22:g.mode&1?(Ko=(_=Ko)||g.memoizedState!==null,Tc(c,f,g),Ko=_):Tc(c,f,g);break;default:Tc(c,f,g)}}function l5(c){var f=c.updateQueue;if(f!==null){c.updateQueue=null;var g=c.stateNode;g===null&&(g=c.stateNode=new ZP),f.forEach(function(_){var R=lD.bind(null,c,_);g.has(_)||(g.add(_),_.then(R,R))})}}function fu(c,f){var g=f.deletions;if(g!==null)for(var _=0;_<g.length;_++){var R=g[_];try{var V=c,K=f,ye=K;e:for(;ye!==null;){switch(ye.tag){case 5:Co=ye.stateNode,hu=!1;break e;case 3:Co=ye.stateNode.containerInfo,hu=!0;break e;case 4:Co=ye.stateNode.containerInfo,hu=!0;break e}ye=ye.return}if(Co===null)throw Error(t(160));u5(V,K,R),Co=null,hu=!1;var Ee=R.alternate;Ee!==null&&(Ee.return=null),R.return=null}catch(Ue){ri(R,f,Ue)}}if(f.subtreeFlags&12854)for(f=f.child;f!==null;)c5(f,c),f=f.sibling}function c5(c,f){var g=c.alternate,_=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(fu(f,c),$u(c),_&4){try{Pp(3,c,c.return),Ig(3,c)}catch(Pt){ri(c,c.return,Pt)}try{Pp(5,c,c.return)}catch(Pt){ri(c,c.return,Pt)}}break;case 1:fu(f,c),$u(c),_&512&&g!==null&&Gf(g,g.return);break;case 5:if(fu(f,c),$u(c),_&512&&g!==null&&Gf(g,g.return),c.flags&32){var R=c.stateNode;try{en(R,"")}catch(Pt){ri(c,c.return,Pt)}}if(_&4&&(R=c.stateNode,R!=null)){var V=c.memoizedProps,K=g!==null?g.memoizedProps:V,ye=c.type,Ee=c.updateQueue;if(c.updateQueue=null,Ee!==null)try{ye==="input"&&V.type==="radio"&&V.name!=null&&rt(R,V),Ot(ye,K);var Ue=Ot(ye,V);for(K=0;K<Ee.length;K+=2){var ot=Ee[K],st=Ee[K+1];ot==="style"?rn(R,st):ot==="dangerouslySetInnerHTML"?vt(R,st):ot==="children"?en(R,st):P(R,ot,st,Ue)}switch(ye){case"input":zt(R,V);break;case"textarea":En(R,V);break;case"select":var it=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!V.multiple;var mt=V.value;mt!=null?lt(R,!!V.multiple,mt,!1):it!==!!V.multiple&&(V.defaultValue!=null?lt(R,!!V.multiple,V.defaultValue,!0):lt(R,!!V.multiple,V.multiple?[]:"",!1))}R[xc]=V}catch(Pt){ri(c,c.return,Pt)}}break;case 6:if(fu(f,c),$u(c),_&4){if(c.stateNode===null)throw Error(t(162));R=c.stateNode,V=c.memoizedProps;try{R.nodeValue=V}catch(Pt){ri(c,c.return,Pt)}}break;case 3:if(fu(f,c),$u(c),_&4&&g!==null&&g.memoizedState.isDehydrated)try{Ca(f.containerInfo)}catch(Pt){ri(c,c.return,Pt)}break;case 4:fu(f,c),$u(c);break;case 13:fu(f,c),$u(c),R=c.child,R.flags&8192&&(V=R.memoizedState!==null,R.stateNode.isHidden=V,!V||R.alternate!==null&&R.alternate.memoizedState!==null||(Y1=Qn())),_&4&&l5(c);break;case 22:if(ot=g!==null&&g.memoizedState!==null,c.mode&1?(Ko=(Ue=Ko)||ot,fu(f,c),Ko=Ue):fu(f,c),$u(c),_&8192){if(Ue=c.memoizedState!==null,(c.stateNode.isHidden=Ue)&&!ot&&(c.mode&1)!==0)for(At=c,ot=c.child;ot!==null;){for(st=At=ot;At!==null;){switch(it=At,mt=it.child,it.tag){case 0:case 11:case 14:case 15:Pp(4,it,it.return);break;case 1:Gf(it,it.return);var Tt=it.stateNode;if(typeof Tt.componentWillUnmount=="function"){_=it,g=it.return;try{f=_,Tt.props=f.memoizedProps,Tt.state=f.memoizedState,Tt.componentWillUnmount()}catch(Pt){ri(_,g,Pt)}}break;case 5:Gf(it,it.return);break;case 22:if(it.memoizedState!==null){d5(st);continue}}mt!==null?(mt.return=it,At=mt):d5(st)}ot=ot.sibling}e:for(ot=null,st=c;;){if(st.tag===5){if(ot===null){ot=st;try{R=st.stateNode,Ue?(V=R.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none"):(ye=st.stateNode,Ee=st.memoizedProps.style,K=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null,ye.style.display=mn("display",K))}catch(Pt){ri(c,c.return,Pt)}}}else if(st.tag===6){if(ot===null)try{st.stateNode.nodeValue=Ue?"":st.memoizedProps}catch(Pt){ri(c,c.return,Pt)}}else if((st.tag!==22&&st.tag!==23||st.memoizedState===null||st===c)&&st.child!==null){st.child.return=st,st=st.child;continue}if(st===c)break e;for(;st.sibling===null;){if(st.return===null||st.return===c)break e;ot===st&&(ot=null),st=st.return}ot===st&&(ot=null),st.sibling.return=st.return,st=st.sibling}}break;case 19:fu(f,c),$u(c),_&4&&l5(c);break;case 21:break;default:fu(f,c),$u(c)}}function $u(c){var f=c.flags;if(f&2){try{e:{for(var g=c.return;g!==null;){if(s5(g)){var _=g;break e}g=g.return}throw Error(t(160))}switch(_.tag){case 5:var R=_.stateNode;_.flags&32&&(en(R,""),_.flags&=-33);var V=a5(c);$1(c,V,R);break;case 3:case 4:var K=_.stateNode.containerInfo,ye=a5(c);G1(c,ye,K);break;default:throw Error(t(161))}}catch(Ee){ri(c,c.return,Ee)}c.flags&=-3}f&4096&&(c.flags&=-4097)}function tD(c,f,g){At=c,h5(c)}function h5(c,f,g){for(var _=(c.mode&1)!==0;At!==null;){var R=At,V=R.child;if(R.tag===22&&_){var K=R.memoizedState!==null||Cg;if(!K){var ye=R.alternate,Ee=ye!==null&&ye.memoizedState!==null||Ko;ye=Cg;var Ue=Ko;if(Cg=K,(Ko=Ee)&&!Ue)for(At=R;At!==null;)K=At,Ee=K.child,K.tag===22&&K.memoizedState!==null?p5(R):Ee!==null?(Ee.return=K,At=Ee):p5(R);for(;V!==null;)At=V,h5(V),V=V.sibling;At=R,Cg=ye,Ko=Ue}f5(c)}else(R.subtreeFlags&8772)!==0&&V!==null?(V.return=R,At=V):f5(c)}}function f5(c){for(;At!==null;){var f=At;if((f.flags&8772)!==0){var g=f.alternate;try{if((f.flags&8772)!==0)switch(f.tag){case 0:case 11:case 15:Ko||Ig(5,f);break;case 1:var _=f.stateNode;if(f.flags&4&&!Ko)if(g===null)_.componentDidMount();else{var R=f.elementType===f.type?g.memoizedProps:cu(f.type,g.memoizedProps);_.componentDidUpdate(R,g.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var V=f.updateQueue;V!==null&&Os(f,V,_);break;case 3:var K=f.updateQueue;if(K!==null){if(g=null,f.child!==null)switch(f.child.tag){case 5:g=f.child.stateNode;break;case 1:g=f.child.stateNode}Os(f,K,g)}break;case 5:var ye=f.stateNode;if(g===null&&f.flags&4){g=ye;var Ee=f.memoizedProps;switch(f.type){case"button":case"input":case"select":case"textarea":Ee.autoFocus&&g.focus();break;case"img":Ee.src&&(g.src=Ee.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(f.memoizedState===null){var Ue=f.alternate;if(Ue!==null){var ot=Ue.memoizedState;if(ot!==null){var st=ot.dehydrated;st!==null&&Ca(st)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ko||f.flags&512&&H1(f)}catch(it){ri(f,f.return,it)}}if(f===c){At=null;break}if(g=f.sibling,g!==null){g.return=f.return,At=g;break}At=f.return}}function d5(c){for(;At!==null;){var f=At;if(f===c){At=null;break}var g=f.sibling;if(g!==null){g.return=f.return,At=g;break}At=f.return}}function p5(c){for(;At!==null;){var f=At;try{switch(f.tag){case 0:case 11:case 15:var g=f.return;try{Ig(4,f)}catch(Ee){ri(f,g,Ee)}break;case 1:var _=f.stateNode;if(typeof _.componentDidMount=="function"){var R=f.return;try{_.componentDidMount()}catch(Ee){ri(f,R,Ee)}}var V=f.return;try{H1(f)}catch(Ee){ri(f,V,Ee)}break;case 5:var K=f.return;try{H1(f)}catch(Ee){ri(f,K,Ee)}}}catch(Ee){ri(f,f.return,Ee)}if(f===c){At=null;break}var ye=f.sibling;if(ye!==null){ye.return=f.return,At=ye;break}At=f.return}}var nD=Math.ceil,Tg=I.ReactCurrentDispatcher,K1=I.ReactCurrentOwner,Va=I.ReactCurrentBatchConfig,$n=0,uo=null,Ni=null,Io=0,la=0,$f=ia(0),Ui=0,Dp=null,Bh=0,kg=0,X1=0,Lp=null,Bs=null,Y1=0,Kf=1/0,zl=null,Ng=!1,Q1=null,kc=null,Rg=!1,Nc=null,Pg=0,Mp=0,J1=null,Dg=-1,Lg=0;function Es(){return($n&6)!==0?Qn():Dg!==-1?Dg:Dg=Qn()}function Rc(c){return(c.mode&1)===0?1:($n&2)!==0&&Io!==0?Io&-Io:zr.transition!==null?(Lg===0&&(Lg=Ru()),Lg):(c=An,c!==0||(c=window.event,c=c===void 0?16:ea(c.type)),c)}function du(c,f,g,_){if(50<Mp)throw Mp=0,J1=null,Error(t(185));Xa(c,g,_),(($n&2)===0||c!==uo)&&(c===uo&&(($n&2)===0&&(kg|=g),Ui===4&&Pc(c,Io)),Vs(c,_),g===1&&$n===0&&(f.mode&1)===0&&(Kf=Qn()+500,Lh&&z()))}function Vs(c,f){var g=c.callbackNode;br(c,f);var _=Is(c,c===uo?Io:0);if(_===0)g!==null&&Xs(g),c.callbackNode=null,c.callbackPriority=0;else if(f=_&-_,c.callbackPriority!==f){if(g!=null&&Xs(g),f===1)c.tag===0?F(g5.bind(null,c)):S(g5.bind(null,c)),I1(function(){($n&6)===0&&z()}),g=null;else{switch(xo(_)){case 1:g=Ka;break;case 4:g=Qi;break;case 16:g=Qs;break;case 536870912:g=Ea;break;default:g=Qs}g=S5(g,m5.bind(null,c))}c.callbackPriority=f,c.callbackNode=g}}function m5(c,f){if(Dg=-1,Lg=0,($n&6)!==0)throw Error(t(327));var g=c.callbackNode;if(Xf()&&c.callbackNode!==g)return null;var _=Is(c,c===uo?Io:0);if(_===0)return null;if((_&30)!==0||(_&c.expiredLanes)!==0||f)f=Mg(c,_);else{f=_;var R=$n;$n|=2;var V=y5();(uo!==c||Io!==f)&&(zl=null,Kf=Qn()+500,jh(c,f));do try{oD();break}catch(ye){v5(c,ye)}while(!0);Hn(),Tg.current=V,$n=R,Ni!==null?f=0:(uo=null,Io=0,f=Ui)}if(f!==0){if(f===2&&(R=ds(c),R!==0&&(_=R,f=Z1(c,R))),f===1)throw g=Dp,jh(c,0),Pc(c,_),Vs(c,Qn()),g;if(f===6)Pc(c,_);else{if(R=c.current.alternate,(_&30)===0&&!rD(R)&&(f=Mg(c,_),f===2&&(V=ds(c),V!==0&&(_=V,f=Z1(c,V))),f===1))throw g=Dp,jh(c,0),Pc(c,_),Vs(c,Qn()),g;switch(c.finishedWork=R,c.finishedLanes=_,f){case 0:case 1:throw Error(t(345));case 2:Uh(c,Bs,zl);break;case 3:if(Pc(c,_),(_&130023424)===_&&(f=Y1+500-Qn(),10<f)){if(Is(c,0)!==0)break;if(R=c.suspendedLanes,(R&_)!==_){Es(),c.pingedLanes|=c.suspendedLanes&R;break}c.timeoutHandle=_p(Uh.bind(null,c,Bs,zl),f);break}Uh(c,Bs,zl);break;case 4:if(Pc(c,_),(_&4194240)===_)break;for(f=c.eventTimes,R=-1;0<_;){var K=31-Pr(_);V=1<<K,K=f[K],K>R&&(R=K),_&=~V}if(_=R,_=Qn()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*nD(_/1960))-_,10<_){c.timeoutHandle=_p(Uh.bind(null,c,Bs,zl),_);break}Uh(c,Bs,zl);break;case 5:Uh(c,Bs,zl);break;default:throw Error(t(329))}}}return Vs(c,Qn()),c.callbackNode===g?m5.bind(null,c):null}function Z1(c,f){var g=Lp;return c.current.memoizedState.isDehydrated&&(jh(c,f).flags|=256),c=Mg(c,f),c!==2&&(f=Bs,Bs=g,f!==null&&ey(f)),c}function ey(c){Bs===null?Bs=c:Bs.push.apply(Bs,c)}function rD(c){for(var f=c;;){if(f.flags&16384){var g=f.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var _=0;_<g.length;_++){var R=g[_],V=R.getSnapshot;R=R.value;try{if(!Dr(V(),R))return!1}catch{return!1}}}if(g=f.child,f.subtreeFlags&16384&&g!==null)g.return=f,f=g;else{if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Pc(c,f){for(f&=~X1,f&=~kg,c.suspendedLanes|=f,c.pingedLanes&=~f,c=c.expirationTimes;0<f;){var g=31-Pr(f),_=1<<g;c[g]=-1,f&=~_}}function g5(c){if(($n&6)!==0)throw Error(t(327));Xf();var f=Is(c,0);if((f&1)===0)return Vs(c,Qn()),null;var g=Mg(c,f);if(c.tag!==0&&g===2){var _=ds(c);_!==0&&(f=_,g=Z1(c,_))}if(g===1)throw g=Dp,jh(c,0),Pc(c,f),Vs(c,Qn()),g;if(g===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=f,Uh(c,Bs,zl),Vs(c,Qn()),null}function ty(c,f){var g=$n;$n|=1;try{return c(f)}finally{$n=g,$n===0&&(Kf=Qn()+500,Lh&&z())}}function Vh(c){Nc!==null&&Nc.tag===0&&($n&6)===0&&Xf();var f=$n;$n|=1;var g=Va.transition,_=An;try{if(Va.transition=null,An=1,c)return c()}finally{An=_,Va.transition=g,$n=f,($n&6)===0&&z()}}function ny(){la=$f.current,Zn($f)}function jh(c,f){c.finishedWork=null,c.finishedLanes=0;var g=c.timeoutHandle;if(g!==-1&&(c.timeoutHandle=-1,dg(g)),Ni!==null)for(g=Ni.return;g!==null;){var _=g;switch(Me(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Mf();break;case 3:Oa(),Zn(qo),Zn(Vi),Tp();break;case 5:Cp(_);break;case 4:Oa();break;case 13:Zn(xr);break;case 19:Zn(xr);break;case 10:Sr(_.type._context);break;case 22:case 23:ny()}g=g.return}if(uo=c,Ni=c=Dc(c.current,null),Io=la=f,Ui=0,Dp=null,X1=kg=Bh=0,Bs=Lp=null,ur!==null){for(f=0;f<ur.length;f++)if(g=ur[f],_=g.interleaved,_!==null){g.interleaved=null;var R=_.next,V=g.pending;if(V!==null){var K=V.next;V.next=R,_.next=K}g.pending=_}ur=null}return c}function v5(c,f){do{var g=Ni;try{if(Hn(),Of.current=_g,Ac){for(var _=Ar.memoizedState;_!==null;){var R=_.queue;R!==null&&(R.pending=null),_=_.next}Ac=!1}if(Fa=0,Gr=ni=Ar=null,uu=!1,Cc=0,K1.current=null,g===null||g.return===null){Ui=1,Dp=f,Ni=null;break}e:{var V=c,K=g.return,ye=g,Ee=f;if(f=Io,ye.flags|=32768,Ee!==null&&typeof Ee=="object"&&typeof Ee.then=="function"){var Ue=Ee,ot=ye,st=ot.tag;if((ot.mode&1)===0&&(st===0||st===11||st===15)){var it=ot.alternate;it?(ot.updateQueue=it.updateQueue,ot.memoizedState=it.memoizedState,ot.lanes=it.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var mt=z_(K);if(mt!==null){mt.flags&=-257,W_(mt,K,ye,V,f),mt.mode&1&&U_(V,Ue,f),f=mt,Ee=Ue;var Tt=f.updateQueue;if(Tt===null){var Pt=new Set;Pt.add(Ee),f.updateQueue=Pt}else Tt.add(Ee);break e}else{if((f&1)===0){U_(V,Ue,f),ry();break e}Ee=Error(t(426))}}else if(Je&&ye.mode&1){var mi=z_(K);if(mi!==null){(mi.flags&65536)===0&&(mi.flags|=256),W_(mi,K,ye,V,f),ct(Hf(Ee,ye));break e}}V=Ee=Hf(Ee,ye),Ui!==4&&(Ui=2),Lp===null?Lp=[V]:Lp.push(V),V=K;do{switch(V.tag){case 3:V.flags|=65536,f&=-f,V.lanes|=f;var Le=V_(V,Ee,f);cr(V,Le);break e;case 1:ye=Ee;var Te=V.type,Be=V.stateNode;if((V.flags&128)===0&&(typeof Te.getDerivedStateFromError=="function"||Be!==null&&typeof Be.componentDidCatch=="function"&&(kc===null||!kc.has(Be)))){V.flags|=65536,f&=-f,V.lanes|=f;var ut=j_(V,ye,f);cr(V,ut);break e}}V=V.return}while(V!==null)}b5(g)}catch(Bt){f=Bt,Ni===g&&g!==null&&(Ni=g=g.return);continue}break}while(!0)}function y5(){var c=Tg.current;return Tg.current=_g,c===null?_g:c}function ry(){(Ui===0||Ui===3||Ui===2)&&(Ui=4),uo===null||(Bh&268435455)===0&&(kg&268435455)===0||Pc(uo,Io)}function Mg(c,f){var g=$n;$n|=2;var _=y5();(uo!==c||Io!==f)&&(zl=null,jh(c,f));do try{iD();break}catch(R){v5(c,R)}while(!0);if(Hn(),$n=g,Tg.current=_,Ni!==null)throw Error(t(261));return uo=null,Io=0,Ui}function iD(){for(;Ni!==null;)w5(Ni)}function oD(){for(;Ni!==null&&!Cs();)w5(Ni)}function w5(c){var f=E5(c.alternate,c,la);c.memoizedProps=c.pendingProps,f===null?b5(c):Ni=f,K1.current=null}function b5(c){var f=c;do{var g=f.alternate;if(c=f.return,(f.flags&32768)===0){if(g=QP(g,f,la),g!==null){Ni=g;return}}else{if(g=JP(g,f),g!==null){g.flags&=32767,Ni=g;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Ui=6,Ni=null;return}}if(f=f.sibling,f!==null){Ni=f;return}Ni=f=c}while(f!==null);Ui===0&&(Ui=5)}function Uh(c,f,g){var _=An,R=Va.transition;try{Va.transition=null,An=1,sD(c,f,g,_)}finally{Va.transition=R,An=_}return null}function sD(c,f,g,_){do Xf();while(Nc!==null);if(($n&6)!==0)throw Error(t(327));g=c.finishedWork;var R=c.finishedLanes;if(g===null)return null;if(c.finishedWork=null,c.finishedLanes=0,g===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var V=g.lanes|g.childLanes;if(Ts(c,V),c===uo&&(Ni=uo=null,Io=0),(g.subtreeFlags&2064)===0&&(g.flags&2064)===0||Rg||(Rg=!0,S5(Qs,function(){return Xf(),null})),V=(g.flags&15990)!==0,(g.subtreeFlags&15990)!==0||V){V=Va.transition,Va.transition=null;var K=An;An=1;var ye=$n;$n|=4,K1.current=null,eD(c,g),c5(g,c),Sh(Ol),Zs=!!Ph,Ol=Ph=null,c.current=g,tD(g),Ys(),$n=ye,An=K,Va.transition=V}else c.current=g;if(Rg&&(Rg=!1,Nc=c,Pg=R),V=c.pendingLanes,V===0&&(kc=null),xl(g.stateNode),Vs(c,Qn()),f!==null)for(_=c.onRecoverableError,g=0;g<f.length;g++)R=f[g],_(R.value,{componentStack:R.stack,digest:R.digest});if(Ng)throw Ng=!1,c=Q1,Q1=null,c;return(Pg&1)!==0&&c.tag!==0&&Xf(),V=c.pendingLanes,(V&1)!==0?c===J1?Mp++:(Mp=0,J1=c):Mp=0,z(),null}function Xf(){if(Nc!==null){var c=xo(Pg),f=Va.transition,g=An;try{if(Va.transition=null,An=16>c?16:c,Nc===null)var _=!1;else{if(c=Nc,Nc=null,Pg=0,($n&6)!==0)throw Error(t(331));var R=$n;for($n|=4,At=c.current;At!==null;){var V=At,K=V.child;if((At.flags&16)!==0){var ye=V.deletions;if(ye!==null){for(var Ee=0;Ee<ye.length;Ee++){var Ue=ye[Ee];for(At=Ue;At!==null;){var ot=At;switch(ot.tag){case 0:case 11:case 15:Pp(8,ot,V)}var st=ot.child;if(st!==null)st.return=ot,At=st;else for(;At!==null;){ot=At;var it=ot.sibling,mt=ot.return;if(o5(ot),ot===Ue){At=null;break}if(it!==null){it.return=mt,At=it;break}At=mt}}}var Tt=V.alternate;if(Tt!==null){var Pt=Tt.child;if(Pt!==null){Tt.child=null;do{var mi=Pt.sibling;Pt.sibling=null,Pt=mi}while(Pt!==null)}}At=V}}if((V.subtreeFlags&2064)!==0&&K!==null)K.return=V,At=K;else e:for(;At!==null;){if(V=At,(V.flags&2048)!==0)switch(V.tag){case 0:case 11:case 15:Pp(9,V,V.return)}var Le=V.sibling;if(Le!==null){Le.return=V.return,At=Le;break e}At=V.return}}var Te=c.current;for(At=Te;At!==null;){K=At;var Be=K.child;if((K.subtreeFlags&2064)!==0&&Be!==null)Be.return=K,At=Be;else e:for(K=Te;At!==null;){if(ye=At,(ye.flags&2048)!==0)try{switch(ye.tag){case 0:case 11:case 15:Ig(9,ye)}}catch(Bt){ri(ye,ye.return,Bt)}if(ye===K){At=null;break e}var ut=ye.sibling;if(ut!==null){ut.return=ye.return,At=ut;break e}At=ye.return}}if($n=R,z(),Ji&&typeof Ji.onPostCommitFiberRoot=="function")try{Ji.onPostCommitFiberRoot(Sa,c)}catch{}_=!0}return _}finally{An=g,Va.transition=f}}return!1}function x5(c,f,g){f=Hf(g,f),f=V_(c,f,1),c=qr(c,f,1),f=Es(),c!==null&&(Xa(c,1,f),Vs(c,f))}function ri(c,f,g){if(c.tag===3)x5(c,c,g);else for(;f!==null;){if(f.tag===3){x5(f,c,g);break}else if(f.tag===1){var _=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(kc===null||!kc.has(_))){c=Hf(g,c),c=j_(f,c,1),f=qr(f,c,1),c=Es(),f!==null&&(Xa(f,1,c),Vs(f,c));break}}f=f.return}}function aD(c,f,g){var _=c.pingCache;_!==null&&_.delete(f),f=Es(),c.pingedLanes|=c.suspendedLanes&g,uo===c&&(Io&g)===g&&(Ui===4||Ui===3&&(Io&130023424)===Io&&500>Qn()-Y1?jh(c,0):X1|=g),Vs(c,f)}function _5(c,f){f===0&&((c.mode&1)===0?f=1:(f=Oi,Oi<<=1,(Oi&130023424)===0&&(Oi=4194304)));var g=Es();c=lr(c,f),c!==null&&(Xa(c,f,g),Vs(c,g))}function uD(c){var f=c.memoizedState,g=0;f!==null&&(g=f.retryLane),_5(c,g)}function lD(c,f){var g=0;switch(c.tag){case 13:var _=c.stateNode,R=c.memoizedState;R!==null&&(g=R.retryLane);break;case 19:_=c.stateNode;break;default:throw Error(t(314))}_!==null&&_.delete(f),_5(c,g)}var E5;E5=function(c,f,g){if(c!==null)if(c.memoizedProps!==f.pendingProps||qo.current)Fs=!0;else{if((c.lanes&g)===0&&(f.flags&128)===0)return Fs=!1,YP(c,f,g);Fs=(c.flags&131072)!==0}else Fs=!1,Je&&(f.flags&1048576)!==0&&Pe(f,ee,f.index);switch(f.lanes=0,f.tag){case 2:var _=f.type;Ag(c,f),c=f.pendingProps;var R=Ec(f,Vi.current);Or(f,g),R=Mh(null,f,_,c,R,g);var V=Ba();return f.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(f.tag=1,f.memoizedState=null,f.updateQueue=null,Ho(_)?(V=!0,Vl(f)):V=!1,f.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,ji(f),R.updater=Eg,f.stateNode=R,R._reactInternals=f,L1(f,_,c,g),f=B1(null,f,_,!0,V,g)):(f.tag=0,Je&&V&&Ke(f),_s(null,f,R,g),f=f.child),f;case 16:_=f.elementType;e:{switch(Ag(c,f),c=f.pendingProps,R=_._init,_=R(_._payload),f.type=_,R=f.tag=hD(_),c=cu(_,c),R){case 0:f=F1(null,f,_,c,g);break e;case 1:f=X_(null,f,_,c,g);break e;case 11:f=q_(null,f,_,c,g);break e;case 14:f=H_(null,f,_,cu(_.type,c),g);break e}throw Error(t(306,_,""))}return f;case 0:return _=f.type,R=f.pendingProps,R=f.elementType===_?R:cu(_,R),F1(c,f,_,R,g);case 1:return _=f.type,R=f.pendingProps,R=f.elementType===_?R:cu(_,R),X_(c,f,_,R,g);case 3:e:{if(Y_(f),c===null)throw Error(t(387));_=f.pendingProps,V=f.memoizedState,R=V.element,Go(c,f),ao(f,_,null,g);var K=f.memoizedState;if(_=K.element,V.isDehydrated)if(V={element:_,isDehydrated:!1,cache:K.cache,pendingSuspenseBoundaries:K.pendingSuspenseBoundaries,transitions:K.transitions},f.updateQueue.baseState=V,f.memoizedState=V,f.flags&256){R=Hf(Error(t(423)),f),f=Q_(c,f,_,g,R);break e}else if(_!==R){R=Hf(Error(t(424)),f),f=Q_(c,f,_,g,R);break e}else for(Ge=Ao(f.stateNode.containerInfo.firstChild),We=f,Je=!0,Ze=null,g=Ir(f,null,_,g),f.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(xt(),_===R){f=Ul(c,f,g);break e}_s(c,f,_,g)}f=f.child}return f;case 5:return vg(f),c===null&&Ct(f),_=f.type,R=f.pendingProps,V=c!==null?c.memoizedProps:null,K=R.children,xp(_,R)?K=null:V!==null&&xp(_,V)&&(f.flags|=32),K_(c,f),_s(c,f,K,g),f.child;case 6:return c===null&&Ct(f),null;case 13:return J_(c,f,g);case 4:return Sc(f,f.stateNode.containerInfo),_=f.pendingProps,c===null?f.child=ei(f,null,_,g):_s(c,f,_,g),f.child;case 11:return _=f.type,R=f.pendingProps,R=f.elementType===_?R:cu(_,R),q_(c,f,_,R,g);case 7:return _s(c,f,f.pendingProps,g),f.child;case 8:return _s(c,f,f.pendingProps.children,g),f.child;case 12:return _s(c,f,f.pendingProps.children,g),f.child;case 10:e:{if(_=f.type._context,R=f.pendingProps,V=f.memoizedProps,K=R.value,nr(di,_._currentValue),_._currentValue=K,V!==null)if(Dr(V.value,K)){if(V.children===R.children&&!qo.current){f=Ul(c,f,g);break e}}else for(V=f.child,V!==null&&(V.return=f);V!==null;){var ye=V.dependencies;if(ye!==null){K=V.child;for(var Ee=ye.firstContext;Ee!==null;){if(Ee.context===_){if(V.tag===1){Ee=Wr(-1,g&-g),Ee.tag=2;var Ue=V.updateQueue;if(Ue!==null){Ue=Ue.shared;var ot=Ue.pending;ot===null?Ee.next=Ee:(Ee.next=ot.next,ot.next=Ee),Ue.pending=Ee}}V.lanes|=g,Ee=V.alternate,Ee!==null&&(Ee.lanes|=g),Gn(V.return,g,f),ye.lanes|=g;break}Ee=Ee.next}}else if(V.tag===10)K=V.type===f.type?null:V.child;else if(V.tag===18){if(K=V.return,K===null)throw Error(t(341));K.lanes|=g,ye=K.alternate,ye!==null&&(ye.lanes|=g),Gn(K,g,f),K=V.sibling}else K=V.child;if(K!==null)K.return=V;else for(K=V;K!==null;){if(K===f){K=null;break}if(V=K.sibling,V!==null){V.return=K.return,K=V;break}K=K.return}V=K}_s(c,f,R.children,g),f=f.child}return f;case 9:return R=f.type,_=f.pendingProps.children,Or(f,g),R=Fr(R),_=_(R),f.flags|=1,_s(c,f,_,g),f.child;case 14:return _=f.type,R=cu(_,f.pendingProps),R=cu(_.type,R),H_(c,f,_,R,g);case 15:return G_(c,f,f.type,f.pendingProps,g);case 17:return _=f.type,R=f.pendingProps,R=f.elementType===_?R:cu(_,R),Ag(c,f),f.tag=1,Ho(_)?(c=!0,Vl(f)):c=!1,Or(f,g),F_(f,_,R),L1(f,_,R,g),B1(null,f,_,!0,c,g);case 19:return e5(c,f,g);case 22:return $_(c,f,g)}throw Error(t(156,f.tag))};function S5(c,f){return _a(c,f)}function cD(c,f,g,_){this.tag=c,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ja(c,f,g,_){return new cD(c,f,g,_)}function iy(c){return c=c.prototype,!(!c||!c.isReactComponent)}function hD(c){if(typeof c=="function")return iy(c)?1:0;if(c!=null){if(c=c.$$typeof,c===O)return 11;if(c===ue)return 14}return 2}function Dc(c,f){var g=c.alternate;return g===null?(g=ja(c.tag,f,c.key,c.mode),g.elementType=c.elementType,g.type=c.type,g.stateNode=c.stateNode,g.alternate=c,c.alternate=g):(g.pendingProps=f,g.type=c.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=c.flags&14680064,g.childLanes=c.childLanes,g.lanes=c.lanes,g.child=c.child,g.memoizedProps=c.memoizedProps,g.memoizedState=c.memoizedState,g.updateQueue=c.updateQueue,f=c.dependencies,g.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},g.sibling=c.sibling,g.index=c.index,g.ref=c.ref,g}function Og(c,f,g,_,R,V){var K=2;if(_=c,typeof c=="function")iy(c)&&(K=1);else if(typeof c=="string")K=5;else e:switch(c){case L:return zh(g.children,R,V,f);case C:K=8,R|=8;break;case A:return c=ja(12,g,f,R|2),c.elementType=A,c.lanes=V,c;case j:return c=ja(13,g,f,R),c.elementType=j,c.lanes=V,c;case X:return c=ja(19,g,f,R),c.elementType=X,c.lanes=V,c;case he:return Fg(g,R,V,f);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case M:K=10;break e;case k:K=9;break e;case O:K=11;break e;case ue:K=14;break e;case ge:K=16,_=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return f=ja(K,g,f,R),f.elementType=c,f.type=_,f.lanes=V,f}function zh(c,f,g,_){return c=ja(7,c,_,f),c.lanes=g,c}function Fg(c,f,g,_){return c=ja(22,c,_,f),c.elementType=he,c.lanes=g,c.stateNode={isHidden:!1},c}function oy(c,f,g){return c=ja(6,c,null,f),c.lanes=g,c}function sy(c,f,g){return f=ja(4,c.children!==null?c.children:[],c.key,f),f.lanes=g,f.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},f}function fD(c,f,g,_,R){this.tag=f,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_l(0),this.expirationTimes=_l(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_l(0),this.identifierPrefix=_,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function ay(c,f,g,_,R,V,K,ye,Ee){return c=new fD(c,f,g,ye,Ee),f===1?(f=1,V===!0&&(f|=8)):f=0,V=ja(3,null,null,f),c.current=V,V.stateNode=c,V.memoizedState={element:_,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},ji(V),c}function dD(c,f,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:_==null?null:""+_,children:c,containerInfo:f,implementation:g}}function A5(c){if(!c)return qu;c=c._reactInternals;e:{if(Vr(c)!==c||c.tag!==1)throw Error(t(170));var f=c;do{switch(f.tag){case 3:f=f.stateNode.context;break e;case 1:if(Ho(f.type)){f=f.stateNode.__reactInternalMemoizedMergedChildContext;break e}}f=f.return}while(f!==null);throw Error(t(171))}if(c.tag===1){var g=c.type;if(Ho(g))return Ap(c,g,f)}return f}function C5(c,f,g,_,R,V,K,ye,Ee){return c=ay(g,_,!0,c,R,V,K,ye,Ee),c.context=A5(null),g=c.current,_=Es(),R=Rc(g),V=Wr(_,R),V.callback=f??null,qr(g,V,R),c.current.lanes=R,Xa(c,R,_),Vs(c,_),c}function Bg(c,f,g,_){var R=f.current,V=Es(),K=Rc(R);return g=A5(g),f.context===null?f.context=g:f.pendingContext=g,f=Wr(V,K),f.payload={element:c},_=_===void 0?null:_,_!==null&&(f.callback=_),c=qr(R,f,K),c!==null&&(du(c,R,K,V),so(c,R,K)),K}function Vg(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function I5(c,f){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var g=c.retryLane;c.retryLane=g!==0&&g<f?g:f}}function uy(c,f){I5(c,f),(c=c.alternate)&&I5(c,f)}function pD(){return null}var T5=typeof reportError=="function"?reportError:function(c){console.error(c)};function ly(c){this._internalRoot=c}jg.prototype.render=ly.prototype.render=function(c){var f=this._internalRoot;if(f===null)throw Error(t(409));Bg(c,f,null,null)},jg.prototype.unmount=ly.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var f=c.containerInfo;Vh(function(){Bg(null,c,null,null)}),f[io]=null}};function jg(c){this._internalRoot=c}jg.prototype.unstable_scheduleHydration=function(c){if(c){var f=Sl();c={blockedOn:null,target:c,priority:f};for(var g=0;g<_o.length&&f!==0&&f<_o[g].priority;g++);_o.splice(g,0,c),g===0&&Lu(c)}};function cy(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function Ug(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function k5(){}function mD(c,f,g,_,R){if(R){if(typeof _=="function"){var V=_;_=function(){var Ue=Vg(K);V.call(Ue)}}var K=C5(f,_,c,0,null,!1,!1,"",k5);return c._reactRootContainer=K,c[io]=K.current,Ll(c.nodeType===8?c.parentNode:c),Vh(),K}for(;R=c.lastChild;)c.removeChild(R);if(typeof _=="function"){var ye=_;_=function(){var Ue=Vg(Ee);ye.call(Ue)}}var Ee=ay(c,0,!1,null,null,!1,!1,"",k5);return c._reactRootContainer=Ee,c[io]=Ee.current,Ll(c.nodeType===8?c.parentNode:c),Vh(function(){Bg(f,Ee,g,_)}),Ee}function zg(c,f,g,_,R){var V=g._reactRootContainer;if(V){var K=V;if(typeof R=="function"){var ye=R;R=function(){var Ee=Vg(K);ye.call(Ee)}}Bg(f,K,c,R)}else K=mD(g,f,c,R,_);return Vg(K)}Js=function(c){switch(c.tag){case 3:var f=c.stateNode;if(f.current.memoizedState.isDehydrated){var g=Tn(f.pendingLanes);g!==0&&(Pu(f,g|1),Vs(f,Qn()),($n&6)===0&&(Kf=Qn()+500,z()))}break;case 13:Vh(function(){var _=lr(c,1);if(_!==null){var R=Es();du(_,c,1,R)}}),uy(c,1)}},Du=function(c){if(c.tag===13){var f=lr(c,134217728);if(f!==null){var g=Es();du(f,c,134217728,g)}uy(c,134217728)}},El=function(c){if(c.tag===13){var f=Rc(c),g=lr(c,f);if(g!==null){var _=Es();du(g,c,f,_)}uy(c,f)}},Sl=function(){return An},Ya=function(c,f){var g=An;try{return An=c,f()}finally{An=g}},Jt=function(c,f,g){switch(f){case"input":if(zt(c,g),f=g.name,g.type==="radio"&&f!=null){for(g=c;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+f)+'][type="radio"]'),f=0;f<g.length;f++){var _=g[f];if(_!==c&&_.form===c.form){var R=Dh(_);if(!R)throw Error(t(90));Ne(_),zt(_,R)}}}break;case"textarea":En(c,g);break;case"select":f=g.value,f!=null&&lt(c,!!g.multiple,f,!1)}},ai=ty,As=Vh;var gD={usingClientEntryPoint:!1,Events:[_c,Fl,Dh,Cn,Mo,ty]},Op={findFiberByHostInstance:Wu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vD={bundleType:Op.bundleType,version:Op.version,rendererPackageName:Op.rendererPackageName,rendererConfig:Op.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=cs(c),c===null?null:c.stateNode},findFiberByHostInstance:Op.findFiberByHostInstance||pD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wg.isDisabled&&Wg.supportsFiber)try{Sa=Wg.inject(vD),Ji=Wg}catch{}}return js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gD,js.createPortal=function(c,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cy(f))throw Error(t(200));return dD(c,f,null,g)},js.createRoot=function(c,f){if(!cy(c))throw Error(t(299));var g=!1,_="",R=T5;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(_=f.identifierPrefix),f.onRecoverableError!==void 0&&(R=f.onRecoverableError)),f=ay(c,1,!1,null,null,g,!1,_,R),c[io]=f.current,Ll(c.nodeType===8?c.parentNode:c),new ly(f)},js.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var f=c._reactInternals;if(f===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=cs(f),c=c===null?null:c.stateNode,c},js.flushSync=function(c){return Vh(c)},js.hydrate=function(c,f,g){if(!Ug(f))throw Error(t(200));return zg(null,c,f,!0,g)},js.hydrateRoot=function(c,f,g){if(!cy(c))throw Error(t(405));var _=g!=null&&g.hydratedSources||null,R=!1,V="",K=T5;if(g!=null&&(g.unstable_strictMode===!0&&(R=!0),g.identifierPrefix!==void 0&&(V=g.identifierPrefix),g.onRecoverableError!==void 0&&(K=g.onRecoverableError)),f=C5(f,null,c,1,g??null,R,!1,V,K),c[io]=f.current,Ll(c),_)for(c=0;c<_.length;c++)g=_[c],R=g._getVersion,R=R(g._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[g,R]:f.mutableSourceEagerHydrationData.push(g,R);return new jg(f)},js.render=function(c,f,g){if(!Ug(f))throw Error(t(200));return zg(null,c,f,!1,g)},js.unmountComponentAtNode=function(c){if(!Ug(c))throw Error(t(40));return c._reactRootContainer?(Vh(function(){zg(null,null,c,!1,function(){c._reactRootContainer=null,c[io]=null})}),!0):!1},js.unstable_batchedUpdates=ty,js.unstable_renderSubtreeIntoContainer=function(c,f,g,_){if(!Ug(g))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return zg(c,f,g,!1,_)},js.version="18.3.1-next-f1338f8080-20240426",js}var F5;function ID(){if(F5)return dy.exports;F5=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),dy.exports=CD(),dy.exports}var B5;function TD(){if(B5)return qg;B5=1;var n=ID();return qg.createRoot=n.createRoot,qg.hydrateRoot=n.hydrateRoot,qg}var kD=TD();const Y4=$e.createContext(),ND=({children:n})=>{const[e,t]=$e.useState(!1),[r,i]=$e.useState(!1),[o,s]=$e.useState("STANDBY"),[a,u]=$e.useState("HOME"),[l,h]=$e.useState(null),[d]=$e.useState({name:"Jim",access:"Admin"}),[m,p]=$e.useState(100),[y,b]=$e.useState([]),[x,E]=$e.useState(0),[T,P]=$e.useState({speed:0,heading:0,altitude:0,accuracy:0}),[I,D]=$e.useState(()=>JSON.parse(localStorage.getItem("jarvis_face_db_v2")||"[]")),[U,L]=$e.useState(()=>JSON.parse(localStorage.getItem("jarvis_incidents")||"[]")),[C,A]=$e.useState(()=>JSON.parse(localStorage.getItem("jarvis_leads")||"[]"));$e.useEffect(()=>{localStorage.setItem("jarvis_face_db_v2",JSON.stringify(I))},[I]),$e.useEffect(()=>{localStorage.setItem("jarvis_incidents",JSON.stringify(U))},[U]),$e.useEffect(()=>{localStorage.setItem("jarvis_leads",JSON.stringify(C))},[C]);const M=Ne=>{L(Oe=>[{...Ne,id:Date.now(),date:new Date().toLocaleString()},...Oe]),ae("Incident logged.")},k=Ne=>L(Oe=>Oe.filter(Qe=>Qe.id!==Ne)),O=Ne=>{A(Oe=>[{...Ne,id:Date.now(),status:"Potential",dateAdded:new Date().toLocaleDateString()},...Oe]),ae("Target added.")},j=(Ne,Oe)=>{A(Qe=>Qe.map(te=>te.id===Ne?{...te,status:Oe}:te)),ae("Status updated.")},X=Ne=>A(Oe=>Oe.filter(Qe=>Qe.id!==Ne)),ue=Ne=>{const Oe=[...I];Oe.splice(Ne,1),D(Oe),ae("Record deleted.")},ge=(Ne,Oe)=>{const Qe=[...I];Qe[Ne]={...Qe[Ne],...Oe},D(Qe),ae("Record updated.")},he=Ne=>{D(Oe=>[...Oe,{...Ne,dateAdded:new Date().toLocaleDateString()}]),ae("Identity added.")},$=()=>{D([]),ae("Database wiped.")};$e.useEffect(()=>{const Ne=()=>{const Oe=window.speechSynthesis.getVoices();if(Oe.length>0){b(Oe);const Qe=localStorage.getItem("jarvis_voice_index");if(Qe)E(parseInt(Qe));else{const te=Oe.findIndex(rt=>rt.name.includes("Google UK English Male"));te!==-1&&E(te)}}};Ne(),window.speechSynthesis.onvoiceschanged=Ne},[]);const le=Ne=>{E(Ne),localStorage.setItem("jarvis_voice_index",Ne)},ae=(Ne,Oe=!1)=>{if(!window.speechSynthesis)return;window.speechSynthesis.cancel(),e&&we(),i(!0);const Qe=new SpeechSynthesisUtterance(Ne);y.length>0&&(Qe.voice=y[x]),Qe.rate=1,Qe.pitch=1,Qe.onend=()=>{i(!1),Oe&&setTimeout(()=>ve(),300)},window.speechSynthesis.speak(Qe)},J=$e.useRef(null),[W,Q]=$e.useState("IDLE"),[ne,fe]=$e.useState({});$e.useEffect(()=>{const Ne=window.SpeechRecognition||window.webkitSpeechRecognition;if(Ne){const Oe=new Ne;Oe.continuous=!1,Oe.interimResults=!1,Oe.lang="en-US",Oe.onstart=()=>t(!0),Oe.onend=()=>t(!1),Oe.onresult=Qe=>{const te=Qe.results[0][0].transcript.toLowerCase().trim();console.log("Heard:",te),Ce(te)},J.current=Oe}},[W,ne,I,a]);const ve=()=>{if(J.current&&!r)try{J.current.start()}catch{}},we=()=>{if(J.current)try{J.current.stop()}catch{}},Se=()=>{e?we():ve()},Ce=Ne=>{if(h({text:Ne,time:Date.now()}),W!=="IDLE"){Fe(Ne);return}if(Ne==="jarvis"||Ne==="hey jarvis"){u("MENU_OPEN"),ae("Sir?",!0);return}Ne.includes("open")||Ne.includes("start")||Ne.includes("let's")?Ne.includes("drive")||Ne.includes("hud")?(u("HUD"),ae("Driving protocols initiated.")):Ne.includes("vision")||Ne.includes("camera")?(u("VISION"),ae("Vision systems active.")):Ne.includes("media")||Ne.includes("music")?(u("MEDIA"),ae("Media player ready.")):Ne.includes("database")?(u("DATABASE"),ae("Accessing records.")):Ne.includes("ops")||Ne.includes("incident")?(u("OPS"),ae("Operations center online.")):Ne.includes("recon")||Ne.includes("sales")?(u("RECON"),ae("Sales targeting engaged.")):Ne.includes("guardian")?u("GUARDIAN"):Ne.includes("comms")&&(u("MENU_OPEN"),ae("Comms channels open.")):Ne.includes("drive home")||Ne.includes("navigate home")?(ae("Setting coordinates for Home Base."),window.open("https://www.google.com/maps/dir/?api=1&destination=Home","_blank")):Ne.includes("open maps")?(ae("Opening global positioning."),window.open("https://maps.google.com","_blank")):Ne.includes("close")||Ne.includes("exit")||Ne.includes("stop")?a!=="HOME"?(u("MENU_OPEN"),ae("Module closed. Anything else, Sir?",!0)):(u("HOME"),ae("Standing by.")):Ne.includes("yes")&&a==="MENU_OPEN"?ae("Awaiting command.",!0):Ne.includes("no")&&a==="MENU_OPEN"&&(u("HOME"),ae("Very well. Interface minimized."))},Fe=Ne=>{const Oe={...ne};if(W==="ASK_NAME")Oe.name=Ne.replace(/\./g,""),fe(Oe),Q("ASK_GENDER"),ae(`Registered ${Oe.name}. Male or Female?`,!0);else if(W==="ASK_GENDER")Oe.gender=Ne.includes("female")?"Female":"Male",fe(Oe),Q("ASK_AGE"),ae("Age?",!0);else if(W==="ASK_AGE")Oe.age=Ne.replace(/\D/g,"")||"Unknown",fe(Oe),Q("ASK_ACCESS"),ae("Access Level?",!0);else if(W==="ASK_ACCESS"){let Qe="No Access";Ne.includes("admin")&&(Qe="Admin"),Ne.includes("medium")&&(Qe="Medium"),Ne.includes("missing")&&(Qe="Missing"),Oe.accessLevel=Qe,Oe.dateAdded=new Date().toLocaleDateString(),D(te=>[...te,Oe]),Q("IDLE"),fe({}),ae("Identity archived.")}};$e.useEffect(()=>{"getBattery"in navigator&&navigator.getBattery().then(Qe=>p(Math.round(Qe.level*100)));const Ne=navigator.geolocation.watchPosition(Qe=>P(te=>({...te,speed:Qe.coords.speed?Math.round(Qe.coords.speed*3.6):0,altitude:Math.round(Qe.coords.altitude||0)})),Qe=>{},{enableHighAccuracy:!0}),Oe=Qe=>{Qe.webkitCompassHeading?P(te=>({...te,heading:Qe.webkitCompassHeading})):Qe.alpha&&P(te=>({...te,heading:360-Qe.alpha}))};return window.addEventListener("deviceorientation",Oe),()=>{navigator.geolocation.clearWatch(Ne),window.removeEventListener("deviceorientation",Oe)}},[]);const qe=Ne=>{};return se.jsx(Y4.Provider,{value:{isListening:e,toggleListening:Se,isSpeaking:r,speak:ae,systemStatus:o,setSystemStatus:s,activeMode:a,setActiveMode:u,user:d,battery:m,playSound:qe,availableVoices:y,selectedVoiceIndex:x,changeVoice:le,conversationState:W,triggerInterview,faceDatabase:I,deletePerson:ue,updatePerson:ge,addPerson:he,clearDatabase:$,hudData:T,incidentLog:U,addIncident:M,deleteIncident:k,leadsLog:C,addLead:O,updateLeadStatus:j,deleteLead:X,lastCommand:l},children:n})},Eu=()=>$e.useContext(Y4),RD=()=>{const n=$e.useRef(null),{isSpeaking:e,isListening:t,activeMode:r}=Eu();return $e.useEffect(()=>{const i=n.current,o=i.getContext("2d");let s,a=0;const u={cyan:"#00E5FF",cyanDim:"rgba(0, 229, 255, 0.2)",white:"#FFFFFF",orange:"#FF8C00",alert:"#FF0000"},l=()=>{i.width=window.innerWidth,i.height=window.innerHeight};window.addEventListener("resize",l),l();const h=(m,p,y,b=0,x=[])=>{o.beginPath(),o.arc(0,0,m,0,Math.PI*2),o.strokeStyle=y,o.lineWidth=p,o.shadowBlur=b,o.shadowColor=y,o.setLineDash(x),o.stroke(),o.setLineDash([])},d=()=>{a++;const m=i.width,p=i.height,y=m/2,b=p/2,x=Math.min(m,p)*(m<768?.35:.25);o.clearRect(0,0,m,p),o.translate(y,b);const T=a*.0015,P=r==="WARNING"?u.alert:u.cyan,I=r==="WARNING"?u.alert:u.white;o.save(),o.rotate(T);for(let L=0;L<72;L++){o.rotate(Math.PI*2/72),o.beginPath();const C=L%4===0?1.15:1.1;o.moveTo(x*1.05,0),o.lineTo(x*C,0),o.strokeStyle=P,o.lineWidth=L%4===0?3:1.5,o.shadowBlur=10,o.shadowColor=P,o.stroke()}o.restore(),o.save(),o.rotate(-T*1.2),h(x*.95,x*.08,u.cyanDim,5,[x*.2,x*.05,x*.05,x*.05]),o.rotate(Math.PI/3),h(x*.95,x*.02,P,15,[x*.3,x*1.5]),o.restore(),o.save(),o.rotate(T*1.5),h(x*.85,2,P,5,[5,10]),o.restore(),o.save(),o.rotate(-T*.8),h(x*.7,8,u.cyanDim,10),h(x*.7,4,P,20,[x*.5,x*1.2]),r!=="WARNING"&&(o.beginPath(),o.arc(0,0,x*.7,Math.PI*.5,Math.PI*.85),o.strokeStyle=u.orange,o.lineWidth=10,o.shadowBlur=30,o.shadowColor=u.orange,o.stroke(),o.beginPath(),o.arc(0,0,x*.7,Math.PI*.52,Math.PI*.83),o.strokeStyle=u.white,o.lineWidth=3,o.shadowBlur=10,o.shadowColor=u.white,o.stroke()),o.restore(),o.save(),o.rotate(T*2),h(x*.55,3,P,5,[10,15]);for(let L=0;L<4;L++)o.rotate(Math.PI/2),o.beginPath(),o.moveTo(x*.5,0),o.lineTo(x*.6,0),o.lineWidth=6,o.stroke();o.restore(),o.save(),o.rotate(-T*3),o.shadowBlur=20,o.shadowColor=P;for(let L=0;L<12;L++)o.rotate(Math.PI*2/12),o.beginPath(),o.moveTo(x*.3,0),o.lineTo(x*.45,x*.05),o.strokeStyle=P,o.lineWidth=2,o.stroke();o.restore();const D=1+Math.sin(a*.05)*.1,U=e?Math.random()*.2:0;o.save(),o.beginPath(),o.arc(0,0,x*.25*D,0,Math.PI*2),o.fillStyle=I,o.shadowBlur=50*D,o.shadowColor=I,o.fill(),h(x*.28*D,5,P,30),U>0&&h(x*.2*(1+U),10,u.white,40),o.restore(),o.resetTransform(),s=requestAnimationFrame(d)};return d(),()=>{window.removeEventListener("resize",l),cancelAnimationFrame(s)}},[e,t,r]),se.jsx("canvas",{ref:n,className:"fixed top-0 left-0 w-full h-full z-0 pointer-events-none"})},PD=({onClose:n})=>{const{availableVoices:e,selectedVoiceIndex:t,changeVoice:r,playSound:i}=Eu();return se.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-md flex flex-col p-6 animate-fade-in",children:[se.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-cyan/30 pb-4",children:[se.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"SYSTEM CONFIG"}),se.jsx("button",{onClick:()=>{i("click"),n()},className:"text-cyan hover:text-white",children:se.jsx("i",{className:"fas fa-times text-2xl"})})]}),se.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar",children:[se.jsx("h3",{className:"text-cyan-dim font-mono text-xs mb-4",children:"VOCAL SYNTHESIS MODULE"}),se.jsxs("div",{className:"flex flex-col gap-2",children:[e.length===0&&se.jsx("div",{className:"text-red-500 font-mono text-sm",children:"LOADING VOICE PACKS..."}),e.map((o,s)=>se.jsxs("button",{onClick:()=>{i("click"),r(s)},className:`
                p-4 text-left font-mono text-sm border transition-all
                ${t===s?"border-cyan bg-cyan/10 text-cyan shadow-[0_0_10px_rgba(0,229,255,0.2)]":"border-white/10 text-gray-500 hover:border-cyan/50 hover:text-cyan/70"}
              `,children:[se.jsx("div",{className:"font-bold truncate",children:o.name}),se.jsx("div",{className:"text-[10px] opacity-70",children:o.lang})]},s))]})]}),se.jsx("div",{className:"mt-6 text-center text-cyan-dim text-[10px] font-mono",children:"T-FORCE SECURITY PROTOCOLS VER 1.0"})]})},ub=$e.createContext({});function lb(n){const e=$e.useRef(null);return e.current===null&&(e.current=n()),e.current}const B0=$e.createContext(null),cb=$e.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class DD extends $e.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function LD({children:n,isPresent:e}){const t=$e.useId(),r=$e.useRef(null),i=$e.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=$e.useContext(cb);return $e.useInsertionEffect(()=>{const{width:s,height:a,top:u,left:l}=i.current;if(e||!r.current||!s||!a)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return o&&(h.nonce=o),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${a}px !important;
            top: ${u}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),se.jsx(DD,{isPresent:e,childRef:r,sizeRef:i,children:$e.cloneElement(n,{ref:r})})}const MD=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:o,mode:s})=>{const a=lb(OD),u=$e.useId(),l=$e.useCallback(d=>{a.set(d,!0);for(const m of a.values())if(!m)return;r&&r()},[a,r]),h=$e.useMemo(()=>({id:u,initial:e,isPresent:t,custom:i,onExitComplete:l,register:d=>(a.set(d,!1),()=>a.delete(d))}),o?[Math.random(),l]:[t,l]);return $e.useMemo(()=>{a.forEach((d,m)=>a.set(m,!1))},[t]),$e.useEffect(()=>{!t&&!a.size&&r&&r()},[t]),s==="popLayout"&&(n=se.jsx(LD,{isPresent:t,children:n})),se.jsx(B0.Provider,{value:h,children:n})};function OD(){return new Map}function Q4(n=!0){const e=$e.useContext(B0);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,o=$e.useId();$e.useEffect(()=>{n&&i(o)},[n]);const s=$e.useCallback(()=>n&&r&&r(o),[o,r,n]);return!t&&r?[!1,s]:[!0]}const Hg=n=>n.key||"";function V5(n){const e=[];return $e.Children.forEach(n,t=>{$e.isValidElement(t)&&e.push(t)}),e}const hb=typeof window<"u",J4=hb?$e.useLayoutEffect:$e.useEffect,FD=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:o="sync",propagate:s=!1})=>{const[a,u]=Q4(s),l=$e.useMemo(()=>V5(n),[n]),h=s&&!a?[]:l.map(Hg),d=$e.useRef(!0),m=$e.useRef(l),p=lb(()=>new Map),[y,b]=$e.useState(l),[x,E]=$e.useState(l);J4(()=>{d.current=!1,m.current=l;for(let I=0;I<x.length;I++){const D=Hg(x[I]);h.includes(D)?p.delete(D):p.get(D)!==!0&&p.set(D,!1)}},[x,h.length,h.join("-")]);const T=[];if(l!==y){let I=[...l];for(let D=0;D<x.length;D++){const U=x[D],L=Hg(U);h.includes(L)||(I.splice(D,0,U),T.push(U))}o==="wait"&&T.length&&(I=T),E(V5(I)),b(l);return}const{forceRender:P}=$e.useContext(ub);return se.jsx(se.Fragment,{children:x.map(I=>{const D=Hg(I),U=s&&!a?!1:l===x||h.includes(D),L=()=>{if(p.has(D))p.set(D,!0);else return;let C=!0;p.forEach(A=>{A||(C=!1)}),C&&(P==null||P(),E(m.current),s&&(u==null||u()),r&&r())};return se.jsx(MD,{isPresent:U,initial:!d.current||t?void 0:!1,custom:U?void 0:e,presenceAffectsLayout:i,mode:o,onExitComplete:U?void 0:L,children:I},D)})})},ya=n=>n;let Z4=ya;function fb(n){let e;return()=>(e===void 0&&(e=n()),e)}const Vd=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Ql=n=>n*1e3,Jl=n=>n/1e3,BD={useManualTiming:!1};function VD(n){let e=new Set,t=new Set,r=!1,i=!1;const o=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1};function a(l){o.has(l)&&(u.schedule(l),n()),l(s)}const u={schedule:(l,h=!1,d=!1)=>{const p=d&&r?e:t;return h&&o.add(l),p.has(l)||p.add(l),l},cancel:l=>{t.delete(l),o.delete(l)},process:l=>{if(s=l,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(a),e.clear(),r=!1,i&&(i=!1,u.process(l))}};return u}const Gg=["read","resolveKeyframes","update","preRender","render","postRender"],jD=40;function e3(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>t=!0,s=Gg.reduce((E,T)=>(E[T]=VD(o),E),{}),{read:a,resolveKeyframes:u,update:l,preRender:h,render:d,postRender:m}=s,p=()=>{const E=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(E-i.timestamp,jD),1),i.timestamp=E,i.isProcessing=!0,a.process(i),u.process(i),l.process(i),h.process(i),d.process(i),m.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(p))},y=()=>{t=!0,r=!0,i.isProcessing||n(p)};return{schedule:Gg.reduce((E,T)=>{const P=s[T];return E[T]=(I,D=!1,U=!1)=>(t||y(),P.schedule(I,D,U)),E},{}),cancel:E=>{for(let T=0;T<Gg.length;T++)s[Gg[T]].cancel(E)},state:i,steps:s}}const{schedule:Nr,cancel:sh,state:To,steps:gy}=e3(typeof requestAnimationFrame<"u"?requestAnimationFrame:ya,!0),t3=$e.createContext({strict:!1}),j5={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},jd={};for(const n in j5)jd[n]={isEnabled:e=>j5[n].some(t=>!!e[t])};function UD(n){for(const e in n)jd[e]={...jd[e],...n[e]}}const zD=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function qv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||zD.has(n)}let n3=n=>!qv(n);function WD(n){n&&(n3=e=>e.startsWith("on")?!qv(e):n(e))}try{WD(require("@emotion/is-prop-valid").default)}catch{}function qD(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(n3(i)||t===!0&&qv(i)||!e&&!qv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function HD(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const V0=$e.createContext({});function mm(n){return typeof n=="string"||Array.isArray(n)}function j0(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const db=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],pb=["initial",...db];function U0(n){return j0(n.animate)||pb.some(e=>mm(n[e]))}function r3(n){return!!(U0(n)||n.variants)}function GD(n,e){if(U0(n)){const{initial:t,animate:r}=n;return{initial:t===!1||mm(t)?t:void 0,animate:mm(r)?r:void 0}}return n.inherit!==!1?e:{}}function $D(n){const{initial:e,animate:t}=GD(n,$e.useContext(V0));return $e.useMemo(()=>({initial:e,animate:t}),[U5(e),U5(t)])}function U5(n){return Array.isArray(n)?n.join(" "):n}const KD=Symbol.for("motionComponentSymbol");function dd(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function XD(n,e,t){return $e.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):dd(t)&&(t.current=r))},[e])}const mb=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),YD="framerAppearId",i3="data-"+mb(YD),{schedule:gb}=e3(queueMicrotask,!1),o3=$e.createContext({});function QD(n,e,t,r,i){var o,s;const{visualElement:a}=$e.useContext(V0),u=$e.useContext(t3),l=$e.useContext(B0),h=$e.useContext(cb).reducedMotion,d=$e.useRef(null);r=r||u.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:h}));const m=d.current,p=$e.useContext(o3);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&JD(d.current,t,i,p);const y=$e.useRef(!1);$e.useInsertionEffect(()=>{m&&y.current&&m.update(t,l)});const b=t[i3],x=$e.useRef(!!b&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,b))&&((s=window.MotionHasOptimisedAnimation)===null||s===void 0?void 0:s.call(window,b)));return J4(()=>{m&&(y.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),gb.render(m.render),x.current&&m.animationState&&m.animationState.animateChanges())}),$e.useEffect(()=>{m&&(!x.current&&m.animationState&&m.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var E;(E=window.MotionHandoffMarkAsComplete)===null||E===void 0||E.call(window,b)}),x.current=!1))}),m}function JD(n,e,t,r){const{layoutId:i,layout:o,drag:s,dragConstraints:a,layoutScroll:u,layoutRoot:l}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:s3(n.parent)),n.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:!!s||a&&dd(a),visualElement:n,animationType:typeof o=="string"?o:"both",initialPromotionConfig:r,layoutScroll:u,layoutRoot:l})}function s3(n){if(n)return n.options.allowProjection!==!1?n.projection:s3(n.parent)}function ZD({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var o,s;n&&UD(n);function a(l,h){let d;const m={...$e.useContext(cb),...l,layoutId:eL(l)},{isStatic:p}=m,y=$D(l),b=r(l,p);if(!p&&hb){tL();const x=nL(m);d=x.MeasureLayout,y.visualElement=QD(i,b,m,e,x.ProjectionNode)}return se.jsxs(V0.Provider,{value:y,children:[d&&y.visualElement?se.jsx(d,{visualElement:y.visualElement,...m}):null,t(i,l,XD(b,y.visualElement,h),b,p,y.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${(s=(o=i.displayName)!==null&&o!==void 0?o:i.name)!==null&&s!==void 0?s:""})`}`;const u=$e.forwardRef(a);return u[KD]=i,u}function eL({layoutId:n}){const e=$e.useContext(ub).id;return e&&n!==void 0?e+"-"+n:n}function tL(n,e){$e.useContext(t3).strict}function nL(n){const{drag:e,layout:t}=jd;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(n)||t!=null&&t.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const rL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function vb(n){return typeof n!="string"||n.includes("-")?!1:!!(rL.indexOf(n)>-1||/[A-Z]/u.test(n))}function z5(n){const e=[{},{}];return n==null||n.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function yb(n,e,t,r){if(typeof e=="function"){const[i,o]=z5(r);e=e(t!==void 0?t:n.custom,i,o)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,o]=z5(r);e=e(t!==void 0?t:n.custom,i,o)}return e}const B2=n=>Array.isArray(n),iL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),oL=n=>B2(n)?n[n.length-1]||0:n,as=n=>!!(n&&n.getVelocity);function Sv(n){const e=as(n)?n.get():n;return iL(e)?e.toValue():e}function sL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,o){const s={latestValues:aL(r,i,o,n),renderState:e()};return t&&(s.onMount=a=>t({props:r,current:a,...s}),s.onUpdate=a=>t(a)),s}const a3=n=>(e,t)=>{const r=$e.useContext(V0),i=$e.useContext(B0),o=()=>sL(n,e,r,i);return t?o():lb(o)};function aL(n,e,t,r){const i={},o=r(n,{});for(const m in o)i[m]=Sv(o[m]);let{initial:s,animate:a}=n;const u=U0(n),l=r3(n);e&&l&&!u&&n.inherit!==!1&&(s===void 0&&(s=e.initial),a===void 0&&(a=e.animate));let h=t?t.initial===!1:!1;h=h||s===!1;const d=h?a:s;if(d&&typeof d!="boolean"&&!j0(d)){const m=Array.isArray(d)?d:[d];for(let p=0;p<m.length;p++){const y=yb(n,m[p]);if(y){const{transitionEnd:b,transition:x,...E}=y;for(const T in E){let P=E[T];if(Array.isArray(P)){const I=h?P.length-1:0;P=P[I]}P!==null&&(i[T]=P)}for(const T in b)i[T]=b[T]}}}return i}const tp=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],yf=new Set(tp),u3=n=>e=>typeof e=="string"&&e.startsWith(n),l3=u3("--"),uL=u3("var(--"),wb=n=>uL(n)?lL.test(n.split("/*")[0].trim()):!1,lL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,c3=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Zl=(n,e,t)=>t>e?e:t<n?n:t,np={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},gm={...np,transform:n=>Zl(0,1,n)},$g={...np,default:1},Bm=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),jc=Bm("deg"),sl=Bm("%"),sn=Bm("px"),cL=Bm("vh"),hL=Bm("vw"),W5={...sl,parse:n=>sl.parse(n)/100,transform:n=>sl.transform(n*100)},fL={borderWidth:sn,borderTopWidth:sn,borderRightWidth:sn,borderBottomWidth:sn,borderLeftWidth:sn,borderRadius:sn,radius:sn,borderTopLeftRadius:sn,borderTopRightRadius:sn,borderBottomRightRadius:sn,borderBottomLeftRadius:sn,width:sn,maxWidth:sn,height:sn,maxHeight:sn,top:sn,right:sn,bottom:sn,left:sn,padding:sn,paddingTop:sn,paddingRight:sn,paddingBottom:sn,paddingLeft:sn,margin:sn,marginTop:sn,marginRight:sn,marginBottom:sn,marginLeft:sn,backgroundPositionX:sn,backgroundPositionY:sn},dL={rotate:jc,rotateX:jc,rotateY:jc,rotateZ:jc,scale:$g,scaleX:$g,scaleY:$g,scaleZ:$g,skew:jc,skewX:jc,skewY:jc,distance:sn,translateX:sn,translateY:sn,translateZ:sn,x:sn,y:sn,z:sn,perspective:sn,transformPerspective:sn,opacity:gm,originX:W5,originY:W5,originZ:sn},q5={...np,transform:Math.round},bb={...fL,...dL,zIndex:q5,size:sn,fillOpacity:gm,strokeOpacity:gm,numOctaves:q5},pL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},mL=tp.length;function gL(n,e,t){let r="",i=!0;for(let o=0;o<mL;o++){const s=tp[o],a=n[s];if(a===void 0)continue;let u=!0;if(typeof a=="number"?u=a===(s.startsWith("scale")?1:0):u=parseFloat(a)===0,!u||t){const l=c3(a,bb[s]);if(!u){i=!1;const h=pL[s]||s;r+=`${h}(${l}) `}t&&(e[s]=l)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function xb(n,e,t){const{style:r,vars:i,transformOrigin:o}=n;let s=!1,a=!1;for(const u in e){const l=e[u];if(yf.has(u)){s=!0;continue}else if(l3(u)){i[u]=l;continue}else{const h=c3(l,bb[u]);u.startsWith("origin")?(a=!0,o[u]=h):r[u]=h}}if(e.transform||(s||t?r.transform=gL(e,n.transform,t):r.transform&&(r.transform="none")),a){const{originX:u="50%",originY:l="50%",originZ:h=0}=o;r.transformOrigin=`${u} ${l} ${h}`}}const vL={offset:"stroke-dashoffset",array:"stroke-dasharray"},yL={offset:"strokeDashoffset",array:"strokeDasharray"};function wL(n,e,t=1,r=0,i=!0){n.pathLength=1;const o=i?vL:yL;n[o.offset]=sn.transform(-r);const s=sn.transform(e),a=sn.transform(t);n[o.array]=`${s} ${a}`}function H5(n,e,t){return typeof n=="string"?n:sn.transform(e+t*n)}function bL(n,e,t){const r=H5(e,n.x,n.width),i=H5(t,n.y,n.height);return`${r} ${i}`}function _b(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:o,pathLength:s,pathSpacing:a=1,pathOffset:u=0,...l},h,d){if(xb(n,l,d),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:p,dimensions:y}=n;m.transform&&(y&&(p.transform=m.transform),delete m.transform),y&&(i!==void 0||o!==void 0||p.transform)&&(p.transformOrigin=bL(y,i!==void 0?i:.5,o!==void 0?o:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),r!==void 0&&(m.scale=r),s!==void 0&&wL(m,s,a,u,!1)}const Eb=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),h3=()=>({...Eb(),attrs:{}}),Sb=n=>typeof n=="string"&&n.toLowerCase()==="svg";function f3(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const o in t)n.style.setProperty(o,t[o])}const d3=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function p3(n,e,t,r){f3(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(d3.has(i)?i:mb(i),e.attrs[i])}const Hv={};function xL(n){Object.assign(Hv,n)}function m3(n,{layout:e,layoutId:t}){return yf.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Hv[n]||n==="opacity")}function Ab(n,e,t){var r;const{style:i}=n,o={};for(const s in i)(as(i[s])||e.style&&as(e.style[s])||m3(s,n)||((r=t==null?void 0:t.getValue(s))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(o[s]=i[s]);return o}function g3(n,e,t){const r=Ab(n,e,t);for(const i in n)if(as(n[i])||as(e[i])){const o=tp.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[o]=n[i]}return r}function _L(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const G5=["x","y","width","height","cx","cy","r"],EL={useVisualState:a3({scrapeMotionValuesFromProps:g3,createRenderState:h3,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let o=!!n.drag;if(!o){for(const a in i)if(yf.has(a)){o=!0;break}}if(!o)return;let s=!e;if(e)for(let a=0;a<G5.length;a++){const u=G5[a];n[u]!==e[u]&&(s=!0)}s&&Nr.read(()=>{_L(t,r),Nr.render(()=>{_b(r,i,Sb(t.tagName),n.transformTemplate),p3(t,r)})})}})},SL={useVisualState:a3({scrapeMotionValuesFromProps:Ab,createRenderState:Eb})};function v3(n,e,t){for(const r in e)!as(e[r])&&!m3(r,t)&&(n[r]=e[r])}function AL({transformTemplate:n},e){return $e.useMemo(()=>{const t=Eb();return xb(t,e,n),Object.assign({},t.vars,t.style)},[e])}function CL(n,e){const t=n.style||{},r={};return v3(r,t,n),Object.assign(r,AL(n,e)),r}function IL(n,e){const t={},r=CL(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function TL(n,e,t,r){const i=$e.useMemo(()=>{const o=h3();return _b(o,e,Sb(r),n.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(n.style){const o={};v3(o,n.style,n),i.style={...o,...i.style}}return i}function kL(n=!1){return(t,r,i,{latestValues:o},s)=>{const u=(vb(t)?TL:IL)(r,o,s,t),l=qD(r,typeof t=="string",n),h=t!==$e.Fragment?{...l,...u,ref:i}:{},{children:d}=r,m=$e.useMemo(()=>as(d)?d.get():d,[d]);return $e.createElement(t,{...h,children:m})}}function NL(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const s={...vb(r)?EL:SL,preloadedFeatures:n,useRender:kL(i),createVisualElement:e,Component:r};return ZD(s)}}function y3(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function z0(n,e,t){const r=n.getProps();return yb(r,e,t!==void 0?t:r.custom,n)}const RL=fb(()=>window.ScrollTimeline!==void 0);class PL{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(RL()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,o)=>{i&&i(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class DL extends PL{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Cb(n,e){return n?n[e]||n.default||n:void 0}const V2=2e4;function w3(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<V2;)e+=t,r=n.next(e);return e>=V2?1/0:e}function Ib(n){return typeof n=="function"}function $5(n,e){n.timeline=e,n.onfinish=null}const Tb=n=>Array.isArray(n)&&typeof n[0]=="number",LL={linearEasing:void 0};function ML(n,e){const t=fb(n);return()=>{var r;return(r=LL[e])!==null&&r!==void 0?r:t()}}const Gv=ML(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),b3=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let o=0;o<i;o++)r+=n(Vd(0,i-1,o))+", ";return`linear(${r.substring(0,r.length-2)})`};function x3(n){return!!(typeof n=="function"&&Gv()||!n||typeof n=="string"&&(n in j2||Gv())||Tb(n)||Array.isArray(n)&&n.every(x3))}const Hp=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,j2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Hp([0,.65,.55,1]),circOut:Hp([.55,0,1,.45]),backIn:Hp([.31,.01,.66,-.59]),backOut:Hp([.33,1.53,.69,.99])};function _3(n,e){if(n)return typeof n=="function"&&Gv()?b3(n,e):Tb(n)?Hp(n):Array.isArray(n)?n.map(t=>_3(t,e)||j2.easeOut):j2[n]}const mu={x:!1,y:!1};function E3(){return mu.x||mu.y}function OL(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const o=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return o?Array.from(o):[]}return Array.from(n)}function S3(n,e){const t=OL(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function K5(n){return e=>{e.pointerType==="touch"||E3()||n(e)}}function FL(n,e,t={}){const[r,i,o]=S3(n,t),s=K5(a=>{const{target:u}=a,l=e(a);if(typeof l!="function"||!u)return;const h=K5(d=>{l(d),u.removeEventListener("pointerleave",h)});u.addEventListener("pointerleave",h,i)});return r.forEach(a=>{a.addEventListener("pointerenter",s,i)}),o}const A3=(n,e)=>e?n===e?!0:A3(n,e.parentElement):!1,kb=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,BL=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function VL(n){return BL.has(n.tagName)||n.tabIndex!==-1}const Gp=new WeakSet;function X5(n){return e=>{e.key==="Enter"&&n(e)}}function vy(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const jL=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=X5(()=>{if(Gp.has(t))return;vy(t,"down");const i=X5(()=>{vy(t,"up")}),o=()=>vy(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",o,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function Y5(n){return kb(n)&&!E3()}function UL(n,e,t={}){const[r,i,o]=S3(n,t),s=a=>{const u=a.currentTarget;if(!Y5(a)||Gp.has(u))return;Gp.add(u);const l=e(a),h=(p,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",m),!(!Y5(p)||!Gp.has(u))&&(Gp.delete(u),typeof l=="function"&&l(p,{success:y}))},d=p=>{h(p,t.useGlobalTarget||A3(u,p.target))},m=p=>{h(p,!1)};window.addEventListener("pointerup",d,i),window.addEventListener("pointercancel",m,i)};return r.forEach(a=>{!VL(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(t.useGlobalTarget?window:a).addEventListener("pointerdown",s,i),a.addEventListener("focus",l=>jL(l,i),i)}),o}function zL(n){return n==="x"||n==="y"?mu[n]?null:(mu[n]=!0,()=>{mu[n]=!1}):mu.x||mu.y?null:(mu.x=mu.y=!0,()=>{mu.x=mu.y=!1})}const C3=new Set(["width","height","top","left","right","bottom",...tp]);let Av;function WL(){Av=void 0}const al={now:()=>(Av===void 0&&al.set(To.isProcessing||BD.useManualTiming?To.timestamp:performance.now()),Av),set:n=>{Av=n,queueMicrotask(WL)}};function Nb(n,e){n.indexOf(e)===-1&&n.push(e)}function Rb(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class Pb{constructor(){this.subscriptions=[]}add(e){return Nb(this.subscriptions,e),()=>Rb(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let o=0;o<i;o++){const s=this.subscriptions[o];s&&s(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function I3(n,e){return e?n*(1e3/e):0}const Q5=30,qL=n=>!isNaN(parseFloat(n));class HL{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const o=al.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=al.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=qL(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Pb);const r=this.events[e].add(t);return e==="change"?()=>{r(),Nr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=al.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Q5)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,Q5);return I3(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function vm(n,e){return new HL(n,e)}function GL(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,vm(t))}function $L(n,e){const t=z0(n,e);let{transitionEnd:r={},transition:i={},...o}=t||{};o={...o,...r};for(const s in o){const a=oL(o[s]);GL(n,s,a)}}function KL(n){return!!(as(n)&&n.add)}function U2(n,e){const t=n.getValue("willChange");if(KL(t))return t.add(e)}function T3(n){return n.props[i3]}const k3=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,XL=1e-7,YL=12;function QL(n,e,t,r,i){let o,s,a=0;do s=e+(t-e)/2,o=k3(s,r,i)-n,o>0?t=s:e=s;while(Math.abs(o)>XL&&++a<YL);return s}function Vm(n,e,t,r){if(n===e&&t===r)return ya;const i=o=>QL(o,0,1,n,t);return o=>o===0||o===1?o:k3(i(o),e,r)}const N3=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,R3=n=>e=>1-n(1-e),P3=Vm(.33,1.53,.69,.99),Db=R3(P3),D3=N3(Db),L3=n=>(n*=2)<1?.5*Db(n):.5*(2-Math.pow(2,-10*(n-1))),Lb=n=>1-Math.sin(Math.acos(n)),M3=R3(Lb),O3=N3(Lb),F3=n=>/^0[^.\s]+$/u.test(n);function JL(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||F3(n):!0}const em=n=>Math.round(n*1e5)/1e5,Mb=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function ZL(n){return n==null}const e6=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Ob=(n,e)=>t=>!!(typeof t=="string"&&e6.test(t)&&t.startsWith(n)||e&&!ZL(t)&&Object.prototype.hasOwnProperty.call(t,e)),B3=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,o,s,a]=r.match(Mb);return{[n]:parseFloat(i),[e]:parseFloat(o),[t]:parseFloat(s),alpha:a!==void 0?parseFloat(a):1}},t6=n=>Zl(0,255,n),yy={...np,transform:n=>Math.round(t6(n))},Zh={test:Ob("rgb","red"),parse:B3("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+yy.transform(n)+", "+yy.transform(e)+", "+yy.transform(t)+", "+em(gm.transform(r))+")"};function n6(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const z2={test:Ob("#"),parse:n6,transform:Zh.transform},pd={test:Ob("hsl","hue"),parse:B3("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+sl.transform(em(e))+", "+sl.transform(em(t))+", "+em(gm.transform(r))+")"},es={test:n=>Zh.test(n)||z2.test(n)||pd.test(n),parse:n=>Zh.test(n)?Zh.parse(n):pd.test(n)?pd.parse(n):z2.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Zh.transform(n):pd.transform(n)},r6=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function i6(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(Mb))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(r6))===null||t===void 0?void 0:t.length)||0)>0}const V3="number",j3="color",o6="var",s6="var(",J5="${}",a6=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ym(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let o=0;const a=e.replace(a6,u=>(es.test(u)?(r.color.push(o),i.push(j3),t.push(es.parse(u))):u.startsWith(s6)?(r.var.push(o),i.push(o6),t.push(u)):(r.number.push(o),i.push(V3),t.push(parseFloat(u))),++o,J5)).split(J5);return{values:t,split:a,indexes:r,types:i}}function U3(n){return ym(n).values}function z3(n){const{split:e,types:t}=ym(n),r=e.length;return i=>{let o="";for(let s=0;s<r;s++)if(o+=e[s],i[s]!==void 0){const a=t[s];a===V3?o+=em(i[s]):a===j3?o+=es.transform(i[s]):o+=i[s]}return o}}const u6=n=>typeof n=="number"?0:n;function l6(n){const e=U3(n);return z3(n)(e.map(u6))}const ah={test:i6,parse:U3,createTransformer:z3,getAnimatableNone:l6},c6=new Set(["brightness","contrast","saturate","opacity"]);function h6(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(Mb)||[];if(!r)return n;const i=t.replace(r,"");let o=c6.has(e)?1:0;return r!==t&&(o*=100),e+"("+o+i+")"}const f6=/\b([a-z-]*)\(.*?\)/gu,W2={...ah,getAnimatableNone:n=>{const e=n.match(f6);return e?e.map(h6).join(" "):n}},d6={...bb,color:es,backgroundColor:es,outlineColor:es,fill:es,stroke:es,borderColor:es,borderTopColor:es,borderRightColor:es,borderBottomColor:es,borderLeftColor:es,filter:W2,WebkitFilter:W2},Fb=n=>d6[n];function W3(n,e){let t=Fb(n);return t!==W2&&(t=ah),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const p6=new Set(["auto","none","0"]);function m6(n,e,t){let r=0,i;for(;r<n.length&&!i;){const o=n[r];typeof o=="string"&&!p6.has(o)&&ym(o).values.length&&(i=n[r]),r++}if(i&&t)for(const o of e)n[o]=W3(t,i)}const Z5=n=>n===np||n===sn,eE=(n,e)=>parseFloat(n.split(", ")[e]),tE=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return eE(i[1],e);{const o=r.match(/^matrix\((.+)\)$/u);return o?eE(o[1],n):0}},g6=new Set(["x","y","z"]),v6=tp.filter(n=>!g6.has(n));function y6(n){const e=[];return v6.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const Ud={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:tE(4,13),y:tE(5,14)};Ud.translateX=Ud.x;Ud.translateY=Ud.y;const rf=new Set;let q2=!1,H2=!1;function q3(){if(H2){const n=Array.from(rf).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=y6(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([o,s])=>{var a;(a=r.getValue(o))===null||a===void 0||a.set(s)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}H2=!1,q2=!1,rf.forEach(n=>n.complete()),rf.clear()}function H3(){rf.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(H2=!0)})}function w6(){H3(),q3()}class Bb{constructor(e,t,r,i,o,s=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=o,this.isAsync=s}scheduleResolve(){this.isScheduled=!0,this.isAsync?(rf.add(this),q2||(q2=!0,Nr.read(H3),Nr.resolveKeyframes(q3))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const s=i==null?void 0:i.get(),a=e[e.length-1];if(s!==void 0)e[0]=s;else if(r&&t){const u=r.readValue(t,a);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=a),i&&s===void 0&&i.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),rf.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,rf.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const G3=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),b6=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function x6(n){const e=b6.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function $3(n,e,t=1){const[r,i]=x6(n);if(!r)return;const o=window.getComputedStyle(e).getPropertyValue(r);if(o){const s=o.trim();return G3(s)?parseFloat(s):s}return wb(i)?$3(i,e,t+1):i}const K3=n=>e=>e.test(n),_6={test:n=>n==="auto",parse:n=>n},X3=[np,sn,sl,jc,hL,cL,_6],nE=n=>X3.find(K3(n));class Y3 extends Bb{constructor(e,t,r,i,o){super(e,t,r,i,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let l=e[u];if(typeof l=="string"&&(l=l.trim(),wb(l))){const h=$3(l,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=l)}}if(this.resolveNoneKeyframes(),!C3.has(r)||e.length!==2)return;const[i,o]=e,s=nE(i),a=nE(o);if(s!==a)if(Z5(s)&&Z5(a))for(let u=0;u<e.length;u++){const l=e[u];typeof l=="string"&&(e[u]=parseFloat(l))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)JL(e[i])&&r.push(i);r.length&&m6(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ud[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const o=t.getValue(r);o&&o.jump(this.measuredOrigin,!1);const s=i.length-1,a=i[s];i[s]=Ud[r](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,l])=>{t.getValue(u).set(l)}),this.resolveNoneKeyframes()}}const rE=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ah.test(n)||n==="0")&&!n.startsWith("url("));function E6(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function S6(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const o=n[n.length-1],s=rE(i,e),a=rE(o,e);return!s||!a?!1:E6(n)||(t==="spring"||Ib(t))&&r}const A6=n=>n!==null;function W0(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(A6),o=e&&t!=="loop"&&e%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const C6=40;class Q3{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:s="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=al.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:o,repeatType:s,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>C6?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&w6(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=al.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:o,delay:s,onComplete:a,onUpdate:u,isGenerator:l}=this.options;if(!l&&!S6(e,r,i,o))if(s)this.options.duration=0;else{u&&u(W0(e,this.options,t)),a&&a(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Xr=(n,e,t)=>n+(e-n)*t;function wy(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function I6({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,o=0,s=0;if(!e)i=o=s=t;else{const a=t<.5?t*(1+e):t+e-t*e,u=2*t-a;i=wy(u,a,n+1/3),o=wy(u,a,n),s=wy(u,a,n-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(s*255),alpha:r}}function $v(n,e){return t=>t>0?e:n}const by=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},T6=[z2,Zh,pd],k6=n=>T6.find(e=>e.test(n));function iE(n){const e=k6(n);if(!e)return!1;let t=e.parse(n);return e===pd&&(t=I6(t)),t}const oE=(n,e)=>{const t=iE(n),r=iE(e);if(!t||!r)return $v(n,e);const i={...t};return o=>(i.red=by(t.red,r.red,o),i.green=by(t.green,r.green,o),i.blue=by(t.blue,r.blue,o),i.alpha=Xr(t.alpha,r.alpha,o),Zh.transform(i))},N6=(n,e)=>t=>e(n(t)),jm=(...n)=>n.reduce(N6),G2=new Set(["none","hidden"]);function R6(n,e){return G2.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function P6(n,e){return t=>Xr(n,e,t)}function Vb(n){return typeof n=="number"?P6:typeof n=="string"?wb(n)?$v:es.test(n)?oE:M6:Array.isArray(n)?J3:typeof n=="object"?es.test(n)?oE:D6:$v}function J3(n,e){const t=[...n],r=t.length,i=n.map((o,s)=>Vb(o)(o,e[s]));return o=>{for(let s=0;s<r;s++)t[s]=i[s](o);return t}}function D6(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=Vb(n[i])(n[i],e[i]));return i=>{for(const o in r)t[o]=r[o](i);return t}}function L6(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const s=e.types[o],a=n.indexes[s][i[s]],u=(t=n.values[a])!==null&&t!==void 0?t:0;r[o]=u,i[s]++}return r}const M6=(n,e)=>{const t=ah.createTransformer(e),r=ym(n),i=ym(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?G2.has(n)&&!i.values.length||G2.has(e)&&!r.values.length?R6(n,e):jm(J3(L6(r,i),i.values),t):$v(n,e)};function Z3(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Xr(n,e,t):Vb(n)(n,e)}const O6=5;function eI(n,e,t){const r=Math.max(e-O6,0);return I3(t-n(r),e-r)}const si={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},xy=.001;function F6({duration:n=si.duration,bounce:e=si.bounce,velocity:t=si.velocity,mass:r=si.mass}){let i,o,s=1-e;s=Zl(si.minDamping,si.maxDamping,s),n=Zl(si.minDuration,si.maxDuration,Jl(n)),s<1?(i=l=>{const h=l*s,d=h*n,m=h-t,p=$2(l,s),y=Math.exp(-d);return xy-m/p*y},o=l=>{const d=l*s*n,m=d*t+t,p=Math.pow(s,2)*Math.pow(l,2)*n,y=Math.exp(-d),b=$2(Math.pow(l,2),s);return(-i(l)+xy>0?-1:1)*((m-p)*y)/b}):(i=l=>{const h=Math.exp(-l*n),d=(l-t)*n+1;return-xy+h*d},o=l=>{const h=Math.exp(-l*n),d=(t-l)*(n*n);return h*d});const a=5/n,u=V6(i,o,a);if(n=Ql(n),isNaN(u))return{stiffness:si.stiffness,damping:si.damping,duration:n};{const l=Math.pow(u,2)*r;return{stiffness:l,damping:s*2*Math.sqrt(r*l),duration:n}}}const B6=12;function V6(n,e,t){let r=t;for(let i=1;i<B6;i++)r=r-n(r)/e(r);return r}function $2(n,e){return n*Math.sqrt(1-e*e)}const j6=["duration","bounce"],U6=["stiffness","damping","mass"];function sE(n,e){return e.some(t=>n[t]!==void 0)}function z6(n){let e={velocity:si.velocity,stiffness:si.stiffness,damping:si.damping,mass:si.mass,isResolvedFromDuration:!1,...n};if(!sE(n,U6)&&sE(n,j6))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,o=2*Zl(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:si.mass,stiffness:i,damping:o}}else{const t=F6(n);e={...e,...t,mass:si.mass},e.isResolvedFromDuration=!0}return e}function tI(n=si.visualDuration,e=si.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const o=t.keyframes[0],s=t.keyframes[t.keyframes.length-1],a={done:!1,value:o},{stiffness:u,damping:l,mass:h,duration:d,velocity:m,isResolvedFromDuration:p}=z6({...t,velocity:-Jl(t.velocity||0)}),y=m||0,b=l/(2*Math.sqrt(u*h)),x=s-o,E=Jl(Math.sqrt(u/h)),T=Math.abs(x)<5;r||(r=T?si.restSpeed.granular:si.restSpeed.default),i||(i=T?si.restDelta.granular:si.restDelta.default);let P;if(b<1){const D=$2(E,b);P=U=>{const L=Math.exp(-b*E*U);return s-L*((y+b*E*x)/D*Math.sin(D*U)+x*Math.cos(D*U))}}else if(b===1)P=D=>s-Math.exp(-E*D)*(x+(y+E*x)*D);else{const D=E*Math.sqrt(b*b-1);P=U=>{const L=Math.exp(-b*E*U),C=Math.min(D*U,300);return s-L*((y+b*E*x)*Math.sinh(C)+D*x*Math.cosh(C))/D}}const I={calculatedDuration:p&&d||null,next:D=>{const U=P(D);if(p)a.done=D>=d;else{let L=0;b<1&&(L=D===0?Ql(y):eI(P,D,U));const C=Math.abs(L)<=r,A=Math.abs(s-U)<=i;a.done=C&&A}return a.value=a.done?s:U,a},toString:()=>{const D=Math.min(w3(I),V2),U=b3(L=>I.next(D*L).value,D,30);return D+"ms "+U}};return I}function aE({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:s,min:a,max:u,restDelta:l=.5,restSpeed:h}){const d=n[0],m={done:!1,value:d},p=C=>a!==void 0&&C<a||u!==void 0&&C>u,y=C=>a===void 0?u:u===void 0||Math.abs(a-C)<Math.abs(u-C)?a:u;let b=t*e;const x=d+b,E=s===void 0?x:s(x);E!==x&&(b=E-d);const T=C=>-b*Math.exp(-C/r),P=C=>E+T(C),I=C=>{const A=T(C),M=P(C);m.done=Math.abs(A)<=l,m.value=m.done?E:M};let D,U;const L=C=>{p(m.value)&&(D=C,U=tI({keyframes:[m.value,y(m.value)],velocity:eI(P,C,m.value),damping:i,stiffness:o,restDelta:l,restSpeed:h}))};return L(0),{calculatedDuration:null,next:C=>{let A=!1;return!U&&D===void 0&&(A=!0,I(C),L(C)),D!==void 0&&C>=D?U.next(C-D):(!A&&I(C),m)}}}const W6=Vm(.42,0,1,1),q6=Vm(0,0,.58,1),nI=Vm(.42,0,.58,1),H6=n=>Array.isArray(n)&&typeof n[0]!="number",G6={linear:ya,easeIn:W6,easeInOut:nI,easeOut:q6,circIn:Lb,circInOut:O3,circOut:M3,backIn:Db,backInOut:D3,backOut:P3,anticipate:L3},uE=n=>{if(Tb(n)){Z4(n.length===4);const[e,t,r,i]=n;return Vm(e,t,r,i)}else if(typeof n=="string")return G6[n];return n};function $6(n,e,t){const r=[],i=t||Z3,o=n.length-1;for(let s=0;s<o;s++){let a=i(n[s],n[s+1]);if(e){const u=Array.isArray(e)?e[s]||ya:e;a=jm(u,a)}r.push(a)}return r}function K6(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const o=n.length;if(Z4(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const s=n[0]===n[1];n[0]>n[o-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=$6(e,r,i),u=a.length,l=h=>{if(s&&h<n[0])return e[0];let d=0;if(u>1)for(;d<n.length-2&&!(h<n[d+1]);d++);const m=Vd(n[d],n[d+1],h);return a[d](m)};return t?h=>l(Zl(n[0],n[o-1],h)):l}function X6(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=Vd(0,e,r);n.push(Xr(t,1,i))}}function Y6(n){const e=[0];return X6(e,n.length-1),e}function Q6(n,e){return n.map(t=>t*e)}function J6(n,e){return n.map(()=>e||nI).splice(0,n.length-1)}function Kv({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=H6(r)?r.map(uE):uE(r),o={done:!1,value:e[0]},s=Q6(t&&t.length===e.length?t:Y6(e),n),a=K6(s,e,{ease:Array.isArray(i)?i:J6(e,i)});return{calculatedDuration:n,next:u=>(o.value=a(u),o.done=u>=n,o)}}const Z6=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Nr.update(e,!0),stop:()=>sh(e),now:()=>To.isProcessing?To.timestamp:al.now()}},eM={decay:aE,inertia:aE,tween:Kv,keyframes:Kv,spring:tI},tM=n=>n/100;class jb extends Q3{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:r,element:i,keyframes:o}=this.options,s=(i==null?void 0:i.KeyframeResolver)||Bb,a=(u,l)=>this.onKeyframesResolved(u,l);this.resolver=new s(o,a,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o,velocity:s=0}=this.options,a=Ib(t)?t:eM[t]||Kv;let u,l;a!==Kv&&typeof e[0]!="number"&&(u=jm(tM,Z3(e[0],e[1])),e=[0,100]);const h=a({...this.options,keyframes:e});o==="mirror"&&(l=a({...this.options,keyframes:[...e].reverse(),velocity:-s})),h.calculatedDuration===null&&(h.calculatedDuration=w3(h));const{calculatedDuration:d}=h,m=d+i,p=m*(r+1)-i;return{generator:h,mirroredGenerator:l,mapPercentToKeyframes:u,calculatedDuration:d,resolvedDuration:m,totalDuration:p}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:i,generator:o,mirroredGenerator:s,mapPercentToKeyframes:a,keyframes:u,calculatedDuration:l,totalDuration:h,resolvedDuration:d}=r;if(this.startTime===null)return o.next(0);const{delay:m,repeat:p,repeatType:y,repeatDelay:b,onUpdate:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const E=this.currentTime-m*(this.speed>=0?1:-1),T=this.speed>=0?E<0:E>h;this.currentTime=Math.max(E,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let P=this.currentTime,I=o;if(p){const C=Math.min(this.currentTime,h)/d;let A=Math.floor(C),M=C%1;!M&&C>=1&&(M=1),M===1&&A--,A=Math.min(A,p+1),!!(A%2)&&(y==="reverse"?(M=1-M,b&&(M-=b/d)):y==="mirror"&&(I=s)),P=Zl(0,1,M)*d}const D=T?{done:!1,value:u[0]}:I.next(P);a&&(D.value=a(D.value));let{done:U}=D;!T&&l!==null&&(U=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const L=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&U);return L&&i!==void 0&&(D.value=W0(u,this.options,i)),x&&x(D.value),L&&this.finish(),D}get duration(){const{resolved:e}=this;return e?Jl(e.calculatedDuration):0}get time(){return Jl(this.currentTime)}set time(e){e=Ql(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Jl(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Z6,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const nM=new Set(["opacity","clipPath","filter","transform"]);function rM(n,e,t,{delay:r=0,duration:i=300,repeat:o=0,repeatType:s="loop",ease:a="easeInOut",times:u}={}){const l={[e]:t};u&&(l.offset=u);const h=_3(a,i);return Array.isArray(h)&&(l.easing=h),n.animate(l,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:o+1,direction:s==="reverse"?"alternate":"normal"})}const iM=fb(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Xv=10,oM=2e4;function sM(n){return Ib(n.type)||n.type==="spring"||!x3(n.ease)}function aM(n,e){const t=new jb({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let o=0;for(;!r.done&&o<oM;)r=t.sample(o),i.push(r.value),o+=Xv;return{times:void 0,keyframes:i,duration:o-Xv,ease:"linear"}}const rI={anticipate:L3,backInOut:D3,circInOut:O3};function uM(n){return n in rI}class lE extends Q3{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:o}=this.options;this.resolver=new Y3(o,(s,a)=>this.onKeyframesResolved(s,a),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:o,type:s,motionValue:a,name:u,startTime:l}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof o=="string"&&Gv()&&uM(o)&&(o=rI[o]),sM(this.options)){const{onComplete:d,onUpdate:m,motionValue:p,element:y,...b}=this.options,x=aM(e,b);e=x.keyframes,e.length===1&&(e[1]=e[0]),r=x.duration,i=x.times,o=x.ease,s="keyframes"}const h=rM(a.owner.current,u,e,{...this.options,duration:r,times:i,ease:o});return h.startTime=l??this.calcStartTime(),this.pendingTimeline?($5(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:d}=this.options;a.set(W0(e,this.options,t)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:s,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Jl(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Jl(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Ql(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return ya;const{animation:r}=t;$5(r,e)}return ya}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:o,ease:s,times:a}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:l,onUpdate:h,onComplete:d,element:m,...p}=this.options,y=new jb({...p,keyframes:r,duration:i,type:o,ease:s,times:a,isGenerator:!0}),b=Ql(this.time);l.setWithVelocity(y.sample(b-Xv).value,y.sample(b).value,Xv)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:o,damping:s,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:l}=t.owner.getProps();return iM()&&r&&nM.has(r)&&!u&&!l&&!i&&o!=="mirror"&&s!==0&&a!=="inertia"}}const lM={type:"spring",stiffness:500,damping:25,restSpeed:10},cM=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),hM={type:"keyframes",duration:.8},fM={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},dM=(n,{keyframes:e})=>e.length>2?hM:yf.has(n)?n.startsWith("scale")?cM(e[1]):lM:fM;function pM({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:o,repeatType:s,repeatDelay:a,from:u,elapsed:l,...h}){return!!Object.keys(h).length}const Ub=(n,e,t,r={},i,o)=>s=>{const a=Cb(r,n)||{},u=a.delay||r.delay||0;let{elapsed:l=0}=r;l=l-Ql(u);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-l,onUpdate:m=>{e.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{s(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:o?void 0:i};pM(a)||(h={...h,...dM(n,h)}),h.duration&&(h.duration=Ql(h.duration)),h.repeatDelay&&(h.repeatDelay=Ql(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let d=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(d=!0)),d&&!o&&e.get()!==void 0){const m=W0(h.keyframes,a);if(m!==void 0)return Nr.update(()=>{h.onUpdate(m),h.onComplete()}),new DL([])}return!o&&lE.supports(h)?new lE(h):new jb(h)};function mM({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function iI(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var o;let{transition:s=n.getDefaultTransition(),transitionEnd:a,...u}=e;r&&(s=r);const l=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const d in u){const m=n.getValue(d,(o=n.latestValues[d])!==null&&o!==void 0?o:null),p=u[d];if(p===void 0||h&&mM(h,d))continue;const y={delay:t,...Cb(s||{},d)};let b=!1;if(window.MotionHandoffAnimation){const E=T3(n);if(E){const T=window.MotionHandoffAnimation(E,d,Nr);T!==null&&(y.startTime=T,b=!0)}}U2(n,d),m.start(Ub(d,m,p,n.shouldReduceMotion&&C3.has(d)?{type:!1}:y,n,b));const x=m.animation;x&&l.push(x)}return a&&Promise.all(l).then(()=>{Nr.update(()=>{a&&$L(n,a)})}),l}function K2(n,e,t={}){var r;const i=z0(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:o=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(o=t.transitionOverride);const s=i?()=>Promise.all(iI(n,i,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(l=0)=>{const{delayChildren:h=0,staggerChildren:d,staggerDirection:m}=o;return gM(n,e,h+l,d,m,t)}:()=>Promise.resolve(),{when:u}=o;if(u){const[l,h]=u==="beforeChildren"?[s,a]:[a,s];return l().then(()=>h())}else return Promise.all([s(),a(t.delay)])}function gM(n,e,t=0,r=0,i=1,o){const s=[],a=(n.variantChildren.size-1)*r,u=i===1?(l=0)=>l*r:(l=0)=>a-l*r;return Array.from(n.variantChildren).sort(vM).forEach((l,h)=>{l.notify("AnimationStart",e),s.push(K2(l,e,{...o,delay:t+u(h)}).then(()=>l.notify("AnimationComplete",e)))}),Promise.all(s)}function vM(n,e){return n.sortNodePosition(e)}function yM(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(o=>K2(n,o,t));r=Promise.all(i)}else if(typeof e=="string")r=K2(n,e,t);else{const i=typeof e=="function"?z0(n,e,t.custom):e;r=Promise.all(iI(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const wM=pb.length;function oI(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?oI(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<wM;t++){const r=pb[t],i=n.props[r];(mm(i)||i===!1)&&(e[r]=i)}return e}const bM=[...db].reverse(),xM=db.length;function _M(n){return e=>Promise.all(e.map(({animation:t,options:r})=>yM(n,t,r)))}function EM(n){let e=_M(n),t=cE(),r=!0;const i=u=>(l,h)=>{var d;const m=z0(n,h,u==="exit"?(d=n.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(m){const{transition:p,transitionEnd:y,...b}=m;l={...l,...b,...y}}return l};function o(u){e=u(n)}function s(u){const{props:l}=n,h=oI(n.parent)||{},d=[],m=new Set;let p={},y=1/0;for(let x=0;x<xM;x++){const E=bM[x],T=t[E],P=l[E]!==void 0?l[E]:h[E],I=mm(P),D=E===u?T.isActive:null;D===!1&&(y=x);let U=P===h[E]&&P!==l[E]&&I;if(U&&r&&n.manuallyAnimateOnMount&&(U=!1),T.protectedKeys={...p},!T.isActive&&D===null||!P&&!T.prevProp||j0(P)||typeof P=="boolean")continue;const L=SM(T.prevProp,P);let C=L||E===u&&T.isActive&&!U&&I||x>y&&I,A=!1;const M=Array.isArray(P)?P:[P];let k=M.reduce(i(E),{});D===!1&&(k={});const{prevResolvedValues:O={}}=T,j={...O,...k},X=he=>{C=!0,m.has(he)&&(A=!0,m.delete(he)),T.needsAnimating[he]=!0;const $=n.getValue(he);$&&($.liveStyle=!1)};for(const he in j){const $=k[he],le=O[he];if(p.hasOwnProperty(he))continue;let ae=!1;B2($)&&B2(le)?ae=!y3($,le):ae=$!==le,ae?$!=null?X(he):m.add(he):$!==void 0&&m.has(he)?X(he):T.protectedKeys[he]=!0}T.prevProp=P,T.prevResolvedValues=k,T.isActive&&(p={...p,...k}),r&&n.blockInitialAnimation&&(C=!1),C&&(!(U&&L)||A)&&d.push(...M.map(he=>({animation:he,options:{type:E}})))}if(m.size){const x={};m.forEach(E=>{const T=n.getBaseTarget(E),P=n.getValue(E);P&&(P.liveStyle=!0),x[E]=T??null}),d.push({animation:x})}let b=!!d.length;return r&&(l.initial===!1||l.initial===l.animate)&&!n.manuallyAnimateOnMount&&(b=!1),r=!1,b?e(d):Promise.resolve()}function a(u,l){var h;if(t[u].isActive===l)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(m=>{var p;return(p=m.animationState)===null||p===void 0?void 0:p.setActive(u,l)}),t[u].isActive=l;const d=s(u);for(const m in t)t[m].protectedKeys={};return d}return{animateChanges:s,setActive:a,setAnimateFunction:o,getState:()=>t,reset:()=>{t=cE(),r=!0}}}function SM(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!y3(e,n):!1}function Wh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function cE(){return{animate:Wh(!0),whileInView:Wh(),whileHover:Wh(),whileTap:Wh(),whileDrag:Wh(),whileFocus:Wh(),exit:Wh()}}class yh{constructor(e){this.isMounted=!1,this.node=e}update(){}}class AM extends yh{constructor(e){super(e),e.animationState||(e.animationState=EM(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();j0(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let CM=0;class IM extends yh{constructor(){super(...arguments),this.id=CM++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const TM={animation:{Feature:AM},exit:{Feature:IM}};function wm(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function Um(n){return{point:{x:n.pageX,y:n.pageY}}}const kM=n=>e=>kb(e)&&n(e,Um(e));function tm(n,e,t,r){return wm(n,e,kM(t),r)}const hE=(n,e)=>Math.abs(n-e);function NM(n,e){const t=hE(n.x,e.x),r=hE(n.y,e.y);return Math.sqrt(t**2+r**2)}class sI{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=Ey(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,p=NM(d.offset,{x:0,y:0})>=3;if(!m&&!p)return;const{point:y}=d,{timestamp:b}=To;this.history.push({...y,timestamp:b});const{onStart:x,onMove:E}=this.handlers;m||(x&&x(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),E&&E(this.lastMoveEvent,d)},this.handlePointerMove=(d,m)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=_y(m,this.transformPagePoint),Nr.update(this.updatePoint,!0)},this.handlePointerUp=(d,m)=>{this.end();const{onEnd:p,onSessionEnd:y,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=Ey(d.type==="pointercancel"?this.lastMoveEventInfo:_y(m,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,x),y&&y(d,x)},!kb(e))return;this.dragSnapToOrigin=o,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const s=Um(e),a=_y(s,this.transformPagePoint),{point:u}=a,{timestamp:l}=To;this.history=[{...u,timestamp:l}];const{onSessionStart:h}=t;h&&h(e,Ey(a,this.history)),this.removeListeners=jm(tm(this.contextWindow,"pointermove",this.handlePointerMove),tm(this.contextWindow,"pointerup",this.handlePointerUp),tm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),sh(this.updatePoint)}}function _y(n,e){return e?{point:e(n.point)}:n}function fE(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Ey({point:n},e){return{point:n,delta:fE(n,aI(e)),offset:fE(n,RM(e)),velocity:PM(e,.1)}}function RM(n){return n[0]}function aI(n){return n[n.length-1]}function PM(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=aI(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ql(e)));)t--;if(!r)return{x:0,y:0};const o=Jl(i.timestamp-r.timestamp);if(o===0)return{x:0,y:0};const s={x:(i.x-r.x)/o,y:(i.y-r.y)/o};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}const uI=1e-4,DM=1-uI,LM=1+uI,lI=.01,MM=0-lI,OM=0+lI;function ba(n){return n.max-n.min}function FM(n,e,t){return Math.abs(n-e)<=t}function dE(n,e,t,r=.5){n.origin=r,n.originPoint=Xr(e.min,e.max,n.origin),n.scale=ba(t)/ba(e),n.translate=Xr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=DM&&n.scale<=LM||isNaN(n.scale))&&(n.scale=1),(n.translate>=MM&&n.translate<=OM||isNaN(n.translate))&&(n.translate=0)}function nm(n,e,t,r){dE(n.x,e.x,t.x,r?r.originX:void 0),dE(n.y,e.y,t.y,r?r.originY:void 0)}function pE(n,e,t){n.min=t.min+e.min,n.max=n.min+ba(e)}function BM(n,e,t){pE(n.x,e.x,t.x),pE(n.y,e.y,t.y)}function mE(n,e,t){n.min=e.min-t.min,n.max=n.min+ba(e)}function rm(n,e,t){mE(n.x,e.x,t.x),mE(n.y,e.y,t.y)}function VM(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Xr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Xr(t,n,r.max):Math.min(n,t)),n}function gE(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function jM(n,{top:e,left:t,bottom:r,right:i}){return{x:gE(n.x,t,i),y:gE(n.y,e,r)}}function vE(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function UM(n,e){return{x:vE(n.x,e.x),y:vE(n.y,e.y)}}function zM(n,e){let t=.5;const r=ba(n),i=ba(e);return i>r?t=Vd(e.min,e.max-r,n.min):r>i&&(t=Vd(n.min,n.max-i,e.min)),Zl(0,1,t)}function WM(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const X2=.35;function qM(n=X2){return n===!1?n=0:n===!0&&(n=X2),{x:yE(n,"left","right"),y:yE(n,"top","bottom")}}function yE(n,e,t){return{min:wE(n,e),max:wE(n,t)}}function wE(n,e){return typeof n=="number"?n:n[e]||0}const bE=()=>({translate:0,scale:1,origin:0,originPoint:0}),md=()=>({x:bE(),y:bE()}),xE=()=>({min:0,max:0}),gi=()=>({x:xE(),y:xE()});function za(n){return[n("x"),n("y")]}function cI({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function HM({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function GM(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function Sy(n){return n===void 0||n===1}function Y2({scale:n,scaleX:e,scaleY:t}){return!Sy(n)||!Sy(e)||!Sy(t)}function Hh(n){return Y2(n)||hI(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function hI(n){return _E(n.x)||_E(n.y)}function _E(n){return n&&n!=="0%"}function Yv(n,e,t){const r=n-t,i=e*r;return t+i}function EE(n,e,t,r,i){return i!==void 0&&(n=Yv(n,i,r)),Yv(n,t,r)+e}function Q2(n,e=0,t=1,r,i){n.min=EE(n.min,e,t,r,i),n.max=EE(n.max,e,t,r,i)}function fI(n,{x:e,y:t}){Q2(n.x,e.translate,e.scale,e.originPoint),Q2(n.y,t.translate,t.scale,t.originPoint)}const SE=.999999999999,AE=1.0000000000001;function $M(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let o,s;for(let a=0;a<i;a++){o=t[a],s=o.projectionDelta;const{visualElement:u}=o.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&vd(n,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),s&&(e.x*=s.x.scale,e.y*=s.y.scale,fI(n,s)),r&&Hh(o.latestValues)&&vd(n,o.latestValues))}e.x<AE&&e.x>SE&&(e.x=1),e.y<AE&&e.y>SE&&(e.y=1)}function gd(n,e){n.min=n.min+e,n.max=n.max+e}function CE(n,e,t,r,i=.5){const o=Xr(n.min,n.max,i);Q2(n,e,t,o,r)}function vd(n,e){CE(n.x,e.x,e.scaleX,e.scale,e.originX),CE(n.y,e.y,e.scaleY,e.scale,e.originY)}function dI(n,e){return cI(GM(n.getBoundingClientRect(),e))}function KM(n,e,t){const r=dI(n,t),{scroll:i}=e;return i&&(gd(r.x,i.offset.x),gd(r.y,i.offset.y)),r}const pI=({current:n})=>n?n.ownerDocument.defaultView:null,XM=new WeakMap;class YM{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=gi(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Um(h).point)},o=(h,d)=>{const{drag:m,dragPropagation:p,onDragStart:y}=this.getProps();if(m&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=zL(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),za(x=>{let E=this.getAxisMotionValue(x).get()||0;if(sl.test(E)){const{projection:T}=this.visualElement;if(T&&T.layout){const P=T.layout.layoutBox[x];P&&(E=ba(P)*(parseFloat(E)/100))}}this.originPoint[x]=E}),y&&Nr.postRender(()=>y(h,d)),U2(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},s=(h,d)=>{const{dragPropagation:m,dragDirectionLock:p,onDirectionLock:y,onDrag:b}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:x}=d;if(p&&this.currentDirection===null){this.currentDirection=QM(x),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,x),this.updateAxis("y",d.point,x),this.visualElement.render(),b&&b(h,d)},a=(h,d)=>this.stop(h,d),u=()=>za(h=>{var d;return this.getAnimationState(h)==="paused"&&((d=this.getAxisMotionValue(h).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:l}=this.getProps();this.panSession=new sI(e,{onSessionStart:i,onStart:o,onMove:s,onSessionEnd:a,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:l,contextWindow:pI(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&Nr.postRender(()=>o(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Kg(e,i,this.currentDirection))return;const o=this.getAxisMotionValue(e);let s=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(s=VM(s,this.constraints[e],this.elastic[e])),o.set(s)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,o=this.constraints;t&&dd(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=jM(i.layoutBox,t):this.constraints=!1,this.elastic=qM(r),o!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&za(s=>{this.constraints!==!1&&this.getAxisMotionValue(s)&&(this.constraints[s]=WM(i.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!dd(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=KM(r,i.root,this.visualElement.getTransformPagePoint());let s=UM(i.layout.layoutBox,o);if(t){const a=t(HM(s));this.hasMutatedConstraints=!!a,a&&(s=cI(a))}return s}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:o,dragSnapToOrigin:s,onDragTransitionEnd:a}=this.getProps(),u=this.constraints||{},l=za(h=>{if(!Kg(h,t,this.currentDirection))return;let d=u&&u[h]||{};s&&(d={min:0,max:0});const m=i?200:1e6,p=i?40:1e7,y={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...o,...d};return this.startAxisValueAnimation(h,y)});return Promise.all(l).then(a)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return U2(this.visualElement,e),r.start(Ub(e,r,0,t,this.visualElement,!1))}stopAnimation(){za(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){za(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){za(t=>{const{drag:r}=this.getProps();if(!Kg(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(t);if(i&&i.layout){const{min:s,max:a}=i.layout.layoutBox[t];o.set(e[t]-Xr(s,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!dd(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};za(s=>{const a=this.getAxisMotionValue(s);if(a&&this.constraints!==!1){const u=a.get();i[s]=zM({min:u,max:u},this.constraints[s])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),za(s=>{if(!Kg(s,e,null))return;const a=this.getAxisMotionValue(s),{min:u,max:l}=this.constraints[s];a.set(Xr(u,l,i[s]))})}addListeners(){if(!this.visualElement.current)return;XM.set(this.visualElement,this);const e=this.visualElement.current,t=tm(e,"pointerdown",u=>{const{drag:l,dragListener:h=!0}=this.getProps();l&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();dd(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Nr.read(r);const s=wm(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:l})=>{this.isDragging&&l&&(za(h=>{const d=this.getAxisMotionValue(h);d&&(this.originPoint[h]+=u[h].translate,d.set(d.get()+u[h].translate))}),this.visualElement.render())}));return()=>{s(),t(),o(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:s=X2,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:o,dragElastic:s,dragMomentum:a}}}function Kg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function QM(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class JM extends yh{constructor(e){super(e),this.removeGroupControls=ya,this.removeListeners=ya,this.controls=new YM(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ya}unmount(){this.removeGroupControls(),this.removeListeners()}}const IE=n=>(e,t)=>{n&&Nr.postRender(()=>n(e,t))};class ZM extends yh{constructor(){super(...arguments),this.removePointerDownListener=ya}onPointerDown(e){this.session=new sI(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:pI(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:IE(e),onStart:IE(t),onMove:r,onEnd:(o,s)=>{delete this.session,i&&Nr.postRender(()=>i(o,s))}}}mount(){this.removePointerDownListener=tm(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Cv={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function TE(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Bp={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(sn.test(n))n=parseFloat(n);else return n;const t=TE(n,e.target.x),r=TE(n,e.target.y);return`${t}% ${r}%`}},eO={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=ah.parse(n);if(i.length>5)return r;const o=ah.createTransformer(n),s=typeof i[0]!="number"?1:0,a=t.x.scale*e.x,u=t.y.scale*e.y;i[0+s]/=a,i[1+s]/=u;const l=Xr(a,u,.5);return typeof i[2+s]=="number"&&(i[2+s]/=l),typeof i[3+s]=="number"&&(i[3+s]/=l),o(i)}};class tO extends $e.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:o}=e;xL(nO),o&&(t.group&&t.group.add(o),r&&r.register&&i&&r.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),Cv.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:o}=this.props,s=r.projection;return s&&(s.isPresent=o,i||e.layoutDependency!==t||t===void 0?s.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?s.promote():s.relegate()||Nr.postRender(()=>{const a=s.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),gb.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function mI(n){const[e,t]=Q4(),r=$e.useContext(ub);return se.jsx(tO,{...n,layoutGroup:r,switchLayoutGroup:$e.useContext(o3),isPresent:e,safeToRemove:t})}const nO={borderRadius:{...Bp,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Bp,borderTopRightRadius:Bp,borderBottomLeftRadius:Bp,borderBottomRightRadius:Bp,boxShadow:eO};function rO(n,e,t){const r=as(n)?n:vm(n);return r.start(Ub("",r,e,t)),r.animation}function iO(n){return n instanceof SVGElement&&n.tagName!=="svg"}const oO=(n,e)=>n.depth-e.depth;class sO{constructor(){this.children=[],this.isDirty=!1}add(e){Nb(this.children,e),this.isDirty=!0}remove(e){Rb(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(oO),this.isDirty=!1,this.children.forEach(e)}}function aO(n,e){const t=al.now(),r=({timestamp:i})=>{const o=i-t;o>=e&&(sh(r),n(o-e))};return Nr.read(r,!0),()=>sh(r)}const gI=["TopLeft","TopRight","BottomLeft","BottomRight"],uO=gI.length,kE=n=>typeof n=="string"?parseFloat(n):n,NE=n=>typeof n=="number"||sn.test(n);function lO(n,e,t,r,i,o){i?(n.opacity=Xr(0,t.opacity!==void 0?t.opacity:1,cO(r)),n.opacityExit=Xr(e.opacity!==void 0?e.opacity:1,0,hO(r))):o&&(n.opacity=Xr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let s=0;s<uO;s++){const a=`border${gI[s]}Radius`;let u=RE(e,a),l=RE(t,a);if(u===void 0&&l===void 0)continue;u||(u=0),l||(l=0),u===0||l===0||NE(u)===NE(l)?(n[a]=Math.max(Xr(kE(u),kE(l),r),0),(sl.test(l)||sl.test(u))&&(n[a]+="%")):n[a]=l}(e.rotate||t.rotate)&&(n.rotate=Xr(e.rotate||0,t.rotate||0,r))}function RE(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const cO=vI(0,.5,M3),hO=vI(.5,.95,ya);function vI(n,e,t){return r=>r<n?0:r>e?1:t(Vd(n,e,r))}function PE(n,e){n.min=e.min,n.max=e.max}function Ua(n,e){PE(n.x,e.x),PE(n.y,e.y)}function DE(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function LE(n,e,t,r,i){return n-=e,n=Yv(n,1/t,r),i!==void 0&&(n=Yv(n,1/i,r)),n}function fO(n,e=0,t=1,r=.5,i,o=n,s=n){if(sl.test(e)&&(e=parseFloat(e),e=Xr(s.min,s.max,e/100)-s.min),typeof e!="number")return;let a=Xr(o.min,o.max,r);n===o&&(a-=e),n.min=LE(n.min,e,t,a,i),n.max=LE(n.max,e,t,a,i)}function ME(n,e,[t,r,i],o,s){fO(n,e[t],e[r],e[i],e.scale,o,s)}const dO=["x","scaleX","originX"],pO=["y","scaleY","originY"];function OE(n,e,t,r){ME(n.x,e,dO,t?t.x:void 0,r?r.x:void 0),ME(n.y,e,pO,t?t.y:void 0,r?r.y:void 0)}function FE(n){return n.translate===0&&n.scale===1}function yI(n){return FE(n.x)&&FE(n.y)}function BE(n,e){return n.min===e.min&&n.max===e.max}function mO(n,e){return BE(n.x,e.x)&&BE(n.y,e.y)}function VE(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function wI(n,e){return VE(n.x,e.x)&&VE(n.y,e.y)}function jE(n){return ba(n.x)/ba(n.y)}function UE(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class gO{constructor(){this.members=[]}add(e){Nb(this.members,e),e.scheduleRender()}remove(e){if(Rb(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){r=o;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function vO(n,e,t){let r="";const i=n.x.translate/e.x,o=n.y.translate/e.y,s=(t==null?void 0:t.z)||0;if((i||o||s)&&(r=`translate3d(${i}px, ${o}px, ${s}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:l,rotate:h,rotateX:d,rotateY:m,skewX:p,skewY:y}=t;l&&(r=`perspective(${l}px) ${r}`),h&&(r+=`rotate(${h}deg) `),d&&(r+=`rotateX(${d}deg) `),m&&(r+=`rotateY(${m}deg) `),p&&(r+=`skewX(${p}deg) `),y&&(r+=`skewY(${y}deg) `)}const a=n.x.scale*e.x,u=n.y.scale*e.y;return(a!==1||u!==1)&&(r+=`scale(${a}, ${u})`),r||"none"}const Gh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},$p=typeof window<"u"&&window.MotionDebug!==void 0,Ay=["","X","Y","Z"],yO={visibility:"hidden"},zE=1e3;let wO=0;function Cy(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function bI(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=T3(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:o}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Nr,!(i||o))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&bI(r)}function xI({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(s={},a=e==null?void 0:e()){this.id=wO++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,$p&&(Gh.totalNodes=Gh.resolvedTargetDeltas=Gh.recalculatedProjection=0),this.nodes.forEach(_O),this.nodes.forEach(IO),this.nodes.forEach(TO),this.nodes.forEach(EO),$p&&window.MotionDebug.record(Gh)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new sO)}addEventListener(s,a){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new Pb),this.eventHandlers.get(s).add(a)}notifyListeners(s,...a){const u=this.eventHandlers.get(s);u&&u.notify(...a)}hasListeners(s){return this.eventHandlers.has(s)}mount(s,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=iO(s),this.instance=s;const{layoutId:u,layout:l,visualElement:h}=this.options;if(h&&!h.current&&h.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(l||u)&&(this.isLayoutDirty=!0),n){let d;const m=()=>this.root.updateBlockedByResize=!1;n(s,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=aO(m,250),Cv.hasAnimatedSinceResize&&(Cv.hasAnimatedSinceResize=!1,this.nodes.forEach(qE))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&h&&(u||l)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:m,hasRelativeTargetChanged:p,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||h.getDefaultTransition()||DO,{onLayoutAnimationStart:x,onLayoutAnimationComplete:E}=h.getProps(),T=!this.targetLayout||!wI(this.targetLayout,y)||p,P=!m&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||P||m&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,P);const I={...Cb(b,"layout"),onPlay:x,onComplete:E};(h.shouldReduceMotion||this.options.layoutRoot)&&(I.delay=0,I.type=!1),this.startAnimation(I)}else m||qE(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,sh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(kO),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&bI(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const d=this.path[h];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:u}=this.options;if(a===void 0&&!u)return;const l=this.getTransformTemplate();this.prevTransformTemplateValue=l?l(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(WE);return}this.isUpdating||this.nodes.forEach(AO),this.isUpdating=!1,this.nodes.forEach(CO),this.nodes.forEach(bO),this.nodes.forEach(xO),this.clearAllSnapshots();const a=al.now();To.delta=Zl(0,1e3/60,a-To.timestamp),To.timestamp=a,To.isProcessing=!0,gy.update.process(To),gy.preRender.process(To),gy.render.process(To),To.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,gb.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(SO),this.sharedNodes.forEach(NO)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Nr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Nr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=gi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(a=!1),a){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:s,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const s=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!yI(this.projectionDelta),u=this.getTransformTemplate(),l=u?u(this.latestValues,""):void 0,h=l!==this.prevTransformTemplateValue;s&&(a||Hh(this.latestValues)||h)&&(i(this.instance,l),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const a=this.measurePageBox();let u=this.removeElementScroll(a);return s&&(u=this.removeTransform(u)),LO(u),{animationId:this.root.animationId,measuredBox:a,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var s;const{visualElement:a}=this.options;if(!a)return gi();const u=a.measureViewportBox();if(!(((s=this.scroll)===null||s===void 0?void 0:s.wasRoot)||this.path.some(MO))){const{scroll:h}=this.root;h&&(gd(u.x,h.offset.x),gd(u.y,h.offset.y))}return u}removeElementScroll(s){var a;const u=gi();if(Ua(u,s),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return u;for(let l=0;l<this.path.length;l++){const h=this.path[l],{scroll:d,options:m}=h;h!==this.root&&d&&m.layoutScroll&&(d.wasRoot&&Ua(u,s),gd(u.x,d.offset.x),gd(u.y,d.offset.y))}return u}applyTransform(s,a=!1){const u=gi();Ua(u,s);for(let l=0;l<this.path.length;l++){const h=this.path[l];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&vd(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Hh(h.latestValues)&&vd(u,h.latestValues)}return Hh(this.latestValues)&&vd(u,this.latestValues),u}removeTransform(s){const a=gi();Ua(a,s);for(let u=0;u<this.path.length;u++){const l=this.path[u];if(!l.instance||!Hh(l.latestValues))continue;Y2(l.latestValues)&&l.updateSnapshot();const h=gi(),d=l.measurePageBox();Ua(h,d),OE(a,l.latestValues,l.snapshot?l.snapshot.layoutBox:void 0,h)}return Hh(this.latestValues)&&OE(a,this.latestValues),a}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==To.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){var a;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==u;if(!(s||l&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:m}=this.options;if(!(!this.layout||!(d||m))){if(this.resolvedRelativeTargetAt=To.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=gi(),this.relativeTargetOrigin=gi(),rm(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),Ua(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=gi(),this.targetWithTransforms=gi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),BM(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ua(this.target,this.layout.layoutBox),fI(this.target,this.targetDelta)):Ua(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=gi(),this.relativeTargetOrigin=gi(),rm(this.relativeTargetOrigin,this.target,p.target),Ua(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}$p&&Gh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Y2(this.parent.latestValues)||hI(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var s;const a=this.getLead(),u=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty)&&(l=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===To.timestamp&&(l=!1),l)return;const{layout:h,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||d))return;Ua(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,p=this.treeScale.y;$M(this.layoutCorrected,this.treeScale,this.path,u),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=gi());const{target:y}=a;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(DE(this.prevProjectionDelta.x,this.projectionDelta.x),DE(this.prevProjectionDelta.y,this.projectionDelta.y)),nm(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==p||!UE(this.projectionDelta.x,this.prevProjectionDelta.x)||!UE(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),$p&&Gh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),s){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=md(),this.projectionDelta=md(),this.projectionDeltaWithTransform=md()}setAnimationOrigin(s,a=!1){const u=this.snapshot,l=u?u.latestValues:{},h={...this.latestValues},d=md();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=gi(),p=u?u.source:void 0,y=this.layout?this.layout.source:void 0,b=p!==y,x=this.getStack(),E=!x||x.members.length<=1,T=!!(b&&!E&&this.options.crossfade===!0&&!this.path.some(PO));this.animationProgress=0;let P;this.mixTargetDelta=I=>{const D=I/1e3;HE(d.x,s.x,D),HE(d.y,s.y,D),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(rm(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),RO(this.relativeTarget,this.relativeTargetOrigin,m,D),P&&mO(this.relativeTarget,P)&&(this.isProjectionDirty=!1),P||(P=gi()),Ua(P,this.relativeTarget)),b&&(this.animationValues=h,lO(h,l,this.latestValues,D,T,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(sh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Nr.update(()=>{Cv.hasAnimatedSinceResize=!0,this.currentAnimation=rO(0,zE,{...s,onUpdate:a=>{this.mixTargetDelta(a),s.onUpdate&&s.onUpdate(a)},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(zE),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:a,target:u,layout:l,latestValues:h}=s;if(!(!a||!u||!l)){if(this!==s&&this.layout&&l&&_I(this.options.animationType,this.layout.layoutBox,l.layoutBox)){u=this.target||gi();const d=ba(this.layout.layoutBox.x);u.x.min=s.target.x.min,u.x.max=u.x.min+d;const m=ba(this.layout.layoutBox.y);u.y.min=s.target.y.min,u.y.max=u.y.min+m}Ua(a,u),vd(a,h),nm(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(s,a){this.sharedNodes.has(s)||this.sharedNodes.set(s,new gO),this.sharedNodes.get(s).add(a);const l=a.options.initialPromotionConfig;a.promote({transition:l?l.transition:void 0,preserveFollowOpacity:l&&l.shouldPreserveFollowOpacity?l.shouldPreserveFollowOpacity(a):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){var s;const{layoutId:a}=this.options;return a?((s=this.getStack())===null||s===void 0?void 0:s.lead)||this:this}getPrevLead(){var s;const{layoutId:a}=this.options;return a?(s=this.getStack())===null||s===void 0?void 0:s.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:a,preserveFollowOpacity:u}={}){const l=this.getStack();l&&l.promote(this,u),s&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetSkewAndRotation(){const{visualElement:s}=this.options;if(!s)return;let a=!1;const{latestValues:u}=s;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(a=!0),!a)return;const l={};u.z&&Cy("z",s,l,this.animationValues);for(let h=0;h<Ay.length;h++)Cy(`rotate${Ay[h]}`,s,l,this.animationValues),Cy(`skew${Ay[h]}`,s,l,this.animationValues);s.render();for(const h in l)s.setStaticValue(h,l[h]),this.animationValues&&(this.animationValues[h]=l[h]);s.scheduleRender()}getProjectionStyles(s){var a,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return yO;const l={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,l.opacity="",l.pointerEvents=Sv(s==null?void 0:s.pointerEvents)||"",l.transform=h?h(this.latestValues,""):"none",l;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const b={};return this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=Sv(s==null?void 0:s.pointerEvents)||""),this.hasProjected&&!Hh(this.latestValues)&&(b.transform=h?h({},""):"none",this.hasProjected=!1),b}const m=d.animationValues||d.latestValues;this.applyTransformsToTarget(),l.transform=vO(this.projectionDeltaWithTransform,this.treeScale,m),h&&(l.transform=h(m,l.transform));const{x:p,y}=this.projectionDelta;l.transformOrigin=`${p.origin*100}% ${y.origin*100}% 0`,d.animationValues?l.opacity=d===this?(u=(a=m.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:l.opacity=d===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const b in Hv){if(m[b]===void 0)continue;const{correct:x,applyTo:E}=Hv[b],T=l.transform==="none"?m[b]:x(m[b],d);if(E){const P=E.length;for(let I=0;I<P;I++)l[E[I]]=T}else l[b]=T}return this.options.layoutId&&(l.pointerEvents=d===this?Sv(s==null?void 0:s.pointerEvents)||"":"none"),l}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>{var a;return(a=s.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(WE),this.root.sharedNodes.clear()}}}function bO(n){n.updateLayout()}function xO(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:o}=n.options,s=t.source!==n.layout.source;o==="size"?za(d=>{const m=s?t.measuredBox[d]:t.layoutBox[d],p=ba(m);m.min=r[d].min,m.max=m.min+p}):_I(o,t.layoutBox,r)&&za(d=>{const m=s?t.measuredBox[d]:t.layoutBox[d],p=ba(r[d]);m.max=m.min+p,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[d].max=n.relativeTarget[d].min+p)});const a=md();nm(a,r,t.layoutBox);const u=md();s?nm(u,n.applyTransform(i,!0),t.measuredBox):nm(u,r,t.layoutBox);const l=!yI(a);let h=!1;if(!n.resumeFrom){const d=n.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:m,layout:p}=d;if(m&&p){const y=gi();rm(y,t.layoutBox,m.layoutBox);const b=gi();rm(b,r,p.layoutBox),wI(y,b)||(h=!0),d.options.layoutRoot&&(n.relativeTarget=b,n.relativeTargetOrigin=y,n.relativeParent=d)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:u,layoutDelta:a,hasLayoutChanged:l,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function _O(n){$p&&Gh.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function EO(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function SO(n){n.clearSnapshot()}function WE(n){n.clearMeasurements()}function AO(n){n.isLayoutDirty=!1}function CO(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function qE(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function IO(n){n.resolveTargetDelta()}function TO(n){n.calcProjection()}function kO(n){n.resetSkewAndRotation()}function NO(n){n.removeLeadSnapshot()}function HE(n,e,t){n.translate=Xr(e.translate,0,t),n.scale=Xr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function GE(n,e,t,r){n.min=Xr(e.min,t.min,r),n.max=Xr(e.max,t.max,r)}function RO(n,e,t,r){GE(n.x,e.x,t.x,r),GE(n.y,e.y,t.y,r)}function PO(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const DO={duration:.45,ease:[.4,0,.1,1]},$E=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),KE=$E("applewebkit/")&&!$E("chrome/")?Math.round:ya;function XE(n){n.min=KE(n.min),n.max=KE(n.max)}function LO(n){XE(n.x),XE(n.y)}function _I(n,e,t){return n==="position"||n==="preserve-aspect"&&!FM(jE(e),jE(t),.2)}function MO(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const OO=xI({attachResizeListener:(n,e)=>wm(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Iy={current:void 0},EI=xI({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!Iy.current){const n=new OO({});n.mount(window),n.setOptions({layoutScroll:!0}),Iy.current=n}return Iy.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),FO={pan:{Feature:ZM},drag:{Feature:JM,ProjectionNode:EI,MeasureLayout:mI}};function YE(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,o=r[i];o&&Nr.postRender(()=>o(e,Um(e)))}class BO extends yh{mount(){const{current:e}=this.node;e&&(this.unmount=FL(e,t=>(YE(this.node,t,"Start"),r=>YE(this.node,r,"End"))))}unmount(){}}class VO extends yh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=jm(wm(this.node.current,"focus",()=>this.onFocus()),wm(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function QE(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),o=r[i];o&&Nr.postRender(()=>o(e,Um(e)))}class jO extends yh{mount(){const{current:e}=this.node;e&&(this.unmount=UL(e,t=>(QE(this.node,t,"Start"),(r,{success:i})=>QE(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const J2=new WeakMap,Ty=new WeakMap,UO=n=>{const e=J2.get(n.target);e&&e(n)},zO=n=>{n.forEach(UO)};function WO({root:n,...e}){const t=n||document;Ty.has(t)||Ty.set(t,{});const r=Ty.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(zO,{root:n,...e})),r[i]}function qO(n,e,t){const r=WO(e);return J2.set(n,t),r.observe(n),()=>{J2.delete(n),r.unobserve(n)}}const HO={some:0,all:1};class GO extends yh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:o}=e,s={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:HO[i]},a=u=>{const{isIntersecting:l}=u;if(this.isInView===l||(this.isInView=l,o&&!l&&this.hasEnteredView))return;l&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",l);const{onViewportEnter:h,onViewportLeave:d}=this.node.getProps(),m=l?h:d;m&&m(u)};return qO(this.node.current,s,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some($O(e,t))&&this.startObserver()}unmount(){}}function $O({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const KO={inView:{Feature:GO},tap:{Feature:jO},focus:{Feature:VO},hover:{Feature:BO}},XO={layout:{ProjectionNode:EI,MeasureLayout:mI}},Z2={current:null},SI={current:!1};function YO(){if(SI.current=!0,!!hb)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Z2.current=n.matches;n.addListener(e),e()}else Z2.current=!1}const QO=[...X3,es,ah],JO=n=>QO.find(K3(n)),JE=new WeakMap;function ZO(n,e,t){for(const r in e){const i=e[r],o=t[r];if(as(i))n.addValue(r,i);else if(as(o))n.addValue(r,vm(i,{owner:n}));else if(o!==i)if(n.hasValue(r)){const s=n.getValue(r);s.liveStyle===!0?s.jump(i):s.hasAnimated||s.set(i)}else{const s=n.getStaticValue(r);n.addValue(r,vm(s!==void 0?s:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const ZE=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class eF{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:o,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Bb,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=al.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,Nr.render(this.render,!1,!0))};const{latestValues:u,renderState:l,onUpdate:h}=s;this.onUpdate=h,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=U0(t),this.isVariantNode=r3(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const p in m){const y=m[p];u[p]!==void 0&&as(y)&&y.set(u[p],!1)}}mount(e){this.current=e,JE.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),SI.current||YO(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Z2.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){JE.delete(this.current),this.projection&&this.projection.unmount(),sh(this.notifyUpdate),sh(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=yf.has(e),i=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Nr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),o=t.on("renderRequest",this.scheduleRender);let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),o(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in jd){const t=jd[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):gi()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<ZE.length;r++){const i=ZE[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o="on"+i,s=e[o];s&&(this.propEventSubscriptions[i]=this.on(i,s))}this.prevMotionValues=ZO(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=vm(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(G3(i)||F3(i))?i=parseFloat(i):!JO(i)&&ah.test(t)&&(i=W3(e,t)),this.setBaseTarget(e,as(i)?i.get():i)),as(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const s=yb(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);s&&(i=s[e])}if(r&&i!==void 0)return i;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!as(o)?o:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Pb),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class AI extends eF{constructor(){super(...arguments),this.KeyframeResolver=Y3}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;as(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function tF(n){return window.getComputedStyle(n)}class nF extends AI{constructor(){super(...arguments),this.type="html",this.renderInstance=f3}readValueFromInstance(e,t){if(yf.has(t)){const r=Fb(t);return r&&r.default||0}else{const r=tF(e),i=(l3(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return dI(e,t)}build(e,t,r){xb(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return Ab(e,t,r)}}class rF extends AI{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=gi}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(yf.has(t)){const r=Fb(t);return r&&r.default||0}return t=d3.has(t)?t:mb(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return g3(e,t,r)}build(e,t,r){_b(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){p3(e,t,r,i)}mount(e){this.isSVGTag=Sb(e.tagName),super.mount(e)}}const iF=(n,e)=>vb(n)?new rF(e):new nF(e,{allowProjection:n!==$e.Fragment}),oF=NL({...TM,...KO,...FO,...XO},iF),eS=HD(oF),sF=({isOpen:n,onClose:e,onOpenSettings:t})=>{const{setActiveMode:r,playSound:i,speak:o}=Eu(),[s,a]=$e.useState(null),u=160,d=s==="COMMS"?[{id:"whatsapp",label:"WHATSAPP",icon:"fab fa-whatsapp",angle:225,url:"https://wa.me/"},{id:"messenger",label:"MESSENGER",icon:"fab fa-facebook-messenger",angle:180,url:"https://m.me/"},{id:"viber",label:"VIBER",icon:"fab fa-viber",angle:135,url:"viber://forward?text=Status%20Check"},{id:"facebook",label:"FACEBOOK",icon:"fab fa-facebook-f",angle:90,url:"https://facebook.com/"},{id:"instagram",label:"INSTAGRAM",icon:"fab fa-instagram",angle:45,url:"https://instagram.com/"},{id:"x",label:"X",icon:"fab fa-x-twitter",angle:0,url:"https://x.com/"},{id:"youtube",label:"YOUTUBE",icon:"fab fa-youtube",angle:-45,url:"https://youtube.com/"},{id:"back",label:"BACK",icon:"fa-undo",angle:-90,action:()=>a(null)}]:[{id:"hud",label:"DRIVE",icon:"fa-car",angle:-90,action:()=>{r("HUD"),o("Driving protocols initiated.")}},{id:"database",label:"DATABASE",icon:"fa-database",angle:-45,action:()=>{r("DATABASE"),o("Accessing personnel records.")}},{id:"recon",label:"RECON",icon:"fa-search-location",angle:0,action:()=>{r("RECON"),o("Sales targeting engaged.")}},{id:"ops",label:"OPS LOG",icon:"fa-file-medical-alt",angle:45,action:()=>{r("OPS"),o("Operations center online.")}},{id:"media",label:"MEDIA",icon:"fa-music",angle:90,action:()=>{r("MEDIA"),o("Media player ready.")}},{id:"vision",label:"VISION",icon:"fa-eye",angle:135,action:()=>{r("VISION"),o("Vision systems active.")}},{id:"guardian",label:"GUARDIAN",icon:"fa-shield-alt",angle:180,action:()=>{r("GUARDIAN")}},{id:"comms",label:"COMMS",icon:"fa-comments",angle:225,action:()=>{a("COMMS"),o("Comms open.")}}],m=y=>{const b=y*Math.PI/180;return{x:Math.cos(b)*u,y:Math.sin(b)*u*.8}},p=y=>{i("click"),y.url?(o(`Opening ${y.label}`),y.url.startsWith("viber://")||y.url.startsWith("whatsapp://")?window.location.href=y.url:window.open(y.url,"_blank")):y.action&&y.action(),y.id!=="comms"&&y.id!=="back"&&(e(),a(null))};return se.jsx(FD,{children:n&&se.jsx(eS.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 backdrop-blur-[2px]",onClick:()=>{e(),a(null)},children:se.jsxs("div",{className:"relative w-0 h-0 flex items-center justify-center",onClick:y=>y.stopPropagation(),children:[se.jsx("div",{className:"absolute w-32 h-32 rounded-full cursor-pointer",onClick:()=>{e(),a(null)}}),d.map((y,b)=>{const x=m(y.angle);return se.jsxs(eS.button,{initial:{x:0,y:0,scale:0,opacity:0},animate:{x:x.x,y:x.y,scale:1,opacity:1},exit:{x:0,y:0,scale:0,opacity:0},transition:{type:"spring",stiffness:200,damping:20,delay:b*.03},onClick:()=>p(y),className:`
                    absolute w-20 h-20 rounded-full border border-cyan/50 bg-black/80
                    flex flex-col items-center justify-center gap-1
                    shadow-[0_0_15px_rgba(0,229,255,0.2)]
                    hover:scale-110 hover:border-cyan hover:bg-cyan/20 hover:shadow-[0_0_25px_rgba(0,229,255,0.6)]
                    active:scale-95 transition-all
                    ${y.id==="back"?"border-red-500/50 text-red-500 hover:border-red-500":"text-cyan"}
                  `,children:[se.jsx("i",{className:`fas ${y.icon} text-2xl`}),se.jsx("span",{className:"font-orbitron text-[8px] tracking-wider mt-1",children:y.label}),se.jsx("div",{className:"absolute top-1/2 left-1/2 w-[160px] h-[1px] bg-cyan/20 -z-10 origin-left pointer-events-none",style:{transform:`rotate(${y.angle+180}deg)`,width:`${u}px`,left:"50%",top:"50%"}})]},y.id)})]})})})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var CI=function(n,e){return(CI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])})(n,e)};function Su(n,e){function t(){this.constructor=n}CI(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Nt(n,e,t,r){return new(t||(t=Promise))((function(i,o){function s(l){try{u(r.next(l))}catch(h){o(h)}}function a(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):new t((function(h){h(l.value)})).then(s,a)}u((r=r.apply(n,[])).next())}))}function Rt(n,e){var t,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(i=2&h[0]?r.return:h[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,h[1])).done)return i;switch(r=0,i&&(h=[2&h[0],i.value]),h[0]){case 0:case 1:i=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,r=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(h[0]===6||h[0]===2)){s=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){s.label=h[1];break}if(h[0]===6&&s.label<i[1]){s.label=i[1],i=h;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(h);break}i[2]&&s.ops.pop(),s.trys.pop();continue}h=e.call(n,s)}catch(d){h=[6,d],r=0}finally{t=i=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([u,l])}}}var aF=(function(){function n(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return n.prototype.setPlatform=function(e,t){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},n.prototype.registerFlag=function(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){var i=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+i+"."),this.set(e,i)}},n.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},n.prototype.getNumber=function(e){return this.get(e)},n.prototype.getBool=function(e){return this.get(e)},n.prototype.getFlags=function(){return this.flags},Object.defineProperty(n.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),n.prototype.set=function(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)},n.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},n.prototype.setFlags=function(e){this.flags=Object.assign({},e)},n.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},n.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var t,r,i=(t=this.global.location.search,r={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(o){for(var s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];return uF(r,s[0],s[1]),s.join("=")})),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach((function(o){var s=o.split(":"),a=s[0],u=s[1];e.urlFlags[a]=(function(l,h){if((h=h.toLowerCase())==="true"||h==="false")return h==="true";if(""+ +h===h)return+h;throw new Error("Could not parse value flag value "+h+" for flag "+l+".")})(a,u)}))}},n})();function uF(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function Ye(){return II}var II=null,Qv=new Map,ew=new Map;function TI(n,e){var t=NI(n,e);return Qv.get(t)}function lF(n){return ew.get(n)}function tS(n){for(var e=Qv.entries(),t=[];;){var r=e.next(),i=r.done,o=r.value;if(i)break;var s=o[0],a=o[1];s.split("_")[0]===n&&t.push(a)}return t}function kI(n){var e=n.kernelName,t=n.backendName,r=NI(e,t);if(Qv.has(r))throw new Error("The kernel '"+e+"' for backend '"+t+"' is already registered");Qv.set(r,n)}function cF(n){var e=n.kernelName;ew.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),ew.set(e,n)}function NI(n,e){return e+"_"+n}function tw(n,e,t){return Math.max(n,Math.min(e,t))}function RI(n){return n%2==0?n:n+1}function hF(n){for(var e=0,t=0;t<n.length;t++)e+=n[t];return e}function me(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function ir(n,e,t){t===void 0&&(t=""),me(po(n,e),(function(){return t+" Shapes "+n+" and "+e+" must match"}))}function rp(n){me(n!=null,(function(){return"The input to the tensor constructor must be a non-null value."}))}function zd(n,e,t){if(e===void 0&&(e=[]),t===void 0&&(t=!1),e==null&&(e=[]),Array.isArray(n)||ul(n)&&!t)for(var r=0;r<n.length;++r)zd(n[r],e,t);else e.push(n);return e}function Mt(n){if(n.length===0)return 1;for(var e=n[0],t=1;t<n.length;t++)e*=n[t];return e}function po(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function xi(n){return n%1==0}function fF(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;var e=Math.exp(2*n);return(e-1)/(e+1)}function nw(n){var e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function bd(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function nS(n,e,t){return e===void 0&&(e=function(r){return 0}),new Promise((function(r,i){var o=0,s=function(){if(n())r();else{o++;var a=e(o);t!=null&&o>=t?i():setTimeout(s,a)}};s()}))}function dF(n,e){for(var t=1,r=-1,i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(n[i]<0)throw Error("Shapes can not be < 0. Found "+n[i]+" at dim "+i);if(r===-1){if(e>0&&e!==t)throw Error("Size("+e+") must match the product of shape "+n);return n}if(t===0)throw Error("Cannot infer the missing size in ["+n+"] when there are 0 elements");if(e%t!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+t);var o=n.slice();return o[r]=e/t,o}function Xi(n,e){var t=e.length;return me((n=n==null?e.map((function(r,i){return i})):[].concat(n)).every((function(r){return r>=-t&&r<t})),(function(){return"All values in axis param must be in range [-"+t+", "+t+") but got axis "+n})),me(n.every((function(r){return xi(r)})),(function(){return"All values in axis param must be integers but got axis "+n})),n.map((function(r){return r<0?t+r:r}))}function Qh(n,e){for(var t=[],r=[],i=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||i?null:Xi(e,n).sort(),s=0,a=0;a<n.length;++a){if(o!=null){if(o[s]===a&&n[a]!==1)throw new Error("Can't squeeze axis "+a+" since its dim '"+n[a]+"' is not 1");(o[s]==null||o[s]>a)&&n[a]===1&&(t.push(n[a]),r.push(a)),o[s]<=a&&s++}n[a]!==1&&(t.push(n[a]),r.push(a))}return{newShape:t,keptDims:r}}function bm(n,e){var t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else{if(n!=="bool")throw new Error("Unknown data type "+n);t=new Uint8Array(e)}return t}function Jv(n,e){var t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else{if(n!=="string")throw new Error("Unknown data type "+n);t=new Array(e)}return t}function pF(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function mF(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function gF(n,e){return e!=="complex64"&&(e!=="float32"||n==="complex64")&&(e!=="int32"||n==="float32"||n==="complex64")&&(e!=="bool"||n!=="bool")}function ul(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array}function PI(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error("Unknown dtype "+n)}function vF(n){if(n==null)return 0;var e=0;return n.forEach((function(t){return e+=t.length})),e}function zb(n){return typeof n=="string"||n instanceof String}function yF(n){return typeof n=="boolean"}function wF(n){return typeof n=="number"}function zm(n){return Array.isArray(n)?zm(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array?"int32":wF(n)?"float32":zb(n)?"string":yF(n)?"bool":"float32"}function rw(n){return!!(n&&n.constructor&&n.call&&n.apply)}function iw(n,e){for(var t=e;t<n;++t)if(n%t==0)return t;return n}function ll(n){var e=n.length;if(e<2)return[];var t=new Array(e-1);t[e-2]=n[e-1];for(var r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function DI(n,e,t){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=zd(n)),t&&pF(n,e),(function(o,s){return o instanceof Float32Array&&s==="float32"||o instanceof Int32Array&&s==="int32"||o instanceof Uint8Array&&s==="bool"})(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){for(var r=new Uint8Array(n.length),i=0;i<r.length;++i)Math.round(n[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function rS(n,e){if(n.length===0)return e[0];var t=n.reduce((function(r,i){return r*i}));if(t===0)return[];if(t!==e.length)throw new Error("["+n+"] does not match the input size.");return(function r(i,o,s){var a=new Array;if(o.length===1)for(var u=o[0],l=0;l<u;l++)a[l]=s[i+l];else{u=o[0];var h=o.slice(1),d=h.reduce((function(m,p){return m*p}));for(l=0;l<u;l++)a[l]=r(i+l*d,h,s)}return a})(0,n,e)}function LI(n,e){for(var t=Wm(n,e),r=0;r<t.length;r++)t[r]=1;return t}function Wm(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error("Unknown data type "+e)}function Zu(){return Ye().platform.now()}function MI(n){n.forEach((function(e){me(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+n+"]."}))}))}function bF(n,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",Ye().platform.encode(n,e)}function Zv(n,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",Ye().platform.decode(n,e)}function iS(n,e,t){if(e===0)return 0;if(e===1)return n[0];for(var r=n[n.length-1],i=0;i<n.length-1;++i)r+=t[i]*n[i];return r}function xF(n,e,t){if(e===0)return[];if(e===1)return[n];for(var r=new Array(e),i=0;i<r.length-1;++i)r[i]=Math.floor(n/t[i]),n-=r[i]*t[i];return r[r.length-1]=n,r}var _F=(function(){function n(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new EF)}return n.prototype.profileKernel=function(e,t,r){var i,o=this,s=this.backendTimer.time((function(){i=r()}));return i.forEach((function(a){a.data().then((function(u){(function(l,h,d){if(h!=="float32")return!1;for(var m=0;m<l.length;m++){var p=l[m];if(isNaN(p)||!isFinite(p))return console.warn("Found "+p+" in the result of '"+d+"'"),!0}})(u,a.dtype,e),s.then((function(l){var h="";l.getExtraProfileInfo!=null&&(h=l.getExtraProfileInfo()),o.logger.logKernelProfile(e,a,u,l.kernelMs,t,h)}))}))})),i},n})(),EF=(function(){function n(){}return n.prototype.logKernelProfile=function(e,t,r,i,o,s){var a=typeof i=="number"?bd(i+"ms",9):i.error,u=bd(e,25),l=t.rank,h=t.size,d=bd(t.shape.toString(),14),m="";for(var p in o){var y=o[p].shape||t.shape,b=y.length;m+=p+": "+b+"D "+(b>0?y:"")+" "}console.log("%c"+u+"	%c"+a+"	%c"+l+"D "+d+"	%c"+h+"	%c"+m+"	%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},n})(),oS=20,Vp=3,ky=7;function SF(n,e,t,r){var i=ll(e),o=(function(l,h,d,m){var p=Mt(h),y=m[m.length-1],b=new Array(y).fill(0),x=h.length,E=d==="complex64"?Up(l):l;if(x>1)for(var T=0;T<p/y;T++)for(var P=T*y,I=0;I<y;I++)b[I]=Math.max(b[I],jp(E[P+I],0,d).length);return b})(n,e,t,i),s=e.length,a=(function l(h,d,m,p,y,b){b===void 0&&(b=!0);var x=m==="complex64"?2:1,E=d[0],T=d.length;if(T===0)return m==="complex64"?[jp(Up(h)[0],0,m)]:m==="bool"?[OI(h[0])]:[h[0].toString()];if(T===1){if(E>oS){var P=Vp*x,I=Array.from(h.slice(0,P)),D=Array.from(h.slice((E-Vp)*x,E*x));return m==="complex64"&&(I=Up(I),D=Up(D)),["["+I.map((function(ue,ge){return jp(ue,y[ge],m)})).join(", ")+", ..., "+D.map((function(ue,ge){return jp(ue,y[E-Vp+ge],m)})).join(", ")+"]"]}return["["+(m==="complex64"?Up(h):Array.from(h)).map((function(ue,ge){return jp(ue,y[ge],m)})).join(", ")+"]"]}var U=d.slice(1),L=p.slice(1),C=p[0]*x,A=[];if(E>oS){for(var M=0;M<Vp;M++){var k=(O=M*C)+C;A.push.apply(A,l(h.slice(O,k),U,m,L,y,!1))}for(A.push("..."),M=E-Vp;M<E;M++)k=(O=M*C)+C,A.push.apply(A,l(h.slice(O,k),U,m,L,y,M===E-1))}else for(M=0;M<E;M++){var O;k=(O=M*C)+C,A.push.apply(A,l(h.slice(O,k),U,m,L,y,M===E-1))}var j=T===2?",":"";for(A[0]="["+A[0]+j,M=1;M<A.length-1;M++)A[M]=" "+A[M]+j;var X=`,
`;for(M=2;M<T;M++)X+=`
`;return A[A.length-1]=" "+A[A.length-1]+"]"+(b?"":X),A})(n,e,t,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+t),u.push("  rank: "+s),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(a.map((function(l){return"    "+l})).join(`
`)),u.join(`
`)}function jp(n,e,t){return bd(Array.isArray(n)?parseFloat(n[0].toFixed(ky))+" + "+parseFloat(n[1].toFixed(ky))+"j":zb(n)?"'"+n+"'":t==="bool"?OI(n):parseFloat(n.toFixed(ky)).toString(),e)}function OI(n){return n===0?"false":"true"}function Up(n){for(var e=[],t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}var xm=(function(){function n(e,t,r){var i=this;if(this.dtype=t,this.shape=e.slice(),this.size=Mt(e),r!=null){var o=r.length;me(o===this.size,(function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+i.size+"'."}))}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Jv(t,this.size),this.strides=ll(e)}return n.prototype.set=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),me(r.length===this.rank,(function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+t.rank+")"}));var o=this.locToIndex(r);this.values[o]=e},n.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length===0&&(e=[0]);for(var r=0,i=0,o=e;i<o.length;i++){var s=o[i];if(s<0||s>=this.shape[r]){var a="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(a)}r++}for(var u=e[e.length-1],l=0;l<e.length-1;++l)u+=this.strides[l]*e[l];return this.values[u]},n.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var t=e[e.length-1],r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t},n.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var t=new Array(this.shape.length),r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.toTensor=function(){return el().makeTensor(this.values,this.shape,this.dtype)},n})(),el=null,ze=null,FI=null,$r=(function(){function n(e,t,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Mt(e),this.strides=ll(e),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return n.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},n.prototype.asScalar=function(){return this.throwIfDisposed(),me(this.size===1,(function(){return"The array must have only 1 element."})),this.reshape([])},n.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},n.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},n.prototype.as3D=function(e,t,r){return this.throwIfDisposed(),this.reshape([e,t,r])},n.prototype.as4D=function(e,t,r,i){return this.throwIfDisposed(),this.reshape([e,t,r,i])},n.prototype.as5D=function(e,t,r,i,o){return this.throwIfDisposed(),this.reshape([e,t,r,i,o])},n.prototype.asType=function(e){return this.throwIfDisposed(),ze.cast(this,e)},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.buffer=function(){return Nt(this,void 0,void 0,(function(){var e;return Rt(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,ze.buffer(this.shape,this.dtype,e)]}}))}))},n.prototype.bufferSync=function(){return ze.buffer(this.shape,this.dtype,this.dataSync())},n.prototype.array=function(){return Nt(this,void 0,void 0,(function(){var e;return Rt(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,rS(this.shape,e)]}}))}))},n.prototype.arraySync=function(){return rS(this.shape,this.dataSync())},n.prototype.data=function(){return Nt(this,void 0,void 0,(function(){var e,t;return Rt(this,(function(r){switch(r.label){case 0:return this.throwIfDisposed(),e=el().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:t=r.sent();try{return[2,t.map((function(i){return Zv(i)}))]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,e]}}))}))},n.prototype.dataSync=function(){this.throwIfDisposed();var e=el().readSync(this.dataId);if(this.dtype==="string")try{return e.map((function(t){return Zv(t)}))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},n.prototype.bytes=function(){return Nt(this,void 0,void 0,(function(){var e;return Rt(this,(function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,el().read(this.dataId)];case 1:return e=t.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}}))}))},n.prototype.dispose=function(){this.isDisposed||(el().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(n.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),n.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},n.prototype.toFloat=function(){return this.asType("float32")},n.prototype.toInt=function(){return this.asType("int32")},n.prototype.toBool=function(){return this.asType("bool")},n.prototype.print=function(e){return e===void 0&&(e=!1),ze.print(this,e)},n.prototype.reshape=function(e){return this.throwIfDisposed(),ze.reshape(this,e)},n.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},n.prototype.expandDims=function(e){return e===void 0&&(e=0),ze.expandDims(this,e)},n.prototype.cumsum=function(e,t,r){return e===void 0&&(e=0),t===void 0&&(t=!1),r===void 0&&(r=!1),ze.cumsum(this,e,t,r)},n.prototype.squeeze=function(e){return this.throwIfDisposed(),ze.squeeze(this,e)},n.prototype.clone=function(){return this.throwIfDisposed(),ze.clone(this)},n.prototype.oneHot=function(e,t,r){return this.throwIfDisposed(),ze.oneHot(this,e,t,r)},n.prototype.toString=function(e){return e===void 0&&(e=!1),SF(this.dataSync(),this.shape,this.dtype,e)},n.prototype.tile=function(e){return this.throwIfDisposed(),ze.tile(this,e)},n.prototype.gather=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),ze.gather(this,e,t)},n.prototype.matMul=function(e,t,r){return t===void 0&&(t=!1),r===void 0&&(r=!1),this.throwIfDisposed(),ze.matMul(this,e,t,r)},n.prototype.dot=function(e){return this.throwIfDisposed(),ze.dot(this,e)},n.prototype.norm=function(e,t,r){return e===void 0&&(e="euclidean"),t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),ze.norm(this,e,t,r)},n.prototype.slice=function(e,t){return this.throwIfDisposed(),ze.slice(this,e,t)},n.prototype.reverse=function(e){return this.throwIfDisposed(),ze.reverse(this,e)},n.prototype.concat=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),e instanceof n&&(e=[e]),ze.concat([this].concat(e),t)},n.prototype.split=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),ze.split(this,e,t)},n.prototype.stack=function(e,t){return t===void 0&&(t=0),ze.stack([this,e],t)},n.prototype.unstack=function(e){return e===void 0&&(e=0),ze.unstack(this,e)},n.prototype.pad=function(e,t){return t===void 0&&(t=0),ze.pad(this,e,t)},n.prototype.batchNormalization=function(e,t,r,i,o){return r===void 0&&(r=.001),FI("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,o,i,r)},n.prototype.batchNorm=function(e,t,r,i,o){return o===void 0&&(o=.001),this.throwIfDisposed(),ze.batchNorm(this,e,t,r,i,o)},n.prototype.all=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ze.all(this,e,t)},n.prototype.any=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ze.any(this,e,t)},n.prototype.logSumExp=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ze.logSumExp(this,e,t)},n.prototype.sum=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ze.sum(this,e,t)},n.prototype.prod=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ze.prod(this,e,t)},n.prototype.mean=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ze.mean(this,e,t)},n.prototype.min=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ze.min(this,e,t)},n.prototype.max=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ze.max(this,e,t)},n.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),ze.argMin(this,e)},n.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),ze.argMax(this,e)},n.prototype.cast=function(e){return this.throwIfDisposed(),ze.cast(this,e)},n.prototype.add=function(e){return this.throwIfDisposed(),ze.add(this,e)},n.prototype.addStrict=function(e){return this.throwIfDisposed(),ze.addStrict(this,e)},n.prototype.atan2=function(e){return this.throwIfDisposed(),ze.atan2(this,e)},n.prototype.sub=function(e){return this.throwIfDisposed(),ze.sub(this,e)},n.prototype.subStrict=function(e){return this.throwIfDisposed(),ze.subStrict(this,e)},n.prototype.pow=function(e){return this.throwIfDisposed(),ze.pow(this,e)},n.prototype.powStrict=function(e){return this.throwIfDisposed(),ze.powStrict(this,e)},n.prototype.mul=function(e){return this.throwIfDisposed(),ze.mul(this,e)},n.prototype.mulStrict=function(e){return this.throwIfDisposed(),ze.mulStrict(this,e)},n.prototype.div=function(e){return this.throwIfDisposed(),ze.div(this,e)},n.prototype.divNoNan=function(e){return this.throwIfDisposed(),ze.divNoNan(this,e)},n.prototype.floorDiv=function(e){return this.throwIfDisposed(),ze.floorDiv(this,e)},n.prototype.divStrict=function(e){return this.throwIfDisposed(),ze.divStrict(this,e)},n.prototype.minimum=function(e){return this.throwIfDisposed(),ze.minimum(this,e)},n.prototype.minimumStrict=function(e){return this.throwIfDisposed(),ze.minimumStrict(this,e)},n.prototype.maximum=function(e){return this.throwIfDisposed(),ze.maximum(this,e)},n.prototype.maximumStrict=function(e){return this.throwIfDisposed(),ze.maximumStrict(this,e)},n.prototype.mod=function(e){return this.throwIfDisposed(),ze.mod(this,e)},n.prototype.modStrict=function(e){return this.throwIfDisposed(),ze.modStrict(this,e)},n.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),ze.squaredDifferenceStrict(this,e)},n.prototype.transpose=function(e){return this.throwIfDisposed(),ze.transpose(this,e)},n.prototype.notEqual=function(e){return this.throwIfDisposed(),ze.notEqual(this,e)},n.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),ze.notEqualStrict(this,e)},n.prototype.less=function(e){return this.throwIfDisposed(),ze.less(this,e)},n.prototype.lessStrict=function(e){return this.throwIfDisposed(),ze.lessStrict(this,e)},n.prototype.equal=function(e){return this.throwIfDisposed(),ze.equal(this,e)},n.prototype.equalStrict=function(e){return this.throwIfDisposed(),ze.equalStrict(this,e)},n.prototype.lessEqual=function(e){return this.throwIfDisposed(),ze.lessEqual(this,e)},n.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),ze.lessEqualStrict(this,e)},n.prototype.greater=function(e){return this.throwIfDisposed(),ze.greater(this,e)},n.prototype.greaterStrict=function(e){return this.throwIfDisposed(),ze.greaterStrict(this,e)},n.prototype.greaterEqual=function(e){return this.throwIfDisposed(),ze.greaterEqual(this,e)},n.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),ze.greaterEqualStrict(this,e)},n.prototype.logicalAnd=function(e){return this.throwIfDisposed(),ze.logicalAnd(this,e)},n.prototype.logicalOr=function(e){return this.throwIfDisposed(),ze.logicalOr(this,e)},n.prototype.logicalNot=function(){return this.throwIfDisposed(),ze.logicalNot(this)},n.prototype.logicalXor=function(e){return this.throwIfDisposed(),ze.logicalXor(this,e)},n.prototype.where=function(e,t){return this.throwIfDisposed(),ze.where(e,this,t)},n.prototype.neg=function(){return this.throwIfDisposed(),ze.neg(this)},n.prototype.ceil=function(){return this.throwIfDisposed(),ze.ceil(this)},n.prototype.floor=function(){return this.throwIfDisposed(),ze.floor(this)},n.prototype.sign=function(){return this.throwIfDisposed(),ze.sign(this)},n.prototype.isNaN=function(){return this.throwIfDisposed(),ze.isNaN(this)},n.prototype.isInf=function(){return this.throwIfDisposed(),ze.isInf(this)},n.prototype.isFinite=function(){return this.throwIfDisposed(),ze.isFinite(this)},n.prototype.exp=function(){return this.throwIfDisposed(),ze.exp(this)},n.prototype.expm1=function(){return this.throwIfDisposed(),ze.expm1(this)},n.prototype.log=function(){return this.throwIfDisposed(),ze.log(this)},n.prototype.log1p=function(){return this.throwIfDisposed(),ze.log1p(this)},n.prototype.sqrt=function(){return this.throwIfDisposed(),ze.sqrt(this)},n.prototype.rsqrt=function(){return this.throwIfDisposed(),ze.rsqrt(this)},n.prototype.square=function(){return this.throwIfDisposed(),ze.square(this)},n.prototype.reciprocal=function(){return this.throwIfDisposed(),ze.reciprocal(this)},n.prototype.abs=function(){return this.throwIfDisposed(),ze.abs(this)},n.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),ze.clipByValue(this,e,t)},n.prototype.relu=function(){return this.throwIfDisposed(),ze.relu(this)},n.prototype.relu6=function(){return this.throwIfDisposed(),ze.relu6(this)},n.prototype.elu=function(){return this.throwIfDisposed(),ze.elu(this)},n.prototype.selu=function(){return this.throwIfDisposed(),ze.selu(this)},n.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),ze.leakyRelu(this,e)},n.prototype.prelu=function(e){return this.throwIfDisposed(),ze.prelu(this,e)},n.prototype.sigmoid=function(){return this.throwIfDisposed(),ze.sigmoid(this)},n.prototype.logSigmoid=function(){return this.throwIfDisposed(),ze.logSigmoid(this)},n.prototype.softplus=function(){return this.throwIfDisposed(),ze.softplus(this)},n.prototype.zerosLike=function(){return this.throwIfDisposed(),ze.zerosLike(this)},n.prototype.onesLike=function(){return this.throwIfDisposed(),ze.onesLike(this)},n.prototype.sin=function(){return this.throwIfDisposed(),ze.sin(this)},n.prototype.cos=function(){return this.throwIfDisposed(),ze.cos(this)},n.prototype.tan=function(){return this.throwIfDisposed(),ze.tan(this)},n.prototype.asin=function(){return this.throwIfDisposed(),ze.asin(this)},n.prototype.acos=function(){return this.throwIfDisposed(),ze.acos(this)},n.prototype.atan=function(){return this.throwIfDisposed(),ze.atan(this)},n.prototype.sinh=function(){return this.throwIfDisposed(),ze.sinh(this)},n.prototype.cosh=function(){return this.throwIfDisposed(),ze.cosh(this)},n.prototype.tanh=function(){return this.throwIfDisposed(),ze.tanh(this)},n.prototype.asinh=function(){return this.throwIfDisposed(),ze.asinh(this)},n.prototype.acosh=function(){return this.throwIfDisposed(),ze.acosh(this)},n.prototype.atanh=function(){return this.throwIfDisposed(),ze.atanh(this)},n.prototype.erf=function(){return this.throwIfDisposed(),ze.erf(this)},n.prototype.round=function(){return this.throwIfDisposed(),ze.round(this)},n.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),ze.step(this,e)},n.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),ze.softmax(this,e)},n.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),ze.logSoftmax(this,e)},n.prototype.resizeBilinear=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),ze.image.resizeBilinear(this,e,t)},n.prototype.resizeNearestNeighbor=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),ze.image.resizeNearestNeighbor(this,e,t)},n.prototype.conv1d=function(e,t,r,i,o,s){return i===void 0&&(i="NWC"),o===void 0&&(o=1),this.throwIfDisposed(),ze.conv1d(this,e,t,r,i,o,s)},n.prototype.conv2d=function(e,t,r,i,o,s){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),ze.conv2d(this,e,t,r,i,o,s)},n.prototype.conv2dTranspose=function(e,t,r,i,o){return this.throwIfDisposed(),ze.conv2dTranspose(this,e,t,r,i,o)},n.prototype.depthwiseConv2D=function(e,t,r,i,o,s){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),ze.depthwiseConv2d(this,e,t,r,i,o,s)},n.prototype.separableConv2d=function(e,t,r,i,o,s){return o===void 0&&(o=[1,1]),s===void 0&&(s="NHWC"),this.throwIfDisposed(),ze.separableConv2d(this,e,t,r,i,o,s)},n.prototype.avgPool=function(e,t,r,i){return this.throwIfDisposed(),ze.avgPool(this,e,t,r,i)},n.prototype.maxPool=function(e,t,r,i){return this.throwIfDisposed(),ze.maxPool(this,e,t,r,i)},n.prototype.localResponseNormalization=function(e,t,r,i){return e===void 0&&(e=5),t===void 0&&(t=1),r===void 0&&(r=1),i===void 0&&(i=.5),ze.localResponseNormalization(this,e,t,r,i)},n.prototype.pool=function(e,t,r,i,o){return this.throwIfDisposed(),ze.pool(this,e,t,r,i,o)},n.prototype.variable=function(e,t,r){return e===void 0&&(e=!0),this.throwIfDisposed(),el().makeVariable(this,e,t,r)},n.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),ze.unsortedSegmentSum(this,e,t)},n.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),ze.batchToSpaceND(this,e,t)},n.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),ze.spaceToBatchND(this,e,t)},n.prototype.topk=function(e,t){return e===void 0&&(e=1),t===void 0&&(t=!0),this.throwIfDisposed(),ze.topk(this,e,t)},n.prototype.stridedSlice=function(e,t,r,i,o,s,a,u){return i===void 0&&(i=0),o===void 0&&(o=0),s===void 0&&(s=0),a===void 0&&(a=0),u===void 0&&(u=0),this.throwIfDisposed(),ze.stridedSlice(this,e,t,r,i,o,s,a,u)},n.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),ze.depthToSpace(this,e,t)},n.prototype.fft=function(){return this.throwIfDisposed(),ze.spectral.fft(this)},n.prototype.ifft=function(){return this.throwIfDisposed(),ze.spectral.ifft(this)},n.prototype.rfft=function(){return this.throwIfDisposed(),ze.spectral.rfft(this)},n.prototype.irfft=function(){return this.throwIfDisposed(),ze.spectral.irfft(this)},n})();Object.defineProperty($r,Symbol.hasInstance,{value:function(n){return!!n&&n.dataId!=null&&n.shape!=null&&n.dtype!=null}});var sS,ow,sw,aw,uw,Wd=(function(n){function e(t,r,i,o){var s=n.call(this,t.shape,t.dtype,t.dataId,o)||this;return s.trainable=r,s.name=i,s}return Su(e,n),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!po(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");el().disposeTensor(this),this.dataId=t.dataId,el().incRef(this,null)},e.prototype.dispose=function(){el().disposeVariable(this),this.isDisposedInternal=!0},e})($r);Object.defineProperty(Wd,Symbol.hasInstance,{value:function(n){return n instanceof $r&&n.assign!=null&&n.assign instanceof Function}}),(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(sS||(sS={})),(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(ow||(ow={})),(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(sw||(sw={})),(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(aw||(aw={})),(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(uw||(uw={}));var AF={float32:aw,int32:ow,bool:sw,complex64:uw};function No(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error("Can not upcast "+n+" with "+e)}return AF[n][e]}function Ny(n){return No(n,"int32")}function Jr(n,e){if(n.dtype===e.dtype)return[n,e];var t=No(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function CF(n,e){me(n.dtype===e.dtype,(function(){return"The dtypes of the first("+n.dtype+") and second("+e.dtype+") input must match"}))}function BI(n){var e=[];return(function t(r,i,o){if(r!=null){if(r instanceof $r)return void i.push(r);if(s=r,!(!Array.isArray(s)&&typeof s!="object")){var s,a=r;for(var u in a){var l=a[u];o.has(l)||(o.add(l),t(l,i,o))}}}})(n,e,new Set),e}var Ry,aS=(function(){function n(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return n.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},n})(),IF=(function(){function n(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new aS}return n.prototype.ready=function(){return Nt(this,void 0,void 0,(function(){var e,t,r;return Rt(this,(function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then((function(){}))];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),t=0,i.label=1;case 1:return t<e.length?(r=e[t],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(n.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),n.prototype.backendNames=function(){return Object.keys(this.registryFactory)},n.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},n.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},n.prototype.registerBackend=function(e,t,r){return r===void 0&&(r=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:r},!0)},n.prototype.setBackend=function(e){return Nt(this,void 0,void 0,(function(){var t,r,i;return Rt(this,(function(o){switch(o.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),r=t.success,t.asyncInit?[4,r]:[3,2]);case 1:return i=o.sent(),[3,3];case 2:i=r,o.label=3;case 3:if(!i)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new _F(this.backendInstance),[2,!0]}}))}))},n.prototype.setupRegisteredKernels=function(){var e=this;tS(this.backendName).forEach((function(t){t.setupFunc!=null&&t.setupFunc(e.backendInstance)}))},n.prototype.disposeRegisteredKernels=function(e){var t=this;tS(e).forEach((function(r){r.disposeFunc!=null&&r.disposeFunc(t.registry[e])}))},n.prototype.initializeBackend=function(e){var t=this,r=this.registryFactory[e];if(r==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var o=++this.pendingBackendInitId,s=i.then((function(a){return!(o<t.pendingBackendInitId)&&(t.registry[e]=a,t.pendingBackendInit=null,!0)})).catch((function(a){return!(o<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(a.stack||a.message),!1)}));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[e]=i,{success:!0,asyncInit:!1}}catch(a){return console.warn("Initialization of backend "+e+" failed"),console.warn(a.stack||a.message),{success:!1,asyncInit:!1}}},n.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},n.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,r){return e.registryFactory[r].priority-e.registryFactory[t].priority}))},n.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var r=e[t],i=this.initializeBackend(r),o=i.success,s=i.asyncInit;if(s||o)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},n.prototype.moveData=function(e,t){var r=this.state.tensorInfo.get(t),i=r.backend,o=this.readSync(t);i.disposeData(t),r.backend=e,e.move(t,o,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},n.prototype.tidy=function(e,t){var r,i=this,o=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}return this.scopedRun((function(){return i.startScope(o)}),(function(){return i.endScope(r)}),(function(){return(r=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r}))},n.prototype.scopedRun=function(e,t,r){e();try{var i=r();return t(),i}catch(o){throw t(),o}},n.prototype.nextTensorId=function(){return n.nextTensorId++},n.prototype.nextVariableId=function(){return n.nextVariableId++},n.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),r={x:e};return this.addTapeNode(this.state.activeScope.name,r,[t],(function(i){return{x:function(){return i.toFloat()}}}),[]),t},n.prototype.runKernel=function(e,t,r,i,o){return this.runKernelFunc(null,t,null,e,r,i,o)},n.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},n.prototype.checkKernelForMemLeak=function(e,t,r){var i=this.backend.numDataIds(),o=0;r.forEach((function(u){o+=u.dtype==="complex64"?3:1}));var s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=i-t-o-s;if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+e+"'")},n.prototype.runKernelFunc=function(e,t,r,i,o,s,a){var u,l=this;s===void 0&&(s=[]),a===void 0&&(a=[]);var h=[],d=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");var m,p=function(T){d&&(h=T.map((function(P){return l.keep(l.clone(P))})))},y=this.state.numBytes,b=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var x,E=TI(i,this.backendName);return m=E!=null?function(){var T=l.backend.numDataIds();x=E.kernelFunc({inputs:t,attrs:o,backend:l.backend});var P=Array.isArray(x)?x:[x];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,T,P);var I=P.map((function(U){var L=U.dataId,C=U.shape,A=U.dtype;return l.makeTensorFromDataId(L,C,A)})),D=I.filter((function(U,L){return a[L]}));return p((s||[]).slice().concat(D)),I}:function(){var T=l.backend.numDataIds();x=l.tidy((function(){return e(l.backend,p)}));var P=Array.isArray(x)?x:[x];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,T,P),P},this.scopedRun((function(){return l.state.kernelDepth++}),(function(){return l.state.kernelDepth--}),(function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(i,t,(function(){return m()})):m()})),d&&this.addTapeNode(i,t,u,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-y,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-b,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(T){return t[T].shape})),outputShapes:u.map((function(T){return T.shape}))}),Array.isArray(x)?u:u[0]},n.prototype.makeTensor=function(e,t,r,i){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var o=e;r==="string"&&zb(e[0])&&(o=e.map((function(h){return bF(h)})));var s=i.write(o,t,r),a=new $r(t,r,s,this.nextTensorId());if(this.incRef(a,i),r==="string"){var u=this.state.tensorInfo.get(s),l=vF(o);this.state.numBytes+=l-u.bytes,u.bytes=l}return a},n.prototype.makeTensorFromDataId=function(e,t,r,i){var o=new $r(t,r=r||"float32",e,this.nextTensorId());return this.incRef(o,i),o},n.prototype.makeVariable=function(e,t,r,i){t===void 0&&(t=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==e.dtype&&(e=e.asType(i));var o=new Wd(e,t,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},n.prototype.incRef=function(e,t){var r=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(i=e.size*PI(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Wd||this.track(e)},n.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},n.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},n.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},n.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},n.prototype.profile=function(e){return Nt(this,void 0,void 0,(function(){var t,r;return Rt(this,(function(i){return this.state.profiling=!0,t=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(o){return o.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]}))}))},n.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},n.prototype.addTapeNode=function(e,t,r,i,o){var s=this,a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:o},u=lF(e);u!=null&&(i=u.gradFunc),i!=null&&(a.gradient=function(l){return l=l.map((function(h,d){if(h==null){var m=r[d],p=Wm(m.size,m.dtype);return s.makeTensor(p,m.shape,m.dtype)}return h})),i(l.length>1?l:l[0],o)}),this.state.activeTape.push(a)},n.prototype.keep=function(e){return e.kept=!0,e},n.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},n.prototype.endTape=function(){this.state.gradientDepth--},n.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},n.prototype.endScope=function(e){for(var t=this,r=BI(e),i=new Set(r.map((function(u){return u.id}))),o=0;o<this.state.activeScope.track.length;o++){var s=this.state.activeScope.track[o];s.kept||i.has(s.id)||s.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach((function(u){u.kept||u.scopeId!==a.id||t.track(u)}))},n.prototype.gradients=function(e,t,r,i){var o=this;if(i===void 0&&(i=!1),me(t.length>0,(function(){return"gradients() received an empty list of xs."})),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var s=this.scopedRun((function(){return o.startTape()}),(function(){return o.endTape()}),(function(){return o.tidy("forward",e)}));me(s instanceof $r,(function(){return"The result y returned by f() must be a tensor."}));var a=(function(u,l,h){for(var d={},m={},p=0;p<l.length;p++)d[l[p].id]=!0;for(p=0;p<u.length;p++){var y=(U=u[p]).inputs;for(var b in y){for(var x=y[b],E=!1,T=0;T<l.length;T++)if(d[x.id]){U.outputs.forEach((function(M){return d[M.id]=!0})),E=!0,m[U.id]=!0;break}if(E)break}}var P={};P[h.id]=!0;var I={};for(p=u.length-1;p>=0;p--)for(y=(U=u[p]).inputs,T=0;T<U.outputs.length;T++)if(P[U.outputs[T].id]){for(var b in y)P[y[b].id]=!0,I[U.id]=!0;break}var D=[];for(p=0;p<u.length;p++){var U;if(m[(U=u[p]).id]&&I[U.id]){var L={};for(var b in U.inputs){var C=U.inputs[b];d[C.id]&&(L[b]=C)}var A=Object.assign({},U);A.inputs=L,A.outputs=U.outputs,D.push(A)}}return D})(this.state.activeTape,t,s);if(!i&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var u,l,h={};h[s.id]=r??(u=s.shape,l=LI(Mt(u),"float32"),Ie.makeTensor(l,u,"float32")),(function(m,p,y){for(var b=function(E){var T=p[E],P=[];if(T.outputs.forEach((function(L){var C=m[L.id];C!=null?P.push(C):P.push(null)})),T.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+T.kernelName+".");var I=T.gradient(P),D=function(L){if(!(L in I))throw new Error("Cannot backprop through input "+L+". Available gradients found: "+Object.keys(I)+".");var C=y((function(){return I[L]()}));if(C.dtype!=="float32")throw new Error("Error in gradient for op "+T.kernelName+". The gradient of input "+L+" must have 'float32' dtype, but has '"+C.dtype+"'");var A=T.inputs[L];if(!po(C.shape,A.shape))throw new Error("Error in gradient for op "+T.kernelName+". The gradient of input '"+L+"' has shape '"+C.shape+"', which does not match the shape of the input '"+A.shape+"'");if(m[A.id]==null)m[A.id]=C;else{var M=m[A.id];m[A.id]=M.add(C),M.dispose()}};for(var U in T.inputs)D(U)},x=p.length-1;x>=0;x--)b(x)})(h,a,(function(m){return o.tidy(m)}));var d=t.map((function(m){return h[m.id]}));return o.state.gradientDepth===0&&(o.state.activeTape.forEach((function(m){for(var p=0,y=m.saved;p<y.length;p++)y[p].dispose()})),o.state.activeTape=null),{value:s,grads:d}}))},n.prototype.customGrad=function(e){var t=this;return me(rw(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var r,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];me(i.every((function(a){return a instanceof $r})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var s={};return i.forEach((function(a,u){s[u]=a})),t.runKernelFunc((function(a,u){return me((r=e.apply(void 0,i.concat([u]))).value instanceof $r,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),me(rw(r.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),r.value}),s,(function(a,u){var l=r.gradFunc(a,u),h=Array.isArray(l)?l:[l];me(h.length===i.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),me(h.every((function(m){return m instanceof $r})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var d={};return h.forEach((function(m,p){d[p]=function(){return m}})),d}))}},n.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},n.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},n.prototype.time=function(e){return Nt(this,void 0,void 0,(function(){var t,r;return Rt(this,(function(i){switch(i.label){case 0:return t=Zu(),[4,this.backend.time(e)];case 1:return(r=i.sent()).wallMs=Zu()-t,[2,r]}}))}))},n.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(n.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),n.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new aS,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},n.nextTensorId=0,n.nextVariableId=0,n})(),Ie=(function(){var n=(function(){if(Ry==null){var t=void 0;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else{if(typeof self>"u")throw new Error("Could not find a global object");t=self}Ry=t}return Ry})();if(n._tfengine==null){var e=new aF(n);n._tfengine=new IF(e)}return(function(t){II=t})(n._tfengine.ENV),el=function(){return n._tfengine},n._tfengine})();function VI(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Wl=Ye();Wl.registerFlag("DEBUG",(function(){return!1}),(function(n){n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Wl.registerFlag("IS_BROWSER",(function(){return VI()})),Wl.registerFlag("IS_NODE",(function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0})),Wl.registerFlag("IS_CHROME",(function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Wl.registerFlag("PROD",(function(){return!1})),Wl.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Wl.getBool("DEBUG")})),Wl.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Wl.registerFlag("IS_TEST",(function(){return!1}));var _m,da,fa,$h={},Py={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function TF(n,e){$h[n]=e}function vl(n){n in $h||($h[n]=(function(t){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=(function(i){if(typeof OffscreenCanvas<"u"&&i===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")})(t);return r.addEventListener("webglcontextlost",(function(i){i.preventDefault(),delete $h[t]}),!1),t===1?r.getContext("webgl",Py)||r.getContext("experimental-webgl",Py):r.getContext("webgl2",Py)})(n));var e=$h[n];return e.isContextLost()?(delete $h[n],vl(n)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),$h[n])}function q0(n,e){return[e,n]}function im(n){var e=Mt(n);return nw(Math.ceil(e/4))}function qm(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function Wb(n,e){var t,r,i,o,s,a,u,l,h,d=n;return Ye().getNumber("WEBGL_VERSION")===2?(t=d.R32F,r=d.R16F,i=d.RGBA16F,o=d.RGBA32F,s=d.RED,a=4,u=1,l=d.HALF_FLOAT,h=d.FLOAT):(t=n.RGBA,r=n.RGBA,i=n.RGBA,o=d.RGBA,s=n.RGBA,a=4,u=4,l=e!=null?e.HALF_FLOAT_OES:null,h=n.FLOAT),{internalFormatFloat:t,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:n.RGBA,downloadUnpackNumChannels:a,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:h}}function Vt(n,e,t){var r=t();return e&&(function(i){var o=i.getError();if(o!==i.NO_ERROR)throw new Error("WebGL Error: "+PF(i,o))})(n),r}(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(_m||(_m={})),(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(da||(da={})),(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(fa||(fa={}));var kF=596e-10,NF=65504;function RF(n){return!!(Ye().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||kF<Math.abs(n)&&Math.abs(n)<NF)}function PF(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function Xg(n,e,t){return rc(n,e,(function(){return n.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function DF(n,e,t){var r=rc(n,e,(function(){return n.createShader(n.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Vt(n,e,(function(){return n.shaderSource(r,t)})),Vt(n,e,(function(){return n.compileShader(r)})),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function LF(n,e,t){var r=rc(n,e,(function(){return n.createShader(n.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Vt(n,e,(function(){return n.shaderSource(r,t)})),Vt(n,e,(function(){return n.compileShader(r)})),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw(function(i,o){var s=MF.exec(o);if(s==null)return console.log("Couldn't parse line number in error: "+o),void console.log(i);for(var a=+s[1],u=i.split(`
`),l=u.length.toString().length+2,h=u.map((function(x,E){return bd((E+1).toString(),l)+x})),d=0,m=0;m<h.length;m++)d=Math.max(h[m].length,d);var p=h.slice(0,a-1),y=h.slice(a-1,a),b=h.slice(a);console.log(p.join(`
`)),console.log(o.split(`
`)[0]),console.log("%c "+bd(y[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(b.join(`
`))})(t,n.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Dy,Ly,MF=/ERROR: [0-9]+:([0-9]+):/g;function OF(n,e){return rc(n,e,(function(){return n.createProgram()}),"Unable to create WebGLProgram.")}function FF(n,e,t){if(Vt(n,e,(function(){return n.linkProgram(t)})),n.getProgramParameter(t,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function My(n,e,t){if(Vt(n,e,(function(){return n.validateProgram(t)})),n.getProgramParameter(t,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function BF(n,e,t){var r=rc(n,e,(function(){return n.createBuffer()}),"Unable to create WebGLBuffer");return Vt(n,e,(function(){return n.bindBuffer(n.ARRAY_BUFFER,r)})),Vt(n,e,(function(){return n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)})),r}function VF(n,e,t){var r=rc(n,e,(function(){return n.createBuffer()}),"Unable to create WebGLBuffer");return Vt(n,e,(function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r)})),Vt(n,e,(function(){return n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)})),r}function jF(n,e){return rc(n,e,(function(){return n.createTexture()}),"Unable to create WebGLTexture.")}function UF(n,e){var t=Ye().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){var r="["+n+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t)throw r="["+n+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+t+"x"+t+"]")+".")}function zF(n,e){return rc(n,e,(function(){return n.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function uS(n,e,t,r,i,o,s,a){var u=n.getAttribLocation(t,r);return u!==-1&&(Vt(n,e,(function(){return n.bindBuffer(n.ARRAY_BUFFER,i)})),Vt(n,e,(function(){return n.vertexAttribPointer(u,o,n.FLOAT,!1,s,a)})),Vt(n,e,(function(){return n.enableVertexAttribArray(u)})),!0)}function WF(n,e,t,r){KF(n,r),Vt(n,e,(function(){return n.activeTexture(n.TEXTURE0+r)})),Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,t)}))}function qF(n,e,t,r){return rc(n,e,(function(){return n.getUniformLocation(t,r)}),'uniform "'+r+'" not present in program.')}function HF(n,e,t){return n.getUniformLocation(e,t)}function GF(n,e,t,r,i,o){Vt(n,e,(function(){return WF(n,e,r,o)})),Vt(n,e,(function(){return n.uniform1i(i,o)}))}function Oy(n,e,t,r){Vt(n,e,(function(){return n.bindFramebuffer(n.FRAMEBUFFER,r)})),Vt(n,e,(function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0)}))}function lS(n,e,t){Vt(n,e,(function(){return n.bindFramebuffer(n.FRAMEBUFFER,t)})),Vt(n,e,(function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0)}))}function Yg(n){var e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+$F(n,e))}function $F(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function rc(n,e,t,r){var i=Vt(n,e,(function(){return t()}));if(i==null)throw new Error(r);return i}function KF(n,e){var t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+t+"]")+".")}function e0(n,e){return e===void 0&&(e=2),Mt(n.slice(0,n.length-e))}function t0(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Fy(n){var e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[e0(n)].concat(t0(n))),e}function XF(n,e){var t;e===void 0&&(e=!1);var r=Ye().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,(n=n.map((function(l,h){return h>=n.length-2?RI(n[h]):n[h]}))).length===1&&(n=[2,n[0]])),n.length!==2){var i=Qh(n);n=i.newShape}var o=Mt(n);if(n.length<=1&&o<=r)return[1,o];if(n.length===2&&n[0]<=r&&n[1]<=r)return n;if(n.length===3&&n[0]*n[1]<=r&&n[2]<=r)return[n[0]*n[1],n[2]];if(n.length===3&&n[0]<=r&&n[1]*n[2]<=r)return[n[0],n[1]*n[2]];if(n.length===4&&n[0]*n[1]*n[2]<=r&&n[3]<=r)return[n[0]*n[1]*n[2],n[3]];if(n.length===4&&n[0]<=r&&n[1]*n[2]*n[3]<=r)return[n[0],n[1]*n[2]*n[3]];if(e){var s=e0(n),a=2,u=2;return n.length&&(a=(t=t0(n))[0],u=t[1]),nw(o=s*(a/2)*(u/2)).map((function(l){return 2*l}))}return nw(o)}function Qg(n){return n%2==0}function Jg(n,e){if(po(n=n.slice(-2),e=e.slice(-2))||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){var t=n.slice(-1)[0],r=e.slice(-1)[0];if(t===r||Qg(t)&&Qg(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&Qg(n[0])&&Qg(e[0])}function YF(n){if(Dy==null){var e=vl(n);Dy=e.getParameter(e.MAX_TEXTURE_SIZE)}return Dy}function QF(n){if(Ly==null){var e=vl(n);Ly=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Ly)}function JF(n){if(n===0)return 0;var e=vl(n);return Ha(e,"EXT_disjoint_timer_query_webgl2")&&n===2?2:Ha(e,"EXT_disjoint_timer_query")?1:0}function Ha(n,e){return n.getExtension(e)!=null}function cS(n){try{if(vl(n)!=null)return!0}catch{return!1}return!1}function ZF(n){if(n===0)return!1;var e=vl(n);if(n===1){if(!Ha(e,"OES_texture_float"))return!1}else if(!Ha(e,"EXT_color_buffer_float"))return!1;return lw(e)}function e8(n){if(n===0)return!1;var e=vl(n);if(n!==1){if(Ha(e,"EXT_color_buffer_float"))return lw(e);if(Ha(e,"EXT_color_buffer_half_float")){var t=e.getExtension("EXT_color_buffer_half_float");return(function(r,i){var o=Wb(r,i),s=r.createTexture();r.bindTexture(r.TEXTURE_2D,s),r.texImage2D(r.TEXTURE_2D,0,o.internalFormatHalfFloat,1,1,0,o.textureFormatFloat,o.textureTypeHalfFloat,null);var a=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,a),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,s,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(s),r.deleteFramebuffer(a),u})(e,t)}return!1}return!!Ha(e,"OES_texture_float")&&!!Ha(e,"WEBGL_color_buffer_float")&&lw(e)}function lw(n){var e=Wb(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);var i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(r),i}function t8(n){return n===2&&vl(n).fenceSync!=null}var dn=Ye();function jI(n){Ye().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function _t(n,e){return Ie.tidy(n,e)}function qs(n){BI(n).forEach((function(e){return e.dispose()}))}function n8(n){return Ie.keep(n)}function n0(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];Ye().getBool("IS_TEST")||console.warn.apply(console,n)}function wh(n,e){var t=n;if(ul(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];for(var r=[];Array.isArray(t)||ul(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&Ye().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&(function i(o,s,a){if(a=a||[],!Array.isArray(o)&&!ul(o))return void me(s.length===0,(function(){return"Element arr["+a.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"}));me(s.length>0,(function(){return"Element arr["+a.join("][")+"] should be a primitive, but is an array of "+o.length+" elements"})),me(o.length===s[0],(function(){return"Element arr["+a.join("][")+"] should have "+s[0]+" elements, but has "+o.length+" elements"}));for(var u=s.slice(1),l=0;l<o.length;++l)i(o[l],u,a.concat(l))})(n,r,[]),r}function hS(n,e,t,r){if(n!=null&&(n!=="numeric"&&n!==e||n==="numeric"&&e==="string"))throw new Error("Argument '"+t+"' passed to '"+r+"' must be "+n+" tensor, but got "+e+" tensor")}function oe(n,e,t,r){if(r===void 0&&(r="numeric"),n instanceof $r)return hS(r,n.dtype,e,t),n;var i=zm(n);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),hS(r,i,e,t),n==null||!ul(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){var o=n==null?"null":n.constructor.name;throw new Error("Argument '"+e+"' passed to '"+t+"' must be a Tensor or TensorLike, but got '"+o+"'")}var s=wh(n,i);ul(n)||Array.isArray(n)||(n=[n]);var a=i!=="string"?DI(n,i,Ye().getBool("DEBUG")):zd(n,[],!0);return Ie.makeTensor(a,s,i)}function r0(n,e,t,r){if(r===void 0&&(r="numeric"),!Array.isArray(n))throw new Error("Argument "+e+" passed to "+t+" must be a `Tensor[]` or `TensorLike[]`");return n.map((function(i,o){return oe(i,e+"["+o+"]",t)}),r)}function UI(n,e){for(var t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function r8(n,e,t){for(var r=n.length+e.length,i=[],o=0,s=0,a=0;a<r;a++)t.indexOf(a)===-1?i.push(n[o++]):i.push(e[s++]);return i}function ts(n,e){for(var t=[],r=n.length,i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);return[t,e.map((function(o){return n[o]}))]}function Hs(n,e){return r8(n,e.map((function(t){return 1})),e)}function ha(n,e,t){me(UI(e,t),(function(){return n+" supports only inner-most axes for now. Got axes "+e+" and rank-"+t+" input."}))}function yl(n,e){if(UI(n,e))return null;for(var t=[],r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach((function(i){return t.push(i)})),t}function qb(n){return n.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function wl(n,e){for(var t=[],r=e-n;r<e;++r)t.push(r);return t}function i8(n,e){var t=n[0].length;n.forEach((function(i,o){me(i.length===t,(function(){return"Error in concat"+t+"D: rank of tensors["+o+"] must be the same as the rank of the rest ("+t+")"}))})),me(e>=0&&e<t,(function(){return"Error in concat"+t+"D: axis must be between 0 and "+(t-1)+"."}));var r=n[0];n.forEach((function(i,o){for(var s=0;s<t;s++)me(s===e||i[s]===r[s],(function(){return"Error in concat"+t+"D: Shape of tensors["+o+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."}))}))}function qd(n,e){for(var t=n[0].slice(),r=1;r<n.length;r++)t[e]+=n[r][e];return t}function xe(n){var e=Object.keys(n);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var t=e[0],r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1));var i=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];Ie.startScope(t);try{var a=r.apply(void 0,o);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Ie.endScope(a),a}catch(u){throw Ie.endScope(null),u}};return Object.defineProperty(i,"name",{value:t,configurable:!0}),i}dn.registerFlag("HAS_WEBGL",(function(){return dn.getNumber("WEBGL_VERSION")>0})),dn.registerFlag("WEBGL_VERSION",(function(){return cS(2)?2:cS(1)?1:0})),dn.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return dn.get("WEBGL_VERSION")===2})),dn.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),dn.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),dn.registerFlag("WEBGL_PACK",(function(){return dn.getBool("HAS_WEBGL")})),dn.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_CLIP",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),dn.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_REDUCE",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_CONV_IM2COL",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return YF(dn.getNumber("WEBGL_VERSION"))})),dn.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return QF(dn.getNumber("WEBGL_VERSION"))})),dn.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var n=dn.getNumber("WEBGL_VERSION");return n===0?0:JF(n)})),dn.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return dn.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(n=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))));var n})),dn.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return ZF(dn.getNumber("WEBGL_VERSION"))})),dn.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!dn.getBool("WEBGL_FORCE_F16_TEXTURES")&&dn.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),dn.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return e8(dn.getNumber("WEBGL_VERSION"))})),dn.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return t8(dn.getNumber("WEBGL_VERSION"))})),dn.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return dn.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),FI=jI;var ko=xe({complex_:function(n,e){var t=oe(n,"real","complex"),r=oe(e,"imag","complex");return ir(t.shape,r.shape,"real and imag shapes, "+t.shape+" and "+r.shape+", must match in call to tf.complex()."),Ie.runKernelFunc((function(i){return i.complex(t,r)}),{$real:t,$imag:r})}}),qa=xe({real_:function(n){var e=oe(n,"input","real");return Ie.runKernelFunc((function(t){return t.real(e)}),{$input:e})}}),tl=xe({imag_:function(n){var e=oe(n,"input","imag");return Ie.runKernelFunc((function(t){return t.imag(e)}),{$input:e})}});function Po(n,e,t){return bh(n,e,wh(n,t),t)}function bh(n,e,t,r){if(r==null&&(r=zm(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!ul(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){MI(e);var i=Mt(e),o=Mt(t);me(i===o,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o}));for(var s=0;s<t.length;++s){var a=t[s],u=s!==t.length-1||a!==Mt(e.slice(s));me(t[s]===e[s]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+t+") does not match the provided shape ("+e+"). "}))}}return ul(n)||Array.isArray(n)||(n=[n]),e=e||t,n=r!=="string"?DI(n,r,Ye().getBool("DEBUG")):zd(n,[],!0),Ie.makeTensor(n,e,r)}function dt(n,e){if((ul(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&ul(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return bh(n,[],[],e)}function Di(n,e){rp(n);var t=wh(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return bh(n,null,t,e)}function Yc(n,e,t){if(rp(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=wh(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return bh(n,e,r,t)}function Hb(n,e,t){if(rp(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=wh(n,t);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return bh(n,e,r,t)}function zs(n,e,t){if(rp(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=wh(n,t);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return bh(n,e,r,t)}function o8(n,e,t){if(rp(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=wh(n,t);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return bh(n,e,r,t)}function s8(n,e,t){if(rp(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=wh(n,t);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return bh(n,e=e||r,r,t)}function a8(n,e,t,r){return e===void 0&&(e=!0),Ie.makeVariable(n,e,t,r)}function ip(n,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=ip(n,"float32"),r=Tr(n,"float32");return ko(t,r)}var i=LI(Mt(n),e);return Ie.makeTensor(i,n,e)}function Tr(n,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=Tr(n,"float32"),r=Tr(n,"float32");return ko(t,r)}var i=Wm(Mt(n),e);return Ie.makeTensor(i,n,e)}function cl(n,e,t){return Ie.runKernelFunc((function(r){return r.fill(n,e,t)}),{})}function u8(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");return Ie.runKernelFunc((function(r){return r.linspace(n,e,t)}),{})}function i0(n,e,t,r){if(t===void 0&&(t=1),r===void 0&&(r="float32"),t===0)throw new Error("Cannot have a step of zero");if(n===e||n<e&&t<0||e<n&&t>1)return Tr([0],r);var i=Wm(Math.abs(Math.ceil((e-n)/t)),r);e<n&&t===1&&(t=-1),i[0]=n;for(var o=1;o<i.length;o++)i[o]=i[o-1]+t;return Di(i,r)}var zI=xe({onesLike_:function(n){var e=oe(n,"x","onesLike");if(e.dtype==="complex64"){var t=zI(qa(e)),r=zn(tl(e));return ko(t,r)}return Ie.runKernelFunc((function(i){return i.onesLike(e)}),{$x:e},(function(i,o){return{$x:function(){return zn(i)}}}))}}),zn=xe({zerosLike_:function(n){var e=oe(n,"x","zerosLike");return Ie.runKernelFunc((function(t){return t.zerosLike(e)}),{$x:e},(function(t,r){return{$x:function(){return zn(t)}}}))}}),qi=xe({concat_:function(n,e){e===void 0&&(e=0),me(n.length>=1,(function(){return"Pass at least one tensor to concat"}));var t=r0(n,"tensors","concat");t[0].dtype==="complex64"&&t.forEach((function(a){if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+a.dtype+". ")})),e=Xi(e,t[0].shape)[0];var r=qd(t.map((function(a){return a.shape})),e);if(Mt(r)===0)return Po([],r);if((t=t.filter((function(a){return a.size>0}))).length===1)return t[0];var i=t.map((function(a){return a.shape}));i8(i,e);var o=t,s={axis:e};return Ie.runKernelFunc((function(a){return a.concat(t,e)}),o,(function(a){var u=i.map((function(l){return l[e]}));return Gb(a,u,e).map((function(l){return function(){return l}}))}),"Concat",s)}}),l8=xe({concat1d_:function(n){return qi(n,0)}}),c8=xe({concat2d_:function(n,e){return qi(n,e)}}),h8=xe({concat3d_:function(n,e){return qi(n,e)}}),f8=xe({concat4d_:function(n,e){return qi(n,e)}}),Gb=xe({split_:function(n,e,t){t===void 0&&(t=0);var r,i=oe(n,"x","split");return t=Xi(t,i.shape)[0],typeof e=="number"?(me(i.shape[t]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[t]/e)):(me(i.shape[t]===e.reduce((function(o,s){return o+s})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),Ie.runKernelFunc((function(o){return o.split(i,r,t)}),{$x:i},(function(o){return{$x:function(){return qi(o,t)}}}))}});function wf(n,e){return n(e={exports:{}},e.exports),e.exports}var d8=wf((function(n){(function(e,t,r){function i(a){var u,l=this,h=(u=4022871197,function(d){d=d.toString();for(var m=0;m<d.length;m++){var p=.02519603282416938*(u+=d.charCodeAt(m));p-=u=p>>>0,u=(p*=u)>>>0,u+=4294967296*(p-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var d=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=h(" "),l.s1=h(" "),l.s2=h(" "),l.s0-=h(a),l.s0<0&&(l.s0+=1),l.s1-=h(a),l.s1<0&&(l.s1+=1),l.s2-=h(a),l.s2<0&&(l.s2+=1),h=null}function o(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function s(a,u){var l=new i(a),h=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.alea=s})(0,n)})),p8=wf((function(n){(function(e,t,r){function i(a){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},a===(0|a)?u.x=a:l+=a;for(var h=0;h<l.length+64;h++)u.x^=0|l.charCodeAt(h),u.next()}function o(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u}function s(a,u){var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var m=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=l.next,d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xor128=s})(0,n)})),m8=wf((function(n){(function(e,t,r){function i(a){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,a===(0|a)?u.x=a:l+=a;for(var h=0;h<l.length+64;h++)u.x^=0|l.charCodeAt(h),h==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u.v=a.v,u.d=a.d,u}function s(a,u){var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var m=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=l.next,d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xorwow=s})(0,n)})),g8=wf((function(n){(function(e,t,r){function i(a){var u=this;u.next=function(){var l,h,d=u.x,m=u.i;return l=d[m],h=(l^=l>>>7)^l<<24,h^=(l=d[m+1&7])^l>>>10,h^=(l=d[m+3&7])^l>>>3,h^=(l=d[m+4&7])^l<<7,l=d[m+7&7],h^=(l^=l<<13)^l<<9,d[m]=h,u.i=m+1&7,h},(function(l,h){var d,m=[];if(h===(0|h))m[0]=h;else for(h=""+h,d=0;d<h.length;++d)m[7&d]=m[7&d]<<15^h.charCodeAt(d)+m[d+1&7]<<13;for(;m.length<8;)m.push(0);for(d=0;d<8&&m[d]===0;++d);for(d==8?m[7]=-1:m[d],l.x=m,l.i=0,d=256;d>0;--d)l.next()})(u,a)}function o(a,u){return u.x=a.x.slice(),u.i=a.i,u}function s(a,u){a==null&&(a=+new Date);var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var m=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=l.next,d.quick=d,h&&(h.x&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xorshift7=s})(0,n)})),v8=wf((function(n){(function(e,t,r){function i(a){var u=this;u.next=function(){var l,h,d=u.w,m=u.X,p=u.i;return u.w=d=d+1640531527|0,h=m[p+34&127],l=m[p=p+1&127],h^=h<<13,l^=l<<17,h^=h>>>15,l^=l>>>12,h=m[p]=h^l,u.i=p,h+(d^d>>>16)|0},(function(l,h){var d,m,p,y,b,x=[],E=128;for(h===(0|h)?(m=h,h=null):(h+="\0",m=0,E=Math.max(E,h.length)),p=0,y=-32;y<E;++y)h&&(m^=h.charCodeAt((y+32)%h.length)),y===0&&(b=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,y>=0&&(b=b+1640531527|0,p=(d=x[127&y]^=m+b)==0?p+1:0);for(p>=128&&(x[127&(h&&h.length||0)]=-1),p=127,y=512;y>0;--y)m=x[p+34&127],d=x[p=p+1&127],m^=m<<13,d^=d<<17,m^=m>>>15,d^=d>>>12,x[p]=m^d;l.w=b,l.X=x,l.i=p})(u,a)}function o(a,u){return u.i=a.i,u.w=a.w,u.X=a.X.slice(),u}function s(a,u){a==null&&(a=+new Date);var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var m=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=l.next,d.quick=d,h&&(h.X&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xor4096=s})(0,n)})),y8=wf((function(n){(function(e,t,r){function i(a){var u=this,l="";u.next=function(){var d=u.b,m=u.c,p=u.d,y=u.a;return d=d<<25^d>>>7^m,m=m-p|0,p=p<<24^p>>>8^y,y=y-d|0,u.b=d=d<<20^d>>>12^m,u.c=m=m-p|0,u.d=p<<16^m>>>16^y,u.a=y-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,a===Math.floor(a)?(u.a=a/4294967296|0,u.b=0|a):l+=a;for(var h=0;h<l.length+20;h++)u.b^=0|l.charCodeAt(h),u.next()}function o(a,u){return u.a=a.a,u.b=a.b,u.c=a.c,u.d=a.d,u}function s(a,u){var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var m=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=l.next,d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.tychei=s})(0,n)})),Kh=wf((function(n){(function(e,t){var r,i=this,o=256,s=6,a="random",u=t.pow(o,s),l=t.pow(2,52),h=2*l,d=o-1;function m(E,T,P){var I=[],D=b((function C(A,M){var k,O=[],j=typeof A;if(M&&j=="object")for(k in A)try{O.push(C(A[k],M-1))}catch{}return O.length?O:j=="string"?A:A+"\0"})((T=T==1?{entropy:!0}:T||{}).entropy?[E,x(e)]:E??(function(){try{var C;return r&&(C=r.randomBytes)?C=C(o):(C=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(C)),x(C)}catch{var A=i.navigator,M=A&&A.plugins;return[+new Date,i,M,i.screen,x(e)]}})(),3),I),U=new p(I),L=function(){for(var C=U.g(s),A=u,M=0;C<l;)C=(C+M)*o,A*=o,M=U.g(1);for(;C>=h;)C/=2,A/=2,M>>>=1;return(C+M)/A};return L.int32=function(){return 0|U.g(4)},L.quick=function(){return U.g(4)/4294967296},L.double=L,b(x(U.S),e),(T.pass||P||function(C,A,M,k){return k&&(k.S&&y(k,U),C.state=function(){return y(U,{})}),M?(t[a]=C,A):C})(L,D,"global"in T?T.global:this==t,T.state)}function p(E){var T,P=E.length,I=this,D=0,U=I.i=I.j=0,L=I.S=[];for(P||(E=[P++]);D<o;)L[D]=D++;for(D=0;D<o;D++)L[D]=L[U=d&U+E[D%P]+(T=L[D])],L[U]=T;(I.g=function(C){for(var A,M=0,k=I.i,O=I.j,j=I.S;C--;)A=j[k=d&k+1],M=M*o+j[d&(j[k]=j[O=d&O+A])+(j[O]=A)];return I.i=k,I.j=O,M})(o)}function y(E,T){return T.i=E.i,T.j=E.j,T.S=E.S.slice(),T}function b(E,T){for(var P,I=E+"",D=0;D<I.length;)T[d&D]=d&(P^=19*T[d&D])+I.charCodeAt(D++);return x(T)}function x(E){return String.fromCharCode.apply(0,E)}if(t["seed"+a]=m,b(t.random(),e),n.exports){n.exports=m;try{r=require("crypto")}catch{}}})([],Math)}));Kh.alea=d8,Kh.xor128=p8,Kh.xorwow=m8,Kh.xorshift7=g8,Kh.xor4096=v8,Kh.tychei=y8;var H0=Kh.alea,$b=(function(){function n(e,t,r,i,o){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=o||Math.random();this.random=H0(s.toString())}return n.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,r,i=!1;!i;){var o=void 0,s=void 0,a=void 0;do a=(o=2*this.random()-1)*o+(s=2*this.random()-1)*s;while(a>=1||a===0);var u=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*o*u,r=this.mean+this.stdDev*s*u,this.truncated&&!this.isValidTruncated(t)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(t)},n.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},n.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},n})(),w8=(function(){function n(e,t,r,i){this.alpha=e,this.beta=1/t,this.dtype=r;var o=i||Math.random();this.randu=H0(o.toString()),this.randn=new $b(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return n.prototype.nextValue=function(){for(var e,t,r,i,o,s;;){do i=this.randn.nextValue(),s=1+this.c*i;while(s<=0);if(s*=s*s,t=1-.331*(e=i*i)*e,r=.5*e+this.d*(1-s+Math.log(s)),(o=this.randu())<t||Math.log(o)<r)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},n.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},n})(),b8=(function(){function n(e,t,r,i){var o=this;if(e===void 0&&(e=0),t===void 0&&(t=1),this.canReturnFloat=function(){return o.dtype==null||o.dtype==="float32"},this.min=e,this.range=t-e,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=H0(i)}return n.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},n.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},n})();function wn(n,e,t){return e===void 0&&(e="float32"),e=e||"float32",MI(n),new xm(n,e,t)}function x8(n,e){e===void 0&&(e=!1),console.log(n.toString(e))}var WI=xe({batchToSpaceND_:function(n,e,t){var r=oe(n,"x","batchToSpaceND"),i=e.reduce((function(o,s){return o*s}));return me(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),me(t.length===e.length,(function(){return"crops.length is "+t.length+" but should be equal to blockShape.length  "+e.length})),me(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),Ie.runKernelFunc((function(o){return o.batchToSpaceND(r,e,t)}),{$x:r},(function(o){return{$x:function(){return o.spaceToBatchND(e,t)}}}))}}),_8=xe({broadcastTo_:function(n,e){var t=oe(n,"broadcastTo","x"),r=t.shape;if(e.some((function(u){return!(u>0)||u%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<t.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+t.rank+".");if(e.length>t.rank){for(var i=t.shape.slice();i.length<e.length;)i.unshift(1);t=t.reshape(i)}for(var o=Array.from(e),s=e.length-1;s>=0;s--)if(t.shape[s]===e[s])o[s]=1;else if(t.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var a=o.map((function(u,l){return u>1?l:-1})).filter((function(u){return u>=0}));return a.length===0?t.clone():Ie.runKernelFunc((function(u){return u.tile(t,o)}),{input:t},(function(u){return{input:function(){return u.sum(a,!0)}}}))}}),E8=xe({cast_:function(n,e){var t=oe(n,"x","cast");if(!mF(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:e};return Ie.runKernelFunc((function(i){return i.cast(t,e)}),{x:t},(function(i){return{x:function(){return i.clone()}}}),"Cast",r)}}),S8=xe({clone_:function(n){var e=oe(n,"x","clone",null);return Ie.runKernelFunc((function(){return Ie.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),A8=xe({cumsum_:function(n,e,t,r){e===void 0&&(e=0),t===void 0&&(t=!1),r===void 0&&(r=!1);var i=oe(n,"x","cumsum"),o=yl([e|=0],i.rank),s=i;o!=null&&(s=i.transpose(o));var a=wl(1,i.rank)[0],u=Ie.runKernelFunc((function(l){return l.cumsum(s,a,t,r)}),{permutedX:s},(function(l){return{permutedX:function(){return l.cumsum(e,t,!r)}}}));return o!=null&&(u=u.transpose(o)),u}}),C8=xe({depthToSpace_:function(n,e,t){t===void 0&&(t="NHWC");var r=oe(n,"x","depthToSpace"),i=t==="NHWC"?r.shape[1]:r.shape[2],o=t==="NHWC"?r.shape[2]:r.shape[3],s=t==="NHWC"?r.shape[3]:r.shape[1];return me(i*e>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+`  for depthToSpace with input shape
      `+r.shape})),me(o*e>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+e+` for depthToSpace with input shape
          `+r.shape})),me(s%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+s+" for depthToSpace with input shape "+r.shape})),Ie.runKernelFunc((function(a){return a.depthToSpace(r,e,t)}),{$x:r})}}),Wa=xe({expandDims_:function(n,e){e===void 0&&(e=0);var t=oe(n,"x","expandDims",null);me(e<=t.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=t.shape.slice();return e<0&&(me(-(t.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(t.rank+1)+", "+t.rank+"]"})),e=t.rank+e+1),r.splice(e,0,1),yu(t,r)}}),qI=xe({eye_:function(n,e,t,r){r===void 0&&(r="float32"),e==null&&(e=n);for(var i=wn([n,e],r),o=n<=e?n:e,s=0;s<o;++s)i.set(1,s,s);var a=i.toTensor().as2D(n,e);if(t==null)return a;if(t.length===1)return xd(Wa(a,0),[t[0],1,1]);if(t.length===2)return xd(Wa(Wa(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return xd(Wa(Wa(Wa(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+t.length+"D.")}}),I8=xe({multinomial_:function(n,e,t,r){r===void 0&&(r=!1);var i=oe(n,"logits","multinomial"),o=i.size,s=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);t=t||Math.random();var a=s===1?i.as2D(1,-1):i,u=Ie.runKernelFunc((function(l){return l.multinomial(a,r,e,t)}),{logits2D:a});return s===1?u.as1D():u}}),cw=xe({oneHot_:function(n,e,t,r){if(t===void 0&&(t=1),r===void 0&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=oe(n,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),Ie.runKernelFunc((function(s){return s.oneHot(i,e,t,r)}),{$indices:i},(function(s){return{$indices:function(){return Tr(i.shape,"float32")}}})).reshape(o)}}),bf=xe({pad_:function(n,e,t){t===void 0&&(t=0);var r=oe(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:e,constantValue:t};return Ie.runKernelFunc((function(o){return o.pad(r,e,t)}),{x:r},(function(o){var s=e.map((function(a){return a[0]}));return{x:function(){return o.slice(s,r.shape)}}}),"PadV2",i)}}),T8=xe({pad1d_:function(n,e,t){return t===void 0&&(t=0),me(e.length===2,(function(){return"Invalid number of paddings. Must be length of 2."})),bf(n,[e],t)}}),k8=xe({pad2d_:function(n,e,t){return t===void 0&&(t=0),me(e.length===2&&e[0].length===2&&e[1].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),bf(n,e,t)}}),N8=xe({pad3d_:function(n,e,t){return t===void 0&&(t=0),me(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),bf(n,e,t)}}),R8=xe({pad4d_:function(n,e,t){return t===void 0&&(t=0),me(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),bf(n,e,t)}}),P8=xe({rand_:function(n,e,t){var r=Mt(n),i=null;if(t==null||t==="float32")i=new Float32Array(r);else if(t==="int32")i=new Int32Array(r);else{if(t!=="bool")throw new Error("Unknown data type "+t);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return Ie.makeTensor(i,n,t)}}),D8=xe({randomNormal_:function(n,e,t,r,i){if(e===void 0&&(e=0),t===void 0&&(t=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new $b(e,t,r,!1,i),s=wn(n,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),L8=xe({randomGamma_:function(n,e,t,r,i){if(t===void 0&&(t=1),r===void 0&&(r="float32"),t==null&&(t=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var o=new w8(e,t,r,i),s=wn(n,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),HI=xe({randomUniform_:function(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=1),r===void 0&&(r="float32");for(var o=wn(n,r),s=new b8(e,t,null,i),a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),yu=xe({reshape_:function(n,e){var t=oe(n,"x","reshape",null);e=dF(e,t.size),me(t.size===Mt(e),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:e};return Ie.runKernelFunc((function(i){return i.reshape(t,e)}),{x:t},(function(i){return{x:function(){return i.reshape(t.shape)}}}),"Reshape",r)}}),GI=xe({spaceToBatchND_:function(n,e,t){var r=oe(n,"x","spaceToBatchND");return me(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),me(t.length===e.length,(function(){return"paddings.shape[0] "+t.length+" must be equal to [blockShape] "+e.length})),me(r.shape.reduce((function(i,o,s){return s>0&&s<=e.length?i&&(o+t[s-1][0]+t[s-1][1])%e[s-1]==0:i}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+t.toString()+" must be divisible by blockShapes "+e.toString()})),Ie.runKernelFunc((function(i){return i.spaceToBatchND(r,e,t)}),{$x:r},(function(i){return{$x:function(){return i.batchToSpaceND(e,t)}}}))}}),$I=xe({squeeze_:function(n,e){var t=oe(n,"x","squeeze");return yu(t,Qh(t.shape,e).newShape)}}),wa=xe({stack_:function(n,e){e===void 0&&(e=0);var t=r0(n,"tensors","stack");if(me(t.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),t.length===1)return t[0].expandDims(e);var r=t[0].rank,i=t[0].shape,o=t[0].dtype;me(e<=r,(function(){return"Axis must be <= rank of the tensor"})),t.forEach((function(a){ir(i,a.shape,"All tensors passed to stack must have matching shapes")})),t.forEach((function(a){me(o===a.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var s=t.map((function(a){return a.expandDims(e)}));return qi(s,e)}}),xd=xe({tile_:function(n,e){var t=oe(n,"x","tile",null);me(t.rank===e.length,(function(){return"Error in transpose: rank of input "+t.rank+" must match length of reps "+e+"."}));var r=[t],i={reps:e};return Ie.runKernelFunc((function(o,s){var a=o.tile(t,e);return s([t]),a}),{x:t},(function(o,s){var a=s[0];return{x:function(){var u=zn(a);if(a.rank===1)for(var l=0;l<e[0];++l)u=u.add(o.slice([l*a.shape[0]],[a.shape[0]]));else if(a.rank===2)for(l=0;l<e[0];++l)for(var h=0;h<e[1];++h)u=u.add(o.slice([l*a.shape[0],h*a.shape[1]],[a.shape[0],a.shape[1]]));else if(a.rank===3)for(l=0;l<e[0];++l)for(h=0;h<e[1];++h)for(var d=0;d<e[2];++d)u=u.add(o.slice([l*a.shape[0],h*a.shape[1],d*a.shape[2]],[a.shape[0],a.shape[1],a.shape[2]]));else{if(a.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+a.rank+" tensors yet.");for(l=0;l<e[0];++l)for(h=0;h<e[1];++h)for(d=0;d<e[2];++d)for(var m=0;m<e[3];++m)u=u.add(o.slice([l*a.shape[0],h*a.shape[1],d*a.shape[2],m*a.shape[3]],[a.shape[0],a.shape[1],a.shape[2],a.shape[3]]))}return u}}}),"Tile",i,r)}}),M8=xe({truncatedNormal_:function(n,e,t,r,i){if(e===void 0&&(e=0),t===void 0&&(t=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new $b(e,t,r,!0,i),s=wn(n,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),Hi=xe({unstack_:function(n,e){e===void 0&&(e=0),e=e||0;var t=oe(n,"x","unstack");me(e>=-t.shape.length&&e<t.shape.length,(function(){return"Axis = "+e+" is not in [-"+t.shape.length+", "+t.shape.length+")"})),e<0&&(e+=t.shape.length);var r={axis:e};return Ie.runKernelFunc((function(i){return i.unstack(t,e)}),{x:t},(function(i){return{x:function(){return wa(i,e)}}}),"Unpack",r)}}),O8=function(n,e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h,d;return Rt(this,(function(m){switch(m.label){case 0:return t=oe(n,"x","setdiff1d"),r=oe(e,"y","setdiff1d"),me(t.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+t.dtype+") and y ("+r.dtype+")."})),me(t.rank===1,(function(){return"x should be 1D tensor, but got x ("+t.shape+")."})),me(r.rank===1,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,t.data()];case 1:return i=m.sent(),[4,r.data()];case 2:for(o=m.sent(),s=new Set(o),a=0,h=0;h<i.length;h++)s.has(i[h])||a++;for(u=new xm([a],t.dtype),l=new xm([a],"int32"),h=0,d=0;h<i.length;h++)s.has(i[h])||(u.values[d]=i[h],l.values[d]=h,d++);return[2,[u.toTensor(),l.toTensor()]]}}))}))};function o0(n,e,t,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(n[0]/t),i=i.concat(n.slice(1));else{i=i.concat(n[0]);for(var o=e.length,s=0;s<o;++s)i=i.concat([n[s+1]/e[s],e[s]]);i=i.concat(n.slice(o+1))}return i}function s0(n,e,t){t===void 0&&(t=!0);var r=[];if(t){r.push(e);for(var i=e+1;i<n;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],s=[];for(i=1;i<n;++i)i>=2*e+1||i%2==1?s.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,s)}return r}function a0(n,e,t,r){r===void 0&&(r=!0);var i=[];r?i.push(n[0]/t):i.push(n[0]*t);for(var o=1;o<n.length;++o)o<=e.length?r?i.push(e[o-1]*n[o]):i.push(n[o]/e[o-1]):i.push(n[o]);return i}function KI(n,e){for(var t=[0],r=0;r<e;++r)t.push(n[r][0]);return t}function XI(n,e,t){for(var r=n.slice(0,1),i=0;i<t;++i)r.push(n[i+1]-e[i][0]-e[i][1]);return r}function YI(n,e){if(n.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+n.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>n.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+n.rank);if(n.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+n.shape+".");for(var t=e.shape,r=t[t.length-1],i=1,o=0;o<t.length-1;++o)i*=t[o];var s=n.shape,a=t.slice();a.pop();var u=1;for(o=r;o<n.rank;++o)u*=s[o],a.push(s[o]);var l=ll(n.shape).map((function(h){return h/u})).concat([1]).slice(0,r);return[a,i,u,l]}var QI=30;function By(n){return n<=QI?n:iw(n,Math.floor(Math.sqrt(n)))}function F8(n,e,t){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+t.shape+", indices.shape: "+e.shape+", shape: "+n+", sliceDim: "+r+", and batchDim: "+i+".";if(t.rank<i)throw new Error(o+" update.rank < "+i+". ");if(n.length<r+(t.rank-i))throw new Error(o+" Output shape length < "+(r+(t.rank-i)));if(t.rank!==i+n.length-r)throw new Error(o+" update.rank != "+(i+n.length-r));for(var s=0;s<i;++s)if(t.shape[s]!==e.shape[s])throw new Error(o+" updates.shape["+s+"] ("+t.shape[s]+") != indices.shape["+s+"] ("+e.shape[s]+").");for(s=0;s<t.rank-i;++s)if(t.shape[s+i]!==n[s+r])throw new Error(o+" updates.shape["+(s+i)+"] ("+t.shape[s+i]+") != shape["+(s+i)+"] ("+n[s+i]+")")}function B8(n,e,t){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(n.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+n.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+t);if(t.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(n.size===0)throw new Error("Updates specified for empty output. updates shape: "+n.shape)}F8(t,e,n)}function u0(n,e,t){for(var r=e.shape.length,i=r>1?e.shape[r-1]:1,o=t.length,s=1,a=i;a<o;++a)s*=t[a];var u=i<1?1:i;return{sliceRank:i,numUpdates:Mt(e.shape)/u,sliceSize:s,strides:ll(t.slice(0,i)).concat([1]),outputSize:Mt(t)}}function V8(n,e,t){me(n.rank===e.length,(function(){return"Error in slice"+n.rank+"D: Length of begin "+e+" must match the rank of the array ("+n.rank+")."})),me(n.rank===t.length,(function(){return"Error in slice"+n.rank+"D: Length of size "+t+" must match the rank of the array ("+n.rank+")."}));for(var r=function(o){me(e[o]+t[o]<=n.shape[o],(function(){return"Error in slice"+n.rank+"D: begin["+o+"] + size["+o+"] ("+(e[o]+t[o])+") would overflow input.shape["+o+"] ("+n.shape[o]+")"}))},i=0;i<n.rank;++i)r(i)}function fS(n){for(var e=[],t=0;n>0;)1&n&&e.push(t),n/=2,t++;return e}function Kb(n,e,t){for(var r=[],i=0;i<n.length;i++)r[i]=Math.ceil((e[i]-n[i])/t[i]);return r}function j8(n,e,t,r,i){var o=e[i],s=t[i]||1;(n&1<<i||o==null)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),o=tw(0,o,a-1)}function U8(n,e,t,r,i){var o=e[i],s=t[i]||1;(n&1<<i||o==null)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),o=s>0?tw(0,o,a):tw(-1,o,a-1)}function JI(n,e,t){for(var r=t.length,i=0;i<t.length;i++)if(t[i]>1){r=i;break}for(i=r+1;i<t.length;i++)if(e[i]>0||t[i]!==n[i])return!1;return!0}function ZI(n,e){for(var t=n.length>0?n[n.length-1]:1,r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function z8(n,e){me(rw(n),(function(){return"The f passed in variableGrads(f) must be a function"})),me(e==null||Array.isArray(e)&&e.every((function(h){return h instanceof Wd})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var t=e!=null;if(!t)for(var r in e=[],Ie.registeredVariables)e.push(Ie.registeredVariables[r]);var i=t?e.filter((function(h){return!h.trainable})):null,o=e.length;me((e=e.filter((function(h){return h.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."}));var s=Ie.gradients(n,e,null,!0),a=s.value,u=s.grads;me(u.some((function(h){return h!=null})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),me(a.rank===0,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+a.rank+" tensor"}));var l={};return e.forEach((function(h,d){u[d]!=null&&(l[h.name]=u[d])})),i!=null&&i.forEach((function(h){return l[h.name]=null})),{value:a,grads:l}}function G0(n){return Ie.customGrad(n)}var ic=xe({softmax_:function(n,e){e===void 0&&(e=-1);var t=oe(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and dim was "+e);return Ie.runKernelFunc((function(r,i){var o=r.softmax(t,e);return i([o]),o}),{logits:t},(function(r,i){var o=i[0],s=r.mul(o);return{logits:function(){return s.sub(s.sum([e],!0).mul(o))}}}),"Softmax",{dim:e},[],[!0])}}),W8=xe({logSoftmax_:function(n,e){e===void 0&&(e=-1);var t=oe(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and axis was "+e);return G0((function(r,i){var o=r.max(e,!0),s=r.sub(o),a=s.toFloat().sub(s.exp().sum(e,!0).log());return i([a]),{value:a,gradFunc:function(u,l){var h=l[0].exp();return u.sub(u.sum(e,!0).mul(h))}}}))(t)}}),eT=(function(){function n(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return n.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},n.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},n.prototype.has=function(e){return this.data.has(e)},n.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},n.prototype.numDataIds=function(){return this.dataIdsCount},n})(),tT=(function(){function n(){}return n.prototype.time=function(e){return je("time")},n.prototype.read=function(e){return je("read")},n.prototype.readSync=function(e){return je("readSync")},n.prototype.numDataIds=function(){return je("numDataIds")},n.prototype.disposeData=function(e){return je("disposeData")},n.prototype.write=function(e,t,r){return je("write")},n.prototype.move=function(e,t,r,i){return je("move")},n.prototype.memory=function(){return je("memory")},n.prototype.floatPrecision=function(){return je("floatPrecision")},n.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},n.prototype.batchMatMul=function(e,t,r,i){return je("batchMatMul")},n.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,je("fusedBatchMatMul")},n.prototype.slice=function(e,t,r){return je("slice")},n.prototype.stridedSlice=function(e,t,r,i){return je("stridedSlice")},n.prototype.unstack=function(e,t){return je("unstack")},n.prototype.reverse=function(e,t){return je("reverse")},n.prototype.concat=function(e,t){return je("concat")},n.prototype.neg=function(e){return je("neg")},n.prototype.add=function(e,t){return je("add")},n.prototype.addN=function(e){return je("addN")},n.prototype.subtract=function(e,t){return je("subtract")},n.prototype.multiply=function(e,t){return je("multiply")},n.prototype.realDivide=function(e,t){return je("realDivide")},n.prototype.floorDiv=function(e,t){return je("floorDiv")},n.prototype.sum=function(e,t){return je("sum")},n.prototype.prod=function(e,t){return je("prod")},n.prototype.unsortedSegmentSum=function(e,t,r){return je("unsortedSegmentSum")},n.prototype.argMin=function(e,t){return je("argMin")},n.prototype.argMax=function(e,t){return je("argMax")},n.prototype.equal=function(e,t){return je("equal")},n.prototype.notEqual=function(e,t){return je("notEqual")},n.prototype.less=function(e,t){return je("less")},n.prototype.lessEqual=function(e,t){return je("lessEqual")},n.prototype.greater=function(e,t){return je("greater")},n.prototype.greaterEqual=function(e,t){return je("greaterEqual")},n.prototype.logicalNot=function(e){return je("logicalNot")},n.prototype.logicalAnd=function(e,t){return je("logicalAnd")},n.prototype.logicalOr=function(e,t){return je("logicalOr")},n.prototype.where=function(e){return je("where")},n.prototype.select=function(e,t,r){return je("select")},n.prototype.topk=function(e,t,r){return je("topk")},n.prototype.min=function(e,t){return je("min")},n.prototype.minimum=function(e,t){return je("minimum")},n.prototype.mod=function(e,t){return je("mod")},n.prototype.max=function(e,t){return je("max")},n.prototype.maximum=function(e,t){return je("maximum")},n.prototype.all=function(e,t){return je("all")},n.prototype.any=function(e,t){return je("any")},n.prototype.squaredDifference=function(e,t){return je("squaredDifference")},n.prototype.ceil=function(e){return je("ceil")},n.prototype.floor=function(e){return je("floor")},n.prototype.round=function(e){return je("round")},n.prototype.sign=function(e){return je("sign")},n.prototype.isNaN=function(e){return je("isNaN")},n.prototype.isInf=function(e){return je("isInf")},n.prototype.isFinite=function(e){return je("isFinite")},n.prototype.pow=function(e,t){return je("pow")},n.prototype.exp=function(e){return je("exp")},n.prototype.expm1=function(e){return je("expm1")},n.prototype.softmax=function(e,t){return je("softmax")},n.prototype.log=function(e){return je("log")},n.prototype.log1p=function(e){return je("log1p")},n.prototype.sqrt=function(e){return je("sqrt")},n.prototype.rsqrt=function(e){return je("rsqrt")},n.prototype.square=function(e){return je("square")},n.prototype.reciprocal=function(e){return je("reciprocal")},n.prototype.relu=function(e){return je("relu")},n.prototype.relu6=function(e){return je("relu6")},n.prototype.prelu=function(e,t){return je("prelu")},n.prototype.elu=function(e){return je("elu")},n.prototype.eluDer=function(e,t){return je("eluDer")},n.prototype.selu=function(e){return je("selu")},n.prototype.int=function(e){return je("int")},n.prototype.clip=function(e,t,r){return je("clip")},n.prototype.abs=function(e){return je("abs")},n.prototype.complexAbs=function(e){return je("complexAbs")},n.prototype.sigmoid=function(e){return je("sigmoid")},n.prototype.softplus=function(e){return je("softplus")},n.prototype.sin=function(e){return je("sin")},n.prototype.cos=function(e){return je("cos")},n.prototype.tan=function(e){return je("tan")},n.prototype.asin=function(e){return je("asin")},n.prototype.acos=function(e){return je("acos")},n.prototype.atan=function(e){return je("atan")},n.prototype.atan2=function(e,t){return je("atan2")},n.prototype.sinh=function(e){return je("sinh")},n.prototype.cosh=function(e){return je("cosh")},n.prototype.tanh=function(e){return je("tanh")},n.prototype.asinh=function(e){return je("asinh")},n.prototype.acosh=function(e){return je("acosh")},n.prototype.atanh=function(e){return je("atanh")},n.prototype.erf=function(e){return je("erf")},n.prototype.step=function(e,t){return je("step")},n.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,je("fusedConv2d")},n.prototype.conv2d=function(e,t,r){return je("conv2d")},n.prototype.conv2dDerInput=function(e,t,r){return je("conv2dDerInput")},n.prototype.conv2dDerFilter=function(e,t,r){return je("conv2dDerFilter")},n.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,je("fusedDepthwiseConv2D")},n.prototype.depthwiseConv2D=function(e,t,r){return je("depthwiseConv2D")},n.prototype.depthwiseConv2DDerInput=function(e,t,r){return je("depthwiseConv2DDerInput")},n.prototype.depthwiseConv2DDerFilter=function(e,t,r){return je("depthwiseConv2DDerFilter")},n.prototype.conv3d=function(e,t,r){return je("conv3d")},n.prototype.conv3dDerInput=function(e,t,r){return je("conv3dDerInput")},n.prototype.conv3dDerFilter=function(e,t,r){return je("conv3dDerFilter")},n.prototype.maxPool=function(e,t){return je("maxPool")},n.prototype.maxPoolBackprop=function(e,t,r,i){return je("maxPoolBackprop")},n.prototype.avgPool=function(e,t){return je("avgPool")},n.prototype.avgPoolBackprop=function(e,t,r){return je("avgPoolBackprop")},n.prototype.avgPool3d=function(e,t){return je("avgPool3d")},n.prototype.avgPool3dBackprop=function(e,t,r){return je("avgPool3dBackprop")},n.prototype.maxPool3d=function(e,t){return je("maxPool3d")},n.prototype.maxPool3dBackprop=function(e,t,r,i){return je("maxPool3dBackprop")},n.prototype.reshape=function(e,t){return je("reshape")},n.prototype.cast=function(e,t){return je("cast")},n.prototype.tile=function(e,t){return je("tile")},n.prototype.pad=function(e,t,r){return je("pad")},n.prototype.transpose=function(e,t){return je("transpose")},n.prototype.gather=function(e,t,r){return je("gather")},n.prototype.gatherND=function(e,t){return je("gatherND")},n.prototype.scatterND=function(e,t,r){return je("scatterND")},n.prototype.batchToSpaceND=function(e,t,r){return je("batchToSpaceND")},n.prototype.spaceToBatchND=function(e,t,r){return je("spaceToBatchND")},n.prototype.resizeBilinear=function(e,t,r,i){return je("resizeBilinear")},n.prototype.resizeBilinearBackprop=function(e,t,r){return je("resizeBilinearBackprop")},n.prototype.resizeNearestNeighbor=function(e,t,r,i){return je("resizeNearestNeighbor")},n.prototype.resizeNearestNeighborBackprop=function(e,t,r){return je("resizeNearestNeighborBackprop")},n.prototype.batchNormalization=function(e,t,r,i,o,s){return je("batchNormalization")},n.prototype.localResponseNormalization4D=function(e,t,r,i,o){return je("localResponseNormalization4D")},n.prototype.LRNGrad=function(e,t,r,i,o,s,a){return je("LRNGrad")},n.prototype.multinomial=function(e,t,r,i){return je("multinomial")},n.prototype.oneHot=function(e,t,r,i){return je("oneHot")},n.prototype.cumsum=function(e,t,r,i){return je("cumsum")},n.prototype.nonMaxSuppression=function(e,t,r,i,o){return je("nonMaxSuppression")},n.prototype.fft=function(e){return je("fft")},n.prototype.ifft=function(e){return je("ifft")},n.prototype.complex=function(e,t){return je("complex")},n.prototype.real=function(e){return je("real")},n.prototype.imag=function(e){return je("imag")},n.prototype.cropAndResize=function(e,t,r,i,o,s){return je("cropAndResize")},n.prototype.depthToSpace=function(e,t,r){return je("depthToSpace")},n.prototype.split=function(e,t,r){return je("split")},n.prototype.sparseToDense=function(e,t,r,i){return je("sparseToDense")},n.prototype.diag=function(e){return je("diag")},n.prototype.fill=function(e,t,r){return je("fill")},n.prototype.onesLike=function(e){return je("onesLike")},n.prototype.zerosLike=function(e){return je("zerosLike")},n.prototype.linspace=function(e,t,r){return je("linspace")},n.prototype.dispose=function(){return je("dispose")},n})();function je(n){throw new Error("'"+n+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Hc(n,e){for(var t=n.length,r=[],i=0;i<t;i++){var o=t-1-i,s=n[o]||1;(e[e.length-1-i]||1)>1&&s===1&&r.unshift(o)}return r}function $i(n,e){for(var t=[],r=0;r<e.length;r++){var i=n[n.length-r-1],o=e.length-r-1,s=e[o];(i==null||i===1&&s>1)&&t.unshift(o)}return t}function Mn(n,e){for(var t=[],r=Math.max(n.length,e.length),i=0;i<r;i++){var o=n[n.length-i-1];o==null&&(o=1);var s=e[e.length-i-1];if(s==null&&(s=1),o===1)t.unshift(s);else if(s===1)t.unshift(o);else{if(o!==s)throw Error("Operands could not be broadcast together with shapes "+n+" and "+e+".");t.unshift(o)}}return t}function Em(n,e,t,r,i,o,s){s===void 0&&(s="channelsLast");var a,u=h0(e),l=u[0],h=u[1];if(s==="channelsLast")a=[l,h,n[3],n[3]];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);a=[l,h,n[1],n[1]]}return xf(n,a,t,r,i,o,!1,s)}function l0(n,e,t,r,i,o,s){s===void 0&&(s="NDHWC");var a,u,l=hw(e),h=l[0],d=l[1],m=l[2];if(s==="NDHWC")u="channelsLast",a=[h,d,m,n[4],n[4]];else{if(s!=="NCDHW")throw new Error("Unknown dataFormat "+s);u="channelsFirst",a=[h,d,m,n[1],n[1]]}return c0(n,a,t,r,i,!1,u,o)}function xf(n,e,t,r,i,o,s,a){s===void 0&&(s=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1],l=u[0],h=u[1],d=u[2],m=u[3];if(a==="channelsLast")l=n[0],h=n[1],d=n[2],m=n[3];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=n[0],m=n[1],h=n[2],d=n[3]}var p,y=e[0],b=e[1],x=e[3],E=h0(t),T=E[0],P=E[1],I=h0(r),D=I[0],U=I[1],L=_d(y,D),C=_d(b,U),A=(function(X,ue,ge,he,$,le,ae,J){var W,Q,ne;if(typeof X=="number"){W={top:X,bottom:X,left:X,right:X,type:X===0?"VALID":"NUMBER"};var fe=(function(qe,Ne,Oe,Qe,te){Qe==null&&(Qe=nT(qe,Ne,Oe));var rt=qe[0],zt=qe[1],gt=om((rt-Ne+2*Qe)/Oe+1,te);me(xi(gt),(function(){return"The output # of rows ("+gt+") must be an integer. Change the stride and/or zero pad parameters"}));var He=om((zt-Ne+2*Qe)/Oe+1,te);return me(xi(He),(function(){return"The output # of columns ("+He+") must be an integer. Change the stride and/or zero pad parameters"})),[gt,He]})([ue,ge],le,he,X,J);Q=fe[0],ne=fe[1]}else if(X==="same"){Q=Math.ceil(ue/he),ne=Math.ceil(ge/$);var ve=Math.max(0,(Q-1)*he+le-ue),we=Math.max(0,(ne-1)*$+ae-ge),Se=Math.floor(ve/2),Ce=ve-Se,Fe=Math.floor(we/2);W={top:Se,bottom:Ce,left:Fe,right:we-Fe,type:"SAME"}}else{if(X!=="valid")throw Error("Unknown padding parameter: "+X);W={top:0,bottom:0,left:0,right:0,type:"VALID"},Q=Math.ceil((ue-le+1)/he),ne=Math.ceil((ge-ae+1)/$)}return{padInfo:W,outHeight:Q,outWidth:ne}})(i,h,d,T,P,L,C,o),M=A.padInfo,k=A.outHeight,O=A.outWidth,j=s?x*m:x;return a==="channelsFirst"?p=[l,j,k,O]:a==="channelsLast"&&(p=[l,k,O,j]),{batchSize:l,dataFormat:a,inHeight:h,inWidth:d,inChannels:m,outHeight:k,outWidth:O,outChannels:j,padInfo:M,strideHeight:T,strideWidth:P,filterHeight:y,filterWidth:b,effectiveFilterHeight:L,effectiveFilterWidth:C,dilationHeight:D,dilationWidth:U,inShape:n,outShape:p,filterShape:e}}function c0(n,e,t,r,i,o,s,a){o===void 0&&(o=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],h=u[1],d=u[2],m=u[3],p=u[4];if(s==="channelsLast")l=n[0],h=n[1],d=n[2],m=n[3],p=n[4];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=n[0],p=n[1],h=n[2],d=n[3],m=n[4]}var y,b=e[0],x=e[1],E=e[2],T=e[4],P=hw(t),I=P[0],D=P[1],U=P[2],L=hw(r),C=L[0],A=L[1],M=L[2],k=_d(b,C),O=_d(x,A),j=_d(E,M),X=(function(ae,J,W,Q,ne,fe,ve,we,Se,Ce,Fe){var qe,Ne,Oe,Qe;if(typeof ae=="number"){qe={top:ae,bottom:ae,left:ae,right:ae,front:ae,back:ae,type:ae===0?"VALID":"NUMBER"};var te=(function(En,$t,Qt,an,qt,vt){qt==null&&(qt=nT(En,$t,an));var en=En[0],yt=En[1],dr=En[2],mn=om((en-$t+2*qt)/an+1,vt);me(xi(mn),(function(){return"The output # of depths ("+mn+") must be an integer. Change the stride and/or zero pad parameters"}));var rn=om((yt-$t+2*qt)/an+1,vt);me(xi(rn),(function(){return"The output # of rows ("+rn+") must be an integer. Change the stride and/or zero pad parameters"}));var un=om((dr-$t+2*qt)/an+1,vt);return me(xi(un),(function(){return"The output # of columns ("+un+") must be an integer. Change the stride and/or zero pad parameters"})),[mn,rn,un,Qt]})([J,W,Q,1],we,1,ne,ae,Fe);Ne=te[0],Oe=te[1],Qe=te[2]}else if(ae==="same"){Ne=Math.ceil(J/ne),Oe=Math.ceil(W/fe),Qe=Math.ceil(Q/ve);var rt=(Ne-1)*ne+we-J,zt=(Oe-1)*fe+Se-W,gt=(Qe-1)*ve+Ce-Q,He=Math.floor(rt/2),ft=rt-He,lt=Math.floor(zt/2),Et=zt-lt,pt=Math.floor(gt/2);qe={top:lt,bottom:Et,left:pt,right:gt-pt,front:He,back:ft,type:"SAME"}}else{if(ae!=="valid")throw Error("Unknown padding parameter: "+ae);qe={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Ne=Math.ceil((J-we+1)/ne),Oe=Math.ceil((W-Se+1)/fe),Qe=Math.ceil((Q-Ce+1)/ve)}return{padInfo:qe,outDepth:Ne,outHeight:Oe,outWidth:Qe}})(i,h,d,m,I,D,U,k,O,j,a),ue=X.padInfo,ge=X.outDepth,he=X.outHeight,$=X.outWidth,le=o?T*p:T;return s==="channelsFirst"?y=[l,le,ge,he,$]:s==="channelsLast"&&(y=[l,ge,he,$,le]),{batchSize:l,dataFormat:s,inDepth:h,inHeight:d,inWidth:m,inChannels:p,outDepth:ge,outHeight:he,outWidth:$,outChannels:le,padInfo:ue,strideDepth:I,strideHeight:D,strideWidth:U,filterDepth:b,filterHeight:x,filterWidth:E,effectiveFilterDepth:k,effectiveFilterHeight:O,effectiveFilterWidth:j,dilationDepth:C,dilationHeight:A,dilationWidth:M,inShape:n,outShape:y,filterShape:e}}function nT(n,e,t,r){r===void 0&&(r=1);var i=_d(e,r);return Math.floor((n[0]*(t-1)-t+i)/2)}function h0(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function hw(n){return typeof n=="number"?[n,n,n]:n}function _d(n,e){return e<=1?n:n+(n-1)*(e-1)}function om(n,e){if(!e)return n;switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error("Unknown roundingMode "+e)}}function Hd(n){var e=h0(n),t=e[0],r=e[1],i=e[2];return t===1&&r===1&&i===1}function Gs(n,e){return Hd(n)||Hd(e)}function Xb(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+n)}function rT(n,e,t){if(e==="complex64"){if(n.dtype==="complex64")return n.clone();var r=Tr(n.shape),i=n.toFloat(),o=t.complex(i,r);return r.dispose(),i.dispose(),o}if(!gF(n.dtype,e))return Ie.makeTensorFromDataId(n.dataId,n.shape,e);if(n.dtype==="complex64"){var s=t.real(n);return o=s.cast(e),s.dispose(),o}if(e==="int32")return t.int(n);if(e==="bool"){var a=dt(0,n.dtype);return o=t.notEqual(n,a),a.dispose(),o}throw new Error("Error in Cast: failed to cast "+n.dtype+" to "+e)}function fw(n,e){return Ie.makeTensorFromDataId(n.dataId,e,n.dtype)}function iT(n,e,t){var r=(e-n)/(t-1),i=Wm(t,"float32");i[0]=n;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return Di(i,"float32")}function dw(n,e){if(n.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+n.length+", imag: "+e.length+".");for(var t=new Float32Array(2*n.length),r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function dS(n,e){return{real:n[2*e],imag:n[2*e+1]}}function q8(n,e,t,r){n[2*r]=e,n[2*r+1]=t}function H8(n,e,t){var r=(t?2:-2)*Math.PI*(n/e);return{real:Math.cos(r),imag:Math.sin(r)}}function G8(n,e,t){var r=(function(o,s,a){return(function(u,l,h){for(var d=0,m=u.length,p=0,y=!1;d<m;){var b=h(l,u[p=d+(m-d>>>1)]);b>0?d=p+1:(m=p,y=!b)}return y?d:-d-1})(o,s,a||$8)})(n,e,t),i=r<0?-(r+1):r;n.splice(i,0,e)}function $8(n,e){return n>e?1:n<e?-1:0}function Yb(n,e,t,r,i){return oT(n,e,t,r,i,0).selectedIndices}function Qb(n,e,t,r,i,o){var s=oT(n,e,t,r,i,o);return s.numValidOutputs.dispose(),{selectedIndices:s.selectedIndices,selectedScores:s.selectedScores}}function oT(n,e,t,r,i,o,s,a){a===void 0&&(a=!1);for(var u=Array.from(e).map((function(I,D){return{score:I,boxIndex:D,suppressBeginIndex:0}})).filter((function(I){return I.score>i})).sort(pS),l=o>0?-.5/o:0,h=[],d=[];h.length<t&&u.length>0;){var m=u.pop(),p=m.score,y=m.boxIndex,b=m.suppressBeginIndex;if(p<i)break;for(var x=!1,E=h.length-1;E>=b;--E){var T=K8(n,y,h[E]);if(T>=r){x=!0;break}if(m.score=m.score*X8(r,l,T),m.score<=i)break}m.suppressBeginIndex=h.length,x||(m.score===p?(h.push(y),d.push(m.score)):m.score>i&&G8(u,m,pS))}var P=h.length;return a&&(h.fill(0,P),d.fill(0,P)),{selectedIndices:Di(h,"int32"),selectedScores:Di(d,"float32"),numValidOutputs:dt(P,"int32")}}function K8(n,e,t){var r=n.subarray(4*e,4*e+4),i=n.subarray(4*t,4*t+4),o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),h=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),m=Math.max(i[1],i[3]),p=(a-o)*(u-s),y=(d-l)*(m-h);if(p<=0||y<=0)return 0;var b=Math.max(o,l),x=Math.max(s,h),E=Math.min(a,d),T=Math.min(u,m),P=Math.max(E-b,0)*Math.max(T-x,0);return P/(p+y-P)}function X8(n,e,t){var r=Math.exp(e*t*t);return t<=n?r:0}function pS(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}function sT(n,e,t){var r=new Array(n.rank).fill(0),i=n.shape.slice();return e.map((function(o){i[t]=o;var s=n.slice(r,i);return r[t]+=o,s}))}function aT(n,e){for(var t=new Array(n.rank),r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];var i=wn(t,n.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),s=new Array(n.rank),a=0;a<s.length;a++)s[a]=o[a]%n.shape[a];var u=n.locToIndex(s);i.values[r]=n.values[u]}return i.toTensor()}function uT(n,e,t,r,i){for(var o=e[e.length-1],s=[n.length/o,o],a=s[0],u=s[1],l=bm(t,a*r),h=bm("int32",a*r),d=0;d<a;d++){for(var m=d*u,p=n.subarray(m,m+u),y=[],b=0;b<p.length;b++)y.push({value:p[b],index:b});y.sort((function(I,D){return D.value-I.value}));var x=d*r,E=l.subarray(x,x+r),T=h.subarray(x,x+r);for(b=0;b<r;b++)E[b]=y[b].value,T[b]=y[b].index}var P=e.slice();return P[P.length-1]=r,[Po(l,P,t),Po(h,P,"int32")]}function Jb(n,e){for(var t=[],r=0;r<e.length;r++)e[r]&&t.push(r);var i=wn(n,"int32"),o=wn([t.length,n.length],"int32");for(r=0;r<t.length;r++){var s=i.indexToLoc(t[r]),a=r*n.length;o.values.set(s,a)}return o.toTensor()}var Y8=function(n,e){this.outputShape=[],this.outputShape=n,this.variableNames=e.map((function(i,o){return"T"+o}));var t=[];this.variableNames.forEach((function(i){t.push("float v"+i+" = get"+i+"AtOutCoords();")}));var r=this.variableNames.map((function(i){return"v"+i})).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},Q8=function(n,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=e.map((function(i,o){return"T"+o}));var t=[];this.variableNames.forEach((function(i){t.push("vec4 v"+i+" = get"+i+"AtOutCoords();")}));var r=this.variableNames.map((function(i){return"v"+i})).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},J8=function(n,e,t){this.variableNames=["A"];var r=n.windowSize,i=n.batchSize,o=n.inSize,s=Math.ceil(o/r);t||this.variableNames.push("bestIndicesA"),this.outputShape=[i,s];var a=e==="max"?">":"<",u=t?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+a+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function lT(n,e){return["x","y","z","w","u","v"].slice(0,e).map((function(t){return n+"."+t}))}function Ws(n,e){return e===1?[n]:lT(n,e)}function os(){var n,e,t,r,i,o,s,a,u,l;return Ye().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",i="texture",o="outputColor",s="out vec4 outputColor;",a=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",i="texture2D",o="gl_FragColor",s="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:i,output:o,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:u,defineRound:l}}function ef(n,e,t){t===void 0&&(t="index");var r=ll(e);return r.map((function(i,o){return"int "+n[o]+" = "+t+" / "+i+"; "+(o===r.length-1?"int "+n[o+1]+" = "+t+" - "+n[o]+" * "+i:"index -= "+n[o]+" * "+i)+";"})).join("")}function Zb(n){var e=ll(n).map((function(t){return t.toString()}));return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var cT=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function Z8(n,e,t,r){var i=[];n.forEach((function(p){var y=Mt(p.shapeInfo.logicalShape);p.shapeInfo.isUniform?i.push("uniform float "+p.name+(y>1?"["+y+"]":"")+";"):(i.push("uniform sampler2D "+p.name+";"),i.push("uniform int offset"+p.name+";"))}));var o,s,a=i.join(`
`),u=n.map((function(p){return(function(y,b,x){x===void 0&&(x=!1);var E="";E+=x?hT(y):rd(y);var T=y.shapeInfo.logicalShape,P=b.logicalShape;return T.length<=P.length&&(E+=x?(function(I,D){var U,L=I.name,C=L.charAt(0).toUpperCase()+L.slice(1),A="get"+C+"AtOutCoords",M=I.shapeInfo.logicalShape.length,k=D.logicalShape.length,O=Hc(I.shapeInfo.logicalShape,D.logicalShape),j=Cr(k),X=k-M,ue=["x","y","z","w","u","v"];U=M===0?"":k<2&&O.length>=1?"coords = 0;":O.map((function(W){return"coords."+ue[W+X]+" = 0;"})).join(`
`);var ge="";ge=k<2&&M>0?"coords":I.shapeInfo.logicalShape.map((function(W,Q){return"coords."+ue[Q+X]})).join(", ");var he="return outputValue;",$=Mt(I.shapeInfo.logicalShape)===1,le=Mt(D.logicalShape)===1;if(M!==1||$||le){if($&&!le)he=k===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(O.length){var ae=M-2,J=M-1;O.indexOf(ae)>-1&&O.indexOf(J)>-1?he="return vec4(outputValue.x);":O.indexOf(ae)>-1?he="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":O.indexOf(J)>-1&&(he="return vec4(outputValue.xx, outputValue.zz);")}}else he=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+A+`() {
      `+j+` coords = getOutputCoords();
      `+U+`
      vec4 outputValue = get`+C+"("+ge+`);
      `+he+`
    }
  `})(y,b):(function(I,D){var U=I.name,L=U.charAt(0).toUpperCase()+U.slice(1),C="get"+L+"AtOutCoords",A=D.texShape,M=I.shapeInfo.texShape,k=I.shapeInfo.logicalShape.length,O=D.logicalShape.length;if(!I.shapeInfo.isUniform&&k===O&&I.shapeInfo.flatOffset==null&&po(M,A))return`
      float `+C+`() {
        return sampleTexture(`+U+`, resultUV);
      }
    `;var j,X=Cr(O),ue=Hc(I.shapeInfo.logicalShape,D.logicalShape),ge=O-k,he=["x","y","z","w","u","v"];j=k===0?"":O<2&&ue.length>=1?"coords = 0;":ue.map((function(le){return"coords."+he[le+ge]+" = 0;"})).join(`
`);var $="";return $=O<2&&k>0?"coords":I.shapeInfo.logicalShape.map((function(le,ae){return"coords."+he[ae+ge]})).join(", "),`
    float `+C+`() {
      `+X+` coords = getOutputCoords();
      `+j+`
      return get`+L+"("+$+`);
    }
  `})(y,b)),E})(p,e,r)})).join(`
`),l=e.texShape,h=os(),d=(function(p){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+p.texture2D+`(textureSampler, uv).r;
    }
  `})(h),m=(function(p){return p.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+p.varyingFs+` vec2 resultUV;
    `+p.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+p.defineSpecialNaN+`
    `+p.defineSpecialInf+`
    `+p.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+eB+`
    `+tB+`
    `+nB+`
  `})(h);return e.isPacked?(o=(function(p,y){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(I,D){var U=[Math.ceil(D[0]/2),Math.ceil(D[1]/2)];return U[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+U[1]+`.0);
      }
    `:U[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+U[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+U[0]+", "+U[1]+`));
      return 2 * (resTexRC.x * `+U[1]+` + resTexRC.y);
    }
  `})(0,y);case 2:return(function(I,D){var U=[Math.ceil(D[0]/2),Math.ceil(D[1]/2)];if(po(I,D))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+U[0]+", "+U[1]+`));
      }
    `;var L=Math.ceil(I[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+U[0]+", "+U[1]+`));

      int index = resTexRC.x * `+U[1]+` + resTexRC.y;
      int r = 2 * (index / `+L+`);
      int c = imod(index, `+L+`) * 2;

      return ivec2(r, c);
    }
  `})(p,y);case 3:return b=p,x=y,E=[Math.ceil(x[0]/2),Math.ceil(x[1]/2)],T=Math.ceil(b[2]/2),P=T*Math.ceil(b[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      int b = index / `+P+`;
      index -= b * `+P+`;

      int r = 2 * (index / `+T+`);
      int c = imod(index, `+T+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return(function(I,D){for(var U=[Math.ceil(D[0]/2),Math.ceil(D[1]/2)],L=Math.ceil(I[I.length-1]/2),C=L*Math.ceil(I[I.length-2]/2),A=C,M="",k="b, r, c",O=2;O<I.length-1;O++)A*=I[I.length-O-1],M=`
      int b`+O+" = index / "+A+`;
      index -= b`+O+" * "+A+`;
    `+M,k="b"+O+", "+k;return`
    ivec`+I.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+U[0]+", "+U[1]+`));
      int index = resTexRC.x * `+U[1]+` + resTexRC.y;

      `+M+`

      int b = index / `+C+`;
      index -= b * `+C+`;

      int r = 2 * (index / `+L+`);
      int c = imod(index, `+L+`) * 2;

      return ivec`+I.length+"("+k+`);
    }
  `})(p,y)}var b,x,E,T,P})(e.logicalShape,l),s=(function(p){return`
    void setOutput(vec4 val) {
      `+p.output+` = val;
    }
  `})(h)):(o=(function(p,y){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(E,T){return T[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+T[1]+`.0);
      }
    `:T[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+T[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+T[0]+", "+T[1]+`));
      return resTexRC.x * `+T[1]+` + resTexRC.y;
    }
  `})(0,y);case 2:return(function(E,T){return po(E,T)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+T[0]+", "+T[1]+`));
      }
    `:E[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+T[0]+", "+T[1]+`));
        int index = resTexRC.x * `+T[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:E[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+T[0]+", "+T[1]+`));
        int index = resTexRC.x * `+T[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+T[0]+", "+T[1]+`));
      int index = resTexRC.x * `+T[1]+` + resTexRC.y;
      int r = index / `+E[1]+`;
      int c = index - r * `+E[1]+`;
      return ivec2(r, c);
    }
  `})(p,y);case 3:return b=y,x=ef(["r","c","d"],p),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+b[0]+", "+b[1]+`));
      int index = resTexRC.x * `+b[1]+` + resTexRC.y;
      `+x+`
      return ivec3(r, c, d);
    }
  `;case 4:return(function(E,T){var P=ef(["r","c","d","d2"],E);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+T[0]+", "+T[1]+`));
      int index = resTexRC.x * `+T[1]+` + resTexRC.y;
      `+P+`
      return ivec4(r, c, d, d2);
    }
  `})(p,y);case 5:return(function(E,T){var P=ef(["r","c","d","d2","d3"],E);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+T[0]+`,
                             `+T[1]+`));

      int index = resTexRC.x * `+T[1]+` + resTexRC.y;

      `+P+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `})(p,y);case 6:return(function(E,T){var P=ef(["r","c","d","d2","d3","d4"],E);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+T[0]+", "+T[1]+`));
      int index = resTexRC.x * `+T[1]+` + resTexRC.y;

      `+P+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `})(p,y);default:throw new Error(p.length+"-D output sampling is not yet supported")}var b,x})(e.logicalShape,l),s=(function(p){return`
    void setOutput(float val) {
      `+p.output+` = vec4(val, 0, 0, 0);
    }
  `})(h)),r&&(m+=rB),[m,d,s,a,o,u,t].join(`
`)}function rd(n){var e=n.shapeInfo.logicalShape;switch(e.length){case 0:return(function(t){var r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var o=t.shapeInfo.texShape,s=o[0],a=o[1];if(s===1&&a===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=t.shapeInfo.texShape,l=u[0],h=u[1],d=qh(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+l+", "+h+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `})(n);case 1:return(function(t){var r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+Yf(t)+`
      }
    `;var o=t.shapeInfo.texShape,s=o[0],a=o[1];if(a===1&&s===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=qh(r);return a===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+s+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+a+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+s+", "+a+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `})(n);case 2:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=t.shapeInfo.texShape;if(s!=null&&po(r,s)){var a=s[0],u=s[1];return`
    float `+o+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+a+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var l=Qh(r),h=l.newShape,d=l.keptDims,m=h;if(m.length<r.length){var p=id(t,m);return`
      `+rd(p)+`
      float `+o+`(int row, int col) {
        return `+o+"("+od(["row","col"],d)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Yf(t)+`
      }
    `;var y=s[0],b=s[1],x=qh(i);return b===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+x+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+y+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:y===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+x+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+b+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+o+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+x+`;
    vec2 uv = uvFromFlat(`+y+", "+b+`, index);
    return sampleTexture(`+i+`, uv);
  }
`})(n);case 3:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=r[1]*r[2],a=r[2],u=Qh(r),l=u.newShape,h=u.keptDims,d=l;if(d.length<r.length){var m=id(t,d);return`
        `+rd(m)+`
        float `+o+`(int row, int col, int depth) {
          return `+o+"("+od(["row","col","depth"],h)+`);
        }
      `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+s+", "+a+`, 1)));
        `+Yf(t)+`
      }
    `;var p=t.shapeInfo.texShape,y=p[0],b=p[1],x=t.shapeInfo.flatOffset;if(b===s&&x==null)return`
        float `+o+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+a+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+b+".0, "+y+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(b===a&&x==null)return`
    float `+o+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+b+".0, "+y+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var E=qh(i);return`
      float `+o+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+s+" + col * "+a+" + depth + "+E+`;
        vec2 uv = uvFromFlat(`+y+", "+b+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `})(n);case 4:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=r[3],a=r[2]*s,u=r[1]*a,l=Qh(r),h=l.newShape,d=l.keptDims;if(h.length<r.length){var m=id(t,h);return`
      `+rd(m)+`
      float `+o+`(int row, int col, int depth, int depth2) {
        return `+o+"("+od(["row","col","depth","depth2"],d)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+a+", "+s+`, 1)));
        `+Yf(t)+`
      }
    `;var p=t.shapeInfo.flatOffset,y=t.shapeInfo.texShape,b=y[0],x=y[1];if(x===u&&p==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+a+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+b+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(x===s&&p==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+b+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var E=qh(i);return`
    float `+o+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+a+` +
          depth * `+s+` + depth2;
      vec2 uv = uvFromFlat(`+b+", "+x+", index + "+E+`);
      return sampleTexture(`+i+`, uv);
    }
  `})(n);case 5:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=r[4],a=r[3]*s,u=r[2]*a,l=r[1]*u,h=Qh(r),d=h.newShape,m=h.keptDims;if(d.length<r.length){var p=id(t,d);return`
      `+rd(p)+`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        return `+o+"("+od(["row","col","depth","depth2","depth3"],m)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+a+", "+s+`)) +
          depth3;
        `+Yf(t)+`
      }
    `;var y=t.shapeInfo.flatOffset,b=t.shapeInfo.texShape,x=b[0],E=b[1];if(E===l&&y==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+a+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+E+".0, "+x+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(E===s&&y==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+E+".0, "+x+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var T=qh(i);return`
    float `+o+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+a+` +
          depth2 * `+s+" + depth3 + "+T+`;
      vec2 uv = uvFromFlat(`+x+", "+E+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `})(n);case 6:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=Qh(r),a=s.newShape,u=s.keptDims;if(a.length<r.length){var l=id(t,a);return`
      `+rd(l)+`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+o+"("+od(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var h=r[5],d=r[4]*h,m=r[3]*d,p=r[2]*m,y=r[1]*p;if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+y+", "+p+", "+m+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+h+`, 1)));
        `+Yf(t)+`
      }
    `;var b=t.shapeInfo.flatOffset,x=t.shapeInfo.texShape,E=x[0],T=x[1];if(T===y&&b==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+p+", "+m+", "+d+", "+h+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+T+".0, "+E+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(T===h&&b==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+T+".0, "+E+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var P=qh(i);return`
    float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+y+" + col * "+p+" + depth * "+m+` +
          depth2 * `+d+" + depth3 * "+h+" + depth4 + "+P+`;
      vec2 uv = uvFromFlat(`+E+", "+T+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `})(n);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function hT(n){var e,t,r;switch(n.shapeInfo.logicalShape.length){case 0:return e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=os(),`
    vec4 `+t+`() {
      return `+r.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return(function(i){var o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),a=i.shapeInfo.texShape,u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=os();return`
    vec4 `+s+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+o+`, uv);
    }
  `})(n);case 2:return(function(i){var o=i.shapeInfo.logicalShape,s=i.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),u=i.shapeInfo.texShape,l=u[0],h=u[1],d=os();if(u!=null&&po(o,u))return`
      vec4 `+a+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+h+".0, "+l+`.0);

        return `+d.texture2D+"("+s+`, uv);
      }
    `;var m=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],p=Math.ceil(o[1]/2);return`
    vec4 `+a+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+p+", "+m[0]+", "+m[1]+`, row, col);
      return `+d.texture2D+"("+s+`, uv);
    }
  `})(n);case 3:return(function(i){var o=i.shapeInfo.logicalShape,s=i.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),u=i.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(o[0]===1){var h=o.slice(1),d=id(i,h);return`
        `+hT(d)+`
        vec4 `+a+`(int b, int row, int col) {
          return `+a+"("+od(["b","row","col"],[1,2])+`);
        }
      `}var m=l[0],p=l[1],y=Math.ceil(o[2]/2),b=y*Math.ceil(o[1]/2),x=os();return`
    vec4 `+a+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+m+", "+p+", "+b+", "+y+`, b, row, col);
      return `+x.texture2D+"("+s+`, uv);
    }
  `})(n);default:return(function(i){for(var o=i.shapeInfo.logicalShape,s=o.length,a=i.name,u="get"+a.charAt(0).toUpperCase()+a.slice(1),l=i.shapeInfo.texShape,h=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=h[0],m=h[1],p=Math.ceil(o[s-1]/2),y=p*Math.ceil(o[s-2]/2),b="int b, int row, int col",x="b * "+y+" + (row / 2) * "+p+" + (col / 2)",E=2;E<s-1;E++)b="int b"+E+", "+b,y*=o[s-E-1],x="b"+E+" * "+y+" + "+x;var T=os();return`
    vec4 `+u+"("+b+`) {
      int index = `+x+`;
      int texR = index / `+m+`;
      int texC = index - texR * `+m+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+", "+d+`);
      return `+T.texture2D+"("+a+`, uv);
    }
  `})(n)}}var eB=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,tB=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,nB=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,rB=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function qh(n){return"offset"+n}function Yf(n){var e=n.name,t=Mt(n.shapeInfo.logicalShape);return t<2?"return "+e+";":`
    for (int i = 0; i < `+t+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function Cr(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error("GPU for rank "+n+" is not yet supported")}function id(n,e){var t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function od(n,e){return e.map((function(t){return n[t]})).join(", ")}var iB=function(n,e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,me(n.length>2,(function(){return"Packed arg"+(t.charAt(0).toUpperCase()+t.slice(1))+" supports only inputs with rank above 2."}));var i=n[n.length-1],o=Math.ceil(i/e);this.outputShape=n.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");var s,a,u=this.outputShape,l=u.length,h=Cr(l),d=Ws("coords",l);if(o===1){var m=Cr(a=l+1);s=`
        `+m+" sourceLocR = "+m+"("+d.join()+`, 0);
        ++`+d[l-1]+`;
        `+m+" sourceLocG = "+m+"("+d.join()+`, 0);
        ++`+d[l-2]+`;
        `+m+" sourceLocA = "+m+"("+d.join()+`, 0);
        --`+d[l-1]+`;
        `+m+" sourceLocB = "+m+"("+d.join()+`, 0);
        --`+d[l-2]+";"}else a=l,s=`
        `+h+` sourceLocR = coords;
        ++`+d[l-1]+`;
        `+h+` sourceLocG = coords;
        ++`+d[l-2]+`;
        `+h+` sourceLocA = coords;
        --`+d[l-1]+`;
        `+h+` sourceLocB = coords;
        --`+d[l-2]+";";var p=["x","y","z","w","u","v"].slice(0,a),y="."+p[a-1],b=p.map((function(C){return"int "+C})),x=Ws("sourceLocR",a-1).concat("inIdx.r"),E=Ws("sourceLocG",a-1).concat("inIdx.g"),T=Ws("sourceLocB",a-1).concat("inIdx.b"),P=Ws("sourceLocA",a-1).concat("inIdx.a"),I=t==="max"?"greaterThan":"lessThan",D=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+E.join()+`),
                             getBestIndicesAChannel(`+T.join()+`),
                             getBestIndicesAChannel(`+P.join()+")));",U=`vec4(
            getAChannel(`+x.join()+`),
            hasNextCol ? getAChannel(`+E.join()+`) : 0.,
            hasNextRow ? getAChannel(`+T.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+P.join()+") : 0.)",L=r?"":`
      float getBestIndicesAChannel(`+b.join()+`) {
        return getChannel(getBestIndicesA(`+p.join()+`),
                                          vec2(`+p.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+b.join()+`) {
        return getChannel(getA(`+p.join()+`),
                               vec2(`+p.slice(-2).join()+`));
      }
      `+L+`
      void main() {
        `+h+` coords = getOutputCoords();
        bool hasNextCol = `+d[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+d[l-2]+" < "+(u[l-2]-1)+`;
        `+s+`
        ivec4 srcIdx = ivec4(sourceLocR`+y+", sourceLocG"+y+`,
          sourceLocB`+y+", sourceLocA"+y+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+U+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+D+`
          vec4 candidate = `+U+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+I+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},oB=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=n.dilationHeight,s=n.dilationWidth,a=n.effectiveFilterHeight,u=n.effectiveFilterWidth,l=a-1-n.padInfo.top,h=u-1-n.padInfo.left,d=1/(e*t);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+h+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
            wR += `+o+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+s+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},sB=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var e=n.filterDepth,t=n.filterHeight,r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,h=n.effectiveFilterDepth,d=n.effectiveFilterHeight,m=n.effectiveFilterWidth,p=h-1-n.padInfo.front,y=d-1-n.padInfo.top,b=m-1-n.padInfo.left,x=1/(e*t*r);this.userCode=`
      const ivec3 pads = ivec3(`+p+", "+y+", "+b+`);
      const float avgMultiplier = float(`+x+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+h+`;
            wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+m+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},aB=function(n,e,t,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Mn(n,e),Mn(n,t);var s="0.0";r!=null&&(Mn(n,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="1.0";i!=null&&(Mn(n,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+s+`;
        float scale = `+a+`;
        float inv = scale * inversesqrt(variance + float(`+o+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},uB=function(n,e,t,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Mn(n,e),Mn(n,t);var s="vec4(0.0)";r!=null&&(Mn(n,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="vec4(1.0)";i!=null&&(Mn(n,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        vec4 offset = `+s+`;
        vec4 scale = `+a+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+o+`));

        setOutput((x - mean) * inv + offset);
      }
    `},lB="return areal * breal - aimag * bimag;",cB="return areal * bimag + aimag * breal;",mS=function(n,e,t){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Mn(e,t),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+n+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Vy="return a + b;",jy="return a - b;",gS="return a * b;",fT="return (a < 0.) ? b * a : a;",ii=function(n,e,t){this.variableNames=["A","B"],this.outputShape=Mn(e,t),this.userCode=`
      float binaryOperation(float a, float b) {
        `+n+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},dT=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Gl=function(n,e,t,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Mn(e,t);var i=this.outputShape.length,o="";if(r)if(i===0||Mt(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          `+Cr(i)+` coords = getOutputCoords();
        `,i===1)o+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var s=Ws("coords",i);o+=`
            bool nextRowOutOfBounds =
              (`+s[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+s[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+n+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+o+`

        setOutput(result);
      }
    `},hB=(function(){function n(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return n.prototype.getCustomSetupFunc=function(e,t){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,e),i.gl.uniform1f(r.maxLoc,t)}},n})(),fB=(function(){function n(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return n.prototype.getCustomSetupFunc=function(e,t){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,e),i.gl.uniform1f(r.maxLoc,t)}},n})(),dB=function(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},pB=function(n){this.outputShape=[],this.outputShape=qd(n,1),this.variableNames=n.map((function(a,u){return"T"+u}));var e=new Array(n.length-1);e[0]=n[0][1];for(var t=1;t<e.length;t++)e[t]=e[t-1]+n[t][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(t=1;t<e.length;t++){var i=e[t-1];r.push("else if (yC < "+e[t]+") setOutput(getT"+t+"(yR, yC-"+i+"));")}var o=e.length,s=e[e.length-1];r.push("else setOutput(getT"+o+"(yR, yC-"+s+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},mB=function(n,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=qd(n,e);var t=this.outputShape,r=t.length,i=Cr(r),o=Ws("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=n.map((function(x,E){return"T"+E}));var a=new Array(n.length-1);a[0]=n[0][e];for(var u=1;u<a.length;u++)a[u]=a[u-1]+n[u][e];var l=s[e],h=s.slice(-2),d=s.join(),m="if ("+l+" < "+a[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+h.join()+`));
        }`;for(u=1;u<a.length;u++){var p=a[u-1];m+=`
        if (`+l+" < "+a[u]+"  && "+l+" >= "+a[u-1]+`) {
          return getChannel(
            getT`+u+"("+Zg(s,l,p)+`),
            vec2(`+Zg(h,l,p)+`));
        }`}var y=a.length,b=a[a.length-1];m+=`
        return getChannel(
          getT`+y+"("+Zg(s,l,b)+`),
          vec2(`+Zg(h,l,b)+"));",this.userCode=`
      float getValue(`+s.map((function(x){return"int "+x}))+`) {
        `+m+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+o+`), 0., 0., 0.);

        `+o[r-1]+" = "+o[r-1]+` + 1;
        if (`+o[r-1]+" < "+t[r-1]+`) {
          result.g = getValue(`+o+`);
        }

        `+o[r-2]+" = "+o[r-2]+` + 1;
        if (`+o[r-2]+" < "+t[r-2]+`) {
          result.a = getValue(`+o+`);
        }

        `+o[r-1]+" = "+o[r-1]+` - 1;
        if (`+o[r-2]+" < "+t[r-2]+` &&
            `+o[r-1]+" < "+t[r-1]+`) {
          result.b = getValue(`+o+`);
        }
        setOutput(result);
      }
    `};function Zg(n,e,t){var r=n.indexOf(e);return n.map((function(i,o){return o===r?i+" - "+t:i})).join()}var gB=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideHeight,t=n.strideWidth,r=n.padInfo.top,i=n.padInfo.left,o=n.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+i+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              if (`+o+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},vB=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=n.dataFormat==="channelsLast",s=e-1-n.padInfo.top,a=t-1-n.padInfo.left,u=o?1:2,l=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+h+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {

              if (`+o+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},yB=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideDepth,t=n.strideHeight,r=n.strideWidth,i=n.padInfo.front,o=n.padInfo.top,s=n.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yF = 0; yF < `+n.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+i+`;

            if (xF < 0 || xF >= `+n.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+n.outHeight+`; yR++) {
              int xR = wR + yR * `+t+" - "+o+`;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+n.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+s+`;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},wB=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterDepth,t=n.filterHeight,r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=e-1-n.padInfo.front,u=t-1-n.padInfo.top,l=r-1-n.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+a+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+n.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+t+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+t+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},bB=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideHeight,t=n.strideWidth,r=n.padInfo.top,i=n.padInfo.left,o=n.outChannels/n.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+o+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+i+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},xB=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=e-1-n.padInfo.top,s=t-1-n.padInfo.left,a=n.outChannels/n.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+a+`; dm++) {
              int d2 = d1 * `+a+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},vS=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var i=n.padInfo.top,o=n.padInfo.left,s=n.strideHeight,a=n.strideWidth,u=n.dilationHeight,l=n.dilationWidth,h=n.filterHeight,d=n.filterWidth,m=4*Math.floor(n.inChannels/4),p=n.inChannels%4,y=n.dataFormat==="channelsLast",b=y?1:2,x=y?2:3,E=y?3:1,T="",P="";t&&(T=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,P="result = activation(result);");var I=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+T+`

      const ivec2 strides = ivec2(`+s+", "+a+`);
      const ivec2 pads = ivec2(`+i+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+E+`];

        ivec2 xRCCorner =
            ivec2(coords[`+b+"], coords["+x+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+h+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+n.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+m+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+y+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(p===1)+`) {

              if (`+y+`) {
                dotProd +=
                    getX(batch, xR, xC, `+m+`) *
                    getW(wR, wC, `+m+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+m+`, xR, xC) *
                    getW(wR, wC, `+m+`, d2);
              }

            } else if (`+(p===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2)
              );

              if (`+y+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(p===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2),
                getW(wR, wC, `+m+` + 2, d2)
              );

              if (`+y+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1),
                  getX(batch, xR, xC, `+m+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC),
                  getX(batch, `+m+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+I+`
        `+P+`
        setOutput(result);
      }
    `},_B=function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var e=n.padInfo.front,t=n.padInfo.top,r=n.padInfo.left,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,h=n.filterDepth,d=n.filterHeight,m=n.filterWidth,p=4*Math.floor(n.inChannels/4),y=n.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+o+", "+s+`);
      const ivec3 pads = ivec3(`+e+", "+t+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+h+`; wF++) {
          int xF = xFCorner + wF * `+a+`;

          if (xF < 0 || xF >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+m+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+p+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(y===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+p+`) *
                  getW(wF, wR, wC, `+p+`, d2);
              } else if (`+(y===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(y===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1),
                  getX(batch, xF, xR, xC, `+p+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2),
                  getW(wF, wR, wC, `+p+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},yS=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var i=n.inHeight,o=n.inWidth,s=n.padInfo.top,a=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,h=n.dilationHeight,d=n.dilationWidth,m=n.filterHeight,p=n.filterWidth,y=n.outChannels/n.inChannels,b="",x="";t&&(b=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,x="result = activation(result);");var E=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+b+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+y+`;
        int q = d2 - d1 * `+y+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+m+`; wR++) {
          int xR = xRCorner + wR * `+h+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+o+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+E+`
        `+x+`
        setOutput(result);
      }
    `},wS=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.outShape;for(var i=n.inHeight,o=n.inWidth,s=n.padInfo.top,a=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,h=n.dilationHeight,d=n.dilationWidth,m=n.filterHeight,p=n.filterWidth,y=p,b="int xR; int xC; int xCOffset;",x=0;x<m;x++)for(var E=0;E<p;E++)b+=`
          vec4 xTexelR`+x+"C"+2*E+` = vec4(0.);
          vec4 wR`+x+"C"+E+` = vec4(0.);
          vec4 xR`+x+"C"+E+" = vec4(0.);";for(x=0;x<m;x++)for(var T=0;T<y;T++){if(b+=`
          xR = xRCorner + `+x*h+`;
          xC = xCCorner + `+(E=2*T)*d+`;
        `,l===1){if(E<p&&(b+=a%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    xTexelR`+x+"C"+E+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+x+"C"+E+" = vec4(previous.zw, xTexelR"+x+"C"+E+`.xy);
                } else {
                  xR`+x+"C"+E+" = vec4(0, 0, xTexelR"+x+"C"+E+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                xR`+x+"C"+E+" = xTexelR"+x+"C"+E+`;
              `,E+1<p)){var P=a%2==0?RI(d):d;d%2==0&&a%2==1||d%2!=0&&a%2!=1?(b+=`
                  xCOffset = xC + `+a%2+" + "+P+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(b+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+o+`) {
                      xTexelR`+x+"C"+E+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+x+"C"+E+` = vec4(0.);
                    }
                  `),b+=`
                  xR`+x+"C"+(E+1)+` = vec4(
                    xTexelR`+x+"C"+E+".zw, xTexelR"+x+"C"+(E+2)+`.xy);
                `):b+=`
                  xCOffset = xC + `+P+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+x+"C"+(E+1)+" = xTexelR"+x+"C"+(E+2)+`;
                `}}else E<p&&(b+=`
              if(xR >= 0 && xR < `+i+`) {
            `,a%2==1?(b+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+o+`) {
                  xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+x+"C"+(E+2)+` = vec4(0.);
                }

                xR`+x+"C"+E+` = vec4(
                  xTexelR`+x+"C"+E+".zw, xTexelR"+x+"C"+(E+2)+`.zw);
              `,E+1<p&&(b+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+o+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+x+"C"+(E+1)+" = vec4(xTexelR"+x+"C"+(E+2)+`.xy, final.xy);
                `)):(b+=`
                if(xC >= 0 && xC < `+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+x+"C"+(E+2)+` = vec4(0.);
                }

                xR`+x+"C"+E+` = vec4(
                  xTexelR`+x+"C"+E+".xy, xTexelR"+x+"C"+(E+2)+`.xy);
              `,E+1<p&&(b+=`
                  xR`+x+"C"+(E+1)+` = vec4(
                    xTexelR`+x+"C"+E+".zw, xTexelR"+x+"C"+(E+2)+`.zw);
                `)),b+="}");E<p&&(b+=`
            vec4 wTexelR`+x+"C"+E+" = getW("+x+", "+E+`, d1, q);
            wR`+x+"C"+E+" = vec4(wTexelR"+x+"C"+E+".xz, wTexelR"+x+"C"+E+`.xz);
          `,E+1<p&&(b+=`
              vec4 wTexelR`+x+"C"+(E+1)+" = getW("+x+", "+(E+1)+`, d1, q);
              wR`+x+"C"+(E+1)+` =
                vec4(wTexelR`+x+"C"+(E+1)+".xz, wTexelR"+x+"C"+(E+1)+".xz);"))}for(x=0;x<m;x++)for(E=0;E<p;E++)b+="dotProd += xR"+x+"C"+E+" * wR"+x+"C"+E+";";var I="",D="";t&&(I=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`vec4 activation(vec4 x) {
          `+t+`
        }`,D="result = activation(result);");var U=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+I+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+b+`

        vec4 result = dotProd;
        `+U+`
        `+D+`
        setOutput(result);
      }
    `},EB=function(n,e,t,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=n[0],s=n[1],a=n[2],u=n[3],l=e[0],h=t[0],d=t[1];this.outputShape=[l,h,d,u];var m=r==="bilinear"?1:0,p=[s-1+".0",a-1+".0"],y=p[0],b=p[1],x=h>1?[""+(s-1)/(h-1),"(y2-y1) * height_ratio","y1*"+y+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+y],E=x[0],T=x[1],P=x[2],I=d>1?[""+(a-1)/(d-1),"(x2-x1) * width_ratio","x1*"+b+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+b],D=I[0],U=I[1],L=I[2];this.userCode=`
      const float height_ratio = float(`+E+`);
      const float width_ratio = float(`+D+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+o+`) {
          return;
        }

        float height_scale = `+T+`;
        float width_scale = `+U+`;

        float in_y = `+P+`;
        if( in_y < 0.0 || in_y > `+y+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+L+`;
        if( in_x < 0.0 || in_x > `+b+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+m+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},SB=function(n,e,t){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=n[n.length-1],o=t?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(t?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Cr(r)+` coords = getOutputCoords();
        int end = `+bS(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+o+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+bS(r,"coords")+` = idx;
          val += getX(`+(function(s,a){if(s===1)return""+a;if(s===2)return a+".x, "+a+".y";if(s===3)return a+".x, "+a+".y, "+a+".z";if(s===4)return a+".x, "+a+".y, "+a+".z, "+a+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")})(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function bS(n,e){if(n===1)return""+e;if(n===2)return e+".y";if(n===3)return e+".z";if(n===4)return e+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}var AB=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=_m.DENSE;var e=im(n),t=os();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ef(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+t.output+` = result;
      }
    `},CB=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=_m.DENSE;var e=im(n),t=os();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ef(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+t.output+` = result;
      }
    `},IB=(function(){function n(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+t+`;
      int offset_h = imod(h, `+t+`);
      int in_w = w / `+t+`;
      int offset_w = imod(w, `+t+`);
      int offset_d = (offset_h * `+t+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return n.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},n.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},n.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},n.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},n.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},n})(),TB=function(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},kB=function(n){this.variableNames=["A"],this.outTexUsage=da.DOWNLOAD;var e=os();this.outputShape=n,this.userCode=`
      `+cT+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `},NB=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=da.DOWNLOAD;var e=os();this.outputShape=n,this.userCode=`
      `+cT+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `},RB=function(n,e,t){t===void 0&&(t=!1),this.variableNames=["A"];var r=os(),i=e[0],o=e[1];this.outputShape=n;var s="result";t&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      `+Zb(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+o+`;
        int c = imod(flatIndex, `+o+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+s+`, 0., 0., 0.);
      }
    `},PB=function(n,e,t){t===void 0&&(t=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=os(),i=e[0],o=e[1];this.outputShape=n;var s="",a="result";t&&(a="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var h=2*u+l;s+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+n[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+n[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+o+`;
              c = imod(flatIndex, `+o+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+h+`] = values[0];
              } else if(offset == 1) {
                result[`+h+`] = values[1];
              } else if(offset == 2) {
                result[`+h+`] = values[2];
              } else {
                result[`+h+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Zb(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+s+`

        `+r.output+" = "+a+`;
      }
    `},DB="return real * expR - imag * expI;",LB="return real * expI + imag * expR;",xS=function(n,e,t){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=t?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=t?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+n+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+o+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},MB=(function(){function n(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;return function(r,i){t.valueLoc==null&&(t.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(t.valueLoc,e)}},n})(),OB=function(n,e,t){this.variableNames=["A","indices"];var r=n.slice();r[t]=e,this.outputShape=r,this.rank=r.length;var i=Cr(this.rank),o=(function(s,a){var u=s.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],h=[],d=0;d<s.length;d++)d===a?h.push("int(getIndices("+l[d]+"))"):h.push(""+l[d]);return h.join()})(n,t);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},FB=function(n,e,t){this.sliceDim=n,this.strides=e,this.variableNames=["x","indices"],this.outputShape=t;var r=Cr(e.length),i=Cr(t.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+o+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function BB(n,e){var t=os();return DF(n,e,t.version+`
    precision highp float;
    `+t.attribute+` vec3 clipSpacePos;
    `+t.attribute+` vec2 uv;
    `+t.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function VB(n,e){return BF(n,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function jB(n,e){return VF(n,e,new Uint16Array([0,1,2,2,1,3]))}function Hm(n,e,t,r,i,o,s){UF(t,r);var a=jF(n,e),u=n.TEXTURE_2D;return Vt(n,e,(function(){return n.bindTexture(u,a)})),Vt(n,e,(function(){return n.texParameteri(u,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)})),Vt(n,e,(function(){return n.texParameteri(u,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)})),Vt(n,e,(function(){return n.texParameteri(u,n.TEXTURE_MIN_FILTER,n.NEAREST)})),Vt(n,e,(function(){return n.texParameteri(u,n.TEXTURE_MAG_FILTER,n.NEAREST)})),Vt(n,e,(function(){return n.texImage2D(u,0,i,t,r,0,o,s,null)})),Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,null)})),a}function UB(n,e,t,r,i){var o=q0(t,r);return Hm(n,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,n.FLOAT)}function zB(n,e,t,r,i){var o=q0(t,r);return Hm(n,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function WB(n,e,t,r,i){var o=q0(t,r);return Hm(n,e,o[0],o[1],n.RGBA,n.RGBA,n.UNSIGNED_BYTE)}function qB(n,e,t,r,i){var o=qm(t,r);return Hm(n,e,o[0],o[1],i.internalFormatPackedFloat,n.RGBA,n.FLOAT)}function HB(n,e,t,r,i){var o=qm(t,r);return Hm(n,e,o[0],o[1],i.internalFormatPackedHalfFloat,n.RGBA,i.textureTypeHalfFloat)}function GB(n,e,t,r){return Vt(n,e,(function(){return n.bindBuffer(n.ARRAY_BUFFER,r)})),uS(n,e,t,"clipSpacePos",r,3,20,0)&&uS(n,e,t,"uv",r,2,20,12)}function $B(n,e,t,r,i,o,s){var a,u,l;Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,t)})),o instanceof Uint8Array?(a=new Uint8Array(r*i*4),u=n.UNSIGNED_BYTE,l=n.RGBA):(a=new Float32Array(r*i*4),u=n.FLOAT,l=s.internalFormatPackedFloat),a.set(o),Vt(n,e,(function(){return n.texImage2D(n.TEXTURE_2D,0,l,r,i,0,n.RGBA,u,a)})),Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,null)}))}function KB(n,e,t,r){Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,t)})),r.data instanceof Uint8Array?Vt(n,e,(function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r.width,r.height,0,n.RGBA,n.UNSIGNED_BYTE,r.data)})):Vt(n,e,(function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)})),Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,null)}))}function XB(n,e,t,r,i){var o=n.createBuffer();Vt(n,e,(function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,o)}));var s=16*t*r;return Vt(n,e,(function(){return n.bufferData(n.PIXEL_PACK_BUFFER,s,n.STREAM_READ)})),Vt(n,e,(function(){return n.readPixels(0,0,r,t,n.RGBA,n.FLOAT,0)})),Vt(n,e,(function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,null)})),o}function YB(n,e,t){var r=n,i=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function QB(n,e,t,r,i){var o=q0(t,r),s=o[0],a=o[1],u=new Uint8Array(t*r*4);return Vt(n,e,(function(){return n.readPixels(0,0,s,a,i.downloadTextureFormat,n.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function JB(n,e,t,r,i,o,s,a){var u=n,l=new Float32Array((function(h,d){var m=qm(h,d);return m[0]*m[1]*4})(o,s));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function ZB(n,e,t,r){var i=new Float32Array(t*r*4);return Vt(n,e,(function(){return n.readPixels(0,0,r,t,n.RGBA,n.FLOAT,i)})),i}var e7=(function(){function n(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=Ye().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,TF(t,e)):this.gl=vl(t);var r="WEBGL_color_buffer_float";if(Ye().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Xg(this.gl,this.debug,"OES_texture_float"),Ha(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Xg(this.gl,this.debug,"OES_texture_half_float");else if(Ye().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Ha(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Xg(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Ye().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Ha(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Ha(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=VB(this.gl,this.debug),this.indexBuffer=jB(this.gl,this.debug),this.framebuffer=zF(this.gl,this.debug),this.textureConfig=Wb(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(n.prototype,"debug",{get:function(){return Ye().getBool("DEBUG")},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Vt(t,this.debug,(function(){return t.finish()})),Vt(t,this.debug,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Vt(t,this.debug,(function(){return t.deleteFramebuffer(e.framebuffer)})),Vt(t,this.debug,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),Vt(t,this.debug,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),Vt(t,this.debug,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},n.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),UB(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),zB(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),WB(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),KB(this.gl,this.debug,e,t)},n.prototype.uploadDenseMatrixToTexture=function(e,t,r,i){this.throwIfDisposed(),$B(this.gl,this.debug,e,t,r,i,this.textureConfig)},n.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),HB(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),qB(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(lS(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Vt(this.gl,this.debug,(function(){return t.gl.deleteTexture(e)}))},n.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,r){var i=this;return this.downloadMatrixDriver(e,(function(){return QB(i.gl,i.debug,t,r,i.textureConfig)}))},n.prototype.downloadPackedMatrixFromBuffer=function(e,t,r,i,o,s){return JB(this.gl,e,0,0,0,o,s,this.textureConfig)},n.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return YB(this.gl,e,t)},n.prototype.createBufferFromTexture=function(e,t,r){this.bindTextureToFrameBuffer(e);var i=XB(this.gl,this.debug,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},n.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},n.prototype.createFence=function(e){var t,r,i=this;if(Ye().getBool("WEBGL_FENCE_API_ENABLED")){var o=e,s=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=function(){var a=o.clientWaitSync(s,0,0);return a===o.ALREADY_SIGNALED||a===o.CONDITION_SATISFIED},t=s}else Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(t,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:t,isFencePassed:r}},n.prototype.downloadMatrixFromPackedTexture=function(e,t,r){var i=this;return this.downloadMatrixDriver(e,(function(){return ZB(i.gl,i.debug,t,r)}))},n.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,r=LF(t,this.debug,e),i=BB(t,this.debug),o=OF(t,this.debug);return Vt(t,this.debug,(function(){return t.attachShader(o,i)})),Vt(t,this.debug,(function(){return t.attachShader(o,r)})),FF(t,this.debug,o),this.debug&&My(t,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=GB(t,this.debug,this.program,this.vertexBuffer)),o},n.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&Vt(this.gl,this.debug,(function(){return t.gl.deleteProgram(e)}))},n.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&My(this.gl,this.debug,this.program),Vt(this.gl,this.debug,(function(){return t.gl.useProgram(e)}))},n.prototype.getUniformLocation=function(e,t,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?qF(this.gl,this.debug,e,t):HF(this.gl,e,t)},n.prototype.getAttributeLocation=function(e,t){var r=this;return this.throwIfDisposed(),Vt(this.gl,this.debug,(function(){return r.gl.getAttribLocation(e,t)}))},n.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},n.prototype.setInputMatrixTexture=function(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),GF(this.gl,this.debug,this.program,e,t,r)},n.prototype.setOutputMatrixTexture=function(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)},n.prototype.setOutputPackedMatrixTexture=function(e,t,r){this.throwIfDisposed();var i=qm(t,r),o=i[0],s=i[1];this.setOutputMatrixTextureDriver(e,o,s)},n.prototype.setOutputMatrixWriteRegion=function(e,t,r,i){this.setOutputMatrixWriteRegionDriver(r,e,i,t)},n.prototype.setOutputPackedMatrixWriteRegion=function(e,t,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},n.prototype.debugValidate=function(){this.program!=null&&My(this.gl,this.debug,this.program),Yg(this.gl)},n.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),Vt(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},n.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),Vt(this.gl,this.debug,(function(){return e.gl.finish()}))},n.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Xg(this.gl,this.debug,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},n.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},n.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},n.prototype.beginQuery=function(){if(Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),r=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),o=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,o),o},n.prototype.endQuery=function(){if(Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT)}},n.prototype.waitForQueryAndGetTime=function(e){return Nt(this,void 0,void 0,(function(){var t=this;return Rt(this,(function(r){switch(r.label){case 0:return[4,nS((function(){return t.disposed||t.isQueryAvailable(e,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return r.sent(),[2,this.getQueryTime(e,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},n.prototype.getQueryTime=function(e,t){if(t===0)return null;if(t===2){var r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(e,i.QUERY_RESULT_EXT)/1e6},n.prototype.isQueryAvailable=function(e,t){if(t===0)return!0;if(t===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint},n.prototype.pollFence=function(e){var t=this;return new Promise((function(r){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return r()}))}))},n.prototype.pollItems=function(){for(var e=(function(r){for(var i=0;i<r.length&&r[i]();++i);return i-1})(this.itemsToPoll.map((function(r){return r.isDoneFn}))),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},n.prototype.addItemToPoll=function(e,t){var r=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||nS((function(){return r.pollItems(),r.itemsToPoll.length===0}))},n.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),Oy(this.gl,this.debug,e,this.framebuffer),this.debug&&Yg(this.gl)},n.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Oy(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Yg(this.gl)):lS(this.gl,this.debug,this.framebuffer)},n.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var r=t();return this.unbindTextureToFrameBuffer(),r},n.prototype.setOutputMatrixTextureDriver=function(e,t,r){this.throwIfDisposed();var i=this.gl;Oy(i,this.debug,e,this.framebuffer),this.debug&&Yg(i),this.outputTexture=e,Vt(i,this.debug,(function(){return i.viewport(0,0,t,r)})),Vt(i,this.debug,(function(){return i.scissor(0,0,t,r)}))},n.prototype.setOutputMatrixWriteRegionDriver=function(e,t,r,i){var o=this;this.throwIfDisposed(),Vt(this.gl,this.debug,(function(){return o.gl.scissor(e,t,r,i)}))},n.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},n.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},n})();function _S(n,e){if(n.length!==e.length)throw Error("Binary was compiled with "+n.length+" inputs, but was executed with "+e.length+" inputs");n.forEach((function(t,r){var i=t.logicalShape,o=e[r],s=o.shape;if(!po(i,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+s+" must match");if(!t.isUniform||!o.isUniform){var a=t.texShape,u=o.isUniform?null:o.texData.texShape;if(!po(a,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+u+" must match")}}))}var t7=function(n,e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var r=t.filterWidth,i=t.inChannels,o=t.strideWidth,s=t.strideHeight,a=t.padInfo,u=t.outWidth,l=t.dilationWidth,h=t.dilationHeight,d=t.dataFormat,m=a.left,p=a.top,y=i*r,b=os(),x=d==="channelsLast",E=x?0:1,T=x?1:2,P="",I=0;I<=1;I++)for(var D=0;D<=1;D++)P+=`
          blockIndex = rc.y + `+D+`;
          pos = rc.x + `+I+`;

          if(blockIndex < `+n[1]+" && pos < "+n[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+s+" - "+p+`;
            d0 = offsetY + `+h+" * (pos / "+y+`);

            if(d0 < `+e[E]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+o+". - "+m+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+y+".) / "+i+`.));

              if(d1 < `+e[T]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+x+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*I+D)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*I+D)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+P+`

        `+b.output+` = result;
      }
    `},n7=function(n,e,t,r,i){this.variableNames=["x"],this.outputShape=[];var o,s=e,a=n[3]-1;this.outputShape=n;var u="float("+t+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+s+"; j <= "+s+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+a+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+o+`;
        setOutput(val);
      }
    `},r7=function(n,e,t,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=e,this.bias=t,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+t+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},i7=function(n,e,t,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=e,a=n[3]-1;this.outputShape=n;var u="float("+t+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+s+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+s+"; j <= "+s+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+a+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+o+`;
        setOutput(result);
      }
    `},o7=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var e=n.strideHeight,t=n.strideWidth,r=n.dilationHeight,i=n.effectiveFilterHeight,o=n.effectiveFilterWidth,s=i-1-n.padInfo.top,a=o-1-n.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+o+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+t+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+o+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},s7=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var e=n.strideDepth,t=n.strideHeight,r=n.strideWidth,i=n.dilationDepth,o=n.dilationHeight,s=n.dilationWidth,a=n.effectiveFilterDepth,u=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=a-1-n.padInfo.front,d=u-1-n.padInfo.top,m=l-1-n.padInfo.left,p=a*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+d+", "+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+a+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+o+`) {
            float dyR = float(dyRCorner + wR) / `+t+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+p+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Uy=function(n,e,t,r,i,o,s){t===void 0&&(t=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),o===void 0&&(o=null),s===void 0&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var a=t?n[1]:n[2],u=Math.ceil(a/2),l=t?"i * 2, rc.y":"rc.y, i * 2",h=r?"rc.z, i * 2":"i * 2, rc.z",d=t?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",y="";o&&(p=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+o+`
        }`:`vec4 activation(vec4 x) {
          `+o+`
        }`,y="result = activation(result);");var b=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+p+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+h+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+m[0]+`);
          result += (`+d[1]+" * "+m[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+b+`

        `+y+`

        setOutput(result);
      }
    `},a7=(function(){function n(e,t,r){this.variableNames=["probs"],this.outputShape=[e,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(t-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(t-1)+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;return function(r,i){t.seedLoc==null&&(t.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(t.seedLoc,e)}},n})(),u7=function(n,e,t,r){this.variableNames=["indices"],this.outputShape=[n,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+t+`),
                      float(index == coords.y)));
      }
    `},l7=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n;var e=n.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var t=Ws("rc",e),r=Cr(e),i=(function(a,u,l){if(a===1)return"rc > "+u[0];for(var h="",d=a-2;d<a;d++)h+=l[d]+" >= "+u[d],d<a-1&&(h+="||");return h})(e,n,t),o=(function(a,u,l,h){if(a===1)return"";var d=h.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `})(e,n[n.length-1],n[n.length-2],t),s=(function(a,u){var l=a.length,h=(function(d,m){for(var p=[],y=0;y<=1;y++)for(var b=0;b<=1;b++){for(var x=(y===0?"r":"rp1")+", "+(b===0?"c":"cp1"),E=2;E<d;E++)x=m[m.length-1-E]+","+x;p.push(x)}return p})(l,u);return l===1?`getA(rc),
            rc + 1 >= `+a[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+h[0]+`),
          cEdge ? 0. : getA(`+h[1]+`),
          rEdge ? 0. : getA(`+h[2]+`),
          rEdge || cEdge ? 0. : getA(`+h[3]+")"})(n,t);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+o+`

            setOutput(vec4(`+s+`));
          }
        }
      `}},c7=function(n,e,t){this.variableNames=["x"],this.outputShape=e.map((function(u,l){return u[0]+n[l]+u[1]}));var r=n.length,i=Cr(r),o=e.map((function(u){return u[0]})).join(","),s=e.map((function(u,l){return u[0]+n[l]})).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+o+`);
      `+i+" end = "+i+"("+s+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+t+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+a+`));
        }
      }
    `:`
        int start = `+o+`;
        int end = `+s+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+t+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},h7=function(n,e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(x,E){return x[0]+n[E]+x[1]}));for(var r=n.length,i=Cr(r),o=e.map((function(x){return x[0]})).join(","),s=e.map((function(x,E){return x[0]+n[E]})).join(","),a=Ws("rc",r),u=Ws("source",r),l=a[r-1]+" < "+this.outputShape[r-1],h=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[i+" rc = outputLoc;",a[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+a[r-2]+` += 1;
       if(`+a[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+a[r-1]+` += 1;
         if(`+l+") {"],m=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",y=0,b=r===1?2:4;y<b;y++)p+=`
        `+d[y]+`
        if (`+m+`) {
          result[`+y+"] = float("+t+`);
        } else {
          `+i+` source = rc - start;
          result[`+y+"] = getChannel(getX("+u.join()+"), "+h+`);
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+o+`);
      const `+i+" end = "+i+"("+s+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+p+`
        setOutput(result);
      }
    `},zy=function(n,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,i=n.strideHeight,o=n.strideWidth,s=n.dilationHeight,a=n.dilationWidth,u=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=n.padInfo.top,d=n.padInfo.left;this.outputShape=n.outShape;var m=e==="avg",p="0.0";if(m||(p="-1.0 / 1e-20"),t)this.userCode=`
        const ivec2 strides = ivec2(`+i+", "+o+`);
        const ivec2 pads = ivec2(`+h+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+s+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(y="avgValue / count");var b=4*Math.floor(r/4),x=r%4,E=`
      if (`+m+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+i+", "+o+`);
      const ivec2 pads = ivec2(`+h+", "+d+`);
      const float initializationValue = `+p+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+p+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+s+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+a+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              getValue(batch, xR, xC + 2 * `+a+`, d),
              getValue(batch, xR, xC + 3 * `+a+`, d)
            );

            `+E+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(x===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+E+`
          } else if (`+(x===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              initializationValue,
              initializationValue
            );

            `+E+`
          } else if (`+(x===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              getValue(batch, xR, xC + 2 * `+a+`, d),
              initializationValue
            );

            `+E+`
          }
        }
        setOutput(`+y+`);
      }
    `}},Wy=function(n,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,h=n.effectiveFilterDepth,d=n.effectiveFilterHeight,m=n.effectiveFilterWidth,p=n.padInfo.front,y=n.padInfo.top,b=n.padInfo.left;this.outputShape=n.outShape;var x=e==="avg",E="0.0";if(x||(E="-1.0 / 1e-20"),t)this.userCode=`
        const ivec3 strides =
            ivec3(`+i+", "+o+", "+s+`);
        const ivec3 pads = ivec3(`+p+", "+y+", "+b+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+h+`;
              wD += `+a+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+n.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+m+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+m+` +
                      wR * `+m+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var T=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(T="avgValue / count");var P=4*Math.floor(r/4),I=r%4,D=`
      if (`+x+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+i+", "+o+", "+s+`);
      const ivec3 pads = ivec3(`+p+", "+y+", "+b+`);
      const float initializationValue = `+E+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+E+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+h+`;
            wD += `+a+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+P+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+D+`
            }

            int xC = xCCorner + `+P+`;
            if (`+(I===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+D+`
            } else if (`+(I===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+D+`
            } else if (`+(I===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+D+`
            }
          }
          setOutput(`+T+`);
        }
      }
    `}},f7=function(n,e){this.variableNames=["x"];var t=n.windowSize,r=n.batchSize,i=n.inSize,o=Math.ceil(i/t);this.outputShape=[r,o];var s="0.0",a="";e==="prod"?s="1.0":e==="min"?(s="1.0 / 1e-20",a="min"):e==="max"&&(s="-1.0 / 1e-20",a="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?u="sumValue":e==="prod"?u="prodValue":e==="all"?u="allValue":e==="any"&&(u="anyValue");var l=4*Math.floor(t/4),h=t%4,d=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+a+`(values, minMaxValue);
      }
    `,m="vec4";e==="all"?(s="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):e==="any"&&(s="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");var p="";i%t>0&&(p=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+s+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+p+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+t+`;

        vec4 minMaxValue = vec4(`+s+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(h===1)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(h===2)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(h===3)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},d7=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var t="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),t+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+ef(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+Zb(n)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+n[1]+`;
        int cols = `+n[2]+`;

        `+t+`

        setOutput(result);
      }
    `},p7=function(n,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=n.shape,a=s[1],u=s[2],l=[t&&a>1?i-1:i,t&&u>1?o-1:o],h=[t&&a>1?a-1:a,t&&u>1?u-1:u],d=l[0]/h[0],m=l[1]/h[1],p=1/d,y=1/m,b=2*Math.ceil(p)+2,x=2*Math.ceil(y)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+y+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+x+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+a+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(o-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},m7=function(n,e,t,r){this.variableNames=["A"],this.outputShape=[];var i=n[0],o=n[1],s=n[2],a=n[3];this.outputShape=[i,e,t,a];var u=[r&&e>1?o-1:o,r&&t>1?s-1:s],l=[r&&e>1?e-1:e,r&&t>1?t-1:t];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},g7=function(n,e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=n[0],o=n[1],s=n[2],a=n[3];this.outputShape=[i,e,t,a];var u=[r&&e>1?o-1:o,r&&t>1?s-1:s],l=[r&&e>1?e-1:e,r&&t>1?t-1:t];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+o+".0, "+s+`.0,
                                     `+s+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(a-1)+`;
        bool hasNextRow = coords.z < `+(t-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},v7=function(n,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=n.shape,a=s[1],u=s[2],l=[t&&a>1?i-1:i,t&&u>1?o-1:o],h=[t&&a>1?a-1:a,t&&u>1?u-1:u],d=l[0]/h[0],m=l[1]/h[1],p=1/d,y=1/m,b=2*Math.ceil(p)+2,x=2*Math.ceil(y)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+y+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+x+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+a+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+h[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+h[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+t+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+o+`) - 1),
                `+t+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},y7=function(n,e,t,r){this.variableNames=["A"],this.outputShape=[];var i=n[0],o=n[1],s=n[2],a=n[3];this.outputShape=[i,e,t,a];var u=[r&&e>1?o-1:o,r&&t>1?s-1:s],l=[r&&e>1?e-1:e,r&&t>1?t-1:t],h=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+h+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},w7=function(n,e){this.variableNames=["x"];var t=n.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");if(this.outputShape=n,t!==1){var r=n.map((function(o,s){return(function(a){return e.indexOf(a)!==-1&&n[a]!==1?n[a]+" - coords["+a+"] - 1":"coords["+a+"]"})(s)})).join(","),i=Cr(t);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+n[0]+` - coord - 1));
        }
      `},b7=function(n,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var t=n.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");this.outputShape=n;var r=Ws("rc",t),i=r[t-1]+" + 1 < "+this.outputShape[t-1],o=r[t-2]+" + 1 < "+this.outputShape[t-2],s=Cr(t);function a(u){var l=n.map((function(h,d){return(function(m,p){return e.indexOf(m)!==-1&&n[m]!==1?n[m]+" - "+p[m]+" - 1":""+p[m]})(d,u)}));return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=t===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+n[0]+` - rc - 1),
            `+n[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+n[0]+` - (rc  + 1) - 1),
                `+n[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+s+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+(function(u){return a(u)})(r.slice())+`;
          if(`+i+`){
            result.g = `+(function(u){return u[t-1]="("+u[t-1]+" + 1)",a(u)})(r.slice())+`;
          }
          if(`+o+`) {
            result.b = `+(function(u){return u[t-2]="("+u[t-2]+" + 1)",a(u)})(r.slice())+`;
            if(`+i+`) {
              result.a = `+(function(u){return u[t-1]="("+u[t-1]+" + 1)",u[t-2]="("+u[t-2]+" + 1)",a(u)})(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},ES=function(n,e,t,r,i,o,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var a=Cr(i.length),u=Cr(o.length),l="";t===1?l="i":t===2&&(l="i, j");var h="getIndices("+l+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var m="getUpdates("+d+")",p=e>1?"strides[j]":"strides";this.userCode=`
        `+a+" strides = "+a+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+n+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+h+`);
              flattenedIndex += index * `+p+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+m+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},x7=function(n,e){this.variableNames=["x","segmentIds"];var t=n.windowSize,r=n.batchSize,i=n.inSize,o=n.numSegments,s=o*Math.ceil(i/t);this.outputShape=[r,s];var a=4*Math.floor(t/4),u=t%4,l=`
        sumValue += dot(values, segFilter);
    `,h="";i%t>0&&(h=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var d="";i%t>0&&(d=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+o+")) * float("+t+`));
        int currentSeg = int(mod(float(outIdx), float(`+o+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+a+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+a+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},_7=function(n,e,t){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,t>4)throw Error("Where for rank "+t+" is not yet supported");if(t===1)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],a=[],u=0;u<e.length;u++)a.push(""+o[u]),u<n&&s.push(""+o[u]);r=s.join(),i=a.join()}var l=Cr(t);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `},E7=(function(){function n(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,r=Cr(this.rank),i="uniform int start["+this.rank+"];",o=(function(s){if(s===1)return"sourceLoc";if(s<=6)return qy.slice(0,s).map((function(a){return"sourceLoc."+a})).join(",");throw Error("Slicing for rank "+s+" is not yet supported")})(this.rank);t=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+e.map((function(s,a){return"sourceLoc."+qy[a]+" = start["+a+"] + coords."+qy[a]+";"})).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+t+`
        setOutput(getSource(`+o+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,i){t.startLoc==null&&(t.startLoc=r.getUniformLocationNoThrow(i,"start"),t.startLoc==null)||r.gl.uniform1iv(t.startLoc,e)}},n})(),qy=["x","y","z","w","u","v"],S7=(function(){function n(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=Cr(this.rank),r=Ws("coords",this.rank),i=Ws("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",s="getChannel(getSource("+i.join()+"), "+o+")",a=`
      result.x = `+s+`;
      if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+s+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+s+`;
        if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+s+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+t+"("+e.map((function(h,d){return"start["+d+"]"})).join()+");":e.map((function(h,d){return i[d]+" = "+r[d]+" + start["+d+"];"})).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+t+` coords = getOutputCoords();
        `+t+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+a+`
        `+u+`
        setOutput(result);
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,i){t.startLoc==null&&(t.startLoc=r.getUniformLocationNoThrow(i,"start"),t.startLoc==null)||r.gl.uniform1iv(t.startLoc,e)}},n})(),A7=function(n,e,t){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=Cr(t.length),o=Cr(t.length),s="";if(r===1)s="coords * strides + begin";else{var a=0;s=t.map((function(u,l){return a++,t.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(a-1)+"] * strides["+l+"] + begin["+l+"]"})).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+n+`);
      `+i+" strides = "+i+"("+e+`);

      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+s+`));
      }
    `},C7=(function(){function n(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return n.prototype.acquireTexture=function(e,t,r){var i,o=SS(t,r),s=AS(e,o,r);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[s].shift();return this.usedTextures[s].push(a),a}return this.numUsedTextures++,this.log(),o===fa.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===fa.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===fa.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===fa.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===fa.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[s].push(i),i},n.prototype.releaseTexture=function(e,t,r,i){if(this.freeTextures!=null){var o=AS(t,SS(r,i),i);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(e),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[o],a=s.indexOf(e);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(a,1),this.log()}},n.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},n.prototype.getNumUsedTextures=function(){return this.numUsedTextures},n.prototype.getNumFreeTextures=function(){return this.numFreeTextures},n.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(r){e.gpgpu.deleteMatrixTexture(r)}));for(var t in this.usedTextures)this.usedTextures[t].forEach((function(i){e.gpgpu.deleteMatrixTexture(i)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},n})();function SS(n,e){if(n===da.UPLOAD)return fa.PACKED_2X2_FLOAT32;if(n===da.RENDER||n==null)return(function(t){return Ye().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?fa.PACKED_2X2_FLOAT32:fa.UNPACKED_FLOAT32:t?fa.PACKED_2X2_FLOAT16:fa.UNPACKED_FLOAT16})(e);if(n===da.DOWNLOAD||n===da.PIXELS)return fa.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+n)}function AS(n,e,t){return n[0]+"_"+n[1]+"_"+e+"_"+t}var I7=function(n,e){this.variableNames=["A"];for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[r]*e[r];this.outputShape=t,this.rank=t.length;var i=Cr(this.rank),o=(function(s){var a=s.length;if(a>5)throw Error("Tile for rank "+a+" is not yet supported");if(a===1)return"imod(resRC, "+s[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],h=0;h<s.length;h++)l.push("imod("+u[h]+", "+s[h]+")");return l.join()})(n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},T7=function(n,e){this.variableNames=["A"];for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[e[r]];this.outputShape=t,this.rank=t.length;var i=Cr(this.rank),o=(function(s){var a=s.length;if(a>6)throw Error("Transpose for rank "+a+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(a),h=0;h<s.length;h++)l[s[h]]=u[h];return l.join()})(e);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+o+`));
    }
    `},k7=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[e[r]];if(this.outputShape=t,this.rank=t.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Cr(this.rank),o=lT("rc",this.rank),s=new Array(this.rank);for(r=0;r<e.length;r++)s[e[r]]=o[r];var a="vec2("+s.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+t[this.rank-1],l="getChannel(getA("+s.join()+"), "+a+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+o[this.rank-1]+`;
      if(++`+o[this.rank-2]+" < "+t[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},ex=1.7580993408473768,tx=1.0507009873554805,Sn=function(n,e){this.variableNames=["A"],this.outputShape=n,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Au="if (isnan(x)) return x;",N7="return x;",CS="return abs(x);",pT=Au+`
  return (x < 0.0) ? 0.0 : x;
`,mT=Au+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,gT="return (x >= 0.0) ? x : (exp(x) - 1.0);",R7=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+ex+`;
  float scale = `+tx+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,IS="return -x;",TS="return ceil(x);",kS="return floor(x);",NS="return exp(x);",RS="return exp(x) - 1.0;",P7=Au+`
  return sin(x);
`,D7=Au+`
  return cos(x);
`,L7=Au+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,M7=Au+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,O7=Au+`
  return atan(x);
`,F7=Au+"return log(x + sqrt(x * x + 1.0));",B7=Au+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,V7=Au+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,ev="return x;",j7="return x;",vT=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,yT=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wT=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,zp=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},U7=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n;var e=n.length,t=Ws("rc",e),r=Cr(e),i=(function(a,u){if(a===1)return"rc";for(var l="",h=0;h<a;h++)l+=u[h],h<a-1&&(l+=",");return l})(e,t),o=t.slice(-2),s=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+s+`));
      }
    `},tv={};function nv(n,e){if(e===void 0&&(e=!1),n==="linear")return e?j7:N7;if(n==="relu")return e?vT:pT;if(n==="elu")return e?wT:gT;if(n==="relu6")return e?yT:mT;if(n==="prelu")return e?dT:fT;throw new Error("Activation "+n+" has not been implemented for the WebGL backend.")}var z7=600,W7=(function(n){function e(t){var r,i=n.call(this)||this;if(i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!Ye().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(t==null){var o=vl(Ye().getNumber("WEBGL_VERSION"));i.binaryCache=((r=Ye().getNumber("WEBGL_VERSION"))in tv||(tv[r]={}),tv[r]),i.gpgpu=new e7(o),i.canvas=o.canvas,i.gpgpuCreatedLocally=!0}else i.gpgpu=t,i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=t.gl.canvas;return i.textureManager=new C7(i.gpgpu),i.numMBBeforeWarning=Ye().global.screen==null?1024:Ye().global.screen.height*Ye().global.screen.width*window.devicePixelRatio*z7/1024/1024,i.texData=new eT(i,Ie),i}return Su(e,n),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(t,r,i){if(Ye().getBool("DEBUG")&&this.checkNumericalProblems(t),i==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var o={};return this.texData.set(o,{shape:r,dtype:i,values:t,usage:da.UPLOAD}),o},e.prototype.move=function(t,r,i,o){if(Ye().getBool("DEBUG")&&this.checkNumericalProblems(r),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:i,dtype:o,values:r,usage:da.UPLOAD})},e.prototype.readSync=function(t){var r=this.texData.get(t),i=r.values,o=r.dtype,s=r.complexTensors,a=r.slice,u=r.shape,l=r.isPacked;if(a!=null){var h=void 0;h=l?new zp(u,ev):new Sn(u,ev);var d=this.runWebGLProgram(h,[{dataId:t,shape:u,dtype:o}],o),m=this.readSync(d.dataId);return this.disposeData(d.dataId),m}if(i!=null)return this.convertAndCacheOnCPU(t);if(o==="string")return i;var p,y,b=this.activeTimers!=null;return b&&(p=Zu()),o==="complex64"?y=dw(s.real.dataSync(),s.imag.dataSync()):y=this.getValuesFromTexture(t),b&&(this.downloadWaitMs+=Zu()-p),this.convertAndCacheOnCPU(t,y)},e.prototype.read=function(t){return Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,I,D,U,L,C;return Rt(this,(function(A){switch(A.label){case 0:if(this.pendingRead.has(t))return r=this.pendingRead.get(t),[2,new Promise((function(M){return r.push(M)}))];if(i=this.texData.get(t),o=i.values,s=i.shape,a=i.slice,u=i.dtype,l=i.complexTensors,h=i.isPacked,a!=null)return d=void 0,d=h?new zp(s,ev):new Sn(s,ev),m=this.runWebGLProgram(d,[{dataId:t,shape:s,dtype:u}],u),p=this.read(m.dataId),this.disposeData(m.dataId),[2,p];if(o!=null)return[2,this.convertAndCacheOnCPU(t)];if(!Ye().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Ye().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return y=null,u!=="complex64"&&Ye().get("WEBGL_BUFFER_SUPPORTED")&&(b=this.decode(t),x=this.texData.get(b.dataId),y=(C=this.gpgpu).createBufferFromTexture.apply(C,[x.texture].concat(im(s)))),this.pendingRead.set(t,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:A.sent(),A.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return T=A.sent(),P=T[0],I=T[1],E=dw(P,I),[3,5];case 4:y==null?E=this.getValuesFromTexture(t):(D=Mt(s),E=this.gpgpu.downloadFloat32MatrixFromBuffer(y,D)),A.label=5;case 5:return b!=null&&this.disposeData(b.dataId),U=this.convertAndCacheOnCPU(t,E),L=this.pendingRead.get(t),this.pendingRead.delete(t),L.forEach((function(M){return M(U)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,U]}}))}))},e.prototype.checkNumericalProblems=function(t){if(t!=null)for(var r=0;r<t.length;r++){var i=t[r];if(!RF(i))throw Ye().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(t){var r,i=this.texData.get(t),o=i.shape,s=i.dtype,a=i.isPacked,u=Mt(o);if(Ye().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(t),h=this.texData.get(l.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[h.texture].concat(im(o))).subarray(0,u);return this.disposeData(l.dataId),d}var m=Ye().getBool("WEBGL_PACK")&&a===!0,p=m?Fy(o):o,y=m?new NB(p):new kB(p),b=this.runWebGLProgram(y,[{shape:p,dtype:s,dataId:t}],"float32"),x=this.texData.get(b.dataId),E=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(x.texture,x.texShape[0],x.texShape[1]).subarray(0,u);return this.disposeData(b.dataId),E},e.prototype.time=function(t){return Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l;return Rt(this,(function(h){switch(h.label){case 0:return r=this.activeTimers,i=[],o=!1,this.programTimersStack==null?(this.programTimersStack=i,o=!0):this.activeTimers.push(i),this.activeTimers=i,t(),s=zd(this.activeTimers.map((function(d){return d.query}))).filter((function(d){return d!=null})),a=zd(this.activeTimers.map((function(d){return d.name}))).filter((function(d){return d!=null})),this.activeTimers=r,o&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(s)]:[3,2];case 1:return l=h.sent(),u.kernelMs=hF(l),u.getExtraProfileInfo=function(){return l.map((function(d,m){return{name:a[m],ms:d}})).map((function(d){return d.name+": "+d.ms})).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},h.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Zu(),endMs:null}},e.prototype.endTimer=function(t){return Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=Zu(),t)},e.prototype.getQueryTime=function(t){return Nt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){return Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(r=t).endMs-r.startMs]}))}))},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var r=this.texData.get(t).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var r=this.texData.get(t),i=r.texture,o=r.dtype,s=r.texShape,a=r.usage,u=r.isPacked,l=r.slice,h=l&&l.origDataId||t,d=this.dataRefCount.get(h);d>1?this.dataRefCount.set(h,d-1):(this.dataRefCount.delete(h),i!=null&&(this.numBytesInGPU-=this.computeBytes(s,o),this.textureManager.releaseTexture(i,s,a,u)));var m=this.texData.get(t);m.texture=null,m.texShape=null,m.isPacked=!1,m.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return Ye().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=Ie.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&t.every((function(o){return i.texData.get(o.dataId).texture==null&&o.size<r}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,r){var i=this.makeOutput(t.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:Ie.keep(t.clone()),imag:Ie.keep(r.clone())},i},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,r,i){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,r,i);if(Mt(i)===0)return Po([],i,t.dtype);var o=this.texData.get(t.dataId).isPacked,s=JI(t.shape,r,i);if(o||!s){var a=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new S7(i):new E7(i),u=a.getCustomSetupFunc(r);return this.compileAndRun(a,[t],null,u)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,r,i)},e.prototype.shallowSlice=function(t,r,i){var o=this.texData.get(t.dataId),s=this.makeOutput(i,t.dtype),a=this.texData.get(s.dataId);Object.assign(a,o),a.shape=i,a.dtype=t.dtype;var u=ZI(r,t.strides);o.slice&&(u+=o.slice.flatOffset),a.slice={flatOffset:u,origDataId:o.slice&&o.slice.origDataId||t.dataId};var l=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,l+1),s},e.prototype.stridedSlice=function(t,r,i,o){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,r,i,o);var s=Kb(r,i,o);if(s.some((function(u){return u===0})))return Po([],s);var a=new A7(r,o,s);return this.compileAndRun(a,[t])},e.prototype.reverse=function(t,r){var i=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new b7(t.shape,r):new w7(t.shape,r);return this.compileAndRun(i,[t])},e.prototype.concat=function(t,r){if(t[0].dtype==="complex64"){var i=t.map((function(p){return qa(p)})),o=t.map((function(p){return tl(p)}));return ko(this.concat(i,r),this.concat(o,r))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,r);if(t.length===1)return t[0];if(t.length>Ye().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(t.length/2),a=this.concat(t.slice(0,s),r),u=this.concat(t.slice(s),r);return this.concat([a,u],r)}if(Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var l=new mB(t.map((function(p){return p.shape})),r);return this.compileAndRun(l,t)}var h=qd(t.map((function(p){return p.shape})),r),d=t.map((function(p){return p.as2D(-1,Mt(p.shape.slice(r)))})),m=new pB(d.map((function(p){return p.shape})));return this.compileAndRun(m,d).reshape(h)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,IS,t.dtype);var r=new Sn(t.shape,IS);return this.compileAndRun(r,[t])},e.prototype.batchMatMul=function(t,r,i,o){var s=i?t.shape[2]:t.shape[1],a=o?r.shape[1]:r.shape[2],u=i?t.shape[1]:t.shape[2],l=t.shape[0];if((s===1||a===1)&&u>1e3){i&&(t=t.transpose([0,2,1])),o&&(r=r.transpose([0,2,1]));var h=a===1?t:t.as3D(l,u,1),d=a===1?2:1,m=a===1?r.as3D(l,1,u):r;return this.multiply(h,m).sum(d,!0)}var p=No(t.dtype,r.dtype),y=new Uy(t.shape,[l,s,a],i,o);return this.compileAndRun(y,[t,r],p)},e.prototype.fusedBatchMatMul=function(t){var r=t.a,i=t.b,o=t.transposeA,s=t.transposeB,a=t.bias,u=t.activation,l=t.preluActivationWeights,h=o?r.shape[2]:r.shape[1],d=s?i.shape[1]:i.shape[2],m=r.shape[0],p=No(r.dtype,i.dtype),y=a!=null,b=l!=null,x=u?nv(u,!0):null,E=new Uy(r.shape,[m,h,d],o,s,y,x,b),T=[r,i];return a&&T.push(a),l&&T.push(l),this.compileAndRun(E,T,p)},e.prototype.multiply=function(t,r){if(t.dtype==="complex64"){var i=this.texData.get(t.dataId),o=this.texData.get(r.dataId),s=new mS(lB,t.shape,r.shape),a=new mS(cB,t.shape,r.shape),u=[this.makeComplexComponentTensorInfo(t,i.complexTensors.real),this.makeComplexComponentTensorInfo(t,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,o.complexTensors.real),this.makeComplexComponentTensorInfo(r,o.complexTensors.imag)],l=this.compileAndRun(s,u),h=this.compileAndRun(a,u),d=this.complex(l,h);return l.dispose(),h.dispose(),d}if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.multiply(t,r);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,gS,t.dtype);var m=new ii(gS,t.shape,r.shape);return this.compileAndRun(m,[t,r],t.dtype)},e.prototype.batchNormalization=function(t,r,i,o,s,a){var u=[t,r,i],l=null;a!=null&&(l=a.shape,u.push(a));var h=null;if(s!=null&&(h=s.shape,u.push(s)),Ye().getBool("WEBGL_PACK_NORMALIZATION")){var d=new uB(t.shape,r.shape,i.shape,l,h,o);return this.compileAndRun(d,u)}var m=new aB(t.shape,r.shape,i.shape,l,h,o);return this.compileAndRun(m,u)},e.prototype.localResponseNormalization4D=function(t,r,i,o,s){var a=Ye().getBool("WEBGL_PACK_NORMALIZATION")?new i7(t.shape,r,i,o,s):new n7(t.shape,r,i,o,s);return this.compileAndRun(a,[t])},e.prototype.LRNGrad=function(t,r,i,o,s,a,u){var l=new r7(r.shape,o,s,a,u);return this.compileAndRun(l,[r,i,t])},e.prototype.tile=function(t,r){if(t.dtype==="string"){var i=this.readSync(t.dataId).map((function(s){return Zv(s)}));return aT(wn(t.shape,t.dtype,i),r)}var o=new I7(t.shape,r);return this.compileAndRun(o,[t])},e.prototype.pad=function(t,r,i){var o=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new h7(t.shape,r,i):new c7(t.shape,r,i);return this.compileAndRun(o,[t])},e.prototype.transpose=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,r);var i=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new k7(t.shape,r):new T7(t.shape,r);return this.compileAndRun(i,[t])},e.prototype.gather=function(t,r,i){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.gather(t,r,i);var o=new OB(t.shape,r.size,i);return this.compileAndRun(o,[t,r])},e.prototype.batchToSpaceND=function(t,r,i){me(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var o=r.reduce((function(d,m){return d*m})),s=o0(t.shape,r,o),a=s0(s.length,r.length),u=a0(t.shape,r,o),l=KI(i,r.length),h=XI(u,i,r.length);return t.reshape(s).transpose(a).reshape(u).slice(l,h)},e.prototype.spaceToBatchND=function(t,r,i){me(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var o=r.reduce((function(m,p){return m*p})),s=[[0,0]];s.push.apply(s,i);for(var a=1+r.length;a<t.shape.length;++a)s.push([0,0]);var u=t.pad(s),l=o0(u.shape,r,o,!1),h=s0(l.length,r.length,!1),d=a0(u.shape,r,o,!1);return u.reshape(l).transpose(h).reshape(d)},e.prototype.reduce=function(t,r,i){var o=t.shape[0],s=t.shape[1],a=By(s),u=new f7({windowSize:a,inSize:s,batchSize:o},r),l=this.compileAndRun(u,[t],i);return l.shape[1]===1?l:this.reduce(l,r,i)},e.prototype.argReduce=function(t,r,i){i===void 0&&(i=null);var o=t.shape[0],s=t.shape[1];i!=null&&(o=i.shape[0],s=i.shape[1]);var a=By(s),u=new J8({windowSize:a,inSize:s,batchSize:o},r,i==null),l=[t];i!=null&&l.push(i);var h=this.compileAndRun(u,l,"int32");return h.shape[1]===1?h:this.argReduce(t,r,h)},e.prototype.argReducePacked=function(t,r,i){i===void 0&&(i=null);var o=i!=null?i.shape:t.shape,s=By(o[o.length-1]),a=new iB(o,s,r,i==null),u=i==null?[t]:[t,i],l=this.compileAndRun(a,u,"int32");return l.rank===t.rank?this.argReducePacked(t,r,l):l},e.prototype.sum=function(t,r){ha("sum",r,t.rank);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s),u=Ny(t.dtype);return this.reduce(a,"sum",u).reshape(o)},e.prototype.prod=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,r);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s),u=Ny(t.dtype);return this.reduce(a,"prod",u).reshape(o)},e.prototype.unsortedSegmentSum=function(t,r,i){var o=0,s=yl([o],t.rank),a=t;s!=null&&(a=t.transpose(s),o=wl(1,t.rank)[0]);var u=(function(p,y,b){for(var x=[],E=p.length,T=0;T<E;T++)T!==y?x.push(p[T]):x.push(b);return x})(a.shape,o,i),l=Mt([a.shape[o]]),h=a.as2D(-1,l),d=Ny(t.dtype),m=this.segOpCompute(h,"unsortedSegmentSum",r,d,i).reshape(u);return s!=null&&(m=m.transpose(qb(s))),m},e.prototype.segOpCompute=function(t,r,i,o,s){var a=t.shape[0],u=t.shape[1],l=(function(m,p){var y,b=!1;for(m<=QI?(y=m,b=!0):y=iw(m,Math.floor(Math.sqrt(m)));!b;)y>p||y===m?b=!0:y=iw(m,y+1);return y})(u,s),h=new x7({windowSize:l,inSize:u,batchSize:a,numSegments:s}),d=this.compileAndRun(h,[t,i],o);return d.shape[1]===s?d:(i=i0(0,s).tile([u/l]),this.segOpCompute(d,r,i,o,s))},e.prototype.argMinMaxReduce=function(t,r,i){var o=[r];if(ha("arg"+i.charAt(0).toUpperCase()+i.slice(1),o,t.rank),!Ye().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var s=ts(t.shape,o),a=s[0],u=Mt(s[1]),l=t.as2D(-1,u);return this.argReduce(l,i).reshape(a)}return this.argReducePacked(t,i)},e.prototype.argMin=function(t,r){return this.argMinMaxReduce(t,r,"min")},e.prototype.argMax=function(t,r){return this.argMinMaxReduce(t,r,"max")},e.prototype.cumsum=function(t,r,i,o){if(r!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+r);var s=new SB(t.shape,i,o);return this.compileAndRun(s,[t])},e.prototype.equal=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(equal(a, b));
`,"bool");var i=new ii("return float(a == b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.notEqual=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new ii("return float(a != b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.less=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.less(t,r);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new ii("return float(a < b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.lessEqual=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new ii("return float(a <= b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.greater=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.greater(t,r);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new ii("return float(a > b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.greaterEqual=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new ii("return float(a >= b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.logicalNot=function(t){var r=new Sn(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[t])},e.prototype.logicalAnd=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new ii("return float(a >= 1.0 && b >= 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.logicalOr=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new ii("return float(a >= 1.0 || b >= 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.select=function(t,r,i){var o=new _7(t.rank,r.shape,r.rank);return this.compileAndRun(o,[t,r,i],No(r.dtype,i.dtype))},e.prototype.where=function(t){n0("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=t.dataSync();return Jb(t.shape,r)},e.prototype.topk=function(t,r,i){return uT(t.dataSync(),t.shape,t.dtype,r)},e.prototype.min=function(t,r){ha("min",r,t.rank);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"min",a.dtype).reshape(o)},e.prototype.minimum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.minimum(t,r);var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new ii(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.mod=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new ii(`if (b == 0.0) return NAN;
  return mod(a, b);`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.max=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,r);ha("max",r,t.rank);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"max",a.dtype).reshape(o)},e.prototype.maximum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.maximum(t,r);var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new ii(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.all=function(t,r){ha("all",r,t.rank);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"all",a.dtype).reshape(o)},e.prototype.any=function(t,r){ha("any",r,t.rank);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"any",a.dtype).reshape(o)},e.prototype.realDivide=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var i=new ii(`
if (a == b) {
  return 1.0;
};
return a / b;`,t.shape,r.shape);return this.compileAndRun(i,[t,r],"float32")},e.prototype.floorDiv=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new ii(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,t.shape,r.shape);return this.compileAndRun(i,[t,r],"int32")},e.prototype.add=function(t,r){if(t.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(t,r,Vy);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.add(t,r);var i=No(t.dtype,r.dtype);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,Vy,i);var o=new ii(Vy,t.shape,r.shape);return this.compileAndRun(o,[t,r],i)},e.prototype.packedUnaryOp=function(t,r,i){var o=new zp(t.shape,r);return this.compileAndRun(o,[t],i)},e.prototype.packedBinaryOp=function(t,r,i,o,s){s===void 0&&(s=!1);var a=new Gl(i,t.shape,r.shape,s);return this.compileAndRun(a,[t,r],o)},e.prototype.complexSeparableBinaryOp=function(t,r,i){var o=this,s=this.texData.get(t.dataId),a=this.texData.get(r.dataId),u=[[s.complexTensors.real,a.complexTensors.real],[s.complexTensors.imag,a.complexTensors.imag]].map((function(m){var p=m[0],y=m[1],b=o.makeComplexComponentTensorInfo(t,p),x=o.makeComplexComponentTensorInfo(r,y),E=new ii(i,t.shape,r.shape);return o.compileAndRun(E,[b,x],No(p.dtype,y.dtype))})),l=u[0],h=u[1],d=this.complex(l,h);return l.dispose(),h.dispose(),d},e.prototype.makeComplexComponentTensorInfo=function(t,r){return{dataId:r.dataId,dtype:r.dtype,shape:t.shape}},e.prototype.addN=function(t){if(t.length===1)return t[0];if(t.length>Ye().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(t.length/2),i=this.addN(t.slice(0,r)),o=this.addN(t.slice(r));return this.addN([i,o])}var s=t.map((function(l){return l.dtype})).reduce((function(l,h){return No(l,h)})),a=t.map((function(l){return l.shape})),u=Ye().getBool("WEBGL_PACK")?new Q8(t[0].shape,a):new Y8(t[0].shape,a);return this.compileAndRun(u,t,s)},e.prototype.subtract=function(t,r){if(t.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(t,r,jy);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.subtract(t,r);var i=No(t.dtype,r.dtype);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,jy,t.dtype);var o=new ii(jy,t.shape,r.shape);return this.compileAndRun(o,[t,r],i)},e.prototype.pow=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new ii(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,t.shape,r.shape),o=No(t.dtype,r.dtype);return this.compileAndRun(i,[t,r],o)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,TS,t.dtype);var r=new Sn(t.shape,TS);return this.compileAndRun(r,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,kS,t.dtype);var r=new Sn(t.shape,kS);return this.compileAndRun(r,[t])},e.prototype.sign=function(t){var r=new Sn(t.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[t])},e.prototype.isNaN=function(t){var r=new Sn(t.shape,"return float(isnan(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.isInf=function(t){var r=new Sn(t.shape,"return float(isinf(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.isFinite=function(t){var r=new Sn(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.round=function(t){var r=new Sn(t.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,NS,t.dtype);var r=new Sn(t.shape,NS);return this.compileAndRun(r,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,RS,t.dtype);var r=new Sn(t.shape,RS);return this.compileAndRun(r,[t])},e.prototype.softmax=function(t,r){var i=Xi([r],t.shape),o=this.max(t,i),s=Hs(o.shape,i),a=this.subtract(t,o.reshape(s)),u=this.exp(a),l=this.sum(u,i).reshape(s);return this.realDivide(u,l)},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,t.dtype);var r=new Sn(t.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[t])},e.prototype.log1p=function(t){var r=new Sn(t.shape,"return log(1.0 + x);");return this.compileAndRun(r,[t])},e.prototype.sqrt=function(t){var r=new Sn(t.shape,"return sqrt(x);");return this.compileAndRun(r,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var r=new Sn(t.shape,"return inversesqrt(x);");return this.compileAndRun(r,[t])},e.prototype.reciprocal=function(t){var r=new Sn(t.shape,"return 1.0 / x;");return this.compileAndRun(r,[t])},e.prototype.relu=function(t){var r;return r=Ye().getBool("WEBGL_PACK")?new zp(t.shape,vT):new Sn(t.shape,pT),this.compileAndRun(r,[t])},e.prototype.relu6=function(t){var r;return r=Ye().getBool("WEBGL_PACK")?new zp(t.shape,yT):new Sn(t.shape,mT),this.compileAndRun(r,[t])},e.prototype.prelu=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(dT,t.shape,r.shape):new ii(fT,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.elu=function(t){if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,wT,t.dtype);var r=new Sn(t.shape,gT);return this.compileAndRun(r,[t])},e.prototype.eluDer=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,t.shape,r.shape):new ii("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.selu=function(t){var r=new Sn(t.shape,R7);return this.compileAndRun(r,[t])},e.prototype.int=function(t){var r=new Sn(t.shape,"return float(int(x));");return this.compileAndRun(r,[t],"int32")},e.prototype.clip=function(t,r,i){var o,s=(o=Ye().getBool("WEBGL_PACK_CLIP")?new fB(t.shape):new hB(t.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(o,[t],null,s)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,CS,t.dtype);var r=new Sn(t.shape,CS);return this.compileAndRun(r,[t])},e.prototype.complexAbs=function(t){var r=this.texData.get(t.dataId),i=new dB(t.shape),o=[this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)];return this.compileAndRun(i,o)},e.prototype.sigmoid=function(t){var r=new Sn(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[t])},e.prototype.softplus=function(t){var r=new Sn(t.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[t])},e.prototype.sin=function(t){var r=new Sn(t.shape,P7);return this.compileAndRun(r,[t])},e.prototype.cos=function(t){var r=new Sn(t.shape,D7);return this.compileAndRun(r,[t])},e.prototype.tan=function(t){var r=new Sn(t.shape,"return tan(x);");return this.compileAndRun(r,[t])},e.prototype.asin=function(t){var r=new Sn(t.shape,L7);return this.compileAndRun(r,[t])},e.prototype.acos=function(t){var r=new Sn(t.shape,M7);return this.compileAndRun(r,[t])},e.prototype.atan=function(t){var r=new Sn(t.shape,O7);return this.compileAndRun(r,[t])},e.prototype.atan2=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new ii(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.sinh=function(t){var r=new Sn(t.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[t])},e.prototype.cosh=function(t){var r=new Sn(t.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[t])},e.prototype.tanh=function(t){var r=new Sn(t.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[t])},e.prototype.asinh=function(t){var r=new Sn(t.shape,F7);return this.compileAndRun(r,[t])},e.prototype.acosh=function(t){var r=new Sn(t.shape,B7);return this.compileAndRun(r,[t])},e.prototype.atanh=function(t){var r=new Sn(t.shape,V7);return this.compileAndRun(r,[t])},e.prototype.erf=function(t){var r=new Sn(t.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[t])},e.prototype.step=function(t,r){var i=new Sn(t.shape,(function(o){return o===void 0&&(o=0),Au+`
    return x > 0.0 ? 1.0 : float(`+o+`);
  `})(r));return this.compileAndRun(i,[t])},e.prototype.conv2dByMatMul=function(t,r,i,o,s,a){var u=t.shape,l=this.texData.get(t.dataId),h=i.inChannels,d=u[0]*u[1]*u[2],m=i.outChannels,p=i.dataFormat==="channelsLast",y=(d===1||m===1)&&h>1e3,b=u[2]%2!=0&&!!l.isPacked;if(y||!Ye().getBool("WEBGL_LAZILY_UNPACK")||!Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!b){var x=p?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],E=this.reshape(t,[1,x,i.inChannels]),T=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:E,b:T,transposeA:!1,transposeB:!1,bias:o,activation:s,preluActivationWeights:a}),i.outShape)}var P=p?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),I={dataId:t.dataId,shape:[1,P,i.inChannels],dtype:t.dtype},D=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,me(Jg(l.shape,I.shape),(function(){return"packed reshape "+l.shape+" to "+I.shape+" isn't free"}));var U=this.reshape(r,[1,i.inChannels,i.outChannels]),L=this.fusedBatchMatMul({a:I,b:U,transposeA:!1,transposeB:!1,bias:o,activation:s,preluActivationWeights:a}),C=this.texData.get(L.dataId);return me(C.isPacked,(function(){return"batchMatMul result is expected to be packed"})),l.shape=D,C.shape=i.outShape,Ie.makeTensorFromDataId(L.dataId,i.outShape,L.dtype)},e.prototype.conv2dWithIm2Row=function(t,r,i,o,s,a){var u=i.filterWidth,l=i.filterHeight,h=i.inChannels,d=i.outWidth,m=i.outHeight,p=i.dataFormat==="channelsLast",y=u*l*h,b=m*d,x=[y,b],E=t.squeeze([0]),T=r.reshape([1,y,-1]),P=new t7(x,E.shape,i),I=this.compileAndRun(P,[E]).reshape([1,x[0],x[1]]),D=o!=null,U=a!=null,L=s?nv(s,!0):null,C=new Uy(I.shape,[1,b,i.outChannels],!0,!1,D,L,U),A=[I,T];o&&A.push(o),U&&A.push(a);var M=this.compileAndRun(C,A);return p?M.reshape([1,m,d,i.outChannels]):M.reshape([1,i.outChannels,m,d])},e.prototype.fusedConv2d=function(t){var r=t.input,i=t.filter,o=t.convInfo,s=t.bias,a=t.activation,u=t.preluActivationWeights;if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,o,s,a,u);if(Ye().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,o,s,a,u);var l=s!=null,h=u!=null,d=a?nv(a,!1):null,m=new vS(o,l,d,h),p=[r,i];return s&&p.push(s),u&&p.push(u),this.compileAndRun(m,p)},e.prototype.conv2d=function(t,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(t,r,i);if(Ye().getBool("WEBGL_CONV_IM2COL")&&t.shape[0]===1)return this.conv2dWithIm2Row(t,r,i);var o=new vS(i);return this.compileAndRun(o,[t,r])},e.prototype.conv2dDerInput=function(t,r,i){var o=new vB(i);return this.compileAndRun(o,[t,r])},e.prototype.conv2dDerFilter=function(t,r,i){var o=new gB(i);return this.compileAndRun(o,[t,r])},e.prototype.fusedDepthwiseConv2D=function(t){var r,i=t.input,o=t.filter,s=t.convInfo,a=t.bias,u=t.activation,l=t.preluActivationWeights,h=Ye().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,d=u?nv(u,h):null,m=[i,o],p=a!=null,y=l!=null;return p&&m.push(a),y&&m.push(l),h?(r=new wS(s,p,d,y),this.compileAndRun(r,m)):(r=new yS(s,p,d,y),this.compileAndRun(r,m))},e.prototype.depthwiseConv2D=function(t,r,i){var o;return Ye().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(o=new wS(i),this.compileAndRun(o,[t,r])):(o=new yS(i),this.compileAndRun(o,[t,r]))},e.prototype.depthwiseConv2DDerInput=function(t,r,i){var o=new xB(i);return this.compileAndRun(o,[t,r])},e.prototype.depthwiseConv2DDerFilter=function(t,r,i){var o=new bB(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3d=function(t,r,i){var o=new _B(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3dDerInput=function(t,r,i){var o=new wB(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3dDerFilter=function(t,r,i){var o=new yB(i);return this.compileAndRun(o,[t,r])},e.prototype.maxPool=function(t,r){var i=new zy(r,"max",!1);return this.compileAndRun(i,[t])},e.prototype.avgPool=function(t,r){var i=new zy(r,"avg",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.maxPoolBackprop=function(t,r,i,o){var s=new zy(o,"max",!0),a=this.compileAndRun(s,[r]),u=new o7(o),l=this.compileAndRun(u,[t,a],r.dtype);return a.dispose(),l},e.prototype.avgPoolBackprop=function(t,r,i){var o=new oB(i);return this.compileAndRun(o,[t],r.dtype)},e.prototype.cast=function(t,r){return rT(t,r,this)},e.prototype.unstack=function(t,r){for(var i=t.shape[r],o=new Array(t.rank-1),s=0,a=0;a<t.rank;a++)a!==r&&(o[s++]=t.shape[a]);var u=new Array(t.rank).fill(0),l=t.shape.slice();l[r]=1;var h=new Array(i);for(a=0;a<h.length;a++)u[r]=a,h[a]=this.slice(t,u,l).reshape(o);return h},e.prototype.avgPool3d=function(t,r){var i=new Wy(r,"avg",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,r,i){var o=new sB(i);return this.compileAndRun(o,[t],r.dtype)},e.prototype.maxPool3d=function(t,r){var i=new Wy(r,"max",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,r,i,o){var s=new Wy(o,"max",!0),a=this.compileAndRun(s,[r]),u=new s7(o),l=this.compileAndRun(u,[t,a],r.dtype);return a.dispose(),l},e.prototype.reshape=function(t,r){var i=this.texData.get(t.dataId);if(i.isPacked&&!Jg(t.shape,r)&&(i.texture===null||!Jg(i.shape,r))){var o=this.packedReshape(t,r);return Ie.makeTensorFromDataId(o.dataId,o.shape,o.dtype)}return fw(t,r)},e.prototype.resizeBilinear=function(t,r,i,o){var s=Ye().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new g7(t.shape,r,i,o):new m7(t.shape,r,i,o);return this.compileAndRun(s,[t],"float32")},e.prototype.resizeBilinearBackprop=function(t,r,i){var o=new p7(t,r,i);return this.compileAndRun(o,[t])},e.prototype.resizeNearestNeighbor=function(t,r,i,o){var s=new y7(t.shape,r,i,o);return this.compileAndRun(s,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,r,i){var o=new v7(t,r,i);return this.compileAndRun(o,[t])},e.prototype.multinomial=function(t,r,i,o){var s=r?t:ic(t),a=s.shape[0],u=s.shape[1],l=new a7(a,u,i),h=l.getCustomSetupFunc(o);return this.compileAndRun(l,[s],"int32",h)},e.prototype.oneHot=function(t,r,i,o){var s=new u7(t.size,r,i,o);return this.compileAndRun(s,[t])},e.prototype.diag=function(t){var r=new TB(t.size);return this.compileAndRun(r,[t])},e.prototype.nonMaxSuppression=function(t,r,i,o,s){return n0("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Yb(t.dataSync(),r.dataSync(),i,o,s)},e.prototype.cropAndResize=function(t,r,i,o,s,a){var u=new EB(t.shape,r.shape,o,s,a);return this.compileAndRun(u,[t,r,i],"float32")},e.prototype.depthToSpace=function(t,r,i){me(r>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+r}));var o=t.shape[0],s=i==="NHWC"?t.shape[1]:t.shape[2],a=i==="NHWC"?t.shape[2]:t.shape[3],u=i==="NHWC"?t.shape[3]:t.shape[1],l=s*r,h=a*r,d=u/(r*r),m=new IB(i==="NHWC"?[o,l,h,d]:[o,d,l,h],r,i);return this.compileAndRun(m,[t])},e.prototype.split=function(t,r,i){return sT(t,r,i)},e.prototype.scatterND=function(t,r,i){var o=u0(0,t,i),s=o.sliceRank,a=o.numUpdates,u=o.sliceSize,l=o.strides,h=o.outputSize,d=[h/u,u],m=t.reshape([a,s]),p=r.reshape([a,u]);if(h===0)return fw(Po([]),i);var y=dt(0),b=new ES(a,s,m.rank,p.rank,l,d);return this.compileAndRun(b,[p,m,y]).reshape(i)},e.prototype.sparseToDense=function(t,r,i,o){var s=u0(0,t,i),a=s.sliceRank,u=s.numUpdates,l=s.strides,h=s.outputSize,d=new ES(u,a,t.rank,r.rank,l,[h,1]);return this.compileAndRun(d,[r,t,o]).reshape(i)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,r){var i=this.texData.get(t.dataId),o=new xS(DB,t.shape,r),s=new xS(LB,t.shape,r),a=[this.makeComplexComponentTensorInfo(t,i.complexTensors.real),this.makeComplexComponentTensorInfo(t,i.complexTensors.imag)],u=this.compileAndRun(o,a),l=this.compileAndRun(s,a),h=this.complex(u,l).as2D(t.shape[0],t.shape[1]);return u.dispose(),l.dispose(),h},e.prototype.gatherND=function(t,r){var i=r.shape,o=i[i.length-1],s=YI(t,r),a=s[0],u=s[1],l=s[2],h=s[3],d=r.reshape([u,o]),m=t.reshape([t.size/l,l]),p=new FB(o,h,[u,l]);return this.compileAndRun(p,[m,d]).reshape(a)},e.prototype.fill=function(t,r,i){if((i=i||zm(r))==="string"){var o=Jv(i,Mt(t));return o.fill(r),Ie.makeTensor(o,t,i,this)}var s=new MB(t,r),a=s.getCustomSetupFunc(r);return this.compileAndRun(s,[],i,a)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,t.dtype==="string"?"":0,t.dtype)},e.prototype.linspace=function(t,r,i){return iT(t,r,i)},e.prototype.makeTensorInfo=function(t,r){var i=this.write(null,t,r);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:r}},e.prototype.makeOutput=function(t,r){var i=this.makeTensorInfo(t,r).dataId;return Ie.makeTensorFromDataId(i,t,r,this)},e.prototype.unpackTensor=function(t){var r=new U7(t.shape);return this.runWebGLProgram(r,[t],t.dtype)},e.prototype.packTensor=function(t){var r=new l7(t.shape);return this.runWebGLProgram(r,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,r){var i=[e0(t.shape)].concat(t0(t.shape)),o={dtype:t.dtype,shape:i,dataId:t.dataId},s=[e0(r)].concat(t0(r)),a=new d7(s,i),u=this.runWebGLProgram(a,[o],t.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},e.prototype.decode=function(t){var r,i=this.texData.get(t),o=i.isPacked,s=i.shape,a=i.dtype,u=Fy(s);return r=o?new CB(u):new AB(u),{dtype:a,shape:s,dataId:this.runWebGLProgram(r,[{shape:u,dtype:a,dataId:t}],a,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,r,i,o,s){var a=this;s===void 0&&(s=!1);var u=this.makeTensorInfo(t.outputShape,i),l=this.texData.get(u.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===_m.DENSE){var h=im(t.outputShape);l.texShape=h.map((function(P){return 2*P}))}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),Mt(u.shape)===0)return l.values=bm(u.dtype,0),u;var d=[],m=r.map((function(P){if(P.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var I=a.texData.get(P.dataId);if(I.texture==null){if(!t.packedInputs&&Mt(P.shape)<=Ye().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:P.shape,texData:null,isUniform:!0,uniformValues:I.values};t.packedInputs&&(I.isPacked=!0,I.shape=P.shape)}else if(!!I.isPacked!=!!t.packedInputs)P=I.isPacked?a.unpackTensor(P):a.packTensor(P),d.push(P),I=a.texData.get(P.dataId);else if(I.isPacked&&!Jg(I.shape,P.shape)){var D=P,U=P.shape;P.shape=I.shape,P=a.packedReshape(P,U),d.push(P),I=a.texData.get(P.dataId),D.shape=U}return a.uploadToGPU(P.dataId),{shape:P.shape,texData:I,isUniform:!1}}));this.uploadToGPU(u.dataId);var p,y={shape:u.shape,texData:l,isUniform:!1},b=(function(P,I,D){var U="";I.concat(D).forEach((function(A){var M=A.texData!=null&&A.texData.slice!=null&&A.texData.slice.flatOffset>0,k=A.isUniform?"uniform":A.texData.texShape;U+=A.shape+"_"+k+"_"+M}));var L=P.userCode,C=P.constructor.name;return C+="_"+U+"_"+L})(t,m,y),x=this.getAndSaveBinary(b,(function(){return(function(P,I,D,U){var L=I.userCode,C=D.map((function($,le){var ae={logicalShape:$.shape,texShape:$.isUniform?null:$.texData.texShape,isUniform:$.isUniform,isPacked:!$.isUniform&&$.texData.isPacked,flatOffset:null};return $.texData!=null&&$.texData.slice!=null&&$.texData.slice.flatOffset>0&&(ae.flatOffset=$.texData.slice.flatOffset),{name:I.variableNames[le],shapeInfo:ae}})),A=C.map((function($){return $.shapeInfo})),M={logicalShape:U.shape,texShape:U.texData.texShape,isUniform:!1,isPacked:U.texData.isPacked,flatOffset:null},k=Z8(C,M,L,I.packedInputs),O=P.createProgram(k),j=null,X=P.getUniformLocation(O,"NAN",!1);Ye().getNumber("WEBGL_VERSION")===1&&(j=P.getUniformLocation(O,"INFINITY",!1));for(var ue={},ge=0;ge<I.variableNames.length;ge++){var he=I.variableNames[ge];ue[he]=P.getUniformLocation(O,he,!1),ue["offset"+he]=P.getUniformLocation(O,"offset"+he,!1)}return{program:I,source:k,webGLProgram:O,uniformLocations:ue,inShapeInfos:A,outShapeInfo:M,infLoc:j,nanLoc:X}})(a.gpgpu,t,m,y)})),E=this.activeTimers!=null;if(E&&(p=this.startTimer()),(function(P,I,D,U,L){_S(I.inShapeInfos,D),_S([I.outShapeInfo],[U]);var C=U.texData.texture,A=U.texData.texShape;U.texData.isPacked?P.setOutputPackedMatrixTexture(C,A[0],A[1]):P.setOutputMatrixTexture(C,A[0],A[1]),P.setProgram(I.webGLProgram),Ye().getNumber("WEBGL_VERSION")===1&&I.infLoc!==null&&P.gl.uniform1f(I.infLoc,1/0),I.nanLoc!==null&&P.gl.uniform1f(I.nanLoc,NaN),D.forEach((function(M,k){var O=I.program.variableNames[k],j=I.uniformLocations[O],X=I.uniformLocations["offset"+O];if(j!=null)if(M.isUniform)if(Mt(M.shape)<2)P.gl.uniform1f(j,M.uniformValues[0]);else{var ue=M.uniformValues;ue instanceof Float32Array||(ue=new Float32Array(ue)),P.gl.uniform1fv(j,ue)}else M.texData.slice!=null&&X!=null&&P.gl.uniform1i(X,M.texData.slice.flatOffset),P.setInputMatrixTexture(M.texData.texture,j,k)})),L!=null&&L(P,I.webGLProgram),P.executeProgram()})(this.gpgpu,x,m,y,o),d.forEach((function(P){return a.disposeData(P.dataId)})),E&&(p=this.endTimer(p),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(p)})),!Ye().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&s===!1){var T=this.unpackTensor(u);return this.disposeData(u.dataId),T}return u},e.prototype.compileAndRun=function(t,r,i,o,s){s===void 0&&(s=!1),i=i||r[0].dtype;var a=this.runWebGLProgram(t,r,i,o,s);return Ie.makeTensorFromDataId(a.dataId,a.shape,a.dtype)},e.prototype.getAndSaveBinary=function(t,r){return t in this.binaryCache||(this.binaryCache[t]=r()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var t=this;this.disposed||(Ye().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(r){t.gpgpu.deleteProgram(t.binaryCache[r].webGLProgram),delete t.binaryCache[r]})),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=_t((function(){if(!Ye().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=Ye().getBool("DEBUG");Ye().set("DEBUG",!1);var i=t.abs(dt(1e-8)).dataSync()[0];if(Ye().set("DEBUG",r),i>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var r,i=this.texData.get(t),o=i.shape,s=i.dtype,a=i.values,u=i.texture,l=i.usage,h=i.isPacked;if(u==null){var d,m=this.activeTimers!=null;m&&(d=Zu());var p=i.texShape;if(p==null&&(p=XF(o,h),i.texShape=p),a!=null){var y=Fy(o),b=void 0,x=p[1],E=p[0],T=a instanceof Uint8Array;h?(x=(r=qm(p[0],p[1]))[0],E=r[1],b=new PB(y,[E,x],T)):b=new RB(y,[E,x],T);var P=this.makeTensorInfo([E,x],s);this.texData.get(P.dataId).usage=T?da.PIXELS:da.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(P.dataId),x,E,a);var I=this.runWebGLProgram(b,[P],s,null,!0),D=this.texData.get(I.dataId);i.texture=D.texture,i.texShape=D.texShape,i.isPacked=D.isPacked,i.usage=D.usage,this.disposeData(P.dataId),this.texData.delete(I.dataId),i.values=null,m&&(this.uploadWaitMs+=Zu()-d)}else{var U=this.acquireTexture(p,l,s,h);i.texture=U}}},e.prototype.convertAndCacheOnCPU=function(t,r){var i=this.texData.get(t),o=i.dtype;return this.releaseGPUData(t),r!=null&&(i.values=(function(s,a){if(a==="float32"||a==="complex64")return s;if(a==="int32"||a==="bool"){for(var u=a==="int32"?new Int32Array(s.length):new Uint8Array(s.length),l=0;l<u.length;++l)u[l]=Math.round(s[l]);return u}throw new Error("Unknown dtype "+a)})(r,o)),i.values},e.prototype.acquireTexture=function(t,r,i,o){if(this.numBytesInGPU+=this.computeBytes(t,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,r,o)},e.prototype.computeBytes=function(t,r){return t[0]*t[1]*PI(r)},e})(tT);VI()&&Ie.registerBackend("webgl",(function(){return new W7}),2);var q7=xe({square_:function(n){var e=oe(n,"x","square"),t=[e];return Ie.runKernelFunc((function(r,i){return i([e]),r.square(e)}),{x:e},null,"Square",{},t,[])}}),Sm="SquaredDifference",bT=xe({squaredDifference_:function(n,e){var t,r=oe(n,"a","squaredDifference"),i=oe(e,"b","squaredDifference");t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape);var o={a:r,b:i},s=[r,i];return Ie.runKernelFunc((function(a,u){var l=a.squaredDifference(r,i);return u([r,i]),l}),o,(function(a,u){var l=u[0],h=u[1],d=dt(2);return{a:function(){return a.mul(l.sub(h).mul(d))},b:function(){return a.mul(h.sub(l).mul(d))}}}),Sm,{},s,[])}}),H7=xe({abs_:function(n){var e=oe(n,"x","abs");return e.dtype==="complex64"?Ie.runKernelFunc((function(t){return t.complexAbs(e)}),{$x:e}):Ie.runKernelFunc((function(t,r){var i=t.abs(e);return r([e]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return t.mul(i.toFloat().step(-1))}}}),"Abs")}}),G7=xe({acos_:function(n){var e=oe(n,"x","acos");return Ie.runKernelFunc((function(t,r){var i=t.acos(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(dt(1).sub(i.toFloat().square()).sqrt()).neg()}}}))}}),$7=xe({acosh_:function(n){var e=oe(n,"x","acosh");return Ie.runKernelFunc((function(t,r){var i=t.acosh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(i.toFloat().square().sub(1).sqrt())}}}))}}),K7=xe({asin_:function(n){var e=oe(n,"x","asin");return Ie.runKernelFunc((function(t,r){var i=t.asin(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(dt(1).sub(i.toFloat().square()).sqrt())}}}))}}),X7=xe({asinh_:function(n){var e=oe(n,"x","asinh");return Ie.runKernelFunc((function(t,r){var i=t.asinh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(dt(1).add(i.toFloat().square()).sqrt())}}}))}}),Y7=xe({atan_:function(n){var e=oe(n,"x","atan");return Ie.runKernelFunc((function(t,r){var i=t.atan(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat().square().add(1))}}}))}}),Q7=xe({atanh_:function(n){var e=oe(n,"x","atanh");return Ie.runKernelFunc((function(t,r){var i=t.atanh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(dt(1).sub(i.toFloat().square()))}}}))}}),J7=xe({ceil_:function(n){var e=oe(n,"x","ceil");return Ie.runKernelFunc((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),nx=xe({clipByValue_:function(n,e,t){var r=oe(n,"x","clipByValue");me(e<=t,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+t+")."}));var i=[r],o={min:e,max:t};return Ie.runKernelFunc((function(s,a){var u=s.clip(r,e,t);return a([r]),u}),{x:r},(function(s,a){var u=a[0];return{x:function(){return s.where(u.greaterEqual(e).logicalAnd(u.lessEqual(t)),zn(s))}}}),"ClipByValue",o,i)}}),Z7=xe({cos_:function(n){var e=oe(n,"x","cos"),t=[e];return Ie.runKernelFunc((function(r,i){var o=r.cos(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return o.toFloat().sin().neg().mul(r)}}}),"Cos",{},t)}}),eV=xe({cosh_:function(n){var e=oe(n,"x","cosh");return Ie.runKernelFunc((function(t,r){var i=t.cosh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(t)}}}))}}),tV=xe({erf_:function(n){var e=oe(n,"x","erf");return me(e.dtype==="int32"||e.dtype==="float32",(function(){return"Input dtype must be `int32` or `float32`."})),e.dtype==="int32"&&(e=e.toFloat()),Ie.runKernelFunc((function(t,r){var i=t.erf(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),pw=xe({exp_:function(n){var e=oe(n,"x","exp");return Ie.runKernelFunc((function(t,r){var i=t.exp(e);return r([i]),i}),{x:e},(function(t,r){return{x:function(){return t.mulStrict(r[0])}}}),"Exp",{},[],[!0])}}),nV=xe({expm1_:function(n){var e=oe(n,"x","expm1");return Ie.runKernelFunc((function(t,r){var i=t.expm1(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.exp())}}}))}}),rV=xe({floor_:function(n){var e=oe(n,"x","floor");return Ie.runKernelFunc((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),iV=xe({log_:function(n){var e=oe(n,"x","log"),t=[e];return Ie.runKernelFunc((function(r,i){var o=r.log(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return r.div(o.toFloat())}}}),"Log",{},t)}}),oV=xe({log1p_:function(n){var e=oe(n,"x","log1p");return Ie.runKernelFunc((function(t,r){var i=t.log1p(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.add(1))}}}))}}),sV=xe({logSigmoid_:function(n){var e=oe(n,"x","logSigmoid");return Ie.runKernelFunc((function(t,r){var i=t.softplus(e.neg()).neg();return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.neg().sigmoid())}}}))}}),f0=xe({neg_:function(n){var e=oe(n,"x","neg"),t=[e];return Ie.runKernelFunc((function(r){return r.neg(e)}),{x:e},(function(r){return{x:function(){return r.neg()}}}),"Neg",{},t)}}),aV=xe({reciprocal_:function(n){var e=oe(n,"x","reciprocal");return Ie.runKernelFunc((function(t,r){var i=t.reciprocal(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.square().neg())}}}))}}),uV=xe({round_:function(n){var e=oe(n,"x","round");return Ie.runKernelFunc((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),xT=xe({rsqrt_:function(n){var e=oe(n,"x","rsqrt"),t=[e];return Ie.runKernelFunc((function(r,i){var o=r.rsqrt(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return r.div(o.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},t)}}),_T=xe({sigmoid_:function(n){var e=oe(n,"x","sigmoid");return Ie.runKernelFunc((function(t,r){var i=t.sigmoid(e);return r([i]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return t.mul(i.mul(dt(1).sub(i)))}}}),"Sigmoid")}}),lV=xe({sign_:function(n){var e=oe(n,"x","sign");return Ie.runKernelFunc((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),cV=xe({isNaN_:function(n){var e=oe(n,"x","isNaN");return Ie.runKernelFunc((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),hV=xe({isInf_:function(n){var e=oe(n,"x","isInf");return Ie.runKernelFunc((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),fV=xe({isFinite_:function(n){var e=oe(n,"x","isFinite");return Ie.runKernelFunc((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),dV=xe({sin_:function(n){var e=oe(n,"x","sin"),t=[e];return Ie.runKernelFunc((function(r,i){var o=r.sin(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return o.toFloat().cos().mul(r)}}}),"Sin",{},t)}}),pV=xe({sinh_:function(n){var e=oe(n,"x","sinh");return Ie.runKernelFunc((function(t,r){var i=t.sinh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(t)}}}))}}),mV=xe({softplus_:function(n){var e=oe(n,"x","softplus");return Ie.runKernelFunc((function(t,r){var i=t.softplus(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.sigmoid())}}}))}}),gV=xe({sqrt_:function(n){var e=oe(n,"x","sqrt");return Ie.runKernelFunc((function(t,r){var i=t.sqrt(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat().sqrt().mul(2))}}}))}}),vV=xe({step_:function(n,e){e===void 0&&(e=0);var t=oe(n,"x","step");return Ie.runKernelFunc((function(r){return r.step(t,e)}),{$x:t},(function(r){return{$x:function(){return zn(r)}}}))}}),yV=xe({tan_:function(n){var e=oe(n,"x","tan");return Ie.runKernelFunc((function(t,r){var i=t.tan(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.cos().square())}}}))}}),wV=xe({tanh_:function(n){var e=oe(n,"x","tanh");return Ie.runKernelFunc((function(t,r){var i=t.tanh(e);return r([i]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return dt(1).sub(i.square()).mulStrict(t)}}}),"Tanh",{},null,[!0])}});function ET(n,e,t,r,i,o){var s,a,u=oe(n,"x","batchNorm"),l=oe(e,"mean","batchNorm"),h=oe(t,"variance","batchNorm");return i!=null&&(s=oe(i,"scale","batchNorm")),r!=null&&(a=oe(r,"offset","batchNorm")),me(u.rank===2,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),me(l.rank===2||l.rank===1,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."})),me(h.rank===2||h.rank===1,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+h.rank+"."})),s!=null&&me(s.rank===2||s.rank===1,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."})),a!=null&&me(a.rank===2||a.rank===1,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+a.rank+"."})),Gm(u,l,h,a,s,o)}function ST(n,e,t,r,i,o){var s,a,u=oe(n,"x","batchNorm"),l=oe(e,"mean","batchNorm"),h=oe(t,"variance","batchNorm");return i!=null&&(s=oe(i,"scale","batchNorm")),r!=null&&(a=oe(r,"offset","batchNorm")),me(u.rank===3,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),me(l.rank===3||l.rank===1,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."})),me(h.rank===3||h.rank===1,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+h.rank+"."})),s!=null&&me(s.rank===3||s.rank===1,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."})),a!=null&&me(a.rank===3||a.rank===1,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+a.rank+"."})),Gm(u,l,h,a,s,o)}function AT(n,e,t,r,i,o){var s,a,u=oe(n,"x","batchNorm"),l=oe(e,"mean","batchNorm"),h=oe(t,"variance","batchNorm");return i!=null&&(s=oe(i,"scale","batchNorm")),r!=null&&(a=oe(r,"offset","batchNorm")),me(u.rank===4,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),me(l.rank===4||l.rank===1,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."})),me(h.rank===4||h.rank===1,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+h.rank+"."})),s!=null&&me(s.rank===4||s.rank===1,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."})),a!=null&&me(a.rank===4||a.rank===1,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+a.rank+"."})),Gm(u,l,h,a,s,o)}function Gm(n,e,t,r,i,o){o==null&&(o=.001);var s,a,u,l=oe(n,"x","batchNorm"),h=oe(e,"mean","batchNorm"),d=oe(t,"variance","batchNorm");i!=null&&(s=oe(i,"scale","batchNorm")),r!=null&&(a=oe(r,"offset","batchNorm")),me(h.rank===d.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),me(a==null||h.rank===a.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),me(s==null||h.rank===s.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var m=[l,h,d,s];return Ie.runKernelFunc((function(p,y){var b=p.batchNormalization(u,rv(h),rv(d),o,rv(s),rv(a));return y([l,h,d,s]),b}),{x:l,mean:h,variance:d,scale:s,offset:a},(function(p,y){var b=y,x=b[0],E=b[1],T=b[2],P=b[3],I=P??dt(1),D=$i(E.shape,u.shape),U=[];if(E.rank===1){for(var L=0;L<u.shape.length-1;++L)U.push(u.shape[L]);U.push(1)}var C=x.sub(E),A=p.mul(I),M=xT(T.add(dt(o))),k=M.mul(M).mul(M).mul(dt(-.5));return{x:function(){return E.rank===1?p.mul(xd(M.as4D(1,1,1,E.shape[0]),U)).mul(I).reshape(x.shape):p.mul(M).mul(I).reshape(x.shape)},mean:function(){var O=M.mul(dt(-1)).mul(A);return E.rank===1&&(O=O.sum(D)),O.reshape(E.shape)},variance:function(){var O=k.mul(C).mul(A);return E.rank===1&&(O=O.sum(D)),O.reshape(E.shape)},scale:function(){var O=C.mul(M),j=p.mul(O);return E.rank===1&&(j=j.sum(D)),j.reshape(E.shape)},offset:function(){var O=p;return E.rank===1&&(O=O.sum(D)),O.reshape(E.shape)}}}),"BatchNormalization",{varianceEpsilon:o},m).reshape(l.shape)}function rv(n){return n==null?null:n.rank===0?n.as1D():n.rank===1?n:n.rank===2?n.as4D(1,1,n.shape[0],n.shape[1]):n.rank===3?n.as4D(1,n.shape[0],n.shape[1],n.shape[2]):n}function $0(){jI("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var bV=xe({batchNormalization2d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),$0(),ET(n,e,t,o,i,r)}}),xV=xe({batchNormalization3d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),$0(),ST(n,e,t,o,i,r)}}),_V=xe({batchNormalization4d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),$0(),AT(n,e,t,o,i,r)}}),EV=xe({batchNormalization_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),$0(),Gm(n,e,t,o,i,r)}}),CT=xe({batchNorm_:Gm}),SV=xe({batchNorm2d_:ET}),AV=xe({batchNorm3d_:ST}),CV=xe({batchNorm4d_:AT}),K0=xe({logicalAnd_:function(n,e){var t=oe(n,"a","logicalAnd","bool"),r=oe(e,"b","logicalAnd","bool");return Mn(t.shape,r.shape),Ie.runKernelFunc((function(i){return i.logicalAnd(t,r)}),{a:t,b:r},null,"LogicalAnd")}}),IV=xe({logicalNot_:function(n){var e=oe(n,"x","logicalNot","bool");return Ie.runKernelFunc((function(t){return t.logicalNot(e)}),{$x:e})}}),IT=xe({logicalOr_:function(n,e){var t=oe(n,"a","logicalOr","bool"),r=oe(e,"b","logicalOr","bool");return Mn(t.shape,r.shape),Ie.runKernelFunc((function(i){return i.logicalOr(t,r)}),{$a:t,$b:r})}}),TV=xe({logicalXor_:function(n,e){var t=oe(n,"a","logicalXor","bool"),r=oe(e,"b","logicalXor","bool");return Mn(t.shape,r.shape),IT(n,e).logicalAnd(K0(n,e).logicalNot())}}),cf=xe({where_:function(n,e,t){var r=oe(e,"a","where"),i=oe(t,"b","where"),o=oe(n,"condition","where","bool");return ir(r.shape,i.shape,"Error in where: "),o.rank===1?me(o.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):ir(o.shape,i.shape,"Error in where: "),Ie.runKernelFunc((function(s,a){var u=s.select(o,r,i);return a([o]),u}),{$condition:o,$a:r,$b:i},(function(s,a){var u=a[0];return{$condition:function(){return zn(u).toFloat()},$a:function(){return s.mul(u.cast(s.dtype))},$b:function(){return s.mul(u.logicalNot().cast(s.dtype))}}}))}}),TT=function(n){return Nt(this,void 0,void 0,(function(){var e,t,r;return Rt(this,(function(i){switch(i.label){case 0:return[4,(e=oe(n,"condition","whereAsync","bool")).data()];case 1:return t=i.sent(),r=Jb(e.shape,t),n!==e&&e.dispose(),[2,r]}}))}))},Dn=xe({add_:function(n,e){var t,r=oe(n,"a","add"),i=oe(e,"b","add");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Ie.runKernelFunc((function(s){return s.add(r,i)}),{a:r,b:i},(function(s){return{a:function(){var a=s,u=$i(r.shape,o);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)},b:function(){var a=s,u=$i(i.shape,o);return u.length>0&&(a=a.sum(u)),a.reshape(i.shape)}}}),"Add")}}),kV=xe({addN_:function(n){me(Array.isArray(n),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),me(n.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+n.length}));var e=n.map((function(i,o){return oe(i,"tensors"+o,"addN")})),t=e[0];e.forEach((function(i){if(i.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(i){if(!po(i.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=e;return Ie.runKernelFunc((function(i){return i.addN(e)}),r,(function(i){var o={};return e.forEach((function(s,a){o[a]=function(){return i.clone()}})),o}),"AddN")}}),NV=xe({addStrict_:function(n,e){var t=oe(n,"a","addStrict"),r=oe(e,"b","addStrict");return ir(t.shape,r.shape,"Error in addStrict: "),t.add(r)}}),RV=xe({atan2_:function(n,e){var t,r=oe(n,"a","atan2"),i=oe(e,"b","atan2");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Ie.runKernelFunc((function(s,a){var u=s.atan2(r,i);return a([r,i]),u}),{$a:r,$b:i},(function(s,a){var u=a[0],l=a[1];return{$a:function(){var h=Dn(u.square(),l.square()),d=s.mul(l.div(h)),m=$i(u.shape,o);return m.length>0&&(d=d.sum(m)),d.reshape(u.shape)},$b:function(){var h=Dn(u.square(),l.square()),d=f0(s.mul(u.div(h))),m=$i(l.shape,o);return m.length>0&&(d=d.sum(m)),d.reshape(l.shape)}}}))}}),gu=xe({div_:function(n,e){var t,r=oe(n,"a","div"),i=oe(e,"b","div");if(t=Jr(r,i),r=t[0],i=t[1],r.dtype==="int32"&&i.dtype==="int32")return kT(r,i);var o=Mn(r.shape,i.shape);return Ie.runKernelFunc((function(s,a){var u=s.realDivide(r,i);return a([r,i]),u}),{a:r,b:i},(function(s,a){var u=a[0],l=a[1];return{a:function(){var h=s.div(l.toFloat()),d=$i(u.shape,o);return d.length>0?h.sum(d).reshape(u.shape):h},b:function(){var h=s.mul(u.toFloat()),d=$i(l.shape,o);d.length>0&&(h=h.sum(d).reshape(l.shape));var m=l.square();return h.div(m.toFloat()).neg()}}}),"Div")}}),PV=xe({divNoNan_:function(n,e){var t,r=oe(n,"a","div"),i=oe(e,"b","div");r=(t=Jr(r,i))[0],i=t[1];var o=gu(r,i),s=zn(o),a=i.equal(s);return cf(a,s,o)}}),DV=xe({divStrict_:function(n,e){var t=oe(n,"a","div"),r=oe(e,"b","div");return ir(t.shape,r.shape,"Error in divideStrict: "),t.div(r)}}),kT=xe({floorDiv_:function(n,e){var t,r=oe(n,"a","floorDiv"),i=oe(e,"b","floorDiv");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Ie.runKernelFunc((function(s,a){var u=s.floorDiv(r,i);return a([r,i]),u}),{a:r,b:i},(function(s,a){var u=a[0],l=a[1];return{a:function(){var h=s.div(l.toFloat()),d=$i(u.shape,o);return d.length>0?h.sum(d).reshape(u.shape):h},b:function(){var h=s.mul(u.toFloat()),d=$i(l.shape,o);d.length>0&&(h=h.sum(d).reshape(l.shape));var m=l.square();return h.div(m.toFloat()).neg()}}}),"FloorDiv")}}),rx=xe({maximum_:function(n,e){var t,r=oe(n,"a","maximum"),i=oe(e,"b","maximum");return t=Jr(r,i),r=t[0],i=t[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Mn(r.shape,i.shape),Ie.runKernelFunc((function(o,s){var a=o.maximum(r,i);return s([r,i]),a}),{a:r,b:i},(function(o,s){var a=s[0],u=s[1];return{a:function(){return o.mul(a.greaterEqual(u).toFloat())},b:function(){return o.mul(a.less(u).toFloat())}}}),"Maximum")}}),LV=xe({maximumStrict_:function(n,e){var t=oe(n,"a","maximumStrict"),r=oe(e,"b","maximumStrict");return ir(t.shape,r.shape,"Error in maximumStrict: "),t.maximum(r)}}),NT=xe({minimum_:function(n,e){var t,r=oe(n,"a","minimum"),i=oe(e,"b","minimum");return t=Jr(r,i),r=t[0],i=t[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Mn(r.shape,i.shape),Ie.runKernelFunc((function(o,s){var a=o.minimum(r,i);return s([r,i]),a}),{a:r,b:i},(function(o,s){var a=s[0],u=s[1];return{a:function(){return o.mul(a.lessEqual(u).toFloat())},b:function(){return o.mul(a.greater(u).toFloat())}}}),"Minimum")}}),MV=xe({minimumStrict_:function(n,e){var t=oe(n,"a","minimumStrict"),r=oe(e,"b","minimumStrict");return ir(t.shape,r.shape,"Error in minimumStrict: "),t.minimum(r)}}),OV=xe({mod_:function(n,e){var t,r=oe(n,"a","mod"),i=oe(e,"b","mod");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Ie.runKernelFunc((function(s,a){var u=s.mod(r,i);return a([r,i]),u}),{$a:r,$b:i},(function(s,a){var u=a[0],l=a[1];return{$a:function(){var h=$i(u.shape,o);return h.length>0?s.sum(h).reshape(u.shape):s},$b:function(){var h=s.mul(u.div(l).floor().neg()),d=$i(l.shape,o);return d.length>0?h.sum(d).reshape(l.shape):h}}}))}}),FV=xe({modStrict_:function(n,e){var t=oe(n,"a","modStrict"),r=oe(e,"b","modStrict");return ir(t.shape,r.shape,"Error in modStrict: "),t.mod(r)}}),us=xe({mul_:function(n,e){var t,r=oe(n,"a","mul"),i=oe(e,"b","mul");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Ie.runKernelFunc((function(s,a){var u=s.multiply(r,i);return a([r,i]),u}),{a:r,b:i},(function(s,a){var u=a[0],l=a[1];return{a:function(){var h=s.mul(l.toFloat()),d=$i(u.shape,o);return d.length>0?h.sum(d).reshape(u.shape):h},b:function(){var h=s.mul(u.toFloat()),d=$i(l.shape,o);return d.length>0?h.sum(d).reshape(l.shape):h}}}),"Mul")}}),BV=xe({mulStrict_:function(n,e){var t=oe(n,"a","mul"),r=oe(e,"b","mul");return ir(t.shape,r.shape,"Error in multiplyStrict: "),t.mul(r)}}),d0=xe({pow_:function(n,e){var t,r=oe(n,"base","pow"),i=oe(e,"exp","pow");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape),s=[r,i];return Ie.runKernelFunc((function(a,u){var l=a.pow(r,i);return u([r,i,l]),l}),{a:r,b:i},(function(a,u){var l=u[0],h=u[1],d=u[2];return{a:function(){var m=h.toFloat(),p=a.mul(m.mul(l.pow(m.sub(dt(1))))),y=$i(l.shape,o);return y.length>0&&(p=p.sum(y)),p.reshape(l.shape)},b:function(){var m=l.greater(0),p=l.log().where(m,zn(l)),y=a.mul(d.mul(p)),b=$i(h.shape,o);return b.length>0&&(y=y.sum(b)),y.reshape(h.shape)}}}),"Pow",{},s,[!0])}}),VV=xe({powStrict_:function(n,e){return ir(n.shape,e.shape,"Error in powStrict: "),n.pow(e)}}),jV=xe({squaredDifferenceStrict_:function(n,e){var t=oe(n,"a","squaredDifferenceStrict"),r=oe(e,"b","squaredDifferenceStrict");return ir(t.shape,r.shape,"Error in squaredDifferenceStrict: "),t.squaredDifference(r)}}),Ki=xe({sub_:function(n,e){var t,r=oe(n,"a","sub"),i=oe(e,"b","sub");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Ie.runKernelFunc((function(s){return s.subtract(r,i)}),{a:r,b:i},(function(s){return{a:function(){var a=s,u=$i(r.shape,o);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)},b:function(){var a=s,u=$i(i.shape,o);return u.length>0&&(a=a.sum(u)),a.neg().reshape(i.shape)}}}),"Sub")}}),UV=xe({subStrict_:function(n,e){var t=oe(n,"a","subStrict"),r=oe(e,"b","subStrict");return ir(t.shape,r.shape,"Error in subStrict: "),t.sub(r)}}),RT=xe({equal_:function(n,e){var t,r=oe(n,"a","equal"),i=oe(e,"b","equal");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Ie.runKernelFunc((function(o){return o.equal(r,i)}),{$a:r,$b:i})}}),zV=xe({equalStrict_:function(n,e){var t=oe(n,"a","equalStrict"),r=oe(e,"b","equalStrict");return ir(t.shape,r.shape,"Error in equalStrict: "),t.equal(r)}}),WV=xe({greater_:function(n,e){var t,r=oe(n,"a","greater"),i=oe(e,"b","greater");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Ie.runKernelFunc((function(o){return o.greater(r,i)}),{a:r,b:i},null,"Greater")}}),PT=xe({greaterEqual_:function(n,e){var t,r=oe(n,"a","greaterEqual"),i=oe(e,"b","greaterEqual");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Ie.runKernelFunc((function(o,s){var a=o.greaterEqual(r,i);return s([r,i]),a}),{a:r,b:i},(function(o,s){var a=s[0],u=s[1];return{a:function(){return zn(a)},b:function(){return zn(u)}}}),"GreaterEqual")}}),qV=xe({greaterEqualStrict_:function(n,e){var t=oe(n,"a","greaterEqualStrict"),r=oe(e,"b","greaterEqualStrict");return ir(t.shape,r.shape,"Error in greaterEqualStrict: "),t.greaterEqual(r)}}),HV=xe({greaterStrict_:function(n,e){var t=oe(n,"a","greaterStrict"),r=oe(e,"b","greaterStrict");return ir(t.shape,r.shape,"Error in greaterStrict: "),t.greater(r)}}),GV=xe({less_:function(n,e){var t,r=oe(n,"a","less"),i=oe(e,"b","less");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Ie.runKernelFunc((function(o){return o.less(r,i)}),{a:r,b:i},null,"Less")}}),$V=xe({lessEqual_:function(n,e){var t,r=oe(n,"a","lessEqual"),i=oe(e,"b","lessEqual");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Ie.runKernelFunc((function(o,s){var a=o.lessEqual(r,i);return s([r,i]),a}),{a:r,b:i},null,"LessEqual")}}),KV=xe({lessEqualStrict_:function(n,e){var t=oe(n,"a","lessEqualStrict"),r=oe(e,"b","lessEqualStrict");return ir(t.shape,r.shape,"Error in lessEqualStrict: "),t.lessEqual(r)}}),XV=xe({lessStrict_:function(n,e){var t=oe(n,"a","lessStrict"),r=oe(e,"b","lessStrict");return ir(t.shape,r.shape,"Error in lessStrict: "),t.less(r)}}),YV=xe({notEqual_:function(n,e){var t,r=oe(n,"a","notEqual"),i=oe(e,"b","notEqual");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Ie.runKernelFunc((function(o){return o.notEqual(r,i)}),{a:r,b:i},null,"NotEqual")}}),QV=xe({notEqualStrict_:function(n,e){var t=oe(n,"a","notEqualStrict"),r=oe(e,"b","notEqualStrict");return ir(t.shape,r.shape,"Error in notEqualStrict: "),t.notEqual(r)}});function PS(n,e){for(var t=[],r=n;r<e;++r)t.push(r);return t}function DS(n){for(var e=[],t=0;t<n.length;++t)for(var r=0;r<n[t].length;++r)e.push(n[t][r]);return e}var ix=xe({gather_:function(n,e,t){t===void 0&&(t=0);var r=oe(n,"x","gather"),i=oe(e,"indices","gather","int32");t=Xi(t,r.shape)[0];var o=(function(s,a,u){for(var l=s.shape[u],h=[],d=1,m=1,p=0;p<u;p++)h.push(s.shape[p]),d*=s.shape[p];for(p=0;p<a.rank;p++)h.push(a.shape[p]);for(p=u+1;p<s.rank;p++)h.push(s.shape[p]),m*=s.shape[p];return{batchSize:d,sliceSize:m,dimSize:l,outputShape:h}})(r,i,t);return Ie.runKernelFunc((function(s,a){var u=s.gather(r,i.flatten(),t);return a([i]),u}),{x:r,indices:i},(function(s,a){var u=a[0];return{x:function(){var l=r.shape,h=u.size,d=l.slice(0,t),m=d.length,p=l.slice(t,l.length).slice(1),y=p.length,b=PS(0,m),x=PS(m+1,m+1+y),E=DS([d,[h],p]),T=s.reshape(E),P=u.reshape([h]),I=DS([[m],b,x]),D=T.transpose(I),U=DT(D,P,r.shape[t]),L=qb(I);return U=U.transpose(L)},indices:function(){return u}}}),"Gather",{axis:t}).reshape(o.outputShape)}}),DT=xe({unsortedSegmentSum_:function(n,e,t){var r=oe(n,"x","unsortedSegmentSum"),i=oe(e,"segmentIds","unsortedSegmentSum","int32");return me(xi(t),(function(){return"numSegments must be of dtype int"})),Ie.runKernelFunc((function(o,s){var a=o.unsortedSegmentSum(r,i,t);return s([i]),a}),{$x:r},(function(o,s){var a=s[0];return{$x:function(){return(function(u,l){for(var h=rx(l,zn(l)),d=ix(u,h),m=PT(l,dt(0,"int32")),p=d.rank-m.rank,y=0;y<p;++y)m=Wa(m,y+1);m=K0(m,ip(d.shape,"bool"));var b=zn(d);return cf(m,d,b)})(o,a)}}}))}}),JV=function(n,e,t){return Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d,m,p,y,b;return Rt(this,(function(x){switch(x.label){case 0:for(r=oe(n,"tensor","boolMask"),i=oe(e,"mask","boolMask","bool"),o=t??0,s=i.rank,a=r.shape,me(s>0,(function(){return"mask cannot be scalar"})),ir(a.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=o;l<o+s;l++)u*=a[l];return h=a.slice(0,o).concat([u],a.slice(o+s)),d=r.reshape(h),m=i.reshape([-1]),[4,TT(m)];case 1:return p=x.sent(),y=p.squeeze([1]),b=ix(d,y,o),n!==r&&r.dispose(),e!==i&&i.dispose(),y.dispose(),d.dispose(),m.dispose(),p.dispose(),[2,b]}}))}))};function LT(n,e,t,r,i,o,s){o===void 0&&(o="NHWC"),me(n.length===e.rank,(function(){return"Length of inShape ("+n.length+") and rank of dy ("+e.rank+") must match"}));var a=n,u=e,l=!1;e.rank===3&&(l=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),a=[1,n[0],n[1],n[2]]),me(a.length===4,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+a.length+"."})),me(u.rank===4,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),me(t.rank===4,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+t.rank}));var h=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?u.shape[3]:u.shape[1];me(h===t.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+h+") must match input depth for filter "+t.shape[2]+"."})),me(d===t.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+t.shape[3]+"."})),s!=null&&me(xi(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+i+"."}));var m=Xb(o),p=xf(a,t.shape,r,1,i,s,!1,m),y=Ie.runKernelFunc((function(b,x){var E=b.conv2dDerInput(u,t,p);return x([t,u]),E}),{dy4D:u,filter:t},(function(b,x){var E=x[0],T=x[1];return{dy4D:function(){return $a(b,E,r,i,o,1,s)},filter:function(){return ox(b,T,E.shape,r,i,o,s)}}}));return l?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}function Hy(n){var e=(function(o){return typeof o=="number"?[o,o,o]:o.length===2?[o[0],o[1],1]:o})(n),t=e[0],r=e[1],i=e[2];return t===1&&r===1&&i===1}function MT(n,e,t,r,i){me(n.length===e.rank,(function(){return"Length of inShape ("+n.length+") and rank of dy ("+e.rank+") must match"}));var o=n,s=e,a=!1;e.rank===4&&(a=!0,s=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,n[0],n[1],n[2],n[3]]);var u=o[4],l=s.shape[4];me(o.length===5,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."})),me(s.rank===5,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank})),me(t.rank===5,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+t.rank})),me(u===t.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+t.shape[3]+"."})),me(l===t.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+t.shape[4]+"."}));var h=c0(o,t.shape,r,1,i),d=Ie.runKernelFunc((function(m){return m.conv3dDerInput(s,t,h)}),{dy5D:s});return a?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var ZV=xe({conv1d_:function(n,e,t,r,i,o,s){i===void 0&&(i="NWC"),o===void 0&&(o=1);var a=oe(n,"x","conv1d"),u=oe(e,"filter","conv1d"),l=a,h=!1;a.rank===2&&(h=!0,l=a.as3D(1,a.shape[0],a.shape[1])),me(l.rank===3,(function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."})),me(u.rank===3,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),s!=null&&me(xi(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."})),me(l.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),me(Gs(t,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+t+" and dilation '"+o+"'"})),me(i==="NWC",(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),m=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),p=$a(m,d,[1,t],r,"NHWC",[1,o],s);return h?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),$a=xe({conv2d_:function(n,e,t,r,i,o,s){i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]);var a=oe(n,"x","conv2d"),u=oe(e,"filter","conv2d"),l=a,h=!1;a.rank===3&&(h=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),me(l.rank===4,(function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."})),me(u.rank===4,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),s!=null&&me(xi(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}));var d=i==="NHWC"?l.shape[3]:l.shape[1];me(d===u.shape[2],(function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."})),me(Gs(t,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"}));var m=Xb(i),p=xf(l.shape,u.shape,t,o,r,s,!1,m),y=[u,l],b=Ie.runKernelFunc((function(x,E){var T=x.conv2d(l,u,p);return E([u,l]),T}),{x:l,filter:u},(function(x,E){var T=E,P=T[0],I=T[1];return me(Hd(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"})),{x:function(){return OT(I.shape,x,P,t,r,i)},filter:function(){return ox(I,x,P.shape,t,r,i)}}}),"Conv2D",p,y);return h?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),ej=xe({conv3d_:function(n,e,t,r,i,o){i===void 0&&(i="NDHWC"),o===void 0&&(o=[1,1,1]);var s=oe(n,"x","conv3d"),a=oe(e,"filter","conv3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),me(u.rank===5,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),me(a.rank===5,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+a.rank+"."})),me(u.shape[4]===a.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+a.shape[3]+"."})),me((function(m,p){return Hy(m)||Hy(p)})(t,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"})),me(i==="NDHWC",(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var h=c0(u.shape,a.shape,t,o,r),d=Ie.runKernelFunc((function(m,p){var y=m.conv3d(u,a,h);return p([u,a]),y}),{x:u,$filter:a},(function(m,p){me(Hy(o),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}));var y=p[0],b=p[1];return{x:function(){return MT(y.shape,m,b,t,r)},$filter:function(){return(function(x,E,T,P,I){var D=x;x.rank===4&&(D=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]));var U=E;U.rank===4&&(U=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),me(D.rank===5,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+D.shape+"."})),me(U.rank===5,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+U.shape+"."})),me(T.length===5,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+T+"."})),me(D.shape[4]===T[3],(function(){return"Error in conv3dDerFilter: depth of input "+D.shape[4]+") must match input depth in filter ("+T[3]+"."})),me(U.shape[4]===T[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+U.shape[4]+") must match output depth for filter ("+T[4]+")."}));var L=c0(D.shape,T,P,1,I);return Ie.runKernelFunc((function(C){return C.conv3dDerFilter(D,U,L)}),{x5D:D,dy5D:U})})(y,m,b.shape,t,r)}}}));return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),ox=xe({conv2dDerFilter_:function(n,e,t,r,i,o,s){o===void 0&&(o="NHWC");var a=n;n.rank===3&&(a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var u=e;u.rank===3&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),me(a.rank===4,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+a.shape+"."})),me(u.rank===4,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),me(t.length===4,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+t+"."}));var l=o==="NHWC"?a.shape[3]:a.shape[1],h=o==="NHWC"?u.shape[3]:u.shape[1];me(l===t[2],(function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+t[2]+"."})),me(h===t[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+h+") must match output depth for filter ("+t[3]+")."})),s!=null&&me(xi(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+i+"."}));var d=Xb(o),m=xf(a.shape,t,r,1,i,s,!1,d);return Ie.runKernelFunc((function(p){return p.conv2dDerFilter(a,u,m)}),{x4D:a,dy4D:u})}}),OT=xe({conv2dDerInput_:LT}),X0=xe({depthwiseConv2d_:function(n,e,t,r,i,o,s){o===void 0&&(o=[1,1]);var a=oe(n,"x","depthwiseConv2d"),u=oe(e,"filter","depthwiseConv2d"),l=a,h=!1;a.rank===3&&(h=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),me(l.rank===4,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."})),me(u.rank===4,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),me(l.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),o==null&&(o=[1,1]),me(Gs(t,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"})),s!=null&&me(xi(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}));var d=xf(l.shape,u.shape,t,o,r,s,!0),m=[l,u],p=Ie.runKernelFunc((function(y,b){var x=y.depthwiseConv2D(l,u,d);return b([l,u]),x}),{x:l,filter:u},(function(y,b){me(Hd(o),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var x=b[0],E=b[1];return{x:function(){return FT(x.shape,y,E,d)},filter:function(){return BT(x,y,E.shape,d)}}}),"DepthwiseConv2dNative",d,m);return h?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),FT=xe({depthwiseConv2dDerInput_:function(n,e,t,r){var i=e,o=!1;e.rank===3&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var s=Ie.runKernelFunc((function(a){return a.depthwiseConv2DDerInput(i,t,r)}),{dy4D:i});return o?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),BT=xe({depthwiseConv2dDerFilter_:function(n,e,t,r){var i=n;n.rank===3&&(i=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var o=e;return o.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),Ie.runKernelFunc((function(s){return s.depthwiseConv2DDerFilter(i,o,r)}),{x4D:i,dy4D:o})}}),sx=xe({separableConv2d_:function(n,e,t,r,i,o,s){o===void 0&&(o=[1,1]),s===void 0&&(s="NHWC");var a=oe(n,"x","separableConv2d"),u=oe(e,"depthwiseFilter","separableConv2d"),l=oe(t,"pointwiseFilter","separableConv2d"),h=a,d=!1;if(a.rank===3&&(d=!0,h=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");me(h.rank===4,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+h.rank+"."})),me(u.rank===4,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),me(l.rank===4,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),me(l.shape[0]===1,(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."})),me(l.shape[1]===1,(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."}));var m=u.shape[2],p=u.shape[3];me(l.shape[2]===m*p,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+m*p+", but got "+l.shape[2]+"."}));var y=X0(h,u,r,i,s,o),b=$a(y,l,1,"valid",s);return d?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),tj=xe({conv2dTranspose_:function(n,e,t,r,i,o){return LT(t,oe(n,"x","conv2dTranspose"),oe(e,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),nj=xe({conv3dTranspose_:function(n,e,t,r,i){return MT(t,oe(n,"x","conv3dTranspose"),oe(e,"filter","conv3dTranspose"),r,i)}}),Y0=xe({matMul_:function(n,e,t,r){var i;t===void 0&&(t=!1),r===void 0&&(r=!1);var o=oe(n,"a","matMul"),s=oe(e,"b","matMul");i=Jr(o,s),o=i[0],s=i[1];var a=t?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?s.shape[s.rank-1]:s.shape[s.rank-2],l=t?o.shape[o.rank-1]:o.shape[o.rank-2],h=r?s.shape[s.rank-2]:s.shape[s.rank-1],d=o.shape.slice(0,-2),m=s.shape.slice(0,-2),p=Mt(d),y=Mt(m);me(o.rank>=2&&s.rank>=2&&o.rank===s.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+s.rank+"."})),me(po(d,m),(function(){return"Error in matMul: outer dimensions ("+d+") and ("+m+") of Tensors with shapes "+o.shape+" and "+s.shape+" must match."})),me(a===u,(function(){return"Error in matMul: inner shapes ("+a+") and ("+u+") of Tensors with shapes "+o.shape+" and "+s.shape+" and transposeA="+t+" and transposeB="+r+" must match."}));var b=o.shape.slice(0,-2).concat([l,h]),x=t?o.as3D(p,a,l):o.as3D(p,l,a),E=r?s.as3D(y,h,u):s.as3D(y,u,h),T={transposeA:t,transposeB:r};return Ie.runKernelFunc((function(P,I){var D=P.batchMatMul(x,E,t,r);return I([x,E]),D}),{a:x,b:E},(function(P,I){var D=I,U=D[0],L=D[1];return t||r?!t&&r?{a:function(){return P.matMul(L,!1,!1)},b:function(){return P.matMul(U,!0,!1)}}:t&&!r?{a:function(){return L.matMul(P,!1,!0)},b:function(){return U.matMul(P,!1,!1)}}:{a:function(){return L.matMul(P,!0,!0)},b:function(){return P.matMul(U,!0,!0)}}:{a:function(){return P.matMul(L,!1,!0)},b:function(){return U.matMul(P,!0,!1)}}}),"BatchMatMul",T).reshape(b)}}),rj=xe({dot_:function(n,e){var t=oe(n,"t1","dot"),r=oe(e,"t2","dot");me(!(t.rank!==1&&t.rank!==2||r.rank!==1&&r.rank!==2),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+t.rank+" and "+r.rank+"."}));var i=t.rank===1?t.size:t.shape[1],o=r.rank===1?r.size:r.shape[0];return me(i===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."})),t.rank===1&&r.rank===1?t.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():t.rank===1&&r.rank===2?t.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():t.rank===2&&r.rank===1?t.matMul(r.as2D(-1,1)).as1D():t.matMul(r.as2D(r.shape[0],r.shape[1]))}}),ij=xe({outerProduct_:function(n,e){var t=oe(n,"v1","outerProduct"),r=oe(e,"v2","outerProduct");return me(t.rank===1&&r.rank===1,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+t.rank+" and "+r.rank+"."})),t.as2D(-1,1).matMul(r.as2D(1,-1))}}),$m=xe({reverse_:function(n,e){var t=oe(n,"x","reverse");if(t.rank===0)return t.clone();var r=Xi(e,t.shape);return Ie.runKernelFunc((function(i){return i.reverse(t,r)}),{$x:t},(function(i){return{$x:function(){return i.reverse(r)}}})).reshapeAs(t)}}),oj=xe({reverse1d_:function(n){var e=oe(n,"x","reverse");return me(e.rank===1,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),$m(e,0)}}),sj=xe({reverse2d_:function(n,e){var t=oe(n,"x","reverse");return me(t.rank===2,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+t.rank+"."})),$m(t,e)}}),aj=xe({reverse3d_:function(n,e){var t=oe(n,"x","reverse");return me(t.rank===3,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+t.rank+"."})),$m(t,e)}}),uj=xe({reverse4d_:function(n,e){var t=oe(n,"x","reverse");return me(t.rank===4,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+t.rank+"."})),$m(t,e)}});function VT(n,e,t,r,i,o){var s=oe(n,"x","maxPool"),a=s,u=!1;s.rank===3&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),me(a.rank===4,(function(){return"Error in maxPool: input must be rank 4 but got rank "+a.rank+"."})),me(Gs(t,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"})),o!=null&&me(xi(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var l=Em(a.shape,e,t,r,i,o);if(l.filterWidth===1&&l.filterHeight===1&&po(l.inShape,l.outShape))return s.clone();var h=[a],d=Ie.runKernelFunc((function(m,p){var y=m.maxPool(a,l);return p([a,y]),y}),{x:a},(function(m,p){var y=p[0],b=p[1];return{x:function(){return(function(x,E,T,P,I,D,U,L){var C=oe(x,"dy","maxPoolBackprop"),A=oe(E,"input","maxPoolBackprop"),M=oe(T,"output","maxPoolBackprop");me(A.rank===C.rank,(function(){return"Rank of input ("+A.rank+") does not match rank of dy ("+C.rank+")"})),me(Gs(I,D),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+I+" and dilations '"+D+"'"})),me(C.rank===4,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+C.rank+"."})),me(A.rank===4,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+A.rank+"."}));var k=Em(A.shape,P,I,D,U,L);return Ie.runKernelFunc((function(O){return O.maxPoolBackprop(C,A,M,k)}),{$dy:C,$input:A})})(m,y,b,e,t,r,i)}}}),"MaxPool",l,h);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function jT(n,e,t,r,i,o){var s=oe(n,"x","avgPool","float32");me(Gs(t,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"}));var a=s,u=!1;s.rank===3&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),me(a.rank===4,(function(){return"Error in avgPool: x must be rank 4 but got rank "+a.rank+"."})),o!=null&&me(xi(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var l=Em(a.shape,e,t,r,i,o);if(l.filterWidth===1&&l.filterHeight===1&&po(l.inShape,l.outShape))return s.clone();var h=Ie.runKernelFunc((function(d){return d.avgPool(a,l)}),{x:a},(function(d){return{x:function(){return(function(m,p,y,b,x,E){var T=oe(m,"dy","avgPoolBackprop"),P=oe(p,"input","avgPoolBackprop");me(P.rank===T.rank,(function(){return"Rank of input ("+P.rank+") does not match rank of dy ("+T.rank+")"})),me(Gs(b,x),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+x+"'"}));var I=P,D=T,U=!1;P.rank===3&&(U=!0,I=P.as4D(1,P.shape[0],P.shape[1],P.shape[2]),D=T.as4D(1,T.shape[0],T.shape[1],T.shape[2])),me(D.rank===4,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+D.rank+"."})),me(I.rank===4,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+I.rank+"."}));var L=Em(I.shape,y,b,x,E),C=Ie.runKernelFunc((function(A){return A.avgPoolBackprop(D,I,L)}),{dy4D:D,input4D:I});return U?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C})(d,a,e,t,r,i)}}}),"AvgPool",l);return h=h.cast(s.dtype),u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}var co=xe({maxPool_:function(n,e,t,r,i){return VT(n,e,t,1,r,i)}}),Km=xe({avgPool_:function(n,e,t,r,i){return jT(n,e,t,1,r,i)}}),lj=xe({pool_:function(n,e,t,r,i,o){i==null&&(i=[1,1]),o==null&&(o=1),r===0&&(r="valid");var s=oe(n,"x","maxPool"),a=s,u=!1;s.rank===3&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),me(Gs(o,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"}));var l,h=Em(a.shape,e,o,i,r),d=[h.dilationHeight,h.dilationWidth];l=r==="same"?(function(I,D){var U=I.map((function(A,M){return A+(A-1)*(D[M]-1)})).map((function(A){return A-1})),L=U.map((function(A){return Math.floor(A/2)})),C=U.map((function(A,M){return A-L[M]}));return U.map((function(A,M){return[L[M],C[M]]}))})([h.filterHeight,h.filterWidth],d):[[0,0],[0,0]];var m=d[0]===1&&d[1]===1,p=(function(I,D,U){var L=U.map((function(X){return X[0]})),C=U.map((function(X){return X[1]})),A=I.concat(L,C),M=D.map((function(X,ue){return(X-A[ue]%X)%X})),k=C.map((function(X,ue){return X+M[ue]})),O=D.map((function(X,ue){return[L[ue],k[ue]]})),j=D.map((function(X,ue){return[0,M[ue]]}));return[O,j]})([h.inHeight,h.inWidth],d,l),y=p[0],b=p[1],x=m?r:"valid",E=m?a:GI(a,d,y),T=(t==="avg"?function(){return jT(E,e,o,1,x)}:function(){return VT(E,e,o,1,x)})(),P=m?T:WI(T,d,b);return u?P.as3D(P.shape[1],P.shape[2],P.shape[3]):P}}),cj=xe({maxPool3d_:function(n,e,t,r,i,o,s){o===void 0&&(o="NDHWC");var a=oe(n,"x","maxPool3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),s==null&&(s=[1,1,1]),me(u.rank===5,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),me(o==="NDHWC",(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),me(Gs(t,s),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"})),i!=null&&me(xi(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var h=l0(u.shape,e,t,s,r,i,o),d=Ie.runKernelFunc((function(m,p){var y=m.maxPool3d(u,h);return p([u,y]),y}),{x:u},(function(m,p){var y=p[0],b=p[1];return{x:function(){return(function(x,E,T,P,I,D,U,L){var C=oe(x,"dy","maxPool3dBackprop"),A=oe(E,"input","maxPool3dBackprop"),M=oe(T,"output","maxPool3dBackprop"),k=C,O=A,j=M,X=!1;A.rank===4&&(X=!0,k=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),O=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3]),j=M.as5D(1,M.shape[0],M.shape[1],M.shape[2],M.shape[3])),me(k.rank===5,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+k.rank+"."})),me(O.rank===5,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+O.rank+"."})),me(j.rank===5,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+j.rank+"."})),D==null&&(D=[1,1,1]),me(Gs(I,D),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+I+" and dilations '"+D+"'"})),L!=null&&me(xi(U),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+L+" but got pad "+U+"."}));var ue=l0(O.shape,P,I,D,U,L),ge=Ie.runKernelFunc((function(he){return he.maxPool3dBackprop(k,O,j,ue)}),{dy5D:k,input5D:O});return X?ge.as4D(ge.shape[1],ge.shape[2],ge.shape[3],ge.shape[4]):ge})(m,y,b,e,t,s,r,i)}}}));return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),hj=xe({avgPool3d_:function(n,e,t,r,i,o,s){o===void 0&&(o="NDHWC");var a=oe(n,"x","avgPool3d","float32"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),s==null&&(s=[1,1,1]),me(u.rank===5,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),me(o==="NDHWC",(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),me(Gs(t,s),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"})),i!=null&&me(xi(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var h=l0(u.shape,e,t,s,r,i,o),d=Ie.runKernelFunc((function(m){return m.avgPool3d(u,h)}),{x:u},(function(m){return{x:function(){return(function(p,y,b,x,E,T,P){var I=oe(p,"dy","avgPool3dBackprop"),D=oe(y,"input","avgPool3dBackprop"),U=I,L=D,C=!1;D.rank===4&&(C=!0,U=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3]),L=D.as5D(1,D.shape[0],D.shape[1],D.shape[2],D.shape[3])),me(U.rank===5,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+U.rank+"."})),me(L.rank===5,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+L.rank+"."})),E==null&&(E=[1,1,1]),me(Gs(x,E),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+E+"'"})),P!=null&&me(xi(T),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+P+" but got pad "+T+"."}));var A=l0(L.shape,b,x,E,T,P),M=Ie.runKernelFunc((function(k){return k.avgPool3dBackprop(U,L,A)}),{dy5D:U,input5D:L});return C?M.as4D(M.shape[1],M.shape[2],M.shape[3],M.shape[4]):M})(m,u,e,t,s,r,i)}}}));return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),pl=xe({slice_:function(n,e,t){var r,i,o=oe(n,"x","slice");if(o.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof e=="number"?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice()).forEach((function(u){me(u!==-1,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=t==null?new Array(o.rank).fill(-1):typeof t=="number"?[t].concat(new Array(o.rank-1).fill(-1)):t.length<o.rank?t.concat(new Array(o.rank-t.length).fill(-1)):t).map((function(u,l){return u>=0?u:(me(u===-1,(function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."})),o.shape[l]-r[l])})),V8(o,r,i);var s=o.shape,a={begin:r,size:i};return Ie.runKernelFunc((function(u){return u.slice(o,r,i)}),{x:o},(function(u){for(var l=[],h=0;h<u.rank;h++)l.push([r[h],s[h]-r[h]-i[h]]);return{x:function(){return u.pad(l)}}}),"Slice",a)}}),fj=xe({slice1d_:function(n,e,t){var r=oe(n,"x","slice1d");return me(r.rank===1,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),pl(r,[e],[t])}}),dj=xe({slice2d_:function(n,e,t){var r=oe(n,"x","slice2d");return me(r.rank===2,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),pl(r,e,t)}}),UT=xe({slice3d_:function(n,e,t){var r=oe(n,"x","slice3d");return me(r.rank===3,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),pl(r,e,t)}}),pj=xe({slice4d_:function(n,e,t){var r=oe(n,"x","slice4d");return me(r.rank===4,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),pl(r,e,t)}});function zT(n,e,t,r,i){return e.rank<t.rank&&(e=e.reshape(Hs(e.shape,r))),n.rank<t.rank&&(n=n.reshape(Hs(n.shape,r))),{x:function(){var o=n.mul(t.equal(e).cast(n.dtype));return i==null?o:o.transpose(i)}}}var mj=xe({all_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","all","bool"),i=Xi(e,r.shape),o=i,s=yl(o,r.rank);s!=null&&(r=r.transpose(s),o=wl(o.length,r.rank));var a=Ie.runKernelFunc((function(l){return l.all(r,o)}),{$x:r});if(t){var u=Hs(a.shape,i);return a.reshape(u)}return a}}),gj=xe({any_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","any","bool"),i=Xi(e,r.shape),o=i,s=yl(o,r.rank);s!=null&&(r=r.transpose(s),o=wl(o.length,r.rank));var a=Ie.runKernelFunc((function(l){return l.any(r,o)}),{$x:r});if(t){var u=Hs(a.shape,i);return a.reshape(u)}return a}}),vj=xe({argMax_:function(n,e){e===void 0&&(e=0);var t=oe(n,"x","argMax");e==null&&(e=0);var r=Xi(e,t.shape),i=yl(r,t.rank);i!=null&&(t=t.transpose(i),r=wl(r.length,t.rank));var o={axis:r[0]},s=[t];return Ie.runKernelFunc((function(a,u){var l=a.argMax(t,r[0]);return u([t]),l}),{x:t},(function(a,u){var l=u[0];return{x:function(){return zn(l)}}}),"ArgMax",o,s)}}),yj=xe({argMin_:function(n,e){e===void 0&&(e=0);var t=oe(n,"x","argMin");e==null&&(e=0);var r=Xi(e,t.shape),i=yl(r,t.rank);return i!=null&&(t=t.transpose(i),r=wl(r.length,t.rank)),Ie.runKernelFunc((function(o,s){var a=o.argMin(t,r[0]);return s([t]),a}),{$x:t},(function(o,s){var a=s[0];return{$x:function(){return zn(a)}}}))}}),wj=xe({logSumExp_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","logSumExp"),i=Xi(e,r.shape),o=r.max(i,!0),s=r.sub(o).exp().sum(i).log(),a=o.reshape(s.shape).add(s);if(t){var u=Hs(a.shape,i);return a.reshape(u)}return a}}),Q0=xe({max_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","max"),i=r,o=Xi(e,r.shape),s=o,a=yl(s,r.rank);a!=null&&(r=r.transpose(a),s=wl(s.length,r.rank));var u=[r],l=Ie.runKernelFunc((function(d,m){var p=d.max(r,s);return m([i,p]),p}),{x:r},(function(d,m){return zT(d,m[1],m[0],o,a)}),"Max",{axes:s},u,[!0]);if(t){var h=Hs(l.shape,o);l=l.reshape(h)}return l}}),bj=xe({mean_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","mean"),i=Xi(e,r.shape),o=Mt(ts(r.shape,i)[1]);return G0((function(s){var a=dt(o);return{value:(a.dtype===s.dtype?s:s.cast(a.dtype)).div(a).sum(e,t),gradFunc:function(u){var l=s.shape.slice();return i.forEach((function(h){l[h]=1})),u.reshape(l).mul(ip(s.shape,"float32")).div(o)}}}))(r)}}),xj=xe({min_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","min"),i=r,o=Xi(e,r.shape),s=o,a=yl(s,r.rank);a!=null&&(r=r.transpose(a),s=wl(s.length,r.rank));var u=[r],l=Ie.runKernelFunc((function(d,m){var p=d.min(r,s);return m([i,p]),p}),{x:r},(function(d,m){return zT(d,m[1],m[0],o,a)}),"Min",{axes:s},u,[!0]);if(t){var h=Hs(l.shape,o);l=l.reshape(h)}return l}}),_j=xe({moments_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Xi(e,(n=oe(n,"x","moments")).shape),i=n.mean(r,t),o=i.shape;t||(o=Hs(i.shape,r));var s=n.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:s.mean(r,t)}}}),WT=xe({sum_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=Xi(e,r.shape);return G0((function(o){var s=yl(i,o.rank),a=i,u=o;s!=null&&(u=o.transpose(s),a=wl(a.length,o.rank));var l=function(p){var y=o.shape.slice();return i.forEach((function(b){y[b]=1})),p.reshape(y).mul(ip(o.shape,"float32"))},h={axes:a},d=Ie.runKernelFunc((function(p){return p.sum(u,a)}),{x:u},(function(p){return{x:function(){return l(p)}}}),"Sum",h);if(t){var m=Hs(d.shape,i);d=d.reshape(m)}return{value:d,gradFunc:l}}))(r)}}),Ej=xe({prod_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=Xi(e,r.shape),o=yl(i,r.rank),s=i,a=r;o!=null&&(a=r.transpose(o),s=wl(s.length,r.rank));var u=Ie.runKernelFunc((function(h){return h.prod(a,s)}),{permutedX:a});if(t){var l=Hs(u.shape,i);u=u.reshape(l)}return u}}),qT=xe({elu_:function(n){var e=oe(n,"x","elu");return Ie.runKernelFunc((function(t,r){var i=t.elu(e);return r([i]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return Ie.runKernelFunc((function(o){return o.eluDer(t,i)}),{dy:t,y:i})}}}))}}),Sj=xe({leakyRelu_:function(n,e){e===void 0&&(e=.2);var t=oe(n,"x","leakyRelu");return rx(dt(e).mul(t),t)}}),HT=xe({prelu_:function(n,e){var t=oe(n,"x","prelu"),r=oe(e,"alpha","prelu");return Ie.runKernelFunc((function(i,o){var s=i.prelu(t,r);return o([t,r]),s}),{x:t,alpha:r},(function(i,o){var s=o[0],a=o[1],u=s.greater(0);return{x:function(){return cf(u,i,i.mul(a))},alpha:function(){var l=cf(u,zn(i),i.mul(s)),h=$i(a.shape,i.shape);return h.length>0&&(l=l.sum(h)),l.reshape(a.shape)}}}),"Prelu")}}),Yr=xe({relu_:function(n){var e=oe(n,"x","relu");return e.dtype==="bool"?e.toInt():Ie.runKernelFunc((function(t,r){var i=t.relu(e);return r([e]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return t.mulStrict(i.step().toFloat())}}}),"Relu")}}),GT=xe({relu6_:function(n){var e=oe(n,"x","relu6");return e.dtype==="bool"?e.toInt():Ie.runKernelFunc((function(t,r){var i=t.relu6(e);return r([e]),i}),{x:e},(function(t,r){var i=r[0],o=i.lessEqual(6).mul(i.step());return{x:function(){return t.mulStrict(o.toFloat())}}}),"Relu6")}}),Aj=xe({selu_:function(n){var e=oe(n,"x","selu");return Ie.runKernelFunc((function(t,r){var i=t.selu(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){var o=i.greater(dt(0)),s=dt(ex),a=dt(tx),u=t.mul(a),l=t.mul(s).mul(i.toFloat().exp());return cf(o,u,l)}}}))}}),uh=xe({transpose_:function(n,e){var t=oe(n,"x","transpose");if(e==null&&(e=t.shape.map((function(i,o){return o})).reverse()),me(t.rank===e.length,(function(){return"Error in transpose: rank of input "+t.rank+" must match length of perm "+e+"."})),e.forEach((function(i){me(i>=0&&i<t.rank,(function(){return"All entries in 'perm' must be between 0 and "+(t.rank-1)+" but got "+e}))})),t.rank<=1)return t.clone();var r={perm:e};return Ie.runKernelFunc((function(i){return i.transpose(t,e)}),{x:t},(function(i){var o=qb(e);return{x:function(){return i.transpose(o)}}}),"Transpose",r)}}),Cj=xe({localResponseNormalization_:function(n,e,t,r,i){e===void 0&&(e=5),t===void 0&&(t=1),r===void 0&&(r=1),i===void 0&&(i=.5);var o=oe(n,"x","localResponseNormalization");me(o.rank===4||o.rank===3,(function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+o.rank+"."})),me(xi(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var s=o,a=!1;o.rank===3&&(a=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=Ie.runKernelFunc((function(l,h){var d=l.localResponseNormalization4D(s,e,t,r,i);return h([s,d]),d}),{x4D:s},(function(l,h){var d=h[0],m=h[1];return{x4D:function(){return Ie.runKernelFunc((function(p){return p.LRNGrad(l,d,m,e,t,r,i)}),{})}}}));return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),$T=xe({norm_:function(n,e,t,r){e===void 0&&(e="euclidean"),t===void 0&&(t=null),r===void 0&&(r=!1);var i=(function a(u,l,h){if(h===void 0&&(h=null),u.rank===0)return u.abs();if(u.rank!==1&&h===null)return a(u.reshape([-1]),l,h);if(u.rank===1||typeof h=="number"||Array.isArray(h)&&h.length===1){if(l===1)return u.abs().sum(h);if(l===1/0)return u.abs().max(h);if(l===-1/0)return u.abs().min(h);if(l==="euclidean"||l===2)return u.abs().pow(dt(2,"int32")).sum(h).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(h)&&h.length===2){if(l===1)return u.abs().sum(h[0]).max(h[1]-1);if(l===1/0)return u.abs().sum(h[1]).max(h[0]);if(l===-1/0)return u.abs().sum(h[1]).min(h[0]);if(l==="fro"||l==="euclidean")return u.square().sum(h).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+h)})(n=oe(n,"x","norm"),e,t),o=i.shape;if(r){var s=Xi(t,n.shape);o=Hs(i.shape,s)}return i.reshape(o)}}),Ij=xe({basicLSTMCell_:function(n,e,t,r,i,o){var s=oe(n,"forgetBias","basicLSTMCell"),a=oe(e,"lstmKernel","basicLSTMCell"),u=oe(t,"lstmBias","basicLSTMCell"),l=oe(r,"data","basicLSTMCell"),h=oe(i,"c","basicLSTMCell"),d=oe(o,"h","basicLSTMCell"),m=l.concat(d,1).matMul(a).add(u),p=m.shape[0],y=m.shape[1]/4,b=[p,y],x=m.slice([0,0],b),E=m.slice([0,y],b),T=m.slice([0,2*y],b),P=m.slice([0,3*y],b),I=x.sigmoid().mulStrict(E.tanh()).addStrict(h.mulStrict(s.add(T).sigmoid())),D=I.tanh().mulStrict(P.sigmoid());return[I,D]}}),Tj=xe({multiRNNCell_:function(n,e,t,r){for(var i=oe(e,"data","multiRNNCell"),o=r0(t,"c","multiRNNCell"),s=r0(r,"h","multiRNNCell"),a=i,u=[],l=0;l<n.length;l++){var h=n[l](a,o[l],s[l]);u.push(h[0]),u.push(h[1]),a=h[1]}var d=[],m=[];for(l=0;l<u.length;l+=2)d.push(u[l]),m.push(u[l+1]);return[d,m]}}),kj=xe({movingAverage_:function(n,e,t,r,i){i===void 0&&(i=!0);var o=oe(n,"v","movingAverage"),s=oe(e,"x","movingAverage"),a=oe(t,"decay","movingAverage");CF(o,s),me(po(o.shape,s.shape),(function(){return"Shape mismatch in v and x"}));var u=dt(1),l=u.sub(a),h=s.sub(o).mul(l);if(i){me(r!=null,(function(){return"When using zeroDebias: true, step is required."}));var d=oe(r,"step","movingAverage");h=h.div(u.sub(d0(a,d)))}return o.add(h)}}),Nj=xe({stridedSlice_:function(n,e,t,r,i,o,s,a,u){if(i===void 0&&(i=0),o===void 0&&(o=0),s===void 0&&(s=0),a===void 0&&(a=0),u===void 0&&(u=0),r==null&&(r=new Array(e.length)),s!==0)throw new Error("ellipsis mask is not yet supported");var l=oe(n,"x","stridedSlice"),h=fS(a),d=l.shape.slice();h.forEach((function(x){e[x]=0,t[x]=1,d.splice(x,0,1)})),l=l.reshape(d);for(var m=0;m<l.rank;m++)e[m]=j8(i,e,r,l.shape,m),t[m]=U8(o,t,r,l.shape,m),r[m]=r[m]||1;var p=fS(u);p.forEach((function(x){t[x]=e[x]+1,r[x]=1}));var y=Kb(e,t,r),b=y.filter((function(x,E){return p.indexOf(E)===-1}));return r.every((function(x){return x===1}))?pl(l,e,y).reshape(b):Ie.runKernelFunc((function(x){return x.stridedSlice(l,e,t,r)}),{$x:l}).reshape(b)}}),Rj=xe({topk_:function(n,e,t){e===void 0&&(e=1),t===void 0&&(t=!0);var r=oe(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=Ie.runKernelFunc((function(s){return s.topk(r,e,t)}),{$x:r});return{values:o[0],indices:o[1]}}}),Pj=xe({scatterND_:function(n,e,t){var r=oe(n,"indices","scatterND","int32"),i=oe(e,"updates","scatterND");return B8(i,r,t),Ie.runKernelFunc((function(o){return o.scatterND(r,i,t)}),{indices:r,updates:i},null,"ScatterNd",{shape:t})}}),ax=xe({fft_:function(n){me(n.dtype==="complex64",(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+n.dtype+"."}));var e=n.shape[n.shape.length-1],t=n.size/e,r=n.as2D(t,e);return Ie.runKernelFunc((function(i){return i.fft(r)}),{input:n}).reshape(n.shape)}}),p0=xe({ifft_:function(n){me(n.dtype==="complex64",(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+n.dtype+"."}));var e=n.shape[n.shape.length-1],t=n.size/e,r=n.as2D(t,e);return Ie.runKernelFunc((function(i){return i.ifft(r)}),{input:n}).reshape(n.shape)}}),ux=xe({rfft_:function(n,e){me(n.dtype==="float32",(function(){return"The dtype for rfft() must be real value but got "+n.dtype}));var t,r=n.shape[n.shape.length-1],i=n.size/r;if(e!=null&&e<r){var o=n.shape.map((function(E){return 0})),s=n.shape.map((function(E){return E}));s[n.shape.length-1]=e,t=n.slice(o,s),r=e}else if(e!=null&&e>r){var a=n.shape.map((function(E){return E}));a[n.shape.length-1]=e-r,t=n.concat(Tr(a),n.shape.length-1),r=e}else t=n;var u=t.zerosLike(),l=ko(t,u).as2D(i,r),h=ax(l),d=Math.floor(r/2)+1,m=qa(h),p=tl(h),y=m.split([d,r-d],m.shape.length-1),b=p.split([d,r-d],p.shape.length-1),x=t.shape.slice();return x[t.shape.length-1]=d,ko(y[0],b[0]).reshape(x)}}),KT=xe({irfft_:function(n){var e=n.shape[n.shape.length-1],t=n.size/e;if(e<=2){var r=n.as2D(t,e),i=p0(r);return qa(i)}var o=[t,2*(e-1)],s=qa(n).as2D(t,e),a=tl(n).as2D(t,e),u=s.slice([0,1],[t,e-2]).reverse(1),l=a.slice([0,1],[t,e-2]).reverse(1).mul(dt(-1)),h=s.concat(u,1),d=a.concat(l,1);return r=ko(h,d).as2D(o[0],o[1]),i=p0(r),qa(i)}}),Dj=Object.freeze({fft:ax,ifft:p0,rfft:ux,irfft:KT}),Lj=xe({sparseToDense_:function(n,e,t,r){r===void 0&&(r=0);var i=oe(n,"sparseIndices","sparseToDense","int32"),o=oe(e,"sparseValues","sparseToDense"),s=oe(r,"defaultValue","sparseToDense",o.dtype);return(function(a,u,l,h){if(a.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+a.dtype+".");if(a.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+a.shape+".");var d=a.rank>0?a.shape[0]:1,m=a.rank>1?a.shape[1]:1;if(l.length!==m)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+m+".");var p=u.size;if(u.rank!==0&&(u.rank!==1||p!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==h.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")})(i,o,t,s),Ie.runKernelFunc((function(a){return a.sparseToDense(i,o,t,s)}),{$sparseIndices:i,$sparseValues:o,$defaultValue:s})}}),Mj=xe({gatherND_:function(n,e){var t=oe(e,"indices","gatherND","int32"),r=oe(n,"x","gatherND");return Ie.runKernelFunc((function(i){return i.gatherND(r,t)}),{x:r,indices:t},null,"GatherNd")}}),Oj=xe({diag_:function(n){var e=oe(n,"x","diag").flatten(),t=n.shape.concat(n.shape);return Ie.runKernelFunc((function(r){return r.diag(e)}),{$x:e}).reshape(t)}}),Fj=xe({dropout_:function(n,e,t,r){var i=oe(n,"x","dropout");if(me(i.dtype==="float32",(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."})),me(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),e===0)return n instanceof $r?i.clone():i;var o=(function(u,l){if(l==null)return u.shape.slice();if(po(u.shape,l))return l;if(u.shape.length===l.length){for(var h=[],d=0;d<u.shape.length;d++)l[d]==null&&u.shape[d]!=null?h.push(u.shape[d]):h.push(l[d]);return h}return l})(i,t),s=1-e,a=HI(o,0,1,"float32",r).add(s).floor().div(s);return i.mul(a)}});function XT(n,e,t){for(var r=1-n%2,i=new Float32Array(n),o=0;o<n;++o){var s=2*Math.PI*o/(n+r-1);i[o]=e-t*Math.cos(s)}return Di(i,"float32")}var lx=xe({hannWindow_:function(n){return XT(n,.5,.5)}}),YT=xe({hammingWindow_:function(n){return XT(n,.54,.46)}}),cx=xe({frame_:function(n,e,t,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var o=0,s=[];o+e<=n.size;)s.push(pl(n,o,e)),o+=t;if(r)for(;o<n.size;){var a=o+e-n.size,u=qi([pl(n,o,e-a),cl([a],i)]);s.push(u),o+=t}return s.length===0?Yc([],[0,e]):qi(s).as2D(s.length,e)}}),QT=xe({stft_:function(n,e,t,r,i){var o;i===void 0&&(i=lx),r==null&&(o=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var s=cx(n,e,t),a=us(s,i(e)),u=[],l=0;l<s.shape[0];l++)u.push(ux(a.slice([l,0],[1,e]),r));return qi(u)}}),Bj=Object.freeze({hannWindow:lx,hammingWindow:YT,frame:cx,stft:QT}),ss,Vj=function(n,e,t){return t===void 0&&(t=1),Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d,m,p,y,b,x;return Rt(this,(function(E){switch(E.label){case 0:return r=oe(n,"predictions","inTopK"),i=oe(e,"targets","inTopK"),me(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),me(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank})),ir(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],me(t>0&&t<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+t})),[4,r.data()];case 1:return s=E.sent(),[4,i.data()];case 2:for(a=E.sent(),u=[s.length/o,o],h=u[1],d=bm("bool",l=u[0]),m=0;m<l;m++){for(p=m*h,y=s.subarray(p,p+h),b=[],x=0;x<y.length;x++)b.push({value:y[x],index:x});for(b.sort((function(T,P){return P.value-T.value})),d[m]=0,x=0;x<t;x++)if(b[x].index===a[m]){d[m]=1;break}}return n!==r&&r.dispose(),e!==i&&i.dispose(),[2,Po(d,i.shape,"bool")]}}))}))};(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(ss||(ss={}));var jj=xe({absoluteDifference_:function(n,e,t,r){r===void 0&&(r=ss.SUM_BY_NONZERO_WEIGHTS);var i=oe(n,"labels","absoluteDifference"),o=oe(e,"predictions","absoluteDifference"),s=null;t!=null&&(s=oe(t,"weights","absoluteDifference")),ir(i.shape,o.shape,"Error in absoluteDifference: ");var a=i.sub(o).abs();return oc(a,s,r)}}),oc=xe({computeWeightedLoss_:function(n,e,t){t===void 0&&(t=ss.SUM_BY_NONZERO_WEIGHTS);var r=oe(n,"losses","computeWeightedLoss"),i=null;e!=null&&(i=oe(e,"weights","computeWeightedLoss"));var o=i==null?r:r.mul(i);if(t===ss.NONE)return o;if(t===ss.SUM)return o.sum();if(t===ss.MEAN){if(i==null)return o.mean();var s=r.size/i.size,a=o.sum().div(i.sum());return s>1?a.div(dt(s)):a}if(t===ss.SUM_BY_NONZERO_WEIGHTS){if(i==null)return o.sum().div(dt(r.size));var u=i.mul(ip(r.shape)).notEqual(dt(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+t)}}),Uj=xe({cosineDistance_:function(n,e,t,r,i){i===void 0&&(i=ss.SUM_BY_NONZERO_WEIGHTS);var o=oe(n,"labels","cosineDistance"),s=oe(e,"predictions","cosineDistance"),a=null;r!=null&&(a=oe(r,"weights","cosineDistance")),ir(o.shape,s.shape,"Error in cosineDistance: ");var u=dt(1).sub(o.mul(s).sum(t,!0));return oc(u,a,i)}}),zj=xe({hingeLoss_:function(n,e,t,r){r===void 0&&(r=ss.SUM_BY_NONZERO_WEIGHTS);var i=oe(n,"labels","hingeLoss"),o=oe(e,"predictions","hingeLoss"),s=null;t!=null&&(s=oe(t,"weights","hingeLoss")),ir(i.shape,o.shape,"Error in hingeLoss: ");var a=dt(1);i=dt(2).mul(i).sub(a);var u=a.sub(i.mul(o)).relu();return oc(u,s,r)}}),Wj=xe({huberLoss_:function(n,e,t,r,i){r===void 0&&(r=1),i===void 0&&(i=ss.SUM_BY_NONZERO_WEIGHTS);var o=oe(n,"labels","huberLoss"),s=oe(e,"predictions","huberLoss"),a=null;t!=null&&(a=oe(t,"weights","huberLoss")),ir(o.shape,s.shape,"Error in huberLoss: ");var u=dt(r),l=s.sub(o).abs(),h=NT(l,u),d=l.sub(h),m=dt(.5).mul(h.square()).add(u.mul(d));return oc(m,a,i)}}),qj=xe({logLoss_:function(n,e,t,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=ss.SUM_BY_NONZERO_WEIGHTS);var o=oe(n,"labels","logLoss"),s=oe(e,"predictions","logLoss"),a=null;t!=null&&(a=oe(t,"weights","logLoss")),ir(o.shape,s.shape,"Error in logLoss: ");var u=dt(1),l=dt(r),h=o.mul(s.add(l).log()).neg().sub(u.sub(o).mul(u.sub(s).add(l).log()));return oc(h,a,i)}}),Hj=xe({meanSquaredError_:function(n,e,t,r){r===void 0&&(r=ss.SUM_BY_NONZERO_WEIGHTS);var i=oe(n,"labels","meanSquaredError"),o=oe(e,"predictions","meanSquaredError"),s=null;t!=null&&(s=oe(t,"weights","meanSquaredError")),ir(i.shape,o.shape,"Error in meanSquaredError: ");var a=i.squaredDifference(o);return oc(a,s,r)}}),Gj=xe({sigmoidCrossEntropy_:function(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=ss.SUM_BY_NONZERO_WEIGHTS);var o=oe(n,"multiClassLabels","sigmoidCrossEntropy"),s=oe(e,"logits","sigmoidCrossEntropy"),a=null;if(t!=null&&(a=oe(t,"weights","sigmoidCrossEntropy")),ir(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=dt(r),l=dt(1),h=dt(.5);o=o.mul(l.sub(u)).add(h.mul(u))}var d=(function(m,p){var y=oe(m,"labels","sigmoidCrossEntropyWithLogits"),b=oe(p,"logits","sigmoidCrossEntropyWithLogits");ir(y.shape,b.shape,"Error in sigmoidCrossEntropyWithLogits: ");var x=b.relu(),E=b.mul(y),T=b.abs().neg().exp().log1p();return x.sub(E).add(T)})(o,s);return oc(d,a,i)}}),$j=xe({softmaxCrossEntropy_:function(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=ss.SUM_BY_NONZERO_WEIGHTS);var o=oe(n,"onehotLabels","softmaxCrossEntropy"),s=oe(e,"logits","softmaxCrossEntropy"),a=null;if(t!=null&&(a=oe(t,"weights","softmaxCrossEntropy")),ir(o.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){var u=dt(r),l=dt(1),h=dt(o.shape[1]);o=o.mul(l.sub(u)).add(u.div(h))}var d=(function(m,p,y){if(y===void 0&&(y=-1),y===-1&&(y=p.rank-1),y!==p.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+p.rank+" and dim was "+y);return G0((function(b,x,E){var T=x.logSumExp([y],!0),P=x.toFloat().sub(T);return E([b,P]),{value:P.mul(b).neg().sum([y]),gradFunc:function(I,D){var U=D[0],L=D[1],C=Hs(I.shape,[y]);return[I.reshape(C).mul(U.toFloat().sub(L.exp())),I.reshape(C).mul(L.exp().sub(U.toFloat()))]}}}))(m,p)})(o,s);return oc(d,a,i)}}),Kj=Object.freeze({get Reduction(){return ss},absoluteDifference:jj,computeWeightedLoss:oc,cosineDistance:Uj,hingeLoss:zj,huberLoss:Wj,logLoss:qj,meanSquaredError:Hj,sigmoidCrossEntropy:Gj,softmaxCrossEntropy:$j});function LS(n,e){return e===void 0&&(e=!1),Ie.tidy((function(){if(n.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+n.shape.length+"D Tensor.");for(var t=n.shape[0],r=n.shape[1],i=qI(t),o=n.clone(),s=Yc([[1]],[1,1]),a=s.clone(),u=t>=r?r:t,l=function(d){var m,p=o,y=a,b=i;m=Ie.tidy((function(){var x=o.slice([d,d],[t-d,1]),E=x.norm(),T=o.slice([d,d],[1,1]),P=Yc([[-1]]).where(T.greater(0),Yc([[1]])),I=T.sub(P.mul(E)),D=x.div(I);a=D.shape[0]===1?s.clone():s.concat(D.slice([1,0],[D.shape[0]-1,D.shape[1]]),0);var U=P.matMul(I).div(E).neg(),L=o.slice([d,0],[t-d,r]),C=U.mul(a);if(d===0)o=L.sub(C.matMul(a.transpose().matMul(L)));else{var A=L.sub(C.matMul(a.transpose().matMul(L)));o=o.slice([0,0],[d,r]).concat(A,0)}var M=i.slice([0,d],[t,i.shape[1]-d]);if(d===0)i=M.sub(M.matMul(a).matMul(C.transpose()));else{var k=M.sub(M.matMul(a).matMul(C.transpose()));i=i.slice([0,0],[t,d]).concat(k,1)}return[a,o,i]})),a=m[0],o=m[1],i=m[2],qs([p,y,b])},h=0;h<u;++h)l(h);return!e&&t>r&&(i=i.slice([0,0],[t,r]),o=o.slice([0,0],[r,r])),[i,o]}))}var Xj=xe({bandPart_:function(n,e,t){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(t%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+t+".");var r=oe(n,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,o=r.shape.slice(-2),s=o[0],a=o[1];if(!(e<=s))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+s+").");if(!(t<=a))throw new Error("bandPart(): numUpper ("+t+") must not be greater than the number of columns ("+a+").");e<0&&(e=s),t<0&&(t=a);var u=i0(0,s,1,"int32").reshape([-1,1]),l=i0(0,a,1,"int32"),h=Ki(u,l),d=K0(h.lessEqual(dt(+e,"int32")),h.greaterEqual(dt(-t,"int32"))),m=Tr([s,a],r.dtype);return wa(Hi(r.reshape([-1,s,a])).map((function(p){return cf(d,p,m)}))).reshape(i)}}),Yj=xe({gramSchmidt_:function(n){var e;if(Array.isArray(n)){e=!1,me(n!=null&&n.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var t=n[0].shape[0],r=function(u){me(n[u].shape[0]===t,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+n[u].shape[0]+" vs. "+t+")"}))},i=1;i<n.length;++i)r(i)}else e=!0,n=Gb(n,n.shape[0],0).map((function(u){return $I(u,[0])}));me(n.length<=n[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+n.length+") exceeds number of dimensions ("+n[0].shape[0]+")."}));var o=[],s=n,a=function(u){o.push(Ie.tidy((function(){var l=s[u];if(u>0)for(var h=0;h<u;++h){var d=WT(o[h].mulStrict(l)).mul(o[h]);l=l.sub(d)}return l.div($T(l,"euclidean"))})))};for(i=0;i<n.length;++i)a(i);return e?wa(o,0):o}}),Qj=xe({qr_:function(n,e){if(e===void 0&&(e=!1),n.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+n.rank);if(n.rank===2)return LS(n,e);var t=n.shape.slice(0,n.shape.length-2).reduce((function(s,a){return s*a})),r=Hi(n.reshape([t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),i=[],o=[];return r.forEach((function(s){var a=LS(s,e),u=a[0],l=a[1];i.push(u),o.push(l)})),[wa(i,0).reshape(n.shape),wa(o,0).reshape(n.shape)]}}),Jj=Object.freeze({bandPart:Xj,gramSchmidt:Yj,qr:Qj});function J0(n,e,t,r,i,o){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),o==null&&(o=0);var s=n.shape[0];return t=Math.min(t,s),me(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),me(n.rank===2,(function(){return"boxes must be a 2D tensor, but was of rank '"+n.rank+"'"})),me(n.shape[1]===4,(function(){return"boxes must have 4 columns, but 2nd dimension was "+n.shape[1]})),me(e.rank===1,(function(){return"scores must be a 1D tensor"})),me(e.shape[0]===s,(function(){return"scores has incompatible shape with boxes. Expected "+s+", but was "+e.shape[0]})),me(0<=o&&o<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+o+"'"})),{maxOutputSize:t,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}var Zj=xe({resizeBilinear_:function(n,e,t){t===void 0&&(t=!1);var r=oe(n,"images","resizeBilinear");me(r.rank===3||r.rank===4,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),me(e.length===2,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=Ie.runKernelFunc((function(l,h){return h([i]),l.resizeBilinear(i,s,a,t)}),{x:i},(function(l,h){return{x:function(){return Ie.runKernelFunc((function(d){return d.resizeBilinearBackprop(l,h[0],t)}),{})}}}),"ResizeBilinear",{alignCorners:t,newHeight:s,newWidth:a});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),e9=xe({resizeNearestNeighbor_:function(n,e,t){t===void 0&&(t=!1);var r=oe(n,"images","resizeNearestNeighbor");me(r.rank===3||r.rank===4,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),me(e.length===2,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),me(r.dtype==="float32"||r.dtype==="int32",(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=Ie.runKernelFunc((function(l,h){return h([i]),l.resizeNearestNeighbor(i,s,a,t)}),{batchImages:i},(function(l,h){return{batchImages:function(){return Ie.runKernelFunc((function(d){return d.resizeNearestNeighborBackprop(l,h[0],t)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),t9=xe({nonMaxSuppression_:function(n,e,t,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var o=oe(n,"boxes","nonMaxSuppression"),s=oe(e,"scores","nonMaxSuppression"),a=J0(o,s,t,r,i);t=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;var u={maxOutputSize:t,iouThreshold:r,scoreThreshold:i};return Ie.runKernelFunc((function(l){return l.nonMaxSuppression(o,s,t,r,i)}),{boxes:o,scores:s},null,"NonMaxSuppressionV3",u)}}),n9=function(n,e,t,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),Nt(this,void 0,void 0,(function(){var o,s,a,u,l,h,d;return Rt(this,(function(m){switch(m.label){case 0:return o=oe(n,"boxes","nonMaxSuppressionAsync"),s=oe(e,"scores","nonMaxSuppressionAsync"),a=J0(o,s,t,r,i),t=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold,[4,Promise.all([o.data(),s.data()])];case 1:return u=m.sent(),l=u[0],h=u[1],d=Yb(l,h,t,r,i),o!==n&&o.dispose(),s!==e&&s.dispose(),[2,d]}}))}))},r9=xe({nonMaxSuppressionWithScore_:function(n,e,t,r,i,o){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),o===void 0&&(o=0);var s=oe(n,"boxes","nonMaxSuppression"),a=oe(e,"scores","nonMaxSuppression"),u=J0(s,a,t,r,i,o),l={maxOutputSize:t=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:o=u.softNmsSigma},h=Ie.runKernel("NonMaxSuppressionV5",{boxes:s,scores:a},l);return{selectedIndices:h[0],selectedScores:h[1]}}}),i9=function(n,e,t,r,i,o){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),o===void 0&&(o=0),Nt(this,void 0,void 0,(function(){var s,a,u,l,h,d,m;return Rt(this,(function(p){switch(p.label){case 0:return s=oe(n,"boxes","nonMaxSuppressionAsync"),a=oe(e,"scores","nonMaxSuppressionAsync"),u=J0(s,a,t,r,i,o),t=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,o=u.softNmsSigma,[4,Promise.all([s.data(),a.data()])];case 1:return l=p.sent(),h=l[0],d=l[1],m=Qb(h,d,t,r,i,o),s!==n&&s.dispose(),a!==e&&a.dispose(),[2,m]}}))}))},o9=xe({cropAndResize_:function(n,e,t,r,i,o){var s=oe(n,"image","cropAndResize"),a=oe(e,"boxes","cropAndResize","float32"),u=oe(t,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var l=a.shape[0];return me(s.rank===4,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."})),me(a.rank===2&&a.shape[1]===4,(function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+a.shape+"."})),me(u.rank===1&&u.shape[0]===l,(function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+a.shape+"."})),me(r.length===2,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),me(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),me(i==="bilinear"||i==="nearest",(function(){return"method must be bilinear or nearest, but was "+i})),Ie.runKernelFunc((function(h,d){return h.cropAndResize(s,a,u,r,i,o)}),{images:s,boxes:a,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:o,cropSize:r})}}),hx=Object.freeze({resizeBilinear:Zj,resizeNearestNeighbor:e9,nonMaxSuppression:t9,nonMaxSuppressionAsync:n9,nonMaxSuppressionWithScore:r9,nonMaxSuppressionWithScoreAsync:i9,cropAndResize:o9}),fx=function(n,e){return!(n>0)||e==="linear"},dx=function(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return n.mul(e.step());throw new Error("Gradient for activation "+t+" has not been implemented yet.")},px=function(n,e){var t=e,r=$i(n.shape,e.shape);return r.length>0&&(t=t.sum(r)),t.reshape(n.shape)},mx=function(n,e,t){if(e==="linear")return n;if(e==="relu")return Yr(n);if(e==="elu")return qT(n);if(e==="relu6")return GT(n);if(e==="prelu")return HT(n,t);throw new Error("Unknown fused activation "+e+".")},s9=xe({fusedMatMul_:function(n){var e,t=n.a,r=n.b,i=n.transposeA,o=i!==void 0&&i,s=n.transposeB,a=s!==void 0&&s,u=n.bias,l=n.activation,h=l===void 0?"linear":l,d=n.preluActivationWeights;if(fx(Ie.state.gradientDepth,h)===!1){var m=Y0(t,r,o,a);return u!=null&&(m=Dn(m,u)),mx(m,h,d)}var p=oe(t,"a","fused matMul"),y=oe(r,"b","fused matMul");e=Jr(p,y),p=e[0],y=e[1];var b=o?p.shape[p.rank-2]:p.shape[p.rank-1],x=a?y.shape[y.rank-1]:y.shape[y.rank-2],E=o?p.shape[p.rank-1]:p.shape[p.rank-2],T=a?y.shape[y.rank-2]:y.shape[y.rank-1],P=p.shape.slice(0,-2),I=y.shape.slice(0,-2),D=Mt(P),U=Mt(I);me(p.rank>=2&&y.rank>=2&&p.rank===y.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+y.rank+"."})),me(po(P,I),(function(){return"Error in fused matMul: outer dimensions ("+P+") and ("+I+") of Tensors with shapes "+p.shape+" and "+y.shape+" must match."})),me(b===x,(function(){return"Error in fused matMul: inner shapes ("+b+") and ("+x+") of Tensors with shapes "+p.shape+" and "+y.shape+" and transposeA="+o+" and transposeB="+a+" must match."}));var L,C,A=p.shape.slice(0,-2).concat([E,T]),M=o?p.as3D(D,b,E):p.as3D(D,E,b),k=a?y.as3D(U,T,x):y.as3D(U,x,T);u!=null&&Mn(A,(L=Jr(L=oe(u,"bias","fused matMul"),p)[0]).shape),d!=null&&(C=oe(d,"prelu weights","fused matMul"));var O={a:M,b:k};u!=null&&(O.bias=L),d!=null&&(O.preluActivationWeights=C);var j=[M,k];return Ie.runKernelFunc((function(X,ue){var ge=X.fusedBatchMatMul({a:M,b:k,transposeA:o,transposeB:a,bias:L,activation:h,preluActivationWeights:C});return ue([M,k,ge]),ge}),O,(function(X,ue){var ge=ue[0],he=ue[1],$=ue[2],le=dx(X,$,h),ae={};return u!=null&&(ae={bias:function(){return px(L,le)}}),Object.assign(o||a?!o&&a?{a:function(){return le.matMul(he,!1,!1)},b:function(){return le.matMul(ge,!0,!1)}}:o&&!a?{a:function(){return he.matMul(le,!1,!0)},b:function(){return ge.matMul(le,!1,!1)}}:{a:function(){return he.matMul(le,!0,!0)},b:function(){return le.matMul(ge,!0,!0)}}:{a:function(){return le.matMul(he,!1,!0)},b:function(){return ge.matMul(le,!0,!1)}},ae)}),"_FusedMatMul",{transposeA:o,transposeB:a,activation:h},j,[!0]).reshape(A)}}),a9=xe({fusedConv2d_:function(n){var e=n.x,t=n.filter,r=n.strides,i=n.pad,o=n.dataFormat,s=o===void 0?"NHWC":o,a=n.dilations,u=a===void 0?[1,1]:a,l=n.dimRoundingMode,h=n.bias,d=n.activation,m=d===void 0?"linear":d,p=n.preluActivationWeights;if(m=m||"linear",fx(Ie.state.gradientDepth,m)===!1){var y=$a(e,t,r,i,s,u,l);return h!=null&&(y=Dn(y,h)),mx(y,m,p)}var b=oe(e,"x","conv2d"),x=oe(t,"filter","conv2d"),E=b,T=!1;b.rank===3&&(T=!0,E=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),me(E.rank===4,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+E.rank+"."})),me(x.rank===4,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+x.rank+"."})),l!=null&&me(xi(i),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."})),me(E.shape[3]===x.shape[2],(function(){return"Error in conv2d: depth of input ("+E.shape[3]+") must match input depth for filter "+x.shape[2]+"."})),me(Gs(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),me(s==="NHWC",(function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."}));var P,I,D=xf(E.shape,x.shape,r,u,i,l);h!=null&&(P=Jr(P=oe(h,"bias","fused conv2d"),b)[0],Mn(D.outShape,P.shape)),p!=null&&(I=oe(p,"prelu weights","fused conv2d"));var U={x:E,filter:x};h!=null&&(U.bias=P),p!=null&&(U.preluActivationWeights=I);var L=[x,E],C=Ie.runKernelFunc((function(A,M){var k=A.fusedConv2d({input:E,filter:x,convInfo:D,bias:P,activation:m,preluActivationWeights:I});return M([x,E,k]),k}),U,(function(A,M){var k=M,O=k[0],j=k[1],X=k[2],ue=dx(A,X,m);me(Hd(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var ge={};return h!=null&&(ge={bias:function(){return px(P,ue)}}),Object.assign({x:function(){return OT(j.shape,ue,O,r,i)},filter:function(){return ox(j,ue,O.shape,r,i)}},ge)}),"FusedConv2D",{convInfo:D,activation:m},L,[!0]);return T?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),u9=xe({fusedDepthwiseConv2d_:function(n){var e=n.x,t=n.filter,r=n.strides,i=n.pad,o=n.dataFormat,s=o===void 0?"NHWC":o,a=n.dilations,u=a===void 0?[1,1]:a,l=n.dimRoundingMode,h=n.bias,d=n.activation,m=d===void 0?"linear":d,p=n.preluActivationWeights;if(fx(Ie.state.gradientDepth,m)===!1){var y=X0(e,t,r,i,s,u,l);return h!=null&&(y=Dn(y,h)),mx(y,m,p)}var b=oe(e,"x","depthwiseConv2d"),x=oe(t,"filter","depthwiseConv2d"),E=b,T=!1;b.rank===3&&(T=!0,E=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),me(E.rank===4,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+E.rank+"."})),me(x.rank===4,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+x.rank+"."})),me(E.shape[3]===x.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+E.shape[3]+") must match the inChannels dimension in filter "+x.shape[2]+"."})),u==null&&(u=[1,1]),me(Gs(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),l!=null&&me(xi(i),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."}));var P,I,D=xf(E.shape,x.shape,r,u,i,l,!0);h!=null&&(P=Jr(P=oe(h,"bias","fused conv2d"),b)[0],Mn(D.outShape,P.shape)),p!=null&&(I=oe(p,"prelu weights","fused depthwiseConv2d"));var U={x:E,filter:x};h!=null&&(U.bias=P),p!=null&&(U.preluActivationWeights=I);var L=[x,E],C=Ie.runKernelFunc((function(A,M){var k=A.fusedDepthwiseConv2D({input:E,filter:x,convInfo:D,bias:P,activation:m,preluActivationWeights:I});return M([x,E,k]),k}),U,(function(A,M){me(Hd(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var k=M[0],O=M[1],j=M[2],X=dx(A,j,m),ue={};return h!=null&&(ue={bias:function(){return px(P,X)}}),Object.assign({x:function(){return FT(O.shape,X,k,D)},filter:function(){return BT(O,X,k.shape,D)}},ue)}),"FusedDepthwiseConv2D",{convInfo:D,activation:m},L,[!0]);return T?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),l9=Object.freeze({matMul:s9,conv2d:a9,depthwiseConv2d:u9}),c9=Object.freeze({image:hx,linalg:Jj,losses:Kj,spectral:Dj,fused:l9,signal:Bj,square:q7,squaredDifference:bT,conv1d:ZV,conv2d:$a,conv3d:ej,depthwiseConv2d:X0,separableConv2d:sx,conv2dTranspose:tj,conv3dTranspose:nj,op:xe,batchNormalization2d:bV,batchNormalization3d:xV,batchNormalization4d:_V,batchNormalization:EV,batchNorm:CT,batchNorm2d:SV,batchNorm3d:AV,batchNorm4d:CV,booleanMaskAsync:JV,complex:ko,real:qa,imag:tl,concat:qi,concat1d:l8,concat2d:c8,concat3d:h8,concat4d:f8,split:Gb,matMul:Y0,dot:rj,outerProduct:ij,reverse:$m,reverse1d:oj,reverse2d:sj,reverse3d:aj,reverse4d:uj,maxPool:co,avgPool:Km,pool:lj,maxPool3d:cj,avgPool3d:hj,slice:pl,slice1d:fj,slice2d:dj,slice3d:UT,slice4d:pj,abs:H7,acos:G7,acosh:$7,asin:K7,asinh:X7,atan:Y7,atanh:Q7,ceil:J7,clipByValue:nx,cos:Z7,cosh:eV,erf:tV,exp:pw,expm1:nV,floor:rV,log:iV,log1p:oV,logSigmoid:sV,neg:f0,reciprocal:aV,round:uV,rsqrt:xT,sigmoid:_T,sign:lV,isNaN:cV,isInf:hV,isFinite:fV,sin:dV,sinh:pV,softplus:mV,sqrt:gV,step:vV,tan:yV,tanh:wV,all:mj,any:gj,argMax:vj,argMin:yj,logSumExp:wj,max:Q0,mean:bj,min:xj,moments:_j,sum:WT,prod:Ej,equal:RT,equalStrict:zV,greater:WV,greaterEqual:PT,greaterEqualStrict:qV,greaterStrict:HV,less:GV,lessEqual:$V,lessEqualStrict:KV,lessStrict:XV,notEqual:YV,notEqualStrict:QV,add:Dn,addN:kV,addStrict:NV,atan2:RV,div:gu,divNoNan:PV,divStrict:DV,floorDiv:kT,maximum:rx,maximumStrict:LV,minimum:NT,minimumStrict:MV,mod:OV,modStrict:FV,mul:us,mulStrict:BV,pow:d0,powStrict:VV,squaredDifferenceStrict:jV,sub:Ki,subStrict:UV,elu:qT,leakyRelu:Sj,prelu:HT,relu:Yr,relu6:GT,selu:Aj,logicalAnd:K0,logicalNot:IV,logicalOr:IT,logicalXor:TV,where:cf,whereAsync:TT,buffer:wn,print:x8,batchToSpaceND:WI,broadcastTo:_8,cast:E8,clone:S8,cumsum:A8,depthToSpace:C8,expandDims:Wa,eye:qI,multinomial:I8,oneHot:cw,pad:bf,pad1d:T8,pad2d:k8,pad3d:N8,pad4d:R8,rand:P8,randomNormal:D8,randomGamma:L8,randomUniform:HI,reshape:yu,spaceToBatchND:GI,squeeze:$I,stack:wa,tile:xd,truncatedNormal:M8,unstack:Hi,setdiff1dAsync:O8,fill:cl,linspace:u8,ones:ip,range:i0,scalar:dt,tensor:Po,tensor1d:Di,tensor2d:Yc,tensor3d:Hb,tensor4d:zs,tensor5d:o8,tensor6d:s8,variable:a8,zeros:Tr,onesLike:zI,zerosLike:zn,transpose:uh,softmax:ic,logSoftmax:W8,localResponseNormalization:Cj,norm:$T,gather:ix,unsortedSegmentSum:DT,basicLSTMCell:Ij,multiRNNCell:Tj,movingAverage:kj,stridedSlice:Nj,topk:Rj,scatterND:Pj,fft:ax,ifft:p0,rfft:ux,irfft:KT,sparseToDense:Lj,gatherND:Mj,diag:Oj,dropout:Fj,hannWindow:lx,hammingWindow:YT,frame:cx,stft:QT,inTopKAsync:Vj});function nt(n,e){Array.isArray(n)||(n=[n]),n.forEach((function(t){t!=null&&me(t.dtype!=="complex64",(function(){return e+" does not support complex64 tensors."}))}))}function Gy(n,e,t,r){if(t==="linear")return n.linear(e);if(t==="relu")return n.relu(e);if(t==="elu")return n.elu(e);if(t==="relu6")return n.relu6(e);if(t==="prelu")return n.prelu(e,r);throw new Error("Activation "+t+" has not been implemented for the CPU backend.")}var h9=(function(n){function e(){var t=n.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new eT(t,Ie),t}return Su(e,n),e.prototype.write=function(t,r,i){this.firstUse&&(this.firstUse=!1,Ye().get("IS_NODE")&&n0(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var o={};return this.data.set(o,{values:t,dtype:i}),o},e.prototype.move=function(t,r,i,o){this.data.set(t,{values:r,dtype:o})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){return[2,this.readSync(t)]}))}))},e.prototype.readSync=function(t){var r=this.data.get(t),i=r.dtype,o=r.complexTensors;return i==="complex64"?dw(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var r=this.readSync(t.dataId),i=r;if(t.dtype==="string")try{i=r.map((function(o){return Zv(o)}))}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return wn(t.shape,t.dtype,i)},e.prototype.makeOutput=function(t,r,i){var o=this.write(t,r,i);return Ie.makeTensorFromDataId(o,r,i,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var r=this.data.get(t).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return Nt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){return r=Zu(),t(),[2,{kernelMs:Zu()-r}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,r){var i=this.makeOutput(null,t.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:Ie.keep(t.clone()),imag:Ie.keep(r.clone())},i},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,r,i){if(nt(t,"slice"),JI(t.shape,r,i)){var o=ZI(r,t.strides),s=Mt(i);return Po(this.readSync(t.dataId).subarray(o,o+s),i,t.dtype)}for(var a=wn(i,t.dtype),u=this.bufferSync(t),l=0;l<a.size;++l){var h=a.indexToLoc(l).map((function(d,m){return d+r[m]}));a.values[l]=u.get.apply(u,h)}return a.toTensor()},e.prototype.stridedSlice=function(t,r,i,o){nt(t,"stridedSlice");var s=Kb(r,i,o);if(s.some((function(p){return p===0})))return Po([],s);for(var a=wn(s,t.dtype),u=this.bufferSync(t),l=0;l<a.size;l++){for(var h=a.indexToLoc(l),d=new Array(h.length),m=0;m<d.length;m++)d[m]=h[m]*o[m]+r[m];a.set.apply(a,[u.get.apply(u,d)].concat(h))}return a.toTensor()},e.prototype.diag=function(t){for(var r=this.readSync(t.dataId),i=wn([t.size,t.size],t.dtype),o=i.values,s=0;s<r.length;s++)o[s*t.size+s]=r[s];return i.toTensor()},e.prototype.unstack=function(t,r){for(var i=t.shape[r],o=new Array(t.rank-1),s=0,a=0;a<t.rank;a++)a!==r&&(o[s++]=t.shape[a]);var u=new Array(t.rank).fill(0),l=t.shape.slice();l[r]=1;var h=new Array(i);for(a=0;a<h.length;a++)u[r]=a,h[a]=this.slice(t,u,l).reshape(o);return h},e.prototype.reverse=function(t,r){nt(t,"reverse");for(var i=wn(t.shape,t.dtype),o=this.bufferSync(t),s=function(u){var l=i.indexToLoc(u),h=l.slice();r.forEach((function(d){return h[d]=t.shape[d]-1-h[d]})),i.set.apply(i,[o.get.apply(o,h)].concat(l))},a=0;a<i.size;a++)s(a);return i.toTensor()},e.prototype.concat=function(t,r){var i=this;if(t[0].dtype==="complex64"){var o=t.map((function(p){return qa(p)})),s=t.map((function(p){return tl(p)}));return ko(this.concat(o,r),this.concat(s,r))}var a=t.map((function(p){var y=Mt(p.shape.slice(r));return p.as2D(-1,y)})),u=qd(a.map((function(p){return p.shape})),1),l=wn(u,t[0].dtype).values;if(a[0].shape[0]===1){var h=0;a.forEach((function(p){l.set(i.readSync(p.dataId),h),h+=p.size}))}else{var d=0;a.forEach((function(p){for(var y=i.readSync(p.dataId),b=0,x=0;x<p.shape[0];++x)for(var E=x*u[1]+d,T=0;T<p.shape[1];++T)l[E+T]=y[b++];d+=p.shape[1]}))}var m=qd(t.map((function(p){return p.shape})),r);return Po(l,m,t[0].dtype)},e.prototype.neg=function(t){return nt(t,"neg"),this.multiply(dt(-1),t)},e.prototype.add=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),(function(i,o,s,a){return{real:i+s,imag:o+a}})):this.broadcastedBinaryOp(t,r,No(t.dtype,r.dtype),(function(i,o){return i+o}))},e.prototype.addN=function(t){var r=this;nt(t,"addN");for(var i=t.map((function(h){return r.readSync(h.dataId)})),o=wn(t[0].shape,t[0].dtype),s=o.values,a=0;a<t.length;a++)for(var u=i[a],l=0;l<s.length;l++)s[l]+=u[l];return o.toTensor()},e.prototype.softmax=function(t,r){var i=Xi([r],t.shape),o=this.max(t,i),s=Hs(o.shape,i),a=this.subtract(t,o.reshape(s)),u=this.exp(a),l=this.sum(u,i).reshape(s);return this.realDivide(u,l)},e.prototype.subtract=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),(function(i,o,s,a){return{real:i-s,imag:o-a}})):this.broadcastedBinaryOp(t,r,No(t.dtype,r.dtype),(function(i,o){return i-o}))},e.prototype.pow=function(t,r){return nt([t,r],"pow"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.pow(i,o)}))},e.prototype.batchMatMul=function(t,r,i,o){nt([t,r],"matMul");for(var s=i?t.shape[1]:t.shape[2],a=i?t.shape[2]:t.shape[1],u=o?r.shape[1]:r.shape[2],l=t.shape[0],h=this.readSync(t.dataId),d=this.readSync(r.dataId),m=i?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],p=m[0],y=m[1],b=m[2],x=o?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],E=x[0],T=x[1],P=x[2],I=a*u,D=wn([l,a,u],t.dtype),U=D.values,L=this.blockSize,C=0;C<l;C++)for(var A=0;A<a;A+=L)for(var M=0;M<u;M+=L)for(var k=0;k<s;k+=L)for(var O=Math.min(A+L,a),j=Math.min(M+L,u),X=Math.min(k+L,s),ue=A;ue<O;ue++)for(var ge=M;ge<j;ge++){for(var he=0,$=k;$<X;$++)he+=h[C*p+ue*y+$*b]*d[$*E+ge*T+C*P];U[C*I+(ue*u+ge)]+=he}return D.toTensor()},e.prototype.fusedBatchMatMul=function(t){var r=t.a,i=t.b,o=t.transposeA,s=t.transposeB,a=t.bias,u=t.activation,l=t.preluActivationWeights,h=this.batchMatMul(r,i,o,s);return a&&(h=this.add(h,a)),u&&(h=Gy(this,h,u,l)),h},e.prototype.multiply=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),(function(i,o,s,a){return{real:i*s-o*a,imag:i*a+o*s}})):this.broadcastedBinaryOp(t,r,No(t.dtype,r.dtype),(function(i,o){return i*o}))},e.prototype.realDivide=function(t,r){return nt([t,r],"realDivide"),this.broadcastedBinaryOp(t,r,"float32",(function(i,o){return i/o}))},e.prototype.floorDiv=function(t,r){return nt([t,r],"floorDiv"),this.broadcastedBinaryOp(t,r,"int32",(function(i,o){return Math.floor(i/o)}))},e.prototype.sum=function(t,r){nt(t,"sum"),ha("sum",r,t.rank);for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,No(t.dtype,"int32")),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=0,y=0;y<u;++y)p+=h[m+y];l[d]=p}return a},e.prototype.prod=function(t,r){nt(t,"sum");for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,No(t.dtype,"int32")),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=1,y=0;y<u;++y)p*=h[m+y];l[d]=p}return a},e.prototype.unsortedSegmentSum=function(t,r,i){nt(t,"unsortedSegmentSum");for(var o=[],s=t.rank-r.rank,a=0;a<s;++a)r=r.expandDims(a+1);for(a=0;a<i;++a){var u=dt(a,"int32"),l=RT(u,r).asType("float32").mul(t).sum(0);o.push(l)}return wa(o)},e.prototype.argMin=function(t,r){nt(t,"argMin");var i=[r];ha("argMin",i,t.rank);for(var o=ts(t.shape,i),s=o[0],a=o[1],u=Tr(s,"int32"),l=Mt(a),h=this.readSync(u.dataId),d=this.readSync(t.dataId),m=0;m<h.length;++m){for(var p=m*l,y=d[p],b=0,x=0;x<l;++x){var E=d[p+x];E<y&&(y=E,b=x)}h[m]=b}return u},e.prototype.argMax=function(t,r){nt(t,"argMax");var i=[r];ha("argMax",i,t.rank);for(var o=ts(t.shape,i),s=o[0],a=o[1],u=Tr(s,"int32"),l=Mt(a),h=this.readSync(u.dataId),d=this.readSync(t.dataId),m=0;m<h.length;++m){for(var p=m*l,y=d[p],b=0,x=0;x<l;++x){var E=d[p+x];E>y&&(y=E,b=x)}h[m]=b}return u},e.prototype.cumsum=function(t,r,i,o){if(nt(t,"cumsum"),r!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+r);for(var s=No(t.dtype,"int32"),a=Tr(t.shape,s),u=this.readSync(a.dataId),l=this.readSync(t.dataId),h=t.shape[t.rank-1],d=o?function(x,E){return x+h-E-1}:function(x,E){return x+E},m=0;m<l.length;m+=h)for(var p=0;p<h;p++){var y=d(m,p);if(p===0)u[y]=i?0:l[y];else{var b=d(m,p-1);u[y]=i?l[b]+u[b]:l[y]+u[b]}}return a},e.prototype.equal=function(t,r){return nt([t,r],"equal"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i===o?1:0}))},e.prototype.notEqual=function(t,r){return nt([t,r],"notEqual"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i!==o?1:0}))},e.prototype.less=function(t,r){return nt([t,r],"less"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i<o?1:0}))},e.prototype.lessEqual=function(t,r){return nt([t,r],"lessEqual"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i<=o?1:0}))},e.prototype.greater=function(t,r){return nt([t,r],"greater"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i>o?1:0}))},e.prototype.greaterEqual=function(t,r){return nt([t,r],"greaterEqual"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i>=o?1:0}))},e.prototype.logicalNot=function(t){nt(t,"logicalNot");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r[o]?0:1;return this.makeOutput(i,t.shape,"bool")},e.prototype.logicalAnd=function(t,r){return nt([t,r],"logicalAnd"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i&&o}))},e.prototype.logicalOr=function(t,r){return nt([t,r],"logicalOr"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i||o}))},e.prototype.select=function(t,r,i){nt([t,r,i],"select");for(var o=this.readSync(t.dataId),s=this.readSync(r.dataId),a=this.readSync(i.dataId),u=Tr(r.shape,No(r.dtype,i.dtype)),l=this.readSync(u.dataId),h=0,d=t.rank===0||t.rank>1||r.rank===1?1:Mt(r.shape.slice(1)),m=0;m<o.length;m++)for(var p=0;p<d;p++)o[m]===1?l[h++]=s[m]:l[h++]=a[m];return u},e.prototype.where=function(t){nt([t],"where");var r=this.readSync(t.dataId);return Jb(t.shape,r)},e.prototype.topk=function(t,r,i){return nt(t,"topk"),uT(this.readSync(t.dataId),t.shape,t.dtype,r)},e.prototype.min=function(t,r){nt(t,"min"),ha("min",r,t.rank);for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,t.dtype),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=h[m],y=0;y<u;++y){var b=h[m+y];b<p&&(p=b)}l[d]=p}return a},e.prototype.minimum=function(t,r){return nt([t,r],"minimum"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.min(i,o)}))},e.prototype.mod=function(t,r){return nt([t,r],"mod"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){var s=i%o;return i<0&&o<0||i>=0&&o>=0?s:(s+o)%o}))},e.prototype.max=function(t,r){nt(t,"max"),ha("max",r,t.rank);for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,t.dtype),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=h[m],y=0;y<u;++y){var b=h[m+y];b>p&&(p=b)}l[d]=p}return a},e.prototype.maximum=function(t,r){return nt([t,r],"maximum"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.max(i,o)}))},e.prototype.all=function(t,r){nt(t,"all"),ha("all",r,t.rank);for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,t.dtype),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=h[m],y=0;y<u;++y){var b=h[m+y];p=p&&b}l[d]=p}return a},e.prototype.any=function(t,r){nt(t,"any"),ha("any",r,t.rank);for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,t.dtype),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=h[m],y=0;y<u;++y){var b=h[m+y];p=p||b}l[d]=p}return a},e.prototype.squaredDifference=function(t,r){return nt([t,r],"squaredDifference"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){var s=i-o;return s*s}))},e.prototype.ceil=function(t){nt(t,"ceil");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.ceil(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.floor=function(t){nt(t,"floor");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.floor(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.sign=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)r[o]<0?i[o]=-1:r[o]>0?i[o]=1:i[o]=0;return this.makeOutput(i,t.shape,"float32")},e.prototype.isNaN=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isNaN(r[o])&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.isInf=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Math.abs(r[o])===1/0&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.isFinite=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isFinite(r[o])&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.round=function(t){nt(t,"round");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=Math.floor(r[o]);r[o]-s<.5?i[o]=Math.floor(r[o]):r[o]-s>.5?i[o]=Math.ceil(r[o]):i[o]=s%2==0?s:s+1}return this.makeOutput(i,t.shape,"float32")},e.prototype.exp=function(t){nt(t,"exp");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.exp(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.expm1=function(t){nt(t,"expm1");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.expm1(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.log=function(t){nt(t,"log");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=Math.log(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.log1p=function(t){nt(t,"log1p");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=Math.log1p(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.sqrt=function(t){nt(t,"sqrt");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=Math.sqrt(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.rsqrt=function(t){nt(t,"rsqrt");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=1/Math.sqrt(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.reciprocal=function(t){nt(t,"reciprocal");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=1/r[o];return this.makeOutput(i,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){nt(t,"relu");for(var r=Tr(t.shape,t.dtype),i=this.readSync(r.dataId),o=this.readSync(t.dataId),s=0;s<o.length;++s)i[s]=Math.max(0,o[s]);return r},e.prototype.relu6=function(t){nt(t,"relu");for(var r=Tr(t.shape,t.dtype),i=this.readSync(r.dataId),o=this.readSync(t.dataId),s=0;s<o.length;++s)i[s]=Math.min(Math.max(0,o[s]),6);return r},e.prototype.prelu=function(t,r){return nt([t,r],"prelu"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return i<0?o*i:i}))},e.prototype.elu=function(t){nt(t,"elu");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var s=i[o];r[o]=s>=0?s:Math.exp(s)-1}return this.makeOutput(r,t.shape,"float32")},e.prototype.eluDer=function(t,r){nt([t,r],"eluDer");for(var i=new Float32Array(r.size),o=this.readSync(r.dataId),s=this.readSync(t.dataId),a=0;a<o.length;++a){var u=o[a];i[a]=u>=1?s[a]:s[a]*(u+1)}return this.makeOutput(i,r.shape,"float32")},e.prototype.selu=function(t){nt(t,"selu");for(var r=ex,i=tx,o=new Float32Array(t.size),s=this.readSync(t.dataId),a=0;a<s.length;++a){var u=s[a];o[a]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(o,t.shape,"float32")},e.prototype.clip=function(t,r,i){nt(t,"clip");for(var o=new Float32Array(t.size),s=this.readSync(t.dataId),a=0;a<s.length;++a){var u=s[a];o[a]=u>i?i:u<r?r:u}return this.makeOutput(o,t.shape,"float32")},e.prototype.abs=function(t){for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.abs(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<t.size;++o){var s=i[2*o],a=i[2*o+1];r[o]=Math.hypot(s,a)}return this.makeOutput(r,t.shape,"float32")},e.prototype.int=function(t){nt(t,"int");for(var r=new Int32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=i[o];return this.makeOutput(r,t.shape,"int32")},e.prototype.sigmoid=function(t){nt(t,"sigmoid");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=1/(1+Math.exp(-i[o]));return this.makeOutput(r,t.shape,"float32")},e.prototype.softplus=function(t){nt(t,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(t.size),o=this.readSync(t.dataId),s=0;s<o.length;++s){var a=o[s]>-r,u=o[s]<r,l=Math.exp(o[s]),h=void 0;h=u?l:a?o[s]:Math.log(1+l),i[s]=h}return this.makeOutput(i,t.shape,"float32")},e.prototype.sin=function(t){nt(t,"sin");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.sin(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.cos=function(t){nt(t,"cos");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.cos(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.tan=function(t){nt(t,"tan");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.tan(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.asin=function(t){nt(t,"asin");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.asin(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.acos=function(t){nt(t,"acos");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.acos(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atan=function(t){nt(t,"atan");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.atan(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atan2=function(t,r){return nt([t,r],"atan2"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.atan2(i,o)}))},e.prototype.sinh=function(t){nt(t,"sinh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.sinh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.cosh=function(t){nt(t,"cosh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.cosh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.tanh=function(t){nt(t,"tanh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=fF(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.asinh=function(t){nt(t,"asinh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.asinh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.acosh=function(t){nt(t,"acosh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.acosh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atanh=function(t){nt(t,"atanh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.atanh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.erf=function(t){nt(t,"erf");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var s=Math.sign(i[o]),a=Math.abs(i[o]),u=1/(1+.3275911*a);r[o]=s*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-a*a))}return this.makeOutput(r,t.shape,"float32")},e.prototype.step=function(t,r){r===void 0&&(r=0),nt(t,"step");for(var i=new Float32Array(t.size),o=this.readSync(t.dataId),s=0;s<o.length;++s){var a=o[s];isNaN(a)?i[s]=NaN:i[s]=a>0?1:r}return this.makeOutput(i,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var r=t.input,i=t.filter,o=t.convInfo,s=t.bias,a=t.activation,u=t.preluActivationWeights,l=this.conv2d(r,i,o);return s&&(l=this.add(l,s)),a&&(l=Gy(this,l,a,u)),l},e.prototype.conv2d=function(t,r,i){nt([t,r],"conv2d");for(var o=i.filterHeight,s=i.filterWidth,a=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,h=i.padInfo.top,d=i.dataFormat==="channelsLast",m=wn(i.outShape,t.dtype),p=t.strides[0],y=d?t.strides[1]:t.strides[2],b=d?t.strides[2]:1,x=d?1:t.strides[1],E=m.strides[0],T=d?m.strides[1]:m.strides[2],P=d?m.strides[2]:1,I=d?1:m.strides[1],D=this.readSync(t.dataId),U=this.readSync(r.dataId),L=m.values,C=0;C<i.batchSize;++C)for(var A=C*p,M=C*E,k=0;k<i.outHeight;++k)for(var O=M+k*T,j=k*i.strideHeight-h,X=0;X<o;X++){var ue=j+X*a;if(!(ue<0||ue>=i.inHeight))for(var ge=X*r.strides[0],he=A+ue*y,$=0;$<i.outWidth;++$)for(var le=O+$*P,ae=$*i.strideWidth-l,J=0;J<s;J++){var W=ae+J*u;if(!(W<0||W>=i.inWidth))for(var Q=he+W*b,ne=ge+J*r.strides[1],fe=0;fe<i.inChannels;++fe){for(var ve=D[Q+fe*x],we=0;we<i.outChannels;++we)L[le+we*I]+=ve*U[ne+we];ne+=i.outChannels}}}return m.toTensor()},e.prototype.conv3d=function(t,r,i){for(var o=i.filterDepth,s=i.filterHeight,a=i.filterWidth,u=i.dilationDepth,l=i.dilationHeight,h=i.dilationWidth,d=i.padInfo.front,m=i.padInfo.left,p=i.padInfo.top,y=wn(i.outShape,t.dtype),b=this.readSync(t.dataId),x=this.readSync(r.dataId),E=y.values,T=0;T<i.batchSize;++T)for(var P=T*t.strides[0],I=T*y.strides[0],D=0;D<i.outDepth;++D)for(var U=I+D*y.strides[1],L=D*i.strideDepth-d,C=0;C<o;C++){var A=L+C*u;if(!(A<0||A>=i.inDepth))for(var M=C*r.strides[0],k=P+A*t.strides[1],O=0;O<i.outHeight;++O)for(var j=U+O*y.strides[2],X=O*i.strideHeight-p,ue=0;ue<s;ue++){var ge=X+ue*l;if(!(ge<0||ge>=i.inHeight))for(var he=M+ue*r.strides[1],$=k+ge*t.strides[2],le=0;le<i.outWidth;++le)for(var ae=j+le*i.outChannels,J=le*i.strideWidth-m,W=0;W<a;W++){var Q=J+W*h;if(!(Q<0||Q>=i.inWidth))for(var ne=he+W*r.strides[2],fe=$+Q*i.inChannels,ve=ne,we=0;we<i.inChannels;++we){for(var Se=b[fe+we],Ce=0;Ce<i.outChannels;++Ce)E[ae+Ce]+=Se*x[ve+Ce];ve+=i.outChannels}}}}return y.toTensor()},e.prototype.conv2dDerInput=function(t,r,i){nt([t,r],"conv2dDerInput");for(var o=wn(i.inShape,"float32"),s=o.values,a=this.readSync(t.dataId),u=this.readSync(r.dataId),l=r.strides,h=l[0],d=l[1],m=l[2],p=i.batchSize,y=i.filterHeight,b=i.filterWidth,x=i.inChannels,E=i.inHeight,T=i.inWidth,P=i.outChannels,I=i.outHeight,D=i.outWidth,U=i.strideHeight,L=i.strideWidth,C=i.dataFormat,A=y-1-i.padInfo.top,M=b-1-i.padInfo.left,k=C==="channelsLast",O=o.strides[0],j=k?o.strides[1]:o.strides[2],X=k?o.strides[2]:1,ue=k?1:o.strides[1],ge=t.strides[0],he=k?t.strides[1]:t.strides[2],$=k?t.strides[2]:1,le=k?1:t.strides[1],ae=0;ae<p;++ae)for(var J=0;J<x;++J)for(var W=0;W<E;++W)for(var Q=W-A,ne=Math.max(0,Math.ceil(Q/U)),fe=Math.min(I,(y+Q)/U),ve=0;ve<T;++ve){for(var we=ve-M,Se=Math.max(0,Math.ceil(we/L)),Ce=Math.min(D,(b+we)/L),Fe=0,qe=ne;qe<fe;++qe)for(var Ne=qe*U-Q,Oe=Se;Oe<Ce;++Oe)for(var Qe=ge*ae+he*qe+$*Oe,te=h*(y-1-Ne)+d*(b-1-(Oe*L-we))+m*J,rt=0;rt<P;++rt)Fe+=a[Qe+le*rt]*u[te+rt];s[O*ae+j*W+X*ve+ue*J]=Fe}return o.toTensor()},e.prototype.conv3dDerInput=function(t,r,i){for(var o=wn(i.inShape,"float32"),s=o.values,a=o.strides,u=a[0],l=a[1],h=a[2],d=a[3],m=this.readSync(t.dataId),p=t.strides,y=p[0],b=p[1],x=p[2],E=p[3],T=this.readSync(r.dataId),P=r.strides,I=P[0],D=P[1],U=P[2],L=P[3],C=i.batchSize,A=i.filterDepth,M=i.filterHeight,k=i.filterWidth,O=i.inChannels,j=i.inDepth,X=i.inHeight,ue=i.inWidth,ge=i.outChannels,he=i.outDepth,$=i.outHeight,le=i.outWidth,ae=i.strideDepth,J=i.strideHeight,W=i.strideWidth,Q=A-1-i.padInfo.front,ne=M-1-i.padInfo.top,fe=k-1-i.padInfo.left,ve=0;ve<C;++ve)for(var we=0;we<O;++we)for(var Se=0;Se<j;++Se)for(var Ce=Se-Q,Fe=Math.max(0,Math.ceil(Ce/ae)),qe=Math.min(he,(A+Ce)/ae),Ne=0;Ne<X;++Ne)for(var Oe=Ne-ne,Qe=Math.max(0,Math.ceil(Oe/J)),te=Math.min($,(M+Oe)/J),rt=0;rt<ue;++rt){for(var zt=rt-fe,gt=Math.max(0,Math.ceil(zt/W)),He=Math.min(le,(k+zt)/W),ft=0,lt=Fe;lt<qe;++lt)for(var Et=lt*ae-Ce,pt=Qe;pt<te;++pt)for(var En=pt*J-Oe,$t=gt;$t<He;++$t)for(var Qt=y*ve+b*lt+x*pt+E*$t,an=I*(A-1-Et)+D*(M-1-En)+U*(k-1-($t*W-zt))+L*we,qt=0;qt<ge;++qt)ft+=m[Qt+qt]*T[an+qt];s[u*ve+l*Se+h*Ne+d*rt+we]=ft}return o.toTensor()},e.prototype.conv2dDerFilter=function(t,r,i){nt([t,r],"conv2dDerFilter");for(var o=i.strideHeight,s=i.strideWidth,a=i.filterHeight,u=i.filterWidth,l=i.dataFormat==="channelsLast",h=wn(i.filterShape,"float32"),d=i.padInfo.left,m=i.padInfo.top,p=this.bufferSync(t),y=this.bufferSync(r),b=0;b<a;++b)for(var x=Math.max(0,Math.ceil((m-b)/o)),E=Math.min(i.outHeight,(i.inHeight+m-b)/o),T=0;T<u;++T)for(var P=Math.max(0,Math.ceil((d-T)/s)),I=Math.min(i.outWidth,(i.inWidth+d-T)/s),D=0;D<i.inChannels;++D)for(var U=0;U<i.outChannels;++U){for(var L=0,C=0;C<i.batchSize;++C)for(var A=x;A<E;++A)for(var M=b+A*o-m,k=P;k<I;++k){var O=T+k*s-d;L+=l?p.get(C,M,O,D)*y.get(C,A,k,U):p.get(C,D,M,O)*y.get(C,U,A,k)}h.set(L,b,T,D,U)}return h.toTensor()},e.prototype.conv3dDerFilter=function(t,r,i){for(var o=i.strideDepth,s=i.strideHeight,a=i.strideWidth,u=i.filterDepth,l=i.filterHeight,h=i.filterWidth,d=wn(i.filterShape,"float32"),m=d.values,p=d.strides,y=p[0],b=p[1],x=p[2],E=p[3],T=this.readSync(r.dataId),P=r.strides,I=P[0],D=P[1],U=P[2],L=P[3],C=this.readSync(t.dataId),A=t.strides,M=A[0],k=A[1],O=A[2],j=A[3],X=i.padInfo.front,ue=i.padInfo.left,ge=i.padInfo.top,he=0;he<u;++he)for(var $=Math.max(0,Math.ceil((X-he)/o)),le=Math.min(i.outDepth,(i.inDepth+X-he)/o),ae=he*y,J=0;J<l;++J)for(var W=Math.max(0,Math.ceil((ge-J)/s)),Q=Math.min(i.outHeight,(i.inHeight+ge-J)/s),ne=J*b+ae,fe=0;fe<h;++fe)for(var ve=Math.max(0,Math.ceil((ue-fe)/a)),we=Math.min(i.outWidth,(i.inWidth+ue-fe)/a),Se=fe*x+ne,Ce=0;Ce<i.inChannels;++Ce)for(var Fe=Ce*E+Se,qe=0;qe<i.outChannels;++qe){for(var Ne=0,Oe=0;Oe<i.batchSize;++Oe)for(var Qe=Oe*M,te=Oe*I,rt=$;rt<le;++rt)for(var zt=(he+rt*o-X)*k+Qe,gt=rt*D+te,He=W;He<Q;++He)for(var ft=(J+He*s-ge)*O+zt,lt=He*U+gt,Et=ve;Et<we;++Et){var pt=Et*L+lt;Ne+=C[(fe+Et*a-ue)*j+ft+Ce]*T[pt+qe]}m[Fe+qe]=Ne}return d.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var r=t.input,i=t.filter,o=t.convInfo,s=t.bias,a=t.activation,u=t.preluActivationWeights,l=this.depthwiseConv2D(r,i,o);return s&&(l=this.add(l,s)),a&&(l=Gy(this,l,a,u)),l},e.prototype.depthwiseConv2D=function(t,r,i){nt([t,r],"depthwiseConv2D");for(var o=i.filterHeight,s=i.filterWidth,a=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,h=i.padInfo.top,d=i.outChannels/i.inChannels,m=wn(i.outShape,t.dtype),p=this.readSync(t.dataId),y=this.readSync(r.dataId),b=m.values,x=0;x<i.batchSize;++x)for(var E=x*t.strides[0],T=x*m.strides[0],P=0;P<i.outHeight;++P)for(var I=T+P*m.strides[1],D=P*i.strideHeight-l,U=0;U<o;++U){var L=D+U*a;if(!(L<0||L>=i.inHeight))for(var C=U*r.strides[0],A=E+L*t.strides[1],M=0;M<i.outWidth;++M)for(var k=I+M*m.strides[2],O=M*i.strideWidth-h,j=0;j<s;++j){var X=O+j*u;if(!(X<0||X>=i.inWidth))for(var ue=C+j*r.strides[1],ge=A+X*i.inChannels,he=k,$=ue,le=0;le<i.inChannels;++le){for(var ae=p[ge+le],J=0;J<d;++J)b[he+J]+=ae*y[$+J];he+=d,$+=d}}}return m.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,r,i){nt([t,r],"depthwiseConv2DDerInput");for(var o=wn(i.inShape,"float32"),s=o.values,a=o.strides,u=a[0],l=a[1],h=a[2],d=this.readSync(t.dataId),m=t.strides,p=m[0],y=m[1],b=m[2],x=this.readSync(r.dataId),E=r.strides,T=E[0],P=E[1],I=E[2],D=i.batchSize,U=i.filterHeight,L=i.filterWidth,C=i.inChannels,A=i.inHeight,M=i.inWidth,k=i.outChannels,O=i.outHeight,j=i.outWidth,X=i.strideHeight,ue=i.strideWidth,ge=U-1-i.padInfo.top,he=L-1-i.padInfo.left,$=k/C,le=0;le<D;++le)for(var ae=0;ae<C;++ae)for(var J=0;J<A;++J)for(var W=J-ge,Q=Math.max(0,Math.ceil(W/X)),ne=Math.min(O,(U+W)/X),fe=0;fe<M;++fe){for(var ve=fe-he,we=Math.max(0,Math.ceil(ve/ue)),Se=Math.min(j,(L+ve)/ue),Ce=0,Fe=Q;Fe<ne;++Fe)for(var qe=Fe*X-W,Ne=we;Ne<Se;++Ne)for(var Oe=p*le+y*Fe+b*Ne,Qe=T*(U-1-qe)+P*(L-1-(Ne*ue-ve))+I*ae,te=0;te<$;++te)Ce+=d[Oe+(ae*$+te)]*x[Qe+te];s[u*le+l*J+h*fe+ae]=Ce}return o.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,r,i){nt([t,r],"depthwiseConv2DDerFilter");for(var o=i.strideHeight,s=i.strideWidth,a=i.filterHeight,u=i.filterWidth,l=wn(i.filterShape,"float32"),h=i.padInfo.left,d=i.padInfo.top,m=i.outChannels/i.inChannels,p=this.bufferSync(t),y=this.bufferSync(r),b=0;b<a;++b)for(var x=Math.max(0,Math.ceil((d-b)/o)),E=Math.min(i.outHeight,(i.inHeight+d-b)/o),T=0;T<u;++T)for(var P=Math.max(0,Math.ceil((h-T)/s)),I=Math.min(i.outWidth,(i.inWidth+h-T)/s),D=0;D<i.outChannels;++D){for(var U=Math.trunc(D/m),L=D%m,C=0,A=0;A<i.batchSize;++A)for(var M=x;M<E;++M)for(var k=b+M*o-d,O=P;O<I;++O){var j=T+O*s-h;C+=p.get(A,k,j,U)*y.get(A,M,O,D)}l.set(C,b,T,U,L)}return l.toTensor()},e.prototype.tile=function(t,r){return nt(t,"tile"),aT(this.bufferSync(t),r)},e.prototype.pad=function(t,r,i){nt(t,"pad");var o=r.map((function(m,p){return m[0]+t.shape[p]+m[1]})),s=r.map((function(m){return m[0]})),a=this.bufferSync(t),u=wn(o,t.dtype);i!==0&&u.values.fill(i);for(var l=0;l<t.size;l++){var h=a.indexToLoc(l),d=h.map((function(m,p){return m+s[p]}));u.set.apply(u,[a.get.apply(a,h)].concat(d))}return u.toTensor()},e.prototype.transpose=function(t,r){nt(t,"transpose");for(var i=new Array(t.rank),o=0;o<i.length;o++)i[o]=t.shape[r[o]];var s=this.readSync(t.dataId),a=wn(i,t.dtype),u=this.bufferSync(t);for(o=0;o<t.size;++o){for(var l=u.indexToLoc(o),h=new Array(l.length),d=0;d<h.length;d++)h[d]=l[r[d]];var m=a.locToIndex(h);a.values[m]=s[o]}return a.toTensor()},e.prototype.gather=function(t,r,i){nt([t,r],"gather");var o=t.shape.slice(),s=this.readSync(r.dataId);o[i]=s.length;for(var a=wn(o,t.dtype),u=this.bufferSync(t),l=0;l<a.size;++l){var h=a.indexToLoc(l),d=h.slice();d[i]=s[h[i]];var m=u.locToIndex(d);a.values[l]=u.values[m]}return a.toTensor()},e.prototype.batchToSpaceND=function(t,r,i){nt([t],"batchToSpaceND");var o=r.reduce((function(d,m){return d*m})),s=o0(t.shape,r,o),a=s0(s.length,r.length),u=a0(t.shape,r,o),l=KI(i,r.length),h=XI(u,i,r.length);return t.reshape(s).transpose(a).reshape(u).slice(l,h)},e.prototype.spaceToBatchND=function(t,r,i){nt([t],"spaceToBatchND");var o=r.reduce((function(m,p){return m*p})),s=[[0,0]];s.push.apply(s,i);for(var a=1+r.length;a<t.shape.length;++a)s.push([0,0]);var u=t.pad(s),l=o0(u.shape,r,o,!1),h=s0(l.length,r.length,!1),d=a0(u.shape,r,o,!1);return u.reshape(l).transpose(h).reshape(d)},e.prototype.pool=function(t,r,i){nt(t,"pool");for(var o=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,m=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(t.dataId),b=wn(r.outShape,t.dtype),x=b.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3],T=r.outShape[2]*r.outShape[3],P=r.outShape[3],I=0;I<r.batchSize;++I)for(var D=I*E,U=I*t.strides[0],L=0;L<r.inChannels;++L)for(var C=0;C<r.outHeight;++C)for(var A=C*o-d,M=Math.max(0,A),k=Math.min(r.inHeight,l+A),O=D+C*T,j=0;j<r.outWidth;++j){for(var X=j*s-m,ue=Math.max(0,X),ge=Math.min(r.inWidth,h+X),he=p,$=0,le=0,ae=M;ae<k;ae+=a){for(var J=U+ae*t.strides[1],W=ue;W<ge;W+=u){var Q=y[J+W*t.strides[2]+L];i==="max"&&Q>he?he=Q:i==="avg"&&($+=Q,le++)}if(isNaN(he))break}x[O+j*P+L]=i==="avg"?$/le:he}return b.toTensor()},e.prototype.maxPool=function(t,r){return this.pool(t,r,"max")},e.prototype.maxPoolPositions=function(t,r){for(var i=wn(r.outShape,"int32"),o=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,m=r.padInfo.left,p=this.bufferSync(t),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var x=0;x<r.outHeight;++x){for(var E=x*o-d,T=E;T<0;)T+=a;for(var P=Math.min(r.inHeight,l+E),I=0;I<r.outWidth;++I){for(var D=I*s-m,U=D;U<0;)U+=u;for(var L=Math.min(r.inWidth,h+D),C=Number.NEGATIVE_INFINITY,A=-1,M=T;M<P;M+=a)for(var k=M-E,O=U;O<L;O+=u){var j=O-D,X=p.get(y,M,O,b);X>C&&(C=X,A=k*h+j)}i.set(A,y,x,I,b)}}return i.toTensor()},e.prototype.maxPoolBackprop=function(t,r,i,o){nt([r,i],"maxPoolBackprop");for(var s=this.maxPoolPositions(r,o),a=o.strideHeight,u=o.strideWidth,l=o.dilationHeight,h=o.dilationWidth,d=o.effectiveFilterHeight,m=o.effectiveFilterWidth,p=m-1-o.padInfo.left,y=d-1-o.padInfo.top,b=wn(r.shape,"float32"),x=this.bufferSync(s),E=this.bufferSync(t),T=0;T<o.batchSize;++T)for(var P=0;P<o.inChannels;++P)for(var I=0;I<o.inHeight;++I)for(var D=0;D<o.inWidth;++D){for(var U=I-y,L=D-p,C=0,A=0;A<d;A+=l){var M=(U+A)/a;if(!(M<0||M>=o.outHeight||Math.floor(M)!==M))for(var k=0;k<m;k+=h){var O=(L+k)/u;if(!(O<0||O>=o.outWidth||Math.floor(O)!==O)){var j=d*m-1-x.get(T,M,O,P)===A*m+k?1:0;j!==0&&(C+=E.get(T,M,O,P)*j)}}}b.set(C,T,I,D,P)}return b.toTensor()},e.prototype.avgPoolBackprop=function(t,r,i){nt([t,r],"avgPoolBackprop");for(var o=i.strideHeight,s=i.strideWidth,a=i.filterHeight,u=i.filterWidth,l=i.dilationHeight,h=i.dilationWidth,d=i.effectiveFilterHeight,m=i.effectiveFilterWidth,p=m-1-i.padInfo.left,y=d-1-i.padInfo.top,b=wn(r.shape,"float32"),x=1/(a*u),E=this.bufferSync(t),T=0;T<i.batchSize;++T)for(var P=0;P<i.inChannels;++P)for(var I=0;I<i.inHeight;++I)for(var D=0;D<i.inWidth;++D){for(var U=I-y,L=D-p,C=0,A=0;A<d;A+=l){var M=(U+A)/o;if(!(M<0||M>=i.outHeight||Math.floor(M)!==M))for(var k=0;k<m;k+=h){var O=(L+k)/s;O<0||O>=i.outWidth||Math.floor(O)!==O||(C+=E.get(T,M,O,P))}}b.set(C*x,T,I,D,P)}return b.toTensor()},e.prototype.pool3d=function(t,r,i){nt(t,"pool3d");for(var o=r.strideDepth,s=r.strideHeight,a=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,m=r.effectiveFilterHeight,p=r.effectiveFilterWidth,y=r.padInfo.front,b=r.padInfo.top,x=r.padInfo.left,E=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,T=this.readSync(t.dataId),P=wn(r.outShape,t.dtype),I=P.values,D=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],U=r.outShape[2]*r.outShape[3]*r.outShape[4],L=r.outShape[3]*r.outShape[4],C=r.outShape[4],A=0;A<r.batchSize;++A)for(var M=A*D,k=A*t.strides[0],O=0;O<r.inChannels;++O)for(var j=0;j<r.outDepth;++j){for(var X=j*o-y,ue=X;ue<0;)ue+=u;for(var ge=Math.min(r.inDepth,d+X),he=M+j*U,$=0;$<r.outHeight;++$){for(var le=$*s-b,ae=le;ae<0;)ae+=l;for(var J=Math.min(r.inHeight,m+le),W=he+$*L,Q=0;Q<r.outWidth;++Q){for(var ne=Q*a-x,fe=ne;fe<0;)fe+=h;for(var ve=Math.min(r.inWidth,p+ne),we=W+Q*C,Se=E,Ce=0,Fe=0,qe=ue;qe<ge;qe+=u){for(var Ne=k+qe*t.strides[1],Oe=ae;Oe<J;Oe+=l){for(var Qe=Ne+Oe*t.strides[2],te=fe;te<ve;te+=h){var rt=T[Qe+te*t.strides[3]+O];if(i==="max"&&rt>Se?Se=rt:i==="avg"&&(Ce+=rt,Fe++),isNaN(Se))break}if(isNaN(Se))break}if(isNaN(Se))break}I[we+O]=i==="avg"?Ce/Fe:Se}}}return P.toTensor()},e.prototype.avgPool3d=function(t,r){return nt(t,"avgPool3d"),this.pool3d(t,r,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,r,i){nt([t,r],"avgPool3dBackprop");for(var o=i.strideDepth,s=i.strideHeight,a=i.strideWidth,u=i.filterDepth,l=i.filterHeight,h=i.filterWidth,d=i.dilationDepth,m=i.dilationHeight,p=i.dilationWidth,y=i.effectiveFilterDepth,b=i.effectiveFilterHeight,x=i.effectiveFilterWidth,E=y-1-i.padInfo.front,T=x-1-i.padInfo.left,P=b-1-i.padInfo.top,I=wn(r.shape,"float32"),D=1/(u*l*h),U=this.bufferSync(t),L=0;L<i.batchSize;++L)for(var C=0;C<i.inChannels;++C)for(var A=0;A<i.inDepth;++A)for(var M=0;M<i.inHeight;++M)for(var k=0;k<i.inWidth;++k){for(var O=A-E,j=M-P,X=k-T,ue=0,ge=0;ge<y;ge+=d){var he=(O+ge)/o;if(!(he<0||he>=i.outDepth||Math.floor(he)!==he))for(var $=0;$<b;$+=m){var le=(j+$)/s;if(!(le<0||le>=i.outHeight||Math.floor(le)!==le))for(var ae=0;ae<x;ae+=p){var J=(X+ae)/a;J<0||J>=i.outWidth||Math.floor(J)!==J||(ue+=U.get(L,he,le,J,C))}}}I.set(ue*D,L,A,M,k,C)}return I.toTensor()},e.prototype.maxPool3d=function(t,r){return nt(t,"maxPool3d"),this.pool3d(t,r,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,r){for(var i=wn(r.outShape,"int32"),o=r.strideDepth,s=r.strideHeight,a=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,m=r.effectiveFilterHeight,p=r.effectiveFilterWidth,y=r.padInfo.front,b=r.padInfo.top,x=r.padInfo.left,E=this.bufferSync(t),T=0;T<r.batchSize;++T)for(var P=0;P<r.inChannels;++P)for(var I=0;I<r.outDepth;++I){for(var D=I*o-y,U=D;U<0;)U+=u;for(var L=Math.min(r.inDepth,d+D),C=0;C<r.outHeight;++C){for(var A=C*s-b,M=A;M<0;)M+=l;for(var k=Math.min(r.inHeight,m+A),O=0;O<r.outWidth;++O){for(var j=O*a-x,X=j;X<0;)X+=h;for(var ue=Math.min(r.inWidth,p+j),ge=Number.NEGATIVE_INFINITY,he=-1,$=U;$<L;$+=u)for(var le=$-D,ae=M;ae<k;ae+=l)for(var J=ae-A,W=X;W<ue;W+=h){var Q=W-j,ne=E.get(T,$,ae,W,P);ne>=ge&&(ge=ne,he=le*m*p+J*m+Q)}i.set(he,T,I,C,O,P)}}}return i.toTensor()},e.prototype.maxPool3dBackprop=function(t,r,i,o){nt([r,i],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(r,o),a=o.strideDepth,u=o.strideHeight,l=o.strideWidth,h=o.dilationDepth,d=o.dilationHeight,m=o.dilationWidth,p=o.effectiveFilterDepth,y=o.effectiveFilterHeight,b=o.effectiveFilterWidth,x=p-1-o.padInfo.front,E=b-1-o.padInfo.left,T=y-1-o.padInfo.top,P=wn(r.shape,"float32"),I=this.bufferSync(s),D=this.bufferSync(t),U=0;U<o.batchSize;++U)for(var L=0;L<o.inChannels;++L)for(var C=0;C<o.inDepth;++C)for(var A=0;A<o.inHeight;++A)for(var M=0;M<o.inWidth;++M){for(var k=C-x,O=A-T,j=M-E,X=0,ue=0;ue<p;ue+=h){var ge=(k+ue)/a;if(!(ge<0||ge>=o.outDepth||Math.floor(ge)!==ge))for(var he=0;he<y;he+=d){var $=(O+he)/u;if(!($<0||$>=o.outHeight||Math.floor($)!==$))for(var le=0;le<b;le+=m){var ae=(j+le)/l;if(!(ae<0||ae>=o.outWidth||Math.floor(ae)!==ae)){var J=p*y*b-1-I.get(U,ge,$,ae,L)===ue*y*b+he*b+le?1:0;J!==0&&(X+=D.get(U,ge,$,ae,L)*J)}}}}P.set(X,U,C,A,M,L)}return P.toTensor()},e.prototype.cast=function(t,r){return rT(t,r,this)},e.prototype.reshape=function(t,r){return fw(t,r)},e.prototype.avgPool=function(t,r){return nt(t,"avgPool"),this.pool(t,r,"avg").toFloat()},e.prototype.resizeBilinear=function(t,r,i,o){nt(t,"resizeBilinear");for(var s=t.shape,a=s[0],u=s[1],l=s[2],h=s[3],d=this.readSync(t.dataId),m=new Float32Array(Mt([a,r,i,h])),p=[o&&r>1?u-1:u,o&&i>1?l-1:l],y=[o&&r>1?r-1:r,o&&i>1?i-1:i],b=0,x=p[0]/y[0],E=p[1]/y[1],T=0;T<a;T++)for(var P=0;P<r;P++)for(var I=x*P,D=Math.floor(I),U=I-D,L=Math.min(u-1,Math.ceil(I)),C=T*t.strides[0]+D*t.strides[1],A=T*t.strides[0]+L*t.strides[1],M=0;M<i;M++)for(var k=E*M,O=Math.floor(k),j=k-O,X=Math.min(l-1,Math.ceil(k)),ue=C+O*t.strides[2],ge=A+O*t.strides[2],he=C+X*t.strides[2],$=A+X*t.strides[2],le=0;le<h;le++){var ae=d[ue+le],J=d[ge+le],W=ae+(d[he+le]-ae)*j,Q=W+(J+(d[$+le]-J)*j-W)*U;m[b++]=Q}return Po(m,[a,r,i,h])},e.prototype.resizeBilinearBackprop=function(t,r,i){nt([t,r],"resizeBilinearBackprop");for(var o=r.shape,s=o[0],a=o[1],u=o[2],l=o[3],h=t.shape,d=h[1],m=h[2],p=new Float32Array(s*a*u*l),y=[i&&d>1?a-1:a,i&&m>1?u-1:u],b=[i&&d>1?d-1:d,i&&m>1?m-1:m],x=y[0]/b[0],E=y[1]/b[1],T=this.readSync(t.dataId),P=0,I=0;I<s;I++)for(var D=I*r.strides[0],U=0;U<d;U++)for(var L=U*x,C=Math.floor(L),A=Math.min(Math.ceil(L),a-1),M=D+C*r.strides[1],k=D+A*r.strides[1],O=L-C,j=1-O,X=0;X<m;X++)for(var ue=X*E,ge=Math.floor(ue),he=Math.min(Math.ceil(ue),u-1),$=ue-ge,le=1-$,ae=M+ge*r.strides[2],J=M+he*r.strides[2],W=k+ge*r.strides[2],Q=k+he*r.strides[2],ne=j*le,fe=j*$,ve=O*le,we=O*$,Se=0;Se<l;Se++){var Ce=T[P++];p[ae+Se]+=Ce*ne,p[J+Se]+=Ce*fe,p[W+Se]+=Ce*ve,p[Q+Se]+=Ce*we}return zs(p,[s,u,a,l],r.dtype)},e.prototype.resizeNearestNeighbor=function(t,r,i,o){nt(t,"resizeNearestNeighbor");for(var s=t.shape,a=s[0],u=s[1],l=s[2],h=s[3],d=this.readSync(t.dataId),m=new Float32Array(a*r*i*h),p=[o&&r>1?u-1:u,o&&i>1?l-1:l],y=[o&&r>1?r-1:r,o&&i>1?i-1:i],b=p[0]/y[0],x=p[1]/y[1],E=0,T=0;T<a;T++)for(var P=T*t.strides[0],I=0;I<r;I++)for(var D=b*I,U=P+Math.min(u-1,o?Math.round(D):Math.floor(D))*t.strides[1],L=0;L<i;L++)for(var C=x*L,A=U+Math.min(l-1,o?Math.round(C):Math.floor(C))*t.strides[2],M=0;M<h;M++){var k=d[A+M];m[E++]=k}return Po(m,[a,r,i,h],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,r,i){nt([t,r],"resizeNearestNeighborBackprop");for(var o=r.shape,s=o[0],a=o[1],u=o[2],l=o[3],h=t.shape,d=h[1],m=h[2],p=new Float32Array(s*a*u*l),y=this.readSync(t.dataId),b=[i&&d>1?a-1:a,i&&m>1?u-1:u],x=[i&&d>1?d-1:d,i&&m>1?m-1:m],E=b[0]/x[0],T=b[1]/x[1],P=1/E,I=1/T,D=2*Math.ceil(P)+2,U=2*Math.ceil(I)+2,L=0;L<s;L++)for(var C=L*r.strides[0],A=0;A<a;A++)for(var M=C+A*r.strides[1],k=Math.floor(A*P),O=Math.floor(k-D/2),j=0;j<u;j++)for(var X=M+j*r.strides[2],ue=Math.floor(j*I),ge=Math.floor(ue-U/2),he=0;he<l;he++){for(var $=0,le=0;le<D;le++){var ae=le+O;if(!(ae<0||ae>=d)){var J=C+ae*t.strides[1],W=ae*E;if(A===Math.min(a-1,i?Math.round(W):Math.floor(W)))for(var Q=0;Q<U;Q++){var ne=Q+ge;if(!(ne<0||ne>=m)){var fe=J+ne*t.strides[2],ve=ne*T;j===Math.min(u-1,i?Math.round(ve):Math.floor(ve))&&($+=y[fe+he])}}}}p[X+he]=$}return zs(p,r.shape,r.dtype)},e.prototype.batchNormalization=function(t,r,i,o,s,a){nt([t,r,i,s,a],"batchNorm");for(var u=this.readSync(t.dataId),l=this.readSync(r.dataId),h=this.readSync(i.dataId),d=s?this.readSync(s.dataId):new Float32Array([1]),m=a?this.readSync(a.dataId):new Float32Array([0]),p=new Float32Array(u.length),y=m.length,b=d.length,x=h.length,E=l.length,T=0,P=0,I=0,D=0,U=0;U<u.length;++U)p[U]=m[T++]+(u[U]-l[P++])*d[I++]/Math.sqrt(h[D++]+o),T>=y&&(T=0),P>=E&&(P=0),I>=b&&(I=0),D>=x&&(D=0);return zs(p,t.shape)},e.prototype.localResponseNormalization4D=function(t,r,i,o,s){nt(t,"localResponseNormalization4D");var a=t.shape[3],u=a-1,l=this.readSync(t.dataId),h=t.size,d=new Float32Array(h);function m(x){for(var E=x%a,T=x-E+Math.max(0,E-r),P=x-E+Math.min(E+r,u),I=0;T<=P;T++){var D=l[T];I+=D*D}return I}for(var p=0;p<h;p++){var y=m(p),b=l[p]*Math.pow(i+o*y,-s);d[p]=b}return zs(d,t.shape)},e.prototype.LRNGrad=function(t,r,i,o,s,a,u){nt(t,"LRNGrad");for(var l=t.shape[3],h=this.readSync(t.dataId),d=this.readSync(r.dataId),m=this.readSync(i.dataId),p=new Float32Array(t.size),y=t.size,b=0;b<y;b++){for(var x=b%l,E=b-x+Math.max(0,x-o),T=b-x+Math.min(l,x+o+1),P=0,I=E;I<T;I++)P+=Math.pow(d[I],2);for(P=a*P+s,I=E;I<T;I++){var D=-2*a*u*d[I]*m[b]/P;b===I&&(D+=Math.pow(P,-u)),D*=h[b],p[I]+=D}}return zs(p,t.shape)},e.prototype.multinomial=function(t,r,i,o){nt(t,"multinomial");for(var s=r?t:ic(t),a=s.shape[0],u=s.shape[1],l=Tr([a,i],"int32"),h=this.readSync(l.dataId),d=this.readSync(s.dataId),m=0;m<a;++m){var p=m*u,y=new Float32Array(u-1);y[0]=d[p];for(var b=1;b<y.length;++b)y[b]=y[b-1]+d[p+b];for(var x=H0(o.toString()),E=m*i,T=0;T<i;++T){var P=x();h[E+T]=y.length;for(var I=0;I<y.length;I++)if(P<y[I]){h[E+T]=I;break}}}return l},e.prototype.oneHot=function(t,r,i,o){nt(t,"oneHot");var s=new Float32Array(t.size*r);s.fill(o);for(var a=this.readSync(t.dataId),u=0;u<t.size;++u)a[u]>=0&&a[u]<r&&(s[u*r+a[u]]=i);return Yc(s,[t.size,r],"int32")},e.prototype.nonMaxSuppression=function(t,r,i,o,s){return nt(t,"nonMaxSuppression"),Yb(this.readSync(t.dataId),this.readSync(r.dataId),i,o,s)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,r){for(var i=t.shape[0],o=t.shape[1],s=wn(t.shape,"float32"),a=wn(t.shape,"float32"),u=qa(t).as2D(i,o),l=tl(t).as2D(i,o),h=0;h<i;h++)for(var d=u.slice([h,0],[1,o]),m=l.slice([h,0],[1,o]),p=ko(d,m),y=this.readSync(this.fftImpl(p,r).dataId),b=0;b<o;b++){var x=dS(y,b);s.values[h*o+b]=x.real,a.values[h*o+b]=x.imag}return ko(s.toTensor(),a.toTensor()).as2D(i,o)},e.prototype.fftImpl=function(t,r){var i=t.as1D(),o=i.size;if(this.isExponentOf2(o)){var s=this.fftRadix2(i,o,r).as2D(t.shape[0],t.shape[1]);return r&&(s=ko(qa(s).div(dt(o)),tl(s).div(dt(o)))),s}var a=this.readSync(t.dataId),u=(function(l){for(var h=new Float32Array(l.length/2),d=new Float32Array(l.length/2),m=0;m<l.length;m+=2)h[m/2]=l[m],d[m/2]=l[m+1];return{real:h,imag:d}})(this.fourierTransformByMatmul(a,o,r));return ko(u.real,u.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return(t&t-1)==0},e.prototype.fftRadix2=function(t,r,i){if(r===1)return t;var o=this.readSync(t.dataId),s=r/2,a=(function(E){for(var T=Math.ceil(E.length/4),P=new Float32Array(T),I=new Float32Array(T),D=0;D<E.length;D+=4)P[Math.floor(D/4)]=E[D],I[Math.floor(D/4)]=E[D+1];return{real:P,imag:I}})(o),u=ko(a.real,a.imag).as1D(),l=(function(E){for(var T=Math.floor(E.length/4),P=new Float32Array(T),I=new Float32Array(T),D=2;D<E.length;D+=4)P[Math.floor(D/4)]=E[D],I[Math.floor(D/4)]=E[D+1];return{real:P,imag:I}})(o),h=ko(l.real,l.imag).as1D();u=this.fftRadix2(u,s,i),h=this.fftRadix2(h,s,i);var d=(function(E,T){for(var P=new Float32Array(E/2),I=new Float32Array(E/2),D=0;D<Math.ceil(E/2);D++){var U=(T?2:-2)*Math.PI*(D/E);P[D]=Math.cos(U),I[D]=Math.sin(U)}return{real:P,imag:I}})(r,i),m=ko(d.real,d.imag).mul(h),p=u.add(m),y=u.sub(m),b=qa(p).concat(qa(y)),x=tl(p).concat(tl(y));return ko(b,x).as1D()},e.prototype.fourierTransformByMatmul=function(t,r,i){for(var o=new Float32Array(2*r),s=0;s<r;s++){for(var a=0,u=0,l=0;l<r;l++){var h=H8(s*l,r,i),d=dS(t,l);a+=d.real*h.real-d.imag*h.imag,u+=d.real*h.imag+d.imag*h.real}i&&(a/=r,u/=r),q8(o,a,u,s)}return o},e.prototype.depthToSpace=function(t,r,i){me(i==="NHWC",(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i})),me(r>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+r}));for(var o=t.shape[0],s=t.shape[1],a=t.shape[2],u=t.shape[3],l=s*r,h=a*r,d=u/(r*r),m=this.readSync(t.dataId),p=new Float32Array(o*l*h*d),y=0,b=0;b<o;++b)for(var x=0;x<l;++x)for(var E=Math.floor(x/r),T=x%r,P=0;P<h;++P)for(var I=Math.floor(P/r),D=(T*r+P%r)*d,U=0;U<d;++U){var L=U+D+u*(I+a*(E+s*b));p[y++]=m[L]}return zs(p,[o,l,h,d])},e.prototype.broadcastedBinaryOp=function(t,r,i,o){var s=Mn(t.shape,r.shape),a=wn(s,i),u=this.readSync(t.dataId),l=this.readSync(r.dataId),h=Hc(t.shape,s),d=Hc(r.shape,s),m=a.values;if(h.length+d.length===0)for(var p=0;p<m.length;++p)m[p]=o(u[p%u.length],l[p%l.length]);else{var y=this.bufferSync(t),b=this.bufferSync(r),x=function(E){var T=a.indexToLoc(E),P=T.slice(-t.rank);h.forEach((function(L){return P[L]=0}));var I=y.locToIndex(P),D=T.slice(-r.rank);d.forEach((function(L){return D[L]=0}));var U=b.locToIndex(D);m[E]=o(u[I],l[U])};for(p=0;p<m.length;++p)x(p)}return a.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,r,i){var o=Mn(t.shape,r.shape),s=wn(o,"float32"),a=wn(o,"float32"),u=this.readSync(t.dataId),l=this.readSync(r.dataId),h=Hc(t.shape,o),d=Hc(r.shape,o),m=s.values,p=a.values;if(h.length+d.length===0)for(var y=0;y<m.length;y++){var b=y%u.length,x=y%l.length,E=i(u[2*b],u[2*b+1],l[2*x],l[2*x+1]);m[y]=E.real,p[y]=E.imag}else{var T=this.bufferSync(this.data.get(t.dataId).complexTensors.real),P=this.bufferSync(this.data.get(r.dataId).complexTensors.real),I=function(D){var U=s.indexToLoc(D),L=U.slice(-t.rank);h.forEach((function(O){return L[O]=0}));var C=T.locToIndex(L),A=U.slice(-r.rank);d.forEach((function(O){return A[O]=0}));var M=P.locToIndex(A),k=i(u[2*C],u[2*C+1],l[2*M],l[2*M+1]);m[D]=k.real,p[D]=k.imag};for(y=0;y<m.length;y++)I(y)}return this.complex(s.toTensor(),a.toTensor())},e.prototype.split=function(t,r,i){return sT(t,r,i)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,r,i,o,s,a){for(var u=t.shape,l=u[0],h=u[1],d=u[2],m=u[3],p=r.shape[0],y=o[0],b=o[1],x=wn([p,y,b,m],"float32"),E=this.readSync(r.dataId),T=this.readSync(i.dataId),P=this.readSync(t.dataId),I=t.strides,D=x.strides,U=0;U<p;U++){var L=4*U,C=E[L],A=E[L+1],M=E[L+2],k=E[L+3],O=T[U];if(!(O>=l))for(var j=y>1?(M-C)*(h-1)/(y-1):0,X=b>1?(k-A)*(d-1)/(b-1):0,ue=0;ue<y;ue++){var ge=y>1?C*(h-1)+ue*j:.5*(C+M)*(h-1);if(ge<0||ge>h-1)for(var he=0;he<b;he++)for(var $=0;$<m;$++){var le=$+he*D[2]+ue*D[1]+U*D[0];x.values[le]=a}else if(s==="bilinear"){var ae=Math.floor(ge),J=Math.ceil(ge),W=ge-ae;for(he=0;he<b;he++)if((qe=b>1?A*(d-1)+he*X:.5*(A+k)*(d-1))<0||qe>d-1)for($=0;$<m;$++)le=$+he*D[2]+ue*D[1]+U*D[0],x.values[le]=a;else{var Q=Math.floor(qe),ne=Math.ceil(qe),fe=qe-Q;for($=0;$<m;$++){var ve=P[le=$+Q*I[2]+ae*I[1]+O*I[0]],we=P[le=$+ne*I[2]+ae*I[1]+O*I[0]],Se=P[le=$+Q*I[2]+J*I[1]+O*I[0]],Ce=ve+(we-ve)*fe,Fe=Se+(P[le=$+ne*I[2]+J*I[1]+O*I[0]]-Se)*fe;le=$+he*D[2]+ue*D[1]+U*D[0],x.values[le]=Ce+(Fe-Ce)*W}}}else for(he=0;he<b;++he){var qe;if((qe=b>1?A*(d-1)+he*X:.5*(A+k)*(d-1))<0||qe>d-1)for($=0;$<m;$++)le=$+he*D[2]+ue*D[1]+U*D[0],x.values[le]=a;else{var Ne=Math.round(qe),Oe=Math.round(ge);for($=0;$<m;$++){var Qe=$+Ne*I[2]+Oe*I[1]+O*I[0],te=$+he*D[2]+ue*D[1]+U*D[0];x.values[te]=P[Qe]}}}}}return x.toTensor()},e.prototype.sparseToDense=function(t,r,i,o){var s=u0(0,t,i),a=s.sliceRank,u=s.numUpdates,l=s.sliceSize,h=s.strides,d=s.outputSize;return this.scatter(t,r,i,d,l,u,a,h,o,!1)},e.prototype.gatherND=function(t,r){var i=r.shape,o=i[i.length-1],s=YI(t,r),a=s[0],u=s[1],l=s[2],h=s[3];if(u===0)return Po([],a,t.dtype);for(var d=new xm([u,l],t.dtype),m=this.readSync(r.dataId),p=this.readSync(t.dataId),y=0;y<u;y++){for(var b=[],x=0,E=0;E<o;E++){var T=m[y*o+E];x+=T*h[E],b.push(T)}if(x<0||x>=t.size/l)throw new Error("Invalid indices: "+b+" does not index into "+t.shape);for(var P=0;P<l;P++)d.values[y*l+P]=p[x*l+P]}return d.toTensor().reshape(a)},e.prototype.scatterND=function(t,r,i){var o=u0(0,t,i),s=o.sliceRank,a=o.numUpdates,u=o.sliceSize,l=o.strides,h=o.outputSize,d=dt(0);return this.scatter(t,r,i,h,u,a,s,l,d,!0)},e.prototype.fill=function(t,r,i){var o=Jv(i=i||zm(r),Mt(t));return o.fill(r),Ie.makeTensor(o,t,i,this)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var r=Jv(t.dtype,Mt(t.shape));return this.makeOutput(r,t.shape,t.dtype)},e.prototype.linspace=function(t,r,i){return iT(t,r,i)},e.prototype.scatter=function(t,r,i,o,s,a,u,l,h,d){var m=[o/s,s],p=this.readSync(t.dataId),y=this.readSync(r.dataId);if(o===0)return Po([],i,r.dtype);var b=new xm(m,r.dtype);b.values.fill(this.readSync(h.dataId)[0]);for(var x=0;x<a;x++){for(var E=[],T=0,P=0;P<u;P++){var I=p[x*u+P];E.push(I),T+=I*l[P]}if(T<0||T>=o/s)throw new Error("Invalid indices: "+E+" does not index into "+i);for(var D=0;D<s;D++)d?b.values[T*s+D]+=y[x*s+D]:b.values[T*s+D]=r.rank===0?y[0]:y[x*s+D]}return b.toTensor().reshape(i)},e})(tT);Ie.registerBackend("cpu",(function(){return new h9}),1);for(var $y=0,MS=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs,i=e,o=i.boxes,s=i.scores,a=r,u=a.maxOutputSize,l=a.iouThreshold,h=a.scoreThreshold,d=a.softNmsSigma,m=t;nt(o,"NonMaxSuppressionWithScore");var p=Qb(m.data.get(o.dataId).values,m.data.get(s.dataId).values,u,l,h,d);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e.x,i=t;nt(r,"square");for(var o=i.data.get(r.dataId).values,s=new Float32Array(o.length),a=0;a<o.length;++a){var u=o[a];s[a]=u*u}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Sm,backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e,i=r.a,o=r.b,s=t;nt([i,o],Sm);var a=s.data.get(i.dataId).values,u=s.data.get(o.dataId).values,l=(function(m,p,y,b,x,E){var T=Mn(m,p),P=T.length,I=ll(T),D=bm(x,Mt(T)),U=m.length,L=p.length,C=ll(m),A=ll(p),M=Hc(m,T),k=Hc(p,T);if(M.length+k.length===0)for(var O=0;O<D.length;++O)D[O]=E(y[O%y.length],b[O%b.length]);else{var j=function(X){var ue=xF(X,P,I),ge=ue.slice(-U);M.forEach((function(ae){return ge[ae]=0}));var he=iS(ge,U,C),$=ue.slice(-L);k.forEach((function(ae){return $[ae]=0}));var le=iS($,L,A);D[X]=E(y[he],b[le])};for(O=0;O<D.length;++O)j(O)}return[D,T]})(i.shape,o.shape,a,u,i.dtype,(function(m,p){var y=m-p;return y*y})),h=l[0],d=l[1];return{dataId:s.write(h,d,i.dtype),shape:d,dtype:i.dtype}}}];$y<MS.length;$y++)kI(MS[$y]);var Qf,f9=function(n){this.variableNames=["A"];var e=os(),t=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+t+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},d9=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=os(),t=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+t+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `};for(var Ky=0,OS=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs,i=e.pixels,o=r.numChannels,s=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,u=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=u[0],h=u[1],d=[h,l],m=[h,l,o];(a||s)&&(Qf==null&&(Qf=document.createElement("canvas").getContext("2d")),Qf.canvas.width=l,Qf.canvas.height=h,Qf.drawImage(i,0,0,l,h),i=Qf.canvas);var p=t.makeTensorInfo(d,"int32");t.texData.get(p.dataId).usage=da.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(p.dataId),i);var y=Ye().getBool("WEBGL_PACK")?new d9(m):new f9(m),b=t.runWebGLProgram(y,[p],"int32");return t.disposeData(p.dataId),b}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs;n0("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=e,o=i.boxes,s=i.scores,a=r,u=a.maxOutputSize,l=a.iouThreshold,h=a.scoreThreshold,d=a.softNmsSigma,m=t,p=Qb(m.readSync(o.dataId),m.readSync(s.dataId),u,l,h,d);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e.x,i=t,o=new Sn(r.shape,"return x * x;");return i.runWebGLProgram(o,[r],r.dtype)}},{kernelName:Sm,backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e,i=r.a,o=r.b,s=t,a=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl("return (a - b) * (a - b);",i.shape,o.shape):new ii("return (a - b) * (a - b);",i.shape,o.shape);return s.compileAndRun(a,[i,o])}}];Ky<OS.length;Ky++)kI(OS[Ky]);for(var Xy=0,FS=[{kernelName:"Square",gradFunc:function(n,e){var t=e[0];return{x:function(){return n.mul(t.toFloat().mul(2))}}}},{kernelName:Sm,gradFunc:function(n,e){var t=e[0],r=e[1],i=dt(2);return{a:function(){return us(n,us(i,Ki(t,r)))},b:function(){return us(n,us(i,Ki(r,t)))}}}}];Xy<FS.length;Xy++)cF(FS[Xy]);var p9=(function(){function n(){}return n.prototype.fetch=function(e,t){return fetch(e,t)},n.prototype.now=function(){return performance.now()},n.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+t);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},n.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},n})();Ye().get("IS_BROWSER")&&Ye().setPlatform("browser",new p9);var Yy,m9=function(){return require("node-fetch")},g9=(function(){function n(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return n.prototype.fetch=function(e,t){return Ye().global.fetch!=null?Ye().global.fetch(e,t):(Yy==null&&(Yy=m9()),Yy(e,t))},n.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},n.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},n.prototype.decode=function(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)},n})();Ye().get("IS_NODE")&&Ye().setPlatform("node",new g9);var mw={float32:4,int32:4,uint16:2,uint8:1,bool:1},m0=4;function JT(n,e){for(var t={},r=0,i=function(a){var u=a.name,l=a.dtype,h=a.shape,d=Mt(h),m=void 0;if("quantization"in a){var p=a.quantization;if(p.dtype!=="uint8"&&p.dtype!=="uint16")throw new Error("Weight "+a.name+" has unknown quantization dtype "+p.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var y=mw[p.dtype],b=n.slice(r,r+d*y),x=p.dtype==="uint8"?new Uint8Array(b):new Uint16Array(b);if(l==="float32")m=Float32Array.from(x,(function(U){return U*p.scale+p.min}));else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);m=Int32Array.from(x,(function(U){return Math.round(U*p.scale+p.min)}))}r+=d*y}else if(l==="string"){var E=Mt(a.shape);m=[];for(var T=0;T<E;T++){var P=new Uint32Array(n.slice(r,r+m0))[0];r+=m0;var I=new Uint8Array(n.slice(r,r+P));m.push(I),r+=P}}else{var D=mw[l];if(b=n.slice(r,r+d*D),l==="float32")m=new Float32Array(b);else if(l==="int32")m=new Int32Array(b);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);m=new Uint8Array(b)}r+=d*D}t[u]=Po(m,h,l)},o=0,s=e;o<s.length;o++)i(s[o]);return t}function v9(n){if(n===null)throw new Error("Invalid input value: "+JSON.stringify(n));var e=0,t=[];n.forEach((function(o){if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+o.constructor.name)}));var r=new Uint8Array(e),i=0;return t.forEach((function(o){r.set(new Uint8Array(o.buffer),i),i+=o.byteLength})),r.buffer}var gw=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function BS(n){return gw?Buffer.byteLength(n):new Blob([n]).size}function gx(n){var e=0;n.forEach((function(i){e+=i.byteLength}));var t=new Uint8Array(e),r=0;return n.forEach((function(i){t.set(new Uint8Array(i),r),r+=i.byteLength})),t.buffer}function VS(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);var e=n.split("/");return e[e.length-1]}function Xm(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:BS(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:BS(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}var pa=(function(){function n(){this.saveRouters=[],this.loadRouters=[]}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerSaveRouter=function(e){n.getInstance().saveRouters.push(e)},n.registerLoadRouter=function(e){n.getInstance().loadRouters.push(e)},n.getSaveHandlers=function(e){return n.getHandlers(e,"save")},n.getLoadHandlers=function(e,t){return n.getHandlers(e,"load",t)},n.getHandlers=function(e,t,r){var i=[];return(t==="load"?n.getInstance().loadRouters:n.getInstance().saveRouters).forEach((function(o){var s=o(e,r);s!==null&&i.push(s)})),i},n})(),Ed="://",Qc=(function(){function n(){this.managers={}}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerManager=function(e,t){me(e!=null,(function(){return"scheme must not be undefined or null."})),e.endsWith(Ed)&&(e=e.slice(0,e.indexOf(Ed))),me(e.length>0,(function(){return"scheme must not be an empty string."}));var r=n.getInstance();me(r.managers[e]==null,(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=t},n.getManager=function(e){var t=this.getInstance().managers[e];if(t==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},n.getSchemes=function(){return Object.keys(this.getInstance().managers)},n})();function Iv(n){if(n.indexOf(Ed)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Qc.getSchemes().join(","));return{scheme:n.split(Ed)[0],path:n.split(Ed)[1]}}function jS(n,e,t){return t===void 0&&(t=!1),Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d;return Rt(this,(function(m){switch(m.label){case 0:return me(n!==e,(function(){return"Old path and new path are the same: '"+n+"'"})),me((r=pa.getLoadHandlers(n)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+n+"."})),me(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+n+"."})),i=r[0],me((o=pa.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),me(o.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),s=o[0],a=Iv(n).scheme,u=Iv(n).path,l=a===Iv(n).scheme,[4,i.load()];case 1:return h=m.sent(),t&&l?[4,Qc.getManager(a).removeModel(u)]:[3,3];case 2:m.sent(),m.label=3;case 3:return[4,s.save(h)];case 4:return d=m.sent(),!t||l?[3,6]:[4,Qc.getManager(a).removeModel(u)];case 5:m.sent(),m.label=6;case 6:return[2,d.modelArtifactsInfo]}}))}))}var tf="models_store",Gc="model_info_store";function ZT(){if(!Ye().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var n=window||self,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function vw(n){var e=n.result;e.createObjectStore(tf,{keyPath:"modelPath"}),e.createObjectStore(Gc,{keyPath:"modelPath"})}var Sd=(function(){function n(e){if(this.indexedDB=ZT(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return n.prototype.save=function(e){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},n.prototype.load=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},n.prototype.databaseAction=function(e,t){var r=this;return new Promise((function(i,o){var s=r.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return vw(s)},s.onsuccess=function(){var a=s.result;if(t==null){var u=a.transaction(tf,"readonly"),l=u.objectStore(tf).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return a.close(),o(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(l.result.modelArtifacts)},l.onerror=function(b){return a.close(),o(l.error)},u.oncomplete=function(){return a.close()}}else{var h,d=Xm(t),m=a.transaction(Gc,"readwrite"),p=m.objectStore(Gc),y=p.put({modelPath:r.modelPath,modelArtifactsInfo:d});y.onsuccess=function(){var b=(h=a.transaction(tf,"readwrite")).objectStore(tf).put({modelPath:r.modelPath,modelArtifacts:t,modelArtifactsInfo:d});b.onsuccess=function(){return i({modelArtifactsInfo:d})},b.onerror=function(x){var E=(p=m.objectStore(Gc)).delete(r.modelPath);E.onsuccess=function(){return a.close(),o(b.error)},E.onerror=function(T){return a.close(),o(b.error)}}},y.onerror=function(b){return a.close(),o(y.error)},m.oncomplete=function(){h==null?a.close():h.oncomplete=function(){return a.close()}}}},s.onerror=function(a){return o(s.error)}}))},n.URL_SCHEME="indexeddb://",n})(),US=function(n){return Ye().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Sd.URL_SCHEME)?(e=n.slice(Sd.URL_SCHEME.length),new Sd(e)):null;var e};pa.registerSaveRouter(US),pa.registerLoadRouter(US);var y9=(function(){function n(){this.indexedDB=ZT()}return n.prototype.listModels=function(){return Nt(this,void 0,void 0,(function(){var e=this;return Rt(this,(function(t){return[2,new Promise((function(r,i){var o=e.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return vw(o)},o.onsuccess=function(){var s=o.result,a=s.transaction(Gc,"readonly"),u=a.objectStore(Gc).getAll();u.onsuccess=function(){for(var l={},h=0,d=u.result;h<d.length;h++){var m=d[h];l[m.modelPath]=m.modelArtifactsInfo}r(l)},u.onerror=function(l){return s.close(),i(u.error)},a.oncomplete=function(){return s.close()}},o.onerror=function(s){return i(o.error)}}))]}))}))},n.prototype.removeModel=function(e){return Nt(this,void 0,void 0,(function(){var t=this;return Rt(this,(function(r){var i;return e=(i=e).startsWith(Sd.URL_SCHEME)?i.slice(Sd.URL_SCHEME.length):i,[2,new Promise((function(o,s){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return vw(a)},a.onsuccess=function(){var u,l=a.result,h=l.transaction(Gc,"readwrite"),d=h.objectStore(Gc),m=d.get(e);m.onsuccess=function(){if(m.result==null)return l.close(),s(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var p=d.delete(e),y=function(){var b=(u=l.transaction(tf,"readwrite")).objectStore(tf).delete(e);b.onsuccess=function(){return o(m.result.modelArtifactsInfo)},b.onerror=function(x){return s(m.error)}};p.onsuccess=y,p.onerror=function(b){return y(),l.close(),s(m.error)}},m.onerror=function(p){return l.close(),s(m.error)},h.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},a.onerror=function(u){return s(a.error)}}))]}))}))},n})();if(Ye().getBool("IS_BROWSER"))try{Qc.registerManager(Sd.URL_SCHEME,new y9)}catch{}var Kl="/",sd="tensorflowjs_models",ek="info",w9="model_topology",b9="weight_specs",x9="weight_data",_9="model_metadata";function tk(n){return{info:[sd,n,ek].join(Kl),topology:[sd,n,w9].join(Kl),weightSpecs:[sd,n,b9].join(Kl),weightData:[sd,n,x9].join(Kl),modelMetadata:[sd,n,_9].join(Kl)}}function E9(n){var e=n.split(Kl);if(e.length<3)throw new Error("Invalid key format: "+n);return e.slice(1,e.length-1).join(Kl)}var Ad=(function(){function n(e){if(!Ye().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=tk(this.modelPath)}return n.prototype.save=function(e){return Nt(this,void 0,void 0,(function(){var t,r,i;return Rt(this,(function(o){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),i=Xm(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,(function(s){if(gw)return Buffer.from(s).toString("base64");for(var a=new Uint8Array(s),u="",l=0,h=a.length;l<h;l++)u+=String.fromCharCode(a[l]);return btoa(u)})(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:i}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}return[2]}))}))},n.prototype.load=function(){return Nt(this,void 0,void 0,(function(){var e,t,r,i,o,s,a;return Rt(this,(function(u){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=i,(o=this.LS.getItem(this.keys.modelMetadata))!=null&&(s=JSON.parse(o),t.format=s.format,t.generatedBy=s.generatedBy,t.convertedBy=s.convertedBy,t.userDefinedMetadata=s.userDefinedMetadata),(a=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=(function(l){if(gw){var h=Buffer.from(l,"base64");return h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength)}for(var d=atob(l),m=new Uint8Array(d.length),p=0;p<d.length;++p)m.set([d.charCodeAt(p)],p);return m.buffer})(a),[2,t]}))}))},n.URL_SCHEME="localstorage://",n})(),zS=function(n){return Ye().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ad.URL_SCHEME)?(e=n.slice(Ad.URL_SCHEME.length),new Ad(e)):null;var e};pa.registerSaveRouter(zS),pa.registerLoadRouter(zS);var S9=(function(){function n(){me(Ye().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),me(typeof window>"u"||window.localStorage!==void 0,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return n.prototype.listModels=function(){return Nt(this,void 0,void 0,(function(){var e,t,r,i,o,s;return Rt(this,(function(a){for(e={},t=sd+Kl,r=Kl+ek,i=0;i<this.LS.length;++i)(o=this.LS.key(i)).startsWith(t)&&o.endsWith(r)&&(s=E9(o),e[s]=JSON.parse(this.LS.getItem(o)));return[2,e]}))}))},n.prototype.removeModel=function(e){return Nt(this,void 0,void 0,(function(){var t,r;return Rt(this,(function(i){var o;if(e=(o=e).startsWith(Ad.URL_SCHEME)?o.slice(Ad.URL_SCHEME.length):o,t=tk(e),this.LS.getItem(t.info)==null)throw new Error("Cannot find model at path '"+e+"'");return r=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,r]}))}))},n})();if(Ye().getBool("IS_BROWSER"))try{Qc.registerManager(Ad.URL_SCHEME,new S9)}catch{}var A9="model",C9=".json",I9=".weights.bin";function WS(n){return new Promise((function(e){return setTimeout(e)})).then(n)}var Qy=(function(){function n(e){if(!Ye().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(n.URL_SCHEME)&&(e=e.slice(n.URL_SCHEME.length)),e!=null&&e.length!==0||(e=A9),this.modelTopologyFileName=e+C9,this.weightDataFileName=e+I9}return n.prototype.save=function(e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a;return Rt(this,(function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:r},o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,s.href=o,[4,WS((function(){return s.dispatchEvent(new MouseEvent("click"))}))];case 2:return u.sent(),e.weightData==null?[3,4]:((a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,a.href=t,[4,WS((function(){return a.dispatchEvent(new MouseEvent("click"))}))]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Xm(e)}]}}))}))},n.URL_SCHEME="downloads://",n})(),T9=(function(){function n(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return n.prototype.load=function(){return Nt(this,void 0,void 0,(function(){var e,t,r=this;return Rt(this,(function(i){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(o,s){var a=new FileReader;a.onload=function(u){var l=JSON.parse(u.target.result),h=l.modelTopology;if(h!=null){t.length===0&&o({modelTopology:h});var d=l.weightsManifest;if(d!=null){var m;try{m=r.checkManifestAndWeightFiles(d,t)}catch(x){return void s(x)}var p=[],y=[],b=[];d.forEach((function(x){x.paths.forEach((function(E){y.push(E),b.push(null)})),p.push.apply(p,x.weights)})),d.forEach((function(x){x.paths.forEach((function(E){var T=new FileReader;T.onload=function(P){var I=P.target.result,D=y.indexOf(E);b[D]=I,b.indexOf(null)===-1&&o({modelTopology:h,weightSpecs:p,weightData:gx(b),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},T.onerror=function(P){return s("Failed to weights data from file of path '"+E+"'.")},T.readAsArrayBuffer(m[E])}))}))}else s(new Error("weightManifest field is missing from file "+e.name))}else s(new Error("modelTopology field is missing from file "+e.name))},a.onerror=function(u){return s("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},a.readAsText(e)}))]}))}))},n.prototype.checkManifestAndWeightFiles=function(e,t){for(var r=[],i=t.map((function(u){return VS(u.name)})),o={},s=0,a=e;s<a.length;s++)a[s].paths.forEach((function(u){var l=VS(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),i.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");o[u]=t[i.indexOf(l)]}));if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+t.length+").");return o},n})();function qS(n,e,t,r){(function(o){me(o!=null&&Array.isArray(o)&&o.length>0,(function(){return"promises must be a none empty array"}))})(n),(function(o,s){me(o>=0&&o<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+o})),me(s>=0&&s<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s})),me(s>=o,(function(){return"startFraction must be no more than endFraction, but got startFraction "+o+" and endFraction "+s}))})(t=t??0,r=r??1);var i=0;return Promise.all(n.map((function(o){return o.then((function(s){var a=t+ ++i/n.length*(r-t);return e(a),s})),o})))}function nk(n,e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h;return Rt(this,(function(d){switch(d.label){case 0:return e==null&&(e={}),t=e.fetchFunc==null?Ye().platform.fetch:e.fetchFunc,r=n.map((function(m){return t(m,e.requestInit,{isBinary:!0})})),i=0,o=.5,e.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return s=d.sent(),[3,4];case 2:return[4,qS(r,e.onProgress,i,o)];case 3:s=d.sent(),d.label=4;case 4:return a=s.map((function(m){return m.arrayBuffer()})),u=.5,l=1,e.onProgress!=null?[3,6]:[4,Promise.all(a)];case 5:return h=d.sent(),[3,8];case 6:return[4,qS(a,e.onProgress,u,l)];case 7:h=d.sent(),d.label=8;case 8:return[2,h]}}))}))}function HS(n){var e=this;return function(t,r,i){return r===void 0&&(r=""),Nt(e,void 0,void 0,(function(){var o,s,a,u,l,h,d,m,p,y;return Rt(this,(function(b){switch(b.label){case 0:if(o=t.map((function(){return!1})),s={},a=i!=null?i.map((function(){return!1})):[],u=[],t.forEach((function(x,E){var T=0;x.weights.forEach((function(P){var I="quantization"in P?P.quantization.dtype:P.dtype,D=mw[I]*Mt(P.shape),U=function(){o[E]=!0,s[E]==null&&(s[E]=[]),s[E].push({manifestEntry:P,groupOffset:T,sizeBytes:D})};i!=null?i.forEach((function(L,C){L===P.name&&(U(),a[C]=!0)})):U(),u.push(P.name),T+=D}))})),!a.every((function(x){return x})))throw l=i.filter((function(x,E){return!a[E]})),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return h=o.reduce((function(x,E,T){return E&&x.push(T),x}),[]),d=[],h.forEach((function(x){t[x].paths.forEach((function(E){var T=r+(r.endsWith("/")?"":"/")+E;d.push(T)}))})),[4,n(d)];case 1:return m=b.sent(),p={},y=0,h.forEach((function(x){for(var E=t[x].paths.length,T=0,P=0;P<E;P++)T+=m[y+P].byteLength;for(var I=new ArrayBuffer(T),D=new Uint8Array(I),U=0,L=0;L<E;L++){var C=new Uint8Array(m[y+L]);D.set(C,U),U+=C.byteLength}s[x].forEach((function(A){var M=JT(I.slice(A.groupOffset,A.groupOffset+A.sizeBytes),[A.manifestEntry]);for(var k in M)p[k]=M[k]})),y+=E})),[2,p]}}))}))}}pa.registerSaveRouter((function(n){return Ye().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Qy.URL_SCHEME)?(function(e){return e===void 0&&(e="model"),new Qy(e)})(n.slice(Qy.URL_SCHEME.length)):null}));var rk=(function(){function n(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,t.fetchFunc!=null?(me(typeof t.fetchFunc=="function",(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=t.fetchFunc):this.fetch=Ye().platform.fetch,me(e!=null&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&me(e.length===2,(function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."})),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return n.prototype.save=function(e){return Nt(this,void 0,void 0,(function(){var t,r,i,o;return Rt(this,(function(s){switch(s.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:r},t.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((o=s.sent()).ok)return[2,{modelArtifactsInfo:Xm(e),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}}))}))},n.prototype.load=function(){return Nt(this,void 0,void 0,(function(){var e,t,r,i,o,s,a,u,l,h,d,m;return Rt(this,(function(p){switch(p.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=p.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");p.label=2;case 2:return p.trys.push([2,4,,5]),[4,e.json()];case 3:return t=p.sent(),[3,5];case 4:throw p.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=t.modelTopology,o=t.weightsManifest,s=t.generatedBy,a=t.convertedBy,u=t.format,l=t.userDefinedMetadata,i==null&&o==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return o==null?[3,7]:[4,this.loadWeights(o)];case 6:m=p.sent(),h=m[0],d=m[1],p.label=7;case 7:return[2,{modelTopology:i,weightSpecs:h,weightData:d,userDefinedMetadata:l,generatedBy:s,convertedBy:a,format:u}]}}))}))},n.prototype.loadWeights=function(e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h,d,m;return Rt(this,(function(p){switch(p.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,r=(function(y){var b=y.lastIndexOf("/"),x=y.lastIndexOf("?"),E=y.substring(0,b),T=x>b?y.substring(x):"";return[E+"/",T]})(t),i=r[0],o=r[1],s=this.weightPathPrefix||i,a=[],u=0,l=e;u<l.length;u++)h=l[u],a.push.apply(a,h.weights);return d=[],e.forEach((function(y){y.paths.forEach((function(b){d.push(s+b+o)}))})),[4,nk(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return m=p.sent(),[2,[a,gx(m)]]}}))}))},n.URL_SCHEME_REGEX=/^https?:\/\//,n})();function yw(n){return n.match(rk.URL_SCHEME_REGEX)!=null}var GS=function(n,e){return typeof fetch>"u"?null:(Array.isArray(n)?n.every((function(t){return yw(t)})):yw(n))?ww(n,{onProgress:e}):null};function ww(n,e){return new rk(n,e)}pa.registerSaveRouter(GS),pa.registerLoadRouter(GS);var Jy=(function(){function n(e){this.modelArtifacts=e}return n.prototype.load=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(e){return[2,this.modelArtifacts]}))}))},n})(),k9=(function(){function n(e){this.saveHandler=e}return n.prototype.save=function(e){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){return[2,this.saveHandler(e)]}))}))},n})(),ik=Object.freeze({browserFiles:function(n){return new T9(n)},browserHTTPRequest:function(n,e){return ww(n,e)},concatenateArrayBuffers:gx,decodeWeights:JT,encodeWeights:function(n,e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a=this;return Rt(this,(function(u){switch(u.label){case 0:for(t=[],r=[],i=Array.isArray(n)?n.map((function(l){return l.name})):Object.keys(n),o=function(l){var h=i[l],d=Array.isArray(n)?n[l].tensor:n[h];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+h+"': "+d.dtype);var m={name:h,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var p=new Promise((function(y){return Nt(a,void 0,void 0,(function(){var b,x,E,T,P,I,D;return Rt(this,(function(U){switch(U.label){case 0:return[4,d.bytes()];case 1:for(b=U.sent(),x=b.reduce((function(L,C){return L+C.length}),0)+m0*b.length,E=new Uint8Array(x),T=0,P=0;P<b.length;P++)I=b[P],D=new Uint8Array(new Uint32Array([I.length]).buffer),E.set(D,T),T+=m0,E.set(I,T),T+=I.length;return y(E),[2]}}))}))}));r.push(p)}else r.push(d.data());e!=null&&(m.group=e),t.push(m)},s=0;s<i.length;++s)o(s);return[4,Promise.all(r)];case 1:return[2,{data:v9(u.sent()),specs:t}]}}))}))},fromMemory:function(n,e,t,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new Jy(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jy({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jy({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:r}))},getLoadHandlers:function(n,e){return pa.getLoadHandlers(n,e)},getModelArtifactsInfoForJSON:Xm,getSaveHandlers:function(n){return pa.getSaveHandlers(n)},http:ww,isHTTPScheme:yw,loadWeights:function(n,e,t,r){return e===void 0&&(e=""),Nt(this,void 0,void 0,(function(){return Rt(this,(function(i){return[2,HS((function(o){return nk(o,{requestInit:r})}))(n,e,t)]}))}))},registerLoadRouter:function(n){return pa.registerLoadRouter(n)},registerSaveRouter:function(n){return pa.registerSaveRouter(n)},weightsLoaderFactory:HS,withSaveHandler:function(n){return new k9(n)},copyModel:function(n,e){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){return[2,jS(n,e,!1)]}))}))},listModels:function(){return Nt(this,void 0,void 0,(function(){var n,e,t,r,i,o,s;return Rt(this,(function(a){switch(a.label){case 0:n=Qc.getSchemes(),e={},t=0,r=n,a.label=1;case 1:return t<r.length?(i=r[t],[4,Qc.getManager(i).listModels()]):[3,4];case 2:for(s in o=a.sent())e[i+Ed+s]=o[s];a.label=3;case 3:return t++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(n,e){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){return[2,jS(n,e,!0)]}))}))},removeModel:function(n){return Nt(this,void 0,void 0,(function(){var e;return Rt(this,(function(t){return e=Iv(n),[2,Qc.getManager(e.scheme).removeModel(e.path)]}))}))}}),Jf;xe({confusionMatrix_:function(n,e,t){var r=oe(n,"labels","confusionMatrix"),i=oe(e,"predictions","confusionMatrix");me(t==null||t>0&&Number.isInteger(t),(function(){return"If provided, numClasses must be a positive integer, but got "+t})),me(r.rank===1,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),me(i.rank===1,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),me(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),me(t>0&&Number.isInteger(t),(function(){return"numClasses is required to be a positive integer, but got "+t}));var o=cw(r.asType("int32"),t),s=cw(i.asType("int32"),t);return o.transpose().matMul(s).asType("int32")}});var N9=xe({fromPixels_:function(n,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var t=!1,r=!1,i=!1,o=!1,s=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)o=!0;else{if(n.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+n.constructor.name);s=!0}if(i&&i&&n.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(TI("FromPixels",Ie.backendName)!=null)return Ie.runKernel("FromPixels",{pixels:n},{numChannels:e});var a,u,l=i?[n.videoWidth,n.videoHeight]:[n.width,n.height],h=l[0],d=l[1];if(s?a=n.getContext("2d").getImageData(0,0,h,d).data:r||t?a=n.data:(o||i)&&(Jf==null&&(Jf=document.createElement("canvas").getContext("2d")),Jf.canvas.width=h,Jf.canvas.height=d,Jf.drawImage(n,0,0,h,d),a=Jf.getImageData(0,0,h,d).data),e===4)u=new Int32Array(a);else{var m=h*d;u=new Int32Array(m*e);for(var p=0;p<m;p++)for(var y=0;y<e;++y)u[p*e+y]=a[4*p+y]}return Hb(u,[d,h,e],"int32")}}),vx=Object.freeze({toPixels:function(n,e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,I,D,U,L,C;return Rt(this,(function(A){switch(A.label){case 0:if(t=oe(n,"img","toPixels"),n instanceof $r||(t=t.toInt()),t.rank!==2&&t.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+t.rank+".");if(r=t.shape.slice(0,2),i=r[0],o=r[1],(s=t.rank===2?1:t.shape[2])>4||s===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,t.data()];case 1:return a=A.sent(),u=t.min(),l=t.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(h=A.sent(),d=h[0],m=h[1],p=d[0],y=m[0],u.dispose(),l.dispose(),t.dtype==="float32"){if(p<0||y>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+p+" - "+y+"].")}else{if(t.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+t.dtype+". Please use float32 or int32 tensors.");if(p<0||y>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+p+" - "+y+"].")}for(b=t.dtype==="float32"?255:1,x=new Uint8ClampedArray(o*i*4),E=0;E<i*o;++E)T=void 0,P=void 0,I=void 0,D=void 0,s===1?(T=a[E]*b,P=a[E]*b,I=a[E]*b,D=255):s===3?(T=a[3*E]*b,P=a[3*E+1]*b,I=a[3*E+2]*b,D=255):s===4&&(T=a[4*E]*b,P=a[4*E+1]*b,I=a[4*E+2]*b,D=a[4*E+3]*b),x[(U=4*E)+0]=Math.round(T),x[U+1]=Math.round(P),x[U+2]=Math.round(I),x[U+3]=Math.round(D);return e!=null&&(e.width=o,e.height=i,L=e.getContext("2d"),C=new ImageData(x,o,i),L.putImageData(C,0,0)),t!==n&&t.dispose(),[2,x]}}))}))},fromPixels:N9}),R9=(function(){function n(){}return n.prototype.getClassName=function(){return this.constructor.className},n.fromConfig=function(e,t){return new e(t)},n})(),P9=(function(){function n(){this.classNameMap={}}return n.getMap=function(){return n.instance==null&&(n.instance=new n),n.instance},n.register=function(e){n.getMap().classNameMap[e.className]=[e,e.fromConfig]},n})();function _f(n){me(n.className!=null,(function(){return"Class being registered does not have the static className property defined."})),me(typeof n.className=="string",(function(){return"className is required to be a string, but got type "+typeof n.className})),me(n.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),P9.register(n)}var Ef=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Su(e,n),e.prototype.minimize=function(t,r,i){r===void 0&&(r=!1);var o=this.computeGradients(t,i),s=o.value,a=o.grads;if(i!=null){var u=i.map((function(l){return{name:l.name,tensor:a[l.name]}}));this.applyGradients(u)}else this.applyGradients(a);return qs(a),r?s:(s.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,r){return z8(t,r)},e.prototype.dispose=function(){this.iterations_!=null&&qs(this.iterations_)},e.prototype.saveIterations=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:dt(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return Nt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){switch(i.label){case 0:return r=this,[4,t[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,t.slice(1)]}}))}))},e})(R9);Object.defineProperty(Ef,Symbol.hasInstance,{value:function(n){return n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null}});var D9=(function(n){function e(t,r,i){i===void 0&&(i=null);var o=n.call(this)||this;return o.learningRate=t,o.rho=r,o.epsilon=i,o.accumulatedGrads=[],o.accumulatedUpdates=[],i==null&&(o.epsilon=Ie.backend.epsilon()),o}return Su(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Ie.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accum_grad",variable:_t((function(){return zn(s).variable(!1)}))}),r.accumulatedUpdates[o]==null&&(r.accumulatedUpdates[o]={originalName:i+"/accum_var",variable:_t((function(){return zn(s).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[i];if(a!=null){var u=r.accumulatedGrads[o].variable,l=r.accumulatedUpdates[o].variable;_t((function(){var h=u.mul(r.rho).add(a.square().mul(1-r.rho)),d=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(a),m=l.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(h),l.assign(m);var p=d.mul(-r.learningRate).add(s);s.assign(p)}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(qs(this.accumulatedGrads.map((function(t){return t.variable}))),qs(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){var t;return Rt(this,(function(r){switch(r.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map((function(i){return{name:i.originalName,tensor:i.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),r=t.length/2,this.accumulatedGrads=t.slice(0,r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(r,2*r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,r){return new t(r.learningRate,r.rho,r.epsilon)},e.className="Adadelta",e})(Ef);_f(D9);var L9=(function(n){function e(t,r){r===void 0&&(r=.1);var i=n.call(this)||this;return i.learningRate=t,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return Su(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Ie.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accumulator",variable:_t((function(){return cl(s.shape,r.initialAccumulatorValue).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[i];if(a!=null){var u=r.accumulatedGrads[o].variable;_t((function(){var l=u.add(a.square());u.assign(l);var h=a.div(l.add(Ie.backend.epsilon()).sqrt()).mul(-r.learningRate).add(s);s.assign(h)}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&qs(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(r){return{name:r.originalName,tensor:r.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulatedGrads=t.map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,r){return new t(r.learningRate,r.initialAccumulatorValue)},e.className="Adagrad",e})(Ef);_f(L9);var M9=(function(n){function e(t,r,i,o){o===void 0&&(o=null);var s=n.call(this)||this;return s.learningRate=t,s.beta1=r,s.beta2=i,s.epsilon=o,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],_t((function(){s.accBeta1=dt(r).variable(),s.accBeta2=dt(i).variable()})),o==null&&(s.epsilon=Ie.backend.epsilon()),s}return Su(e,n),e.prototype.applyGradients=function(t){var r=this,i=Array.isArray(t)?t.map((function(o){return o.name})):Object.keys(t);_t((function(){var o=Ki(1,r.accBeta1),s=Ki(1,r.accBeta2);i.forEach((function(a,u){var l=Ie.registeredVariables[a];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:a+"/m",variable:_t((function(){return zn(l).variable(!1)}))}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:a+"/v",variable:_t((function(){return zn(l).variable(!1)}))});var h=Array.isArray(t)?t[u].tensor:t[a];if(h!=null){var d=r.accumulatedFirstMoment[u].variable,m=r.accumulatedSecondMoment[u].variable,p=d.mul(r.beta1).add(h.mul(1-r.beta1)),y=m.mul(r.beta2).add(h.square().mul(1-r.beta2)),b=p.div(o),x=y.div(s);d.assign(p),m.assign(y);var E=b.div(x.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(E)}})),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&qs(this.accumulatedFirstMoment.map((function(t){return t.variable}))),this.accumulatedSecondMoment!=null&&qs(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){var t;return Rt(this,(function(r){switch(r.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map((function(i){return{name:i.originalName,tensor:i.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){var r,i=this;return Rt(this,(function(o){switch(o.label){case 0:return[4,this.extractIterations(t)];case 1:return t=o.sent(),_t((function(){i.accBeta1.assign(d0(i.beta1,i.iterations_+1)),i.accBeta2.assign(d0(i.beta2,i.iterations_+1))})),r=t.length/2,this.accumulatedFirstMoment=t.slice(0,r).map((function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(r,2*r).map((function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon)},e.className="Adam",e})(Ef);_f(M9);var O9=(function(n){function e(t,r,i,o,s){o===void 0&&(o=null),s===void 0&&(s=0);var a=n.call(this)||this;return a.learningRate=t,a.beta1=r,a.beta2=i,a.epsilon=o,a.decay=s,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],_t((function(){a.iteration=dt(0).variable(),a.accBeta1=dt(r).variable()})),o==null&&(a.epsilon=Ie.backend.epsilon()),a}return Su(e,n),e.prototype.applyGradients=function(t){var r=this,i=Array.isArray(t)?t.map((function(o){return o.name})):Object.keys(t);_t((function(){var o=Ki(1,r.accBeta1),s=gu(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach((function(a,u){var l=Ie.registeredVariables[a];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:a+"/m",variable:zn(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:a+"/v",variable:zn(l).variable(!1)});var h=Array.isArray(t)?t[u].tensor:t[a];if(h!=null){var d=r.accumulatedFirstMoment[u].variable,m=r.accumulatedWeightedInfNorm[u].variable,p=d.mul(r.beta1).add(h.mul(1-r.beta1)),y=m.mul(r.beta2),b=h.abs(),x=y.maximum(b);d.assign(p),m.assign(x);var E=s.div(o).mul(p.div(x.add(r.epsilon))).add(l);l.assign(E)}})),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&qs(this.accumulatedFirstMoment.map((function(t){return t.variable}))),this.accumulatedWeightedInfNorm!=null&&qs(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},e.className="Adamax",e})(Ef);_f(O9);var ok=(function(n){function e(t){var r=n.call(this)||this;return r.learningRate=t,r.setLearningRate(t),r}return Su(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Array.isArray(t)?t[o].tensor:t[i];if(s!=null){var a=Ie.registeredVariables[i];_t((function(){var u=r.c.mul(s).add(a);a.assign(u)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=n8(dt(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:if((t=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,r){return new t(r.learningRate)},e.className="SGD",e})(Ef);_f(ok);var F9=(function(n){function e(t,r,i){i===void 0&&(i=!1);var o=n.call(this,t)||this;return o.learningRate=t,o.momentum=r,o.useNesterov=i,o.accumulations=[],o.m=dt(o.momentum),o}return Su(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Ie.registeredVariables[i];r.accumulations[o]==null&&(r.accumulations[o]={originalName:i+"/momentum",variable:_t((function(){return zn(s).variable(!1)}))});var a=r.accumulations[o].variable,u=Array.isArray(t)?t[o].tensor:t[i];u!=null&&_t((function(){var l,h=r.m.mul(a).add(u);l=r.useNesterov?r.c.mul(u.add(h.mul(r.m))).add(s):r.c.mul(h).add(s),a.assign(h),s.assign(l)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&qs(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(r){return{name:r.originalName,tensor:r.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulations=t.map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,r){return new t(r.learningRate,r.momentum,r.useNesterov)},e.className="Momentum",e})(ok);_f(F9);var B9=(function(n){function e(t,r,i,o,s){r===void 0&&(r=.9),i===void 0&&(i=0),o===void 0&&(o=null),s===void 0&&(s=!1);var a=n.call(this)||this;if(a.learningRate=t,a.decay=r,a.momentum=i,a.epsilon=o,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=s,o==null&&(a.epsilon=Ie.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return a}return Su(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Ie.registeredVariables[i];r.accumulatedMeanSquares[o]==null&&(r.accumulatedMeanSquares[o]={originalName:i+"/rms",variable:_t((function(){return zn(s).variable(!1)}))}),r.accumulatedMoments[o]==null&&(r.accumulatedMoments[o]={originalName:i+"/momentum",variable:_t((function(){return zn(s).variable(!1)}))}),r.accumulatedMeanGrads[o]==null&&r.centered&&(r.accumulatedMeanGrads[o]={originalName:i+"/mg",variable:_t((function(){return zn(s).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[i];if(a!=null){var u=r.accumulatedMeanSquares[o].variable,l=r.accumulatedMoments[o].variable;_t((function(){var h=u.mul(r.decay).add(a.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[o].variable,m=d.mul(r.decay).add(a.mul(1-r.decay)),p=l.mul(r.momentum).add(a.mul(r.learningRate).div(h.sub(m.square().add(r.epsilon)).sqrt()));u.assign(h),d.assign(m),l.assign(p);var y=s.sub(p);s.assign(y)}else{var b=u.mul(r.decay).add(a.square().mul(1-r.decay));p=l.mul(r.momentum).add(a.mul(r.learningRate).div(b.add(r.epsilon).sqrt())),u.assign(b),l.assign(p),y=s.sub(p),s.assign(y)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&qs(this.accumulatedMeanSquares.map((function(t){return t.variable}))),this.accumulatedMeanGrads!=null&&this.centered&&qs(this.accumulatedMeanGrads.map((function(t){return t.variable}))),this.accumulatedMoments!=null&&qs(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){var t;return Rt(this,(function(r){switch(r.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map((function(i){return{name:i.originalName,tensor:i.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),r=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(r,2*r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*r,3*r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,r){return new t(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},e.className="RMSProp",e})(Ef);_f(B9);$r.prototype.squaredDifference=function(n){return bT(this,n)},ze=c9;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bw=function(n,e){return bw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},bw(n,e)};function vn(n,e){bw(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var rs=function(){return rs=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},rs.apply(this,arguments)};function jt(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(h){try{l(r.next(h))}catch(d){s(d)}}function u(h){try{l(r.throw(h))}catch(d){s(d)}}function l(h){h.done?o(h.value):i(h.value).then(a,u)}l((r=r.apply(n,[])).next())})}function Ut(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(h){return u([l,h])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){t.label=l[1];break}if(l[0]===6&&t.label<o[1]){t.label=o[1],o=l;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(l);break}o[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(h){l=[6,h],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function sm(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var of=(function(){function n(e,t){if(!sf(e)||!sf(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}return Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),n.prototype.reverse=function(){return new n(1/this.width,1/this.height)},n})();function Z0(n,e){return n instanceof $r&&n.shape.length===e}function V9(n){return Z0(n,2)}function e1(n){return Z0(n,3)}function Jc(n){return Z0(n,4)}function j9(n){return n%1!==0}function $S(n){return n%2===0}function U9(n,e){e===void 0&&(e=2);var t=Math.pow(10,e);return Math.floor(n*t)/t}function KS(n){return n&&n.width&&n.height}function z9(n,e){var t=n.width,r=n.height,i=e/Math.max(r,t);return new of(Math.round(t*i),Math.round(r*i))}function yx(n){return n.reduce(function(e,t){return e.add(t)},new er(0,0)).div(new er(n.length,n.length))}function Am(n,e,t){return Array(n).fill(0).map(function(r,i){return e+i*t})}function sf(n){return!!n&&n!==1/0&&n!==-1/0&&!isNaN(n)||n===0}function XS(n){return sf(n)&&0<=n&&n<=1}var er=(function(){function n(e,t){this._x=e,this._y=t}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.add=function(e){return new n(this.x+e.x,this.y+e.y)},n.prototype.sub=function(e){return new n(this.x-e.x,this.y-e.y)},n.prototype.mul=function(e){return new n(this.x*e.x,this.y*e.y)},n.prototype.div=function(e){return new n(this.x/e.x,this.y/e.y)},n.prototype.abs=function(){return new n(Math.abs(this.x),Math.abs(this.y))},n.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.floor=function(){return new n(Math.floor(this.x),Math.floor(this.y))},n})(),lh=(function(){function n(e,t){t===void 0&&(t=!0);var r=e||{},i=[r.left,r.top,r.right,r.bottom].every(sf),o=[r.x,r.y,r.width,r.height].every(sf);if(!o&&!i)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var s=o?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],a=s[0],u=s[1],l=s[2],h=s[3];n.assertIsValidBox({x:a,y:u,width:l,height:h},"Box.constructor",t),this._x=a,this._y=u,this._width=l,this._height=h}return n.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(sf)},n.assertIsValidBox=function(e,t,r){if(r===void 0&&(r=!1),!n.isRect(e))throw new Error(t+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(t+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topLeft",{get:function(){return new er(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topRight",{get:function(){return new er(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomLeft",{get:function(){return new er(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomRight",{get:function(){return new er(this.right,this.bottom)},enumerable:!0,configurable:!0}),n.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(s){return Math.round(s)}),t=e[0],r=e[1],i=e[2],o=e[3];return new n({x:t,y:r,width:i,height:o})},n.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(s){return Math.floor(s)}),t=e[0],r=e[1],i=e[2],o=e[3];return new n({x:t,y:r,width:i,height:o})},n.prototype.toSquare=function(){var e=this,t=e.x,r=e.y,i=e.width,o=e.height,s=Math.abs(i-o);return i<o&&(t-=s/2,i+=s),o<i&&(r-=s/2,o+=s),new n({x:t,y:r,width:i,height:o})},n.prototype.rescale=function(e){var t=KS(e)?e.width:e,r=KS(e)?e.height:e;return new n({x:this.x*t,y:this.y*r,width:this.width*t,height:this.height*r})},n.prototype.pad=function(e,t){var r=[this.x-e/2,this.y-t/2,this.width+e,this.height+t],i=r[0],o=r[1],s=r[2],a=r[3];return new n({x:i,y:o,width:s,height:a})},n.prototype.clipAtImageBorders=function(e,t){var r=this,i=r.x,o=r.y,s=r.right,a=r.bottom,u=Math.max(i,0),l=Math.max(o,0),h=s-u,d=a-l,m=Math.min(h,e-u),p=Math.min(d,t-l);return new n({x:u,y:l,width:m,height:p}).floor()},n.prototype.shift=function(e,t){var r=this,i=r.width,o=r.height,s=this.x+e,a=this.y+t;return new n({x:s,y:a,width:i,height:o})},n.prototype.padAtBorders=function(e,t){var r=this.width+1,i=this.height+1,o=1,s=1,a=r,u=i,l=this.left,h=this.top,d=this.right,m=this.bottom;return d>t&&(a=-d+t+r,d=t),m>e&&(u=-m+e+i,m=e),l<1&&(u=2-l,l=1),h<1&&(u=2-h,h=1),{dy:s,edy:u,dx:o,edx:a,y:h,ey:m,x:l,ex:d,w:r,h:i}},n.prototype.calibrate=function(e){return new n({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},n})(),t1=(function(n){vn(e,n);function e(t,r,i,o,s){return s===void 0&&(s=!1),n.call(this,{left:t,top:r,right:i,bottom:o},s)||this}return e})(lh),sk=(function(){function n(e,t,r,i,o){this._imageDims=new of(o.width,o.height),this._score=e,this._classScore=t,this._className=r,this._box=new lh(i).rescale(this._imageDims)}return Object.defineProperty(n.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativeBox",{get:function(){return new lh(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),n.prototype.forSize=function(e,t){return new n(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:t})},n})(),Cu=(function(n){vn(e,n);function e(t,r,i){return n.call(this,t,t,"",r,i)||this}return e.prototype.forSize=function(t,r){var i=n.prototype.forSize.call(this,t,r),o=i.score,s=i.relativeBox,a=i.imageDims;return new e(o,s,a)},e})(sk);function W9(n,e,t){t===void 0&&(t=!0);var r=Math.max(0,Math.min(n.right,e.right)-Math.max(n.left,e.left)),i=Math.max(0,Math.min(n.bottom,e.bottom)-Math.max(n.top,e.top)),o=r*i;return t?o/(n.area+e.area-o):o/Math.min(n.area,e.area)}function q9(n){var e=n.map(function(a){return a.x}),t=n.map(function(a){return a.y}),r=e.reduce(function(a,u){return u<a?u:a},1/0),i=t.reduce(function(a,u){return u<a?u:a},1/0),o=e.reduce(function(a,u){return a<u?u:a},0),s=t.reduce(function(a,u){return a<u?u:a},0);return new t1(r,i,o,s)}function Cm(n,e,t,r){r===void 0&&(r=!0);for(var i=e.map(function(a,u){return{score:a,boxIndex:u}}).sort(function(a,u){return a.score-u.score}).map(function(a){return a.boxIndex}),o=[],s=function(){var a=i.pop();o.push(a);for(var u=i,l=[],h=0;h<u.length;h++){var d=u[h],m=n[a],p=n[d];l.push(W9(m,p,r))}i=i.filter(function(y,b){return l[b]<=t})};i.length>0;)s();return o}function Ym(n,e){return _t(function(){var t=e[0],r=e[1],i=e[2],o=cl(sm(n.shape.slice(0,3),[1]),t),s=cl(sm(n.shape.slice(0,3),[1]),r),a=cl(sm(n.shape.slice(0,3),[1]),i),u=qi([o,s,a],3);return Ki(n,u)})}function H9(n,e){return e===void 0&&(e=!1),_t(function(){var t=n.shape.slice(1),r=t[0],i=t[1];if(r===i)return n;var o=Math.abs(r-i),s=Math.round(o*(e?.5:1)),a=r>i?2:1,u=function(p){var y=n.shape.slice();return y[a]=p,cl(y,0)},l=u(s),h=o-l.shape[a],d=e&&h?u(h):null,m=[d,n,l].filter(function(p){return!!p}).map(function(p){return p.toFloat()});return qi(m,a)})}function Zy(n){return 1/(1+Math.exp(-n))}var wx=(function(n){vn(e,n);function e(t,r,i,o,s){return s===void 0&&(s=!1),n.call(this,{x:t,y:r,width:i,height:o},s)||this}return e})(lh),G9=.5,$9=.43,K9=.45,Im=(function(){function n(e,t,r){r===void 0&&(r=new er(0,0));var i=t.width,o=t.height;this._imgDims=new of(i,o),this._shift=r,this._positions=e.map(function(s){return s.mul(new er(i,o)).add(r)})}return Object.defineProperty(n.prototype,"shift",{get:function(){return new er(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(t){return t.sub(e._shift).div(new er(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),n.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},n.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new er(e,t))},n.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},n.prototype.align=function(e,t){if(t===void 0&&(t={}),e){var r=e instanceof Cu?e.box.floor():new lh(e);return this.shiftBy(r.x,r.y).align(null,t)}var i=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),o=i.useDlibAlignment,s=i.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(s)},n.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),t=e[0],r=e[1],i=e[2],o=function(d){return i.sub(d).magnitude()},s=(o(t)+o(r))/2,a=Math.floor(s/K9),u=yx(e),l=Math.floor(Math.max(0,u.x-G9*a)),h=Math.floor(Math.max(0,u.y-$9*a));return new wx(l,h,Math.min(a,this.imageWidth+l),Math.min(a,this.imageHeight+h))},n.prototype.alignMinBbox=function(e){var t=q9(this.positions);return t.pad(t.width*e,t.height*e)},n.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},n})(),X9=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],yx([t[3],t[4]])]},e})(Im),Y9=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(yx)},e})(Im),YS=(function(){function n(e,t){this._label=e,this._distance=t}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),n.prototype.toString=function(e){return e===void 0&&(e=!0),""+this.label+(e?" ("+U9(this.distance)+")":"")},n})(),QS=(function(n){vn(e,n);function e(t,r){var i=n.call(this,t)||this;return i._label=r,i}return e.assertIsValidLabeledBox=function(t,r){if(lh.assertIsValidBox(t,r),!sf(t.label))throw new Error(r+" - expected property label ("+t.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e})(lh),iv=(function(){function n(e,t){if(typeof e!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),n.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},n.fromJSON=function(e){var t=e.descriptors.map(function(r){return new Float32Array(r)});return new n(e.label,t)},n})();(function(n){vn(e,n);function e(t,r,i,o){var s=n.call(this,t,r)||this;return s._score=i,s._classScore=o,s}return e.assertIsValidPredictedBox=function(t,r){if(QS.assertIsValidLabeledBox(t,r),!XS(t.score)||!XS(t.classScore))throw new Error(r+" - expected properties score ("+t.score+") and ("+t.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),e})(QS);function ak(n){return n.detection instanceof Cu}function Tm(n,e){var t={detection:e};return Object.assign({},n,t)}function uk(){var n=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},e=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:n,readFile:e}}function lk(n){var e="";if(!n)try{n=require("fs")}catch(r){e=r.toString()}var t=n?function(r){return new Promise(function(i,o){n.readFile(r,function(s,a){return s?o(s):i(a)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)};return{readFile:t}}function ck(){var n=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,t=function(){if(n)return new n;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},i=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},o=lk();return rs({Canvas:n||(function(){function s(){}return s})(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||(function(){function s(){}return s})(),Image:e||(function(){function s(){}return s})(),ImageData:global.ImageData||(function(){function s(){}return s})(),Video:global.HTMLVideoElement||(function(){function s(){}return s})(),createCanvasElement:t,createImageElement:r,fetch:i},o)}function hk(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function fk(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var zi;function Q9(){if(!zi)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return zi}function xw(n){zi=n}function bx(){hk()&&xw(uk()),fk()&&xw(ck())}function J9(n){if(zi||bx(),!zi)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=n.Canvas,t=e===void 0?zi.Canvas:e,r=n.Image,i=r===void 0?zi.Image:r;zi.Canvas=t,zi.Image=i,zi.createCanvasElement=n.createCanvasElement||(function(){return new t}),zi.createImageElement=n.createImageElement||(function(){return new i}),zi.ImageData=n.ImageData||zi.ImageData,zi.Video=n.Video||zi.Video,zi.fetch=n.fetch||zi.fetch,zi.readFile=n.readFile||zi.readFile}var Do={getEnv:Q9,setEnv:xw,initialize:bx,createBrowserEnv:uk,createFileSystem:lk,createNodejsEnv:ck,monkeyPatch:J9,isBrowser:hk,isNodejs:fk};bx();function dk(n){return!Do.isNodejs()&&typeof n=="string"?document.getElementById(n):n}function hf(n){var e=Do.getEnv(),t=e.Canvas,r=e.CanvasRenderingContext2D;if(n instanceof r)return n;var i=dk(n);if(!(i instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=i.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}var JS;(function(n){n.TOP_LEFT="TOP_LEFT",n.TOP_RIGHT="TOP_RIGHT",n.BOTTOM_LEFT="BOTTOM_LEFT",n.BOTTOM_RIGHT="BOTTOM_RIGHT"})(JS||(JS={}));function pk(n){var e=Do.getEnv(),t=e.Image,r=e.Video;return n instanceof t&&n.complete||n instanceof r&&n.readyState>=3}function Z9(n){return new Promise(function(e,t){if(n instanceof Do.getEnv().Canvas||pk(n))return e();function r(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",i),e(o))}function i(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",i),t(o))}n.addEventListener("load",r),n.addEventListener("error",i)})}function eU(n){return new Promise(function(e,t){if(!(n instanceof Blob))return t("bufferToImage - expected buf to be of type: Blob");var r=new FileReader;r.onload=function(){if(typeof r.result!="string")return t("bufferToImage - expected reader.result to be a string, in onload");var i=Do.getEnv().createImageElement();i.onload=function(){return e(i)},i.onerror=t,i.src=r.result},r.onerror=t,r.readAsDataURL(n)})}function mk(n){var e=Do.getEnv(),t=e.Image,r=e.Video;return n instanceof t?new of(n.naturalWidth,n.naturalHeight):n instanceof r?new of(n.videoWidth,n.videoHeight):new of(n.width,n.height)}function n1(n){var e=n.width,t=n.height,r=Do.getEnv().createCanvasElement,i=r();return i.width=e,i.height=t,i}function xx(n,e){var t=Do.getEnv().ImageData;if(!(n instanceof t)&&!pk(n))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=mk(n),i=r.width,o=r.height,s=n1({width:i,height:o});return n instanceof t?hf(s).putImageData(n,0,0):hf(s).drawImage(n,0,0,i,o),s}function tU(n,e){return jt(this,void 0,void 0,function(){var t,r,i,o,s,a;return Ut(this,function(u){switch(u.label){case 0:return t=Do.getEnv().createCanvasElement(),r=n.shape.slice(Jc(n)?1:0),i=r[0],o=r[1],s=r[2],a=_t(function(){return n.as3D(i,o,s).toInt()}),[4,vx.toPixels(a,t)];case 1:return u.sent(),a.dispose(),[2,t]}})})}function ZS(n){var e=Do.getEnv(),t=e.Image,r=e.Canvas,i=e.Video;return n instanceof t||n instanceof r||n instanceof i}function nU(n,e,t){t===void 0&&(t=!1);var r=Do.getEnv(),i=r.Image,o=r.Canvas;if(!(n instanceof i||n instanceof o))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var s=mk(n),a=e/Math.max(s.height,s.width),u=a*s.width,l=a*s.height,h=n1({width:e,height:e}),d=n instanceof o?n:xx(n),m=Math.abs(u-l)/2,p=t&&u<l?m:0,y=t&&l<u?m:0;return hf(h).drawImage(d,p,y,u,l),h}var g0=(function(){function n(e,t){var r=this;if(t===void 0&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach(function(i,o){if(e1(i)){r._imageTensors[o]=i,r._inputDimensions[o]=i.shape;return}if(Jc(i)){var s=i.shape[0];if(s!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+s+" passed, but not supported in input array");r._imageTensors[o]=i,r._inputDimensions[o]=i.shape.slice(1);return}var a=i instanceof Do.getEnv().Canvas?i:xx(i);r._canvases[o]=a,r._inputDimensions[o]=[a.height,a.width,3]})}return Object.defineProperty(n.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Am(this.batchSize,0,1).map(function(t,r){return e.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),n.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},n.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},n.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},n.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},n.prototype.getReshapedInputDimensions=function(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var t=this.getInputWidth(e),r=this.getInputHeight(e);return z9({width:t,height:r},this.inputSize)},n.prototype.toBatchTensor=function(e,t){var r=this;return t===void 0&&(t=!0),this._inputSize=e,_t(function(){var i=Am(r.batchSize,0,1).map(function(s){var a=r.getInput(s);if(a instanceof $r){var u=Jc(a)?a:a.expandDims();return u=H9(u,t),(u.shape[1]!==e||u.shape[2]!==e)&&(u=hx.resizeBilinear(u,[e,e])),u.as3D(e,e,3)}if(a instanceof Do.getEnv().Canvas)return vx.fromPixels(nU(a,e,t));throw new Error("toBatchTensor - at batchIdx "+s+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+a)}),o=wa(i.map(function(s){return s.toFloat()})).as4D(r.batchSize,e,e,3);return o})},n})();function mo(n){return jt(this,void 0,void 0,function(){var e,t,r;return Ut(this,function(i){switch(i.label){case 0:if(n instanceof g0)return[2,n];if(e=Array.isArray(n)?n:[n],!e.length)throw new Error("toNetInput - empty array passed as input");return t=function(o){return Array.isArray(n)?" at input index "+o+":":""},r=e.map(dk),r.forEach(function(o,s){if(!ZS(o)&&!e1(o)&&!Jc(o))throw typeof e[s]=="string"?new Error("toNetInput -"+t(s)+" string passed, but could not resolve HTMLElement for element id "+e[s]):new Error("toNetInput -"+t(s)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Jc(o)){var a=o.shape[0];if(a!==1)throw new Error("toNetInput -"+t(s)+" tf.Tensor4D with batchSize "+a+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(o){return ZS(o)&&Z9(o)}))];case 1:return i.sent(),[2,new g0(r,Array.isArray(n))]}})})}function _x(n,e){return jt(this,void 0,void 0,function(){var t,r,i,o,s,a,u;return Ut(this,function(l){switch(l.label){case 0:return t=Do.getEnv().Canvas,r=n,n instanceof t?[3,5]:[4,mo(n)];case 1:if(i=l.sent(),i.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return o=i.getInput(0),o instanceof t?(s=o,[3,4]):[3,2];case 2:return[4,tU(o)];case 3:s=l.sent(),l.label=4;case 4:r=s,l.label=5;case 5:return a=hf(r),u=e.map(function(h){return h instanceof Cu?h.forSize(r.width,r.height).box.floor():h}).map(function(h){return h.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(h){var d=h.x,m=h.y,p=h.width,y=h.height,b=n1({width:p,height:y});return hf(b).putImageData(a.getImageData(d,m,p,y),0,0),b})]}})})}function Ex(n,e){return jt(this,void 0,void 0,function(){return Ut(this,function(t){if(!e1(n)&&!Jc(n))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Jc(n)&&n.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,_t(function(){var r=n.shape.slice(Jc(n)?1:0),i=r[0],o=r[1],s=r[2],a=e.map(function(l){return l instanceof Cu?l.forSize(o,i).box:l}).map(function(l){return l.clipAtImageBorders(o,i)}),u=a.map(function(l){var h=l.x,d=l.y,m=l.width,p=l.height;return UT(n.as3D(i,o,s),[d,h,0],[p,m,s])});return u})]})})}function rU(n,e){return jt(this,void 0,void 0,function(){var t,r;return Ut(this,function(i){switch(i.label){case 0:return t=Do.getEnv().fetch,[4,t(n,e)];case 1:if(r=i.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function iU(n){return jt(this,void 0,void 0,function(){return Ut(this,function(e){switch(e.label){case 0:return[4,rU(n)];case 1:return[2,e.sent().json()]}})})}function gk(n,e){var t=e+"-weights_manifest.json";if(!n)return{modelBaseUri:"",manifestUri:t};if(n==="/")return{modelBaseUri:"/",manifestUri:"/"+t};var r=n.startsWith("http://")?"http://":n.startsWith("https://")?"https://":"";n=n.replace(r,"");var i=n.split("/").filter(function(a){return a}),o=n.endsWith(".json")?i[i.length-1]:t,s=r+(n.endsWith(".json")?i.slice(0,i.length-1):i).join("/");return s=n.startsWith("/")?"/"+s:s,{modelBaseUri:s,manifestUri:s==="/"?"/"+o:s+"/"+o}}function oU(n,e){return jt(this,void 0,void 0,function(){var t,r,i,o;return Ut(this,function(s){switch(s.label){case 0:return t=gk(n,e),r=t.manifestUri,i=t.modelBaseUri,[4,iU(r)];case 1:return o=s.sent(),[2,ik.loadWeights(o,i)]}})})}var sc=(function(){function n(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(n.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),n.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e),r=t.obj,i=t.objProp;return r[i]},n.prototype.reassignParamFromPath=function(e,t){var r=this.traversePropertyPath(e),i=r.obj,o=r.objProp;i[o].dispose(),i[o]=t},n.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(t){var r=t.paramPath;return{path:r,tensor:e.getParamFromPath(r)}})},n.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof Wd})},n.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof Wd)})},n.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(t){var r=t.path,i=t.tensor;e.reassignParamFromPath(r,i.variable())})},n.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(t){var r=t.path,i=t.tensor,o=Po(i.dataSync());i.dispose(),e.reassignParamFromPath(r,o)})},n.prototype.dispose=function(e){e===void 0&&(e=!0),this.getParamList().forEach(function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()}),this._params=void 0},n.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var t=e.tensor;return Array.from(t.dataSync())}).reduce(function(e,t){return e.concat(t)}))},n.prototype.load=function(e){return jt(this,void 0,void 0,function(){return Ut(this,function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}})})},n.prototype.loadFromUri=function(e){return jt(this,void 0,void 0,function(){var t;return Ut(this,function(r){switch(r.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,oU(e,this.getDefaultModelName())];case 1:return t=r.sent(),this.loadFromWeightMap(t),[2]}})})},n.prototype.loadFromDisk=function(e){return jt(this,void 0,void 0,function(){var t,r,i,o,s,a,u,l,h,d;return Ut(this,function(m){switch(m.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return t=Do.getEnv().readFile,r=gk(e,this.getDefaultModelName()),i=r.manifestUri,o=r.modelBaseUri,s=function(p){return Promise.all(p.map(function(y){return t(y).then(function(b){return b.buffer})}))},a=ik.weightsLoaderFactory(s),h=(l=JSON).parse,[4,t(i)];case 1:return u=h.apply(l,[m.sent().toString()]),[4,a(u,o)];case 2:return d=m.sent(),this.loadFromWeightMap(d),[2]}})})},n.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),r=t.paramMappings,i=t.params;this._paramMappings=r,this._params=i},n.prototype.extractWeights=function(e){var t=this.extractParams(e),r=t.paramMappings,i=t.params;this._paramMappings=r,this._params=i},n.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce(function(o,s){if(!o.nextObj.hasOwnProperty(s))throw new Error("traversePropertyPath - object does not have property "+s+", for path "+e);return{obj:o.nextObj,objProp:s,nextObj:o.nextObj[s]}},{nextObj:this.params}),r=t.obj,i=t.objProp;if(!r||!i||!(r[i]instanceof $r))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:r,objProp:i}},n})();function ma(n,e,t){return _t(function(){var r=sx(n,e.depthwise_filter,e.pointwise_filter,t,"same");return r=Dn(r,e.bias),r})}function e2(n,e,t){return t===void 0&&(t=!1),_t(function(){var r=Yr(t?Dn($a(n,e.conv0.filters,[2,2],"same"),e.conv0.bias):ma(n,e.conv0,[2,2])),i=ma(r,e.conv1,[1,1]),o=Yr(Dn(r,i)),s=ma(o,e.conv2,[1,1]);return Yr(Dn(r,Dn(i,s)))})}function ov(n,e,t,r){return t===void 0&&(t=!1),r===void 0&&(r=!0),_t(function(){var i=Yr(t?Dn($a(n,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):ma(n,e.conv0,r?[2,2]:[1,1])),o=ma(i,e.conv1,[1,1]),s=Yr(Dn(i,o)),a=ma(s,e.conv2,[1,1]),u=Yr(Dn(i,Dn(o,a))),l=ma(u,e.conv3,[1,1]);return Yr(Dn(i,Dn(o,Dn(a,l))))})}function bu(n,e,t,r){return t===void 0&&(t="same"),r===void 0&&(r=!1),_t(function(){var i=Dn($a(n,e.filters,[1,1],t),e.bias);return r?Yr(i):i})}function ac(n,e){Object.keys(n).forEach(function(t){e.some(function(r){return r.originalPath===t})||n[t].dispose()})}function r1(n,e){return function(t,r,i,o){var s=zs(n(t*r*i*i),[i,i,t,r]),a=Di(n(r));return e.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:s,bias:a}}}function Sx(n,e){return function(t,r,i){var o=Yc(n(t*r),[t,r]),s=Di(n(r));return e.push({paramPath:i+"/weights"},{paramPath:i+"/bias"}),{weights:o,bias:s}}}var vk=(function(){function n(e,t,r){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=r}return n})();function Ax(n,e){return function(t,r,i){var o=zs(n(9*t),[3,3,t,1]),s=zs(n(t*r),[1,1,t,r]),a=Di(n(r));return e.push({paramPath:i+"/depthwise_filter"},{paramPath:i+"/pointwise_filter"},{paramPath:i+"/bias"}),new vk(o,s,a)}}function Cx(n){return function(e){var t=n(e+"/depthwise_filter",4),r=n(e+"/pointwise_filter",4),i=n(e+"/bias",1);return new vk(t,r,i)}}function xh(n,e){return function(t,r,i){var o=n[t];if(!Z0(o,r))throw new Error("expected weightMap["+t+"] to be a Tensor"+r+"D, instead have "+o);return e.push({originalPath:t,paramPath:i||t}),o}}function uc(n){var e=n;function t(i){var o=e.slice(0,i);return e=e.slice(i),o}function r(){return e}return{extractWeights:t,getRemainingWeights:r}}function yk(n,e){var t=r1(n,e),r=Ax(n,e);function i(s,a,u,l){l===void 0&&(l=!1);var h=l?t(s,a,3,u+"/conv0"):r(s,a,u+"/conv0"),d=r(a,a,u+"/conv1"),m=r(a,a,u+"/conv2");return{conv0:h,conv1:d,conv2:m}}function o(s,a,u,l){l===void 0&&(l=!1);var h=i(s,a,u,l),d=h.conv0,m=h.conv1,p=h.conv2,y=r(a,a,u+"/conv3");return{conv0:d,conv1:m,conv2:p,conv3:y}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:o}}function sU(n){var e=[],t=uc(n),r=t.extractWeights,i=t.getRemainingWeights,o=yk(r,e).extractDenseBlock4Params,s=o(3,32,"dense0",!0),a=o(32,64,"dense1"),u=o(64,128,"dense2"),l=o(128,256,"dense3");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{dense0:s,dense1:a,dense2:u,dense3:l}}}function wk(n){return function(e){var t=n(e+"/filters",4),r=n(e+"/bias",1);return{filters:t,bias:r}}}function bk(n,e){var t=xh(n,e),r=wk(t),i=Cx(t);function o(a,u){u===void 0&&(u=!1);var l=u?r(a+"/conv0"):i(a+"/conv0"),h=i(a+"/conv1"),d=i(a+"/conv2");return{conv0:l,conv1:h,conv2:d}}function s(a,u){u===void 0&&(u=!1);var l=u?r(a+"/conv0"):i(a+"/conv0"),h=i(a+"/conv1"),d=i(a+"/conv2"),m=i(a+"/conv3");return{conv0:l,conv1:h,conv2:d,conv3:m}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:s}}function aU(n){var e=[],t=bk(n,e).extractDenseBlock4Params,r={dense0:t("dense0",!0),dense1:t("dense1"),dense2:t("dense2"),dense3:t("dense3")};return ac(n,e),{params:r,paramMappings:e}}var xk=(function(n){vn(e,n);function e(){return n.call(this,"FaceFeatureExtractor")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return _t(function(){var i=t.toBatchTensor(112,!0),o=[122.782,117.001,104.298],s=Ym(i,o).div(dt(255)),a=ov(s,r.dense0,!0);return a=ov(a,r.dense1),a=ov(a,r.dense2),a=ov(a,r.dense3),a=Km(a,[7,7],[2,2],"valid"),a})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(t){return aU(t)},e.prototype.extractParams=function(t){return sU(t)},e})(sc);function il(n,e){return _t(function(){return Dn(Y0(n,e.weights),e.bias)})}function uU(n,e,t){var r=[],i=uc(n),o=i.extractWeights,s=i.getRemainingWeights,a=Sx(o,r),u=a(e,t,"fc");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:r,params:{fc:u}}}function lU(n){var e=[],t=xh(n,e);function r(o){var s=t(o+"/weights",2),a=t(o+"/bias",1);return{weights:s,bias:a}}var i={fc:r("fc")};return ac(n,e),{params:i,paramMappings:e}}function _k(n){var e={},t={};return Object.keys(n).forEach(function(r){var i=r.startsWith("fc")?t:e;i[r]=n[r]}),{featureExtractorMap:e,classifierMap:t}}var Ek=(function(n){vn(e,n);function e(t,r){var i=n.call(this,t)||this;return i._faceFeatureExtractor=r,i}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var r=this,i=this.params;if(!i)throw new Error(this._name+" - load model before inference");return _t(function(){var o=t instanceof g0?r.faceFeatureExtractor.forwardInput(t):t;return il(o.as2D(o.shape[0],-1),i.fc)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.faceFeatureExtractor.dispose(t),n.prototype.dispose.call(this,t)},e.prototype.loadClassifierParams=function(t){var r=this.extractClassifierParams(t),i=r.params,o=r.paramMappings;this._params=i,this._paramMappings=o},e.prototype.extractClassifierParams=function(t){return uU(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(t){var r=_k(t),i=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),lU(o)},e.prototype.extractParams=function(t){var r=this.getClassifierChannelsIn(),i=this.getClassifierChannelsOut(),o=i*r+i,s=t.slice(0,t.length-o),a=t.slice(t.length-o);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(a)},e})(sc),eA=["neutral","happy","sad","angry","fearful","disgusted","surprised"],cU=(function(){function n(e){var t=this;if(e.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);eA.forEach(function(r,i){t[r]=e[i]})}return n.prototype.asSortedArray=function(){var e=this;return eA.map(function(t){return{expression:t,probability:e[t]}}).sort(function(t,r){return r.probability-t.probability})},n})(),hU=(function(n){vn(e,n);function e(t){return t===void 0&&(t=new xk),n.call(this,"FaceExpressionNet",t)||this}return e.prototype.forwardInput=function(t){var r=this;return _t(function(){return ic(r.runNet(t))})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.predictExpressions=function(t){return jt(this,void 0,void 0,function(){var r,i,o,s,a=this;return Ut(this,function(u){switch(u.label){case 0:return[4,mo(t)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return i=u.sent(),[4,Promise.all(Hi(i).map(function(l){return jt(a,void 0,void 0,function(){var h;return Ut(this,function(d){switch(d.label){case 0:return[4,l.data()];case 1:return h=d.sent(),l.dispose(),[2,h]}})})}))];case 3:return o=u.sent(),i.dispose(),s=o.map(function(l){return new cU(l)}),[2,r.isBatchInput?s:s[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e})(Ek);function Sk(n,e){var t={expressions:e};return Object.assign({},n,t)}function Ak(n){return ak(n)&&n.landmarks instanceof Im&&n.unshiftedLandmarks instanceof Im&&n.alignedRect instanceof Cu}function i1(n,e){var t=n.detection.box,r=e.shiftBy(t.x,t.y),i=r.align(),o=n.detection.imageDims,s=new Cu(n.detection.score,i.rescale(o.reverse()),o),a={landmarks:r,unshiftedLandmarks:e,alignedRect:s};return Object.assign({},n,a)}function fU(n,e){var t=r1(n,e),r=Ax(n,e);function i(s,a,u){var l=r(s,a,u+"/separable_conv0"),h=r(a,a,u+"/separable_conv1"),d=t(s,a,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:h,expansion_conv:d}}function o(s,a){var u=r(s,s,a+"/separable_conv0"),l=r(s,s,a+"/separable_conv1"),h=r(s,s,a+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:h}}return{extractConvParams:t,extractSeparableConvParams:r,extractReductionBlockParams:i,extractMainBlockParams:o}}function dU(n,e){var t=[],r=uc(n),i=r.extractWeights,o=r.getRemainingWeights,s=fU(i,t),a=s.extractConvParams,u=s.extractSeparableConvParams,l=s.extractReductionBlockParams,h=s.extractMainBlockParams,d=a(3,32,3,"entry_flow/conv_in"),m=l(32,64,"entry_flow/reduction_block_0"),p=l(64,128,"entry_flow/reduction_block_1"),y={conv_in:d,reduction_block_0:m,reduction_block_1:p},b={};Am(e,0,1).forEach(function(P){b["main_block_"+P]=h(128,"middle_flow/main_block_"+P)});var x=l(128,256,"exit_flow/reduction_block"),E=u(256,512,"exit_flow/separable_conv"),T={reduction_block:x,separable_conv:E};if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{entry_flow:y,middle_flow:b,exit_flow:T}}}function pU(n,e){var t=xh(n,e),r=wk(t),i=Cx(t);function o(a){var u=i(a+"/separable_conv0"),l=i(a+"/separable_conv1"),h=r(a+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:h}}function s(a){var u=i(a+"/separable_conv0"),l=i(a+"/separable_conv1"),h=i(a+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:h}}return{extractConvParams:r,extractSeparableConvParams:i,extractReductionBlockParams:o,extractMainBlockParams:s}}function mU(n,e){var t=[],r=pU(n,t),i=r.extractConvParams,o=r.extractSeparableConvParams,s=r.extractReductionBlockParams,a=r.extractMainBlockParams,u=i("entry_flow/conv_in"),l=s("entry_flow/reduction_block_0"),h=s("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:l,reduction_block_1:h},m={};Am(e,0,1).forEach(function(x){m["main_block_"+x]=a("middle_flow/main_block_"+x)});var p=s("exit_flow/reduction_block"),y=o("exit_flow/separable_conv"),b={reduction_block:p,separable_conv:y};return ac(n,t),{params:{entry_flow:d,middle_flow:m,exit_flow:b},paramMappings:t}}function Ck(n,e,t){return Dn($a(n,e.filters,t,"same"),e.bias)}function t2(n,e,t){t===void 0&&(t=!0);var r=t?Yr(n):n;return r=ma(r,e.separable_conv0,[1,1]),r=ma(Yr(r),e.separable_conv1,[1,1]),r=co(r,[3,3],[2,2],"same"),r=Dn(r,Ck(n,e.expansion_conv,[2,2])),r}function gU(n,e){var t=ma(Yr(n),e.separable_conv0,[1,1]);return t=ma(Yr(t),e.separable_conv1,[1,1]),t=ma(Yr(t),e.separable_conv2,[1,1]),t=Dn(t,n),t}var vU=(function(n){vn(e,n);function e(t){var r=n.call(this,"TinyXception")||this;return r._numMainBlocks=t,r}return e.prototype.forwardInput=function(t){var r=this,i=this.params;if(!i)throw new Error("TinyXception - load model before inference");return _t(function(){var o=t.toBatchTensor(112,!0),s=[122.782,117.001,104.298],a=Ym(o,s).div(dt(256)),u=Yr(Ck(a,i.entry_flow.conv_in,[2,2]));return u=t2(u,i.entry_flow.reduction_block_0,!1),u=t2(u,i.entry_flow.reduction_block_1),Am(r._numMainBlocks,0,1).forEach(function(l){u=gU(u,i.middle_flow["main_block_"+l])}),u=t2(u,i.exit_flow.reduction_block),u=Yr(ma(u,i.exit_flow.separable_conv,[1,1])),u})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(t){return mU(t,this._numMainBlocks)},e.prototype.extractParams=function(t){return dU(t,this._numMainBlocks)},e})(sc);function yU(n){var e=[],t=uc(n),r=t.extractWeights,i=t.getRemainingWeights,o=Sx(r,e),s=o(512,1,"fc/age"),a=o(512,2,"fc/gender");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{fc:{age:s,gender:a}}}}function wU(n){var e=[],t=xh(n,e);function r(o){var s=t(o+"/weights",2),a=t(o+"/bias",1);return{weights:s,bias:a}}var i={fc:{age:r("fc/age"),gender:r("fc/gender")}};return ac(n,e),{params:i,paramMappings:e}}var v0;(function(n){n.FEMALE="female",n.MALE="male"})(v0||(v0={}));var bU=(function(n){vn(e,n);function e(t){t===void 0&&(t=new vU(2));var r=n.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=t,r}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var r=this,i=this.params;if(!i)throw new Error(this._name+" - load model before inference");return _t(function(){var o=t instanceof g0?r.faceFeatureExtractor.forwardInput(t):t,s=Km(o,[7,7],[2,2],"valid").as2D(o.shape[0],-1),a=il(s,i.fc.age).as1D(),u=il(s,i.fc.gender);return{age:a,gender:u}})},e.prototype.forwardInput=function(t){var r=this;return _t(function(){var i=r.runNet(t),o=i.age,s=i.gender;return{age:o,gender:ic(s)}})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.predictAgeAndGender=function(t){return jt(this,void 0,void 0,function(){var r,i,o,s,a,u,l=this;return Ut(this,function(h){switch(h.label){case 0:return[4,mo(t)];case 1:return r=h.sent(),[4,this.forwardInput(r)];case 2:return i=h.sent(),o=Hi(i.age),s=Hi(i.gender),a=o.map(function(d,m){return{ageTensor:d,genderTensor:s[m]}}),[4,Promise.all(a.map(function(d){var m=d.ageTensor,p=d.genderTensor;return jt(l,void 0,void 0,function(){var y,b,x,E,T;return Ut(this,function(P){switch(P.label){case 0:return[4,m.data()];case 1:return y=P.sent()[0],[4,p.data()];case 2:return b=P.sent()[0],x=b>.5,E=x?v0.MALE:v0.FEMALE,T=x?b:1-b,m.dispose(),p.dispose(),[2,{age:y,gender:E,genderProbability:T}]}})})}))];case 3:return u=h.sent(),i.age.dispose(),i.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.faceFeatureExtractor.dispose(t),n.prototype.dispose.call(this,t)},e.prototype.loadClassifierParams=function(t){var r=this.extractClassifierParams(t),i=r.params,o=r.paramMappings;this._params=i,this._paramMappings=o},e.prototype.extractClassifierParams=function(t){return yU(t)},e.prototype.extractParamsFromWeigthMap=function(t){var r=_k(t),i=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),wU(o)},e.prototype.extractParams=function(t){var r=1539,i=t.slice(0,t.length-r),o=t.slice(t.length-r);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(o)},e})(sc),Ik=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.postProcess=function(t,r,i){var o=i.map(function(a){var u=a.width,l=a.height,h=r/Math.max(l,u);return{width:u*h,height:l*h}}),s=o.length;return _t(function(){var a=function(m,p){return wa([cl([68],m),cl([68],p)],1).as2D(1,136).as1D()},u=function(m,p){var y=o[m],b=y.width,x=y.height;return p(b,x)?Math.abs(b-x)/2:0},l=function(m){return u(m,function(p,y){return p<y})},h=function(m){return u(m,function(p,y){return y<p})},d=t.mul(cl([s,136],r)).sub(wa(Array.from(Array(s),function(m,p){return a(l(p),h(p))}))).div(wa(Array.from(Array(s),function(m,p){return a(o[p].width,o[p].height)})));return d})},e.prototype.forwardInput=function(t){var r=this;return _t(function(){var i=r.runNet(t);return r.postProcess(i,t.inputSize,t.inputDimensions.map(function(o){var s=o[0],a=o[1];return{height:s,width:a}}))})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.detectLandmarks=function(t){return jt(this,void 0,void 0,function(){var r,i,o,s=this;return Ut(this,function(a){switch(a.label){case 0:return[4,mo(t)];case 1:return r=a.sent(),i=_t(function(){return Hi(s.forwardInput(r))}),[4,Promise.all(i.map(function(u,l){return jt(s,void 0,void 0,function(){var h,d,m,p,y;return Ut(this,function(b){switch(b.label){case 0:return m=(d=Array).from,[4,u.data()];case 1:return h=m.apply(d,[b.sent()]),p=h.filter(function(x,E){return $S(E)}),y=h.filter(function(x,E){return!$S(E)}),[2,new Y9(Array(68).fill(0).map(function(x,E){return new er(p[E],y[E])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return o=a.sent(),i.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e})(Ek),Tk=(function(n){vn(e,n);function e(t){return t===void 0&&(t=new xk),n.call(this,"FaceLandmark68Net",t)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e})(Ik);function xU(n){var e=[],t=bk(n,e).extractDenseBlock3Params,r={dense0:t("dense0",!0),dense1:t("dense1"),dense2:t("dense2")};return ac(n,e),{params:r,paramMappings:e}}function _U(n){var e=[],t=uc(n),r=t.extractWeights,i=t.getRemainingWeights,o=yk(r,e).extractDenseBlock3Params,s=o(3,32,"dense0",!0),a=o(32,64,"dense1"),u=o(64,128,"dense2");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{dense0:s,dense1:a,dense2:u}}}var EU=(function(n){vn(e,n);function e(){return n.call(this,"TinyFaceFeatureExtractor")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return _t(function(){var i=t.toBatchTensor(112,!0),o=[122.782,117.001,104.298],s=Ym(i,o).div(dt(255)),a=e2(s,r.dense0,!0);return a=e2(a,r.dense1),a=e2(a,r.dense2),a=Km(a,[14,14],[2,2],"valid"),a})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(t){return xU(t)},e.prototype.extractParams=function(t){return _U(t)},e})(sc),SU=(function(n){vn(e,n);function e(t){return t===void 0&&(t=new EU),n.call(this,"FaceLandmark68TinyNet",t)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e})(Ik);(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(Tk);function AU(n,e){return Dn(us(n,e.weights),e.biases)}function Ix(n,e,t,r,i){i===void 0&&(i="same");var o=e.conv,s=o.filters,a=o.bias,u=$a(n,s,t,i);return u=Dn(u,a),u=AU(u,e.scale),r?Yr(u):u}function CU(n,e){return Ix(n,e,[1,1],!0)}function kk(n,e){return Ix(n,e,[1,1],!1)}function Nk(n,e){return Ix(n,e,[2,2],!0,"valid")}function IU(n,e){function t(a,u,l){var h=n(a),d=h.length/(u*l*l);if(j9(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+h.length+", numFilters: "+u+", filterSize: "+l);return _t(function(){return uh(zs(h,[u,d,l,l]),[2,3,1,0])})}function r(a,u,l,h){var d=t(a,u,l),m=Di(n(u));return e.push({paramPath:h+"/filters"},{paramPath:h+"/bias"}),{filters:d,bias:m}}function i(a,u){var l=Di(n(a)),h=Di(n(a));return e.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:h}}function o(a,u,l,h){var d=r(a,u,l,h+"/conv"),m=i(u,h+"/scale");return{conv:d,scale:m}}function s(a,u,l,h,d){d===void 0&&(d=!1);var m=o((d?.5:1)*a,u,l,h+"/conv1"),p=o(a,u,l,h+"/conv2");return{conv1:m,conv2:p}}return{extractConvLayerParams:o,extractResidualLayerParams:s}}function TU(n){var e=uc(n),t=e.extractWeights,r=e.getRemainingWeights,i=[],o=IU(t,i),s=o.extractConvLayerParams,a=o.extractResidualLayerParams,u=s(4704,32,7,"conv32_down"),l=a(9216,32,3,"conv32_1"),h=a(9216,32,3,"conv32_2"),d=a(9216,32,3,"conv32_3"),m=a(36864,64,3,"conv64_down",!0),p=a(36864,64,3,"conv64_1"),y=a(36864,64,3,"conv64_2"),b=a(36864,64,3,"conv64_3"),x=a(147456,128,3,"conv128_down",!0),E=a(147456,128,3,"conv128_1"),T=a(147456,128,3,"conv128_2"),P=a(589824,256,3,"conv256_down",!0),I=a(589824,256,3,"conv256_1"),D=a(589824,256,3,"conv256_2"),U=a(589824,256,3,"conv256_down_out"),L=_t(function(){return uh(Yc(t(256*128),[128,256]),[1,0])});if(i.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var C={conv32_down:u,conv32_1:l,conv32_2:h,conv32_3:d,conv64_down:m,conv64_1:p,conv64_2:y,conv64_3:b,conv128_down:x,conv128_1:E,conv128_2:T,conv256_down:P,conv256_1:I,conv256_2:D,conv256_down_out:U,fc:L};return{params:C,paramMappings:i}}function kU(n,e){var t=xh(n,e);function r(s){var a=t(s+"/scale/weights",1),u=t(s+"/scale/biases",1);return{weights:a,biases:u}}function i(s){var a=t(s+"/conv/filters",4),u=t(s+"/conv/bias",1),l=r(s);return{conv:{filters:a,bias:u},scale:l}}function o(s){return{conv1:i(s+"/conv1"),conv2:i(s+"/conv2")}}return{extractConvLayerParams:i,extractResidualLayerParams:o}}function NU(n){var e=[],t=kU(n,e),r=t.extractConvLayerParams,i=t.extractResidualLayerParams,o=r("conv32_down"),s=i("conv32_1"),a=i("conv32_2"),u=i("conv32_3"),l=i("conv64_down"),h=i("conv64_1"),d=i("conv64_2"),m=i("conv64_3"),p=i("conv128_down"),y=i("conv128_1"),b=i("conv128_2"),x=i("conv256_down"),E=i("conv256_1"),T=i("conv256_2"),P=i("conv256_down_out"),I=n.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!V9(I))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+I);var D={conv32_down:o,conv32_1:s,conv32_2:a,conv32_3:u,conv64_down:l,conv64_1:h,conv64_2:d,conv64_3:m,conv128_down:p,conv128_1:y,conv128_2:b,conv256_down:x,conv256_1:E,conv256_2:T,conv256_down_out:P,fc:I};return ac(n,e),{params:D,paramMappings:e}}function Ku(n,e){var t=CU(n,e.conv1);return t=kk(t,e.conv2),t=Dn(t,n),t=Yr(t),t}function sv(n,e){var t=Nk(n,e.conv1);t=kk(t,e.conv2);var r=Km(n,2,2,"valid"),i=Tr(r.shape),o=r.shape[3]!==t.shape[3],s=r.shape[1]!==t.shape[1]||r.shape[2]!==t.shape[2];if(s){var a=sm(t.shape);a[1]=1;var u=Tr(a);t=qi([t,u],1);var l=sm(t.shape);l[2]=1;var h=Tr(l);t=qi([t,h],2)}return r=o?qi([r,i],3):r,t=Dn(r,t),t=Yr(t),t}var RU=(function(n){vn(e,n);function e(){return n.call(this,"FaceRecognitionNet")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return _t(function(){var i=t.toBatchTensor(150,!0).toFloat(),o=[122.782,117.001,104.298],s=Ym(i,o).div(dt(256)),a=Nk(s,r.conv32_down);a=co(a,3,2,"valid"),a=Ku(a,r.conv32_1),a=Ku(a,r.conv32_2),a=Ku(a,r.conv32_3),a=sv(a,r.conv64_down),a=Ku(a,r.conv64_1),a=Ku(a,r.conv64_2),a=Ku(a,r.conv64_3),a=sv(a,r.conv128_down),a=Ku(a,r.conv128_1),a=Ku(a,r.conv128_2),a=sv(a,r.conv256_down),a=Ku(a,r.conv256_1),a=Ku(a,r.conv256_2),a=sv(a,r.conv256_down_out);var u=a.mean([1,2]),l=Y0(u,r.fc);return l})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.computeFaceDescriptor=function(t){return jt(this,void 0,void 0,function(){var r,i,o,s=this;return Ut(this,function(a){switch(a.label){case 0:return[4,mo(t)];case 1:return r=a.sent(),i=_t(function(){return Hi(s.forwardInput(r))}),[4,Promise.all(i.map(function(u){return u.data()}))];case 2:return o=a.sent(),i.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(t){return NU(t)},e.prototype.extractParams=function(t){return TU(t)},e})(sc);function Rk(n,e){var t={descriptor:e};return Object.assign({},n,t)}function Pk(n,e){var t={age:e};return Object.assign({},n,t)}function Dk(n,e,t){var r={gender:e,genderProbability:t};return Object.assign({},n,r)}var Lk=(function(){function n(e){var t=e===void 0?{}:e,r=t.minFaceSize,i=t.scaleFactor,o=t.maxNumScales,s=t.scoreThresholds,a=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=i||.709,this._maxNumScales=o||10,this._scoreThresholds=s||[.6,.7,.7],this._scaleSteps=a,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(n.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),n})();function PU(n,e){function t(u,l){var h=zs(n(9*u),[3,3,u,1]),d=Di(n(u)),m=Di(n(u)),p=Di(n(u)),y=Di(n(u));return e.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:h,batch_norm_scale:d,batch_norm_offset:m,batch_norm_mean:p,batch_norm_variance:y}}function r(u,l,h,d,m){var p=zs(n(u*l*h*h),[h,h,u,l]),y=Di(n(l));return e.push({paramPath:d+"/filters"},{paramPath:d+"/"+(m?"batch_norm_offset":"bias")}),{filters:p,bias:y}}function i(u,l,h,d){var m=r(u,l,h,d,!0),p=m.filters,y=m.bias;return{filters:p,batch_norm_offset:y}}function o(u,l,h){var d=t(u,h+"/depthwise_conv"),m=i(u,l,1,h+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:m}}function s(){var u=i(3,32,3,"mobilenetv1/conv_0"),l=o(32,64,"mobilenetv1/conv_1"),h=o(64,128,"mobilenetv1/conv_2"),d=o(128,128,"mobilenetv1/conv_3"),m=o(128,256,"mobilenetv1/conv_4"),p=o(256,256,"mobilenetv1/conv_5"),y=o(256,512,"mobilenetv1/conv_6"),b=o(512,512,"mobilenetv1/conv_7"),x=o(512,512,"mobilenetv1/conv_8"),E=o(512,512,"mobilenetv1/conv_9"),T=o(512,512,"mobilenetv1/conv_10"),P=o(512,512,"mobilenetv1/conv_11"),I=o(512,1024,"mobilenetv1/conv_12"),D=o(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:h,conv_3:d,conv_4:m,conv_5:p,conv_6:y,conv_7:b,conv_8:x,conv_9:E,conv_10:T,conv_11:P,conv_12:I,conv_13:D}}function a(){var u=i(1024,256,1,"prediction_layer/conv_0"),l=i(256,512,3,"prediction_layer/conv_1"),h=i(512,128,1,"prediction_layer/conv_2"),d=i(128,256,3,"prediction_layer/conv_3"),m=i(256,128,1,"prediction_layer/conv_4"),p=i(128,256,3,"prediction_layer/conv_5"),y=i(256,64,1,"prediction_layer/conv_6"),b=i(64,128,3,"prediction_layer/conv_7"),x=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),E=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),T=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),P=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),I=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),D=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),U=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),L=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),C=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),A=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),M=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),k=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),O={box_encoding_predictor:x,class_predictor:E},j={box_encoding_predictor:T,class_predictor:P},X={box_encoding_predictor:I,class_predictor:D},ue={box_encoding_predictor:U,class_predictor:L},ge={box_encoding_predictor:C,class_predictor:A},he={box_encoding_predictor:M,class_predictor:k};return{conv_0:u,conv_1:l,conv_2:h,conv_3:d,conv_4:m,conv_5:p,conv_6:y,conv_7:b,box_predictor_0:O,box_predictor_1:j,box_predictor_2:X,box_predictor_3:ue,box_predictor_4:ge,box_predictor_5:he}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:a}}function DU(n){var e=[],t=uc(n),r=t.extractWeights,i=t.getRemainingWeights,o=PU(r,e),s=o.extractMobilenetV1Params,a=o.extractPredictionLayerParams,u=s(),l=a(),h=Hb(r(5118*4),[1,5118,4]),d={extra_dim:h};if(e.push({paramPath:"output_layer/extra_dim"}),i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:d},paramMappings:e}}function LU(n,e){var t=xh(n,e);function r(l,h,d){var m=t(l+"/Conv2d_"+h+"_pointwise/weights",4,d+"/filters"),p=t(l+"/Conv2d_"+h+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:m,batch_norm_offset:p}}function i(l){var h="mobilenetv1/conv_"+l,d="MobilenetV1/Conv2d_"+l+"_depthwise",m=h+"/depthwise_conv",p=h+"/pointwise_conv",y=t(d+"/depthwise_weights",4,m+"/filters"),b=t(d+"/BatchNorm/gamma",1,m+"/batch_norm_scale"),x=t(d+"/BatchNorm/beta",1,m+"/batch_norm_offset"),E=t(d+"/BatchNorm/moving_mean",1,m+"/batch_norm_mean"),T=t(d+"/BatchNorm/moving_variance",1,m+"/batch_norm_variance");return{depthwise_conv:{filters:y,batch_norm_scale:b,batch_norm_offset:x,batch_norm_mean:E,batch_norm_variance:T},pointwise_conv:r("MobilenetV1",l,p)}}function o(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:i(1),conv_2:i(2),conv_3:i(3),conv_4:i(4),conv_5:i(5),conv_6:i(6),conv_7:i(7),conv_8:i(8),conv_9:i(9),conv_10:i(10),conv_11:i(11),conv_12:i(12),conv_13:i(13)}}function s(l,h){var d=t(l+"/weights",4,h+"/filters"),m=t(l+"/biases",1,h+"/bias");return{filters:d,bias:m}}function a(l){var h=s("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),d=s("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:h,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:u}}function MU(n){var e=[],t=LU(n,e),r=t.extractMobilenetV1Params,i=t.extractPredictionLayerParams,o=n["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!e1(o))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+o);var s={mobilenetv1:r(),prediction_layer:i(),output_layer:{extra_dim:o}};return ac(n,e),{params:s,paramMappings:e}}function Qu(n,e,t){return _t(function(){var r=$a(n,e.filters,t,"same");return r=Dn(r,e.batch_norm_offset),nx(r,0,6)})}var OU=.0010000000474974513;function FU(n,e,t){return _t(function(){var r=X0(n,e.filters,t,"same");return r=CT(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,OU),nx(r,0,6)})}function BU(n){return[2,4,6,12].some(function(e){return e===n})?[2,2]:[1,1]}function VU(n,e){return _t(function(){var t=null,r=Qu(n,e.conv_0,[2,2]),i=[e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13];if(i.forEach(function(o,s){var a=s+1,u=BU(a);r=FU(r,o.depthwise_conv,u),r=Qu(r,o.pointwise_conv,[1,1]),a===11&&(t=r)}),t===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:t}})}function jU(n,e,t,r,i){var o=n.shape[0],s=Math.min(t,o),a=e.map(function(h,d){return{score:h,boxIndex:d}}).filter(function(h){return h.score>i}).sort(function(h,d){return d.score-h.score}),u=function(h){return h<=r?1:0},l=[];return a.forEach(function(h){if(!(l.length>=s)){for(var d=h.score,m=l.length-1;m>=0;--m){var p=UU(n,h.boxIndex,l[m]);if(p!==0&&(h.score*=u(p),h.score<=i))break}d===h.score&&l.push(h.boxIndex)}}),l}function UU(n,e,t){var r=n.arraySync(),i=Math.min(r[e][0],r[e][2]),o=Math.min(r[e][1],r[e][3]),s=Math.max(r[e][0],r[e][2]),a=Math.max(r[e][1],r[e][3]),u=Math.min(r[t][0],r[t][2]),l=Math.min(r[t][1],r[t][3]),h=Math.max(r[t][0],r[t][2]),d=Math.max(r[t][1],r[t][3]),m=(s-i)*(a-o),p=(h-u)*(d-l);if(m<=0||p<=0)return 0;var y=Math.max(i,u),b=Math.max(o,l),x=Math.min(s,h),E=Math.min(a,d),T=Math.max(x-y,0)*Math.max(E-b,0);return T/(m+p-T)}function zU(n){var e=Hi(uh(n,[1,0])),t=[Ki(e[2],e[0]),Ki(e[3],e[1])],r=[Dn(e[0],gu(t[0],dt(2))),Dn(e[1],gu(t[1],dt(2)))];return{sizes:t,centers:r}}function WU(n,e){var t=zU(n),r=t.sizes,i=t.centers,o=Hi(uh(e,[1,0])),s=gu(us(pw(gu(o[2],dt(5))),r[0]),dt(2)),a=Dn(us(gu(o[0],dt(10)),r[0]),i[0]),u=gu(us(pw(gu(o[3],dt(5))),r[1]),dt(2)),l=Dn(us(gu(o[1],dt(10)),r[1]),i[1]);return uh(wa([Ki(a,s),Ki(l,u),Dn(a,s),Dn(l,u)]),[1,0])}function qU(n,e,t){return _t(function(){var r=n.shape[0],i=WU(yu(xd(t.extra_dim,[r,1,1]),[-1,4]),yu(n,[-1,4]));i=yu(i,[r,i.shape[0]/r,4]);var o=_T(pl(e,[0,0,1],[-1,-1,-1])),s=pl(o,[0,0,0],[-1,-1,1]);s=yu(s,[r,s.shape[1]]);var a=Hi(i),u=Hi(s);return{boxes:a,scores:u}})}function Zf(n,e){return _t(function(){var t=n.shape[0],r=yu(bu(n,e.box_encoding_predictor),[t,-1,1,4]),i=yu(bu(n,e.class_predictor),[t,-1,3]);return{boxPredictionEncoding:r,classPrediction:i}})}function HU(n,e,t){return _t(function(){var r=Qu(n,t.conv_0,[1,1]),i=Qu(r,t.conv_1,[2,2]),o=Qu(i,t.conv_2,[1,1]),s=Qu(o,t.conv_3,[2,2]),a=Qu(s,t.conv_4,[1,1]),u=Qu(a,t.conv_5,[2,2]),l=Qu(u,t.conv_6,[1,1]),h=Qu(l,t.conv_7,[2,2]),d=Zf(e,t.box_predictor_0),m=Zf(n,t.box_predictor_1),p=Zf(i,t.box_predictor_2),y=Zf(s,t.box_predictor_3),b=Zf(u,t.box_predictor_4),x=Zf(h,t.box_predictor_5),E=qi([d.boxPredictionEncoding,m.boxPredictionEncoding,p.boxPredictionEncoding,y.boxPredictionEncoding,b.boxPredictionEncoding,x.boxPredictionEncoding],1),T=qi([d.classPrediction,m.classPrediction,p.classPrediction,y.classPrediction,b.classPrediction,x.classPrediction],1);return{boxPredictions:E,classPredictions:T}})}var Qm=(function(){function n(e){var t=e===void 0?{}:e,r=t.minConfidence,i=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=i||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(n.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),n})(),Mk=(function(n){vn(e,n);function e(){return n.call(this,"SsdMobilenetv1")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return _t(function(){var i=t.toBatchTensor(512,!1).toFloat(),o=Ki(us(i,dt(.007843137718737125)),dt(1)),s=VU(o,r.mobilenetv1),a=HU(s.out,s.conv11,r.prediction_layer),u=a.boxPredictions,l=a.classPredictions;return qU(u,l,r.output_layer)})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.locateFaces=function(t,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,I,D,U,L,C;return Ut(this,function(A){switch(A.label){case 0:return i=new Qm(r),o=i.maxResults,s=i.minConfidence,[4,mo(t)];case 1:for(a=A.sent(),u=this.forwardInput(a),l=u.boxes,h=u.scores,d=l[0],m=h[0],p=1;p<l.length;p++)l[p].dispose(),h[p].dispose();return x=(b=Array).from,[4,m.data()];case 2:return y=x.apply(b,[A.sent()]),E=.5,T=jU(d,y,o,E,s),P=a.getReshapedInputDimensions(0),I=a.inputSize,D=I/P.width,U=I/P.height,L=d.arraySync(),C=T.map(function(M){var k=[Math.max(0,L[M][0]),Math.min(1,L[M][2])].map(function(he){return he*U}),O=k[0],j=k[1],X=[Math.max(0,L[M][1]),Math.min(1,L[M][3])].map(function(he){return he*D}),ue=X[0],ge=X[1];return new Cu(y[M],new wx(ue,O,ge-ue,j-O),{height:a.getInputHeight(0),width:a.getInputWidth(0)})}),d.dispose(),m.dispose(),[2,C]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(t){return MU(t)},e.prototype.extractParams=function(t){return DU(t)},e})(sc);(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(Mk);var GU=.4,$U=[new er(.738768,.874946),new er(2.42204,2.65704),new er(4.30971,7.04493),new er(10.246,4.59428),new er(12.6868,11.8741)],KU=[new er(1.603231,2.094468),new er(6.041143,7.080126),new er(2.882459,3.518061),new er(4.266906,5.178857),new er(9.041765,10.66308)],XU=[117.001,114.697,97.404],YU="tiny_yolov2_model",QU="tiny_yolov2_separable_conv_model",av=function(n){return typeof n=="number"};function JU(n){if(!n)throw new Error("invalid config: "+n);if(typeof n.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+n.withSeparableConvs);if(!av(n.iouThreshold)||n.iouThreshold<0||n.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+n.iouThreshold);if(!Array.isArray(n.classes)||!n.classes.length||!n.classes.every(function(e){return typeof e=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(n.classes));if(!Array.isArray(n.anchors)||!n.anchors.length||!n.anchors.map(function(e){return e||{}}).every(function(e){return av(e.x)&&av(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(n.anchors));if(n.meanRgb&&(!Array.isArray(n.meanRgb)||n.meanRgb.length!==3||!n.meanRgb.every(av)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(n.meanRgb))}function Tx(n){return _t(function(){var e=us(n,dt(.10000000149011612));return Dn(Yr(Ki(n,e)),e)})}function Mc(n,e){return _t(function(){var t=bf(n,[[0,0],[1,1],[1,1],[0,0]]);return t=$a(t,e.conv.filters,[1,1],"valid"),t=Ki(t,e.bn.sub),t=us(t,e.bn.truediv),t=Dn(t,e.conv.bias),Tx(t)})}function Oc(n,e){return _t(function(){var t=bf(n,[[0,0],[1,1],[1,1],[0,0]]);return t=sx(t,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),t=Dn(t,e.bias),Tx(t)})}function ZU(n,e){var t=r1(n,e);function r(s,a){var u=Di(n(s)),l=Di(n(s));return e.push({paramPath:a+"/sub"},{paramPath:a+"/truediv"}),{sub:u,truediv:l}}function i(s,a,u){var l=t(s,a,3,u+"/conv"),h=r(a,u+"/bn");return{conv:l,bn:h}}var o=Ax(n,e);return{extractConvParams:t,extractConvWithBatchNormParams:i,extractSeparableConvParams:o}}function ez(n,e,t,r){var i=uc(n),o=i.extractWeights,s=i.getRemainingWeights,a=[],u=ZU(o,a),l=u.extractConvParams,h=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,m;if(e.withSeparableConvs){var p=r[0],y=r[1],b=r[2],x=r[3],E=r[4],T=r[5],P=r[6],I=r[7],D=r[8],U=e.isFirstLayerConv2d?l(p,y,3,"conv0"):d(p,y,"conv0"),L=d(y,b,"conv1"),C=d(b,x,"conv2"),A=d(x,E,"conv3"),M=d(E,T,"conv4"),k=d(T,P,"conv5"),O=I?d(P,I,"conv6"):void 0,j=D?d(I,D,"conv7"):void 0,X=l(D||I||P,5*t,1,"conv8");m={conv0:U,conv1:L,conv2:C,conv3:A,conv4:M,conv5:k,conv6:O,conv7:j,conv8:X}}else{var p=r[0],y=r[1],b=r[2],x=r[3],E=r[4],T=r[5],P=r[6],I=r[7],D=r[8],U=h(p,y,"conv0"),L=h(y,b,"conv1"),C=h(b,x,"conv2"),A=h(x,E,"conv3"),M=h(E,T,"conv4"),k=h(T,P,"conv5"),O=h(P,I,"conv6"),j=h(I,D,"conv7"),X=l(D,5*t,1,"conv8");m={conv0:U,conv1:L,conv2:C,conv3:A,conv4:M,conv5:k,conv6:O,conv7:j,conv8:X}}if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{params:m,paramMappings:a}}function tz(n,e){var t=xh(n,e);function r(a){var u=t(a+"/sub",1),l=t(a+"/truediv",1);return{sub:u,truediv:l}}function i(a){var u=t(a+"/filters",4),l=t(a+"/bias",1);return{filters:u,bias:l}}function o(a){var u=i(a+"/conv"),l=r(a+"/bn");return{conv:u,bn:l}}var s=Cx(t);return{extractConvParams:i,extractConvWithBatchNormParams:o,extractSeparableConvParams:s}}function nz(n,e){var t=[],r=tz(n,t),i=r.extractConvParams,o=r.extractConvWithBatchNormParams,s=r.extractSeparableConvParams,a;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;a={conv0:e.isFirstLayerConv2d?i("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:i("conv8")}}else a={conv0:o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:o("conv6"),conv7:o("conv7"),conv8:i("conv8")};return ac(n,t),{params:a,paramMappings:t}}var tA;(function(n){n[n.XS=224]="XS",n[n.SM=320]="SM",n[n.MD=416]="MD",n[n.LG=608]="LG"})(tA||(tA={}));var kx=(function(){function n(e){var t=e===void 0?{}:e,r=t.inputSize,i=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=i||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),n})(),Ok=(function(n){vn(e,n);function e(t){var r=n.call(this,"TinyYolov2")||this;return JU(t),r._config=t,r}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(t,r){var i=Mc(t,r.conv0);return i=co(i,[2,2],[2,2],"same"),i=Mc(i,r.conv1),i=co(i,[2,2],[2,2],"same"),i=Mc(i,r.conv2),i=co(i,[2,2],[2,2],"same"),i=Mc(i,r.conv3),i=co(i,[2,2],[2,2],"same"),i=Mc(i,r.conv4),i=co(i,[2,2],[2,2],"same"),i=Mc(i,r.conv5),i=co(i,[2,2],[1,1],"same"),i=Mc(i,r.conv6),i=Mc(i,r.conv7),bu(i,r.conv8,"valid",!1)},e.prototype.runMobilenet=function(t,r){var i=this.config.isFirstLayerConv2d?Tx(bu(t,r.conv0,"valid",!1)):Oc(t,r.conv0);return i=co(i,[2,2],[2,2],"same"),i=Oc(i,r.conv1),i=co(i,[2,2],[2,2],"same"),i=Oc(i,r.conv2),i=co(i,[2,2],[2,2],"same"),i=Oc(i,r.conv3),i=co(i,[2,2],[2,2],"same"),i=Oc(i,r.conv4),i=co(i,[2,2],[2,2],"same"),i=Oc(i,r.conv5),i=co(i,[2,2],[1,1],"same"),i=r.conv6?Oc(i,r.conv6):i,i=r.conv7?Oc(i,r.conv7):i,bu(i,r.conv8,"valid",!1)},e.prototype.forwardInput=function(t,r){var i=this,o=this.params;if(!o)throw new Error("TinyYolov2 - load model before inference");return _t(function(){var s=t.toBatchTensor(r,!1).toFloat();return s=i.config.meanRgb?Ym(s,i.config.meanRgb):s,s=s.div(dt(256)),i.config.withSeparableConvs?i.runMobilenet(s,o):i.runTinyYolov2(s,o)})},e.prototype.forward=function(t,r){return jt(this,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,mo(t)];case 1:return[4,i.apply(this,[o.sent(),r])];case 2:return[2,o.sent()]}})})},e.prototype.detect=function(t,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i,o,s,a,u,l,h,d,m,p,y,b,x,E,T=this;return Ut(this,function(P){switch(P.label){case 0:return i=new kx(r),o=i.inputSize,s=i.scoreThreshold,[4,mo(t)];case 1:return a=P.sent(),[4,this.forwardInput(a,o)];case 2:return u=P.sent(),l=_t(function(){return Hi(u)[0].expandDims()}),h={width:a.getInputWidth(0),height:a.getInputHeight(0)},[4,this.extractBoxes(l,a.getReshapedInputDimensions(0),s)];case 3:return d=P.sent(),u.dispose(),l.dispose(),m=d.map(function(I){return I.box}),p=d.map(function(I){return I.score}),y=d.map(function(I){return I.classScore}),b=d.map(function(I){return T.config.classes[I.label]}),x=Cm(m.map(function(I){return I.rescale(o)}),p,this.config.iouThreshold,!0),E=x.map(function(I){return new sk(p[I],y[I],b[I],m[I],h)}),[2,E]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(t){return nz(t,this.config)},e.prototype.extractParams=function(t){var r=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,i=r?r.length:void 0;if(i!==7&&i!==8&&i!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+i+" filterSizes in config");return ez(t,this.config,this.boxEncodingSize,r)},e.prototype.extractBoxes=function(t,r,i){return jt(this,void 0,void 0,function(){var o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,I,D,U,L,C,A,M,k,O,j,X,ue,ge,he,$=this;return Ut(this,function(le){switch(le.label){case 0:return o=r.width,s=r.height,a=Math.max(o,s),u=a/o,l=a/s,h=t.shape[1],d=this.config.anchors.length,m=_t(function(){var ae=t.reshape([h,h,d,$.boxEncodingSize]),J=ae.slice([0,0,0,0],[h,h,d,4]),W=ae.slice([0,0,0,4],[h,h,d,1]),Q=$.withClassScores?ic(ae.slice([0,0,0,5],[h,h,d,$.config.classes.length]),3):dt(0);return[J,W,Q]}),p=m[0],y=m[1],b=m[2],x=[],[4,y.array()];case 1:return E=le.sent(),[4,p.array()];case 2:T=le.sent(),P=0,le.label=3;case 3:if(!(P<h))return[3,12];I=0,le.label=4;case 4:if(!(I<h))return[3,11];D=0,le.label=5;case 5:return D<d?(U=Zy(E[P][I][D][0]),!i||U>i?(L=(I+Zy(T[P][I][D][0]))/h*u,C=(P+Zy(T[P][I][D][1]))/h*l,A=Math.exp(T[P][I][D][2])*this.config.anchors[D].x/h*u,M=Math.exp(T[P][I][D][3])*this.config.anchors[D].y/h*l,k=L-A/2,O=C-M/2,j={row:P,col:I,anchor:D},this.withClassScores?[4,this.extractPredictedClass(b,j)]:[3,7]):[3,9]):[3,10];case 6:return he=le.sent(),[3,8];case 7:he={classScore:1,label:0},le.label=8;case 8:X=he,ue=X.classScore,ge=X.label,x.push(rs({box:new t1(k,O,k+A,O+M),score:U,classScore:U*ue,label:ge},j)),le.label=9;case 9:return D++,[3,5];case 10:return I++,[3,4];case 11:return P++,[3,3];case 12:return p.dispose(),y.dispose(),b.dispose(),[2,x]}})})},e.prototype.extractPredictedClass=function(t,r){return jt(this,void 0,void 0,function(){var i,o,s,a;return Ut(this,function(u){switch(u.label){case 0:return i=r.row,o=r.col,s=r.anchor,[4,t.array()];case 1:return a=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,h){return a[i][o][s][h]}).map(function(l,h){return{classScore:l,label:h}}).reduce(function(l,h){return l.classScore>h.classScore?l:h})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e})(sc),rz=(function(n){vn(e,n);function e(t){t===void 0&&(t=!0);var r=this,i=Object.assign({},{withSeparableConvs:t,iouThreshold:GU,classes:["face"]},t?{anchors:KU,meanRgb:XU}:{anchors:$U,withClassScores:!0});return r=n.call(this,i)||this,r}return Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,r){return jt(this,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return[4,this.detect(t,r)];case 1:return i=o.sent(),[2,i.map(function(s){return new Cu(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?QU:YU},e.prototype.extractParamsFromWeigthMap=function(t){return n.prototype.extractParamsFromWeigthMap.call(this,t)},e})(Ok),Fk=(function(n){vn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return e})(kx),Jm=(function(){function n(){}return n.prototype.then=function(e){return jt(this,void 0,void 0,function(){var t;return Ut(this,function(r){switch(r.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[r.sent()])]}})})},n.prototype.run=function(){return jt(this,void 0,void 0,function(){return Ut(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},n})();function o1(n,e,t,r,i){return i===void 0&&(i=function(o){var s=o.alignedRect;return s}),jt(this,void 0,void 0,function(){var o,s,a,u,l;return Ut(this,function(h){switch(h.label){case 0:return o=n.map(function(d){return Ak(d)?i(d):d.detection}),a=r,a?[3,5]:e instanceof $r?[4,Ex(e,o)]:[3,2];case 1:return u=h.sent(),[3,4];case 2:return[4,_x(e,o)];case 3:u=h.sent(),h.label=4;case 4:a=u,h.label=5;case 5:return s=a,[4,t(s)];case 6:return l=h.sent(),s.forEach(function(d){return d instanceof $r&&d.dispose()}),[2,l]}})})}function Nx(n,e,t,r,i){return jt(this,void 0,void 0,function(){var o=this;return Ut(this,function(s){return[2,o1([n],e,function(a){return jt(o,void 0,void 0,function(){return Ut(this,function(u){return[2,t(a[0])]})})},r,i)]})})}function iz(n){return _t(function(){return wa(Hi(n,3).reverse(),3)})}var uv=2,y0=12;function oz(n,e){var t=r1(n,e),r=Sx(n,e);function i(l,h){var d=Di(n(l));return e.push({paramPath:h}),d}function o(l,h,d){d===void 0&&(d=!1);var m=t(l[0],l[1],3,h+"/conv1"),p=i(l[1],h+"/prelu1_alpha"),y=t(l[1],l[2],3,h+"/conv2"),b=i(l[2],h+"/prelu2_alpha"),x=t(l[2],l[3],d?2:3,h+"/conv3"),E=i(l[3],h+"/prelu3_alpha");return{conv1:m,prelu1_alpha:p,conv2:y,prelu2_alpha:b,conv3:x,prelu3_alpha:E}}function s(){var l=o([3,10,16,32],"pnet"),h=t(32,2,1,"pnet/conv4_1"),d=t(32,4,1,"pnet/conv4_2");return rs(rs({},l),{conv4_1:h,conv4_2:d})}function a(){var l=o([3,28,48,64],"rnet",!0),h=r(576,128,"rnet/fc1"),d=i(128,"rnet/prelu4_alpha"),m=r(128,2,"rnet/fc2_1"),p=r(128,4,"rnet/fc2_2");return rs(rs({},l),{fc1:h,prelu4_alpha:d,fc2_1:m,fc2_2:p})}function u(){var l=o([3,32,64,64],"onet"),h=t(64,128,2,"onet/conv4"),d=i(128,"onet/prelu4_alpha"),m=r(1152,256,"onet/fc1"),p=i(256,"onet/prelu5_alpha"),y=r(256,2,"onet/fc2_1"),b=r(256,4,"onet/fc2_2"),x=r(256,10,"onet/fc2_3");return rs(rs({},l),{conv4:h,prelu4_alpha:d,fc1:m,prelu5_alpha:p,fc2_1:y,fc2_2:b,fc2_3:x})}return{extractPNetParams:s,extractRNetParams:a,extractONetParams:u}}function sz(n){var e=uc(n),t=e.extractWeights,r=e.getRemainingWeights,i=[],o=oz(t,i),s=o.extractPNetParams,a=o.extractRNetParams,u=o.extractONetParams,l=s(),h=a(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:h,onet:d},paramMappings:i}}function az(n,e){var t=xh(n,e);function r(h){var d=t(h+"/weights",4,h+"/filters"),m=t(h+"/bias",1);return{filters:d,bias:m}}function i(h){var d=t(h+"/weights",2),m=t(h+"/bias",1);return{weights:d,bias:m}}function o(h){return t(h,1)}function s(h){var d=r(h+"/conv1"),m=o(h+"/prelu1_alpha"),p=r(h+"/conv2"),y=o(h+"/prelu2_alpha"),b=r(h+"/conv3"),x=o(h+"/prelu3_alpha");return{conv1:d,prelu1_alpha:m,conv2:p,prelu2_alpha:y,conv3:b,prelu3_alpha:x}}function a(){var h=s("pnet"),d=r("pnet/conv4_1"),m=r("pnet/conv4_2");return rs(rs({},h),{conv4_1:d,conv4_2:m})}function u(){var h=s("rnet"),d=i("rnet/fc1"),m=o("rnet/prelu4_alpha"),p=i("rnet/fc2_1"),y=i("rnet/fc2_2");return rs(rs({},h),{fc1:d,prelu4_alpha:m,fc2_1:p,fc2_2:y})}function l(){var h=s("onet"),d=r("onet/conv4"),m=o("onet/prelu4_alpha"),p=i("onet/fc1"),y=o("onet/prelu5_alpha"),b=i("onet/fc2_1"),x=i("onet/fc2_2"),E=i("onet/fc2_3");return rs(rs({},h),{conv4:d,prelu4_alpha:m,fc1:p,prelu5_alpha:y,fc2_1:b,fc2_2:x,fc2_3:E})}return{extractPNetParams:a,extractRNetParams:u,extractONetParams:l}}function uz(n){var e=[],t=az(n,e),r=t.extractPNetParams,i=t.extractRNetParams,o=t.extractONetParams,s=r(),a=i(),u=o();return ac(n,e),{params:{pnet:s,rnet:a,onet:u},paramMappings:e}}function _w(n,e){var t=e[0],r=e[1];return{height:Math.floor(t*n),width:Math.floor(r*n)}}function lz(n,e,t){for(var r=t[0],i=t[1],o=y0/n,s=[],a=Math.min(r,i)*o,u=0;a>=12;)s.push(o*Math.pow(e,u)),a=a*e,u+=1;return s}var Rx=(function(n){vn(e,n);function e(t,r,i,o){return n.call(this,{left:t,top:r,right:i,bottom:o},!0)||this}return e})(lh);function Bk(n){return _t(function(){return us(Ki(n,dt(127.5)),dt(.0078125))})}function Cd(n,e){return _t(function(){return Dn(Yr(n),us(e,f0(Yr(f0(n)))))})}function Px(n,e,t){return t===void 0&&(t=!1),_t(function(){var r=bu(n,e.conv1,"valid");return r=Cd(r,e.prelu1_alpha),r=co(r,t?[2,2]:[3,3],[2,2],"same"),r=bu(r,e.conv2,"valid"),r=Cd(r,e.prelu2_alpha),r=t?r:co(r,[3,3],[2,2],"valid"),r=bu(r,e.conv3,"valid"),r=Cd(r,e.prelu3_alpha),r})}function cz(n,e){return _t(function(){var t=Px(n,e,!0),r=bu(t,e.conv4_1,"valid"),i=Wa(Q0(r,3),3),o=ic(Ki(r,i),3),s=bu(t,e.conv4_2,"valid");return{prob:o,regions:s}})}function hz(n,e){return _t(function(){var t=_w(e,n.shape.slice(1)),r=t.height,i=t.width,o=hx.resizeBilinear(n,[r,i]),s=Bk(o);return uh(s,[0,2,1,3])})}function fz(n,e,t,r){for(var i=[],o=n.arraySync(),s=0;s<n.shape[0];s++)for(var a=0;a<n.shape[1];a++)o[s][a]>=r&&i.push(new er(a,s));var u=i.map(function(l){var h=new t1(Math.round((l.y*uv+1)/t),Math.round((l.x*uv+1)/t),Math.round((l.y*uv+y0)/t),Math.round((l.x*uv+y0)/t)),d=o[l.y][l.x],m=e.arraySync(),p=new Rx(m[l.y][l.x][0],m[l.y][l.x][1],m[l.y][l.x][2],m[l.y][l.x][3]);return{cell:h,score:d,region:p}});return u}function dz(n,e,t,r,i){i.stage1=[];var o=e.map(function(m){return _t(function(){var p={scale:m},y=hz(n,m),b=Date.now(),x=cz(y,r),E=x.prob,T=x.regions;p.pnet=Date.now()-b;var P=Hi(Hi(E,3)[1])[0],I=Hi(T)[0];return{scoresTensor:P,regionsTensor:I,scale:m,statsForScale:p}})}),s=o.map(function(m){var p=m.scoresTensor,y=m.regionsTensor,b=m.scale,x=m.statsForScale,E=fz(p,y,b,t);if(p.dispose(),y.dispose(),!E.length)return i.stage1.push(x),[];var T=Date.now(),P=Cm(E.map(function(I){return I.cell}),E.map(function(I){return I.score}),.5);return x.nms=Date.now()-T,x.numBoxes=P.length,i.stage1.push(x),P.map(function(I){return E[I]})}),a=s.reduce(function(m,p){return m.concat(p)},[]),u=[],l=[];if(a.length>0){var h=Date.now(),d=Cm(a.map(function(m){return m.cell}),a.map(function(m){return m.score}),.7);i.stage1_nms=Date.now()-h,l=d.map(function(m){return a[m].score}),u=d.map(function(m){return a[m]}).map(function(m){var p=m.cell,y=m.region;return new t1(p.left+y.left*p.width,p.top+y.top*p.height,p.right+y.right*p.width,p.bottom+y.bottom*p.height).toSquare().round()})}return{boxes:u,scores:l}}function Vk(n,e,t){var r=t.width,i=t.height;return jt(this,void 0,void 0,function(){var o,s,a,u=this;return Ut(this,function(l){switch(l.label){case 0:return o=hf(n),[4,Promise.all(e.map(function(h){return jt(u,void 0,void 0,function(){var d,m,p,y,b,x,E,T;return Ut(this,function(P){return d=h.padAtBorders(n.height,n.width),m=d.y,p=d.ey,y=d.x,b=d.ex,x=y-1,E=m-1,T=o.getImageData(x,E,b-x,p-E),[2,Do.isNodejs()?xx(T):createImageBitmap(T)]})})}))];case 1:return s=l.sent(),a=[],s.forEach(function(h){var d=n1({width:r,height:i}),m=hf(d);m.drawImage(h,0,0,r,i);for(var p=m.getImageData(0,0,r,i).data,y=[],b=0;b<p.length;b+=4)y.push(p[b+2]),y.push(p[b+1]),y.push(p[b]);a.push(y)}),[2,a.map(function(h){var d=_t(function(){var m=uh(zs(h,[1,r,i,3]),[0,2,1,3]).toFloat();return Bk(m)});return d})]}})})}function pz(n,e){return _t(function(){var t=Px(n,e),r=yu(t,[t.shape[0],e.fc1.weights.shape[0]]),i=il(r,e.fc1),o=Cd(i,e.prelu4_alpha),s=il(o,e.fc2_1),a=Wa(Q0(s,1),1),u=ic(Ki(s,a),1),l=il(o,e.fc2_2),h=Hi(u,1)[1];return{scores:h,regions:l}})}function mz(n,e,t,r,i){return jt(this,void 0,void 0,function(){var o,s,a,u,l,h,d,m,p,y,b,x,E,T;return Ut(this,function(P){switch(P.label){case 0:return o=Date.now(),[4,Vk(n,e,{width:24,height:24})];case 1:return s=P.sent(),i.stage2_extractImagePatches=Date.now()-o,o=Date.now(),a=s.map(function(I){var D=pz(I,r);return I.dispose(),D}),i.stage2_rnet=Date.now()-o,u=a.length>1?qi(a.map(function(I){return I.scores})):a[0].scores,d=(h=Array).from,[4,u.data()];case 2:return l=d.apply(h,[P.sent()]),u.dispose(),m=l.map(function(I,D){return{score:I,idx:D}}).filter(function(I){return I.score>t}).map(function(I){var D=I.idx;return D}),p=m.map(function(I){return e[I]}),y=m.map(function(I){return l[I]}),b=[],x=[],p.length>0&&(o=Date.now(),E=Cm(p,y,.7),i.stage2_nms=Date.now()-o,T=E.map(function(I){var D=a[m[I]].regions.arraySync();return new Rx(D[0][0],D[0][1],D[0][2],D[0][3])}),x=E.map(function(I){return y[I]}),b=E.map(function(I,D){return p[I].calibrate(T[D])})),a.forEach(function(I){I.regions.dispose(),I.scores.dispose()}),[2,{boxes:b,scores:x}]}})})}function gz(n,e){return _t(function(){var t=Px(n,e);t=co(t,[2,2],[2,2],"same"),t=bu(t,e.conv4,"valid"),t=Cd(t,e.prelu4_alpha);var r=yu(t,[t.shape[0],e.fc1.weights.shape[0]]),i=il(r,e.fc1),o=Cd(i,e.prelu5_alpha),s=il(o,e.fc2_1),a=Wa(Q0(s,1),1),u=ic(Ki(s,a),1),l=il(o,e.fc2_2),h=il(o,e.fc2_3),d=Hi(u,1)[1];return{scores:d,regions:l,points:h}})}function vz(n,e,t,r,i){return jt(this,void 0,void 0,function(){var o,s,a,u,l,h,d,m,p,y,b,x,E,T,P;return Ut(this,function(I){switch(I.label){case 0:return o=Date.now(),[4,Vk(n,e,{width:48,height:48})];case 1:return s=I.sent(),i.stage3_extractImagePatches=Date.now()-o,o=Date.now(),a=s.map(function(D){var U=gz(D,r);return D.dispose(),U}),i.stage3_onet=Date.now()-o,u=a.length>1?qi(a.map(function(D){return D.scores})):a[0].scores,d=(h=Array).from,[4,u.data()];case 2:return l=d.apply(h,[I.sent()]),u.dispose(),m=l.map(function(D,U){return{score:D,idx:U}}).filter(function(D){return D.score>t}).map(function(D){var U=D.idx;return U}),p=m.map(function(D){var U=a[D].regions.arraySync();return new Rx(U[0][0],U[0][1],U[0][2],U[0][3])}),y=m.map(function(D,U){return e[D].calibrate(p[U])}),b=m.map(function(D){return l[D]}),x=[],E=[],T=[],y.length>0&&(o=Date.now(),P=Cm(y,b,.7,!1),i.stage3_nms=Date.now()-o,x=P.map(function(D){return y[D]}),E=P.map(function(D){return b[D]}),T=P.map(function(D,U){return Array(5).fill(0).map(function(L,C){var A=a[D].points.arraySync();return new er(A[0][C]*(x[U].width+1)+x[U].left,A[0][C+5]*(x[U].height+1)+x[U].top)})})),a.forEach(function(D){D.regions.dispose(),D.scores.dispose(),D.points.dispose()}),[2,{boxes:x,scores:E,points:T}]}})})}var yz=(function(n){vn(e,n);function e(){return n.call(this,"Mtcnn")||this}return e.prototype.load=function(t){return jt(this,void 0,void 0,function(){return Ut(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.load.call(this,t)]})})},e.prototype.loadFromDisk=function(t){return jt(this,void 0,void 0,function(){return Ut(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.loadFromDisk.call(this,t)]})})},e.prototype.forwardInput=function(t,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,I,D,U,L,C;return Ut(this,function(A){switch(A.label){case 0:if(i=this.params,!i)throw new Error("Mtcnn - load model before inference");if(o=t.canvases[0],!o)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return s={},a=Date.now(),u=_t(function(){return iz(Wa(vx.fromPixels(o)).toFloat())}),l=function(M){return u.dispose(),s.total=Date.now()-a,M},h=u.shape.slice(1),d=h[0],m=h[1],p=new Lk(r),y=p.minFaceSize,b=p.scaleFactor,x=p.maxNumScales,E=p.scoreThresholds,T=p.scaleSteps,P=(T||lz(y,b,[d,m])).filter(function(M){var k=_w(M,[d,m]);return Math.min(k.width,k.height)>y0}).slice(0,x),s.scales=P,s.pyramid=P.map(function(M){return _w(M,[d,m])}),I=Date.now(),[4,dz(u,P,E[0],i.pnet,s)];case 1:return D=A.sent(),s.total_stage1=Date.now()-I,D.boxes.length?(s.stage2_numInputBoxes=D.boxes.length,I=Date.now(),[4,mz(o,D.boxes,E[1],i.rnet,s)]):[2,l({results:[],stats:s})];case 2:return U=A.sent(),s.total_stage2=Date.now()-I,U.boxes.length?(s.stage3_numInputBoxes=U.boxes.length,I=Date.now(),[4,vz(o,U.boxes,E[2],i.onet,s)]):[2,l({results:[],stats:s})];case 3:return L=A.sent(),s.total_stage3=Date.now()-I,C=L.boxes.map(function(M,k){return i1(Tm({},new Cu(L.scores[k],new wx(M.left/m,M.top/d,M.width/m,M.height/d),{height:d,width:m})),new X9(L.points[k].map(function(O){return O.sub(new er(M.left,M.top)).div(new er(M.width,M.height))}),{width:M.width,height:M.height}))}),[2,l({results:C,stats:s})]}})})},e.prototype.forward=function(t,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,mo(t)];case 1:return[4,i.apply(this,[o.sent(),r])];case 2:return[2,o.sent().results]}})})},e.prototype.forwardWithStats=function(t,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,mo(t)];case 1:return[2,i.apply(this,[o.sent(),r])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(t){return uz(t)},e.prototype.extractParams=function(t){return sz(t)},e})(sc),wz=.4,bz=[new er(1.603231,2.094468),new er(6.041143,7.080126),new er(2.882459,3.518061),new er(4.266906,5.178857),new er(9.041765,10.66308)],xz=[117.001,114.697,97.404],_z=(function(n){vn(e,n);function e(){var t=this,r={withSeparableConvs:!0,iouThreshold:wz,classes:["face"],anchors:bz,meanRgb:xz,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return t=n.call(this,r)||this,t}return Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,r){return jt(this,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return[4,this.detect(t,r)];case 1:return i=o.sent(),[2,i.map(function(s){return new Cu(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(t){return n.prototype.extractParamsFromWeigthMap.call(this,t)},e})(Ok),Li={ssdMobilenetv1:new Mk,tinyFaceDetector:new _z,tinyYolov2:new rz,mtcnn:new yz,faceLandmark68Net:new Tk,faceLandmark68TinyNet:new SU,faceRecognitionNet:new RU,faceExpressionNet:new hU,ageGenderNet:new bU},jk=(function(n){vn(e,n);function e(t,r,i){var o=n.call(this)||this;return o.parentTask=t,o.input=r,o.extractedFaces=i,o}return e})(Jm),Dx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i=this;return Ut(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return t=o.sent(),[4,o1(t,this.input,function(s){return jt(i,void 0,void 0,function(){return Ut(this,function(a){switch(a.label){case 0:return[4,Promise.all(s.map(function(u){return Li.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,a.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,t.map(function(s,a){return Sk(s,r[a])})]}})})},e.prototype.withAgeAndGender=function(){return new Fx(this,this.input)},e})(jk),Lx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r;return Ut(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),t?[4,Nx(t,this.input,function(o){return Li.faceExpressionNet.predictExpressions(o)},this.extractedFaces)]:[2];case 2:return r=i.sent(),[2,Sk(t,r)]}})})},e.prototype.withAgeAndGender=function(){return new Bx(this,this.input)},e})(jk),Mx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new Vx(this,this.input)},e.prototype.withFaceDescriptors=function(){return new Ux(this,this.input)},e})(Dx),Ox=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new jx(this,this.input)},e.prototype.withFaceDescriptor=function(){return new zx(this,this.input)},e})(Lx),Uk=(function(n){vn(e,n);function e(t,r,i){var o=n.call(this)||this;return o.parentTask=t,o.input=r,o.extractedFaces=i,o}return e})(Jm),Fx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i=this;return Ut(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return t=o.sent(),[4,o1(t,this.input,function(s){return jt(i,void 0,void 0,function(){return Ut(this,function(a){switch(a.label){case 0:return[4,Promise.all(s.map(function(u){return Li.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,a.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,t.map(function(s,a){var u=r[a],l=u.age,h=u.gender,d=u.genderProbability;return Pk(Dk(s,h,d),l)})]}})})},e.prototype.withFaceExpressions=function(){return new Dx(this,this.input)},e})(Uk),Bx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i,o,s;return Ut(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),t?[4,Nx(t,this.input,function(u){return Li.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=a.sent(),i=r.age,o=r.gender,s=r.genderProbability,[2,Pk(Dk(t,o,s),i)]}})})},e.prototype.withFaceExpressions=function(){return new Lx(this,this.input)},e})(Uk),Vx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new Mx(this,this.input)},e.prototype.withFaceDescriptors=function(){return new Ux(this,this.input)},e})(Fx),jx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new Ox(this,this.input)},e.prototype.withFaceDescriptor=function(){return new zx(this,this.input)},e})(Bx),zk=(function(n){vn(e,n);function e(t,r){var i=n.call(this)||this;return i.parentTask=t,i.input=r,i}return e})(Jm),Ux=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r;return Ut(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),[4,o1(t,this.input,function(o){return Promise.all(o.map(function(s){return Li.faceRecognitionNet.computeFaceDescriptor(s)}))},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=i.sent(),[2,r.map(function(o,s){return Rk(t[s],o)})]}})})},e.prototype.withFaceExpressions=function(){return new Mx(this,this.input)},e.prototype.withAgeAndGender=function(){return new Vx(this,this.input)},e})(zk),zx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r;return Ut(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),t?[4,Nx(t,this.input,function(o){return Li.faceRecognitionNet.computeFaceDescriptor(o)},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=i.sent(),[2,Rk(t,r)]}})})},e.prototype.withFaceExpressions=function(){return new Ox(this,this.input)},e.prototype.withAgeAndGender=function(){return new jx(this,this.input)},e})(zk),Wk=(function(n){vn(e,n);function e(t,r,i){var o=n.call(this)||this;return o.parentTask=t,o.input=r,o.useTinyLandmarkNet=i,o}return Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Li.faceLandmark68TinyNet:Li.faceLandmark68Net},enumerable:!0,configurable:!0}),e})(Jm),Ez=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i,o,s,a=this;return Ut(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return t=u.sent(),r=t.map(function(l){return l.detection}),this.input instanceof $r?[4,Ex(this.input,r)]:[3,3];case 2:return o=u.sent(),[3,5];case 3:return[4,_x(this.input,r)];case 4:o=u.sent(),u.label=5;case 5:return i=o,[4,Promise.all(i.map(function(l){return a.landmarkNet.detectLandmarks(l)}))];case 6:return s=u.sent(),i.forEach(function(l){return l instanceof $r&&l.dispose()}),[2,t.map(function(l,h){return i1(l,s[h])})]}})})},e.prototype.withFaceExpressions=function(){return new Mx(this,this.input)},e.prototype.withAgeAndGender=function(){return new Vx(this,this.input)},e.prototype.withFaceDescriptors=function(){return new Ux(this,this.input)},e})(Wk),Sz=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i,o,s;return Ut(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),t?(r=t.detection,this.input instanceof $r?[4,Ex(this.input,[r])]:[3,3]):[2];case 2:return o=a.sent(),[3,5];case 3:return[4,_x(this.input,[r])];case 4:o=a.sent(),a.label=5;case 5:return i=o,[4,this.landmarkNet.detectLandmarks(i[0])];case 6:return s=a.sent(),i.forEach(function(u){return u instanceof $r&&u.dispose()}),[2,i1(t,s)]}})})},e.prototype.withFaceExpressions=function(){return new Ox(this,this.input)},e.prototype.withAgeAndGender=function(){return new jx(this,this.input)},e.prototype.withFaceDescriptor=function(){return new zx(this,this.input)},e})(Wk),qk=(function(n){vn(e,n);function e(t,r){r===void 0&&(r=new Qm);var i=n.call(this)||this;return i.input=t,i.options=r,i}return e})(Jm),Hk=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i,o;return Ut(this,function(s){switch(s.label){case 0:return t=this,r=t.input,i=t.options,i instanceof Lk?[4,Li.mtcnn.forward(r,i)]:[3,2];case 1:return[2,s.sent().map(function(a){return a.detection})];case 2:if(o=i instanceof Fk?function(a){return Li.tinyFaceDetector.locateFaces(a,i)}:i instanceof Qm?function(a){return Li.ssdMobilenetv1.locateFaces(a,i)}:i instanceof kx?function(a){return Li.tinyYolov2.locateFaces(a,i)}:null,!o)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,o(r)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise(function(r){return jt(t,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return i=o.sent(),[2,r(i.map(function(s){return Tm({},s)}))]}})})})},e.prototype.withFaceLandmarks=function(t){return t===void 0&&(t=!1),new Ez(this.runAndExtendWithFaceDetections(),this.input,t)},e.prototype.withFaceExpressions=function(){return new Dx(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new Fx(this.runAndExtendWithFaceDetections(),this.input)},e})(qk),Az=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r;return Ut(this,function(i){switch(i.label){case 0:return[4,new Hk(this.input,this.options)];case 1:return t=i.sent(),r=t[0],t.forEach(function(o){o.score>r.score&&(r=o)}),[2,r]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var t=this;return new Promise(function(r){return jt(t,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return i=o.sent(),[2,r(i?Tm({},i):void 0)]}})})})},e.prototype.withFaceLandmarks=function(t){return t===void 0&&(t=!1),new Sz(this.runAndExtendWithFaceDetection(),this.input,t)},e.prototype.withFaceExpressions=function(){return new Lx(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new Bx(this.runAndExtendWithFaceDetection(),this.input)},e})(qk);function Cz(n,e){return e===void 0&&(e=new Qm),new Az(n,e)}function Iz(n,e){return e===void 0&&(e=new Qm),new Hk(n,e)}function Gk(n,e){if(n.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var t=Array.from(n),r=Array.from(e);return Math.sqrt(t.map(function(i,o){return i-r[o]}).reduce(function(i,o){return i+Math.pow(o,2)},0))}(function(){function n(e,t){t===void 0&&(t=.6),this._distanceThreshold=t;var r=Array.isArray(e)?e:[e];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var i=1,o=function(){return"person "+i++};this._labeledDescriptors=r.map(function(s){if(s instanceof iv)return s;if(s instanceof Float32Array)return new iv(o(),[s]);if(s.descriptor&&s.descriptor instanceof Float32Array)return new iv(o(),[s.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(n.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),n.prototype.computeMeanDistance=function(e,t){return t.map(function(r){return Gk(r,e)}).reduce(function(r,i){return r+i},0)/(t.length||1)},n.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map(function(r){var i=r.descriptors,o=r.label;return new YS(o,t.computeMeanDistance(e,i))}).reduce(function(r,i){return r.distance<i.distance?r:i})},n.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new YS("unknown",t.distance)},n.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},n.fromJSON=function(e){var t=e.labeledDescriptors.map(function(r){return iv.fromJSON(r)});return new n(t,e.distanceThreshold)},n})();function $k(n,e){var t=new of(e.width,e.height),r=t.width,i=t.height;if(r<=0||i<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:i}));if(Array.isArray(n))return n.map(function(a){return $k(a,{width:r,height:i})});if(Ak(n)){var o=n.detection.forSize(r,i),s=n.unshiftedLandmarks.forSize(o.box.width,o.box.height);return i1(Tm(n,o),s)}return ak(n)?Tm(n,n.detection.forSize(r,i)):n instanceof Im||n instanceof Cu?n.forSize(r,i):n}const Tz=()=>{const n=$e.useRef(null),e=$e.useRef(null),t=$e.useRef(!0),{setActiveMode:r,speak:i,playSound:o,conversationState:s,triggerInterview:a,faceDatabase:u,isListening:l,toggleListening:h}=Eu(),[d,m]=$e.useState(!1),[p,y]=$e.useState(0),[b,x]=$e.useState("environment"),E=$e.useRef(0);$e.useEffect(()=>(t.current=!0,(async()=>{const U="https://justadudewhohacks.github.io/face-api.js/models";try{await Promise.all([Li.tinyFaceDetector.loadFromUri(U),Li.faceLandmark68TinyNet.loadFromUri(U),Li.faceRecognitionNet.loadFromUri(U),Li.ssdMobilenetv1.loadFromUri(U)]),t.current&&m(!0)}catch{t.current&&i("Neural network connection failed.")}})(),()=>{t.current=!1}),[]),$e.useEffect(()=>{let D=null;return(async()=>{n.current&&n.current.srcObject&&n.current.srcObject.getTracks().forEach(L=>L.stop());try{D=await navigator.mediaDevices.getUserMedia({video:{facingMode:b,width:{ideal:640},height:{ideal:480},frameRate:{ideal:30}},audio:!1}),n.current&&t.current&&(n.current.srcObject=D)}catch{t.current&&i("Camera malfunction.")}})(),()=>{D&&D.getTracks().forEach(L=>L.stop())}},[b]);const T=()=>{o("click"),x(D=>D==="environment"?"user":"environment")},P=(D,U,L,C,A,M,k)=>{const O=U+C/2,j=L+A/2,X=Math.max(C,A)*.6;D.save(),D.translate(O,j),b==="user"&&D.scale(-1,1),D.beginPath(),D.rotate(k*.05),D.arc(0,0,X*.8,0,Math.PI*2),D.strokeStyle=M,D.lineWidth=3,D.setLineDash([10,5]),D.shadowBlur=10,D.shadowColor=M,D.stroke(),D.rotate(-k*.1);const ue=X*1.2;D.lineWidth=5,D.setLineDash([]);for(let ge=0;ge<3;ge++)D.rotate(Math.PI*2/3),D.beginPath(),D.arc(0,0,ue,0,1),D.stroke();D.resetTransform(),D.strokeStyle=M,D.lineWidth=1,D.globalAlpha=.5,D.beginPath(),D.moveTo(O-20,j),D.lineTo(O+20,j),D.moveTo(O,j-20),D.lineTo(O,j+20),D.stroke(),D.restore()},I=(D,U,L,C,A,M,k=!1)=>{const O=C*.2;if(D.save(),k){const j=Math.sin(Date.now()/100);D.lineWidth=4,D.shadowBlur=20*Math.abs(j),D.shadowColor=M,D.strokeStyle=`rgba(0, 68, 255, ${Math.abs(j)+.5})`}else D.lineWidth=2,D.strokeStyle=M,D.shadowBlur=0;D.beginPath(),D.moveTo(U,L+O),D.lineTo(U,L),D.lineTo(U+O,L),D.moveTo(U+C-O,L),D.lineTo(U+C,L),D.lineTo(U+C,L+O),D.moveTo(U+C,L+A-O),D.lineTo(U+C,L+A),D.lineTo(U+C-O,L+A),D.moveTo(U+O,L+A),D.lineTo(U,L+A),D.lineTo(U,L+A-O),D.stroke(),D.restore()};return $e.useEffect(()=>{if(!d||!n.current)return;let D=!1,U;const L=new Fk({inputSize:320,scoreThreshold:.5}),C=async()=>{if(t.current){if(D){U=requestAnimationFrame(C);return}if(D=!0,n.current&&n.current.readyState===4&&e.current)try{const A=await Iz(n.current,L).withFaceLandmarks(!0).withFaceDescriptors();if(!t.current)return;const M=e.current.getContext("2d"),k={width:n.current.videoWidth,height:n.current.videoHeight};e.current.width=k.width,e.current.height=k.height,b==="user"&&(M.translate(k.width,0),M.scale(-1,1));const O=$k(A,k);M.clearRect(0,0,k.width,k.height);let j=-1,X=0,ue=!1;if(O.forEach((ge,he)=>{const $=ge.detection.box.width*ge.detection.box.height;$>X&&(X=$,j=he)}),O.forEach((ge,he)=>{const $=ge.detection.box,le=he===j;let ae={name:"Unknown",accessLevel:"No Access",distance:1};u.length>0&&u.forEach(W=>{if(W.descriptor){const Q=new Float32Array(Object.values(W.descriptor)),ne=Gk(ge.descriptor,Q);ne<.6&&ne<ae.distance&&(ae={...W,distance:ne})}});let J="#888888";if(s==="SCANNING"&&le?J="#FFFFFF":ae.accessLevel==="Admin"?J="#00FF00":ae.accessLevel==="Medium"?J="#FFA500":ae.accessLevel==="Missing"&&(J="#0044FF"),ae.accessLevel==="Missing"&&(ue=!0),le){const W=Date.now()/20;P(M,$.x,$.y,$.width,$.height,J,W),M.save(),b==="user"&&(M.scale(-1,1),M.translate(-($.x*2+$.width+180),0));const Q=$.x+$.width+20,ne=$.y;(ae.name!=="Unknown"||s==="SCANNING")&&(M.fillStyle="rgba(0, 0, 0, 0.8)",M.fillRect(Q,ne,160,90),M.strokeStyle=J,M.strokeRect(Q,ne,160,90),M.font="bold 12px Orbitron",M.fillStyle=J,M.fillText(ae.name.toUpperCase(),Q+10,ne+25),M.font="10px Share Tech Mono",M.fillStyle="#FFFFFF",M.fillText(`ACCESS: ${ae.accessLevel?ae.accessLevel.toUpperCase():"SCANNING..."}`,Q+10,ne+45),ae.age&&M.fillText(`AGE: ${ae.age}`,Q+10,ne+60)),M.restore(),s==="SCANNING"?(y(fe=>fe+1),M.fillStyle="#00E5FF",M.fillRect($.x,$.y-15,$.width*(p/20),8),p>20&&(y(0),a(ge.descriptor))):y(0)}else{I(M,$.x,$.y,$.width,$.height,J,ae.accessLevel==="Missing"),M.save(),b==="user"&&(M.scale(-1,1),M.translate(-($.x*2+$.width),0)),M.font="bold 10px Orbitron",M.fillStyle=J;const W=ae.name!=="Unknown"?ae.name.toUpperCase():"UNKNOWN";M.fillText(W,$.x,$.y-5),ae.accessLevel==="Missing"&&(M.fillStyle="#0044FF",M.font="bold 12px Orbitron",M.fillText(" MATCH FOUND",$.x,$.y-20)),M.restore()}}),ue){const ge=Date.now();ge-E.current>15e3&&(i("Alert, Sir. Missing person detected in sector.",!1),o("startup"),E.current=ge)}O.length===0&&y(0)}catch(A){console.log("Detection skip",A)}D=!1,U=requestAnimationFrame(C)}};return C(),()=>cancelAnimationFrame(U)},[d,u,s,p,a,b]),se.jsxs("div",{className:"fixed inset-0 z-50 bg-black flex flex-col items-center justify-center",children:[se.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,muted:!0,className:`absolute inset-0 w-full h-full object-cover ${b==="user"?"scale-x-[-1]":""}`}),se.jsx("canvas",{ref:e,className:"absolute inset-0 w-full h-full object-cover pointer-events-none"}),se.jsx("div",{className:"absolute top-8 left-1/2 transform -translate-x-1/2 bg-black/60 border border-cyan px-4 py-2 rounded text-cyan font-orbitron text-xs backdrop-blur-md",children:d?s==="IDLE"?"MULTI-TARGET TRACKING ACTIVE":"PRIORITY SCAN IN PROGRESS":"LOADING AI CORE..."}),se.jsxs("div",{className:"absolute bottom-10 z-50 flex gap-4",children:[se.jsx("button",{onClick:T,className:"w-14 h-14 rounded-full bg-black/60 border border-cyan text-cyan flex items-center justify-center backdrop-blur-md hover:bg-cyan/20 active:scale-90 transition-all",children:se.jsx("i",{className:"fas fa-sync-alt text-xl"})}),se.jsx("button",{onClick:h,className:`w-14 h-14 rounded-full border flex items-center justify-center backdrop-blur-md transition-all ${l?"bg-red-500/50 border-red-500 animate-pulse":"bg-black/60 border-cyan text-cyan"}`,children:se.jsx("i",{className:"fas fa-microphone text-xl"})}),se.jsx("button",{onClick:()=>{o("click"),r("HOME")},className:"w-14 h-14 rounded-full bg-black/60 border border-red-500 text-red-500 flex items-center justify-center backdrop-blur-md",children:se.jsx("i",{className:"fas fa-times text-xl"})})]})]})},kz="JarvisMediaDB",ch="tracks",Wx=()=>new Promise((n,e)=>{const t=indexedDB.open(kz,1);t.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(ch)||i.createObjectStore(ch,{keyPath:"id"})},t.onsuccess=()=>n(t.result),t.onerror=r=>e(r)}),Nz=async n=>{const t=(await Wx()).transaction(ch,"readwrite");return t.objectStore(ch).put(n),t.complete},Rz=async()=>{const n=await Wx();return new Promise(e=>{const r=n.transaction(ch,"readonly").objectStore(ch).getAll();r.onsuccess=()=>e(r.result)})},Pz=async n=>{const t=(await Wx()).transaction(ch,"readwrite");return t.objectStore(ch).delete(n),t.complete},Dz=()=>{const{setActiveMode:n,speak:e,playSound:t,lastCommand:r}=Eu(),i=$e.useRef(null),[o,s]=$e.useState([]),[a,u]=$e.useState(-1),[l,h]=$e.useState(!1),[d,m]=$e.useState(0),[p,y]=$e.useState(0);$e.useEffect(()=>{(async()=>{const L=await Rz();if(L.length>0){const C=L.map(A=>({...A,url:URL.createObjectURL(A.file)}));s(C),u(0)}})()},[]),$e.useEffect(()=>{if(!r)return;const U=r.text,L=r.time;Date.now()-L>2e3||(U.includes("play music")||U.includes("resume")?i.current&&a!==-1?(i.current.play(),h(!0),e("Playing audio.")):e("Playlist is empty."):U.includes("stop")||U.includes("pause")?i.current&&(i.current.pause(),h(!1),e("Audio paused.")):U.includes("next")?(T(),e("Skipping track.")):U.includes("previous")&&P())},[r]);const b=async U=>{const L=Array.from(U.target.files);if(L.length>0){e("Processing audio files.");const C=[];for(const A of L){const M={id:Date.now()+Math.random(),name:A.name.replace(/\.[^/.]+$/,""),file:A};await Nz(M),C.push({...M,url:URL.createObjectURL(A)})}s(A=>[...A,...C]),e(`${L.length} tracks added to database.`),a===-1&&u(0)}},x=async U=>{const L=o[U];await Pz(L.id);const C=[...o];C.splice(U,1),s(C),a>=U&&a>0&&u(a-1)};$e.useEffect(()=>{a>=0&&a<o.length&&i.current&&(i.current.src=o[a].url,l&&i.current.play())},[a]);const E=()=>{!i.current||a===-1||(l?i.current.pause():i.current.play(),h(!l))},T=()=>{a<o.length-1?u(U=>U+1):u(0)},P=()=>{a>0&&u(U=>U-1)},I=()=>{i.current&&(m(i.current.currentTime),y(i.current.duration||0))},D=U=>{const L=Math.floor(U/60),C=Math.floor(U%60);return`${L}:${C<10?"0"+C:C}`};return se.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[se.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[se.jsxs("div",{className:"flex items-center gap-3",children:[se.jsx("i",{className:"fas fa-music text-cyan text-xl animate-pulse"}),se.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"MEDIA DECK"})]}),se.jsx("button",{onClick:()=>{t("click"),n("MENU_OPEN")},className:"text-cyan hover:text-white",children:se.jsx("i",{className:"fas fa-times text-2xl"})})]}),se.jsxs("div",{className:"p-6 flex flex-col items-center justify-center border-b border-cyan/10 bg-cyan/5",children:[se.jsxs("div",{className:"w-32 h-32 rounded-full border-4 border-cyan/30 flex items-center justify-center mb-4 relative",children:[se.jsx("div",{className:`absolute inset-0 border-t-4 border-cyan rounded-full ${l?"animate-spin":""}`}),se.jsx("i",{className:"fas fa-compact-disc text-5xl text-cyan/50"})]}),se.jsx("h3",{className:"text-cyan font-bold text-lg text-center truncate w-full max-w-xs",children:a!==-1?o[a].name:"NO MEDIA LOADED"}),se.jsxs("p",{className:"text-cyan-dim font-mono text-xs mt-1",children:[D(d)," / ",D(p)]}),se.jsx("div",{className:"w-full max-w-xs h-1 bg-cyan/20 mt-4 rounded-full overflow-hidden",children:se.jsx("div",{className:"h-full bg-cyan transition-all duration-300",style:{width:`${d/p*100}%`}})})]}),se.jsx("div",{className:"flex-1 overflow-y-auto p-4 no-scrollbar",children:se.jsx("div",{className:"flex flex-col gap-2",children:o.map((U,L)=>se.jsxs("div",{className:`p-3 border rounded flex items-center gap-3 ${a===L?"border-cyan bg-cyan/20 text-cyan":"border-white/5 text-gray-500"}`,children:[se.jsxs("button",{onClick:()=>{u(L),h(!0)},className:"flex-1 text-left truncate",children:[L+1,". ",U.name]}),se.jsx("button",{onClick:()=>x(L),className:"text-red-500 hover:text-white",children:se.jsx("i",{className:"fas fa-trash"})})]},U.id))})}),se.jsxs("div",{className:"p-6 pb-10 border-t border-cyan/30 bg-black flex flex-col gap-4",children:[se.jsx("input",{type:"file",id:"audio-upload",multiple:!0,accept:"audio/*",className:"hidden",onChange:b}),se.jsx("button",{onClick:()=>document.getElementById("audio-upload").click(),className:"w-full py-3 border border-dashed border-cyan/50 text-cyan/50 font-mono text-xs",children:"+ IMPORT AUDIO FILES"}),se.jsxs("div",{className:"flex justify-between items-center px-4",children:[se.jsx("button",{onClick:P,className:"text-cyan hover:text-white",children:se.jsx("i",{className:"fas fa-step-backward text-2xl"})}),se.jsx("button",{onClick:E,className:"w-16 h-16 rounded-full bg-cyan text-black flex items-center justify-center shadow-[0_0_20px_#00E5FF]",children:se.jsx("i",{className:`fas ${l?"fa-pause":"fa-play"} text-2xl`})}),se.jsx("button",{onClick:T,className:"text-cyan hover:text-white",children:se.jsx("i",{className:"fas fa-step-forward text-2xl"})})]})]}),se.jsx("audio",{ref:i,onTimeUpdate:I,onEnded:T})]})},Lz=()=>{const{faceDatabase:n,deletePerson:e,updatePerson:t,addPerson:r,clearDatabase:i,setActiveMode:o,playSound:s,speak:a}=Eu(),[u,l]=$e.useState("LIST"),[h,d]=$e.useState(null),[m,p]=$e.useState({name:"",gender:"Male",age:"",accessLevel:"No Access"}),[y,b]=$e.useState(!1),[x,E]=$e.useState(!1),T=L=>{const C=n[L];p({name:C.name,gender:C.gender||"Male",age:C.age||"",accessLevel:C.accessLevel||"No Access",descriptor:C.descriptor}),b(!!C.descriptor),d(L),l("EDIT")},P=()=>{p({name:"",gender:"Male",age:"",accessLevel:"No Access"}),b(!1),l("ADD")},I=()=>{if(!m.name)return a("Name is required.");u==="ADD"?r(m):t(h,m),l("LIST")},D=async L=>{const C=L.target.files[0];if(C){E(!0),a("Analyzing photo for biometric data...");try{const A="https://justadudewhohacks.github.io/face-api.js/models";await Promise.all([Li.tinyFaceDetector.loadFromUri(A),Li.faceLandmark68Net.loadFromUri(A),Li.faceRecognitionNet.loadFromUri(A),Li.ssdMobilenetv1.loadFromUri(A)]);const M=await eU(C),k=await Cz(M).withFaceLandmarks().withFaceDescriptor();k?(p(O=>({...O,descriptor:k.descriptor})),b(!0),a("Face detected and encoded.")):a("No valid face found in this image.")}catch(A){console.error(A),a("Analysis failed.")}E(!1)}},U=L=>L==="Admin"?"text-green-500 border-green-500/50 bg-green-500/10":L==="Medium"?"text-orange-500 border-orange-500/50 bg-orange-500/10":L==="Missing"?"text-blue-500 border-blue-500/50 bg-blue-500/10":"text-gray-400 border-gray-500/50 bg-gray-500/10";return se.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[se.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[se.jsxs("div",{className:"flex items-center gap-3",children:[se.jsx("i",{className:"fas fa-database text-cyan text-xl animate-pulse"}),se.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:u==="LIST"?"IDENTITY RECORDS":u==="ADD"?"NEW ENTRY":"EDIT RECORD"})]}),se.jsx("button",{onClick:()=>{s("click"),u==="LIST"?o("HOME"):l("LIST")},className:"text-cyan hover:text-white",children:se.jsx("i",{className:`fas ${u==="LIST"?"fa-times":"fa-arrow-left"} text-2xl`})})]}),u==="LIST"&&se.jsxs(se.Fragment,{children:[se.jsxs("div",{className:"p-4 border-b border-cyan/10 flex justify-between",children:[se.jsxs("span",{className:"text-cyan-dim font-mono text-xs pt-2",children:["RECORDS: ",n.length]}),se.jsx("button",{onClick:()=>{s("click"),P()},className:"px-4 py-2 bg-cyan/10 border border-cyan text-cyan font-orbitron text-xs hover:bg-cyan/30",children:"+ ADD MANUAL ENTRY"})]}),se.jsx("div",{className:"flex-1 overflow-y-auto p-4 no-scrollbar flex flex-col gap-3",children:n.length===0?se.jsx("div",{className:"text-center text-cyan-dim mt-20 opacity-50",children:"DATABASE EMPTY"}):n.map((L,C)=>se.jsxs("div",{className:`p-4 border rounded-lg flex justify-between items-center ${U(L.accessLevel)}`,children:[se.jsxs("div",{className:"flex items-center gap-4",children:[se.jsx("div",{className:"w-10 h-10 rounded-full border flex items-center justify-center",children:se.jsx("i",{className:`fas ${L.descriptor?"fa-fingerprint":"fa-user"} text-lg`})}),se.jsxs("div",{children:[se.jsx("div",{className:"font-bold",children:L.name.toUpperCase()}),se.jsxs("div",{className:"text-xs opacity-70",children:[L.gender," | ",L.age," | ",L.accessLevel]})]})]}),se.jsxs("div",{className:"flex gap-2",children:[se.jsx("button",{onClick:()=>T(C),className:"w-8 h-8 border rounded hover:bg-white/10",children:se.jsx("i",{className:"fas fa-pen text-xs"})}),se.jsx("button",{onClick:()=>e(C),className:"w-8 h-8 border border-red-500/50 text-red-500 hover:bg-red-500/20",children:se.jsx("i",{className:"fas fa-trash text-xs"})})]})]},C))})]}),u!=="LIST"&&se.jsxs("div",{className:"flex-1 overflow-y-auto p-6 flex flex-col gap-6",children:[se.jsxs("div",{className:"p-4 border border-cyan/30 rounded bg-cyan/5 text-center",children:[se.jsx("div",{className:`w-20 h-20 mx-auto rounded-full border-2 flex items-center justify-center mb-2 ${y?"border-green-500 text-green-500":"border-cyan/30 text-cyan/30"}`,children:x?se.jsx("i",{className:"fas fa-circle-notch fa-spin text-2xl"}):se.jsx("i",{className:"fas fa-fingerprint text-3xl"})}),se.jsx("div",{className:"font-mono text-xs mb-3",children:y?"BIOMETRIC DATA LINKED":"NO BIOMETRIC DATA"}),se.jsx("input",{type:"file",id:"face-upload",accept:"image/*",className:"hidden",onChange:D}),se.jsx("button",{onClick:()=>document.getElementById("face-upload").click(),disabled:x,className:"px-4 py-2 border border-cyan text-cyan font-mono text-xs hover:bg-cyan/10",children:y?"UPDATE PHOTO":"UPLOAD PHOTO FOR SCAN"}),se.jsx("div",{className:"text-[10px] text-cyan-dim mt-2",children:"* Uploading a clear face photo allows JARVIS to recognize this person in the field."})]}),se.jsxs("div",{className:"flex flex-col gap-4",children:[se.jsxs("div",{children:[se.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"FULL NAME"}),se.jsx("input",{type:"text",value:m.name,onChange:L=>p({...m,name:L.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-orbitron focus:border-cyan outline-none",placeholder:"ENTER NAME"})]}),se.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[se.jsxs("div",{children:[se.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"GENDER"}),se.jsxs("select",{value:m.gender,onChange:L=>p({...m,gender:L.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-mono outline-none",children:[se.jsx("option",{value:"Male",children:"MALE"}),se.jsx("option",{value:"Female",children:"FEMALE"})]})]}),se.jsxs("div",{children:[se.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"AGE"}),se.jsx("input",{type:"number",value:m.age,onChange:L=>p({...m,age:L.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-mono outline-none",placeholder:"00"})]})]}),se.jsxs("div",{children:[se.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"ACCESS LEVEL"}),se.jsxs("select",{value:m.accessLevel,onChange:L=>p({...m,accessLevel:L.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-mono outline-none",children:[se.jsx("option",{value:"No Access",children:"NO ACCESS (GREY)"}),se.jsx("option",{value:"Medium",children:"MEDIUM (ORANGE)"}),se.jsx("option",{value:"Admin",children:"ADMIN (GREEN)"}),se.jsx("option",{value:"Missing",children:"MISSING PERSON (BLUE)"})]})]})]}),se.jsx("button",{onClick:I,className:"mt-4 w-full py-4 bg-cyan/20 border border-cyan text-cyan font-bold font-orbitron tracking-widest hover:bg-cyan/40",children:"SAVE RECORD"})]})]})},Mz=()=>{const{hudData:n,setActiveMode:e,playSound:t,speak:r,battery:i}=Eu(),[o,s]=$e.useState(!1),[a,u]=$e.useState(new Date);$e.useEffect(()=>{const d=setInterval(()=>u(new Date),1e3);return()=>clearInterval(d)},[]);const l=()=>{s(!o),r(o?"Standard view.":"Heads up display mode active.")},h=d=>d<50?"text-cyan":d<100?"text-cyan-200":d<130?"text-orange-500":"text-red-600 animate-pulse";return se.jsxs("div",{className:"fixed inset-0 z-30 flex flex-col items-center justify-between p-6 bg-black/10 backdrop-blur-[1px]",children:[se.jsxs("div",{className:`w-full h-full flex flex-col justify-between relative z-10 transition-transform duration-500 ${o?"scale-x-[-1]":""}`,children:[se.jsxs("div",{className:"flex justify-between items-start pointer-events-none",children:[se.jsxs("div",{className:"text-cyan font-mono text-sm bg-black/40 p-2 rounded border border-cyan/20",children:[se.jsx("div",{className:"border-b border-cyan/50 mb-1 pb-1 text-[10px]",children:"HEADING"}),se.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(n.heading),""]}),se.jsx("div",{className:"text-xs opacity-70",children:n.heading>=337||n.heading<23?"N":n.heading<67?"NE":n.heading<112?"E":n.heading<157?"SE":n.heading<202?"S":n.heading<247?"SW":n.heading<292?"W":"NW"})]}),se.jsxs("div",{className:"text-right text-cyan font-mono bg-black/40 p-2 rounded border border-cyan/20",children:[se.jsx("div",{className:"text-4xl font-bold",children:a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),se.jsxs("div",{className:"text-xs",children:["ALT: ",n.altitude,"m"]})]})]}),se.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center w-full pointer-events-none",children:[se.jsx("div",{className:`font-orbitron font-black text-[100px] leading-none tracking-tighter drop-shadow-[0_0_10px_rgba(0,0,0,0.8)] ${h(n.speed)}`,children:n.speed}),se.jsx("div",{className:"text-cyan/70 font-mono text-xl tracking-[8px] mt-2 bg-black/30 inline-block px-4 rounded",children:"KM/H"})]}),se.jsxs("div",{className:"flex justify-between items-end w-full",children:[se.jsxs("div",{className:"w-24 h-24 rounded-full border border-cyan/30 flex items-center justify-center relative bg-black/20 backdrop-blur-sm pointer-events-none",children:[se.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-30 text-4xl text-cyan",children:"+"}),se.jsx("div",{className:"w-3 h-3 bg-cyan rounded-full shadow-[0_0_10px_#00E5FF]",style:{transform:`translate(${Math.sin(a.getTime()/1e3)*10}px, ${Math.cos(a.getTime()/1e3)*10}px)`}}),se.jsx("div",{className:"absolute -bottom-6 w-full text-center text-cyan/50 text-[10px]",children:"G-FORCE"})]}),se.jsxs("button",{onClick:()=>{t("click"),window.open("https://maps.google.com","_blank")},className:"mb-2 bg-cyan/10 border border-cyan text-cyan px-6 py-3 rounded-full font-orbitron text-sm hover:bg-cyan/30 active:scale-95 transition-all shadow-[0_0_15px_rgba(0,229,255,0.2)]",children:[se.jsx("i",{className:"fas fa-location-arrow mr-2"})," MAPS"]})]})]}),se.jsxs("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 flex gap-6 z-50",children:[se.jsx("button",{onClick:l,className:`w-14 h-14 rounded-full border flex items-center justify-center backdrop-blur-md transition-all shadow-[0_0_15px_rgba(0,229,255,0.2)] ${o?"bg-cyan text-black border-cyan":"bg-black/60 border-cyan text-cyan"}`,children:se.jsx("i",{className:"fas fa-clone text-xl transform rotate-90"})}),se.jsx("button",{onClick:()=>{t("click"),e("HOME")},className:"w-14 h-14 rounded-full bg-black/60 border border-red-500 text-red-500 flex items-center justify-center backdrop-blur-md shadow-[0_0_15px_rgba(255,0,0,0.3)]",children:se.jsx("i",{className:"fas fa-times text-xl"})})]})]})},Oz="modulepreload",Fz=function(n){return"/jarvis-mobile/"+n},nA={},n2=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let s=function(l){return Promise.all(l.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=s(t.map(l=>{if(l=Fz(l),l in nA)return;nA[l]=!0;const h=l.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":Oz,h||(m.as="script"),m.crossOrigin="",m.href=l,u&&m.setAttribute("nonce",u),document.head.appendChild(m),h)return new Promise((p,y)=>{m.addEventListener("load",p),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})};function fr(n){"@babel/helpers - typeof";return fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(n)}var xu=Uint8Array,ga=Uint16Array,qx=Int32Array,Hx=new xu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Gx=new xu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),rA=new xu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Kk=function(n,e){for(var t=new ga(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new qx(t[30]),r=1;r<30;++r)for(var o=t[r];o<t[r+1];++o)i[o]=o-t[r]<<5|r;return{b:t,r:i}},Xk=Kk(Hx,2),Bz=Xk.b,Ew=Xk.r;Bz[28]=258,Ew[258]=28;var Vz=Kk(Gx,0),iA=Vz.r,Sw=new ga(32768);for(var kr=0;kr<32768;++kr){var Fc=(kr&43690)>>1|(kr&21845)<<1;Fc=(Fc&52428)>>2|(Fc&13107)<<2,Fc=(Fc&61680)>>4|(Fc&3855)<<4,Sw[kr]=((Fc&65280)>>8|(Fc&255)<<8)>>1}var am=(function(n,e,t){for(var r=n.length,i=0,o=new ga(e);i<r;++i)n[i]&&++o[n[i]-1];var s=new ga(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var a;if(t){a=new ga(1<<e);var u=15-e;for(i=0;i<r;++i)if(n[i])for(var l=i<<4|n[i],h=e-n[i],d=s[n[i]-1]++<<h,m=d|(1<<h)-1;d<=m;++d)a[Sw[d]>>u]=l}else for(a=new ga(r),i=0;i<r;++i)n[i]&&(a[i]=Sw[s[n[i]-1]++]>>15-n[i]);return a}),ff=new xu(288);for(var kr=0;kr<144;++kr)ff[kr]=8;for(var kr=144;kr<256;++kr)ff[kr]=9;for(var kr=256;kr<280;++kr)ff[kr]=7;for(var kr=280;kr<288;++kr)ff[kr]=8;var w0=new xu(32);for(var kr=0;kr<32;++kr)w0[kr]=5;var jz=am(ff,9,0),Uz=am(w0,5,0),Yk=function(n){return(n+7)/8|0},zz=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new xu(n.subarray(e,t))},ql=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8},Wp=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8,n[r+2]|=t>>16},r2=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var i=t.length,o=t.slice();if(!i)return{t:Jk,l:0};if(i==1){var s=new xu(t[0].s+1);return s[t[0].s]=1,{t:s,l:1}}t.sort(function(D,U){return D.f-U.f}),t.push({s:-1,f:25001});var a=t[0],u=t[1],l=0,h=1,d=2;for(t[0]={s:-1,f:a.f+u.f,l:a,r:u};h!=i-1;)a=t[t[l].f<t[d].f?l++:d++],u=t[l!=h&&t[l].f<t[d].f?l++:d++],t[h++]={s:-1,f:a.f+u.f,l:a,r:u};for(var m=o[0].s,r=1;r<i;++r)o[r].s>m&&(m=o[r].s);var p=new ga(m+1),y=Aw(t[h-1],p,0);if(y>e){var r=0,b=0,x=y-e,E=1<<x;for(o.sort(function(U,L){return p[L.s]-p[U.s]||U.f-L.f});r<i;++r){var T=o[r].s;if(p[T]>e)b+=E-(1<<y-p[T]),p[T]=e;else break}for(b>>=x;b>0;){var P=o[r].s;p[P]<e?b-=1<<e-p[P]++-1:++r}for(;r>=0&&b;--r){var I=o[r].s;p[I]==e&&(--p[I],++b)}y=e}return{t:new xu(p),l:y}},Aw=function(n,e,t){return n.s==-1?Math.max(Aw(n.l,e,t+1),Aw(n.r,e,t+1)):e[n.s]=t},oA=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new ga(++e),r=0,i=n[0],o=1,s=function(u){t[r++]=u},a=1;a<=e;++a)if(n[a]==i&&a!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=n[a]}return{c:t.subarray(0,r),n:e}},qp=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},Qk=function(n,e,t){var r=t.length,i=Yk(e+2);n[i]=r&255,n[i+1]=r>>8,n[i+2]=n[i]^255,n[i+3]=n[i+1]^255;for(var o=0;o<r;++o)n[i+o+4]=t[o];return(i+4+r)*8},sA=function(n,e,t,r,i,o,s,a,u,l,h){ql(e,h++,t),++i[256];for(var d=r2(i,15),m=d.t,p=d.l,y=r2(o,15),b=y.t,x=y.l,E=oA(m),T=E.c,P=E.n,I=oA(b),D=I.c,U=I.n,L=new ga(19),C=0;C<T.length;++C)++L[T[C]&31];for(var C=0;C<D.length;++C)++L[D[C]&31];for(var A=r2(L,7),M=A.t,k=A.l,O=19;O>4&&!M[rA[O-1]];--O);var j=l+5<<3,X=qp(i,ff)+qp(o,w0)+s,ue=qp(i,m)+qp(o,b)+s+14+3*O+qp(L,M)+2*L[16]+3*L[17]+7*L[18];if(u>=0&&j<=X&&j<=ue)return Qk(e,h,n.subarray(u,u+l));var ge,he,$,le;if(ql(e,h,1+(ue<X)),h+=2,ue<X){ge=am(m,p,0),he=m,$=am(b,x,0),le=b;var ae=am(M,k,0);ql(e,h,P-257),ql(e,h+5,U-1),ql(e,h+10,O-4),h+=14;for(var C=0;C<O;++C)ql(e,h+3*C,M[rA[C]]);h+=3*O;for(var J=[T,D],W=0;W<2;++W)for(var Q=J[W],C=0;C<Q.length;++C){var ne=Q[C]&31;ql(e,h,ae[ne]),h+=M[ne],ne>15&&(ql(e,h,Q[C]>>5&127),h+=Q[C]>>12)}}else ge=jz,he=ff,$=Uz,le=w0;for(var C=0;C<a;++C){var fe=r[C];if(fe>255){var ne=fe>>18&31;Wp(e,h,ge[ne+257]),h+=he[ne+257],ne>7&&(ql(e,h,fe>>23&31),h+=Hx[ne]);var ve=fe&31;Wp(e,h,$[ve]),h+=le[ve],ve>3&&(Wp(e,h,fe>>5&8191),h+=Gx[ve])}else Wp(e,h,ge[fe]),h+=he[fe]}return Wp(e,h,ge[256]),h+he[256]},Wz=new qx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Jk=new xu(0),qz=function(n,e,t,r,i,o){var s=o.z||n.length,a=new xu(r+s+5*(1+Math.ceil(s/7e3))+i),u=a.subarray(r,a.length-i),l=o.l,h=(o.r||0)&7;if(e){h&&(u[0]=o.r>>3);for(var d=Wz[e-1],m=d>>13,p=d&8191,y=(1<<t)-1,b=o.p||new ga(32768),x=o.h||new ga(y+1),E=Math.ceil(t/3),T=2*E,P=function(Qe){return(n[Qe]^n[Qe+1]<<E^n[Qe+2]<<T)&y},I=new qx(25e3),D=new ga(288),U=new ga(32),L=0,C=0,A=o.i||0,M=0,k=o.w||0,O=0;A+2<s;++A){var j=P(A),X=A&32767,ue=x[j];if(b[X]=ue,x[j]=X,k<=A){var ge=s-A;if((L>7e3||M>24576)&&(ge>423||!l)){h=sA(n,u,0,I,D,U,C,M,O,A-O,h),M=L=C=0,O=A;for(var he=0;he<286;++he)D[he]=0;for(var he=0;he<30;++he)U[he]=0}var $=2,le=0,ae=p,J=X-ue&32767;if(ge>2&&j==P(A-J))for(var W=Math.min(m,ge)-1,Q=Math.min(32767,A),ne=Math.min(258,ge);J<=Q&&--ae&&X!=ue;){if(n[A+$]==n[A+$-J]){for(var fe=0;fe<ne&&n[A+fe]==n[A+fe-J];++fe);if(fe>$){if($=fe,le=J,fe>W)break;for(var ve=Math.min(J,fe-2),we=0,he=0;he<ve;++he){var Se=A-J+he&32767,Ce=b[Se],Fe=Se-Ce&32767;Fe>we&&(we=Fe,ue=Se)}}}X=ue,ue=b[X],J+=X-ue&32767}if(le){I[M++]=268435456|Ew[$]<<18|iA[le];var qe=Ew[$]&31,Ne=iA[le]&31;C+=Hx[qe]+Gx[Ne],++D[257+qe],++U[Ne],k=A+$,++L}else I[M++]=n[A],++D[n[A]]}}for(A=Math.max(A,k);A<s;++A)I[M++]=n[A],++D[n[A]];h=sA(n,u,l,I,D,U,C,M,O,A-O,h),l||(o.r=h&7|u[h/8|0]<<3,h-=7,o.h=x,o.p=b,o.i=A,o.w=k)}else{for(var A=o.w||0;A<s+l;A+=65535){var Oe=A+65535;Oe>=s&&(u[h/8|0]=l,Oe=s),h=Qk(u,h+1,n.subarray(A,Oe))}o.i=s}return zz(a,0,r+Yk(h)+i)},Zk=function(){var n=1,e=0;return{p:function(t){for(var r=n,i=e,o=t.length|0,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)i+=r+=t[s];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}n=r,e=i},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},Hz=function(n,e,t,r,i){if(!i&&(i={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new xu(o.length+n.length);s.set(o),s.set(n,o.length),n=s,i.w=o.length}return qz(n,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,r,i)},eN=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},Gz=function(n,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=r<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var i=Zk();i.p(e.dictionary),eN(n,2,i.d())}};function Cw(n,e){e||(e={});var t=Zk();t.p(n);var r=Hz(n,e,e.dictionary?6:2,4);return Gz(r,e),eN(r,r.length-4,t.d()),r}var $z=typeof TextDecoder<"u"&&new TextDecoder,Kz=0;try{$z.decode(Jk,{stream:!0}),Kz=1}catch{}function Xz(n){if(Array.isArray(n))return n}function Yz(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,o,s,a=[],u=!0,l=!1;try{if(o=(t=t.call(n)).next,e!==0)for(;!(u=(r=o.call(t)).done)&&(a.push(r.value),a.length!==e);u=!0);}catch(h){l=!0,i=h}finally{try{if(!u&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(l)throw i}}return a}}function aA(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function Qz(n,e){if(n){if(typeof n=="string")return aA(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?aA(n,e):void 0}}function Jz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uA(n,e){return Xz(n)||Yz(n,e)||Qz(n,e)||Jz()}function lA(n,e="utf8"){return new TextDecoder(e).decode(n)}const Zz=new TextEncoder;function eW(n){return Zz.encode(n)}const tW=1024*8,nW=(()=>{const n=new Uint8Array(4),e=new Uint32Array(n.buffer);return!((e[0]=1)&n[0])})(),i2={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class $x{constructor(e=tW,t={}){hr(this,"buffer");hr(this,"byteLength");hr(this,"byteOffset");hr(this,"length");hr(this,"offset");hr(this,"lastWrittenByte");hr(this,"littleEndian");hr(this,"_data");hr(this,"_mark");hr(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const i=t.offset?t.offset>>>0:0,o=e.byteLength-i;let s=i;(ArrayBuffer.isView(e)||e instanceof $x)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+i),e=e.buffer),r?this.lastWrittenByte=o:this.lastWrittenByte=0,this.buffer=e,this.length=o,this.byteLength=o,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,o),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const r=i2[t].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,o=this.buffer.slice(i,i+r);if(this.littleEndian===nW&&t!=="uint8"&&t!=="int8"){const a=new Uint8Array(this.buffer.slice(i,i+r));a.reverse();const u=new i2[t](a.buffer);return this.offset+=r,u.reverse(),u}const s=new i2[t](o);return this.offset+=r,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let r=0;r<e;r++)t+=this.readChar();return t}readUtf8(e=1){return lA(this.readBytes(e))}decodeText(e=1,t="utf8"){return lA(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(eW(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function op(n){let e=n.length;for(;--e>=0;)n[e]=0}const rW=3,iW=258,tN=29,oW=256,sW=oW+1+tN,nN=30,aW=512,uW=new Array((sW+2)*2);op(uW);const lW=new Array(nN*2);op(lW);const cW=new Array(aW);op(cW);const hW=new Array(iW-rW+1);op(hW);const fW=new Array(tN);op(fW);const dW=new Array(nN);op(dW);const pW=(n,e,t,r)=>{let i=n&65535|0,o=n>>>16&65535|0,s=0;for(;t!==0;){s=t>2e3?2e3:t,t-=s;do i=i+e[r++]|0,o=o+i|0;while(--s);i%=65521,o%=65521}return i|o<<16|0};var Iw=pW;const mW=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},gW=new Uint32Array(mW()),vW=(n,e,t,r)=>{const i=gW,o=r+t;n^=-1;for(let s=r;s<o;s++)n=n>>>8^i[(n^e[s])&255];return n^-1};var Xu=vW,Tw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},rN={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const yW=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var wW=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const r in t)yW(t,r)&&(n[r]=t[r])}}return n},bW=n=>{let e=0;for(let r=0,i=n.length;r<i;r++)e+=n[r].length;const t=new Uint8Array(e);for(let r=0,i=0,o=n.length;r<o;r++){let s=n[r];t.set(s,i),i+=s.length}return t},iN={assign:wW,flattenChunks:bW};let oN=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{oN=!1}const km=new Uint8Array(256);for(let n=0;n<256;n++)km[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;km[254]=km[254]=1;var xW=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,r,i,o,s=n.length,a=0;for(i=0;i<s;i++)t=n.charCodeAt(i),(t&64512)===55296&&i+1<s&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),o=0,i=0;o<a;i++)t=n.charCodeAt(i),(t&64512)===55296&&i+1<s&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),t<128?e[o++]=t:t<2048?(e[o++]=192|t>>>6,e[o++]=128|t&63):t<65536?(e[o++]=224|t>>>12,e[o++]=128|t>>>6&63,e[o++]=128|t&63):(e[o++]=240|t>>>18,e[o++]=128|t>>>12&63,e[o++]=128|t>>>6&63,e[o++]=128|t&63);return e};const _W=(n,e)=>{if(e<65534&&n.subarray&&oN)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let r=0;r<e;r++)t+=String.fromCharCode(n[r]);return t};var EW=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let r,i;const o=new Array(t*2);for(i=0,r=0;r<t;){let s=n[r++];if(s<128){o[i++]=s;continue}let a=km[s];if(a>4){o[i++]=65533,r+=a-1;continue}for(s&=a===2?31:a===3?15:7;a>1&&r<t;)s=s<<6|n[r++]&63,a--;if(a>1){o[i++]=65533;continue}s<65536?o[i++]=s:(s-=65536,o[i++]=55296|s>>10&1023,o[i++]=56320|s&1023)}return _W(o,i)},SW=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+km[n[t]]>e?t:e},kw={string2buf:xW,buf2string:EW,utf8border:SW};function AW(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var CW=AW;const lv=16209,IW=16191;var TW=function(e,t){let r,i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,I,D,U,L,C,A,M;const k=e.state;r=e.next_in,A=e.input,i=r+(e.avail_in-5),o=e.next_out,M=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),u=k.dmax,l=k.wsize,h=k.whave,d=k.wnext,m=k.window,p=k.hold,y=k.bits,b=k.lencode,x=k.distcode,E=(1<<k.lenbits)-1,T=(1<<k.distbits)-1;e:do{y<15&&(p+=A[r++]<<y,y+=8,p+=A[r++]<<y,y+=8),P=b[p&E];t:for(;;){if(I=P>>>24,p>>>=I,y-=I,I=P>>>16&255,I===0)M[o++]=P&65535;else if(I&16){D=P&65535,I&=15,I&&(y<I&&(p+=A[r++]<<y,y+=8),D+=p&(1<<I)-1,p>>>=I,y-=I),y<15&&(p+=A[r++]<<y,y+=8,p+=A[r++]<<y,y+=8),P=x[p&T];n:for(;;){if(I=P>>>24,p>>>=I,y-=I,I=P>>>16&255,I&16){if(U=P&65535,I&=15,y<I&&(p+=A[r++]<<y,y+=8,y<I&&(p+=A[r++]<<y,y+=8)),U+=p&(1<<I)-1,U>u){e.msg="invalid distance too far back",k.mode=lv;break e}if(p>>>=I,y-=I,I=o-s,U>I){if(I=U-I,I>h&&k.sane){e.msg="invalid distance too far back",k.mode=lv;break e}if(L=0,C=m,d===0){if(L+=l-I,I<D){D-=I;do M[o++]=m[L++];while(--I);L=o-U,C=M}}else if(d<I){if(L+=l+d-I,I-=d,I<D){D-=I;do M[o++]=m[L++];while(--I);if(L=0,d<D){I=d,D-=I;do M[o++]=m[L++];while(--I);L=o-U,C=M}}}else if(L+=d-I,I<D){D-=I;do M[o++]=m[L++];while(--I);L=o-U,C=M}for(;D>2;)M[o++]=C[L++],M[o++]=C[L++],M[o++]=C[L++],D-=3;D&&(M[o++]=C[L++],D>1&&(M[o++]=C[L++]))}else{L=o-U;do M[o++]=M[L++],M[o++]=M[L++],M[o++]=M[L++],D-=3;while(D>2);D&&(M[o++]=M[L++],D>1&&(M[o++]=M[L++]))}}else if((I&64)===0){P=x[(P&65535)+(p&(1<<I)-1)];continue n}else{e.msg="invalid distance code",k.mode=lv;break e}break}}else if((I&64)===0){P=b[(P&65535)+(p&(1<<I)-1)];continue t}else if(I&32){k.mode=IW;break e}else{e.msg="invalid literal/length code",k.mode=lv;break e}break}}while(r<i&&o<a);D=y>>3,r-=D,y-=D<<3,p&=(1<<y)-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=o<a?257+(a-o):257-(o-a),k.hold=p,k.bits=y};const ed=15,cA=852,hA=592,fA=0,o2=1,dA=2,kW=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),NW=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),RW=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),PW=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),DW=(n,e,t,r,i,o,s,a)=>{const u=a.bits;let l=0,h=0,d=0,m=0,p=0,y=0,b=0,x=0,E=0,T=0,P,I,D,U,L,C=null,A;const M=new Uint16Array(ed+1),k=new Uint16Array(ed+1);let O=null,j,X,ue;for(l=0;l<=ed;l++)M[l]=0;for(h=0;h<r;h++)M[e[t+h]]++;for(p=u,m=ed;m>=1&&M[m]===0;m--);if(p>m&&(p=m),m===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<m&&M[d]===0;d++);for(p<d&&(p=d),x=1,l=1;l<=ed;l++)if(x<<=1,x-=M[l],x<0)return-1;if(x>0&&(n===fA||m!==1))return-1;for(k[1]=0,l=1;l<ed;l++)k[l+1]=k[l]+M[l];for(h=0;h<r;h++)e[t+h]!==0&&(s[k[e[t+h]]++]=h);if(n===fA?(C=O=s,A=20):n===o2?(C=kW,O=NW,A=257):(C=RW,O=PW,A=0),T=0,h=0,l=d,L=o,y=p,b=0,D=-1,E=1<<p,U=E-1,n===o2&&E>cA||n===dA&&E>hA)return 1;for(;;){j=l-b,s[h]+1<A?(X=0,ue=s[h]):s[h]>=A?(X=O[s[h]-A],ue=C[s[h]-A]):(X=96,ue=0),P=1<<l-b,I=1<<y,d=I;do I-=P,i[L+(T>>b)+I]=j<<24|X<<16|ue|0;while(I!==0);for(P=1<<l-1;T&P;)P>>=1;if(P!==0?(T&=P-1,T+=P):T=0,h++,--M[l]===0){if(l===m)break;l=e[t+s[h]]}if(l>p&&(T&U)!==D){for(b===0&&(b=p),L+=d,y=l-b,x=1<<y;y+b<m&&(x-=M[y+b],!(x<=0));)y++,x<<=1;if(E+=1<<y,n===o2&&E>cA||n===dA&&E>hA)return 1;D=T&U,i[D]=p<<24|y<<16|L-o|0}}return T!==0&&(i[L+T]=l-b<<24|64<<16|0),a.bits=p,0};var um=DW;const LW=0,sN=1,aN=2,{Z_FINISH:pA,Z_BLOCK:MW,Z_TREES:cv,Z_OK:df,Z_STREAM_END:OW,Z_NEED_DICT:FW,Z_STREAM_ERROR:Ga,Z_DATA_ERROR:uN,Z_MEM_ERROR:lN,Z_BUF_ERROR:BW,Z_DEFLATED:mA}=rN,s1=16180,gA=16181,vA=16182,yA=16183,wA=16184,bA=16185,xA=16186,_A=16187,EA=16188,SA=16189,b0=16190,Hl=16191,s2=16192,AA=16193,a2=16194,CA=16195,IA=16196,TA=16197,kA=16198,hv=16199,fv=16200,NA=16201,RA=16202,PA=16203,DA=16204,LA=16205,u2=16206,MA=16207,OA=16208,Br=16209,cN=16210,hN=16211,VW=852,jW=592,UW=15,zW=UW,FA=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function WW(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Sf=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<s1||e.mode>hN?1:0},fN=n=>{if(Sf(n))return Ga;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=s1,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(VW),e.distcode=e.distdyn=new Int32Array(jW),e.sane=1,e.back=-1,df},dN=n=>{if(Sf(n))return Ga;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,fN(n)},pN=(n,e)=>{let t;if(Sf(n))return Ga;const r=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Ga:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=t,r.wbits=e,dN(n))},mN=(n,e)=>{if(!n)return Ga;const t=new WW;n.state=t,t.strm=n,t.window=null,t.mode=s1;const r=pN(n,e);return r!==df&&(n.state=null),r},qW=n=>mN(n,zW);let BA=!0,l2,c2;const HW=n=>{if(BA){l2=new Int32Array(512),c2=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(um(sN,n.lens,0,288,l2,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;um(aN,n.lens,0,32,c2,0,n.work,{bits:5}),BA=!1}n.lencode=l2,n.lenbits=9,n.distcode=c2,n.distbits=5},gN=(n,e,t,r)=>{let i;const o=n.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),r>=o.wsize?(o.window.set(e.subarray(t-o.wsize,t),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>r&&(i=r),o.window.set(e.subarray(t-r,t-r+i),o.wnext),r-=i,r?(o.window.set(e.subarray(t-r,t),0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},GW=(n,e)=>{let t,r,i,o,s,a,u,l,h,d,m,p,y,b,x=0,E,T,P,I,D,U,L,C;const A=new Uint8Array(4);let M,k;const O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Sf(n)||!n.output||!n.input&&n.avail_in!==0)return Ga;t=n.state,t.mode===Hl&&(t.mode=s2),s=n.next_out,i=n.output,u=n.avail_out,o=n.next_in,r=n.input,a=n.avail_in,l=t.hold,h=t.bits,d=a,m=u,C=df;e:for(;;)switch(t.mode){case s1:if(t.wrap===0){t.mode=s2;break}for(;h<16;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(t.wrap&2&&l===35615){t.wbits===0&&(t.wbits=15),t.check=0,A[0]=l&255,A[1]=l>>>8&255,t.check=Xu(t.check,A,2,0),l=0,h=0,t.mode=gA;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){n.msg="incorrect header check",t.mode=Br;break}if((l&15)!==mA){n.msg="unknown compression method",t.mode=Br;break}if(l>>>=4,h-=4,L=(l&15)+8,t.wbits===0&&(t.wbits=L),L>15||L>t.wbits){n.msg="invalid window size",t.mode=Br;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=l&512?SA:Hl,l=0,h=0;break;case gA:for(;h<16;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(t.flags=l,(t.flags&255)!==mA){n.msg="unknown compression method",t.mode=Br;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=Br;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&t.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,t.check=Xu(t.check,A,2,0)),l=0,h=0,t.mode=vA;case vA:for(;h<32;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.head&&(t.head.time=l),t.flags&512&&t.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,A[2]=l>>>16&255,A[3]=l>>>24&255,t.check=Xu(t.check,A,4,0)),l=0,h=0,t.mode=yA;case yA:for(;h<16;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&t.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,t.check=Xu(t.check,A,2,0)),l=0,h=0,t.mode=wA;case wA:if(t.flags&1024){for(;h<16;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&t.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,t.check=Xu(t.check,A,2,0)),l=0,h=0}else t.head&&(t.head.extra=null);t.mode=bA;case bA:if(t.flags&1024&&(p=t.length,p>a&&(p=a),p&&(t.head&&(L=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(r.subarray(o,o+p),L)),t.flags&512&&t.wrap&4&&(t.check=Xu(t.check,r,p,o)),a-=p,o+=p,t.length-=p),t.length))break e;t.length=0,t.mode=xA;case xA:if(t.flags&2048){if(a===0)break e;p=0;do L=r[o+p++],t.head&&L&&t.length<65536&&(t.head.name+=String.fromCharCode(L));while(L&&p<a);if(t.flags&512&&t.wrap&4&&(t.check=Xu(t.check,r,p,o)),a-=p,o+=p,L)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=_A;case _A:if(t.flags&4096){if(a===0)break e;p=0;do L=r[o+p++],t.head&&L&&t.length<65536&&(t.head.comment+=String.fromCharCode(L));while(L&&p<a);if(t.flags&512&&t.wrap&4&&(t.check=Xu(t.check,r,p,o)),a-=p,o+=p,L)break e}else t.head&&(t.head.comment=null);t.mode=EA;case EA:if(t.flags&512){for(;h<16;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(t.wrap&4&&l!==(t.check&65535)){n.msg="header crc mismatch",t.mode=Br;break}l=0,h=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=Hl;break;case SA:for(;h<32;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}n.adler=t.check=FA(l),l=0,h=0,t.mode=b0;case b0:if(t.havedict===0)return n.next_out=s,n.avail_out=u,n.next_in=o,n.avail_in=a,t.hold=l,t.bits=h,FW;n.adler=t.check=1,t.mode=Hl;case Hl:if(e===MW||e===cv)break e;case s2:if(t.last){l>>>=h&7,h-=h&7,t.mode=u2;break}for(;h<3;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}switch(t.last=l&1,l>>>=1,h-=1,l&3){case 0:t.mode=AA;break;case 1:if(HW(t),t.mode=hv,e===cv){l>>>=2,h-=2;break e}break;case 2:t.mode=IA;break;case 3:n.msg="invalid block type",t.mode=Br}l>>>=2,h-=2;break;case AA:for(l>>>=h&7,h-=h&7;h<32;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if((l&65535)!==(l>>>16^65535)){n.msg="invalid stored block lengths",t.mode=Br;break}if(t.length=l&65535,l=0,h=0,t.mode=a2,e===cv)break e;case a2:t.mode=CA;case CA:if(p=t.length,p){if(p>a&&(p=a),p>u&&(p=u),p===0)break e;i.set(r.subarray(o,o+p),s),a-=p,o+=p,u-=p,s+=p,t.length-=p;break}t.mode=Hl;break;case IA:for(;h<14;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(t.nlen=(l&31)+257,l>>>=5,h-=5,t.ndist=(l&31)+1,l>>>=5,h-=5,t.ncode=(l&15)+4,l>>>=4,h-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=Br;break}t.have=0,t.mode=TA;case TA:for(;t.have<t.ncode;){for(;h<3;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.lens[O[t.have++]]=l&7,l>>>=3,h-=3}for(;t.have<19;)t.lens[O[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,M={bits:t.lenbits},C=um(LW,t.lens,0,19,t.lencode,0,t.work,M),t.lenbits=M.bits,C){n.msg="invalid code lengths set",t.mode=Br;break}t.have=0,t.mode=kA;case kA:for(;t.have<t.nlen+t.ndist;){for(;x=t.lencode[l&(1<<t.lenbits)-1],E=x>>>24,T=x>>>16&255,P=x&65535,!(E<=h);){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(P<16)l>>>=E,h-=E,t.lens[t.have++]=P;else{if(P===16){for(k=E+2;h<k;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(l>>>=E,h-=E,t.have===0){n.msg="invalid bit length repeat",t.mode=Br;break}L=t.lens[t.have-1],p=3+(l&3),l>>>=2,h-=2}else if(P===17){for(k=E+3;h<k;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}l>>>=E,h-=E,L=0,p=3+(l&7),l>>>=3,h-=3}else{for(k=E+7;h<k;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}l>>>=E,h-=E,L=0,p=11+(l&127),l>>>=7,h-=7}if(t.have+p>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=Br;break}for(;p--;)t.lens[t.have++]=L}}if(t.mode===Br)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=Br;break}if(t.lenbits=9,M={bits:t.lenbits},C=um(sN,t.lens,0,t.nlen,t.lencode,0,t.work,M),t.lenbits=M.bits,C){n.msg="invalid literal/lengths set",t.mode=Br;break}if(t.distbits=6,t.distcode=t.distdyn,M={bits:t.distbits},C=um(aN,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,M),t.distbits=M.bits,C){n.msg="invalid distances set",t.mode=Br;break}if(t.mode=hv,e===cv)break e;case hv:t.mode=fv;case fv:if(a>=6&&u>=258){n.next_out=s,n.avail_out=u,n.next_in=o,n.avail_in=a,t.hold=l,t.bits=h,TW(n,m),s=n.next_out,i=n.output,u=n.avail_out,o=n.next_in,r=n.input,a=n.avail_in,l=t.hold,h=t.bits,t.mode===Hl&&(t.back=-1);break}for(t.back=0;x=t.lencode[l&(1<<t.lenbits)-1],E=x>>>24,T=x>>>16&255,P=x&65535,!(E<=h);){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(T&&(T&240)===0){for(I=E,D=T,U=P;x=t.lencode[U+((l&(1<<I+D)-1)>>I)],E=x>>>24,T=x>>>16&255,P=x&65535,!(I+E<=h);){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}l>>>=I,h-=I,t.back+=I}if(l>>>=E,h-=E,t.back+=E,t.length=P,T===0){t.mode=LA;break}if(T&32){t.back=-1,t.mode=Hl;break}if(T&64){n.msg="invalid literal/length code",t.mode=Br;break}t.extra=T&15,t.mode=NA;case NA:if(t.extra){for(k=t.extra;h<k;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,h-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=RA;case RA:for(;x=t.distcode[l&(1<<t.distbits)-1],E=x>>>24,T=x>>>16&255,P=x&65535,!(E<=h);){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if((T&240)===0){for(I=E,D=T,U=P;x=t.distcode[U+((l&(1<<I+D)-1)>>I)],E=x>>>24,T=x>>>16&255,P=x&65535,!(I+E<=h);){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}l>>>=I,h-=I,t.back+=I}if(l>>>=E,h-=E,t.back+=E,T&64){n.msg="invalid distance code",t.mode=Br;break}t.offset=P,t.extra=T&15,t.mode=PA;case PA:if(t.extra){for(k=t.extra;h<k;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,h-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=Br;break}t.mode=DA;case DA:if(u===0)break e;if(p=m-u,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=Br;break}p>t.wnext?(p-=t.wnext,y=t.wsize-p):y=t.wnext-p,p>t.length&&(p=t.length),b=t.window}else b=i,y=s-t.offset,p=t.length;p>u&&(p=u),u-=p,t.length-=p;do i[s++]=b[y++];while(--p);t.length===0&&(t.mode=fv);break;case LA:if(u===0)break e;i[s++]=t.length,u--,t.mode=fv;break;case u2:if(t.wrap){for(;h<32;){if(a===0)break e;a--,l|=r[o++]<<h,h+=8}if(m-=u,n.total_out+=m,t.total+=m,t.wrap&4&&m&&(n.adler=t.check=t.flags?Xu(t.check,i,m,s-m):Iw(t.check,i,m,s-m)),m=u,t.wrap&4&&(t.flags?l:FA(l))!==t.check){n.msg="incorrect data check",t.mode=Br;break}l=0,h=0}t.mode=MA;case MA:if(t.wrap&&t.flags){for(;h<32;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(t.wrap&4&&l!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=Br;break}l=0,h=0}t.mode=OA;case OA:C=OW;break e;case Br:C=uN;break e;case cN:return lN;case hN:default:return Ga}return n.next_out=s,n.avail_out=u,n.next_in=o,n.avail_in=a,t.hold=l,t.bits=h,(t.wsize||m!==n.avail_out&&t.mode<Br&&(t.mode<u2||e!==pA))&&gN(n,n.output,n.next_out,m-n.avail_out),d-=n.avail_in,m-=n.avail_out,n.total_in+=d,n.total_out+=m,t.total+=m,t.wrap&4&&m&&(n.adler=t.check=t.flags?Xu(t.check,i,m,n.next_out-m):Iw(t.check,i,m,n.next_out-m)),n.data_type=t.bits+(t.last?64:0)+(t.mode===Hl?128:0)+(t.mode===hv||t.mode===a2?256:0),(d===0&&m===0||e===pA)&&C===df&&(C=BW),C},$W=n=>{if(Sf(n))return Ga;let e=n.state;return e.window&&(e.window=null),n.state=null,df},KW=(n,e)=>{if(Sf(n))return Ga;const t=n.state;return(t.wrap&2)===0?Ga:(t.head=e,e.done=!1,df)},XW=(n,e)=>{const t=e.length;let r,i,o;return Sf(n)||(r=n.state,r.wrap!==0&&r.mode!==b0)?Ga:r.mode===b0&&(i=1,i=Iw(i,e,t,0),i!==r.check)?uN:(o=gN(n,e,t,t),o?(r.mode=cN,lN):(r.havedict=1,df))};var YW=dN,QW=pN,JW=fN,ZW=qW,eq=mN,tq=GW,nq=$W,rq=KW,iq=XW,oq="pako inflate (from Nodeca project)",$l={inflateReset:YW,inflateReset2:QW,inflateResetKeep:JW,inflateInit:ZW,inflateInit2:eq,inflate:tq,inflateEnd:nq,inflateGetHeader:rq,inflateSetDictionary:iq,inflateInfo:oq};function sq(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var aq=sq;const vN=Object.prototype.toString,{Z_NO_FLUSH:uq,Z_FINISH:lq,Z_OK:Nm,Z_STREAM_END:h2,Z_NEED_DICT:f2,Z_STREAM_ERROR:cq,Z_DATA_ERROR:VA,Z_MEM_ERROR:hq}=rN;function Zm(n){this.options=iN.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new CW,this.strm.avail_out=0;let t=$l.inflateInit2(this.strm,e.windowBits);if(t!==Nm)throw new Error(Tw[t]);if(this.header=new aq,$l.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=kw.string2buf(e.dictionary):vN.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=$l.inflateSetDictionary(this.strm,e.dictionary),t!==Nm)))throw new Error(Tw[t])}Zm.prototype.push=function(n,e){const t=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?lq:uq,vN.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),o=$l.inflate(t,s),o===f2&&i&&(o=$l.inflateSetDictionary(t,i),o===Nm?o=$l.inflate(t,s):o===VA&&(o=f2));t.avail_in>0&&o===h2&&t.state.wrap>0&&n[t.next_in]!==0;)$l.inflateReset(t),o=$l.inflate(t,s);switch(o){case cq:case VA:case f2:case hq:return this.onEnd(o),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||o===h2))if(this.options.to==="string"){let u=kw.utf8border(t.output,t.next_out),l=t.next_out-u,h=kw.buf2string(t.output,u);t.next_out=l,t.avail_out=r-l,l&&t.output.set(t.output.subarray(u,u+l),0),this.onData(h)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(o===Nm&&a===0)){if(o===h2)return o=$l.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Zm.prototype.onData=function(n){this.chunks.push(n)};Zm.prototype.onEnd=function(n){n===Nm&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=iN.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function fq(n,e){const t=new Zm(e);if(t.push(n),t.err)throw t.msg||Tw[t.err];return t.result}var dq=Zm,pq=fq,mq={Inflate:dq,inflate:pq};const{Inflate:gq,inflate:vq}=mq;var jA=gq,yq=vq;const yN=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;yN[n]=e}const UA=4294967295;function wq(n,e,t){let r=n;for(let i=0;i<t;i++)r=yN[(r^e[i])&255]^r>>>8;return r}function bq(n,e){return(wq(UA,n,e)^UA)>>>0}function zA(n,e,t){const r=n.readUint32(),i=bq(new Uint8Array(n.buffer,n.byteOffset+n.offset-e-4,e),e);if(i!==r)throw new Error(`CRC mismatch for chunk ${t}. Expected ${r}, found ${i}`)}function wN(n,e,t){for(let r=0;r<t;r++)e[r]=n[r]}function bN(n,e,t,r){let i=0;for(;i<r;i++)e[i]=n[i];for(;i<t;i++)e[i]=n[i]+e[i-r]&255}function xN(n,e,t,r){let i=0;if(t.length===0)for(;i<r;i++)e[i]=n[i];else for(;i<r;i++)e[i]=n[i]+t[i]&255}function _N(n,e,t,r,i){let o=0;if(t.length===0){for(;o<i;o++)e[o]=n[o];for(;o<r;o++)e[o]=n[o]+(e[o-i]>>1)&255}else{for(;o<i;o++)e[o]=n[o]+(t[o]>>1)&255;for(;o<r;o++)e[o]=n[o]+(e[o-i]+t[o]>>1)&255}}function EN(n,e,t,r,i){let o=0;if(t.length===0){for(;o<i;o++)e[o]=n[o];for(;o<r;o++)e[o]=n[o]+e[o-i]&255}else{for(;o<i;o++)e[o]=n[o]+t[o]&255;for(;o<r;o++)e[o]=n[o]+xq(e[o-i],t[o],t[o-i])&255}}function xq(n,e,t){const r=n+e-t,i=Math.abs(r-n),o=Math.abs(r-e),s=Math.abs(r-t);return i<=o&&i<=s?n:o<=s?e:t}function _q(n,e,t,r,i,o){switch(n){case 0:wN(e,t,i);break;case 1:bN(e,t,i,o);break;case 2:xN(e,t,r,i);break;case 3:_N(e,t,r,i,o);break;case 4:EN(e,t,r,i,o);break;default:throw new Error(`Unsupported filter: ${n}`)}}const Eq=new Uint16Array([255]),Sq=new Uint8Array(Eq.buffer),Aq=Sq[0]===255;function Cq(n){const{data:e,width:t,height:r,channels:i,depth:o}=n,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],a=Math.ceil(o/8)*i,u=new Uint8Array(r*t*a);let l=0;for(let h=0;h<7;h++){const d=s[h],m=Math.ceil((t-d.x)/d.xStep),p=Math.ceil((r-d.y)/d.yStep);if(m<=0||p<=0)continue;const y=m*a,b=new Uint8Array(y);for(let x=0;x<p;x++){const E=e[l++],T=e.subarray(l,l+y);l+=y;const P=new Uint8Array(y);_q(E,T,P,b,y,a),b.set(P);for(let I=0;I<m;I++){const D=d.x+I*d.xStep,U=d.y+x*d.yStep;if(!(D>=t||U>=r))for(let L=0;L<a;L++)u[(U*t+D)*a+L]=P[I*a+L]}}}if(o===16){const h=new Uint16Array(u.buffer);if(Aq)for(let d=0;d<h.length;d++)h[d]=Iq(h[d]);return h}else return u}function Iq(n){return(n&255)<<8|n>>8&255}const Tq=new Uint16Array([255]),kq=new Uint8Array(Tq.buffer),Nq=kq[0]===255,Rq=new Uint8Array(0);function WA(n){const{data:e,width:t,height:r,channels:i,depth:o}=n,s=Math.ceil(o/8)*i,a=Math.ceil(o/8*i*t),u=new Uint8Array(r*a);let l=Rq,h=0,d,m;for(let p=0;p<r;p++){switch(d=e.subarray(h+1,h+1+a),m=u.subarray(p*a,(p+1)*a),e[h]){case 0:wN(d,m,a);break;case 1:bN(d,m,a,s);break;case 2:xN(d,m,l,a);break;case 3:_N(d,m,l,a,s);break;case 4:EN(d,m,l,a,s);break;default:throw new Error(`Unsupported filter: ${e[h]}`)}l=m,h+=a+1}if(o===16){const p=new Uint16Array(u.buffer);if(Nq)for(let y=0;y<p.length;y++)p[y]=Pq(p[y]);return p}else return u}function Pq(n){return(n&255)<<8|n>>8&255}const Tv=Uint8Array.of(137,80,78,71,13,10,26,10);function qA(n){if(!Dq(n.readBytes(Tv.length)))throw new Error("wrong PNG signature")}function Dq(n){if(n.length<Tv.length)return!1;for(let e=0;e<Tv.length;e++)if(n[e]!==Tv[e])return!1;return!0}const Lq="tEXt",Mq=0,SN=new TextDecoder("latin1");function Oq(n){if(Bq(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const Fq=/^[\u0000-\u00FF]*$/;function Bq(n){if(!Fq.test(n))throw new Error("invalid latin1 text")}function Vq(n,e,t){const r=AN(e);n[r]=jq(e,t-r.length-1)}function AN(n){for(n.mark();n.readByte()!==Mq;);const e=n.offset;n.reset();const t=SN.decode(n.readBytes(e-n.offset-1));return n.skip(1),Oq(t),t}function jq(n,e){return SN.decode(n.readBytes(e))}const ca={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},d2={UNKNOWN:-1,DEFLATE:0},HA={UNKNOWN:-1,ADAPTIVE:0},p2={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},dv={NONE:0,BACKGROUND:1,PREVIOUS:2},m2={SOURCE:0,OVER:1};class Uq extends $x{constructor(t,r={}){super(t);hr(this,"_checkCrc");hr(this,"_inflator");hr(this,"_png");hr(this,"_apng");hr(this,"_end");hr(this,"_hasPalette");hr(this,"_palette");hr(this,"_hasTransparency");hr(this,"_transparency");hr(this,"_compressionMethod");hr(this,"_filterMethod");hr(this,"_interlaceMethod");hr(this,"_colorType");hr(this,"_isAnimated");hr(this,"_numberOfFrames");hr(this,"_numberOfPlays");hr(this,"_frames");hr(this,"_writingDataChunks");const{checkCrc:i=!1}=r;this._checkCrc=i,this._inflator=new jA,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=d2.UNKNOWN,this._filterMethod=HA.UNKNOWN,this._interlaceMethod=p2.UNKNOWN,this._colorType=ca.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(qA(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeChunk(t,r)}return this.decodeImage(),this._png}decodeApng(){for(qA(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(t,r)}return this.decodeApngImage(),this._apng}decodeChunk(t,r){const i=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case Lq:Vq(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-i!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?zA(this,t+4,r):this.skip(4)}decodeApngChunk(t,r){const i=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,r),this.offset=i+t;break}if(this.offset-i!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?zA(this,t+4,r):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=zq(this.readUint8());const r=this.readUint8();this._colorType=r;let i;switch(r){case ca.GREYSCALE:i=1;break;case ca.TRUECOLOUR:i=3;break;case ca.INDEXED_COLOUR:i=1;break;case ca.GREYSCALE_ALPHA:i=2;break;case ca.TRUECOLOUR_ALPHA:i=4;break;case ca.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==d2.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const r=t/3;this._hasPalette=!0;const i=[];this._palette=i;for(let o=0;o<r;o++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const r=t,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let r=t,i=this.offset+this.byteOffset;if(i+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case ca.GREYSCALE:case ca.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let r=0;r<t/2;r++)this._transparency[r]=this.readUint16();break}case ca.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let r=0;for(;r<t;r++){const i=this.readByte();this._palette[r].push(i)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case ca.UNKNOWN:case ca.GREYSCALE_ALPHA:case ca.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const r=AN(this),i=this.readUint8();if(i!==d2.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const o=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:yq(o)}}decodepHYs(){const t=this.readUint32(),r=this.readUint32(),i=this.readByte();this._png.resolution={x:t,y:r,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const r={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(t);if(i){if(i.data=WA({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)r.data=i.data;else{const o=this._apng.frames.at(t-1);this.disposeFrame(i,o,r),this.addFrameDataToCanvas(r,i)}this._apng.frames.push(r)}}return this._apng}disposeFrame(t,r,i){switch(t.disposeOp){case dv.NONE:break;case dv.BACKGROUND:for(let o=0;o<this._png.height;o++)for(let s=0;s<this._png.width;s++){const a=(o*t.width+s)*this._png.channels;for(let u=0;u<this._png.channels;u++)i.data[a+u]=0}break;case dv.PREVIOUS:i.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,r){const i=1<<this._png.depth,o=(s,a)=>{const u=((s+r.yOffset)*this._png.width+r.xOffset+a)*this._png.channels,l=(s*r.width+a)*this._png.channels;return{index:u,frameIndex:l}};switch(r.blendOp){case m2.SOURCE:for(let s=0;s<r.height;s++)for(let a=0;a<r.width;a++){const{index:u,frameIndex:l}=o(s,a);for(let h=0;h<this._png.channels;h++)t.data[u+h]=r.data[l+h]}break;case m2.OVER:for(let s=0;s<r.height;s++)for(let a=0;a<r.width;a++){const{index:u,frameIndex:l}=o(s,a);for(let h=0;h<this._png.channels;h++){const d=r.data[l+this._png.channels-1]/i,m=h%(this._png.channels-1)===0?1:r.data[l+h],p=Math.floor(d*m+(1-d)*t.data[u+h]);t.data[u+h]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==HA.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===p2.NO_INTERLACE)this._png.data=WA({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===p2.ADAM7)this._png.data=Cq({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,r=this._frames.at(-1);r?r.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:dv.NONE,blendOp:m2.SOURCE,data:t}),this._inflator=new jA,this._writingDataChunks=!1}}function zq(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var GA;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(GA||(GA={}));function Wq(n,e){return new Uq(n,e).decode()}var pn=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function g2(){pn.console&&typeof pn.console.log=="function"&&pn.console.log.apply(pn.console,arguments)}var _r={log:g2,warn:function(n){pn.console&&(typeof pn.console.warn=="function"?pn.console.warn.apply(pn.console,arguments):g2.call(null,arguments))},error:function(n){pn.console&&(typeof pn.console.error=="function"?pn.console.error.apply(pn.console,arguments):g2(n))}};function v2(n,e,t){var r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",r.onload=function(){Xh(r.response,e,t)},r.onerror=function(){_r.error("could not download file")},r.send()}function $A(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function pv(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Xh=pn.saveAs||((typeof window>"u"?"undefined":fr(window))!=="object"||window!==pn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var r=pn.URL||pn.webkitURL,i=document.createElement("a");e=e||n.name||"download",i.download=e,i.rel="noopener",typeof n=="string"?(i.href=n,i.origin!==location.origin?$A(i.href)?v2(n,e,t):pv(i,i.target="_blank"):pv(i)):(i.href=r.createObjectURL(n),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){pv(i)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if($A(n))v2(n,e,t);else{var r=document.createElement("a");r.href=n,r.target="_blank",setTimeout(function(){pv(r)})}else navigator.msSaveOrOpenBlob((function(i,o){return o===void 0?o={autoBom:!1}:fr(o)!=="object"&&(_r.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(n,t),e)}:function(n,e,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof n=="string")return v2(n,e,t);var i=n.type==="application/octet-stream",o=/constructor/i.test(pn.HTMLElement)||pn.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":fr(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var h=a.result;h=s?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=h:location=h,r=null},a.readAsDataURL(n)}else{var u=pn.URL||pn.webkitURL,l=u.createObjectURL(n);r?r.location=l:location.href=l,r=null,setTimeout(function(){u.revokeObjectURL(l)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function CN(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],r=0;r<t.length;r++){var i=t[r].re,o=t[r].process,s=i.exec(n);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),u=this.g.toString(16),l=this.b.toString(16);return a.length==1&&(a="0"+a),u.length==1&&(u="0"+u),l.length==1&&(l="0"+l),"#"+a+u+l}}var kv=pn.atob.bind(pn),KA=pn.btoa.bind(pn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function y2(n,e){var t=n[0],r=n[1],i=n[2],o=n[3];t=Xo(t,r,i,o,e[0],7,-680876936),o=Xo(o,t,r,i,e[1],12,-389564586),i=Xo(i,o,t,r,e[2],17,606105819),r=Xo(r,i,o,t,e[3],22,-1044525330),t=Xo(t,r,i,o,e[4],7,-176418897),o=Xo(o,t,r,i,e[5],12,1200080426),i=Xo(i,o,t,r,e[6],17,-1473231341),r=Xo(r,i,o,t,e[7],22,-45705983),t=Xo(t,r,i,o,e[8],7,1770035416),o=Xo(o,t,r,i,e[9],12,-1958414417),i=Xo(i,o,t,r,e[10],17,-42063),r=Xo(r,i,o,t,e[11],22,-1990404162),t=Xo(t,r,i,o,e[12],7,1804603682),o=Xo(o,t,r,i,e[13],12,-40341101),i=Xo(i,o,t,r,e[14],17,-1502002290),t=Yo(t,r=Xo(r,i,o,t,e[15],22,1236535329),i,o,e[1],5,-165796510),o=Yo(o,t,r,i,e[6],9,-1069501632),i=Yo(i,o,t,r,e[11],14,643717713),r=Yo(r,i,o,t,e[0],20,-373897302),t=Yo(t,r,i,o,e[5],5,-701558691),o=Yo(o,t,r,i,e[10],9,38016083),i=Yo(i,o,t,r,e[15],14,-660478335),r=Yo(r,i,o,t,e[4],20,-405537848),t=Yo(t,r,i,o,e[9],5,568446438),o=Yo(o,t,r,i,e[14],9,-1019803690),i=Yo(i,o,t,r,e[3],14,-187363961),r=Yo(r,i,o,t,e[8],20,1163531501),t=Yo(t,r,i,o,e[13],5,-1444681467),o=Yo(o,t,r,i,e[2],9,-51403784),i=Yo(i,o,t,r,e[7],14,1735328473),t=Qo(t,r=Yo(r,i,o,t,e[12],20,-1926607734),i,o,e[5],4,-378558),o=Qo(o,t,r,i,e[8],11,-2022574463),i=Qo(i,o,t,r,e[11],16,1839030562),r=Qo(r,i,o,t,e[14],23,-35309556),t=Qo(t,r,i,o,e[1],4,-1530992060),o=Qo(o,t,r,i,e[4],11,1272893353),i=Qo(i,o,t,r,e[7],16,-155497632),r=Qo(r,i,o,t,e[10],23,-1094730640),t=Qo(t,r,i,o,e[13],4,681279174),o=Qo(o,t,r,i,e[0],11,-358537222),i=Qo(i,o,t,r,e[3],16,-722521979),r=Qo(r,i,o,t,e[6],23,76029189),t=Qo(t,r,i,o,e[9],4,-640364487),o=Qo(o,t,r,i,e[12],11,-421815835),i=Qo(i,o,t,r,e[15],16,530742520),t=Jo(t,r=Qo(r,i,o,t,e[2],23,-995338651),i,o,e[0],6,-198630844),o=Jo(o,t,r,i,e[7],10,1126891415),i=Jo(i,o,t,r,e[14],15,-1416354905),r=Jo(r,i,o,t,e[5],21,-57434055),t=Jo(t,r,i,o,e[12],6,1700485571),o=Jo(o,t,r,i,e[3],10,-1894986606),i=Jo(i,o,t,r,e[10],15,-1051523),r=Jo(r,i,o,t,e[1],21,-2054922799),t=Jo(t,r,i,o,e[8],6,1873313359),o=Jo(o,t,r,i,e[15],10,-30611744),i=Jo(i,o,t,r,e[6],15,-1560198380),r=Jo(r,i,o,t,e[13],21,1309151649),t=Jo(t,r,i,o,e[4],6,-145523070),o=Jo(o,t,r,i,e[11],10,-1120210379),i=Jo(i,o,t,r,e[2],15,718787259),r=Jo(r,i,o,t,e[9],21,-343485551),n[0]=$c(t,n[0]),n[1]=$c(r,n[1]),n[2]=$c(i,n[2]),n[3]=$c(o,n[3])}function a1(n,e,t,r,i,o){return e=$c($c(e,n),$c(r,o)),$c(e<<i|e>>>32-i,t)}function Xo(n,e,t,r,i,o,s){return a1(e&t|~e&r,n,e,i,o,s)}function Yo(n,e,t,r,i,o,s){return a1(e&r|t&~r,n,e,i,o,s)}function Qo(n,e,t,r,i,o,s){return a1(e^t^r,n,e,i,o,s)}function Jo(n,e,t,r,i,o,s){return a1(t^(e|~r),n,e,i,o,s)}function IN(n){var e,t=n.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)y2(r,qq(n.substring(e-64,e)));n=n.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)i[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(y2(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*t,y2(r,i),r}function qq(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}var XA="0123456789abcdef".split("");function Hq(n){for(var e="",t=0;t<4;t++)e+=XA[n>>8*t+4&15]+XA[n>>8*t&15];return e}function Gq(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function Nw(n){return IN(n).map(Gq).join("")}var $q=(function(n){for(var e=0;e<n.length;e++)n[e]=Hq(n[e]);return n.join("")})(IN("hello"))!="5d41402abc4b2a76b9719d911017c592";function $c(n,e){if($q){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Rw(n,e){var t,r,i,o;if(n!==t){for(var s=(i=n,o=1+(256/n.length|0),new Array(o+1).join(i)),a=[],u=0;u<256;u++)a[u]=u;var l=0;for(u=0;u<256;u++){var h=a[u];l=(l+h+s.charCodeAt(u))%256,a[u]=a[l],a[l]=h}t=n,r=a}else a=r;var d=e.length,m=0,p=0,y="";for(u=0;u<d;u++)p=(p+(h=a[m=(m+1)%256]))%256,a[m]=a[p],a[p]=h,s=a[(a[m]+a[p])%256],y+=String.fromCharCode(e.charCodeAt(u)^s);return y}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var YA={print:4,modify:8,copy:16,"annot-forms":32};function ad(n,e,t,r){this.v=1,this.r=2;var i=192;n.forEach(function(a){if(YA.perm!==void 0)throw new Error("Invalid permission: "+a);i+=YA[a]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(e+this.padding).substr(0,32),s=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=Nw(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Rw(this.encryptionKey,this.padding)}function ud(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,r=0;r<t;r++){var i=n.charCodeAt(r);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):n[r]}return e}function QA(n){if(fr(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,r,i){if(i=i||!1,typeof t!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var o=Math.random().toString(35);return e[t][o]=[r,!!i],o},this.unsubscribe=function(t){for(var r in e)if(e[r][t])return delete e[r][t],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[t]){var s=e[t][o];try{s[0].apply(n,r)}catch(a){pn.console&&_r.error("jsPDF PubSub Error",a.message,a)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function x0(n){if(!(this instanceof x0))return new x0(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function TN(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function Jh(n,e,t,r,i){if(!(this instanceof Jh))return new Jh(n,e,t,r,i);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,TN.call(this,r,i)}function yd(n,e,t,r,i){if(!(this instanceof yd))return new yd(n,e,t,r,i);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,TN.call(this,r,i)}function Wt(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],o=arguments[3],s=[],a=1,u=16,l="S",h=null;fr(n=n||{})==="object"&&(t=n.orientation,r=n.unit||r,i=n.format||i,o=n.compress||n.compressPdf||o,(h=n.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),a=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(u=n.floatPrecision),l=n.defaultPathOperation||"S"),s=n.filters||(o===!0?["FlateEncode"]:s),r=r||"mm",t=(""+(t||"P")).toLowerCase();var d=n.putOnlyUsedFonts||!1,m={},p={internal:{},__private__:{}};p.__private__.PubSub=QA;var y="1.3",b=p.__private__.getPdfVersion=function(){return y};p.__private__.setPdfVersion=function(N){y=N};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return x};var E=p.__private__.getPageFormat=function(N){return x[N]};i=i||"a4";var T="compat",P="advanced",I=T;function D(){this.saveGraphicsState(),te(new Kt(en,0,0,-en,0,to()*en).toString()+" cm"),this.setFontSize(this.getFontSize()/en),l="n",I=P}function U(){this.restoreGraphicsState(),l="S",I=T}var L=p.__private__.combineFontStyleAndFontWeight=function(N,H){if(N=="bold"&&H=="normal"||N=="bold"&&H==400||N=="normal"&&H=="italic"||N=="bold"&&H=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return H&&(N=H==400||H==="normal"?N==="italic"?"italic":"normal":H!=700&&H!=="bold"||N!=="normal"?(H==700?"bold":H)+""+N:"bold"),N};p.advancedAPI=function(N){var H=I===T;return H&&D.call(this),typeof N!="function"||(N(this),H&&U.call(this)),this},p.compatAPI=function(N){var H=I===P;return H&&U.call(this),typeof N!="function"||(N(this),H&&D.call(this)),this},p.isAdvancedAPI=function(){return I===P};var C,A=function(N){if(I!==P)throw new Error(N+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},M=p.roundToPrecision=p.__private__.roundToPrecision=function(N,H){var pe=e||H;if(isNaN(N)||isNaN(pe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return N.toFixed(pe).replace(/0+$/,"")};C=p.hpf=p.__private__.hpf=typeof u=="number"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return M(N,u)}:u==="smart"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return M(N,N>-1&&N<1?16:5)}:function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return M(N,16)};var k=p.f2=p.__private__.f2=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f2");return M(N,2)},O=p.__private__.f3=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f3");return M(N,3)},j=p.scale=p.__private__.scale=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.scale");return I===T?N*en:I===P?N:void 0},X=function(N){return j((function(H){return I===T?to()-H:I===P?H:void 0})(N))};p.__private__.setPrecision=p.setPrecision=function(N){typeof parseInt(N,10)=="number"&&(e=parseInt(N,10))};var ue,ge="00000000000000000000000000000000",he=p.__private__.getFileId=function(){return ge},$=p.__private__.setFileId=function(N){return ge=N!==void 0&&/^[a-fA-F0-9]{32}$/.test(N)?N.toUpperCase():ge.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(br=new ad(h.userPermissions,h.userPassword,h.ownerPassword,ge)),ge};p.setFileId=function(N){return $(N),this},p.getFileId=function(){return he()};var le=p.__private__.convertDateToPDFDate=function(N){var H=N.getTimezoneOffset(),pe=H<0?"+":"-",be=Math.floor(Math.abs(H/60)),ke=Math.abs(H%60),Xe=[pe,ne(be),"'",ne(ke),"'"].join("");return["D:",N.getFullYear(),ne(N.getMonth()+1),ne(N.getDate()),ne(N.getHours()),ne(N.getMinutes()),ne(N.getSeconds()),Xe].join("")},ae=p.__private__.convertPDFDateToDate=function(N){var H=parseInt(N.substr(2,4),10),pe=parseInt(N.substr(6,2),10)-1,be=parseInt(N.substr(8,2),10),ke=parseInt(N.substr(10,2),10),Xe=parseInt(N.substr(12,2),10),et=parseInt(N.substr(14,2),10);return new Date(H,pe,be,ke,Xe,et,0)},J=p.__private__.setCreationDate=function(N){var H;if(N===void 0&&(N=new Date),N instanceof Date)H=le(N);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(N))throw new Error("Invalid argument passed to jsPDF.setCreationDate");H=N}return ue=H},W=p.__private__.getCreationDate=function(N){var H=ue;return N==="jsDate"&&(H=ae(ue)),H};p.setCreationDate=function(N){return J(N),this},p.getCreationDate=function(N){return W(N)};var Q,ne=p.__private__.padd2=function(N){return("0"+parseInt(N)).slice(-2)},fe=p.__private__.padd2Hex=function(N){return("00"+(N=N.toString())).substr(N.length)},ve=0,we=[],Se=[],Ce=0,Fe=[],qe=[],Ne=!1,Oe=Se;p.__private__.setCustomOutputDestination=function(N){Ne=!0,Oe=N};var Qe=function(N){Ne||(Oe=N)};p.__private__.resetCustomOutputDestination=function(){Ne=!1,Oe=Se};var te=p.__private__.out=function(N){return N=N.toString(),Ce+=N.length+1,Oe.push(N),Oe},rt=p.__private__.write=function(N){return te(arguments.length===1?N.toString():Array.prototype.join.call(arguments," "))},zt=p.__private__.getArrayBuffer=function(N){for(var H=N.length,pe=new ArrayBuffer(H),be=new Uint8Array(pe);H--;)be[H]=N.charCodeAt(H);return pe},gt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return gt};var He=n.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(N){return He=I===P?N/en:N,this};var ft,lt=p.__private__.getFontSize=p.getFontSize=function(){return I===T?He:He*en},Et=n.R2L||!1;p.__private__.setR2L=p.setR2L=function(N){return Et=N,this},p.__private__.getR2L=p.getR2L=function(){return Et};var pt,En=p.__private__.setZoomMode=function(N){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(N))ft=N;else if(isNaN(N)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(N)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+N+'" is not recognized.');ft=N}else ft=parseInt(N,10)};p.__private__.getZoomMode=function(){return ft};var $t,Qt=p.__private__.setPageMode=function(N){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(N)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+N+'" is not recognized.');pt=N};p.__private__.getPageMode=function(){return pt};var an=p.__private__.setLayoutMode=function(N){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(N)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+N+'" is not recognized.');$t=N};p.__private__.getLayoutMode=function(){return $t},p.__private__.setDisplayMode=p.setDisplayMode=function(N,H,pe){return En(N),an(H),Qt(pe),this};var qt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(N){if(Object.keys(qt).indexOf(N)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return qt[N]},p.__private__.getDocumentProperties=function(){return qt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(N){for(var H in qt)qt.hasOwnProperty(H)&&N[H]&&(qt[H]=N[H]);return this},p.__private__.setDocumentProperty=function(N,H){if(Object.keys(qt).indexOf(N)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return qt[N]=H};var vt,en,yt,dr,mn,rn={},un={},On=[],Ot={},Bn={},Ht={},Jt={},jn=null,Dt=0,Gt=[],Cn=new QA(p),Mo=n.hotfixes||[],ai={},As={},ui=[],Kt=function N(H,pe,be,ke,Xe,et){if(!(this instanceof N))return new N(H,pe,be,ke,Xe,et);isNaN(H)&&(H=1),isNaN(pe)&&(pe=0),isNaN(be)&&(be=0),isNaN(ke)&&(ke=1),isNaN(Xe)&&(Xe=0),isNaN(et)&&(et=0),this._matrix=[H,pe,be,ke,Xe,et]};Object.defineProperty(Kt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Kt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Kt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Kt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Kt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Kt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Kt.prototype,"a",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Kt.prototype,"b",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Kt.prototype,"c",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Kt.prototype,"d",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Kt.prototype,"e",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Kt.prototype,"f",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Kt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Kt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Kt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Kt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Kt.prototype.join=function(N){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(C).join(N)},Kt.prototype.multiply=function(N){var H=N.sx*this.sx+N.shy*this.shx,pe=N.sx*this.shy+N.shy*this.sy,be=N.shx*this.sx+N.sy*this.shx,ke=N.shx*this.shy+N.sy*this.sy,Xe=N.tx*this.sx+N.ty*this.shx+this.tx,et=N.tx*this.shy+N.ty*this.sy+this.ty;return new Kt(H,pe,be,ke,Xe,et)},Kt.prototype.decompose=function(){var N=this.sx,H=this.shy,pe=this.shx,be=this.sy,ke=this.tx,Xe=this.ty,et=Math.sqrt(N*N+H*H),wt=(N/=et)*pe+(H/=et)*be;pe-=N*wt,be-=H*wt;var It=Math.sqrt(pe*pe+be*be);return wt/=It,N*(be/=It)<H*(pe/=It)&&(N=-N,H=-H,wt=-wt,et=-et),{scale:new Kt(et,0,0,It,0,0),translate:new Kt(1,0,0,1,ke,Xe),rotate:new Kt(N,H,-H,N,0,0),skew:new Kt(1,0,wt,1,0,0)}},Kt.prototype.toString=function(N){return this.join(" ")},Kt.prototype.inversed=function(){var N=this.sx,H=this.shy,pe=this.shx,be=this.sy,ke=this.tx,Xe=this.ty,et=1/(N*be-H*pe),wt=be*et,It=-H*et,Zt=-pe*et,Ft=N*et;return new Kt(wt,It,Zt,Ft,-wt*ke-Zt*Xe,-It*ke-Ft*Xe)},Kt.prototype.applyToPoint=function(N){var H=N.x*this.sx+N.y*this.shx+this.tx,pe=N.x*this.shy+N.y*this.sy+this.ty;return new Ai(H,pe)},Kt.prototype.applyToRectangle=function(N){var H=this.applyToPoint(N),pe=this.applyToPoint(new Ai(N.x+N.w,N.y+N.h));return new Ia(H.x,H.y,pe.x-H.x,pe.y-H.y)},Kt.prototype.clone=function(){var N=this.sx,H=this.shy,pe=this.shx,be=this.sy,ke=this.tx,Xe=this.ty;return new Kt(N,H,pe,be,ke,Xe)},p.Matrix=Kt;var go=p.matrixMult=function(N,H){return H.multiply(N)},Yi=new Kt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Yi;var li=function(N,H){if(!Bn[N]){var pe=(H instanceof Jh?"Sh":"P")+(Object.keys(Ot).length+1).toString(10);H.id=pe,Bn[N]=pe,Ot[pe]=H,Cn.publish("addPattern",H)}};p.ShadingPattern=Jh,p.TilingPattern=yd,p.addShadingPattern=function(N,H){return A("addShadingPattern()"),li(N,H),this},p.beginTilingPattern=function(N){A("beginTilingPattern()"),Bi(N.boundingBox[0],N.boundingBox[1],N.boundingBox[2]-N.boundingBox[0],N.boundingBox[3]-N.boundingBox[1],N.matrix)},p.endTilingPattern=function(N,H){A("endTilingPattern()"),H.stream=qe[Q].join(`
`),li(N,H),Cn.publish("endTilingPattern",H),ui.pop().restore()};var vo,Xn=p.__private__.newObject=function(){var N=or();return Rr(N,!0),N},or=p.__private__.newObjectDeferred=function(){return ve++,we[ve]=function(){return Ce},ve},Rr=function(N,H){return H=typeof H=="boolean"&&H,we[N]=Ce,H&&te(N+" 0 obj"),N},Ei=p.__private__.newAdditionalObject=function(){var N={objId:or(),content:""};return Fe.push(N),N},Ks=or(),Oo=or(),Fo=p.__private__.decodeColorString=function(N){var H=N.split(" ");if(H.length!==2||H[1]!=="g"&&H[1]!=="G")H.length!==5||H[4]!=="k"&&H[4]!=="K"||(H=[(1-H[0])*(1-H[3]),(1-H[1])*(1-H[3]),(1-H[2])*(1-H[3]),"r"]);else{var pe=parseFloat(H[0]);H=[pe,pe,pe,"r"]}for(var be="#",ke=0;ke<3;ke++)be+=("0"+Math.floor(255*parseFloat(H[ke])).toString(16)).slice(-2);return be},Vr=p.__private__.encodeColorString=function(N){var H;typeof N=="string"&&(N={ch1:N});var pe=N.ch1,be=N.ch2,ke=N.ch3,Xe=N.ch4,et=N.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof pe=="string"&&pe.charAt(0)!=="#"){var wt=new CN(pe);if(wt.ok)pe=wt.toHex();else if(!/^\d*\.?\d*$/.test(pe))throw new Error('Invalid color "'+pe+'" passed to jsPDF.encodeColorString.')}if(typeof pe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(pe)&&(pe="#"+pe[1]+pe[1]+pe[2]+pe[2]+pe[3]+pe[3]),typeof pe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(pe)){var It=parseInt(pe.substr(1),16);pe=It>>16&255,be=It>>8&255,ke=255&It}if(be===void 0||Xe===void 0&&pe===be&&be===ke)H=typeof pe=="string"?pe+" "+et[0]:N.precision===2?k(pe/255)+" "+et[0]:O(pe/255)+" "+et[0];else if(Xe===void 0||fr(Xe)==="object"){if(Xe&&!isNaN(Xe.a)&&Xe.a===0)return["1.","1.","1.",et[1]].join(" ");H=typeof pe=="string"?[pe,be,ke,et[1]].join(" "):N.precision===2?[k(pe/255),k(be/255),k(ke/255),et[1]].join(" "):[O(pe/255),O(be/255),O(ke/255),et[1]].join(" ")}else H=typeof pe=="string"?[pe,be,ke,Xe,et[2]].join(" "):N.precision===2?[k(pe),k(be),k(ke),k(Xe),et[2]].join(" "):[O(pe),O(be),O(ke),O(Xe),et[2]].join(" ");return H},yo=p.__private__.getFilters=function(){return s},wo=p.__private__.putStream=function(N){var H=(N=N||{}).data||"",pe=N.filters||yo(),be=N.alreadyAppliedFilters||[],ke=N.addLength1||!1,Xe=H.length,et=N.objectId,wt=function(B){return B};if(h!==null&&et===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(wt=br.encryptor(et,0));var It={};pe===!0&&(pe=["FlateEncode"]);var Zt=N.additionalKeyValues||[],Ft=(It=Wt.API.processDataByFilters!==void 0?Wt.API.processDataByFilters(H,pe):{data:H,reverseChain:[]}).reverseChain+(Array.isArray(be)?be.join(" "):be.toString());if(It.data.length!==0&&(Zt.push({key:"Length",value:It.data.length}),ke===!0&&Zt.push({key:"Length1",value:Xe})),Ft.length!=0)if(Ft.split("/").length-1==1)Zt.push({key:"Filter",value:Ft});else{Zt.push({key:"Filter",value:"["+Ft+"]"});for(var kn=0;kn<Zt.length;kn+=1)if(Zt[kn].key==="DecodeParms"){for(var mr=[],sr=0;sr<It.reverseChain.split("/").length-1;sr+=1)mr.push("null");mr.push(Zt[kn].value),Zt[kn].value="["+mr.join(" ")+"]"}}te("<<");for(var w=0;w<Zt.length;w++)te("/"+Zt[w].key+" "+Zt[w].value);te(">>"),It.data.length!==0&&(te("stream"),te(wt(It.data)),te("endstream"))},xa=p.__private__.putPage=function(N){var H=N.number,pe=N.data,be=N.objId,ke=N.contentsObjId;Rr(be,!0),te("<</Type /Page"),te("/Parent "+N.rootDictionaryObjId+" 0 R"),te("/Resources "+N.resourceDictionaryObjId+" 0 R"),te("/MediaBox ["+parseFloat(C(N.mediaBox.bottomLeftX))+" "+parseFloat(C(N.mediaBox.bottomLeftY))+" "+C(N.mediaBox.topRightX)+" "+C(N.mediaBox.topRightY)+"]"),N.cropBox!==null&&te("/CropBox ["+C(N.cropBox.bottomLeftX)+" "+C(N.cropBox.bottomLeftY)+" "+C(N.cropBox.topRightX)+" "+C(N.cropBox.topRightY)+"]"),N.bleedBox!==null&&te("/BleedBox ["+C(N.bleedBox.bottomLeftX)+" "+C(N.bleedBox.bottomLeftY)+" "+C(N.bleedBox.topRightX)+" "+C(N.bleedBox.topRightY)+"]"),N.trimBox!==null&&te("/TrimBox ["+C(N.trimBox.bottomLeftX)+" "+C(N.trimBox.bottomLeftY)+" "+C(N.trimBox.topRightX)+" "+C(N.trimBox.topRightY)+"]"),N.artBox!==null&&te("/ArtBox ["+C(N.artBox.bottomLeftX)+" "+C(N.artBox.bottomLeftY)+" "+C(N.artBox.topRightX)+" "+C(N.artBox.topRightY)+"]"),typeof N.userUnit=="number"&&N.userUnit!==1&&te("/UserUnit "+N.userUnit),Cn.publish("putPage",{objId:be,pageContext:Gt[H],pageNumber:H,page:pe}),te("/Contents "+ke+" 0 R"),te(">>"),te("endobj");var Xe=pe.join(`
`);return I===P&&(Xe+=`
Q`),Rr(ke,!0),wo({data:Xe,filters:yo(),objectId:ke}),te("endobj"),be},cs=p.__private__.putPages=function(){var N,H,pe=[];for(N=1;N<=Dt;N++)Gt[N].objId=or(),Gt[N].contentsObjId=or();for(N=1;N<=Dt;N++)pe.push(xa({number:N,data:qe[N],objId:Gt[N].objId,contentsObjId:Gt[N].contentsObjId,mediaBox:Gt[N].mediaBox,cropBox:Gt[N].cropBox,bleedBox:Gt[N].bleedBox,trimBox:Gt[N].trimBox,artBox:Gt[N].artBox,userUnit:Gt[N].userUnit,rootDictionaryObjId:Ks,resourceDictionaryObjId:Oo}));Rr(Ks,!0),te("<</Type /Pages");var be="/Kids [";for(H=0;H<Dt;H++)be+=pe[H]+" 0 R ";te(be+"]"),te("/Count "+Dt),te(">>"),te("endobj"),Cn.publish("postPutPages")},hs=function(N){Cn.publish("putFont",{font:N,out:te,newObject:Xn,putStream:wo}),N.isAlreadyPutted!==!0&&(N.objectNumber=Xn(),te("<<"),te("/Type /Font"),te("/BaseFont /"+ud(N.postScriptName)),te("/Subtype /Type1"),typeof N.encoding=="string"&&te("/Encoding /"+N.encoding),te("/FirstChar 32"),te("/LastChar 255"),te(">>"),te("endobj"))},_a=function(N){N.objectNumber=Xn();var H=[];H.push({key:"Type",value:"/XObject"}),H.push({key:"Subtype",value:"/Form"}),H.push({key:"BBox",value:"["+[C(N.x),C(N.y),C(N.x+N.width),C(N.y+N.height)].join(" ")+"]"}),H.push({key:"Matrix",value:"["+N.matrix.toString()+"]"});var pe=N.pages[1].join(`
`);wo({data:pe,additionalKeyValues:H,objectId:N.objectNumber}),te("endobj")},Xs=function(N,H){H||(H=21);var pe=Xn(),be=(function(et,wt){var It,Zt=[],Ft=1/(wt-1);for(It=0;It<1;It+=Ft)Zt.push(It);if(Zt.push(1),et[0].offset!=0){var kn={offset:0,color:et[0].color};et.unshift(kn)}if(et[et.length-1].offset!=1){var mr={offset:1,color:et[et.length-1].color};et.push(mr)}for(var sr="",w=0,B=0;B<Zt.length;B++){for(It=Zt[B];It>et[w+1].offset;)w++;var q=et[w].offset,re=(It-q)/(et[w+1].offset-q),Re=et[w].color,Ve=et[w+1].color;sr+=fe(Math.round((1-re)*Re[0]+re*Ve[0]).toString(16))+fe(Math.round((1-re)*Re[1]+re*Ve[1]).toString(16))+fe(Math.round((1-re)*Re[2]+re*Ve[2]).toString(16))}return sr.trim()})(N.colors,H),ke=[];ke.push({key:"FunctionType",value:"0"}),ke.push({key:"Domain",value:"[0.0 1.0]"}),ke.push({key:"Size",value:"["+H+"]"}),ke.push({key:"BitsPerSample",value:"8"}),ke.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ke.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),wo({data:be,additionalKeyValues:ke,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:pe}),te("endobj"),N.objectNumber=Xn(),te("<< /ShadingType "+N.type),te("/ColorSpace /DeviceRGB");var Xe="/Coords ["+C(parseFloat(N.coords[0]))+" "+C(parseFloat(N.coords[1]))+" ";N.type===2?Xe+=C(parseFloat(N.coords[2]))+" "+C(parseFloat(N.coords[3])):Xe+=C(parseFloat(N.coords[2]))+" "+C(parseFloat(N.coords[3]))+" "+C(parseFloat(N.coords[4]))+" "+C(parseFloat(N.coords[5])),te(Xe+="]"),N.matrix&&te("/Matrix ["+N.matrix.toString()+"]"),te("/Function "+pe+" 0 R"),te("/Extend [true true]"),te(">>"),te("endobj")},Cs=function(N,H){var pe=or(),be=Xn();H.push({resourcesOid:pe,objectOid:be}),N.objectNumber=be;var ke=[];ke.push({key:"Type",value:"/Pattern"}),ke.push({key:"PatternType",value:"1"}),ke.push({key:"PaintType",value:"1"}),ke.push({key:"TilingType",value:"1"}),ke.push({key:"BBox",value:"["+N.boundingBox.map(C).join(" ")+"]"}),ke.push({key:"XStep",value:C(N.xStep)}),ke.push({key:"YStep",value:C(N.yStep)}),ke.push({key:"Resources",value:pe+" 0 R"}),N.matrix&&ke.push({key:"Matrix",value:"["+N.matrix.toString()+"]"}),wo({data:N.stream,additionalKeyValues:ke,objectId:N.objectNumber}),te("endobj")},Ys=function(N){for(var H in N.objectNumber=Xn(),te("<<"),N)switch(H){case"opacity":te("/ca "+k(N[H]));break;case"stroke-opacity":te("/CA "+k(N[H]))}te(">>"),te("endobj")},Qn=function(N){Rr(N.resourcesOid,!0),te("<<"),te("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var H in te("/Font <<"),rn)rn.hasOwnProperty(H)&&(d===!1||d===!0&&m.hasOwnProperty(H))&&te("/"+H+" "+rn[H].objectNumber+" 0 R");te(">>")})(),(function(){if(Object.keys(Ot).length>0){for(var H in te("/Shading <<"),Ot)Ot.hasOwnProperty(H)&&Ot[H]instanceof Jh&&Ot[H].objectNumber>=0&&te("/"+H+" "+Ot[H].objectNumber+" 0 R");Cn.publish("putShadingPatternDict"),te(">>")}})(),(function(H){if(Object.keys(Ot).length>0){for(var pe in te("/Pattern <<"),Ot)Ot.hasOwnProperty(pe)&&Ot[pe]instanceof p.TilingPattern&&Ot[pe].objectNumber>=0&&Ot[pe].objectNumber<H&&te("/"+pe+" "+Ot[pe].objectNumber+" 0 R");Cn.publish("putTilingPatternDict"),te(">>")}})(N.objectOid),(function(){if(Object.keys(Ht).length>0){var H;for(H in te("/ExtGState <<"),Ht)Ht.hasOwnProperty(H)&&Ht[H].objectNumber>=0&&te("/"+H+" "+Ht[H].objectNumber+" 0 R");Cn.publish("putGStateDict"),te(">>")}})(),(function(){for(var H in te("/XObject <<"),ai)ai.hasOwnProperty(H)&&ai[H].objectNumber>=0&&te("/"+H+" "+ai[H].objectNumber+" 0 R");Cn.publish("putXobjectDict"),te(">>")})(),te(">>"),te("endobj")},cc=function(N){un[N.fontName]=un[N.fontName]||{},un[N.fontName][N.fontStyle]=N.id},Ka=function(N,H,pe,be,ke){var Xe={id:"F"+(Object.keys(rn).length+1).toString(10),postScriptName:N,fontName:H,fontStyle:pe,encoding:be,isStandardFont:ke||!1,metadata:{}};return Cn.publish("addFont",{font:Xe,instance:this}),rn[Xe.id]=Xe,cc(Xe),Xe.id},Qi=p.__private__.pdfEscape=p.pdfEscape=function(N,H){return(function(pe,be){var ke,Xe,et,wt,It,Zt,Ft,kn,mr;if(et=(be=be||{}).sourceEncoding||"Unicode",It=be.outputEncoding,(be.autoencode||It)&&rn[vt].metadata&&rn[vt].metadata[et]&&rn[vt].metadata[et].encoding&&(wt=rn[vt].metadata[et].encoding,!It&&rn[vt].encoding&&(It=rn[vt].encoding),!It&&wt.codePages&&(It=wt.codePages[0]),typeof It=="string"&&(It=wt[It]),It)){for(Ft=!1,Zt=[],ke=0,Xe=pe.length;ke<Xe;ke++)(kn=It[pe.charCodeAt(ke)])?Zt.push(String.fromCharCode(kn)):Zt.push(pe[ke]),Zt[ke].charCodeAt(0)>>8&&(Ft=!0);pe=Zt.join("")}for(ke=pe.length;Ft===void 0&&ke!==0;)pe.charCodeAt(ke-1)>>8&&(Ft=!0),ke--;if(!Ft)return pe;for(Zt=be.noBOM?[]:[254,255],ke=0,Xe=pe.length;ke<Xe;ke++){if((mr=(kn=pe.charCodeAt(ke))>>8)>>8)throw new Error("Character at position "+ke+" of string '"+pe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Zt.push(mr),Zt.push(kn-(mr<<8))}return String.fromCharCode.apply(void 0,Zt)})(N,H).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Qs=p.__private__.beginPage=function(N){qe[++Dt]=[],Gt[Dt]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(N[0]),topRightY:Number(N[1])}},Sa(Dt),Qe(qe[Q])},Nu=function(N,H){var pe,be,ke;switch(t=H||t,typeof N=="string"&&(pe=E(N.toLowerCase()),Array.isArray(pe)&&(be=pe[0],ke=pe[1])),Array.isArray(N)&&(be=N[0]*en,ke=N[1]*en),isNaN(be)&&(be=i[0],ke=i[1]),(be>14400||ke>14400)&&(_r.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),be=Math.min(14400,be),ke=Math.min(14400,ke)),i=[be,ke],t.substr(0,1)){case"l":ke>be&&(i=[ke,be]);break;case"p":be>ke&&(i=[ke,be])}Qs(i),Xt(jr),te(Ja),jo!==0&&te(jo+" J"),Mu!==0&&te(Mu+" j"),Cn.publish("addPage",{pageNumber:Dt})},Ea=function(N){N>0&&N<=Dt&&(qe.splice(N,1),Gt.splice(N,1),Dt--,Q>Dt&&(Q=Dt),this.setPage(Q))},Sa=function(N){N>0&&N<=Dt&&(Q=N)},Ji=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return qe.length-1},xl=function(N,H,pe){var be,ke=void 0;return pe=pe||{},N=N!==void 0?N:rn[vt].fontName,H=H!==void 0?H:rn[vt].fontStyle,be=N.toLowerCase(),un[be]!==void 0&&un[be][H]!==void 0?ke=un[be][H]:un[N]!==void 0&&un[N][H]!==void 0?ke=un[N][H]:pe.disableWarning===!1&&_r.warn("Unable to look up font label for font '"+N+"', '"+H+"'. Refer to getFontList() for available fonts."),ke||pe.noFallback||(ke=un.times[H])==null&&(ke=un.times.normal),ke},Pr=p.__private__.putInfo=function(){var N=Xn(),H=function(be){return be};for(var pe in h!==null&&(H=br.encryptor(N,0)),te("<<"),te("/Producer ("+Qi(H("jsPDF "+Wt.version))+")"),qt)qt.hasOwnProperty(pe)&&qt[pe]&&te("/"+pe.substr(0,1).toUpperCase()+pe.substr(1)+" ("+Qi(H(qt[pe]))+")");te("/CreationDate ("+Qi(H(ue))+")"),te(">>"),te("endobj")},bo=p.__private__.putCatalog=function(N){var H=(N=N||{}).rootDictionaryObjId||Ks;switch(Xn(),te("<<"),te("/Type /Catalog"),te("/Pages "+H+" 0 R"),ft||(ft="fullwidth"),ft){case"fullwidth":te("/OpenAction [3 0 R /FitH null]");break;case"fullheight":te("/OpenAction [3 0 R /FitV null]");break;case"fullpage":te("/OpenAction [3 0 R /Fit]");break;case"original":te("/OpenAction [3 0 R /XYZ null null 1]");break;default:var pe=""+ft;pe.substr(pe.length-1)==="%"&&(ft=parseInt(ft)/100),typeof ft=="number"&&te("/OpenAction [3 0 R /XYZ null null "+k(ft)+"]")}switch($t||($t="continuous"),$t){case"continuous":te("/PageLayout /OneColumn");break;case"single":te("/PageLayout /SinglePage");break;case"two":case"twoleft":te("/PageLayout /TwoColumnLeft");break;case"tworight":te("/PageLayout /TwoColumnRight")}pt&&te("/PageMode /"+pt),Cn.publish("putCatalog"),te(">>"),te("endobj")},Bo=p.__private__.putTrailer=function(){te("trailer"),te("<<"),te("/Size "+(ve+1)),te("/Root "+ve+" 0 R"),te("/Info "+(ve-1)+" 0 R"),h!==null&&te("/Encrypt "+br.oid+" 0 R"),te("/ID [ <"+ge+"> <"+ge+"> ]"),te(">>")},pr=p.__private__.putHeader=function(){te("%PDF-"+y),te("%")},fs=p.__private__.putXRef=function(){var N="0000000000";te("xref"),te("0 "+(ve+1)),te("0000000000 65535 f ");for(var H=1;H<=ve;H++)typeof we[H]=="function"?te((N+we[H]()).slice(-10)+" 00000 n "):we[H]!==void 0?te((N+we[H]).slice(-10)+" 00000 n "):te("0000000000 00000 n ")},Oi=p.__private__.buildDocument=function(){var N;ve=0,Ce=0,Se=[],we=[],Fe=[],Ks=or(),Oo=or(),Qe(Se),Cn.publish("buildDocument"),pr(),cs(),(function(){Cn.publish("putAdditionalObjects");for(var pe=0;pe<Fe.length;pe++){var be=Fe[pe];Rr(be.objId,!0),te(be.content),te("endobj")}Cn.publish("postPutAdditionalObjects")})(),N=[],(function(){for(var pe in rn)rn.hasOwnProperty(pe)&&(d===!1||d===!0&&m.hasOwnProperty(pe))&&hs(rn[pe])})(),(function(){var pe;for(pe in Ht)Ht.hasOwnProperty(pe)&&Ys(Ht[pe])})(),(function(){for(var pe in ai)ai.hasOwnProperty(pe)&&_a(ai[pe])})(),(function(pe){var be;for(be in Ot)Ot.hasOwnProperty(be)&&(Ot[be]instanceof Jh?Xs(Ot[be]):Ot[be]instanceof yd&&Cs(Ot[be],pe))})(N),Cn.publish("putResources"),N.forEach(Qn),Qn({resourcesOid:Oo,objectOid:Number.MAX_SAFE_INTEGER}),Cn.publish("postPutResources"),h!==null&&(br.oid=Xn(),te("<<"),te("/Filter /Standard"),te("/V "+br.v),te("/R "+br.r),te("/U <"+br.toHexString(br.U)+">"),te("/O <"+br.toHexString(br.O)+">"),te("/P "+br.P),te(">>"),te("endobj")),Pr(),bo();var H=Ce;return fs(),Bo(),te("startxref"),te(""+H),te("%%EOF"),Qe(qe[Q]),Se.join(`
`)},Tn=p.__private__.getBlob=function(N){return new Blob([zt(N)],{type:"application/pdf"})},Is=p.output=p.__private__.output=(vo=function(N,H){switch(typeof(H=H||{})=="string"?H={filename:H}:H.filename=H.filename||"generated.pdf",N){case void 0:return Oi();case"save":p.save(H.filename);break;case"arraybuffer":return zt(Oi());case"blob":return Tn(Oi());case"bloburi":case"bloburl":if(pn.URL!==void 0&&typeof pn.URL.createObjectURL=="function")return pn.URL&&pn.URL.createObjectURL(Tn(Oi()))||void 0;_r.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var pe="",be=Oi();try{pe=KA(be)}catch{pe=KA(unescape(encodeURIComponent(be)))}return"data:application/pdf;filename="+H.filename+";base64,"+pe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(pn)==="[object Window]"){var ke="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Xe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';H.pdfObjectUrl&&(ke=H.pdfObjectUrl,Xe="");var et='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ke+'"'+Xe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(H)+");<\/script></body></html>",wt=pn.open();return wt!==null&&wt.document.write(et),wt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(pn)==="[object Window]"){var It='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(H.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+H.filename+'" width="500px" height="400px" /></body></html>',Zt=pn.open();if(Zt!==null){Zt.document.write(It);var Ft=this;Zt.document.documentElement.querySelector("#pdfViewer").onload=function(){Zt.document.title=H.filename,Zt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ft.output("bloburl"))}}return Zt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(pn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var kn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",H)+'"></iframe></body></html>',mr=pn.open();if(mr!==null&&(mr.document.write(kn),mr.document.title=H.filename),mr||typeof safari>"u")return mr;break;case"datauri":case"dataurl":return pn.document.location.href=this.output("datauristring",H);default:return null}},vo.foo=function(){try{return vo.apply(this,arguments)}catch(pe){var N=pe.stack||"";~N.indexOf(" at ")&&(N=N.split(" at ")[1]);var H="Error in function "+N.split(`
`)[0].split("<")[0]+": "+pe.message;if(!pn.console)throw new Error(H);pn.console.error(H,pe),pn.alert&&alert(H)}},vo.foo.bar=vo,vo.foo),Si=function(N){return Array.isArray(Mo)===!0&&Mo.indexOf(N)>-1};switch(r){case"pt":en=1;break;case"mm":en=72/25.4;break;case"cm":en=72/2.54;break;case"in":en=72;break;case"px":en=Si("px_scaling")==1?.75:96/72;break;case"pc":case"em":en=12;break;case"ex":en=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);en=r}var br=null;J(),$();var ds=p.__private__.getPageInfo=p.getPageInfo=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Gt[N].objId,pageNumber:N,pageContext:Gt[N]}},Ru=p.__private__.getPageInfoByObjId=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var H in Gt)if(Gt[H].objId===N)break;return ds(H)},_l=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Gt[Q].objId,pageNumber:Q,pageContext:Gt[Q]}};p.addPage=function(){return Nu.apply(this,arguments),this},p.setPage=function(){return Sa.apply(this,arguments),Qe.call(this,qe[Q]),this},p.insertPage=function(N){return this.addPage(),this.movePage(Q,N),this},p.movePage=function(N,H){var pe,be;if(N>H){pe=qe[N],be=Gt[N];for(var ke=N;ke>H;ke--)qe[ke]=qe[ke-1],Gt[ke]=Gt[ke-1];qe[H]=pe,Gt[H]=be,this.setPage(H)}else if(N<H){pe=qe[N],be=Gt[N];for(var Xe=N;Xe<H;Xe++)qe[Xe]=qe[Xe+1],Gt[Xe]=Gt[Xe+1];qe[H]=pe,Gt[H]=be,this.setPage(H)}return this},p.deletePage=function(){return Ea.apply(this,arguments),this},p.__private__.text=p.text=function(N,H,pe,be,ke){var Xe,et,wt,It,Zt,Ft,kn,mr,sr,w=(be=be||{}).scope||this;if(typeof N=="number"&&typeof H=="number"&&(typeof pe=="string"||Array.isArray(pe))){var B=pe;pe=H,H=N,N=B}if(arguments[3]instanceof Kt==0?(wt=arguments[4],It=arguments[5],fr(kn=arguments[3])==="object"&&kn!==null||(typeof wt=="string"&&(It=wt,wt=null),typeof kn=="string"&&(It=kn,kn=null),typeof kn=="number"&&(wt=kn,kn=null),be={flags:kn,angle:wt,align:It})):(A("The transform parameter of text() with a Matrix value"),sr=ke),isNaN(H)||isNaN(pe)||N==null)throw new Error("Invalid arguments passed to jsPDF.text");if(N.length===0)return w;var q,re="",Re=typeof be.lineHeightFactor=="number"?be.lineHeightFactor:eo,Ve=w.internal.scaleFactor;function at(qn){return qn=qn.split("	").join(Array(be.TabLen||9).join(" ")),Qi(qn,kn)}function on(qn){for(var tr,Lr=qn.concat(),Zr=[],ra=Lr.length;ra--;)typeof(tr=Lr.shift())=="string"?Zr.push(tr):Array.isArray(qn)&&(tr.length===1||tr[1]===void 0&&tr[2]===void 0)?Zr.push(tr[0]):Zr.push([tr[0],tr[1],tr[2]]);return Zr}function gr(qn,tr){var Lr;if(typeof qn=="string")Lr=tr(qn)[0];else if(Array.isArray(qn)){for(var Zr,ra,Sh=qn.concat(),gc=[],iu=Sh.length;iu--;)typeof(Zr=Sh.shift())=="string"?gc.push(tr(Zr)[0]):Array.isArray(Zr)&&typeof Zr[0]=="string"&&(ra=tr(Zr[0],Zr[1],Zr[2]),gc.push([ra[0],ra[1],ra[2]]));Lr=gc}return Lr}var Nn=!1,vr=!0;if(typeof N=="string")Nn=!0;else if(Array.isArray(N)){var fi=N.concat();et=[];for(var no,yr=fi.length;yr--;)(typeof(no=fi.shift())!="string"||Array.isArray(no)&&typeof no[0]!="string")&&(vr=!1);Nn=vr}if(Nn===!1)throw new Error('Type of text must be string or Array. "'+N+'" is not recognized.');typeof N=="string"&&(N=N.match(/[\r?\n]/)?N.split(/\r\n|\r|\n/g):[N]);var ro=He/w.internal.scaleFactor,Ps=ro*(Re-1);switch(be.baseline){case"bottom":pe-=Ps;break;case"top":pe+=ro-Ps;break;case"hanging":pe+=ro-2*Ps;break;case"middle":pe+=ro/2-Ps}if((Ft=be.maxWidth||0)>0&&(typeof N=="string"?N=w.splitTextToSize(N,Ft):Object.prototype.toString.call(N)==="[object Array]"&&(N=N.reduce(function(qn,tr){return qn.concat(w.splitTextToSize(tr,Ft))},[]))),Xe={text:N,x:H,y:pe,options:be,mutex:{pdfEscape:Qi,activeFontKey:vt,fonts:rn,activeFontSize:He}},Cn.publish("preProcessText",Xe),N=Xe.text,wt=(be=Xe.options).angle,sr instanceof Kt==0&&wt&&typeof wt=="number"){wt*=Math.PI/180,be.rotationDirection===0&&(wt=-wt),I===P&&(wt=-wt);var Za=Math.cos(wt),Eh=Math.sin(wt);sr=new Kt(Za,Eh,-Eh,Za,0,0)}else wt&&wt instanceof Kt&&(sr=wt);I!==P||sr||(sr=Yi),(Zt=be.charSpace||Fi)!==void 0&&(re+=C(j(Zt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(mr=be.horizontalScale)!==void 0&&(re+=C(100*mr)+` Tz
`),be.lang;var Eo=-1,ta=be.renderingMode!==void 0?be.renderingMode:be.stroke,Na=w.internal.getCurrentPageInfo().pageContext;switch(ta){case 0:case!1:case"fill":Eo=0;break;case 1:case!0:case"stroke":Eo=1;break;case 2:case"fillThenStroke":Eo=2;break;case 3:case"invisible":Eo=3;break;case 4:case"fillAndAddForClipping":Eo=4;break;case 5:case"strokeAndAddPathForClipping":Eo=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Eo=6;break;case 7:case"addToPathForClipping":Eo=7}var Tf=Na.usedRenderingMode!==void 0?Na.usedRenderingMode:-1;Eo!==-1?re+=Eo+` Tr
`:Tf!==-1&&(re+=`0 Tr
`),Eo!==-1&&(Na.usedRenderingMode=Eo),It=be.align||"left";var vs,Fu=He*Re,fc=w.internal.pageSize.getWidth(),dc=rn[vt];Zt=be.charSpace||Fi,Ft=be.maxWidth||0,kn=Object.assign({autoencode:!0,noBOM:!0},be.flags);var eu=[],Ds=function(qn){return w.getStringUnitWidth(qn,{font:dc,charSpace:Zt,fontSize:He,doKerning:!1})*He/Ve};if(Object.prototype.toString.call(N)==="[object Array]"){var ys;et=on(N),It!=="left"&&(vs=et.map(Ds));var ws,Bu=0;if(It==="right"){H-=vs[0],N=[],yr=et.length;for(var Ra=0;Ra<yr;Ra++)Ra===0?(ws=ci(H),ys=Ns(pe)):(ws=j(Bu-vs[Ra]),ys=-Fu),N.push([et[Ra],ws,ys]),Bu=vs[Ra]}else if(It==="center"){H-=vs[0]/2,N=[],yr=et.length;for(var tu=0;tu<yr;tu++)tu===0?(ws=ci(H),ys=Ns(pe)):(ws=j((Bu-vs[tu])/2),ys=-Fu),N.push([et[tu],ws,ys]),Bu=vs[tu]}else if(It==="left"){N=[],yr=et.length;for(var nu=0;nu<yr;nu++)N.push(et[nu])}else if(It==="justify"&&dc.encoding==="Identity-H"){N=[],yr=et.length,Ft=Ft!==0?Ft:fc;for(var Pa=0,Ur=0;Ur<yr;Ur++)if(ys=Ur===0?Ns(pe):-Fu,ws=Ur===0?ci(H):Pa,Ur<yr-1){var Il=j((Ft-vs[Ur])/(et[Ur].split(" ").length-1)),Da=et[Ur].split(" ");N.push([Da[0]+" ",ws,ys]),Pa=0;for(var na=1;na<Da.length;na++){var Tl=(Ds(Da[na-1]+" "+Da[na])-Ds(Da[na]))*Ve+Il;na==Da.length-1?N.push([Da[na],Tl,0]):N.push([Da[na]+" ",Tl,0]),Pa-=Tl}}else N.push([et[Ur],ws,ys]);N.push(["",Pa,0])}else{if(It!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(N=[],yr=et.length,Ft=Ft!==0?Ft:fc,Ur=0;Ur<yr;Ur++){ys=Ur===0?Ns(pe):-Fu,ws=Ur===0?ci(H):0;var kl=et[Ur].split(" ").length-1,pc=kl>0?(Ft-vs[Ur])/kl:0;Ur<yr-1?eu.push(C(j(pc))):eu.push(0),N.push([et[Ur],ws,ys])}}}(typeof be.R2L=="boolean"?be.R2L:Et)===!0&&(N=gr(N,function(qn,tr,Lr){return[qn.split("").reverse().join(""),tr,Lr]})),Xe={text:N,x:H,y:pe,options:be,mutex:{pdfEscape:Qi,activeFontKey:vt,fonts:rn,activeFontSize:He}},Cn.publish("postProcessText",Xe),N=Xe.text,q=Xe.mutex.isHex||!1;var mc=rn[vt].encoding;mc!=="WinAnsiEncoding"&&mc!=="StandardEncoding"||(N=gr(N,function(qn,tr,Lr){return[at(qn),tr,Lr]})),et=on(N),N=[];for(var ru,Vu,ju,Nl=Array.isArray(et[0])?1:0,Uu="",Rl=function(qn,tr,Lr){var Zr="";return Lr instanceof Kt?(Lr=typeof be.angle=="number"?go(Lr,new Kt(1,0,0,1,qn,tr)):go(new Kt(1,0,0,1,qn,tr),Lr),I===P&&(Lr=go(new Kt(1,0,0,-1,0,0),Lr)),Zr=Lr.join(" ")+` Tm
`):Zr=C(qn)+" "+C(tr)+` Td
`,Zr},Dr=0;Dr<et.length;Dr++){switch(Uu="",Nl){case 1:ju=(q?"<":"(")+et[Dr][0]+(q?">":")"),ru=parseFloat(et[Dr][1]),Vu=parseFloat(et[Dr][2]);break;case 0:ju=(q?"<":"(")+et[Dr]+(q?">":")"),ru=ci(H),Vu=Ns(pe)}eu!==void 0&&eu[Dr]!==void 0&&(Uu=eu[Dr]+` Tw
`),Dr===0?N.push(Uu+Rl(ru,Vu,sr)+ju):Nl===0?N.push(Uu+ju):Nl===1&&N.push(Uu+Rl(ru,Vu,sr)+ju)}N=Nl===0?N.join(` Tj
T* `):N.join(` Tj
`),N+=` Tj
`;var Uo=`BT
/`;return Uo+=vt+" "+He+` Tf
`,Uo+=C(He*Re)+` TL
`,Uo+=Vo+`
`,Uo+=re,Uo+=N,te(Uo+="ET"),m[vt]=!0,w};var Xa=p.__private__.clip=p.clip=function(N){return te(N==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return Xa("evenodd")},p.__private__.discardPath=p.discardPath=function(){return te("n"),this};var Ts=p.__private__.isValidStyle=function(N){var H=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(N)!==-1&&(H=!0),H};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(N){return Ts(N)&&(l=N),this};var Pu=p.__private__.getStyle=p.getStyle=function(N){var H=l;switch(N){case"D":case"S":H="S";break;case"F":H="f";break;case"FD":case"DF":H="B";break;case"f":case"f*":case"B":case"B*":H=N}return H},An=p.close=function(){return te("h"),this};p.stroke=function(){return te("S"),this},p.fill=function(N){return xo("f",N),this},p.fillEvenOdd=function(N){return xo("f*",N),this},p.fillStroke=function(N){return xo("B",N),this},p.fillStrokeEvenOdd=function(N){return xo("B*",N),this};var xo=function(N,H){fr(H)==="object"?El(H,N):te(N)},Js=function(N){N===null||I===P&&N===void 0||(N=Pu(N),te(N))};function Du(N,H,pe,be,ke){var Xe=new yd(H||this.boundingBox,pe||this.xStep,be||this.yStep,this.gState,ke||this.matrix);Xe.stream=this.stream;var et=N+"$$"+this.cloneIndex+++"$$";return li(et,Xe),Xe}var El=function(N,H){var pe=Bn[N.key],be=Ot[pe];if(be instanceof Jh)te("q"),te(Sl(H)),be.gState&&p.setGState(be.gState),te(N.matrix.toString()+" cm"),te("/"+pe+" sh"),te("Q");else if(be instanceof yd){var ke=new Kt(1,0,0,-1,0,to());N.matrix&&(ke=ke.multiply(N.matrix||Yi),pe=Du.call(be,N.key,N.boundingBox,N.xStep,N.yStep,ke).id),te("q"),te("/Pattern cs"),te("/"+pe+" scn"),be.gState&&p.setGState(be.gState),te(H),te("Q")}},Sl=function(N){switch(N){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ya=p.moveTo=function(N,H){return te(C(j(N))+" "+C(X(H))+" m"),this},ps=p.lineTo=function(N,H){return te(C(j(N))+" "+C(X(H))+" l"),this},Zi=p.curveTo=function(N,H,pe,be,ke,Xe){return te([C(j(N)),C(X(H)),C(j(pe)),C(X(be)),C(j(ke)),C(X(Xe)),"c"].join(" ")),this};p.__private__.line=p.line=function(N,H,pe,be,ke){if(isNaN(N)||isNaN(H)||isNaN(pe)||isNaN(be)||!Ts(ke))throw new Error("Invalid arguments passed to jsPDF.line");return I===T?this.lines([[pe-N,be-H]],N,H,[1,1],ke||"S"):this.lines([[pe-N,be-H]],N,H,[1,1]).stroke()},p.__private__.lines=p.lines=function(N,H,pe,be,ke,Xe){var et,wt,It,Zt,Ft,kn,mr,sr,w,B,q,re;if(typeof N=="number"&&(re=pe,pe=H,H=N,N=re),be=be||[1,1],Xe=Xe||!1,isNaN(H)||isNaN(pe)||!Array.isArray(N)||!Array.isArray(be)||!Ts(ke)||typeof Xe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ya(H,pe),et=be[0],wt=be[1],Zt=N.length,B=H,q=pe,It=0;It<Zt;It++)(Ft=N[It]).length===2?(B=Ft[0]*et+B,q=Ft[1]*wt+q,ps(B,q)):(kn=Ft[0]*et+B,mr=Ft[1]*wt+q,sr=Ft[2]*et+B,w=Ft[3]*wt+q,B=Ft[4]*et+B,q=Ft[5]*wt+q,Zi(kn,mr,sr,w,B,q));return Xe&&An(),Js(ke),this},p.path=function(N){for(var H=0;H<N.length;H++){var pe=N[H],be=pe.c;switch(pe.op){case"m":Ya(be[0],be[1]);break;case"l":ps(be[0],be[1]);break;case"c":Zi.apply(this,be);break;case"h":An()}}return this},p.__private__.rect=p.rect=function(N,H,pe,be,ke){if(isNaN(N)||isNaN(H)||isNaN(pe)||isNaN(be)||!Ts(ke))throw new Error("Invalid arguments passed to jsPDF.rect");return I===T&&(be=-be),te([C(j(N)),C(X(H)),C(j(pe)),C(j(be)),"re"].join(" ")),Js(ke),this},p.__private__.triangle=p.triangle=function(N,H,pe,be,ke,Xe,et){if(isNaN(N)||isNaN(H)||isNaN(pe)||isNaN(be)||isNaN(ke)||isNaN(Xe)||!Ts(et))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[pe-N,be-H],[ke-pe,Xe-be],[N-ke,H-Xe]],N,H,[1,1],et,!0),this},p.__private__.roundedRect=p.roundedRect=function(N,H,pe,be,ke,Xe,et){if(isNaN(N)||isNaN(H)||isNaN(pe)||isNaN(be)||isNaN(ke)||isNaN(Xe)||!Ts(et))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var wt=4/3*(Math.SQRT2-1);return ke=Math.min(ke,.5*pe),Xe=Math.min(Xe,.5*be),this.lines([[pe-2*ke,0],[ke*wt,0,ke,Xe-Xe*wt,ke,Xe],[0,be-2*Xe],[0,Xe*wt,-ke*wt,Xe,-ke,Xe],[2*ke-pe,0],[-ke*wt,0,-ke,-Xe*wt,-ke,-Xe],[0,2*Xe-be],[0,-Xe*wt,ke*wt,-Xe,ke,-Xe]],N+ke,H,[1,1],et,!0),this},p.__private__.ellipse=p.ellipse=function(N,H,pe,be,ke){if(isNaN(N)||isNaN(H)||isNaN(pe)||isNaN(be)||!Ts(ke))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Xe=4/3*(Math.SQRT2-1)*pe,et=4/3*(Math.SQRT2-1)*be;return Ya(N+pe,H),Zi(N+pe,H-et,N+Xe,H-be,N,H-be),Zi(N-Xe,H-be,N-pe,H-et,N-pe,H),Zi(N-pe,H+et,N-Xe,H+be,N,H+be),Zi(N+Xe,H+be,N+pe,H+et,N+pe,H),Js(ke),this},p.__private__.circle=p.circle=function(N,H,pe,be){if(isNaN(N)||isNaN(H)||isNaN(pe)||!Ts(be))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(N,H,pe,pe,be)},p.setFont=function(N,H,pe){return pe&&(H=L(H,pe)),vt=xl(N,H,{disableWarning:!1}),this};var ks=p.__private__.getFont=p.getFont=function(){return rn[xl.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var N,H,pe={};for(N in un)if(un.hasOwnProperty(N))for(H in pe[N]=[],un[N])un[N].hasOwnProperty(H)&&pe[N].push(H);return pe},p.addFont=function(N,H,pe,be,ke){var Xe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Xe.indexOf(arguments[3])!==-1?ke=arguments[3]:arguments[3]&&Xe.indexOf(arguments[3])==-1&&(pe=L(pe,be)),Ka.call(this,N,H,pe,ke=ke||"Identity-H")};var eo,jr=n.lineWidth||.200025,Qa=p.__private__.getLineWidth=p.getLineWidth=function(){return jr},Xt=p.__private__.setLineWidth=p.setLineWidth=function(N){return jr=N,te(C(j(N))+" w"),this};p.__private__.setLineDash=Wt.API.setLineDash=Wt.API.setLineDashPattern=function(N,H){if(N=N||[],H=H||0,isNaN(H)||!Array.isArray(N))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return N=N.map(function(pe){return C(j(pe))}).join(" "),H=C(j(H)),te("["+N+"] "+H+" d"),this};var _o=p.__private__.getLineHeight=p.getLineHeight=function(){return He*eo};p.__private__.getLineHeight=p.getLineHeight=function(){return He*eo};var hc=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(N){return typeof(N=N||1.15)=="number"&&(eo=N),this},Aa=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return eo};hc(n.lineHeight);var ci=p.__private__.getHorizontalCoordinate=function(N){return j(N)},Ns=p.__private__.getVerticalCoordinate=function(N){return I===P?N:Gt[Q].mediaBox.topRightY-Gt[Q].mediaBox.bottomLeftY-j(N)},Lu=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(N){return C(ci(N))},Jn=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(N){return C(Ns(N))},Ja=n.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Fo(Ja)},p.__private__.setStrokeColor=p.setDrawColor=function(N,H,pe,be){return Ja=Vr({ch1:N,ch2:H,ch3:pe,ch4:be,pdfColorType:"draw",precision:2}),te(Ja),this};var Al=n.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Fo(Al)},p.__private__.setFillColor=p.setFillColor=function(N,H,pe,be){return Al=Vr({ch1:N,ch2:H,ch3:pe,ch4:be,pdfColorType:"fill",precision:2}),te(Al),this};var Vo=n.textColor||"0 g",Ca=p.__private__.getTextColor=p.getTextColor=function(){return Fo(Vo)};p.__private__.setTextColor=p.setTextColor=function(N,H,pe,be){return Vo=Vr({ch1:N,ch2:H,ch3:pe,ch4:be,pdfColorType:"text",precision:3}),this};var Fi=n.charSpace,Zs=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Fi||0)};p.__private__.setCharSpace=p.setCharSpace=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Fi=N,this};var jo=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(N){var H=p.CapJoinStyles[N];if(H===void 0)throw new Error("Line cap style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return jo=H,te(H+" J"),this};var Mu=0;p.__private__.setLineJoin=p.setLineJoin=function(N){var H=p.CapJoinStyles[N];if(H===void 0)throw new Error("Line join style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Mu=H,te(H+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(N){if(N=N||0,isNaN(N))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return te(C(j(N))+" M"),this},p.GState=x0,p.setGState=function(N){(N=typeof N=="string"?Ht[Jt[N]]:Ou(null,N)).equals(jn)||(te("/"+N.id+" gs"),jn=N)};var Ou=function(N,H){if(!N||!Jt[N]){var pe=!1;for(var be in Ht)if(Ht.hasOwnProperty(be)&&Ht[be].equals(H)){pe=!0;break}if(pe)H=Ht[be];else{var ke="GS"+(Object.keys(Ht).length+1).toString(10);Ht[ke]=H,H.id=ke}return N&&(Jt[N]=H.id),Cn.publish("addGState",H),H}};p.addGState=function(N,H){return Ou(N,H),this},p.saveGraphicsState=function(){return te("q"),On.push({key:vt,size:He,color:Vo}),this},p.restoreGraphicsState=function(){te("Q");var N=On.pop();return vt=N.key,He=N.size,Vo=N.color,jn=null,this},p.setCurrentTransformationMatrix=function(N){return te(N.toString()+" cm"),this},p.comment=function(N){return te("#"+N),this};var Ai=function(N,H){var pe=N||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return pe},set:function(Xe){isNaN(Xe)||(pe=parseFloat(Xe))}});var be=H||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return be},set:function(Xe){isNaN(Xe)||(be=parseFloat(Xe))}});var ke="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ke},set:function(Xe){ke=Xe.toString()}}),this},Ia=function(N,H,pe,be){Ai.call(this,N,H),this.type="rect";var ke=pe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ke},set:function(et){isNaN(et)||(ke=parseFloat(et))}});var Xe=be||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Xe},set:function(et){isNaN(et)||(Xe=parseFloat(et))}}),this},ea=function(){this.page=Dt,this.currentPage=Q,this.pages=qe.slice(0),this.pagesContext=Gt.slice(0),this.x=yt,this.y=dr,this.matrix=mn,this.width=ms(Q),this.height=Ta(Q),this.outputDestination=Oe,this.id="",this.objectNumber=-1};ea.prototype.restore=function(){Dt=this.page,Q=this.currentPage,Gt=this.pagesContext,qe=this.pages,yt=this.x,dr=this.y,mn=this.matrix,Cl(Q,this.width),Ci(Q,this.height),Oe=this.outputDestination};var Bi=function(N,H,pe,be,ke){ui.push(new ea),Dt=Q=0,qe=[],yt=N,dr=H,mn=ke,Qs([pe,be])};for(var Rs in p.beginFormObject=function(N,H,pe,be,ke){return Bi(N,H,pe,be,ke),this},p.endFormObject=function(N){return(function(H){if(As[H])ui.pop().restore();else{var pe=new ea,be="Xo"+(Object.keys(ai).length+1).toString(10);pe.id=be,As[H]=be,ai[be]=pe,Cn.publish("addFormObject",pe),ui.pop().restore()}})(N),this},p.doFormObject=function(N,H){var pe=ai[As[N]];return te("q"),te(H.toString()+" cm"),te("/"+pe.id+" Do"),te("Q"),this},p.getFormObject=function(N){var H=ai[As[N]];return{x:H.x,y:H.y,width:H.width,height:H.height,matrix:H.matrix}},p.save=function(N,H){return N=N||"generated.pdf",(H=H||{}).returnPromise=H.returnPromise||!1,H.returnPromise===!1?(Xh(Tn(Oi()),N),typeof Xh.unload=="function"&&pn.setTimeout&&setTimeout(Xh.unload,911),this):new Promise(function(pe,be){try{var ke=Xh(Tn(Oi()),N);typeof Xh.unload=="function"&&pn.setTimeout&&setTimeout(Xh.unload,911),pe(ke)}catch(Xe){be(Xe.message)}})},Wt.API)Wt.API.hasOwnProperty(Rs)&&(Rs==="events"&&Wt.API.events.length?(function(N,H){var pe,be,ke;for(ke=H.length-1;ke!==-1;ke--)pe=H[ke][0],be=H[ke][1],N.subscribe.apply(N,[pe].concat(typeof be=="function"?[be]:be))})(Cn,Wt.API.events):p[Rs]=Wt.API[Rs]);function ms(N){return Gt[N].mediaBox.topRightX-Gt[N].mediaBox.bottomLeftX}function Cl(N,H){Gt[N].mediaBox.topRightX=H+Gt[N].mediaBox.bottomLeftX}function Ta(N){return Gt[N].mediaBox.topRightY-Gt[N].mediaBox.bottomLeftY}function Ci(N,H){Gt[N].mediaBox.topRightY=H+Gt[N].mediaBox.bottomLeftY}var gs=p.getPageWidth=function(N){return ms(N=N||Q)/en},hi=p.setPageWidth=function(N,H){Cl(N,H*en)},to=p.getPageHeight=function(N){return Ta(N=N||Q)/en},ka=p.setPageHeight=function(N,H){Ci(N,H*en)};return p.internal={pdfEscape:Qi,getStyle:Pu,getFont:ks,getFontSize:lt,getCharSpace:Zs,getTextColor:Ca,getLineHeight:_o,getLineHeightFactor:Aa,getLineWidth:Qa,write:rt,getHorizontalCoordinate:ci,getVerticalCoordinate:Ns,getCoordinateString:Lu,getVerticalCoordinateString:Jn,collections:{},newObject:Xn,newAdditionalObject:Ei,newObjectDeferred:or,newObjectDeferredBegin:Rr,getFilters:yo,putStream:wo,events:Cn,scaleFactor:en,pageSize:{getWidth:function(){return gs(Q)},setWidth:function(N){hi(Q,N)},getHeight:function(){return to(Q)},setHeight:function(N){ka(Q,N)}},encryptionOptions:h,encryption:br,getEncryptor:function(N){return h!==null?br.encryptor(N,0):function(H){return H}},output:Is,getNumberOfPages:Ji,get pages(){return qe},out:te,f2:k,f3:O,getPageInfo:ds,getPageInfoByObjId:Ru,getCurrentPageInfo:_l,getPDFVersion:b,Point:Ai,Rectangle:Ia,Matrix:Kt,hasHotfix:Si},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return gs(Q)},set:function(N){hi(Q,N)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return to(Q)},set:function(N){ka(Q,N)},enumerable:!0,configurable:!0}),(function(N){for(var H=0,pe=gt.length;H<pe;H++){var be=Ka.call(this,N[H][0],N[H][1],N[H][2],gt[H][3],!0);d===!1&&(m[be]=!0);var ke=N[H][0].split("-");cc({id:be,fontName:ke[0],fontStyle:ke[1]||""})}Cn.publish("addFonts",{fonts:rn,dictionary:un})}).call(p,gt),vt="F1",Nu(i,t),Cn.publish("initialized"),p}ad.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},ad.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},ad.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},ad.prototype.processOwnerPassword=function(n,e){return Rw(Nw(e).substr(0,5),n)},ad.prototype.encryptor=function(n,e){var t=Nw(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return Rw(t,r)}},x0.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||fr(n)!==fr(this))return!1;var r=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;r++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&r--;return r===0},Wt.API={events:[]},Wt.version="3.0.4";var oi=Wt.API,Kx=1,Af=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},td=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},bn=function(n){return n.toFixed(2)},Bc=function(n){return n.toFixed(5)};oi.__acroform__={};var $s=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},JA=function(n){return n*Kx},Yu=function(n){var e=new NN,t=kt.internal.getHeight(n)||0,r=kt.internal.getWidth(n)||0;return e.BBox=[0,0,Number(bn(r)),Number(bn(t))],e},Kq=oi.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<e},Xq=oi.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<e)},Yq=oi.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},yi=oi.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Yq(n,e-1)},wi=oi.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Kq(n,e-1)},bi=oi.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Xq(n,e-1)},Qq=oi.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=n[0],o=n[1],s=n[2],a=n[3],u={};return u.lowerLeft_X=t(i)||0,u.lowerLeft_Y=r(o+a)||0,u.upperRight_X=t(i+s)||0,u.upperRight_Y=r(o)||0,[Number(bn(u.lowerLeft_X)),Number(bn(u.lowerLeft_Y)),Number(bn(u.upperRight_X)),Number(bn(u.upperRight_Y))]},Jq=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,r=Pw(n,t),i=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+i+" "+bn(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Yu(n);return o.scope=n.scope,o.stream=e.join(`
`),o}},Pw=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=n.multiline?i.map(function(k){return k.split(`
`)}):i.map(function(k){return[k]});var o=t,s=kt.internal.getHeight(n)||0;s=s<0?-s:s;var a=kt.internal.getWidth(n)||0;a=a<0?-a:a;var u=function(k,O,j){if(k+1<i.length){var X=O+" "+i[k+1][0];return mv(X,n,j).width<=a-4}return!1};o++;e:for(;o>0;){e="",o--;var l,h,d=mv("3",n,o).height,m=n.multiline?s-o:(s-d)/2,p=m+=2,y=0,b=0,x=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+mv(e,n,o=12).width+", FieldWidth:"+a+`
`;break}for(var E="",T=0,P=0;P<i.length;P++)if(i.hasOwnProperty(P)){var I=!1;if(i[P].length!==1&&x!==i[P].length-1){if((d+2)*(T+2)+2>s)continue e;E+=i[P][x],I=!0,b=P,P--}else{E=(E+=i[P][x]+" ").substr(E.length-1)==" "?E.substr(0,E.length-1):E;var D=parseInt(P),U=u(D,E,o),L=P>=i.length-1;if(U&&!L){E+=" ",x=0;continue}if(U||L){if(L)b=D;else if(n.multiline&&(d+2)*(T+2)+2>s)continue e}else{if(!n.multiline||(d+2)*(T+2)+2>s)continue e;b=D}}for(var C="",A=y;A<=b;A++){var M=i[A];if(n.multiline){if(A===b){C+=M[x]+" ",x=(x+1)%M.length;continue}if(A===y){C+=M[M.length-1]+" ";continue}}C+=M[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,h=mv(C,n,o).width,n.textAlign){case"right":l=a-h-2;break;case"center":l=(a-h)/2;break;default:l=2}e+=bn(l)+" "+bn(p)+` Td
`,e+="("+Af(C)+`) Tj
`,e+=-bn(l)+` 0 Td
`,p=-(o+2),h=0,y=I?b:b+1,T++,E=""}break}return r.text=e,r.fontSize=o,r},mv=function(n,e,t){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(n,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:i}},Zq={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},eH=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},tH=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Iu.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(Zq)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Kx=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new RN,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];o.objId=void 0,o.hasAnnotation&&eH(o,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(r,i){var o=!r;for(var s in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(s)){var a=r[s],u=[],l=a.Rect;if(a.Rect&&(a.Rect=Qq(a.Rect,i)),i.internal.newObjectDeferredBegin(a.objId,!0),a.DA=kt.createDefaultAppearanceStream(a),fr(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(u=a.getKeyValueListForStream()),a.Rect=l,a.hasAppearanceStream&&!a.appearanceStreamContent){var h=Jq(a);u.push({key:"AP",value:"<</N "+h+">>"}),i.internal.acroformPlugin.xForms.push(h)}if(a.appearanceStreamContent){var d="";for(var m in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(m)){var p=a.appearanceStreamContent[m];if(d+="/"+m+" ",d+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var s in p)if(p.hasOwnProperty(s)){var y=p[s];typeof y=="function"&&(y=y.call(i,a)),d+="/"+s+" "+y+" ",i.internal.acroformPlugin.xForms.indexOf(y)>=0||i.internal.acroformPlugin.xForms.push(y)}}else typeof(y=p)=="function"&&(y=y.call(i,a)),d+="/"+s+" "+y,i.internal.acroformPlugin.xForms.indexOf(y)>=0||i.internal.acroformPlugin.xForms.push(y);d+=">>"}u.push({key:"AP",value:`<<
`+d+">>"})}i.internal.putStream({additionalKeyValues:u,objectId:a.objId}),i.internal.out("endobj")}o&&(function(b,x){for(var E in b)if(b.hasOwnProperty(E)){var T=E,P=b[E];x.internal.newObjectDeferredBegin(P.objId,!0),fr(P)==="object"&&typeof P.putStream=="function"&&P.putStream(),delete b[T]}})(i.internal.acroformPlugin.xForms,i)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},kN=oi.__acroform__.arrayToPdfArray=function(n,e,t){var r=function(s){return s};if(Array.isArray(n)){for(var i="[",o=0;o<n.length;o++)switch(o!==0&&(i+=" "),fr(n[o])){case"boolean":case"number":case"object":i+=n[o].toString();break;case"string":n[o].substr(0,1)!=="/"?(e!==void 0&&t&&(r=t.internal.getEncryptor(e)),i+="("+Af(r(n[o].toString()))+")"):i+=n[o].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},w2=function(n,e,t){var r=function(i){return i};return e!==void 0&&t&&(r=t.internal.getEncryptor(e)),(n=n||"").toString(),"("+Af(r(n))+")"},ol=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ol.prototype.toString=function(){return this.objId+" 0 R"},ol.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},ol.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var r=e[t],i=this[r];i&&(Array.isArray(i)?n.push({key:r,value:kN(i,this.objId,this.scope)}):i instanceof ol?(i.scope=this.scope,n.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&n.push({key:r,value:i}))}return n};var NN=function(){ol.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};$s(NN,ol);var RN=function(){ol.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Af(t(n))+")"}},set:function(t){n=t}})};$s(RN,ol);var Iu=function n(){ol.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute F supplied.');e=E}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!yi(e,3)},set:function(E){E?this.F=wi(e,3):this.F=bi(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute Ff supplied.');t=E}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(E){r=E!==void 0?E:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(E){r[0]=E}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(E){r[1]=E}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(E){r[2]=E}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(E){r[3]=E}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(E){switch(E){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=E;break;default:throw new Error('Invalid value "'+E+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof _0)return;o="FieldObject"+n.FieldNum++}var E=function(T){return T};return this.scope&&(E=this.scope.internal.getEncryptor(this.objId)),"("+Af(E(o))+")"},set:function(E){o=E.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(E){o=E}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(E){s=E}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(E){a=E}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(E){u=E}});var l=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return l===void 0?50/Kx:l},set:function(E){l=E}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(E){h=E}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof _0||this instanceof af))return w2(d,this.objId,this.scope)},set:function(E){E=E.toString(),d=E}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof fo==0?w2(m,this.objId,this.scope):m},set:function(E){E=E.toString(),m=this instanceof fo==0?E.substr(0,1)==="("?td(E.substr(1,E.length-2)):td(E):E}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof fo==1?td(m.substr(1,m.length-1)):m},set:function(E){E=E.toString(),m=this instanceof fo==1?"/"+E:E}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(E){this.V=E}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof fo==0?w2(p,this.objId,this.scope):p},set:function(E){E=E.toString(),p=this instanceof fo==0?E.substr(0,1)==="("?td(E.substr(1,E.length-2)):td(E):E}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof fo==1?td(p.substr(1,p.length-1)):p},set:function(E){E=E.toString(),p=this instanceof fo==1?"/"+E:E}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(E){E=!!E,b=E}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(E){y=E}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,1)},set:function(E){E?this.Ff=wi(this.Ff,1):this.Ff=bi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,2)},set:function(E){E?this.Ff=wi(this.Ff,2):this.Ff=bi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,3)},set:function(E){E?this.Ff=wi(this.Ff,3):this.Ff=bi(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(E){if([0,1,2].indexOf(E)===-1)throw new Error('Invalid value "'+E+'" for attribute Q supplied.');x=E}}),Object.defineProperty(this,"textAlign",{get:function(){var E;switch(x){case 0:default:E="left";break;case 1:E="center";break;case 2:E="right"}return E},configurable:!0,enumerable:!0,set:function(E){switch(E){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};$s(Iu,ol);var Id=function(){Iu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return kN(e,this.objId,this.scope)},set:function(t){var r,i;i=[],typeof(r=t)=="string"&&(i=(function(o,s,a){a||(a=1);for(var u,l=[];u=s.exec(o);)l.push(u[a]);return l})(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,18)},set:function(t){t?this.Ff=wi(this.Ff,18):this.Ff=bi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=wi(this.Ff,19):this.Ff=bi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,20)},set:function(t){t?(this.Ff=wi(this.Ff,20),e.sort()):this.Ff=bi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,22)},set:function(t){t?this.Ff=wi(this.Ff,22):this.Ff=bi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,23)},set:function(t){t?this.Ff=wi(this.Ff,23):this.Ff=bi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,27)},set:function(t){t?this.Ff=wi(this.Ff,27):this.Ff=bi(this.Ff,27)}}),this.hasAppearanceStream=!1};$s(Id,Iu);var Td=function(){Id.call(this),this.fontName="helvetica",this.combo=!1};$s(Td,Id);var kd=function(){Td.call(this),this.combo=!0};$s(kd,Td);var Nv=function(){kd.call(this),this.edit=!0};$s(Nv,kd);var fo=function(){Iu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,15)},set:function(t){t?this.Ff=wi(this.Ff,15):this.Ff=bi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,16)},set:function(t){t?this.Ff=wi(this.Ff,16):this.Ff=bi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,17)},set:function(t){t?this.Ff=wi(this.Ff,17):this.Ff=bi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,26)},set:function(t){t?this.Ff=wi(this.Ff,26):this.Ff=bi(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+Af(t(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(t){fr(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};$s(fo,Iu);var Rv=function(){fo.call(this),this.pushButton=!0};$s(Rv,fo);var Nd=function(){fo.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};$s(Nd,fo);var _0=function(){var n,e;Iu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(a){return a};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),r)s.push("/"+o+" ("+Af(i(r[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){fr(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(i){t="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=kt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};$s(_0,Iu),Nd.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},Nd.prototype.createOption=function(n){var e=new _0;return e.Parent=this,e.optionName=n,this.Kids.push(e),nH.call(this.scope,e),e};var Pv=function(){fo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=kt.CheckBox.createAppearanceStream()};$s(Pv,fo);var af=function(){Iu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,13)},set:function(e){e?this.Ff=wi(this.Ff,13):this.Ff=bi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,21)},set:function(e){e?this.Ff=wi(this.Ff,21):this.Ff=bi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,23)},set:function(e){e?this.Ff=wi(this.Ff,23):this.Ff=bi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,24)},set:function(e){e?this.Ff=wi(this.Ff,24):this.Ff=bi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,25)},set:function(e){e?this.Ff=wi(this.Ff,25):this.Ff=bi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,26)},set:function(e){e?this.Ff=wi(this.Ff,26):this.Ff=bi(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};$s(af,Iu);var Dv=function(){af.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,14)},set:function(n){n?this.Ff=wi(this.Ff,14):this.Ff=bi(this.Ff,14)}}),this.password=!0};$s(Dv,af);var kt={CheckBox:{createAppearanceStream:function(){return{N:{On:kt.CheckBox.YesNormal},D:{On:kt.CheckBox.YesPushDown,Off:kt.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=[],r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,i=n.scope.__private__.encodeColorString(n.color),o=Pw(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+bn(kt.internal.getWidth(n))+" "+bn(kt.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+bn(o.fontSize)+" Tf "+i),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=Yu(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),i=[],o=kt.internal.getHeight(n),s=kt.internal.getWidth(n),a=Pw(n,n.caption);return i.push("1 g"),i.push("0 0 "+bn(s)+" "+bn(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+bn(s-1)+" "+bn(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+t+" "+bn(a.fontSize)+" Tf "+r),i.push(a.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+bn(kt.internal.getWidth(n))+" "+bn(kt.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:kt.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=kt.RadioButton.Circle.YesNormal,e.D[n]=kt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=Yu(n);e.scope=n.scope;var t=[],r=kt.internal.getWidth(n)<=kt.internal.getHeight(n)?kt.internal.getWidth(n)/4:kt.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=kt.internal.Bezier_C,o=Number((r*i).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Bc(kt.internal.getWidth(n)/2)+" "+Bc(kt.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=[],r=kt.internal.getWidth(n)<=kt.internal.getHeight(n)?kt.internal.getWidth(n)/4:kt.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),o=Number((i*kt.internal.Bezier_C).toFixed(5)),s=Number((r*kt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Bc(kt.internal.getWidth(n)/2)+" "+Bc(kt.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Bc(kt.internal.getWidth(n)/2)+" "+Bc(kt.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=[],r=kt.internal.getWidth(n)<=kt.internal.getHeight(n)?kt.internal.getWidth(n)/4:kt.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),o=Number((i*kt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Bc(kt.internal.getWidth(n)/2)+" "+Bc(kt.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:kt.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=kt.RadioButton.Cross.YesNormal,e.D[n]=kt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=Yu(n);e.scope=n.scope;var t=[],r=kt.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+bn(kt.internal.getWidth(n)-2)+" "+bn(kt.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(bn(r.x1.x)+" "+bn(r.x1.y)+" m"),t.push(bn(r.x2.x)+" "+bn(r.x2.y)+" l"),t.push(bn(r.x4.x)+" "+bn(r.x4.y)+" m"),t.push(bn(r.x3.x)+" "+bn(r.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=kt.internal.calculateCross(n),r=[];return r.push("0.749023 g"),r.push("0 0 "+bn(kt.internal.getWidth(n))+" "+bn(kt.internal.getHeight(n))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+bn(kt.internal.getWidth(n)-2)+" "+bn(kt.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(bn(t.x1.x)+" "+bn(t.x1.y)+" m"),r.push(bn(t.x2.x)+" "+bn(t.x2.y)+" l"),r.push(bn(t.x4.x)+" "+bn(t.x4.y)+" m"),r.push(bn(t.x3.x)+" "+bn(t.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+bn(kt.internal.getWidth(n))+" "+bn(kt.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};kt.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=kt.internal.getWidth(n),t=kt.internal.getHeight(n),r=Math.min(e,t);return{x1:{x:(e-r)/2,y:(t-r)/2+r},x2:{x:(e-r)/2+r,y:(t-r)/2},x3:{x:(e-r)/2,y:(t-r)/2},x4:{x:(e-r)/2+r,y:(t-r)/2+r}}}},kt.internal.getWidth=function(n){var e=0;return fr(n)==="object"&&(e=JA(n.Rect[2])),e},kt.internal.getHeight=function(n){var e=0;return fr(n)==="object"&&(e=JA(n.Rect[3])),e};var nH=oi.addField=function(n){if(tH(this,n),!(n instanceof Iu))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};oi.AcroFormChoiceField=Id,oi.AcroFormListBox=Td,oi.AcroFormComboBox=kd,oi.AcroFormEditBox=Nv,oi.AcroFormButton=fo,oi.AcroFormPushButton=Rv,oi.AcroFormRadioButton=Nd,oi.AcroFormCheckBox=Pv,oi.AcroFormTextField=af,oi.AcroFormPasswordField=Dv,oi.AcroFormAppearance=kt,oi.AcroForm={ChoiceField:Id,ListBox:Td,ComboBox:kd,EditBox:Nv,Button:fo,PushButton:Rv,RadioButton:Nd,CheckBox:Pv,TextField:af,PasswordField:Dv,Appearance:kt},Wt.AcroForm={ChoiceField:Id,ListBox:Td,ComboBox:kd,EditBox:Nv,Button:fo,PushButton:Rv,RadioButton:Nd,CheckBox:Pv,TextField:af,PasswordField:Dv,Appearance:kt};Wt.AcroForm;function PN(n){return n.reduce(function(e,t,r){return e[t]=r,e},{})}(function(n){var e="addImage_";n.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=n.__addimage__.getImageFileTypeByImageData=function(k,O){var j,X,ue,ge,he,$=t;if((O=O||t)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(U(k))for(he in r)for(ue=r[he],j=0;j<ue.length;j+=1){for(ge=!0,X=0;X<ue[j].length;X+=1)if(ue[j][X]!==void 0&&ue[j][X]!==k[X]){ge=!1;break}if(ge===!0){$=he;break}}else for(he in r)for(ue=r[he],j=0;j<ue.length;j+=1){for(ge=!0,X=0;X<ue[j].length;X+=1)if(ue[j][X]!==void 0&&ue[j][X]!==k.charCodeAt(X)){ge=!1;break}if(ge===!0){$=he;break}}return $===t&&O!==t&&($=O),$},o=function k(O){for(var j=this.internal.write,X=this.internal.putStream,ue=(0,this.internal.getFilters)();ue.indexOf("FlateEncode")!==-1;)ue.splice(ue.indexOf("FlateEncode"),1);O.objectId=this.internal.newObject();var ge=[];if(ge.push({key:"Type",value:"/XObject"}),ge.push({key:"Subtype",value:"/Image"}),ge.push({key:"Width",value:O.width}),ge.push({key:"Height",value:O.height}),O.colorSpace===E.INDEXED?ge.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(O.palette.length/3-1)+" "+("sMask"in O&&O.sMask!==void 0?O.objectId+2:O.objectId+1)+" 0 R]"}):(ge.push({key:"ColorSpace",value:"/"+O.colorSpace}),O.colorSpace===E.DEVICE_CMYK&&ge.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ge.push({key:"BitsPerComponent",value:O.bitsPerComponent}),"decodeParameters"in O&&O.decodeParameters!==void 0&&ge.push({key:"DecodeParms",value:"<<"+O.decodeParameters+">>"}),"transparency"in O&&Array.isArray(O.transparency)&&O.transparency.length>0){for(var he="",$=0,le=O.transparency.length;$<le;$++)he+=O.transparency[$]+" "+O.transparency[$]+" ";ge.push({key:"Mask",value:"["+he+"]"})}O.sMask!==void 0&&ge.push({key:"SMask",value:O.objectId+1+" 0 R"});var ae=O.filter!==void 0?["/"+O.filter]:void 0;if(X({data:O.data,additionalKeyValues:ge,alreadyAppliedFilters:ae,objectId:O.objectId}),j("endobj"),"sMask"in O&&O.sMask!==void 0){var J,W=(J=O.sMaskBitsPerComponent)!==null&&J!==void 0?J:O.bitsPerComponent,Q={width:O.width,height:O.height,colorSpace:"DeviceGray",bitsPerComponent:W,data:O.sMask};"filter"in O&&(Q.decodeParameters="/Predictor ".concat(O.predictor," /Colors 1 /BitsPerComponent ").concat(W," /Columns ").concat(O.width),Q.filter=O.filter),k.call(this,Q)}if(O.colorSpace===E.INDEXED){var ne=this.internal.newObject();X({data:C(new Uint8Array(O.palette)),objectId:ne}),j("endobj")}},s=function(){var k=this.internal.collections[e+"images"];for(var O in k)o.call(this,k[O])},a=function(){var k,O=this.internal.collections[e+"images"],j=this.internal.write;for(var X in O)j("/I"+(k=O[X]).index,k.objectId,"0","R")},u=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var k=this.internal.collections[e+"images"];return u.call(this),k},h=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(k){return typeof n["process"+k.toUpperCase()]=="function"},m=function(k){return fr(k)==="object"&&k.nodeType===1},p=function(k,O){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var j=""+k.getAttribute("src");if(j.indexOf("data:image/")===0)return kv(unescape(j).split("base64,").pop());var X=n.loadFile(j,!0);if(X!==void 0)return X}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var ue;switch(O){case"PNG":ue="image/png";break;case"WEBP":ue="image/webp";break;default:ue="image/jpeg"}return kv(k.toDataURL(ue,1).split("base64,").pop())}},y=function(k){var O=this.internal.collections[e+"images"];if(O){for(var j in O)if(k===O[j].alias)return O[j]}},b=function(k,O,j){return k||O||(k=-96,O=-96),k<0&&(k=-1*j.width*72/k/this.internal.scaleFactor),O<0&&(O=-1*j.height*72/O/this.internal.scaleFactor),k===0&&(k=O*j.width/j.height),O===0&&(O=k*j.height/j.width),[k,O]},x=function(k,O,j,X,ue,ge){var he=b.call(this,j,X,ue),$=this.internal.getCoordinateString,le=this.internal.getVerticalCoordinateString,ae=l.call(this);if(j=he[0],X=he[1],ae[ue.index]=ue,ge){ge*=Math.PI/180;var J=Math.cos(ge),W=Math.sin(ge),Q=function(fe){return fe.toFixed(4)},ne=[Q(J),Q(W),Q(-1*W),Q(J),0,0,"cm"]}this.internal.write("q"),ge?(this.internal.write([1,"0","0",1,$(k),le(O+X),"cm"].join(" ")),this.internal.write(ne.join(" ")),this.internal.write([$(j),"0","0",$(X),"0","0","cm"].join(" "))):this.internal.write([$(j),"0","0",$(X),$(k),le(O+X),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ue.index+" Do"),this.internal.write("Q")},E=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var T=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},P=n.__addimage__.sHashCode=function(k){var O,j,X=0;if(typeof k=="string")for(j=k.length,O=0;O<j;O++)X=(X<<5)-X+k.charCodeAt(O),X|=0;else if(U(k))for(j=k.byteLength/2,O=0;O<j;O++)X=(X<<5)-X+k[O],X|=0;return X},I=n.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var O=!0;return k.length===0&&(O=!1),k.length%4!=0&&(O=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(O=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(O=!1),O},D=n.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var O=k.indexOf(",");return O<0?null:k.substring(0,O).trim().endsWith("base64")?k.substring(O+1):null};n.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var U=n.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},L=n.__addimage__.binaryStringToUint8Array=function(k){for(var O=k.length,j=new Uint8Array(O),X=0;X<O;X++)j[X]=k.charCodeAt(X);return j},C=n.__addimage__.arrayBufferToBinaryString=function(k){for(var O="",j=U(k)?k:new Uint8Array(k),X=0;X<j.length;X+=8192)O+=String.fromCharCode.apply(null,j.subarray(X,X+8192));return O};n.addImage=function(){var k,O,j,X,ue,ge,he,$,le;if(typeof arguments[1]=="number"?(O=t,j=arguments[1],X=arguments[2],ue=arguments[3],ge=arguments[4],he=arguments[5],$=arguments[6],le=arguments[7]):(O=arguments[1],j=arguments[2],X=arguments[3],ue=arguments[4],ge=arguments[5],he=arguments[6],$=arguments[7],le=arguments[8]),fr(k=arguments[0])==="object"&&!m(k)&&"imageData"in k){var ae=k;k=ae.imageData,O=ae.format||O||t,j=ae.x||j||0,X=ae.y||X||0,ue=ae.w||ae.width||ue,ge=ae.h||ae.height||ge,he=ae.alias||he,$=ae.compression||$,le=ae.rotation||ae.angle||le}var J=this.internal.getFilters();if($===void 0&&J.indexOf("FlateEncode")!==-1&&($="SLOW"),isNaN(j)||isNaN(X))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var W=A.call(this,k,O,he,$);return x.call(this,j,X,ue,ge,W,le),this};var A=function(k,O,j,X){var ue,ge,he;if(typeof k=="string"&&i(k)===t){k=unescape(k);var $=M(k,!1);($!==""||($=n.loadFile(k,!0))!==void 0)&&(k=$)}if(m(k)&&(k=p(k,O)),O=i(k,O),!d(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(((he=j)==null||he.length===0)&&(j=(function(le){return typeof le=="string"||U(le)?P(le):U(le.data)?P(le.data):null})(k)),(ue=y.call(this,j))||(k instanceof Uint8Array||O==="RGBA"||(ge=k,k=L(k)),ue=this["process"+O.toUpperCase()](k,h.call(this),j,(function(le){return le&&typeof le=="string"&&(le=le.toUpperCase()),le in n.image_compression?le:T.NONE})(X),ge)),!ue)throw new Error("An unknown error occurred whilst processing the image.");return ue},M=n.__addimage__.convertBase64ToBinaryString=function(k,O){O=typeof O!="boolean"||O;var j,X="";if(typeof k=="string"){var ue;j=(ue=D(k))!==null&&ue!==void 0?ue:k;try{X=kv(j)}catch(ge){if(O)throw I(j)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ge.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return X};n.getImageProperties=function(k){var O,j,X="";if(m(k)&&(k=p(k)),typeof k=="string"&&i(k)===t&&((X=M(k,!1))===""&&(X=n.loadFile(k)||""),k=X),j=i(k),!d(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(k instanceof Uint8Array||(k=L(k)),!(O=this["process"+j.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return O.fileType=j,O}})(Wt.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};Wt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var r,i,o,s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(t.objId),l=t.pageContext.annotations,h=!1,d=0;d<l.length&&!h;d++)switch((r=l[d]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var m=0;m<l.length;m++){r=l[m];var p=this.internal.pdfEscape,y=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),E=this.internal.getEncryptor(b.objId),T=r.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(r.bounds.x)+" "+a(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y)+"] ")+"/Contents ("+p(E(r.contents))+")",o+=" /Popup "+x.objId+" 0 R",o+=" /P "+u.objId+" 0 R",o+=" /T ("+p(E(T))+") >>",b.content=o;var P=b.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(r.bounds.x+30)+" "+a(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w+30)+" "+a(r.bounds.y)+"] ")+" /Parent "+P,r.open&&(o+=" /Open true"),o+=" >>",x.content=o,this.internal.write(b.objId,"0 R",x.objId,"0 R");break;case"freetext":i="/Rect ["+s(r.bounds.x)+" "+a(r.bounds.y)+" "+s(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y+r.bounds.h)+"] ";var I=r.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(y(r.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+I+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(r.options.name){var D=this.annotations._nameMap[r.options.name];r.options.pageNumber=D.page,r.options.top=D.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",o="",r.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(y(r.options.url))+") >>";else if(r.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,o+=" /FitV "+r.options.left+"]";break;default:var U=a(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),o+=" /XYZ "+r.options.left+" "+U+" "+r.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},n.link=function(t,r,i,o,s){var a=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:u(t),y:l(r),w:u(t+i),h:l(r+o)},options:s,type:"link"})},n.textWithLink=function(t,r,i,o){var s,a,u=this.getTextWidth(t),l=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){a=o.maxWidth;var h=this.splitTextToSize(t,a).length;s=Math.ceil(l*h)}else a=u,s=l;return this.text(t,r,i,o),i+=.2*l,o.align==="center"&&(r-=u/2),o.align==="right"&&(r-=u),this.link(r,i-l,a,s,o),u},n.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}})(Wt.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];n.__arabicParser__={};var o=n.__arabicParser__.isInArabicSubstitutionA=function(b){return e[b.charCodeAt(0)]!==void 0},s=n.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},a=n.__arabicParser__.isArabicEndLetter=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length<=2},u=n.__arabicParser__.isArabicAlfLetter=function(b){return s(b)&&i.indexOf(b.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length>=1};var l=n.__arabicParser__.arabicLetterHasFinalForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length>=3};var h=n.__arabicParser__.arabicLetterHasMedialForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length==4},d=n.__arabicParser__.resolveLigatures=function(b){var x=0,E=t,T="",P=0;for(x=0;x<b.length;x+=1)E[b.charCodeAt(x)]!==void 0?(P++,typeof(E=E[b.charCodeAt(x)])=="number"&&(T+=String.fromCharCode(E),E=t,P=0),x===b.length-1&&(E=t,T+=b.charAt(x-(P-1)),x-=P-1,P=0)):(E=t,T+=b.charAt(x-P),x-=P,P=0);return T};n.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&r[b.charCodeAt(0)]!==void 0};var m=n.__arabicParser__.getCorrectForm=function(b,x,E){return s(b)?o(b)===!1?-1:!l(b)||!s(x)&&!s(E)||!s(E)&&a(x)||a(b)&&!s(x)||a(b)&&u(x)||a(b)&&a(x)?0:h(b)&&s(x)&&!a(x)&&s(E)&&l(E)?3:a(b)||!s(E)?1:2:-1},p=function(b){var x=0,E=0,T=0,P="",I="",D="",U=(b=b||"").split("\\s+"),L=[];for(x=0;x<U.length;x+=1){for(L.push(""),E=0;E<U[x].length;E+=1)P=U[x][E],I=U[x][E-1],D=U[x][E+1],s(P)?(T=m(P,I,D),L[x]+=T!==-1?String.fromCharCode(e[P.charCodeAt(0)][T]):P):L[x]+=P;L[x]=d(L[x])}return L.join(" ")},y=n.__arabicParser__.processArabic=n.processArabic=function(){var b,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,E=[];if(Array.isArray(x)){var T=0;for(E=[],T=0;T<x.length;T+=1)Array.isArray(x[T])?E.push([p(x[T][0]),x[T][1],x[T][2]]):E.push([p(x[T])]);b=E}else b=p(x);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};n.events.push(["preProcessText",y])})(Wt.API),Wt.API.autoPrint=function(n){var e;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(a){t=a}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(a){o=a}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(a){s=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,r){var i;if((t=t||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Wt.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(b){u=b}});var l=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return l},set:function(b){l=b}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(b){h=b}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(b){d=b}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(b){m=b}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(b){p=b}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(b){y=b}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(u){return r.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},n.getTextDimensions=function(u,l){r.call(this);var h=(l=l||{}).fontSize||this.getFontSize(),d=l.font||this.getFont(),m=l.scaleFactor||this.internal.scaleFactor,p=0,y=0,b=0,x=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var E=l.maxWidth;E>0?typeof u=="string"?u=this.splitTextToSize(u,E):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(P,I){return P.concat(x.splitTextToSize(I,E))},[])):u=Array.isArray(u)?u:[u];for(var T=0;T<u.length;T++)p<(b=this.getStringUnitWidth(u[T],{font:d})*h)&&(p=b);return p!==0&&(y=u.length),{w:p/=m,h:Math.max((y*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/m,0)}},n.cellAddPage=function(){r.call(this),this.addPage();var u=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=n.cell=function(){var u;u=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),r.call(this);var l=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,m=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return l.lineNumber!==void 0&&(l.lineNumber===u.lineNumber?(u.x=(l.x||0)+(l.width||0),u.y=l.y||0):l.y+l.height+u.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=d.top,p&&m&&(this.printHeaderRow(u.lineNumber,!0),u.y+=m[0].height)):u.y=l.y+l.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,t===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-h,u.y+h,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+h,{align:"center",baseline:"top",maxWidth:u.width-h-h}):this.text(u.text,u.x+h,u.y+h,{align:"left",baseline:"top",maxWidth:u.width-h-h})),this.internal.__cell__.lastCell=u,this};n.table=function(u,l,h,d,m){if(r.call(this),!h)throw new Error("No data for PDF table.");var p,y,b,x,E=[],T=[],P=[],I={},D={},U=[],L=[],C=(m=m||{}).autoSize||!1,A=m.printHeaders!==!1,M=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,k=m.margins||Object.assign({width:this.getPageWidth()},e),O=typeof m.padding=="number"?m.padding:3,j=m.headerBackgroundColor||"#c8c8c8",X=m.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=O,this.internal.__cell__.headerBackgroundColor=j,this.internal.__cell__.headerTextColor=X,this.setFontSize(M),d==null)T=E=Object.keys(h[0]),P=E.map(function(){return"left"});else if(Array.isArray(d)&&fr(d[0])==="object")for(E=d.map(function(ae){return ae.name}),T=d.map(function(ae){return ae.prompt||ae.name||""}),P=d.map(function(ae){return ae.align||"left"}),p=0;p<d.length;p+=1)D[d[p].name]=.7499990551181103*d[p].width;else Array.isArray(d)&&typeof d[0]=="string"&&(T=E=d,P=E.map(function(){return"left"}));if(C||Array.isArray(d)&&typeof d[0]=="string")for(p=0;p<E.length;p+=1){for(I[x=E[p]]=h.map(function(ae){return ae[x]}),this.setFont(void 0,"bold"),U.push(this.getTextDimensions(T[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=I[x],this.setFont(void 0,"normal"),b=0;b<y.length;b+=1)U.push(this.getTextDimensions(y[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[x]=Math.max.apply(null,U)+O+O,U=[]}if(A){var ue={};for(p=0;p<E.length;p+=1)ue[E[p]]={},ue[E[p]].text=T[p],ue[E[p]].align=P[p];var ge=a.call(this,ue,D);L=E.map(function(ae){return new o(u,l,D[ae],ge,ue[ae].text,void 0,ue[ae].align)}),this.setTableHeaderRow(L),this.printHeaderRow(1,!1)}var he=d.reduce(function(ae,J){return ae[J.name]=J.align,ae},{});for(p=0;p<h.length;p+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:p,data:h[p]},this);var $=a.call(this,h[p],D);for(b=0;b<E.length;b+=1){var le=h[p][E[b]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:p,col:b,data:le},this),s.call(this,new o(u,l,D[E[b]],$,le,p+2,he[E[b]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=l,this};var a=function(u,l){var h=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(u).map(function(p){var y=u[p];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,l[p]-h-h)},this).map(function(p){return this.getLineHeightFactor()*p.length*d/m+h+h},this).reduce(function(p,y){return Math.max(p,y)},0)};n.setTableHeaderRow=function(u){r.call(this),this.internal.__cell__.tableHeaderRow=u},n.printHeaderRow=function(u,l){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){h=this.internal.__cell__.tableHeaderRow[p].clone(),l&&(h.y=this.internal.__cell__.margins.top||0,m.push(h)),h.lineNumber=u;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,h),this.setTextColor(y)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),t=!1}})(Wt.API);var DN={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},LN=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Dw=PN(LN),MN=[100,200,300,400,500,600,700,800,900],rH=PN(MN);function b2(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(o){return DN[o=o||"normal"]?o:"normal"})(n.style),r=(function(o){return o?typeof o=="number"?o>=100&&o<=900&&o%100==0?o:400:/^\d00$/.test(o)?parseInt(o):o==="bold"?700:400:400})(n.weight),i=(function(o){return typeof Dw[o=o||"normal"]=="number"?o:"normal"})(n.stretch);return{family:e,style:t,weight:r,stretch:i,src:n.src||[],ref:n.ref||{name:e,style:[i,t,r].join(" ")}}}function ZA(n,e,t,r){var i;for(i=t;i>=0&&i<e.length;i+=r)if(n[e[i]])return n[e[i]];for(i=t;i>=0&&i<e.length;i-=r)if(n[e[i]])return n[e[i]]}var iH={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},eC={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function tC(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function nC(n){return n.trimLeft()}function oH(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function sH(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var gv,rC,iC,nd,vv,oC,sC,aC,x2=["times"];function uC(n,e,t,r,i){var o=4,s=cC;switch(i){case Wt.API.image_compression.FAST:o=1,s=lC;break;case Wt.API.image_compression.MEDIUM:o=6,s=hC;break;case Wt.API.image_compression.SLOW:o=9,s=fC}n=(function(u,l,h,d){for(var m,p=u.length/l,y=new Uint8Array(u.length+p),b=[aH,lC,cC,hC,fC],x=0;x<p;x+=1){var E=x*l,T=u.subarray(E,E+l);if(d)y.set(d(T,h,m),E+x);else{for(var P=b.length,I=[],D=0;D<P;D+=1)I[D]=b[D](T,h,m);var U=lH(I.concat());y.set(I[U],E+x)}m=T}return y})(n,e,Math.ceil(t*r/8),s);var a=Cw(n,{level:o});return Wt.API.__addimage__.arrayBufferToBinaryString(a)}function aH(n){var e=Array.apply([],n);return e.unshift(0),e}function lC(n,e){var t=n.length,r=[];r[0]=1;for(var i=0;i<t;i+=1){var o=n[i-e]||0;r[i+1]=n[i]-o+256&255}return r}function cC(n,e,t){var r=n.length,i=[];i[0]=2;for(var o=0;o<r;o+=1){var s=t&&t[o]||0;i[o+1]=n[o]-s+256&255}return i}function hC(n,e,t){var r=n.length,i=[];i[0]=3;for(var o=0;o<r;o+=1){var s=n[o-e]||0,a=t&&t[o]||0;i[o+1]=n[o]+256-(s+a>>>1)&255}return i}function fC(n,e,t){var r=n.length,i=[];i[0]=4;for(var o=0;o<r;o+=1){var s=uH(n[o-e]||0,t&&t[o]||0,t&&t[o-e]||0);i[o+1]=n[o]-s+256&255}return i}function uH(n,e,t){if(n===e&&e===t)return n;var r=Math.abs(e-t),i=Math.abs(n-t),o=Math.abs(n+e-t-t);return r<=i&&r<=o?n:i<=o?e:t}function lH(n){var e=n.map(function(t){return t.reduce(function(r,i){return r+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function _2(n,e,t){var r=e*t,i=Math.floor(r/8),o=16-(r-8*i+t),s=(1<<t)-1;return ON(n,i)>>o&s}function dC(n,e,t,r){var i=t*r,o=Math.floor(i/8),s=16-(i-8*o+r),a=(1<<r)-1,u=(e&a)<<s;(function(l,h,d){if(h+1<l.byteLength)l.setUint16(h,d,!1);else{var m=d>>8&255;l.setUint8(h,m)}})(n,o,ON(n,o)&~(a<<s)&65535|u)}function ON(n,e){return e+1<n.byteLength?n.getUint16(e,!1):n.getUint8(e)<<8}function cH(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,r=n[e++]|n[e++]<<8,i=n[e++],o=i>>7,s=1<<1+(7&i);n[e++],n[e++];var a=null,u=null;o&&(a=e,u=s,e+=3*s);var l=!0,h=[],d=0,m=null,p=0,y=null;for(this.width=t,this.height=r;l&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,y=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((k=n[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var b=n[e++];d=n[e++]|n[e++]<<8,m=n[e++],1&b||(m=null),p=b>>2&7,e++;break;case 254:for(;;){if(!((k=n[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var x=n[e++]|n[e++]<<8,E=n[e++]|n[e++]<<8,T=n[e++]|n[e++]<<8,P=n[e++]|n[e++]<<8,I=n[e++],D=I>>6&1,U=1<<1+(7&I),L=a,C=u,A=!1;I>>7&&(A=!0,L=e,C=U,e+=3*U);var M=e;for(e++;;){var k;if(!((k=n[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}h.push({x,y:E,width:T,height:P,has_local_palette:A,palette_offset:L,palette_size:C,data_offset:M,data_length:e-M,transparent_index:m,interlaced:!!D,delay:d,disposal:p});break;case 59:l=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return y},this.frameInfo=function(O){if(O<0||O>=h.length)throw new Error("Frame index out of range.");return h[O]},this.decodeAndBlitFrameBGRA=function(O,j){var X=this.frameInfo(O),ue=X.width*X.height,ge=new Uint8Array(ue);pC(n,X.data_offset,ge,ue);var he=X.palette_offset,$=X.transparent_index;$===null&&($=256);var le=X.width,ae=t-le,J=le,W=4*(X.y*t+X.x),Q=4*((X.y+X.height)*t+X.x),ne=W,fe=4*ae;X.interlaced===!0&&(fe+=4*t*7);for(var ve=8,we=0,Se=ge.length;we<Se;++we){var Ce=ge[we];if(J===0&&(J=le,(ne+=fe)>=Q&&(fe=4*ae+4*t*(ve-1),ne=W+(le+ae)*(ve<<1),ve>>=1)),Ce===$)ne+=4;else{var Fe=n[he+3*Ce],qe=n[he+3*Ce+1],Ne=n[he+3*Ce+2];j[ne++]=Ne,j[ne++]=qe,j[ne++]=Fe,j[ne++]=255}--J}},this.decodeAndBlitFrameRGBA=function(O,j){var X=this.frameInfo(O),ue=X.width*X.height,ge=new Uint8Array(ue);pC(n,X.data_offset,ge,ue);var he=X.palette_offset,$=X.transparent_index;$===null&&($=256);var le=X.width,ae=t-le,J=le,W=4*(X.y*t+X.x),Q=4*((X.y+X.height)*t+X.x),ne=W,fe=4*ae;X.interlaced===!0&&(fe+=4*t*7);for(var ve=8,we=0,Se=ge.length;we<Se;++we){var Ce=ge[we];if(J===0&&(J=le,(ne+=fe)>=Q&&(fe=4*ae+4*t*(ve-1),ne=W+(le+ae)*(ve<<1),ve>>=1)),Ce===$)ne+=4;else{var Fe=n[he+3*Ce],qe=n[he+3*Ce+1],Ne=n[he+3*Ce+2];j[ne++]=Fe,j[ne++]=qe,j[ne++]=Ne,j[ne++]=255}--J}}}function pC(n,e,t,r){for(var i=n[e++],o=1<<i,s=o+1,a=s+1,u=i+1,l=(1<<u)-1,h=0,d=0,m=0,p=n[e++],y=new Int32Array(4096),b=null;;){for(;h<16&&p!==0;)d|=n[e++]<<h,h+=8,p===1?p=n[e++]:--p;if(h<u)break;var x=d&l;if(d>>=u,h-=u,x!==o){if(x===s)break;for(var E=x<a?x:b,T=0,P=E;P>o;)P=y[P]>>8,++T;var I=P;if(m+T+(E!==x?1:0)>r)return void _r.log("Warning, gif stream longer than expected.");t[m++]=I;var D=m+=T;for(E!==x&&(t[m++]=I),P=E;T--;)P=y[P],t[--D]=255&P,P>>=8;b!==null&&a<4096&&(y[a++]=b<<8|I,a>=l+1&&u<12&&(++u,l=l<<1|1)),b=x}else a=s+1,l=(1<<(u=i+1))-1,b=null}return m!==r&&_r.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function E2(n){var e,t,r,i,o,s=Math.floor,a=new Array(64),u=new Array(64),l=new Array(64),h=new Array(64),d=new Array(65535),m=new Array(65535),p=new Array(64),y=new Array(64),b=[],x=0,E=7,T=new Array(64),P=new Array(64),I=new Array(64),D=new Array(256),U=new Array(2048),L=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],O=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ue=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ge(W,Q){for(var ne=0,fe=0,ve=new Array,we=1;we<=16;we++){for(var Se=1;Se<=W[we];Se++)ve[Q[fe]]=[],ve[Q[fe]][0]=ne,ve[Q[fe]][1]=we,fe++,ne++;ne*=2}return ve}function he(W){for(var Q=W[0],ne=W[1]-1;ne>=0;)Q&1<<ne&&(x|=1<<E),ne--,--E<0&&(x==255?($(255),$(0)):$(x),E=7,x=0)}function $(W){b.push(W)}function le(W){$(W>>8&255),$(255&W)}function ae(W,Q,ne,fe,ve){for(var we,Se=ve[0],Ce=ve[240],Fe=(function(He,ft){var lt,Et,pt,En,$t,Qt,an,qt,vt,en,yt=0;for(vt=0;vt<8;++vt){lt=He[yt],Et=He[yt+1],pt=He[yt+2],En=He[yt+3],$t=He[yt+4],Qt=He[yt+5],an=He[yt+6];var dr=lt+(qt=He[yt+7]),mn=lt-qt,rn=Et+an,un=Et-an,On=pt+Qt,Ot=pt-Qt,Bn=En+$t,Ht=En-$t,Jt=dr+Bn,jn=dr-Bn,Dt=rn+On,Gt=rn-On;He[yt]=Jt+Dt,He[yt+4]=Jt-Dt;var Cn=.707106781*(Gt+jn);He[yt+2]=jn+Cn,He[yt+6]=jn-Cn;var Mo=.382683433*((Jt=Ht+Ot)-(Gt=un+mn)),ai=.5411961*Jt+Mo,As=1.306562965*Gt+Mo,ui=.707106781*(Dt=Ot+un),Kt=mn+ui,go=mn-ui;He[yt+5]=go+ai,He[yt+3]=go-ai,He[yt+1]=Kt+As,He[yt+7]=Kt-As,yt+=8}for(yt=0,vt=0;vt<8;++vt){lt=He[yt],Et=He[yt+8],pt=He[yt+16],En=He[yt+24],$t=He[yt+32],Qt=He[yt+40],an=He[yt+48];var Yi=lt+(qt=He[yt+56]),li=lt-qt,vo=Et+an,Xn=Et-an,or=pt+Qt,Rr=pt-Qt,Ei=En+$t,Ks=En-$t,Oo=Yi+Ei,Fo=Yi-Ei,Vr=vo+or,yo=vo-or;He[yt]=Oo+Vr,He[yt+32]=Oo-Vr;var wo=.707106781*(yo+Fo);He[yt+16]=Fo+wo,He[yt+48]=Fo-wo;var xa=.382683433*((Oo=Ks+Rr)-(yo=Xn+li)),cs=.5411961*Oo+xa,hs=1.306562965*yo+xa,_a=.707106781*(Vr=Rr+Xn),Xs=li+_a,Cs=li-_a;He[yt+40]=Cs+cs,He[yt+24]=Cs-cs,He[yt+8]=Xs+hs,He[yt+56]=Xs-hs,yt++}for(vt=0;vt<64;++vt)en=He[vt]*ft[vt],p[vt]=en>0?en+.5|0:en-.5|0;return p})(W,Q),qe=0;qe<64;++qe)y[L[qe]]=Fe[qe];var Ne=y[0]-ne;ne=y[0],Ne==0?he(fe[0]):(he(fe[m[we=32767+Ne]]),he(d[we]));for(var Oe=63;Oe>0&&y[Oe]==0;)Oe--;if(Oe==0)return he(Se),ne;for(var Qe,te=1;te<=Oe;){for(var rt=te;y[te]==0&&te<=Oe;)++te;var zt=te-rt;if(zt>=16){Qe=zt>>4;for(var gt=1;gt<=Qe;++gt)he(Ce);zt&=15}we=32767+y[te],he(ve[(zt<<4)+m[we]]),he(d[we]),te++}return Oe!=63&&he(Se),ne}function J(W){W=Math.min(Math.max(W,1),100),o!=W&&((function(Q){for(var ne=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],fe=0;fe<64;fe++){var ve=s((ne[fe]*Q+50)/100);ve=Math.min(Math.max(ve,1),255),a[L[fe]]=ve}for(var we=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Se=0;Se<64;Se++){var Ce=s((we[Se]*Q+50)/100);Ce=Math.min(Math.max(Ce,1),255),u[L[Se]]=Ce}for(var Fe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],qe=0,Ne=0;Ne<8;Ne++)for(var Oe=0;Oe<8;Oe++)l[qe]=1/(a[L[qe]]*Fe[Ne]*Fe[Oe]*8),h[qe]=1/(u[L[qe]]*Fe[Ne]*Fe[Oe]*8),qe++})(W<50?Math.floor(5e3/W):Math.floor(200-2*W)),o=W)}this.encode=function(W,Q){Q&&J(Q),b=new Array,x=0,E=7,le(65496),le(65504),le(16),$(74),$(70),$(73),$(70),$(0),$(1),$(1),$(0),le(1),le(1),$(0),$(0),(function(){le(65499),le(132),$(0);for(var Et=0;Et<64;Et++)$(a[Et]);$(1);for(var pt=0;pt<64;pt++)$(u[pt])})(),(function(Et,pt){le(65472),le(17),$(8),le(pt),le(Et),$(3),$(1),$(17),$(0),$(2),$(17),$(1),$(3),$(17),$(1)})(W.width,W.height),(function(){le(65476),le(418),$(0);for(var Et=0;Et<16;Et++)$(C[Et+1]);for(var pt=0;pt<=11;pt++)$(A[pt]);$(16);for(var En=0;En<16;En++)$(M[En+1]);for(var $t=0;$t<=161;$t++)$(k[$t]);$(1);for(var Qt=0;Qt<16;Qt++)$(O[Qt+1]);for(var an=0;an<=11;an++)$(j[an]);$(17);for(var qt=0;qt<16;qt++)$(X[qt+1]);for(var vt=0;vt<=161;vt++)$(ue[vt])})(),le(65498),le(12),$(3),$(1),$(0),$(2),$(17),$(3),$(17),$(0),$(63),$(0);var ne=0,fe=0,ve=0;x=0,E=7,this.encode.displayName="_encode_";for(var we,Se,Ce,Fe,qe,Ne,Oe,Qe,te,rt=W.data,zt=W.width,gt=W.height,He=4*zt,ft=0;ft<gt;){for(we=0;we<He;){for(qe=He*ft+we,Oe=-1,Qe=0,te=0;te<64;te++)Ne=qe+(Qe=te>>3)*He+(Oe=4*(7&te)),ft+Qe>=gt&&(Ne-=He*(ft+1+Qe-gt)),we+Oe>=He&&(Ne-=we+Oe-He+4),Se=rt[Ne++],Ce=rt[Ne++],Fe=rt[Ne++],T[te]=(U[Se]+U[Ce+256|0]+U[Fe+512|0]>>16)-128,P[te]=(U[Se+768|0]+U[Ce+1024|0]+U[Fe+1280|0]>>16)-128,I[te]=(U[Se+1280|0]+U[Ce+1536|0]+U[Fe+1792|0]>>16)-128;ne=ae(T,l,ne,e,r),fe=ae(P,h,fe,t,i),ve=ae(I,h,ve,t,i),we+=32}ft+=8}if(E>=0){var lt=[];lt[1]=E+1,lt[0]=(1<<E+1)-1,he(lt)}return le(65497),new Uint8Array(b)},n=n||50,(function(){for(var W=String.fromCharCode,Q=0;Q<256;Q++)D[Q]=W(Q)})(),e=ge(C,A),t=ge(O,j),r=ge(M,k),i=ge(X,ue),(function(){for(var W=1,Q=2,ne=1;ne<=15;ne++){for(var fe=W;fe<Q;fe++)m[32767+fe]=ne,d[32767+fe]=[],d[32767+fe][1]=ne,d[32767+fe][0]=fe;for(var ve=-(Q-1);ve<=-W;ve++)m[32767+ve]=ne,d[32767+ve]=[],d[32767+ve][1]=ne,d[32767+ve][0]=Q-1+ve;W<<=1,Q<<=1}})(),(function(){for(var W=0;W<256;W++)U[W]=19595*W,U[W+256|0]=38470*W,U[W+512|0]=7471*W+32768,U[W+768|0]=-11059*W,U[W+1024|0]=-21709*W,U[W+1280|0]=32768*W+8421375,U[W+1536|0]=-27439*W,U[W+1792|0]=-5329*W})(),J(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function pu(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function mC(n){function e(A){if(!A)throw Error("assert :P")}function t(A,M,k){for(var O=0;4>O;O++)if(A[M+O]!=k.charCodeAt(O))return!0;return!1}function r(A,M,k,O,j){for(var X=0;X<j;X++)A[M+X]=k[O+X]}function i(A,M,k,O){for(var j=0;j<O;j++)A[M+j]=k}function o(A){return new Int32Array(A)}function s(A,M){for(var k=[],O=0;O<A;O++)k.push(new M);return k}function a(A,M){var k=[];return(function O(j,X,ue){for(var ge=ue[X],he=0;he<ge&&(j.push(ue.length>X+1?[]:new M),!(ue.length<X+1));he++)O(j[he],X+1,ue)})(k,0,A),k}var u=function(){var A=this;function M(v,S){for(var F=1<<S-1>>>0;v&F;)F>>>=1;return F?(v&F-1)+F:v}function k(v,S,F,z,G){e(!(z%F));do v[S+(z-=F)]=G;while(0<z)}function O(v,S,F,z,G){if(e(2328>=G),512>=G)var Y=o(512);else if((Y=o(G))==null)return 0;return(function(Z,ee,ie,ce,_e,De){var de,Ae,Pe=ee,Ke=1<<ie,Me=o(16),We=o(16);for(e(_e!=0),e(ce!=null),e(Z!=null),e(0<ie),Ae=0;Ae<_e;++Ae){if(15<ce[Ae])return 0;++Me[ce[Ae]]}if(Me[0]==_e)return 0;for(We[1]=0,de=1;15>de;++de){if(Me[de]>1<<de)return 0;We[de+1]=We[de]+Me[de]}for(Ae=0;Ae<_e;++Ae)de=ce[Ae],0<ce[Ae]&&(De[We[de]++]=Ae);if(We[15]==1)return(ce=new j).g=0,ce.value=De[0],k(Z,Pe,1,Ke,ce),Ke;var Ge,Je=-1,Ze=Ke-1,Lt=0,bt=1,gn=1,Ct=1<<ie;for(Ae=0,de=1,_e=2;de<=ie;++de,_e<<=1){if(bt+=gn<<=1,0>(gn-=Me[de]))return 0;for(;0<Me[de];--Me[de])(ce=new j).g=de,ce.value=De[Ae++],k(Z,Pe+Lt,_e,Ct,ce),Lt=M(Lt,de)}for(de=ie+1,_e=2;15>=de;++de,_e<<=1){if(bt+=gn<<=1,0>(gn-=Me[de]))return 0;for(;0<Me[de];--Me[de]){if(ce=new j,(Lt&Ze)!=Je){for(Pe+=Ct,Ge=1<<(Je=de)-ie;15>Je&&!(0>=(Ge-=Me[Je]));)++Je,Ge<<=1;Ke+=Ct=1<<(Ge=Je-ie),Z[ee+(Je=Lt&Ze)].g=Ge+ie,Z[ee+Je].value=Pe-ee-Je}ce.g=de-ie,ce.value=De[Ae++],k(Z,Pe+(Lt>>ie),_e,Ct,ce),Lt=M(Lt,de)}}return bt!=2*We[15]-1?0:Ke})(v,S,F,z,G,Y)}function j(){this.value=this.g=0}function X(){this.value=this.g=0}function ue(){this.G=s(5,j),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Ds,X)}function ge(v,S,F,z){e(v!=null),e(S!=null),e(2147483648>z),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=S,v.pa=F,v.Jd=S,v.Yc=F+z,v.Zc=4<=z?F+z-4+1:F,Se(v)}function he(v,S){for(var F=0;0<S--;)F|=Fe(v,128)<<S;return F}function $(v,S){var F=he(v,S);return Ce(v)?-F:F}function le(v,S,F,z){var G,Y=0;for(e(v!=null),e(S!=null),e(4294967288>z),v.Sb=z,v.Ra=0,v.u=0,v.h=0,4<z&&(z=4),G=0;G<z;++G)Y+=S[F+G]<<8*G;v.Ra=Y,v.bb=z,v.oa=S,v.pa=F}function ae(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<Bu-8>>>0,++v.bb,v.u-=8;fe(v)&&(v.h=1,v.u=0)}function J(v,S){if(e(0<=S),!v.h&&S<=ws){var F=ne(v)&ys[S];return v.u+=S,ae(v),F}return v.h=1,v.u=0}function W(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Q(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function ne(v){return v.Ra>>>(v.u&Bu-1)>>>0}function fe(v){return e(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>Bu}function ve(v,S){v.u=S,v.h=fe(v)}function we(v){v.u>=Ra&&(e(v.u>=Ra),ae(v))}function Se(v){e(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(e(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function Ce(v){return he(v,1)}function Fe(v,S){var F=v.Ca;0>v.b&&Se(v);var z=v.b,G=F*S>>>8,Y=(v.I>>>z>G)+0;for(Y?(F-=G,v.I-=G+1<<z>>>0):F=G+1,z=F,G=0;256<=z;)G+=8,z>>=8;return z=7^G+tu[z],v.b-=z,v.Ca=(F<<z)-1,Y}function qe(v,S,F){v[S+0]=F>>24&255,v[S+1]=F>>16&255,v[S+2]=F>>8&255,v[S+3]=255&F}function Ne(v,S){return v[S+0]|v[S+1]<<8}function Oe(v,S){return Ne(v,S)|v[S+2]<<16}function Qe(v,S){return Ne(v,S)|Ne(v,S+2)<<16}function te(v,S){var F=1<<S;return e(v!=null),e(0<S),v.X=o(F),v.X==null?0:(v.Mb=32-S,v.Xa=S,1)}function rt(v,S){e(v!=null),e(S!=null),e(v.Xa==S.Xa),r(S.X,0,v.X,0,1<<S.Xa)}function zt(){this.X=[],this.Xa=this.Mb=0}function gt(v,S,F,z){e(F!=null),e(z!=null);var G=F[0],Y=z[0];return G==0&&(G=(v*Y+S/2)/S),Y==0&&(Y=(S*G+v/2)/v),0>=G||0>=Y?0:(F[0]=G,z[0]=Y,1)}function He(v,S){return v+(1<<S)-1>>>S}function ft(v,S){return((4278255360&v)+(4278255360&S)>>>0&4278255360)+((16711935&v)+(16711935&S)>>>0&16711935)>>>0}function lt(v,S){A[S]=function(F,z,G,Y,Z,ee,ie){var ce;for(ce=0;ce<Z;++ce){var _e=A[v](ee[ie+ce-1],G,Y+ce);ee[ie+ce]=ft(F[z+ce],_e)}}}function Et(){this.ud=this.hd=this.jd=0}function pt(v,S){return((4278124286&(v^S))>>>1)+(v&S)>>>0}function En(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function $t(v,S){return En(v+(v-S+.5>>1))}function Qt(v,S,F){return Math.abs(S-F)-Math.abs(v-F)}function an(v,S,F,z,G,Y,Z){for(z=Y[Z-1],F=0;F<G;++F)Y[Z+F]=z=ft(v[S+F],z)}function qt(v,S,F,z,G){var Y;for(Y=0;Y<F;++Y){var Z=v[S+Y],ee=Z>>8&255,ie=16711935&(ie=(ie=16711935&Z)+((ee<<16)+ee));z[G+Y]=(4278255360&Z)+ie>>>0}}function vt(v,S){S.jd=255&v,S.hd=v>>8&255,S.ud=v>>16&255}function en(v,S,F,z,G,Y){var Z;for(Z=0;Z<z;++Z){var ee=S[F+Z],ie=ee>>>8,ce=ee,_e=255&(_e=(_e=ee>>>16)+((v.jd<<24>>24)*(ie<<24>>24)>>>5));ce=255&(ce=(ce+=(v.hd<<24>>24)*(ie<<24>>24)>>>5)+((v.ud<<24>>24)*(_e<<24>>24)>>>5)),G[Y+Z]=(4278255360&ee)+(_e<<16)+ce}}function yt(v,S,F,z,G){A[S]=function(Y,Z,ee,ie,ce,_e,De,de,Ae){for(ie=De;ie<de;++ie)for(De=0;De<Ae;++De)ce[_e++]=G(ee[z(Y[Z++])])},A[v]=function(Y,Z,ee,ie,ce,_e,De){var de=8>>Y.b,Ae=Y.Ea,Pe=Y.K[0],Ke=Y.w;if(8>de)for(Y=(1<<Y.b)-1,Ke=(1<<de)-1;Z<ee;++Z){var Me,We=0;for(Me=0;Me<Ae;++Me)Me&Y||(We=z(ie[ce++])),_e[De++]=G(Pe[We&Ke]),We>>=de}else A["VP8LMapColor"+F](ie,ce,Pe,Ke,_e,De,Z,ee,Ae)}}function dr(v,S,F,z,G){for(F=S+F;S<F;){var Y=v[S++];z[G++]=Y>>16&255,z[G++]=Y>>8&255,z[G++]=255&Y}}function mn(v,S,F,z,G){for(F=S+F;S<F;){var Y=v[S++];z[G++]=Y>>16&255,z[G++]=Y>>8&255,z[G++]=255&Y,z[G++]=Y>>24&255}}function rn(v,S,F,z,G){for(F=S+F;S<F;){var Y=(Z=v[S++])>>16&240|Z>>12&15,Z=240&Z|Z>>28&15;z[G++]=Y,z[G++]=Z}}function un(v,S,F,z,G){for(F=S+F;S<F;){var Y=(Z=v[S++])>>16&248|Z>>13&7,Z=Z>>5&224|Z>>3&31;z[G++]=Y,z[G++]=Z}}function On(v,S,F,z,G){for(F=S+F;S<F;){var Y=v[S++];z[G++]=255&Y,z[G++]=Y>>8&255,z[G++]=Y>>16&255}}function Ot(v,S,F,z,G,Y){if(Y==0)for(F=S+F;S<F;)qe(z,((Y=v[S++])[0]>>24|Y[1]>>8&65280|Y[2]<<8&16711680|Y[3]<<24)>>>0),G+=32;else r(z,G,v,S,F)}function Bn(v,S){A[S][0]=A[v+"0"],A[S][1]=A[v+"1"],A[S][2]=A[v+"2"],A[S][3]=A[v+"3"],A[S][4]=A[v+"4"],A[S][5]=A[v+"5"],A[S][6]=A[v+"6"],A[S][7]=A[v+"7"],A[S][8]=A[v+"8"],A[S][9]=A[v+"9"],A[S][10]=A[v+"10"],A[S][11]=A[v+"11"],A[S][12]=A[v+"12"],A[S][13]=A[v+"13"],A[S][14]=A[v+"0"],A[S][15]=A[v+"0"]}function Ht(v){return v==wc||v==Ll||v==kh||v==Nh}function Jt(){this.eb=[],this.size=this.A=this.fb=0}function jn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Dt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Jt,this.f.kb=new jn,this.sd=null}function Gt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Cn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Mo(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function ai(v,S){var F=v.T,z=S.ba.f.RGBA,G=z.eb,Y=z.fb+v.ka*z.A,Z=Wo[S.ba.S],ee=v.y,ie=v.O,ce=v.f,_e=v.N,De=v.ea,de=v.W,Ae=S.cc,Pe=S.dc,Ke=S.Mc,Me=S.Nc,We=v.ka,Ge=v.ka+v.T,Je=v.U,Ze=Je+1>>1;for(We==0?Z(ee,ie,null,null,ce,_e,De,de,ce,_e,De,de,G,Y,null,null,Je):(Z(S.ec,S.fc,ee,ie,Ae,Pe,Ke,Me,ce,_e,De,de,G,Y-z.A,G,Y,Je),++F);We+2<Ge;We+=2)Ae=ce,Pe=_e,Ke=De,Me=de,_e+=v.Rc,de+=v.Rc,Y+=2*z.A,Z(ee,(ie+=2*v.fa)-v.fa,ee,ie,Ae,Pe,Ke,Me,ce,_e,De,de,G,Y-z.A,G,Y,Je);return ie+=v.fa,v.j+Ge<v.o?(r(S.ec,S.fc,ee,ie,Je),r(S.cc,S.dc,ce,_e,Ze),r(S.Mc,S.Nc,De,de,Ze),F--):1&Ge||Z(ee,ie,null,null,ce,_e,De,de,ce,_e,De,de,G,Y+z.A,null,null,Je),F}function As(v,S,F){var z=v.F,G=[v.J];if(z!=null){var Y=v.U,Z=S.ba.S,ee=Z==Th||Z==kh;S=S.ba.f.RGBA;var ie=[0],ce=v.ka;ie[0]=v.T,v.Kb&&(ce==0?--ie[0]:(--ce,G[0]-=v.width),v.j+v.ka+v.T==v.o&&(ie[0]=v.o-v.j-ce));var _e=S.eb;ce=S.fb+ce*S.A,v=Ch(z,G[0],v.width,Y,ie,_e,ce+(ee?0:3),S.A),e(F==ie),v&&Ht(Z)&&Dl(_e,ce,ee,Y,ie,S.A)}return 0}function ui(v){var S=v.ma,F=S.ba.S,z=11>F,G=F==zu||F==Ih||F==Th||F==ar||F==12||Ht(F);if(S.memory=null,S.Ib=null,S.Jb=null,S.Nd=null,!fc(S.Oa,v,G?11:12))return 0;if(G&&Ht(F)&&on(),v.da)alert("todo:use_scaling");else{if(z){if(S.Ib=Mo,v.Kb){if(F=v.U+1>>1,S.memory=o(v.U+2*F),S.memory==null)return 0;S.ec=S.memory,S.fc=0,S.cc=S.ec,S.dc=S.fc+v.U,S.Mc=S.cc,S.Nc=S.dc+F,S.Ib=ai,on()}}else alert("todo:EmitYUV");G&&(S.Jb=As,z&&Ve())}if(z&&!Vi){for(v=0;256>v;++v)qo[v]=89858*(v-128)+ia>>ou,Ho[v]=-22014*(v-128)+ia,Ec[v]=-45773*(v-128),Bl[v]=113618*(v-128)+ia>>ou;for(v=Zn;v<nr;++v)S=76283*(v-16)+ia>>ou,Mf[v-Zn]=Pr(S,255),mg[v-Zn]=Pr(S+8>>4,15);Vi=1}return 1}function Kt(v){var S=v.ma,F=v.U,z=v.T;return e(!(1&v.ka)),0>=F||0>=z?0:(F=S.Ib(v,S),S.Jb!=null&&S.Jb(v,S,F),S.Dc+=F,1)}function go(v){v.ma.memory=null}function Yi(v,S,F,z){return J(v,8)!=47?0:(S[0]=J(v,14)+1,F[0]=J(v,14)+1,z[0]=J(v,1),J(v,3)!=0?0:!v.h)}function li(v,S){if(4>v)return v+1;var F=v-2>>1;return(2+(1&v)<<F)+J(S,F)+1}function vo(v,S){return 120<S?S-120:1<=(F=((F=C1[S-1])>>4)*v+(8-(15&F)))?F:1;var F}function Xn(v,S,F){var z=ne(F),G=v[S+=255&z].g-8;return 0<G&&(ve(F,F.u+8),z=ne(F),S+=v[S].value,S+=z&(1<<G)-1),ve(F,F.u+v[S].g),v[S].value}function or(v,S,F){return F.g+=v.g,F.value+=v.value<<S>>>0,e(8>=F.g),v.g}function Rr(v,S,F){var z=v.xc;return e((S=z==0?0:v.vc[v.md*(F>>z)+(S>>z)])<v.Wb),v.Ya[S]}function Ei(v,S,F,z){var G=v.ab,Y=v.c*S,Z=v.C;S=Z+S;var ee=F,ie=z;for(z=v.Ta,F=v.Ua;0<G--;){var ce=v.gc[G],_e=Z,De=S,de=ee,Ae=ie,Pe=(ie=z,ee=F,ce.Ea);switch(e(_e<De),e(De<=ce.nc),ce.hc){case 2:Ur(de,Ae,(De-_e)*Pe,ie,ee);break;case 0:var Ke=_e,Me=De,We=ie,Ge=ee,Je=(Ct=ce).Ea;Ke==0&&(nu(de,Ae,null,null,1,We,Ge),an(de,Ae+1,0,0,Je-1,We,Ge+1),Ae+=Je,Ge+=Je,++Ke);for(var Ze=1<<Ct.b,Lt=Ze-1,bt=He(Je,Ct.b),gn=Ct.K,Ct=Ct.w+(Ke>>Ct.b)*bt;Ke<Me;){var Rn=gn,Mr=Ct,yn=1;for(Pa(de,Ae,We,Ge-Je,1,We,Ge);yn<Je;){var xt=(yn&~Lt)+Ze;xt>Je&&(xt=Je),(0,kl[Rn[Mr++]>>8&15])(de,Ae+ +yn,We,Ge+yn-Je,xt-yn,We,Ge+yn),yn=xt}Ae+=Je,Ge+=Je,++Ke&Lt||(Ct+=bt)}De!=ce.nc&&r(ie,ee-Pe,ie,ee+(De-_e-1)*Pe,Pe);break;case 1:for(Pe=de,Me=Ae,Je=(de=ce.Ea)-(Ge=de&~(We=(Ae=1<<ce.b)-1)),Ke=He(de,ce.b),Ze=ce.K,ce=ce.w+(_e>>ce.b)*Ke;_e<De;){for(Lt=Ze,bt=ce,gn=new Et,Ct=Me+Ge,Rn=Me+de;Me<Ct;)vt(Lt[bt++],gn),pc(gn,Pe,Me,Ae,ie,ee),Me+=Ae,ee+=Ae;Me<Rn&&(vt(Lt[bt++],gn),pc(gn,Pe,Me,Je,ie,ee),Me+=Je,ee+=Je),++_e&We||(ce+=Ke)}break;case 3:if(de==ie&&Ae==ee&&0<ce.b){for(Me=ie,de=Pe=ee+(De-_e)*Pe-(Ge=(De-_e)*He(ce.Ea,ce.b)),Ae=ie,We=ee,Ke=[],Ge=(Je=Ge)-1;0<=Ge;--Ge)Ke[Ge]=Ae[We+Ge];for(Ge=Je-1;0<=Ge;--Ge)Me[de+Ge]=Ke[Ge];Il(ce,_e,De,ie,Pe,ie,ee)}else Il(ce,_e,De,de,Ae,ie,ee)}ee=z,ie=F}ie!=F&&r(z,F,ee,ie,Y)}function Ks(v,S){var F=v.V,z=v.Ba+v.c*v.C,G=S-v.C;if(e(S<=v.l.o),e(16>=G),0<G){var Y=v.l,Z=v.Ta,ee=v.Ua,ie=Y.width;if(Ei(v,G,F,z),G=ee=[ee],e((F=v.C)<(z=S)),e(Y.v<Y.va),z>Y.o&&(z=Y.o),F<Y.j){var ce=Y.j-F;F=Y.j,G[0]+=ce*ie}if(F>=z?F=0:(G[0]+=4*Y.v,Y.ka=F-Y.j,Y.U=Y.va-Y.v,Y.T=z-F,F=1),F){if(ee=ee[0],11>(F=v.ca).S){var _e=F.f.RGBA,De=(z=F.S,G=Y.U,Y=Y.T,ce=_e.eb,_e.A),de=Y;for(_e=_e.fb+v.Ma*_e.A;0<de--;){var Ae=Z,Pe=ee,Ke=G,Me=ce,We=_e;switch(z){case Rf:mc(Ae,Pe,Ke,Me,We);break;case zu:ru(Ae,Pe,Ke,Me,We);break;case wc:ru(Ae,Pe,Ke,Me,We),Dl(Me,We,0,Ke,1,0);break;case cg:Nl(Ae,Pe,Ke,Me,We);break;case Ih:Ot(Ae,Pe,Ke,Me,We,1);break;case Ll:Ot(Ae,Pe,Ke,Me,We,1),Dl(Me,We,0,Ke,1,0);break;case Th:Ot(Ae,Pe,Ke,Me,We,0);break;case kh:Ot(Ae,Pe,Ke,Me,We,0),Dl(Me,We,1,Ke,1,0);break;case ar:Vu(Ae,Pe,Ke,Me,We);break;case Nh:Vu(Ae,Pe,Ke,Me,We),pp(Me,We,Ke,1,0);break;case Pf:ju(Ae,Pe,Ke,Me,We);break;default:e(0)}ee+=ie,_e+=De}v.Ma+=Y}else alert("todo:EmitRescaledRowsYUVA");e(v.Ma<=F.height)}}v.C=S,e(v.C<=v.i)}function Oo(v){var S;if(0<v.ua)return 0;for(S=0;S<v.Wb;++S){var F=v.Ya[S].G,z=v.Ya[S].H;if(0<F[1][z[1]+0].g||0<F[2][z[2]+0].g||0<F[3][z[3]+0].g)return 0}return 1}function Fo(v,S,F,z,G,Y){if(v.Z!=0){var Z=v.qd,ee=v.rd;for(e(io[v.Z]!=null);S<F;++S)io[v.Z](Z,ee,z,G,z,G,Y),Z=z,ee=G,G+=Y;v.qd=Z,v.rd=ee}}function Vr(v,S){var F=v.l.ma,z=F.Z==0||F.Z==1?v.l.j:v.C;if(z=v.C<z?z:v.C,e(S<=v.l.o),S>z){var G=v.l.width,Y=F.ca,Z=F.tb+G*z,ee=v.V,ie=v.Ba+v.c*z,ce=v.gc;e(v.ab==1),e(ce[0].hc==3),na(ce[0],z,S,ee,ie,Y,Z),Fo(F,z,S,Y,Z,G)}v.C=v.Ma=S}function yo(v,S,F,z,G,Y,Z){var ee=v.$/z,ie=v.$%z,ce=v.m,_e=v.s,De=F+v.$,de=De;G=F+z*G;var Ae=F+z*Y,Pe=280+_e.ua,Ke=v.Pb?ee:16777216,Me=0<_e.ua?_e.Wa:null,We=_e.wc,Ge=De<Ae?Rr(_e,ie,ee):null;e(v.C<Y),e(Ae<=G);var Je=!1;e:for(;;){for(;Je||De<Ae;){var Ze=0;if(ee>=Ke){var Lt=De-F;e((Ke=v).Pb),Ke.wd=Ke.m,Ke.xd=Lt,0<Ke.s.ua&&rt(Ke.s.Wa,Ke.s.vb),Ke=ee+Lf}if(ie&We||(Ge=Rr(_e,ie,ee)),e(Ge!=null),Ge.Qb&&(S[De]=Ge.qb,Je=!0),!Je)if(we(ce),Ge.jc){Ze=ce,Lt=S;var bt=De,gn=Ge.pd[ne(Ze)&Ds-1];e(Ge.jc),256>gn.g?(ve(Ze,Ze.u+gn.g),Lt[bt]=gn.value,Ze=0):(ve(Ze,Ze.u+gn.g-256),e(256<=gn.value),Ze=gn.value),Ze==0&&(Je=!0)}else Ze=Xn(Ge.G[0],Ge.H[0],ce);if(ce.h)break;if(Je||256>Ze){if(!Je)if(Ge.nd)S[De]=(Ge.qb|Ze<<8)>>>0;else{if(we(ce),Je=Xn(Ge.G[1],Ge.H[1],ce),we(ce),Lt=Xn(Ge.G[2],Ge.H[2],ce),bt=Xn(Ge.G[3],Ge.H[3],ce),ce.h)break;S[De]=(bt<<24|Je<<16|Ze<<8|Lt)>>>0}if(Je=!1,++De,++ie>=z&&(ie=0,++ee,Z!=null&&ee<=Y&&!(ee%16)&&Z(v,ee),Me!=null))for(;de<De;)Ze=S[de++],Me.X[(506832829*Ze&4294967295)>>>Me.Mb]=Ze}else if(280>Ze){if(Ze=li(Ze-256,ce),Lt=Xn(Ge.G[4],Ge.H[4],ce),we(ce),Lt=vo(z,Lt=li(Lt,ce)),ce.h)break;if(De-F<Lt||G-De<Ze)break e;for(bt=0;bt<Ze;++bt)S[De+bt]=S[De+bt-Lt];for(De+=Ze,ie+=Ze;ie>=z;)ie-=z,++ee,Z!=null&&ee<=Y&&!(ee%16)&&Z(v,ee);if(e(De<=G),ie&We&&(Ge=Rr(_e,ie,ee)),Me!=null)for(;de<De;)Ze=S[de++],Me.X[(506832829*Ze&4294967295)>>>Me.Mb]=Ze}else{if(!(Ze<Pe))break e;for(Je=Ze-280,e(Me!=null);de<De;)Ze=S[de++],Me.X[(506832829*Ze&4294967295)>>>Me.Mb]=Ze;Ze=De,e(!(Je>>>(Lt=Me).Xa)),S[Ze]=Lt.X[Je],Je=!0}Je||e(ce.h==fe(ce))}if(v.Pb&&ce.h&&De<G)e(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&rt(v.s.vb,v.s.Wa);else{if(ce.h)break e;Z!=null&&Z(v,ee>Y?Y:ee),v.a=0,v.$=De-F}return 1}return v.a=3,0}function wo(v){e(v!=null),v.vc=null,v.yc=null,v.Ya=null;var S=v.Wa;S!=null&&(S.X=null),v.vb=null,e(v!=null)}function xa(){var v=new Zt;return v==null?null:(v.a=0,v.xb=xc,Bn("Predictor","VP8LPredictors"),Bn("Predictor","VP8LPredictors_C"),Bn("PredictorAdd","VP8LPredictorsAdd"),Bn("PredictorAdd","VP8LPredictorsAdd_C"),Ur=qt,pc=en,mc=dr,ru=mn,Vu=rn,ju=un,Nl=On,A.VP8LMapColor32b=Da,A.VP8LMapColor8b=Tl,v)}function cs(v,S,F,z,G){var Y=1,Z=[v],ee=[S],ie=z.m,ce=z.s,_e=null,De=0;e:for(;;){if(F)for(;Y&&J(ie,1);){var de=Z,Ae=ee,Pe=z,Ke=1,Me=Pe.m,We=Pe.gc[Pe.ab],Ge=J(Me,2);if(Pe.Oc&1<<Ge)Y=0;else{switch(Pe.Oc|=1<<Ge,We.hc=Ge,We.Ea=de[0],We.nc=Ae[0],We.K=[null],++Pe.ab,e(4>=Pe.ab),Ge){case 0:case 1:We.b=J(Me,3)+2,Ke=cs(He(We.Ea,We.b),He(We.nc,We.b),0,Pe,We.K),We.K=We.K[0];break;case 3:var Je,Ze=J(Me,8)+1,Lt=16<Ze?0:4<Ze?1:2<Ze?2:3;if(de[0]=He(We.Ea,Lt),We.b=Lt,Je=Ke=cs(Ze,1,0,Pe,We.K)){var bt,gn=Ze,Ct=We,Rn=1<<(8>>Ct.b),Mr=o(Rn);if(Mr==null)Je=0;else{var yn=Ct.K[0],xt=Ct.w;for(Mr[0]=Ct.K[0][0],bt=1;bt<1*gn;++bt)Mr[bt]=ft(yn[xt+bt],Mr[bt-1]);for(;bt<4*Rn;++bt)Mr[bt]=0;Ct.K[0]=null,Ct.K[0]=Mr,Je=1}}Ke=Je;break;case 2:break;default:e(0)}Y=Ke}}if(Z=Z[0],ee=ee[0],Y&&J(ie,1)&&!(Y=1<=(De=J(ie,4))&&11>=De)){z.a=3;break e}var ct;if(ct=Y)t:{var zr,ln,In,wr=z,Ii=Z,ei=ee,Ir=De,di=F,Ti=wr.m,Er=wr.s,Ln=[null],Hn=1,Sr=0,Gn=fg[Ir];n:for(;;){if(di&&J(Ti,1)){var Or=J(Ti,3)+2,Fr=He(Ii,Or),ur=He(ei,Or),oo=Fr*ur;if(!cs(Fr,ur,0,wr,Ln))break n;for(Ln=Ln[0],Er.xc=Or,zr=0;zr<oo;++zr){var rr=Ln[zr]>>8&65535;Ln[zr]=rr,rr>=Hn&&(Hn=rr+1)}}if(Ti.h)break n;for(ln=0;5>ln;++ln){var lr=Ml[ln];!ln&&0<Ir&&(lr+=1<<Ir),Sr<lr&&(Sr=lr)}var ti=s(Hn*Gn,j),ji=Hn,Go=s(ji,ue);if(Go==null)var Wr=null;else e(65536>=ji),Wr=Go;var qr=o(Sr);if(Wr==null||qr==null||ti==null){wr.a=1;break n}var so=ti;for(zr=In=0;zr<Hn;++zr){var cr=Wr[zr],ao=cr.G,Os=cr.H,oa=0,ki=1,Hr=0;for(ln=0;5>ln;++ln){lr=Ml[ln],ao[ln]=so,Os[ln]=In,!ln&&0<Ir&&(lr+=1<<Ir);i:{var Hu,au=lr,Sc=wr,Oa=qr,vg=so,Cp=In,xr=0,sa=Sc.m,Ip=J(sa,1);if(i(Oa,0,0,au),Ip){var Tp=J(sa,1)+1,Of=J(sa,1),Ff=J(sa,Of==0?1:8);Oa[Ff]=1,Tp==2&&(Oa[Ff=J(sa,8)]=1);var Fa=1}else{var Ar=o(19),ni=J(sa,4)+4;if(19<ni){Sc.a=3;var Gr=0;break i}for(Hu=0;Hu<ni;++Hu)Ar[A1[Hu]]=J(sa,3);var Ac=void 0,uu=void 0,Cc=Sc,R1=Ar,pi=au,Bf=Oa,Mh=0,Ba=Cc.m,aa=8,bs=s(128,j);r:for(;O(bs,0,7,R1,19);){if(J(Ba,1)){var Oh=2+2*J(Ba,3);if((Ac=2+J(Ba,Oh))>pi)break r}else Ac=pi;for(uu=0;uu<pi&&Ac--;){we(Ba);var Vf=bs[0+(127&ne(Ba))];ve(Ba,Ba.u+Vf.g);var Gu=Vf.value;if(16>Gu)Bf[uu++]=Gu,Gu!=0&&(aa=Gu);else{var yg=Gu==16,kp=Gu-16,wg=Df[kp],Np=J(Ba,Rh[kp])+wg;if(uu+Np>pi)break r;for(var bg=yg?aa:0;0<Np--;)Bf[uu++]=bg}}Mh=1;break r}Mh||(Cc.a=3),Fa=Mh}(Fa=Fa&&!sa.h)&&(xr=O(vg,Cp,8,Oa,au)),Fa&&xr!=0?Gr=xr:(Sc.a=3,Gr=0)}if(Gr==0)break n;if(ki&&hg[ln]==1&&(ki=so[In].g==0),oa+=so[In].g,In+=Gr,3>=ln){var Ic,jf=qr[0];for(Ic=1;Ic<lr;++Ic)qr[Ic]>jf&&(jf=qr[Ic]);Hr+=jf}}if(cr.nd=ki,cr.Qb=0,ki&&(cr.qb=(ao[3][Os[3]+0].value<<24|ao[1][Os[1]+0].value<<16|ao[2][Os[2]+0].value)>>>0,oa==0&&256>ao[0][Os[0]+0].value&&(cr.Qb=1,cr.qb+=ao[0][Os[0]+0].value<<8)),cr.jc=!cr.Qb&&6>Hr,cr.jc){var Fh,xs=cr;for(Fh=0;Fh<Ds;++Fh){var lu=Fh,ua=xs.pd[lu],jl=xs.G[0][xs.H[0]+lu];256<=jl.value?(ua.g=jl.g+256,ua.value=jl.value):(ua.g=0,ua.value=0,lu>>=or(jl,8,ua),lu>>=or(xs.G[1][xs.H[1]+lu],16,ua),lu>>=or(xs.G[2][xs.H[2]+lu],0,ua),or(xs.G[3][xs.H[3]+lu],24,ua))}}}Er.vc=Ln,Er.Wb=Hn,Er.Ya=Wr,Er.yc=ti,ct=1;break t}ct=0}if(!(Y=ct)){z.a=3;break e}if(0<De){if(ce.ua=1<<De,!te(ce.Wa,De)){z.a=1,Y=0;break e}}else ce.ua=0;var Uf=z,zf=Z,xg=ee,Wf=Uf.s,qf=Wf.xc;if(Uf.c=zf,Uf.i=xg,Wf.md=He(zf,qf),Wf.wc=qf==0?-1:(1<<qf)-1,F){z.xb=Ma;break e}if((_e=o(Z*ee))==null){z.a=1,Y=0;break e}Y=(Y=yo(z,_e,0,Z,ee,ee,null))&&!ie.h;break e}return Y?(G!=null?G[0]=_e:(e(_e==null),e(F)),z.$=0,F||wo(ce)):wo(ce),Y}function hs(v,S){var F=v.c*v.i,z=F+S+16*S;return e(v.c<=S),v.V=o(z),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+F+S,1)}function _a(v,S){var F=v.C,z=S-F,G=v.V,Y=v.Ba+v.c*F;for(e(S<=v.l.o);0<z;){var Z=16<z?16:z,ee=v.l.ma,ie=v.l.width,ce=ie*Z,_e=ee.ca,De=ee.tb+ie*F,de=v.Ta,Ae=v.Ua;Ei(v,Z,G,Y),mp(de,Ae,_e,De,ce),Fo(ee,F,F+Z,_e,De,ie),z-=Z,G+=Z*v.c,F+=Z}e(F==S),v.C=v.Ma=S}function Xs(){this.ub=this.yd=this.td=this.Rb=0}function Cs(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ys(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Qn(){this.Yb=(function(){var v=[];return(function S(F,z,G){for(var Y=G[z],Z=0;Z<Y&&(F.push(G.length>z+1?[]:0),!(G.length<z+1));Z++)S(F[Z],z+1,G)})(v,0,[3,11]),v})()}function cc(){this.jb=o(3),this.Wc=a([4,8],Qn),this.Xc=a([4,17],Qn)}function Ka(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function Qi(){this.ld=this.La=this.dd=this.tc=0}function Qs(){this.Na=this.la=0}function Nu(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ea(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Sa(){this.uc=this.M=this.Nb=0,this.wa=Array(new Qi),this.Y=0,this.ya=Array(new Ea),this.aa=0,this.l=new bo}function Ji(){this.y=o(16),this.f=o(8),this.ea=o(8)}function xl(){this.cb=this.a=0,this.sc="",this.m=new W,this.Od=new Xs,this.Kc=new Cs,this.ed=new Ka,this.Qa=new Ys,this.Ic=this.$c=this.Aa=0,this.D=new Sa,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,W),this.ia=0,this.pb=s(4,Nu),this.Pa=new cc,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ji),this.Hd=0,this.rb=Array(new Qs),this.sb=0,this.wa=Array(new Qi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ea),this.L=this.aa=0,this.gd=a([4,2],Qi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Pr(v,S){return 0>v?0:v>S?S:v}function bo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Bo(){var v=new xl;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,Ol||(Ol=Tn)),v}function pr(v,S,F){return v.a==0&&(v.a=S,v.sc=F,v.cb=0),0}function fs(v,S,F){return 3<=F&&v[S+0]==157&&v[S+1]==1&&v[S+2]==42}function Oi(v,S){if(v==null)return 0;if(v.a=0,v.sc="OK",S==null)return pr(v,2,"null VP8Io passed to VP8GetHeaders()");var F=S.data,z=S.w,G=S.ha;if(4>G)return pr(v,7,"Truncated header.");var Y=F[z+0]|F[z+1]<<8|F[z+2]<<16,Z=v.Od;if(Z.Rb=!(1&Y),Z.td=Y>>1&7,Z.yd=Y>>4&1,Z.ub=Y>>5,3<Z.td)return pr(v,3,"Incorrect keyframe parameters.");if(!Z.yd)return pr(v,4,"Frame not displayable.");z+=3,G-=3;var ee=v.Kc;if(Z.Rb){if(7>G)return pr(v,7,"cannot parse picture header");if(!fs(F,z,G))return pr(v,3,"Bad code word");ee.c=16383&(F[z+4]<<8|F[z+3]),ee.Td=F[z+4]>>6,ee.i=16383&(F[z+6]<<8|F[z+5]),ee.Ud=F[z+6]>>6,z+=7,G-=7,v.za=ee.c+15>>4,v.Ub=ee.i+15>>4,S.width=ee.c,S.height=ee.i,S.Da=0,S.j=0,S.v=0,S.va=S.width,S.o=S.height,S.da=0,S.ib=S.width,S.hb=S.height,S.U=S.width,S.T=S.height,i((Y=v.Pa).jb,0,255,Y.jb.length),e((Y=v.Qa)!=null),Y.Cb=0,Y.Bb=0,Y.Fb=1,i(Y.Zb,0,0,Y.Zb.length),i(Y.Lb,0,0,Y.Lb)}if(Z.ub>G)return pr(v,7,"bad partition length");ge(Y=v.m,F,z,Z.ub),z+=Z.ub,G-=Z.ub,Z.Rb&&(ee.Ld=Ce(Y),ee.Kd=Ce(Y)),ee=v.Qa;var ie,ce=v.Pa;if(e(Y!=null),e(ee!=null),ee.Cb=Ce(Y),ee.Cb){if(ee.Bb=Ce(Y),Ce(Y)){for(ee.Fb=Ce(Y),ie=0;4>ie;++ie)ee.Zb[ie]=Ce(Y)?$(Y,7):0;for(ie=0;4>ie;++ie)ee.Lb[ie]=Ce(Y)?$(Y,6):0}if(ee.Bb)for(ie=0;3>ie;++ie)ce.jb[ie]=Ce(Y)?he(Y,8):255}else ee.Bb=0;if(Y.Ka)return pr(v,3,"cannot parse segment header");if((ee=v.ed).zd=Ce(Y),ee.Tb=he(Y,6),ee.wb=he(Y,3),ee.Pc=Ce(Y),ee.Pc&&Ce(Y)){for(ce=0;4>ce;++ce)Ce(Y)&&(ee.vd[ce]=$(Y,6));for(ce=0;4>ce;++ce)Ce(Y)&&(ee.od[ce]=$(Y,6))}if(v.L=ee.Tb==0?0:ee.zd?1:2,Y.Ka)return pr(v,3,"cannot parse filter header");var _e=G;if(G=ie=z,z=ie+_e,ee=_e,v.Xb=(1<<he(v.m,2))-1,_e<3*(ce=v.Xb))F=7;else{for(ie+=3*ce,ee-=3*ce,_e=0;_e<ce;++_e){var De=F[G+0]|F[G+1]<<8|F[G+2]<<16;De>ee&&(De=ee),ge(v.Jc[+_e],F,ie,De),ie+=De,ee-=De,G+=3}ge(v.Jc[+ce],F,ie,ee),F=ie<z?0:5}if(F!=0)return pr(v,F,"cannot parse partitions");for(F=he(ie=v.m,7),G=Ce(ie)?$(ie,4):0,z=Ce(ie)?$(ie,4):0,ee=Ce(ie)?$(ie,4):0,ce=Ce(ie)?$(ie,4):0,ie=Ce(ie)?$(ie,4):0,_e=v.Qa,De=0;4>De;++De){if(_e.Cb){var de=_e.Zb[De];_e.Fb||(de+=F)}else{if(0<De){v.pb[De]=v.pb[0];continue}de=F}var Ae=v.pb[De];Ae.Sc[0]=bc[Pr(de+G,127)],Ae.Sc[1]=Ph[Pr(de+0,127)],Ae.Eb[0]=2*bc[Pr(de+z,127)],Ae.Eb[1]=101581*Ph[Pr(de+ee,127)]>>16,8>Ae.Eb[1]&&(Ae.Eb[1]=8),Ae.Qc[0]=bc[Pr(de+ce,117)],Ae.Qc[1]=Ph[Pr(de+ie,127)],Ae.lc=de+ie}if(!Z.Rb)return pr(v,4,"Not a key frame.");for(Ce(Y),Z=v.Pa,F=0;4>F;++F){for(G=0;8>G;++G)for(z=0;3>z;++z)for(ee=0;11>ee;++ee)ce=Fe(Y,T1[F][G][z][ee])?he(Y,8):pg[F][G][z][ee],Z.Wc[F][G].Yb[z][ee]=ce;for(G=0;17>G;++G)Z.Xc[F][G]=Z.Wc[F][Ep[G]]}return v.kc=Ce(Y),v.kc&&(v.Bd=he(Y,8)),v.cb=1}function Tn(v,S,F,z,G,Y,Z){var ee=S[G].Yb[F];for(F=0;16>G;++G){if(!Fe(v,ee[F+0]))return G;for(;!Fe(v,ee[F+1]);)if(ee=S[++G].Yb[0],F=0,G==16)return 16;var ie=S[G+1].Yb;if(Fe(v,ee[F+2])){var ce=v,_e=0;if(Fe(ce,(de=ee)[(De=F)+3]))if(Fe(ce,de[De+6])){for(ee=0,De=2*(_e=Fe(ce,de[De+8]))+(de=Fe(ce,de[De+9+_e])),_e=0,de=xp[De];de[ee];++ee)_e+=_e+Fe(ce,de[ee]);_e+=3+(8<<De)}else Fe(ce,de[De+7])?(_e=7+2*Fe(ce,165),_e+=Fe(ce,145)):_e=5+Fe(ce,159);else _e=Fe(ce,de[De+4])?3+Fe(ce,de[De+5]):2;ee=ie[2]}else _e=1,ee=ie[1];ie=Z+_p[G],0>(ce=v).b&&Se(ce);var De,de=ce.b,Ae=(De=ce.Ca>>1)-(ce.I>>de)>>31;--ce.b,ce.Ca+=Ae,ce.Ca|=1,ce.I-=(De+1&Ae)<<de,Y[ie]=((_e^Ae)-Ae)*z[(0<G)+0]}return 16}function Is(v){var S=v.rb[v.sb-1];S.la=0,S.Na=0,i(v.zc,0,0,v.zc.length),v.ja=0}function Si(v,S,F,z,G){G=v[S+F+32*z]+(G>>3),v[S+F+32*z]=-256&G?0>G?0:255:G}function br(v,S,F,z,G,Y){Si(v,S,0,F,z+G),Si(v,S,1,F,z+Y),Si(v,S,2,F,z-Y),Si(v,S,3,F,z-G)}function ds(v){return(20091*v>>16)+v}function Ru(v,S,F,z){var G,Y=0,Z=o(16);for(G=0;4>G;++G){var ee=v[S+0]+v[S+8],ie=v[S+0]-v[S+8],ce=(35468*v[S+4]>>16)-ds(v[S+12]),_e=ds(v[S+4])+(35468*v[S+12]>>16);Z[Y+0]=ee+_e,Z[Y+1]=ie+ce,Z[Y+2]=ie-ce,Z[Y+3]=ee-_e,Y+=4,S++}for(G=Y=0;4>G;++G)ee=(v=Z[Y+0]+4)+Z[Y+8],ie=v-Z[Y+8],ce=(35468*Z[Y+4]>>16)-ds(Z[Y+12]),Si(F,z,0,0,ee+(_e=ds(Z[Y+4])+(35468*Z[Y+12]>>16))),Si(F,z,1,0,ie+ce),Si(F,z,2,0,ie-ce),Si(F,z,3,0,ee-_e),Y++,z+=32}function _l(v,S,F,z){var G=v[S+0]+4,Y=35468*v[S+4]>>16,Z=ds(v[S+4]),ee=35468*v[S+1]>>16;br(F,z,0,G+Z,v=ds(v[S+1]),ee),br(F,z,1,G+Y,v,ee),br(F,z,2,G-Y,v,ee),br(F,z,3,G-Z,v,ee)}function Xa(v,S,F,z,G){Ru(v,S,F,z),G&&Ru(v,S+16,F,z+4)}function Ts(v,S,F,z){Rl(v,S+0,F,z,1),Rl(v,S+32,F,z+128,1)}function Pu(v,S,F,z){var G;for(v=v[S+0]+4,G=0;4>G;++G)for(S=0;4>S;++S)Si(F,z,S,G,v)}function An(v,S,F,z){v[S+0]&&qn(v,S+0,F,z),v[S+16]&&qn(v,S+16,F,z+4),v[S+32]&&qn(v,S+32,F,z+128),v[S+48]&&qn(v,S+48,F,z+128+4)}function xo(v,S,F,z){var G,Y=o(16);for(G=0;4>G;++G){var Z=v[S+0+G]+v[S+12+G],ee=v[S+4+G]+v[S+8+G],ie=v[S+4+G]-v[S+8+G],ce=v[S+0+G]-v[S+12+G];Y[0+G]=Z+ee,Y[8+G]=Z-ee,Y[4+G]=ce+ie,Y[12+G]=ce-ie}for(G=0;4>G;++G)Z=(v=Y[0+4*G]+3)+Y[3+4*G],ee=Y[1+4*G]+Y[2+4*G],ie=Y[1+4*G]-Y[2+4*G],ce=v-Y[3+4*G],F[z+0]=Z+ee>>3,F[z+16]=ce+ie>>3,F[z+32]=Z-ee>>3,F[z+48]=ce-ie>>3,z+=64}function Js(v,S,F){var z,G=S-32,Y=So,Z=255-v[G-1];for(z=0;z<F;++z){var ee,ie=Y,ce=Z+v[S-1];for(ee=0;ee<F;++ee)v[S+ee]=ie[ce+v[G+ee]];S+=32}}function Du(v,S){Js(v,S,4)}function El(v,S){Js(v,S,8)}function Sl(v,S){Js(v,S,16)}function Ya(v,S){var F;for(F=0;16>F;++F)r(v,S+32*F,v,S-32,16)}function ps(v,S){var F;for(F=16;0<F;--F)i(v,S,v[S-1],16),S+=32}function Zi(v,S,F){var z;for(z=0;16>z;++z)i(S,F+32*z,v,16)}function ks(v,S){var F,z=16;for(F=0;16>F;++F)z+=v[S-1+32*F]+v[S+F-32];Zi(z>>5,v,S)}function eo(v,S){var F,z=8;for(F=0;16>F;++F)z+=v[S-1+32*F];Zi(z>>4,v,S)}function jr(v,S){var F,z=8;for(F=0;16>F;++F)z+=v[S+F-32];Zi(z>>4,v,S)}function Qa(v,S){Zi(128,v,S)}function Xt(v,S,F){return v+2*S+F+2>>2}function _o(v,S){var F,z=S-32;for(z=new Uint8Array([Xt(v[z-1],v[z+0],v[z+1]),Xt(v[z+0],v[z+1],v[z+2]),Xt(v[z+1],v[z+2],v[z+3]),Xt(v[z+2],v[z+3],v[z+4])]),F=0;4>F;++F)r(v,S+32*F,z,0,z.length)}function hc(v,S){var F=v[S-1],z=v[S-1+32],G=v[S-1+64],Y=v[S-1+96];qe(v,S+0,16843009*Xt(v[S-1-32],F,z)),qe(v,S+32,16843009*Xt(F,z,G)),qe(v,S+64,16843009*Xt(z,G,Y)),qe(v,S+96,16843009*Xt(G,Y,Y))}function Aa(v,S){var F,z=4;for(F=0;4>F;++F)z+=v[S+F-32]+v[S-1+32*F];for(z>>=3,F=0;4>F;++F)i(v,S+32*F,z,4)}function ci(v,S){var F=v[S-1+0],z=v[S-1+32],G=v[S-1+64],Y=v[S-1-32],Z=v[S+0-32],ee=v[S+1-32],ie=v[S+2-32],ce=v[S+3-32];v[S+0+96]=Xt(z,G,v[S-1+96]),v[S+1+96]=v[S+0+64]=Xt(F,z,G),v[S+2+96]=v[S+1+64]=v[S+0+32]=Xt(Y,F,z),v[S+3+96]=v[S+2+64]=v[S+1+32]=v[S+0+0]=Xt(Z,Y,F),v[S+3+64]=v[S+2+32]=v[S+1+0]=Xt(ee,Z,Y),v[S+3+32]=v[S+2+0]=Xt(ie,ee,Z),v[S+3+0]=Xt(ce,ie,ee)}function Ns(v,S){var F=v[S+1-32],z=v[S+2-32],G=v[S+3-32],Y=v[S+4-32],Z=v[S+5-32],ee=v[S+6-32],ie=v[S+7-32];v[S+0+0]=Xt(v[S+0-32],F,z),v[S+1+0]=v[S+0+32]=Xt(F,z,G),v[S+2+0]=v[S+1+32]=v[S+0+64]=Xt(z,G,Y),v[S+3+0]=v[S+2+32]=v[S+1+64]=v[S+0+96]=Xt(G,Y,Z),v[S+3+32]=v[S+2+64]=v[S+1+96]=Xt(Y,Z,ee),v[S+3+64]=v[S+2+96]=Xt(Z,ee,ie),v[S+3+96]=Xt(ee,ie,ie)}function Lu(v,S){var F=v[S-1+0],z=v[S-1+32],G=v[S-1+64],Y=v[S-1-32],Z=v[S+0-32],ee=v[S+1-32],ie=v[S+2-32],ce=v[S+3-32];v[S+0+0]=v[S+1+64]=Y+Z+1>>1,v[S+1+0]=v[S+2+64]=Z+ee+1>>1,v[S+2+0]=v[S+3+64]=ee+ie+1>>1,v[S+3+0]=ie+ce+1>>1,v[S+0+96]=Xt(G,z,F),v[S+0+64]=Xt(z,F,Y),v[S+0+32]=v[S+1+96]=Xt(F,Y,Z),v[S+1+32]=v[S+2+96]=Xt(Y,Z,ee),v[S+2+32]=v[S+3+96]=Xt(Z,ee,ie),v[S+3+32]=Xt(ee,ie,ce)}function Jn(v,S){var F=v[S+0-32],z=v[S+1-32],G=v[S+2-32],Y=v[S+3-32],Z=v[S+4-32],ee=v[S+5-32],ie=v[S+6-32],ce=v[S+7-32];v[S+0+0]=F+z+1>>1,v[S+1+0]=v[S+0+64]=z+G+1>>1,v[S+2+0]=v[S+1+64]=G+Y+1>>1,v[S+3+0]=v[S+2+64]=Y+Z+1>>1,v[S+0+32]=Xt(F,z,G),v[S+1+32]=v[S+0+96]=Xt(z,G,Y),v[S+2+32]=v[S+1+96]=Xt(G,Y,Z),v[S+3+32]=v[S+2+96]=Xt(Y,Z,ee),v[S+3+64]=Xt(Z,ee,ie),v[S+3+96]=Xt(ee,ie,ce)}function Ja(v,S){var F=v[S-1+0],z=v[S-1+32],G=v[S-1+64],Y=v[S-1+96];v[S+0+0]=F+z+1>>1,v[S+2+0]=v[S+0+32]=z+G+1>>1,v[S+2+32]=v[S+0+64]=G+Y+1>>1,v[S+1+0]=Xt(F,z,G),v[S+3+0]=v[S+1+32]=Xt(z,G,Y),v[S+3+32]=v[S+1+64]=Xt(G,Y,Y),v[S+3+64]=v[S+2+64]=v[S+0+96]=v[S+1+96]=v[S+2+96]=v[S+3+96]=Y}function Al(v,S){var F=v[S-1+0],z=v[S-1+32],G=v[S-1+64],Y=v[S-1+96],Z=v[S-1-32],ee=v[S+0-32],ie=v[S+1-32],ce=v[S+2-32];v[S+0+0]=v[S+2+32]=F+Z+1>>1,v[S+0+32]=v[S+2+64]=z+F+1>>1,v[S+0+64]=v[S+2+96]=G+z+1>>1,v[S+0+96]=Y+G+1>>1,v[S+3+0]=Xt(ee,ie,ce),v[S+2+0]=Xt(Z,ee,ie),v[S+1+0]=v[S+3+32]=Xt(F,Z,ee),v[S+1+32]=v[S+3+64]=Xt(z,F,Z),v[S+1+64]=v[S+3+96]=Xt(G,z,F),v[S+1+96]=Xt(Y,G,z)}function Vo(v,S){var F;for(F=0;8>F;++F)r(v,S+32*F,v,S-32,8)}function Ca(v,S){var F;for(F=0;8>F;++F)i(v,S,v[S-1],8),S+=32}function Fi(v,S,F){var z;for(z=0;8>z;++z)i(S,F+32*z,v,8)}function Zs(v,S){var F,z=8;for(F=0;8>F;++F)z+=v[S+F-32]+v[S-1+32*F];Fi(z>>4,v,S)}function jo(v,S){var F,z=4;for(F=0;8>F;++F)z+=v[S+F-32];Fi(z>>3,v,S)}function Mu(v,S){var F,z=4;for(F=0;8>F;++F)z+=v[S-1+32*F];Fi(z>>3,v,S)}function Ou(v,S){Fi(128,v,S)}function Ai(v,S,F){var z=v[S-F],G=v[S+0],Y=3*(G-z)+La[1020+v[S-2*F]-v[S+F]],Z=yc[112+(Y+4>>3)];v[S-F]=So[255+z+yc[112+(Y+3>>3)]],v[S+0]=So[255+G-Z]}function Ia(v,S,F,z){var G=v[S+0],Y=v[S+F];return Ls[255+v[S-2*F]-v[S-F]]>z||Ls[255+Y-G]>z}function ea(v,S,F,z){return 4*Ls[255+v[S-F]-v[S+0]]+Ls[255+v[S-2*F]-v[S+F]]<=z}function Bi(v,S,F,z,G){var Y=v[S-3*F],Z=v[S-2*F],ee=v[S-F],ie=v[S+0],ce=v[S+F],_e=v[S+2*F],De=v[S+3*F];return 4*Ls[255+ee-ie]+Ls[255+Z-ce]>z?0:Ls[255+v[S-4*F]-Y]<=G&&Ls[255+Y-Z]<=G&&Ls[255+Z-ee]<=G&&Ls[255+De-_e]<=G&&Ls[255+_e-ce]<=G&&Ls[255+ce-ie]<=G}function Rs(v,S,F,z){var G=2*z+1;for(z=0;16>z;++z)ea(v,S+z,F,G)&&Ai(v,S+z,F)}function ms(v,S,F,z){var G=2*z+1;for(z=0;16>z;++z)ea(v,S+z*F,1,G)&&Ai(v,S+z*F,1)}function Cl(v,S,F,z){var G;for(G=3;0<G;--G)Rs(v,S+=4*F,F,z)}function Ta(v,S,F,z){var G;for(G=3;0<G;--G)ms(v,S+=4,F,z)}function Ci(v,S,F,z,G,Y,Z,ee){for(Y=2*Y+1;0<G--;){if(Bi(v,S,F,Y,Z))if(Ia(v,S,F,ee))Ai(v,S,F);else{var ie=v,ce=S,_e=F,De=ie[ce-2*_e],de=ie[ce-_e],Ae=ie[ce+0],Pe=ie[ce+_e],Ke=ie[ce+2*_e],Me=27*(Ge=La[1020+3*(Ae-de)+La[1020+De-Pe]])+63>>7,We=18*Ge+63>>7,Ge=9*Ge+63>>7;ie[ce-3*_e]=So[255+ie[ce-3*_e]+Ge],ie[ce-2*_e]=So[255+De+We],ie[ce-_e]=So[255+de+Me],ie[ce+0]=So[255+Ae-Me],ie[ce+_e]=So[255+Pe-We],ie[ce+2*_e]=So[255+Ke-Ge]}S+=z}}function gs(v,S,F,z,G,Y,Z,ee){for(Y=2*Y+1;0<G--;){if(Bi(v,S,F,Y,Z))if(Ia(v,S,F,ee))Ai(v,S,F);else{var ie=v,ce=S,_e=F,De=ie[ce-_e],de=ie[ce+0],Ae=ie[ce+_e],Pe=yc[112+(4+(Ke=3*(de-De))>>3)],Ke=yc[112+(Ke+3>>3)],Me=Pe+1>>1;ie[ce-2*_e]=So[255+ie[ce-2*_e]+Me],ie[ce-_e]=So[255+De+Ke],ie[ce+0]=So[255+de-Pe],ie[ce+_e]=So[255+Ae-Me]}S+=z}}function hi(v,S,F,z,G,Y){Ci(v,S,F,1,16,z,G,Y)}function to(v,S,F,z,G,Y){Ci(v,S,1,F,16,z,G,Y)}function ka(v,S,F,z,G,Y){var Z;for(Z=3;0<Z;--Z)gs(v,S+=4*F,F,1,16,z,G,Y)}function N(v,S,F,z,G,Y){var Z;for(Z=3;0<Z;--Z)gs(v,S+=4,1,F,16,z,G,Y)}function H(v,S,F,z,G,Y,Z,ee){Ci(v,S,G,1,8,Y,Z,ee),Ci(F,z,G,1,8,Y,Z,ee)}function pe(v,S,F,z,G,Y,Z,ee){Ci(v,S,1,G,8,Y,Z,ee),Ci(F,z,1,G,8,Y,Z,ee)}function be(v,S,F,z,G,Y,Z,ee){gs(v,S+4*G,G,1,8,Y,Z,ee),gs(F,z+4*G,G,1,8,Y,Z,ee)}function ke(v,S,F,z,G,Y,Z,ee){gs(v,S+4,1,G,8,Y,Z,ee),gs(F,z+4,1,G,8,Y,Z,ee)}function Xe(){this.ba=new Dt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Cn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function et(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function wt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function It(){this.ua=0,this.Wa=new zt,this.vb=new zt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ue,this.yc=new j}function Zt(){this.xb=this.a=0,this.l=new bo,this.ca=new Dt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Q,this.Pb=0,this.wd=new Q,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new It,this.ab=0,this.gc=s(4,wt),this.Oc=0}function Ft(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new bo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function kn(v,S,F,z,G,Y,Z){for(v=v==null?0:v[S+0],S=0;S<Z;++S)G[Y+S]=v+F[z+S]&255,v=G[Y+S]}function mr(v,S,F,z,G,Y,Z){var ee;if(v==null)kn(null,null,F,z,G,Y,Z);else for(ee=0;ee<Z;++ee)G[Y+ee]=v[S+ee]+F[z+ee]&255}function sr(v,S,F,z,G,Y,Z){if(v==null)kn(null,null,F,z,G,Y,Z);else{var ee,ie=v[S+0],ce=ie,_e=ie;for(ee=0;ee<Z;++ee)ce=_e+(ie=v[S+ee])-ce,_e=F[z+ee]+(-256&ce?0>ce?0:255:ce)&255,ce=ie,G[Y+ee]=_e}}function w(v,S,F,z){var G=S.width,Y=S.o;if(e(v!=null&&S!=null),0>F||0>=z||F+z>Y)return null;if(!v.Cc){if(v.ga==null){var Z;if(v.ga=new Ft,(Z=v.ga==null)||(Z=S.width*S.o,e(v.Gb.length==0),v.Gb=o(Z),v.Uc=0,v.Gb==null?Z=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,Z=1),Z=!Z),!Z){Z=v.ga;var ee=v.Fa,ie=v.P,ce=v.qc,_e=v.mb,De=v.nb,de=ie+1,Ae=ce-1,Pe=Z.l;if(e(ee!=null&&_e!=null&&S!=null),io[0]=null,io[1]=kn,io[2]=mr,io[3]=sr,Z.ca=_e,Z.tb=De,Z.c=S.width,Z.i=S.height,e(0<Z.c&&0<Z.i),1>=ce)S=0;else if(Z.$a=3&ee[ie+0],Z.Z=ee[ie+0]>>2&3,Z.Lc=ee[ie+0]>>4&3,ie=ee[ie+0]>>6&3,0>Z.$a||1<Z.$a||4<=Z.Z||1<Z.Lc||ie)S=0;else if(Pe.put=Kt,Pe.ac=ui,Pe.bc=go,Pe.ma=Z,Pe.width=S.width,Pe.height=S.height,Pe.Da=S.Da,Pe.v=S.v,Pe.va=S.va,Pe.j=S.j,Pe.o=S.o,Z.$a)e:{e(Z.$a==1),S=xa();t:for(;;){if(S==null){S=0;break e}if(e(Z!=null),Z.mc=S,S.c=Z.c,S.i=Z.i,S.l=Z.l,S.l.ma=Z,S.l.width=Z.c,S.l.height=Z.i,S.a=0,le(S.m,ee,de,Ae),!cs(Z.c,Z.i,1,S,null)||(S.ab==1&&S.gc[0].hc==3&&Oo(S.s)?(Z.ic=1,ee=S.c*S.i,S.Ta=null,S.Ua=0,S.V=o(ee),S.Ba=0,S.V==null?(S.a=1,S=0):S=1):(Z.ic=0,S=hs(S,Z.c)),!S))break t;S=1;break e}Z.mc=null,S=0}else S=Ae>=Z.c*Z.i;Z=!S}if(Z)return null;v.ga.Lc!=1?v.Ga=0:z=Y-F}e(v.ga!=null),e(F+z<=Y);e:{if(S=(ee=v.ga).c,Y=ee.l.o,ee.$a==0){if(de=v.rc,Ae=v.Vc,Pe=v.Fa,ie=v.P+1+F*S,ce=v.mb,_e=v.nb+F*S,e(ie<=v.P+v.qc),ee.Z!=0)for(e(io[ee.Z]!=null),Z=0;Z<z;++Z)io[ee.Z](de,Ae,Pe,ie,ce,_e,S),de=ce,Ae=_e,_e+=S,ie+=S;else for(Z=0;Z<z;++Z)r(ce,_e,Pe,ie,S),de=ce,Ae=_e,_e+=S,ie+=S;v.rc=de,v.Vc=Ae}else{if(e(ee.mc!=null),S=F+z,e((Z=ee.mc)!=null),e(S<=Z.i),Z.C>=S)S=1;else if(ee.ic||Ve(),ee.ic){ee=Z.V,de=Z.Ba,Ae=Z.c;var Ke=Z.i,Me=(Pe=1,ie=Z.$/Ae,ce=Z.$%Ae,_e=Z.m,De=Z.s,Z.$),We=Ae*Ke,Ge=Ae*S,Je=De.wc,Ze=Me<Ge?Rr(De,ce,ie):null;e(Me<=We),e(S<=Ke),e(Oo(De));t:for(;;){for(;!_e.h&&Me<Ge;){if(ce&Je||(Ze=Rr(De,ce,ie)),e(Ze!=null),we(_e),256>(Ke=Xn(Ze.G[0],Ze.H[0],_e)))ee[de+Me]=Ke,++Me,++ce>=Ae&&(ce=0,++ie<=S&&!(ie%16)&&Vr(Z,ie));else{if(!(280>Ke)){Pe=0;break t}Ke=li(Ke-256,_e);var Lt,bt=Xn(Ze.G[4],Ze.H[4],_e);if(we(_e),!(Me>=(bt=vo(Ae,bt=li(bt,_e)))&&We-Me>=Ke)){Pe=0;break t}for(Lt=0;Lt<Ke;++Lt)ee[de+Me+Lt]=ee[de+Me+Lt-bt];for(Me+=Ke,ce+=Ke;ce>=Ae;)ce-=Ae,++ie<=S&&!(ie%16)&&Vr(Z,ie);Me<Ge&&ce&Je&&(Ze=Rr(De,ce,ie))}e(_e.h==fe(_e))}Vr(Z,ie>S?S:ie);break t}!Pe||_e.h&&Me<We?(Pe=0,Z.a=_e.h?5:3):Z.$=Me,S=Pe}else S=yo(Z,Z.V,Z.Ba,Z.c,Z.i,S,_a);if(!S){z=0;break e}}F+z>=Y&&(v.Cc=1),z=1}if(!z)return null;if(v.Cc&&((z=v.ga)!=null&&(z.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+F*G}function B(v,S,F,z,G,Y){for(;0<G--;){var Z,ee=v,ie=S+(F?1:0),ce=v,_e=S+(F?0:3);for(Z=0;Z<z;++Z){var De=ce[_e+4*Z];De!=255&&(De*=32897,ee[ie+4*Z+0]=ee[ie+4*Z+0]*De>>23,ee[ie+4*Z+1]=ee[ie+4*Z+1]*De>>23,ee[ie+4*Z+2]=ee[ie+4*Z+2]*De>>23)}S+=Y}}function q(v,S,F,z,G){for(;0<z--;){var Y;for(Y=0;Y<F;++Y){var Z=v[S+2*Y+0],ee=15&(ce=v[S+2*Y+1]),ie=4369*ee,ce=(240&ce|ce>>4)*ie>>16;v[S+2*Y+0]=(240&Z|Z>>4)*ie>>16&240|(15&Z|Z<<4)*ie>>16>>4&15,v[S+2*Y+1]=240&ce|ee}S+=G}}function re(v,S,F,z,G,Y,Z,ee){var ie,ce,_e=255;for(ce=0;ce<G;++ce){for(ie=0;ie<z;++ie){var De=v[S+ie];Y[Z+4*ie]=De,_e&=De}S+=F,Z+=ee}return _e!=255}function Re(v,S,F,z,G){var Y;for(Y=0;Y<G;++Y)F[z+Y]=v[S+Y]>>8}function Ve(){Dl=B,pp=q,Ch=re,mp=Re}function at(v,S,F){A[v]=function(z,G,Y,Z,ee,ie,ce,_e,De,de,Ae,Pe,Ke,Me,We,Ge,Je){var Ze,Lt=Je-1>>1,bt=ee[ie+0]|ce[_e+0]<<16,gn=De[de+0]|Ae[Pe+0]<<16;e(z!=null);var Ct=3*bt+gn+131074>>2;for(S(z[G+0],255&Ct,Ct>>16,Ke,Me),Y!=null&&(Ct=3*gn+bt+131074>>2,S(Y[Z+0],255&Ct,Ct>>16,We,Ge)),Ze=1;Ze<=Lt;++Ze){var Rn=ee[ie+Ze]|ce[_e+Ze]<<16,Mr=De[de+Ze]|Ae[Pe+Ze]<<16,yn=bt+Rn+gn+Mr+524296,xt=yn+2*(Rn+gn)>>3;Ct=xt+bt>>1,bt=(yn=yn+2*(bt+Mr)>>3)+Rn>>1,S(z[G+2*Ze-1],255&Ct,Ct>>16,Ke,Me+(2*Ze-1)*F),S(z[G+2*Ze-0],255&bt,bt>>16,Ke,Me+(2*Ze-0)*F),Y!=null&&(Ct=yn+gn>>1,bt=xt+Mr>>1,S(Y[Z+2*Ze-1],255&Ct,Ct>>16,We,Ge+(2*Ze-1)*F),S(Y[Z+2*Ze+0],255&bt,bt>>16,We,Ge+(2*Ze+0)*F)),bt=Rn,gn=Mr}1&Je||(Ct=3*bt+gn+131074>>2,S(z[G+Je-1],255&Ct,Ct>>16,Ke,Me+(Je-1)*F),Y!=null&&(Ct=3*gn+bt+131074>>2,S(Y[Z+Je-1],255&Ct,Ct>>16,We,Ge+(Je-1)*F)))}}function on(){Wo[Rf]=k1,Wo[zu]=Wu,Wo[cg]=N1,Wo[Ih]=_c,Wo[Th]=Fl,Wo[ar]=Dh,Wo[Pf]=Sp,Wo[wc]=Wu,Wo[Ll]=_c,Wo[kh]=Fl,Wo[Nh]=Dh}function gr(v){return v&-16384?0>v?0:255:v>>qu}function Nn(v,S){return gr((19077*v>>8)+(26149*S>>8)-14234)}function vr(v,S,F){return gr((19077*v>>8)-(6419*S>>8)-(13320*F>>8)+8708)}function fi(v,S){return gr((19077*v>>8)+(33050*S>>8)-17685)}function no(v,S,F,z,G){z[G+0]=Nn(v,F),z[G+1]=vr(v,S,F),z[G+2]=fi(v,S)}function yr(v,S,F,z,G){z[G+0]=fi(v,S),z[G+1]=vr(v,S,F),z[G+2]=Nn(v,F)}function ro(v,S,F,z,G){var Y=vr(v,S,F);S=Y<<3&224|fi(v,S)>>3,z[G+0]=248&Nn(v,F)|Y>>5,z[G+1]=S}function Ps(v,S,F,z,G){var Y=240&fi(v,S)|15;z[G+0]=240&Nn(v,F)|vr(v,S,F)>>4,z[G+1]=Y}function Za(v,S,F,z,G){z[G+0]=255,no(v,S,F,z,G+1)}function Eh(v,S,F,z,G){yr(v,S,F,z,G),z[G+3]=255}function Eo(v,S,F,z,G){no(v,S,F,z,G),z[G+3]=255}function ta(v,S,F){A[v]=function(z,G,Y,Z,ee,ie,ce,_e,De){for(var de=_e+(-2&De)*F;_e!=de;)S(z[G+0],Y[Z+0],ee[ie+0],ce,_e),S(z[G+1],Y[Z+0],ee[ie+0],ce,_e+F),G+=2,++Z,++ie,_e+=2*F;1&De&&S(z[G+0],Y[Z+0],ee[ie+0],ce,_e)}}function Na(v,S,F){return F==0?v==0?S==0?6:5:S==0?4:0:F}function Tf(v,S,F,z,G){switch(v>>>30){case 3:Rl(S,F,z,G,0);break;case 2:Dr(S,F,z,G);break;case 1:qn(S,F,z,G)}}function vs(v,S){var F,z,G=S.M,Y=S.Nb,Z=v.oc,ee=v.pc+40,ie=v.oc,ce=v.pc+584,_e=v.oc,De=v.pc+600;for(F=0;16>F;++F)Z[ee+32*F-1]=129;for(F=0;8>F;++F)ie[ce+32*F-1]=129,_e[De+32*F-1]=129;for(0<G?Z[ee-1-32]=ie[ce-1-32]=_e[De-1-32]=129:(i(Z,ee-32-1,127,21),i(ie,ce-32-1,127,9),i(_e,De-32-1,127,9)),z=0;z<v.za;++z){var de=S.ya[S.aa+z];if(0<z){for(F=-1;16>F;++F)r(Z,ee+32*F-4,Z,ee+32*F+12,4);for(F=-1;8>F;++F)r(ie,ce+32*F-4,ie,ce+32*F+4,4),r(_e,De+32*F-4,_e,De+32*F+4,4)}var Ae=v.Gd,Pe=v.Hd+z,Ke=de.ad,Me=de.Hc;if(0<G&&(r(Z,ee-32,Ae[Pe].y,0,16),r(ie,ce-32,Ae[Pe].f,0,8),r(_e,De-32,Ae[Pe].ea,0,8)),de.Za){var We=Z,Ge=ee-32+16;for(0<G&&(z>=v.za-1?i(We,Ge,Ae[Pe].y[15],4):r(We,Ge,Ae[Pe+1].y,0,4)),F=0;4>F;F++)We[Ge+128+F]=We[Ge+256+F]=We[Ge+384+F]=We[Ge+0+F];for(F=0;16>F;++F,Me<<=2)We=Z,Ge=ee+Ap[F],Ms[de.Ob[F]](We,Ge),Tf(Me,Ke,16*+F,We,Ge)}else if(We=Na(z,G,de.Ob[0]),Ao[We](Z,ee),Me!=0)for(F=0;16>F;++F,Me<<=2)Tf(Me,Ke,16*+F,Z,ee+Ap[F]);for(F=de.Gc,We=Na(z,G,de.Dd),zo[We](ie,ce),zo[We](_e,De),Me=Ke,We=ie,Ge=ce,255&(de=0|F)&&(170&de?Uo(Me,256,We,Ge):tr(Me,256,We,Ge)),de=_e,Me=De,255&(F>>=8)&&(170&F?Uo(Ke,320,de,Me):tr(Ke,320,de,Me)),G<v.Ub-1&&(r(Ae[Pe].y,0,Z,ee+480,16),r(Ae[Pe].f,0,ie,ce+224,8),r(Ae[Pe].ea,0,_e,De+224,8)),F=8*Y*v.B,Ae=v.sa,Pe=v.ta+16*z+16*Y*v.R,Ke=v.qa,de=v.ra+8*z+F,Me=v.Ha,We=v.Ia+8*z+F,F=0;16>F;++F)r(Ae,Pe+F*v.R,Z,ee+32*F,16);for(F=0;8>F;++F)r(Ke,de+F*v.B,ie,ce+32*F,8),r(Me,We+F*v.B,_e,De+32*F,8)}}function Fu(v,S,F,z,G,Y,Z,ee,ie){var ce=[0],_e=[0],De=0,de=ie!=null?ie.kd:0,Ae=ie??new et;if(v==null||12>F)return 7;Ae.data=v,Ae.w=S,Ae.ha=F,S=[S],F=[F],Ae.gb=[Ae.gb];e:{var Pe=S,Ke=F,Me=Ae.gb;if(e(v!=null),e(Ke!=null),e(Me!=null),Me[0]=0,12<=Ke[0]&&!t(v,Pe[0],"RIFF")){if(t(v,Pe[0]+8,"WEBP")){Me=3;break e}var We=Qe(v,Pe[0]+4);if(12>We||4294967286<We){Me=3;break e}if(de&&We>Ke[0]-8){Me=7;break e}Me[0]=We,Pe[0]+=12,Ke[0]-=12}Me=0}if(Me!=0)return Me;for(We=0<Ae.gb[0],F=F[0];;){e:{var Ge=v;Ke=S,Me=F;var Je=ce,Ze=_e,Lt=Pe=[0];if((Ct=De=[De])[0]=0,8>Me[0])Me=7;else{if(!t(Ge,Ke[0],"VP8X")){if(Qe(Ge,Ke[0]+4)!=10){Me=3;break e}if(18>Me[0]){Me=7;break e}var bt=Qe(Ge,Ke[0]+8),gn=1+Oe(Ge,Ke[0]+12);if(2147483648<=gn*(Ge=1+Oe(Ge,Ke[0]+15))){Me=3;break e}Lt!=null&&(Lt[0]=bt),Je!=null&&(Je[0]=gn),Ze!=null&&(Ze[0]=Ge),Ke[0]+=18,Me[0]-=18,Ct[0]=1}Me=0}}if(De=De[0],Pe=Pe[0],Me!=0)return Me;if(Ke=!!(2&Pe),!We&&De)return 3;if(Y!=null&&(Y[0]=!!(16&Pe)),Z!=null&&(Z[0]=Ke),ee!=null&&(ee[0]=0),Z=ce[0],Pe=_e[0],De&&Ke&&ie==null){Me=0;break}if(4>F){Me=7;break}if(We&&De||!We&&!De&&!t(v,S[0],"ALPH")){F=[F],Ae.na=[Ae.na],Ae.P=[Ae.P],Ae.Sa=[Ae.Sa];e:{bt=v,Me=S,We=F;var Ct=Ae.gb;Je=Ae.na,Ze=Ae.P,Lt=Ae.Sa,gn=22,e(bt!=null),e(We!=null),Ge=Me[0];var Rn=We[0];for(e(Je!=null),e(Lt!=null),Je[0]=null,Ze[0]=null,Lt[0]=0;;){if(Me[0]=Ge,We[0]=Rn,8>Rn){Me=7;break e}var Mr=Qe(bt,Ge+4);if(4294967286<Mr){Me=3;break e}var yn=8+Mr+1&-2;if(gn+=yn,0<Ct&&gn>Ct){Me=3;break e}if(!t(bt,Ge,"VP8 ")||!t(bt,Ge,"VP8L")){Me=0;break e}if(Rn[0]<yn){Me=7;break e}t(bt,Ge,"ALPH")||(Je[0]=bt,Ze[0]=Ge+8,Lt[0]=Mr),Ge+=yn,Rn-=yn}}if(F=F[0],Ae.na=Ae.na[0],Ae.P=Ae.P[0],Ae.Sa=Ae.Sa[0],Me!=0)break}F=[F],Ae.Ja=[Ae.Ja],Ae.xa=[Ae.xa];e:if(Ct=v,Me=S,We=F,Je=Ae.gb[0],Ze=Ae.Ja,Lt=Ae.xa,bt=Me[0],Ge=!t(Ct,bt,"VP8 "),gn=!t(Ct,bt,"VP8L"),e(Ct!=null),e(We!=null),e(Ze!=null),e(Lt!=null),8>We[0])Me=7;else{if(Ge||gn){if(Ct=Qe(Ct,bt+4),12<=Je&&Ct>Je-12){Me=3;break e}if(de&&Ct>We[0]-8){Me=7;break e}Ze[0]=Ct,Me[0]+=8,We[0]-=8,Lt[0]=gn}else Lt[0]=5<=We[0]&&Ct[bt+0]==47&&!(Ct[bt+4]>>5),Ze[0]=We[0];Me=0}if(F=F[0],Ae.Ja=Ae.Ja[0],Ae.xa=Ae.xa[0],S=S[0],Me!=0)break;if(4294967286<Ae.Ja)return 3;if(ee==null||Ke||(ee[0]=Ae.xa?2:1),Z=[Z],Pe=[Pe],Ae.xa){if(5>F){Me=7;break}ee=Z,de=Pe,Ke=Y,v==null||5>F?v=0:5<=F&&v[S+0]==47&&!(v[S+4]>>5)?(We=[0],Ct=[0],Je=[0],le(Ze=new Q,v,S,F),Yi(Ze,We,Ct,Je)?(ee!=null&&(ee[0]=We[0]),de!=null&&(de[0]=Ct[0]),Ke!=null&&(Ke[0]=Je[0]),v=1):v=0):v=0}else{if(10>F){Me=7;break}ee=Pe,v==null||10>F||!fs(v,S+3,F-3)?v=0:(de=v[S+0]|v[S+1]<<8|v[S+2]<<16,Ke=16383&(v[S+7]<<8|v[S+6]),v=16383&(v[S+9]<<8|v[S+8]),1&de||3<(de>>1&7)||!(de>>4&1)||de>>5>=Ae.Ja||!Ke||!v?v=0:(Z&&(Z[0]=Ke),ee&&(ee[0]=v),v=1))}if(!v||(Z=Z[0],Pe=Pe[0],De&&(ce[0]!=Z||_e[0]!=Pe)))return 3;ie!=null&&(ie[0]=Ae,ie.offset=S-ie.w,e(4294967286>S-ie.w),e(ie.offset==ie.ha-F));break}return Me==0||Me==7&&De&&ie==null?(Y!=null&&(Y[0]|=Ae.na!=null&&0<Ae.na.length),z!=null&&(z[0]=Z),G!=null&&(G[0]=Pe),0):Me}function fc(v,S,F){var z=S.width,G=S.height,Y=0,Z=0,ee=z,ie=G;if(S.Da=v!=null&&0<v.Da,S.Da&&(ee=v.cd,ie=v.bd,Y=v.v,Z=v.j,11>F||(Y&=-2,Z&=-2),0>Y||0>Z||0>=ee||0>=ie||Y+ee>z||Z+ie>G))return 0;if(S.v=Y,S.j=Z,S.va=Y+ee,S.o=Z+ie,S.U=ee,S.T=ie,S.da=v!=null&&0<v.da,S.da){if(!gt(ee,ie,F=[v.ib],Y=[v.hb]))return 0;S.ib=F[0],S.hb=Y[0]}return S.ob=v!=null&&v.ob,S.Kb=v==null||!v.Sd,S.da&&(S.ob=S.ib<3*z/4&&S.hb<3*G/4,S.Kb=0),1}function dc(v){if(v==null)return 2;if(11>v.S){var S=v.f.RGBA;S.fb+=(v.height-1)*S.A,S.A=-S.A}else S=v.f.kb,v=v.height,S.O+=(v-1)*S.fa,S.fa=-S.fa,S.N+=(v-1>>1)*S.Ab,S.Ab=-S.Ab,S.W+=(v-1>>1)*S.Db,S.Db=-S.Db,S.F!=null&&(S.J+=(v-1)*S.lb,S.lb=-S.lb);return 0}function eu(v,S,F,z){if(z==null||0>=v||0>=S)return 2;if(F!=null){if(F.Da){var G=F.cd,Y=F.bd,Z=-2&F.v,ee=-2&F.j;if(0>Z||0>ee||0>=G||0>=Y||Z+G>v||ee+Y>S)return 2;v=G,S=Y}if(F.da){if(!gt(v,S,G=[F.ib],Y=[F.hb]))return 2;v=G[0],S=Y[0]}}z.width=v,z.height=S;e:{var ie=z.width,ce=z.height;if(v=z.S,0>=ie||0>=ce||!(v>=Rf&&13>v))v=2;else{if(0>=z.Rd&&z.sd==null){Z=Y=G=S=0;var _e=(ee=ie*Lh[v])*ce;if(11>v||(Y=(ce+1)/2*(S=(ie+1)/2),v==12&&(Z=(G=ie)*ce)),(ce=o(_e+2*Y+Z))==null){v=1;break e}z.sd=ce,11>v?((ie=z.f.RGBA).eb=ce,ie.fb=0,ie.A=ee,ie.size=_e):((ie=z.f.kb).y=ce,ie.O=0,ie.fa=ee,ie.Fd=_e,ie.f=ce,ie.N=0+_e,ie.Ab=S,ie.Cd=Y,ie.ea=ce,ie.W=0+_e+Y,ie.Db=S,ie.Ed=Y,v==12&&(ie.F=ce,ie.J=0+_e+2*Y),ie.Tc=Z,ie.lb=G)}if(S=1,G=z.S,Y=z.width,Z=z.height,G>=Rf&&13>G)if(11>G)v=z.f.RGBA,S&=(ee=Math.abs(v.A))*(Z-1)+Y<=v.size,S&=ee>=Y*Lh[G],S&=v.eb!=null;else{v=z.f.kb,ee=(Y+1)/2,_e=(Z+1)/2,ie=Math.abs(v.fa),ce=Math.abs(v.Ab);var De=Math.abs(v.Db),de=Math.abs(v.lb),Ae=de*(Z-1)+Y;S&=ie*(Z-1)+Y<=v.Fd,S&=ce*(_e-1)+ee<=v.Cd,S=(S&=De*(_e-1)+ee<=v.Ed)&ie>=Y&ce>=ee&De>=ee,S&=v.y!=null,S&=v.f!=null,S&=v.ea!=null,G==12&&(S&=de>=Y,S&=Ae<=v.Tc,S&=v.F!=null)}else S=0;v=S?0:2}}return v!=0||F!=null&&F.fd&&(v=dc(z)),v}var Ds=64,ys=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ws=24,Bu=32,Ra=8,tu=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];lt("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(v){return v},A.Predictor2=function(v,S,F){return S[F+0]},A.Predictor3=function(v,S,F){return S[F+1]},A.Predictor4=function(v,S,F){return S[F-1]},A.Predictor5=function(v,S,F){return pt(pt(v,S[F+1]),S[F+0])},A.Predictor6=function(v,S,F){return pt(v,S[F-1])},A.Predictor7=function(v,S,F){return pt(v,S[F+0])},A.Predictor8=function(v,S,F){return pt(S[F-1],S[F+0])},A.Predictor9=function(v,S,F){return pt(S[F+0],S[F+1])},A.Predictor10=function(v,S,F){return pt(pt(v,S[F-1]),pt(S[F+0],S[F+1]))},A.Predictor11=function(v,S,F){var z=S[F+0];return 0>=Qt(z>>24&255,v>>24&255,(S=S[F-1])>>24&255)+Qt(z>>16&255,v>>16&255,S>>16&255)+Qt(z>>8&255,v>>8&255,S>>8&255)+Qt(255&z,255&v,255&S)?z:v},A.Predictor12=function(v,S,F){var z=S[F+0];return(En((v>>24&255)+(z>>24&255)-((S=S[F-1])>>24&255))<<24|En((v>>16&255)+(z>>16&255)-(S>>16&255))<<16|En((v>>8&255)+(z>>8&255)-(S>>8&255))<<8|En((255&v)+(255&z)-(255&S)))>>>0},A.Predictor13=function(v,S,F){var z=S[F-1];return($t((v=pt(v,S[F+0]))>>24&255,z>>24&255)<<24|$t(v>>16&255,z>>16&255)<<16|$t(v>>8&255,z>>8&255)<<8|$t(255&v,255&z))>>>0};var nu=A.PredictorAdd0;A.PredictorAdd1=an,lt("Predictor2","PredictorAdd2"),lt("Predictor3","PredictorAdd3"),lt("Predictor4","PredictorAdd4"),lt("Predictor5","PredictorAdd5"),lt("Predictor6","PredictorAdd6"),lt("Predictor7","PredictorAdd7"),lt("Predictor8","PredictorAdd8"),lt("Predictor9","PredictorAdd9"),lt("Predictor10","PredictorAdd10"),lt("Predictor11","PredictorAdd11"),lt("Predictor12","PredictorAdd12"),lt("Predictor13","PredictorAdd13");var Pa=A.PredictorAdd2;yt("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),yt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var Ur,Il=A.ColorIndexInverseTransform,Da=A.MapARGB,na=A.VP8LColorIndexInverseTransformAlpha,Tl=A.MapAlpha,kl=A.VP8LPredictorsAdd=[];kl.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var pc,mc,ru,Vu,ju,Nl,Uu,Rl,Dr,Uo,qn,tr,Lr,Zr,ra,Sh,gc,iu,kf,vc,Nf,dp,Ah,Pl,Dl,pp,Ch,mp,gp=o(511),vp=o(2041),yp=o(225),wp=o(767),bp=0,La=vp,yc=yp,So=wp,Ls=gp,Rf=0,zu=1,cg=2,Ih=3,Th=4,ar=5,Pf=6,wc=7,Ll=8,kh=9,Nh=10,Rh=[2,3,7],Df=[3,3,11],Ml=[280,256,256,256,40],hg=[0,1,1,1,0],A1=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],C1=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],fg=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Lf=8,bc=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ph=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ol=null,xp=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],_p=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],dg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],pg=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],I1=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],T1=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Ep=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ao=[],Ms=[],zo=[],Ma=1,xc=2,io=[],Wo=[];at("UpsampleRgbLinePair",no,3),at("UpsampleBgrLinePair",yr,3),at("UpsampleRgbaLinePair",Eo,4),at("UpsampleBgraLinePair",Eh,4),at("UpsampleArgbLinePair",Za,4),at("UpsampleRgba4444LinePair",Ps,2),at("UpsampleRgb565LinePair",ro,2);var k1=A.UpsampleRgbLinePair,N1=A.UpsampleBgrLinePair,Wu=A.UpsampleRgbaLinePair,_c=A.UpsampleBgraLinePair,Fl=A.UpsampleArgbLinePair,Dh=A.UpsampleRgba4444LinePair,Sp=A.UpsampleRgb565LinePair,ou=16,ia=1<<ou-1,Zn=-227,nr=482,qu=6,Vi=0,qo=o(256),Bl=o(256),Ec=o(256),Ho=o(256),Mf=o(nr-Zn),mg=o(nr-Zn);ta("YuvToRgbRow",no,3),ta("YuvToBgrRow",yr,3),ta("YuvToRgbaRow",Eo,4),ta("YuvToBgraRow",Eh,4),ta("YuvToArgbRow",Za,4),ta("YuvToRgba4444Row",Ps,2),ta("YuvToRgb565Row",ro,2);var Ap=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Vl=[0,2,8],gg=[8,7,6,4,4,2,2,2,1,1,1,1],su=1;this.WebPDecodeRGBA=function(v,S,F,z,G){var Y=zu,Z=new Xe,ee=new Dt;Z.ba=ee,ee.S=Y,ee.width=[ee.width],ee.height=[ee.height];var ie=ee.width,ce=ee.height,_e=new Gt;if(_e==null||v==null)var De=2;else e(_e!=null),De=Fu(v,S,F,_e.width,_e.height,_e.Pd,_e.Qd,_e.format,null);if(De!=0?ie=0:(ie!=null&&(ie[0]=_e.width[0]),ce!=null&&(ce[0]=_e.height[0]),ie=1),ie){ee.width=ee.width[0],ee.height=ee.height[0],z!=null&&(z[0]=ee.width),G!=null&&(G[0]=ee.height);e:{if(z=new bo,(G=new et).data=v,G.w=S,G.ha=F,G.kd=1,S=[0],e(G!=null),((v=Fu(G.data,G.w,G.ha,null,null,null,S,null,G))==0||v==7)&&S[0]&&(v=4),(S=v)==0){if(e(Z!=null),z.data=G.data,z.w=G.w+G.offset,z.ha=G.ha-G.offset,z.put=Kt,z.ac=ui,z.bc=go,z.ma=Z,G.xa){if((v=xa())==null){Z=1;break e}if((function(de,Ae){var Pe=[0],Ke=[0],Me=[0];t:for(;;){if(de==null)return 0;if(Ae==null)return de.a=2,0;if(de.l=Ae,de.a=0,le(de.m,Ae.data,Ae.w,Ae.ha),!Yi(de.m,Pe,Ke,Me)){de.a=3;break t}if(de.xb=xc,Ae.width=Pe[0],Ae.height=Ke[0],!cs(Pe[0],Ke[0],1,de,null))break t;return 1}return e(de.a!=0),0})(v,z)){if(z=(S=eu(z.width,z.height,Z.Oa,Z.ba))==0){t:{z=v;n:for(;;){if(z==null){z=0;break t}if(e(z.s.yc!=null),e(z.s.Ya!=null),e(0<z.s.Wb),e((F=z.l)!=null),e((G=F.ma)!=null),z.xb!=0){if(z.ca=G.ba,z.tb=G.tb,e(z.ca!=null),!fc(G.Oa,F,Ih)){z.a=2;break n}if(!hs(z,F.width)||F.da)break n;if((F.da||Ht(z.ca.S))&&Ve(),11>z.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),z.ca.f.kb.F!=null&&Ve()),z.Pb&&0<z.s.ua&&z.s.vb.X==null&&!te(z.s.vb,z.s.Wa.Xa)){z.a=1;break n}z.xb=0}if(!yo(z,z.V,z.Ba,z.c,z.i,F.o,Ks))break n;G.Dc=z.Ma,z=1;break t}e(z.a!=0),z=0}z=!z}z&&(S=v.a)}else S=v.a}else{if((v=new Bo)==null){Z=1;break e}if(v.Fa=G.na,v.P=G.P,v.qc=G.Sa,Oi(v,z)){if((S=eu(z.width,z.height,Z.Oa,Z.ba))==0){if(v.Aa=0,F=Z.Oa,e((G=v)!=null),F!=null){if(0<(ie=0>(ie=F.Md)?0:100<ie?255:255*ie/100)){for(ce=_e=0;4>ce;++ce)12>(De=G.pb[ce]).lc&&(De.ia=ie*gg[0>De.lc?0:De.lc]>>3),_e|=De.ia;_e&&(alert("todo:VP8InitRandom"),G.ia=1)}G.Ga=F.Id,100<G.Ga?G.Ga=100:0>G.Ga&&(G.Ga=0)}(function(de,Ae){if(de==null)return 0;if(Ae==null)return pr(de,2,"NULL VP8Io parameter in VP8Decode().");if(!de.cb&&!Oi(de,Ae))return 0;if(e(de.cb),Ae.ac==null||Ae.ac(Ae)){Ae.ob&&(de.L=0);var Pe=Vl[de.L];if(de.L==2?(de.yb=0,de.zb=0):(de.yb=Ae.v-Pe>>4,de.zb=Ae.j-Pe>>4,0>de.yb&&(de.yb=0),0>de.zb&&(de.zb=0)),de.Va=Ae.o+15+Pe>>4,de.Hb=Ae.va+15+Pe>>4,de.Hb>de.za&&(de.Hb=de.za),de.Va>de.Ub&&(de.Va=de.Ub),0<de.L){var Ke=de.ed;for(Pe=0;4>Pe;++Pe){var Me;if(de.Qa.Cb){var We=de.Qa.Lb[Pe];de.Qa.Fb||(We+=Ke.Tb)}else We=Ke.Tb;for(Me=0;1>=Me;++Me){var Ge=de.gd[Pe][Me],Je=We;if(Ke.Pc&&(Je+=Ke.vd[0],Me&&(Je+=Ke.od[0])),0<(Je=0>Je?0:63<Je?63:Je)){var Ze=Je;0<Ke.wb&&(Ze=4<Ke.wb?Ze>>2:Ze>>1)>9-Ke.wb&&(Ze=9-Ke.wb),1>Ze&&(Ze=1),Ge.dd=Ze,Ge.tc=2*Je+Ze,Ge.ld=40<=Je?2:15<=Je?1:0}else Ge.tc=0;Ge.La=Me}}}Pe=0}else pr(de,6,"Frame setup failed"),Pe=de.a;if(Pe=Pe==0){if(Pe){de.$c=0,0<de.Aa||(de.Ic=su);t:{Pe=de.Ic,Ke=4*(Ze=de.za);var Lt=32*Ze,bt=Ze+1,gn=0<de.L?Ze*(0<de.Aa?2:1):0,Ct=(de.Aa==2?2:1)*Ze;if((Ge=Ke+832+(Me=3*(16*Pe+Vl[de.L])/2*Lt)+(We=de.Fa!=null&&0<de.Fa.length?de.Kc.c*de.Kc.i:0))!=Ge)Pe=0;else{if(Ge>de.Vb){if(de.Vb=0,de.Ec=o(Ge),de.Fc=0,de.Ec==null){Pe=pr(de,1,"no memory during frame initialization.");break t}de.Vb=Ge}Ge=de.Ec,Je=de.Fc,de.Ac=Ge,de.Bc=Je,Je+=Ke,de.Gd=s(Lt,Ji),de.Hd=0,de.rb=s(bt+1,Qs),de.sb=1,de.wa=gn?s(gn,Qi):null,de.Y=0,de.D.Nb=0,de.D.wa=de.wa,de.D.Y=de.Y,0<de.Aa&&(de.D.Y+=Ze),e(!0),de.oc=Ge,de.pc=Je,Je+=832,de.ya=s(Ct,Ea),de.aa=0,de.D.ya=de.ya,de.D.aa=de.aa,de.Aa==2&&(de.D.aa+=Ze),de.R=16*Ze,de.B=8*Ze,Ze=(Lt=Vl[de.L])*de.R,Lt=Lt/2*de.B,de.sa=Ge,de.ta=Je+Ze,de.qa=de.sa,de.ra=de.ta+16*Pe*de.R+Lt,de.Ha=de.qa,de.Ia=de.ra+8*Pe*de.B+Lt,de.$c=0,Je+=Me,de.mb=We?Ge:null,de.nb=We?Je:null,e(Je+We<=de.Fc+de.Vb),Is(de),i(de.Ac,de.Bc,0,Ke),Pe=1}}if(Pe){if(Ae.ka=0,Ae.y=de.sa,Ae.O=de.ta,Ae.f=de.qa,Ae.N=de.ra,Ae.ea=de.Ha,Ae.Vd=de.Ia,Ae.fa=de.R,Ae.Rc=de.B,Ae.F=null,Ae.J=0,!bp){for(Pe=-255;255>=Pe;++Pe)gp[255+Pe]=0>Pe?-Pe:Pe;for(Pe=-1020;1020>=Pe;++Pe)vp[1020+Pe]=-128>Pe?-128:127<Pe?127:Pe;for(Pe=-112;112>=Pe;++Pe)yp[112+Pe]=-16>Pe?-16:15<Pe?15:Pe;for(Pe=-255;510>=Pe;++Pe)wp[255+Pe]=0>Pe?0:255<Pe?255:Pe;bp=1}Uu=xo,Rl=Xa,Uo=Ts,qn=Pu,tr=An,Dr=_l,Lr=hi,Zr=to,ra=H,Sh=pe,gc=ka,iu=N,kf=be,vc=ke,Nf=Rs,dp=ms,Ah=Cl,Pl=Ta,Ms[0]=Aa,Ms[1]=Du,Ms[2]=_o,Ms[3]=hc,Ms[4]=ci,Ms[5]=Lu,Ms[6]=Ns,Ms[7]=Jn,Ms[8]=Al,Ms[9]=Ja,Ao[0]=ks,Ao[1]=Sl,Ao[2]=Ya,Ao[3]=ps,Ao[4]=eo,Ao[5]=jr,Ao[6]=Qa,zo[0]=Zs,zo[1]=El,zo[2]=Vo,zo[3]=Ca,zo[4]=Mu,zo[5]=jo,zo[6]=Ou,Pe=1}else Pe=0}Pe&&(Pe=(function(Rn,Mr){for(Rn.M=0;Rn.M<Rn.Va;++Rn.M){var yn,xt=Rn.Jc[Rn.M&Rn.Xb],ct=Rn.m,zr=Rn;for(yn=0;yn<zr.za;++yn){var ln=ct,In=zr,wr=In.Ac,Ii=In.Bc+4*yn,ei=In.zc,Ir=In.ya[In.aa+yn];if(In.Qa.Bb?Ir.$b=Fe(ln,In.Pa.jb[0])?2+Fe(ln,In.Pa.jb[2]):Fe(ln,In.Pa.jb[1]):Ir.$b=0,In.kc&&(Ir.Ad=Fe(ln,In.Bd)),Ir.Za=!Fe(ln,145)+0,Ir.Za){var di=Ir.Ob,Ti=0;for(In=0;4>In;++In){var Er,Ln=ei[0+In];for(Er=0;4>Er;++Er){Ln=I1[wr[Ii+Er]][Ln];for(var Hn=dg[Fe(ln,Ln[0])];0<Hn;)Hn=dg[2*Hn+Fe(ln,Ln[Hn])];Ln=-Hn,wr[Ii+Er]=Ln}r(di,Ti,wr,Ii,4),Ti+=4,ei[0+In]=Ln}}else Ln=Fe(ln,156)?Fe(ln,128)?1:3:Fe(ln,163)?2:0,Ir.Ob[0]=Ln,i(wr,Ii,Ln,4),i(ei,0,Ln,4);Ir.Dd=Fe(ln,142)?Fe(ln,114)?Fe(ln,183)?1:3:2:0}if(zr.m.Ka)return pr(Rn,7,"Premature end-of-partition0 encountered.");for(;Rn.ja<Rn.za;++Rn.ja){if(zr=xt,ln=(ct=Rn).rb[ct.sb-1],wr=ct.rb[ct.sb+ct.ja],yn=ct.ya[ct.aa+ct.ja],Ii=ct.kc?yn.Ad:0)ln.la=wr.la=0,yn.Za||(ln.Na=wr.Na=0),yn.Hc=0,yn.Gc=0,yn.ia=0;else{var Sr,Gn;if(ln=wr,wr=zr,Ii=ct.Pa.Xc,ei=ct.ya[ct.aa+ct.ja],Ir=ct.pb[ei.$b],In=ei.ad,di=0,Ti=ct.rb[ct.sb-1],Ln=Er=0,i(In,di,0,384),ei.Za)var Or=0,Fr=Ii[3];else{Hn=o(16);var ur=ln.Na+Ti.Na;if(ur=Ol(wr,Ii[1],ur,Ir.Eb,0,Hn,0),ln.Na=Ti.Na=(0<ur)+0,1<ur)Uu(Hn,0,In,di);else{var oo=Hn[0]+3>>3;for(Hn=0;256>Hn;Hn+=16)In[di+Hn]=oo}Or=1,Fr=Ii[0]}var rr=15&ln.la,lr=15&Ti.la;for(Hn=0;4>Hn;++Hn){var ti=1&lr;for(oo=Gn=0;4>oo;++oo)rr=rr>>1|(ti=(ur=Ol(wr,Fr,ur=ti+(1&rr),Ir.Sc,Or,In,di))>Or)<<7,Gn=Gn<<2|(3<ur?3:1<ur?2:In[di+0]!=0),di+=16;rr>>=4,lr=lr>>1|ti<<7,Er=(Er<<8|Gn)>>>0}for(Fr=rr,Or=lr>>4,Sr=0;4>Sr;Sr+=2){for(Gn=0,rr=ln.la>>4+Sr,lr=Ti.la>>4+Sr,Hn=0;2>Hn;++Hn){for(ti=1&lr,oo=0;2>oo;++oo)ur=ti+(1&rr),rr=rr>>1|(ti=0<(ur=Ol(wr,Ii[2],ur,Ir.Qc,0,In,di)))<<3,Gn=Gn<<2|(3<ur?3:1<ur?2:In[di+0]!=0),di+=16;rr>>=2,lr=lr>>1|ti<<5}Ln|=Gn<<4*Sr,Fr|=rr<<4<<Sr,Or|=(240&lr)<<Sr}ln.la=Fr,Ti.la=Or,ei.Hc=Er,ei.Gc=Ln,ei.ia=43690&Ln?0:Ir.ia,Ii=!(Er|Ln)}if(0<ct.L&&(ct.wa[ct.Y+ct.ja]=ct.gd[yn.$b][yn.Za],ct.wa[ct.Y+ct.ja].La|=!Ii),zr.Ka)return pr(Rn,7,"Premature end-of-file encountered.")}if(Is(Rn),ct=Mr,zr=1,yn=(xt=Rn).D,ln=0<xt.L&&xt.M>=xt.zb&&xt.M<=xt.Va,xt.Aa==0)t:{if(yn.M=xt.M,yn.uc=ln,vs(xt,yn),zr=1,yn=(Gn=xt.D).Nb,ln=(Ln=Vl[xt.L])*xt.R,wr=Ln/2*xt.B,Hn=16*yn*xt.R,oo=8*yn*xt.B,Ii=xt.sa,ei=xt.ta-ln+Hn,Ir=xt.qa,In=xt.ra-wr+oo,di=xt.Ha,Ti=xt.Ia-wr+oo,lr=(rr=Gn.M)==0,Er=rr>=xt.Va-1,xt.Aa==2&&vs(xt,Gn),Gn.uc)for(ti=(ur=xt).D.M,e(ur.D.uc),Gn=ur.yb;Gn<ur.Hb;++Gn){Or=Gn,Fr=ti;var ji=(Go=(Hr=ur).D).Nb;Sr=Hr.R;var Go=Go.wa[Go.Y+Or],Wr=Hr.sa,qr=Hr.ta+16*ji*Sr+16*Or,so=Go.dd,cr=Go.tc;if(cr!=0)if(e(3<=cr),Hr.L==1)0<Or&&dp(Wr,qr,Sr,cr+4),Go.La&&Pl(Wr,qr,Sr,cr),0<Fr&&Nf(Wr,qr,Sr,cr+4),Go.La&&Ah(Wr,qr,Sr,cr);else{var ao=Hr.B,Os=Hr.qa,oa=Hr.ra+8*ji*ao+8*Or,ki=Hr.Ha,Hr=Hr.Ia+8*ji*ao+8*Or;ji=Go.ld,0<Or&&(Zr(Wr,qr,Sr,cr+4,so,ji),Sh(Os,oa,ki,Hr,ao,cr+4,so,ji)),Go.La&&(iu(Wr,qr,Sr,cr,so,ji),vc(Os,oa,ki,Hr,ao,cr,so,ji)),0<Fr&&(Lr(Wr,qr,Sr,cr+4,so,ji),ra(Os,oa,ki,Hr,ao,cr+4,so,ji)),Go.La&&(gc(Wr,qr,Sr,cr,so,ji),kf(Os,oa,ki,Hr,ao,cr,so,ji))}}if(xt.ia&&alert("todo:DitherRow"),ct.put!=null){if(Gn=16*rr,rr=16*(rr+1),lr?(ct.y=xt.sa,ct.O=xt.ta+Hn,ct.f=xt.qa,ct.N=xt.ra+oo,ct.ea=xt.Ha,ct.W=xt.Ia+oo):(Gn-=Ln,ct.y=Ii,ct.O=ei,ct.f=Ir,ct.N=In,ct.ea=di,ct.W=Ti),Er||(rr-=Ln),rr>ct.o&&(rr=ct.o),ct.F=null,ct.J=null,xt.Fa!=null&&0<xt.Fa.length&&Gn<rr&&(ct.J=w(xt,ct,Gn,rr-Gn),ct.F=xt.mb,ct.F==null&&ct.F.length==0)){zr=pr(xt,3,"Could not decode alpha data.");break t}Gn<ct.j&&(Ln=ct.j-Gn,Gn=ct.j,e(!(1&Ln)),ct.O+=xt.R*Ln,ct.N+=xt.B*(Ln>>1),ct.W+=xt.B*(Ln>>1),ct.F!=null&&(ct.J+=ct.width*Ln)),Gn<rr&&(ct.O+=ct.v,ct.N+=ct.v>>1,ct.W+=ct.v>>1,ct.F!=null&&(ct.J+=ct.v),ct.ka=Gn-ct.j,ct.U=ct.va-ct.v,ct.T=rr-Gn,zr=ct.put(ct))}yn+1!=xt.Ic||Er||(r(xt.sa,xt.ta-ln,Ii,ei+16*xt.R,ln),r(xt.qa,xt.ra-wr,Ir,In+8*xt.B,wr),r(xt.Ha,xt.Ia-wr,di,Ti+8*xt.B,wr))}if(!zr)return pr(Rn,6,"Output aborted.")}return 1})(de,Ae)),Ae.bc!=null&&Ae.bc(Ae),Pe&=1}return Pe?(de.cb=0,Pe):0})(v,z)||(S=v.a)}}else S=v.a}S==0&&Z.Oa!=null&&Z.Oa.fd&&(S=dc(Z.ba))}Z=S}Y=Z!=0?null:11>Y?ee.f.RGBA.eb:ee.f.kb.y}else Y=null;return Y};var Lh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function l(A,M){for(var k="",O=0;O<4;O++)k+=String.fromCharCode(A[M++]);return k}function h(A,M){return A[M+0]|A[M+1]<<8}function d(A,M){return(A[M+0]|A[M+1]<<8|A[M+2]<<16)>>>0}function m(A,M){return(A[M+0]|A[M+1]<<8|A[M+2]<<16|A[M+3]<<24)>>>0}new u;var p=[0],y=[0],b=[],x=new u,E=n,T=(function(A,M){var k={},O=0,j=!1,X=0,ue=0;if(k.frames=[],!(function(W,Q){for(var ne=0;ne<4;ne++)if(W[Q+ne]!="RIFF".charCodeAt(ne))return!0;return!1})(A,M)){for(m(A,M+=4),M+=8;M<A.length;){var ge=l(A,M),he=m(A,M+=4);M+=4;var $=he+(1&he);switch(ge){case"VP8 ":case"VP8L":k.frames[O]===void 0&&(k.frames[O]={}),(J=k.frames[O]).src_off=j?ue:M-8,J.src_size=X+he+8,O++,j&&(j=!1,X=0,ue=0);break;case"VP8X":(J=k.header={}).feature_flags=A[M];var le=M+4;J.canvas_width=1+d(A,le),le+=3,J.canvas_height=1+d(A,le),le+=3;break;case"ALPH":j=!0,X=$+8,ue=M-8;break;case"ANIM":(J=k.header).bgcolor=m(A,M),le=M+4,J.loop_count=h(A,le),le+=2;break;case"ANMF":var ae,J;(J=k.frames[O]={}).offset_x=2*d(A,M),M+=3,J.offset_y=2*d(A,M),M+=3,J.width=1+d(A,M),M+=3,J.height=1+d(A,M),M+=3,J.duration=d(A,M),M+=3,ae=A[M++],J.dispose=1&ae,J.blend=ae>>1&1}ge!="ANMF"&&(M+=$)}return k}})(E,0);T.response=E,T.rgbaoutput=!0,T.dataurl=!1;var P=T.header?T.header:null,I=T.frames?T.frames:null;if(P){P.loop_counter=P.loop_count,p=[P.canvas_height],y=[P.canvas_width];for(var D=0;D<I.length&&I[D].blend!=0;D++);}var U=I[0],L=x.WebPDecodeRGBA(E,U.src_off,U.src_size,y,p);U.rgba=L,U.imgwidth=y[0],U.imgheight=p[0];for(var C=0;C<y[0]*p[0]*4;C++)b[C]=L[C];return this.width=y,this.height=p,this.data=b,this}(function(n){var e,t,r,i,o,s,a,u,l,h=function(W){return W=W||{},this.isStrokeTransparent=W.isStrokeTransparent||!1,this.strokeOpacity=W.strokeOpacity||1,this.strokeStyle=W.strokeStyle||"#000000",this.fillStyle=W.fillStyle||"#000000",this.isFillTransparent=W.isFillTransparent||!1,this.fillOpacity=W.fillOpacity||1,this.font=W.font||"10px sans-serif",this.textBaseline=W.textBaseline||"alphabetic",this.textAlign=W.textAlign||"left",this.lineWidth=W.lineWidth||1,this.lineJoin=W.lineJoin||"miter",this.lineCap=W.lineCap||"butt",this.path=W.path||[],this.transform=W.transform!==void 0?W.transform.clone():new u,this.globalCompositeOperation=W.globalCompositeOperation||"normal",this.globalAlpha=W.globalAlpha||1,this.clip_path=W.clip_path||[],this.currentPoint=W.currentPoint||new s,this.miterLimit=W.miterLimit||10,this.lastPoint=W.lastPoint||new s,this.lineDashOffset=W.lineDashOffset||0,this.lineDash=W.lineDash||[],this.margin=W.margin||[0,0,0,0],this.prevPageLastElemOffset=W.prevPageLastElemOffset||0,this.ignoreClearRect=typeof W.ignoreClearRect!="boolean"||W.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,a=this.internal.Rectangle,u=this.internal.Matrix,l=new h}]);var d=function(W){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Q=W;Object.defineProperty(this,"pdf",{get:function(){return Q}});var ne=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return ne},set:function(te){ne=!!te}});var fe=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return fe},set:function(te){fe=!!te}});var ve=0;Object.defineProperty(this,"posX",{get:function(){return ve},set:function(te){isNaN(te)||(ve=te)}});var we=0;Object.defineProperty(this,"posY",{get:function(){return we},set:function(te){isNaN(te)||(we=te)}}),Object.defineProperty(this,"margin",{get:function(){return l.margin},set:function(te){var rt;typeof te=="number"?rt=[te,te,te,te]:((rt=new Array(4))[0]=te[0],rt[1]=te.length>=2?te[1]:rt[0],rt[2]=te.length>=3?te[2]:rt[0],rt[3]=te.length>=4?te[3]:rt[1]),l.margin=rt}});var Se=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Se},set:function(te){Se=te}});var Ce=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ce},set:function(te){Ce=te}});var Fe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Fe},set:function(te){Fe=te}}),Object.defineProperty(this,"ctx",{get:function(){return l},set:function(te){te instanceof h&&(l=te)}}),Object.defineProperty(this,"path",{get:function(){return l.path},set:function(te){l.path=te}});var qe=[];Object.defineProperty(this,"ctxStack",{get:function(){return qe},set:function(te){qe=te}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(te){var rt;rt=m(te),this.ctx.fillStyle=rt.style,this.ctx.isFillTransparent=rt.a===0,this.ctx.fillOpacity=rt.a,this.pdf.setFillColor(rt.r,rt.g,rt.b,{a:rt.a}),this.pdf.setTextColor(rt.r,rt.g,rt.b,{a:rt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(te){var rt=m(te);this.ctx.strokeStyle=rt.style,this.ctx.isStrokeTransparent=rt.a===0,this.ctx.strokeOpacity=rt.a,rt.a===0?this.pdf.setDrawColor(255,255,255):(rt.a,this.pdf.setDrawColor(rt.r,rt.g,rt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(te){["butt","round","square"].indexOf(te)!==-1&&(this.ctx.lineCap=te,this.pdf.setLineCap(te))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(te){isNaN(te)||(this.ctx.lineWidth=te,this.pdf.setLineWidth(te))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(te){["bevel","round","miter"].indexOf(te)!==-1&&(this.ctx.lineJoin=te,this.pdf.setLineJoin(te))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(te){isNaN(te)||(this.ctx.miterLimit=te,this.pdf.setMiterLimit(te))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(te){this.ctx.textBaseline=te}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(te){["right","end","center","left","start"].indexOf(te)!==-1&&(this.ctx.textAlign=te)}});var Ne=null,Oe=null,Qe=null;Object.defineProperty(this,"fontFaces",{get:function(){return Qe},set:function(te){Ne=null,Oe=null,Qe=te}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(te){var rt;if(this.ctx.font=te,(rt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(te))!==null){var zt=rt[1];rt[2];var gt=rt[3],He=rt[4];rt[5];var ft=rt[6],lt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(He)[2];He=Math.floor(lt==="px"?parseFloat(He)*this.pdf.internal.scaleFactor:lt==="em"?parseFloat(He)*this.pdf.getFontSize():parseFloat(He)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(He);var Et=(function(yt){var dr,mn,rn=[],un=yt.trim();if(un==="")return x2;if(un in eC)return[eC[un]];for(;un!=="";){switch(mn=null,dr=(un=nC(un)).charAt(0)){case'"':case"'":mn=oH(un.substring(1),dr);break;default:mn=sH(un)}if(mn===null||(rn.push(mn[0]),(un=nC(mn[1]))!==""&&un.charAt(0)!==","))return x2;un=un.replace(/^,/,"")}return rn})(ft);if(this.fontFaces){var pt=(function(yt,dr){var mn=yt.getFontList(),rn=JSON.stringify(mn);if(Ne===null||Oe!==rn){var un=(function(On){var Ot=[];return Object.keys(On).forEach(function(Bn){On[Bn].forEach(function(Ht){var Jt=null;switch(Ht){case"bold":Jt={family:Bn,weight:"bold"};break;case"italic":Jt={family:Bn,style:"italic"};break;case"bolditalic":Jt={family:Bn,weight:"bold",style:"italic"};break;case"":case"normal":Jt={family:Bn}}Jt!==null&&(Jt.ref={name:Bn,style:Ht},Ot.push(Jt))})}),Ot})(mn);Ne=(function(On){for(var Ot={},Bn=0;Bn<On.length;++Bn){var Ht=b2(On[Bn]),Jt=Ht.family,jn=Ht.stretch,Dt=Ht.style,Gt=Ht.weight;Ot[Jt]=Ot[Jt]||{},Ot[Jt][jn]=Ot[Jt][jn]||{},Ot[Jt][jn][Dt]=Ot[Jt][jn][Dt]||{},Ot[Jt][jn][Dt][Gt]=Ht}return Ot})(un.concat(dr)),Oe=rn}return Ne})(this.pdf,this.fontFaces),En=Et.map(function(yt){return{family:yt,stretch:"normal",weight:gt,style:zt}}),$t=(function(yt,dr,mn){for(var rn=(mn=mn||{}).defaultFontFamily||"times",un=Object.assign({},iH,mn.genericFontFamilies||{}),On=null,Ot=null,Bn=0;Bn<dr.length;++Bn)if(un[(On=b2(dr[Bn])).family]&&(On.family=un[On.family]),yt.hasOwnProperty(On.family)){Ot=yt[On.family];break}if(!(Ot=Ot||yt[rn]))throw new Error("Could not find a font-family for the rule '"+tC(On)+"' and default family '"+rn+"'.");if(Ot=(function(Ht,Jt){if(Jt[Ht])return Jt[Ht];var jn=Dw[Ht],Dt=jn<=Dw.normal?-1:1,Gt=ZA(Jt,LN,jn,Dt);if(!Gt)throw new Error("Could not find a matching font-stretch value for "+Ht);return Gt})(On.stretch,Ot),Ot=(function(Ht,Jt){if(Jt[Ht])return Jt[Ht];for(var jn=DN[Ht],Dt=0;Dt<jn.length;++Dt)if(Jt[jn[Dt]])return Jt[jn[Dt]];throw new Error("Could not find a matching font-style for "+Ht)})(On.style,Ot),!(Ot=(function(Ht,Jt){if(Jt[Ht])return Jt[Ht];if(Ht===400&&Jt[500])return Jt[500];if(Ht===500&&Jt[400])return Jt[400];var jn=rH[Ht],Dt=ZA(Jt,MN,jn,Ht<400?-1:1);if(!Dt)throw new Error("Could not find a matching font-weight for value "+Ht);return Dt})(On.weight,Ot)))throw new Error("Failed to resolve a font for the rule '"+tC(On)+"'.");return Ot})(pt,En);this.pdf.setFont($t.ref.name,$t.ref.style)}else{var Qt="";(gt==="bold"||parseInt(gt,10)>=700||zt==="bold")&&(Qt="bold"),zt==="italic"&&(Qt+="italic"),Qt.length===0&&(Qt="normal");for(var an="",qt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},vt=0;vt<Et.length;vt++){if(this.pdf.internal.getFont(Et[vt],Qt,{noFallback:!0,disableWarning:!0})!==void 0){an=Et[vt];break}if(Qt==="bolditalic"&&this.pdf.internal.getFont(Et[vt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)an=Et[vt],Qt="bold";else if(this.pdf.internal.getFont(Et[vt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){an=Et[vt],Qt="normal";break}}if(an===""){for(var en=0;en<Et.length;en++)if(qt[Et[en]]){an=qt[Et[en]];break}}an=an===""?"Times":an,this.pdf.setFont(an,Qt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(te){this.ctx.globalCompositeOperation=te}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(te){this.ctx.globalAlpha=te}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(te){this.ctx.lineDashOffset=te,J.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(te){this.ctx.lineDash=te,J.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(te){this.ctx.ignoreClearRect=!!te}})};d.prototype.setLineDash=function(W){this.lineDash=W},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){I.call(this,"fill",!1)},d.prototype.stroke=function(){I.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(W,Q){if(isNaN(W)||isNaN(Q))throw _r.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var ne=this.ctx.transform.applyToPoint(new s(W,Q));this.path.push({type:"mt",x:ne.x,y:ne.y}),this.ctx.lastPoint=new s(W,Q)},d.prototype.closePath=function(){var W=new s(0,0),Q=0;for(Q=this.path.length-1;Q!==-1;Q--)if(this.path[Q].type==="begin"&&fr(this.path[Q+1])==="object"&&typeof this.path[Q+1].x=="number"){W=new s(this.path[Q+1].x,this.path[Q+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(W.x,W.y)},d.prototype.lineTo=function(W,Q){if(isNaN(W)||isNaN(Q))throw _r.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var ne=this.ctx.transform.applyToPoint(new s(W,Q));this.path.push({type:"lt",x:ne.x,y:ne.y}),this.ctx.lastPoint=new s(ne.x,ne.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),I.call(this,null,!0)},d.prototype.quadraticCurveTo=function(W,Q,ne,fe){if(isNaN(ne)||isNaN(fe)||isNaN(W)||isNaN(Q))throw _r.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ve=this.ctx.transform.applyToPoint(new s(ne,fe)),we=this.ctx.transform.applyToPoint(new s(W,Q));this.path.push({type:"qct",x1:we.x,y1:we.y,x:ve.x,y:ve.y}),this.ctx.lastPoint=new s(ve.x,ve.y)},d.prototype.bezierCurveTo=function(W,Q,ne,fe,ve,we){if(isNaN(ve)||isNaN(we)||isNaN(W)||isNaN(Q)||isNaN(ne)||isNaN(fe))throw _r.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Se=this.ctx.transform.applyToPoint(new s(ve,we)),Ce=this.ctx.transform.applyToPoint(new s(W,Q)),Fe=this.ctx.transform.applyToPoint(new s(ne,fe));this.path.push({type:"bct",x1:Ce.x,y1:Ce.y,x2:Fe.x,y2:Fe.y,x:Se.x,y:Se.y}),this.ctx.lastPoint=new s(Se.x,Se.y)},d.prototype.arc=function(W,Q,ne,fe,ve,we){if(isNaN(W)||isNaN(Q)||isNaN(ne)||isNaN(fe)||isNaN(ve))throw _r.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(we=!!we,!this.ctx.transform.isIdentity){var Se=this.ctx.transform.applyToPoint(new s(W,Q));W=Se.x,Q=Se.y;var Ce=this.ctx.transform.applyToPoint(new s(0,ne)),Fe=this.ctx.transform.applyToPoint(new s(0,0));ne=Math.sqrt(Math.pow(Ce.x-Fe.x,2)+Math.pow(Ce.y-Fe.y,2))}Math.abs(ve-fe)>=2*Math.PI&&(fe=0,ve=2*Math.PI),this.path.push({type:"arc",x:W,y:Q,radius:ne,startAngle:fe,endAngle:ve,counterclockwise:we})},d.prototype.arcTo=function(W,Q,ne,fe,ve){throw new Error("arcTo not implemented.")},d.prototype.rect=function(W,Q,ne,fe){if(isNaN(W)||isNaN(Q)||isNaN(ne)||isNaN(fe))throw _r.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(W,Q),this.lineTo(W+ne,Q),this.lineTo(W+ne,Q+fe),this.lineTo(W,Q+fe),this.lineTo(W,Q),this.lineTo(W+ne,Q),this.lineTo(W,Q)},d.prototype.fillRect=function(W,Q,ne,fe){if(isNaN(W)||isNaN(Q)||isNaN(ne)||isNaN(fe))throw _r.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var ve={};this.lineCap!=="butt"&&(ve.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ve.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(W,Q,ne,fe),this.fill(),ve.hasOwnProperty("lineCap")&&(this.lineCap=ve.lineCap),ve.hasOwnProperty("lineJoin")&&(this.lineJoin=ve.lineJoin)}},d.prototype.strokeRect=function(W,Q,ne,fe){if(isNaN(W)||isNaN(Q)||isNaN(ne)||isNaN(fe))throw _r.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(W,Q,ne,fe),this.stroke())},d.prototype.clearRect=function(W,Q,ne,fe){if(isNaN(W)||isNaN(Q)||isNaN(ne)||isNaN(fe))throw _r.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(W,Q,ne,fe))},d.prototype.save=function(W){W=typeof W!="boolean"||W;for(var Q=this.pdf.internal.getCurrentPageInfo().pageNumber,ne=0;ne<this.pdf.internal.getNumberOfPages();ne++)this.pdf.setPage(ne+1),this.pdf.internal.out("q");if(this.pdf.setPage(Q),W){this.ctx.fontSize=this.pdf.internal.getFontSize();var fe=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=fe}},d.prototype.restore=function(W){W=typeof W!="boolean"||W;for(var Q=this.pdf.internal.getCurrentPageInfo().pageNumber,ne=0;ne<this.pdf.internal.getNumberOfPages();ne++)this.pdf.setPage(ne+1),this.pdf.internal.out("Q");this.pdf.setPage(Q),W&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(W){var Q,ne,fe,ve;if(W.isCanvasGradient===!0&&(W=W.getColor()),!W)return{r:0,g:0,b:0,a:0,style:W};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(W))Q=0,ne=0,fe=0,ve=0;else{var we=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(W);if(we!==null)Q=parseInt(we[1]),ne=parseInt(we[2]),fe=parseInt(we[3]),ve=1;else if((we=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(W))!==null)Q=parseInt(we[1]),ne=parseInt(we[2]),fe=parseInt(we[3]),ve=parseFloat(we[4]);else{if(ve=1,typeof W=="string"&&W.charAt(0)!=="#"){var Se=new CN(W);W=Se.ok?Se.toHex():"#000000"}W.length===4?(Q=W.substring(1,2),Q+=Q,ne=W.substring(2,3),ne+=ne,fe=W.substring(3,4),fe+=fe):(Q=W.substring(1,3),ne=W.substring(3,5),fe=W.substring(5,7)),Q=parseInt(Q,16),ne=parseInt(ne,16),fe=parseInt(fe,16)}}return{r:Q,g:ne,b:fe,a:ve,style:W}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(W,Q,ne,fe){if(isNaN(Q)||isNaN(ne)||typeof W!="string")throw _r.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(fe=isNaN(fe)?void 0:fe,!p.call(this)){var ve=$(this.ctx.transform.rotation),we=this.ctx.transform.scaleX;O.call(this,{text:W,x:Q,y:ne,scale:we,angle:ve,align:this.textAlign,maxWidth:fe})}},d.prototype.strokeText=function(W,Q,ne,fe){if(isNaN(Q)||isNaN(ne)||typeof W!="string")throw _r.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){fe=isNaN(fe)?void 0:fe;var ve=$(this.ctx.transform.rotation),we=this.ctx.transform.scaleX;O.call(this,{text:W,x:Q,y:ne,scale:we,renderingMode:"stroke",angle:ve,align:this.textAlign,maxWidth:fe})}},d.prototype.measureText=function(W){if(typeof W!="string")throw _r.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Q=this.pdf,ne=this.pdf.internal.scaleFactor,fe=Q.internal.getFontSize(),ve=Q.getStringUnitWidth(W)*fe/Q.internal.scaleFactor;return new function(we){var Se=(we=we||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Se}}),this}({width:ve*=Math.round(96*ne/72*1e4)/1e4})},d.prototype.scale=function(W,Q){if(isNaN(W)||isNaN(Q))throw _r.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var ne=new u(W,0,0,Q,0,0);this.ctx.transform=this.ctx.transform.multiply(ne)},d.prototype.rotate=function(W){if(isNaN(W))throw _r.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Q=new u(Math.cos(W),Math.sin(W),-Math.sin(W),Math.cos(W),0,0);this.ctx.transform=this.ctx.transform.multiply(Q)},d.prototype.translate=function(W,Q){if(isNaN(W)||isNaN(Q))throw _r.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var ne=new u(1,0,0,1,W,Q);this.ctx.transform=this.ctx.transform.multiply(ne)},d.prototype.transform=function(W,Q,ne,fe,ve,we){if(isNaN(W)||isNaN(Q)||isNaN(ne)||isNaN(fe)||isNaN(ve)||isNaN(we))throw _r.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Se=new u(W,Q,ne,fe,ve,we);this.ctx.transform=this.ctx.transform.multiply(Se)},d.prototype.setTransform=function(W,Q,ne,fe,ve,we){W=isNaN(W)?1:W,Q=isNaN(Q)?0:Q,ne=isNaN(ne)?0:ne,fe=isNaN(fe)?1:fe,ve=isNaN(ve)?0:ve,we=isNaN(we)?0:we,this.ctx.transform=new u(W,Q,ne,fe,ve,we)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(W,Q,ne,fe,ve,we,Se,Ce,Fe){var qe=this.pdf.getImageProperties(W),Ne=1,Oe=1,Qe=1,te=1;fe!==void 0&&Ce!==void 0&&(Qe=Ce/fe,te=Fe/ve,Ne=qe.width/fe*Ce/fe,Oe=qe.height/ve*Fe/ve),we===void 0&&(we=Q,Se=ne,Q=0,ne=0),fe!==void 0&&Ce===void 0&&(Ce=fe,Fe=ve),fe===void 0&&Ce===void 0&&(Ce=qe.width,Fe=qe.height);var rt=this.ctx.transform.decompose(),zt=$(rt.rotate.shx),gt=new u,He=(gt=(gt=(gt=gt.multiply(rt.translate)).multiply(rt.skew)).multiply(rt.scale)).applyToRectangle(new a(we-Q*Qe,Se-ne*te,fe*Ne,ve*Oe));if(this.autoPaging){for(var ft,lt=x.call(this,He),Et=[],pt=0;pt<lt.length;pt+=1)Et.indexOf(lt[pt])===-1&&Et.push(lt[pt]);P(Et);for(var En=Et[0],$t=Et[Et.length-1],Qt=En;Qt<$t+1;Qt++){this.pdf.setPage(Qt);var an=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],qt=Qt===1?this.posY+this.margin[0]:this.margin[0],vt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],en=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],yt=Qt===1?0:vt+(Qt-2)*en;if(this.ctx.clip_path.length!==0){var dr=this.path;ft=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(ft,this.posX+this.margin[3],-yt+qt+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=dr}var mn=JSON.parse(JSON.stringify(He));mn=T([mn],this.posX+this.margin[3],-yt+qt+this.ctx.prevPageLastElemOffset)[0];var rn=(Qt>En||Qt<$t)&&b.call(this);rn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],an,en,null).clip().discardPath()),this.pdf.addImage(W,"JPEG",mn.x,mn.y,mn.w,mn.h,null,null,zt),rn&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(W,"JPEG",He.x,He.y,He.w,He.h,null,null,zt)};var x=function(W,Q,ne){var fe=[];Q=Q||this.pdf.internal.pageSize.width,ne=ne||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ve=this.posY+this.ctx.prevPageLastElemOffset;switch(W.type){default:case"mt":case"lt":fe.push(Math.floor((W.y+ve)/ne)+1);break;case"arc":fe.push(Math.floor((W.y+ve-W.radius)/ne)+1),fe.push(Math.floor((W.y+ve+W.radius)/ne)+1);break;case"qct":var we=le(this.ctx.lastPoint.x,this.ctx.lastPoint.y,W.x1,W.y1,W.x,W.y);fe.push(Math.floor((we.y+ve)/ne)+1),fe.push(Math.floor((we.y+we.h+ve)/ne)+1);break;case"bct":var Se=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,W.x1,W.y1,W.x2,W.y2,W.x,W.y);fe.push(Math.floor((Se.y+ve)/ne)+1),fe.push(Math.floor((Se.y+Se.h+ve)/ne)+1);break;case"rect":fe.push(Math.floor((W.y+ve)/ne)+1),fe.push(Math.floor((W.y+W.h+ve)/ne)+1)}for(var Ce=0;Ce<fe.length;Ce+=1)for(;this.pdf.internal.getNumberOfPages()<fe[Ce];)E.call(this);return fe},E=function(){var W=this.fillStyle,Q=this.strokeStyle,ne=this.font,fe=this.lineCap,ve=this.lineWidth,we=this.lineJoin;this.pdf.addPage(),this.fillStyle=W,this.strokeStyle=Q,this.font=ne,this.lineCap=fe,this.lineWidth=ve,this.lineJoin=we},T=function(W,Q,ne){for(var fe=0;fe<W.length;fe++)switch(W[fe].type){case"bct":W[fe].x2+=Q,W[fe].y2+=ne;case"qct":W[fe].x1+=Q,W[fe].y1+=ne;default:W[fe].x+=Q,W[fe].y+=ne}return W},P=function(W){return W.sort(function(Q,ne){return Q-ne})},I=function(W,Q){var ne=this.fillStyle,fe=this.strokeStyle,ve=this.lineCap,we=this.lineWidth,Se=Math.abs(we*this.ctx.transform.scaleX),Ce=this.lineJoin;if(this.autoPaging){for(var Fe,qe,Ne=JSON.parse(JSON.stringify(this.path)),Oe=JSON.parse(JSON.stringify(this.path)),Qe=[],te=0;te<Oe.length;te++)if(Oe[te].x!==void 0)for(var rt=x.call(this,Oe[te]),zt=0;zt<rt.length;zt+=1)Qe.indexOf(rt[zt])===-1&&Qe.push(rt[zt]);for(var gt=0;gt<Qe.length;gt++)for(;this.pdf.internal.getNumberOfPages()<Qe[gt];)E.call(this);P(Qe);for(var He=Qe[0],ft=Qe[Qe.length-1],lt=He;lt<ft+1;lt++){this.pdf.setPage(lt),this.fillStyle=ne,this.strokeStyle=fe,this.lineCap=ve,this.lineWidth=Se,this.lineJoin=Ce;var Et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],pt=lt===1?this.posY+this.margin[0]:this.margin[0],En=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Qt=lt===1?0:En+(lt-2)*$t;if(this.ctx.clip_path.length!==0){var an=this.path;Fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(Fe,this.posX+this.margin[3],-Qt+pt+this.ctx.prevPageLastElemOffset),D.call(this,W,!0),this.path=an}if(qe=JSON.parse(JSON.stringify(Ne)),this.path=T(qe,this.posX+this.margin[3],-Qt+pt+this.ctx.prevPageLastElemOffset),Q===!1||lt===0){var qt=(lt>He||lt<ft)&&b.call(this);qt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,$t,null).clip().discardPath()),D.call(this,W,Q),qt&&this.pdf.restoreGraphicsState()}this.lineWidth=we}this.path=Ne}else this.lineWidth=Se,D.call(this,W,Q),this.lineWidth=we},D=function(W,Q){if((W!=="stroke"||Q||!y.call(this))&&(W==="stroke"||Q||!p.call(this))){for(var ne,fe,ve=[],we=this.path,Se=0;Se<we.length;Se++){var Ce=we[Se];switch(Ce.type){case"begin":ve.push({begin:!0});break;case"close":ve.push({close:!0});break;case"mt":ve.push({start:Ce,deltas:[],abs:[]});break;case"lt":var Fe=ve.length;if(we[Se-1]&&!isNaN(we[Se-1].x)&&(ne=[Ce.x-we[Se-1].x,Ce.y-we[Se-1].y],Fe>0)){for(;Fe>=0;Fe--)if(ve[Fe-1].close!==!0&&ve[Fe-1].begin!==!0){ve[Fe-1].deltas.push(ne),ve[Fe-1].abs.push(Ce);break}}break;case"bct":ne=[Ce.x1-we[Se-1].x,Ce.y1-we[Se-1].y,Ce.x2-we[Se-1].x,Ce.y2-we[Se-1].y,Ce.x-we[Se-1].x,Ce.y-we[Se-1].y],ve[ve.length-1].deltas.push(ne);break;case"qct":var qe=we[Se-1].x+2/3*(Ce.x1-we[Se-1].x),Ne=we[Se-1].y+2/3*(Ce.y1-we[Se-1].y),Oe=Ce.x+2/3*(Ce.x1-Ce.x),Qe=Ce.y+2/3*(Ce.y1-Ce.y),te=Ce.x,rt=Ce.y;ne=[qe-we[Se-1].x,Ne-we[Se-1].y,Oe-we[Se-1].x,Qe-we[Se-1].y,te-we[Se-1].x,rt-we[Se-1].y],ve[ve.length-1].deltas.push(ne);break;case"arc":ve.push({deltas:[],abs:[],arc:!0}),Array.isArray(ve[ve.length-1].abs)&&ve[ve.length-1].abs.push(Ce)}}fe=Q?null:W==="stroke"?"stroke":"fill";for(var zt=!1,gt=0;gt<ve.length;gt++)if(ve[gt].arc)for(var He=ve[gt].abs,ft=0;ft<He.length;ft++){var lt=He[ft];lt.type==="arc"?C.call(this,lt.x,lt.y,lt.radius,lt.startAngle,lt.endAngle,lt.counterclockwise,void 0,Q,!zt):j.call(this,lt.x,lt.y),zt=!0}else if(ve[gt].close===!0)this.pdf.internal.out("h"),zt=!1;else if(ve[gt].begin!==!0){var Et=ve[gt].start.x,pt=ve[gt].start.y;X.call(this,ve[gt].deltas,Et,pt),zt=!0}fe&&A.call(this,fe),Q&&M.call(this)}},U=function(W){var Q=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,ne=Q*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return W-ne;case"top":return W+Q-ne;case"hanging":return W+Q-2*ne;case"middle":return W+Q/2-ne;default:return W}},L=function(W){return W+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var W=function(){};return W.colorStops=[],W.addColorStop=function(Q,ne){this.colorStops.push([Q,ne])},W.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},W.isCanvasGradient=!0,W},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(W,Q,ne,fe,ve,we,Se,Ce,Fe){for(var qe=ge.call(this,ne,fe,ve,we),Ne=0;Ne<qe.length;Ne++){var Oe=qe[Ne];Ne===0&&(Fe?k.call(this,Oe.x1+W,Oe.y1+Q):j.call(this,Oe.x1+W,Oe.y1+Q)),ue.call(this,W,Q,Oe.x2,Oe.y2,Oe.x3,Oe.y3,Oe.x4,Oe.y4)}Ce?M.call(this):A.call(this,Se)},A=function(W){switch(W){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(W,Q){this.pdf.internal.out(t(W)+" "+r(Q)+" m")},O=function(W){var Q;switch(W.align){case"right":case"end":Q="right";break;case"center":Q="center";break;default:Q="left"}var ne,fe,ve,we=this.pdf.getTextDimensions(W.text),Se=U.call(this,W.y),Ce=L.call(this,Se)-we.h,Fe=this.ctx.transform.applyToPoint(new s(W.x,Se));if(this.autoPaging){var qe=this.ctx.transform.decompose(),Ne=new u;Ne=(Ne=(Ne=Ne.multiply(qe.translate)).multiply(qe.skew)).multiply(qe.scale);for(var Oe=this.ctx.transform.applyToRectangle(new a(W.x,Se,we.w,we.h)),Qe=Ne.applyToRectangle(new a(W.x,Ce,we.w,we.h)),te=x.call(this,Qe),rt=[],zt=0;zt<te.length;zt+=1)rt.indexOf(te[zt])===-1&&rt.push(te[zt]);P(rt);for(var gt=rt[0],He=rt[rt.length-1],ft=gt;ft<He+1;ft++){this.pdf.setPage(ft);var lt=ft===1?this.posY+this.margin[0]:this.margin[0],Et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],pt=this.pdf.internal.pageSize.height-this.margin[2],En=pt-this.margin[0],$t=this.pdf.internal.pageSize.width-this.margin[1],Qt=$t-this.margin[3],an=ft===1?0:Et+(ft-2)*En;if(this.ctx.clip_path.length!==0){var qt=this.path;ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(ne,this.posX+this.margin[3],-1*an+lt),D.call(this,"fill",!0),this.path=qt}var vt=T([JSON.parse(JSON.stringify(Qe))],this.posX+this.margin[3],-an+lt+this.ctx.prevPageLastElemOffset)[0];W.scale>=.01&&(fe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(fe*W.scale),ve=this.lineWidth,this.lineWidth=ve*W.scale);var en=this.autoPaging!=="text";if(en||vt.y+vt.h<=pt){if(en||vt.y>=lt&&vt.x<=$t){var yt=en?W.text:this.pdf.splitTextToSize(W.text,W.maxWidth||$t-vt.x)[0],dr=T([JSON.parse(JSON.stringify(Oe))],this.posX+this.margin[3],-an+lt+this.ctx.prevPageLastElemOffset)[0],mn=en&&(ft>gt||ft<He)&&b.call(this);mn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Qt,En,null).clip().discardPath()),this.pdf.text(yt,dr.x,dr.y,{angle:W.angle,align:Q,renderingMode:W.renderingMode}),mn&&this.pdf.restoreGraphicsState()}}else vt.y<pt&&(this.ctx.prevPageLastElemOffset+=pt-vt.y);W.scale>=.01&&(this.pdf.setFontSize(fe),this.lineWidth=ve)}}else W.scale>=.01&&(fe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(fe*W.scale),ve=this.lineWidth,this.lineWidth=ve*W.scale),this.pdf.text(W.text,Fe.x+this.posX,Fe.y+this.posY,{angle:W.angle,align:Q,renderingMode:W.renderingMode,maxWidth:W.maxWidth}),W.scale>=.01&&(this.pdf.setFontSize(fe),this.lineWidth=ve)},j=function(W,Q,ne,fe){ne=ne||0,fe=fe||0,this.pdf.internal.out(t(W+ne)+" "+r(Q+fe)+" l")},X=function(W,Q,ne){return this.pdf.lines(W,Q,ne,null,null)},ue=function(W,Q,ne,fe,ve,we,Se,Ce){this.pdf.internal.out([e(i(ne+W)),e(o(fe+Q)),e(i(ve+W)),e(o(we+Q)),e(i(Se+W)),e(o(Ce+Q)),"c"].join(" "))},ge=function(W,Q,ne,fe){for(var ve=2*Math.PI,we=Math.PI/2;Q>ne;)Q-=ve;var Se=Math.abs(ne-Q);Se<ve&&fe&&(Se=ve-Se);for(var Ce=[],Fe=fe?-1:1,qe=Q;Se>1e-5;){var Ne=qe+Fe*Math.min(Se,we);Ce.push(he.call(this,W,qe,Ne)),Se-=Math.abs(Ne-qe),qe=Ne}return Ce},he=function(W,Q,ne){var fe=(ne-Q)/2,ve=W*Math.cos(fe),we=W*Math.sin(fe),Se=ve,Ce=-we,Fe=Se*Se+Ce*Ce,qe=Fe+Se*ve+Ce*we,Ne=4/3*(Math.sqrt(2*Fe*qe)-qe)/(Se*we-Ce*ve),Oe=Se-Ne*Ce,Qe=Ce+Ne*Se,te=Oe,rt=-Qe,zt=fe+Q,gt=Math.cos(zt),He=Math.sin(zt);return{x1:W*Math.cos(Q),y1:W*Math.sin(Q),x2:Oe*gt-Qe*He,y2:Oe*He+Qe*gt,x3:te*gt-rt*He,y3:te*He+rt*gt,x4:W*Math.cos(ne),y4:W*Math.sin(ne)}},$=function(W){return 180*W/Math.PI},le=function(W,Q,ne,fe,ve,we){var Se=W+.5*(ne-W),Ce=Q+.5*(fe-Q),Fe=ve+.5*(ne-ve),qe=we+.5*(fe-we),Ne=Math.min(W,ve,Se,Fe),Oe=Math.max(W,ve,Se,Fe),Qe=Math.min(Q,we,Ce,qe),te=Math.max(Q,we,Ce,qe);return new a(Ne,Qe,Oe-Ne,te-Qe)},ae=function(W,Q,ne,fe,ve,we,Se,Ce){var Fe,qe,Ne,Oe,Qe,te,rt,zt,gt,He,ft,lt,Et,pt,En=ne-W,$t=fe-Q,Qt=ve-ne,an=we-fe,qt=Se-ve,vt=Ce-we;for(qe=0;qe<41;qe++)gt=(rt=(Ne=W+(Fe=qe/40)*En)+Fe*((Qe=ne+Fe*Qt)-Ne))+Fe*(Qe+Fe*(ve+Fe*qt-Qe)-rt),He=(zt=(Oe=Q+Fe*$t)+Fe*((te=fe+Fe*an)-Oe))+Fe*(te+Fe*(we+Fe*vt-te)-zt),qe==0?(ft=gt,lt=He,Et=gt,pt=He):(ft=Math.min(ft,gt),lt=Math.min(lt,He),Et=Math.max(Et,gt),pt=Math.max(pt,He));return new a(Math.round(ft),Math.round(lt),Math.round(Et-ft),Math.round(pt-lt))},J=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var W,Q,ne=(W=this.ctx.lineDash,Q=this.ctx.lineDashOffset,JSON.stringify({lineDash:W,lineDashOffset:Q}));this.prevLineDash!==ne&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=ne)}}})(Wt.API),(function(n){var e=function(s){var a,u,l,h,d,m,p,y,b,x;for(u=[],l=0,h=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;h>l;l+=4)(d=(s.charCodeAt(l)<<24)+(s.charCodeAt(l+1)<<16)+(s.charCodeAt(l+2)<<8)+s.charCodeAt(l+3))!==0?(m=(d=((d=((d=((d=(d-(x=d%85))/85)-(b=d%85))/85)-(y=d%85))/85)-(p=d%85))/85)%85,u.push(m+33,p+33,y+33,b+33,x+33)):u.push(122);return(function(E,T){for(var P=T;P>0;P--)E.pop()})(u,a.length),String.fromCharCode.apply(String,u)+"~>"},t=function(s){var a,u,l,h,d,m=String,p="length",y=255,b="charCodeAt",x="slice",E="replace";for(s[x](-2),s=s[x](0,-2)[E](/\s/g,"")[E]("z","!!!!!"),l=[],h=0,d=(s+=a="uuuuu"[x](s[p]%5||5))[p];d>h;h+=5)u=52200625*(s[b](h)-33)+614125*(s[b](h+1)-33)+7225*(s[b](h+2)-33)+85*(s[b](h+3)-33)+(s[b](h+4)-33),l.push(y&u>>24,y&u>>16,y&u>>8,y&u);return(function(T,P){for(var I=P;I>0;I--)T.pop()})(l,a[p]),m.fromCharCode.apply(m,l)},r=function(s){return s.split("").map(function(a){return("0"+a.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var u="",l=0;l<s.length;l+=2)u+=String.fromCharCode("0x"+(s[l]+s[l+1]));return u},o=function(s){for(var a=new Uint8Array(s.length),u=s.length;u--;)a[u]=s.charCodeAt(u);return(a=Cw(a)).reduce(function(l,h){return l+String.fromCharCode(h)},"")};n.processDataByFilters=function(s,a){var u=0,l=s||"",h=[];for(typeof(a=a||[])=="string"&&(a=[a]),u=0;u<a.length;u+=1)switch(a[u]){case"ASCII85Decode":case"/ASCII85Decode":l=t(l),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=i(l),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=r(l),h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=o(l),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[u]+'" is not implemented')}return{data:l,reverseChain:h.reverse().join(" ")}}})(Wt.API),(function(n){n.loadFile=function(e,t,r){return(function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var a=void 0;try{a=(function(u,l,h){var d=new XMLHttpRequest,m=0,p=function(y){var b=y.length,x=[],E=String.fromCharCode;for(m=0;m<b;m+=1)x.push(E(255&y.charCodeAt(m)));return x.join("")};if(d.open("GET",u,!l),d.overrideMimeType("text/plain; charset=x-user-defined"),l===!1&&(d.onload=function(){d.status===200?h(p(this.responseText)):h(void 0)}),d.send(null),l&&d.status===200)return p(d.responseText)})(i,o,s)}catch{}return a})(e,t,r)},n.loadImageFile=n.loadFile})(Wt.API),(function(n){function e(){return(pn.html2canvas?Promise.resolve(pn.html2canvas):n2(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function t(){return(pn.DOMPurify?Promise.resolve(pn.DOMPurify):n2(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var r=function(a){var u=fr(a);return u==="undefined"?"undefined":u==="string"||a instanceof String?"string":u==="number"||a instanceof Number?"number":u==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":u==="object"?"object":"unknown"},i=function(a,u){var l=document.createElement(a);for(var h in u.className&&(l.className=u.className),u.innerHTML&&u.dompurify&&(l.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)l.style[h]=u.style[h];return l},o=function a(u,l){for(var h=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),d=u.firstChild;d;d=d.nextSibling)l!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||h.appendChild(a(d,l));return u.nodeType===1&&(u.nodeName==="CANVAS"?(h.width=u.width,h.height=u.height,h.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(h.value=u.value),h.addEventListener("load",function(){h.scrollTop=u.scrollTop,h.scrollLeft=u.scrollLeft},!0)),h},s=function a(u){var l=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),h=a.convert(Promise.resolve(),l);return(h=h.setProgress(1,a,1,[a])).set(u)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,u){return a.__proto__=u||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,u){return this.then(function(){switch(u=u||(function(l){switch(r(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(a),u){case"string":return this.then(t).then(function(l){return this.set({src:i("div",{innerHTML:a,dompurify:l})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=o(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(u){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,u(this.prop.container,l)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(u){var l=this.opt.jsPDF,h=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=h,h)for(var p=0;p<h.length;++p){var y=h[p],b=y.src.find(function(x){return x.format==="truetype"});b&&l.addFont(b.url,y.ref.name,y.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,l.context2d.save(!0),u(this.prop.container,m)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,u,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(a,u):this.outputPdf(a,u)},s.prototype.outputPdf=function(a,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,u)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(r(a)!=="object")return this;var u=Object.keys(a||{}).map(function(l){if(l in s.template.prop)return function(){this.prop[l]=a[l]};switch(l){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[l]=a[l]}}},this);return this.then(function(){return this.thenList(u)})},s.prototype.get=function(a,u){return this.then(function(){var l=a in s.template.prop?this.prop[a]:this.opt[a];return u?u(l):l})},s.prototype.setMargin=function(a){return this.then(function(){switch(r(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function u(l,h){return Math.floor(l*h/72*96)}return this.then(function(){(a=a||Wt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:u(a.inner.width,a.k),height:u(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,u,l,h){return a!=null&&(this.progress.val=a),u!=null&&(this.progress.state=u),l!=null&&(this.progress.n=l),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,u,l,h){return this.setProgress(a?this.progress.val+a:null,u||null,l?this.progress.n+l:null,h?this.progress.stack.concat(h):null)},s.prototype.then=function(a,u){var l=this;return this.thenCore(a,u,function(h,d){return l.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(m){return l.updateProgress(null,h),m}).then(h,d).then(function(m){return l.updateProgress(1),m})})},s.prototype.thenCore=function(a,u,l){l=l||Promise.prototype.then;var h=this;a&&(a=a.bind(h)),u&&(u=u.bind(h));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?h:s.convert(Object.assign({},h),Promise.prototype),m=l.call(d,a,u);return s.convert(m,h.__proto__)},s.prototype.thenExternal=function(a,u){return Promise.prototype.then.call(this,a,u)},s.prototype.thenList=function(a){var u=this;return a.forEach(function(l){u=u.thenCore(l)}),u},s.prototype.catch=function(a){a&&(a=a.bind(this));var u=Promise.prototype.catch.call(this,a);return s.convert(u,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Wt.getPageSize=function(a,u,l){if(fr(a)==="object"){var h=a;a=h.orientation,u=h.unit||u,l=h.format||l}u=u||"mm",l=l||"a4",a=(""+(a||"P")).toLowerCase();var d,m=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+u}var y,b=0,x=0;if(p.hasOwnProperty(m))b=p[m][1]/d,x=p[m][0]/d;else try{b=l[1],x=l[0]}catch{throw new Error("Invalid format: "+l)}if(a==="p"||a==="portrait")a="p",x>b&&(y=x,x=b,b=y);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",b>x&&(y=x,x=b,b=y)}return{width:x,height:b,unit:u,k:d,orientation:a}},n.html=function(a,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(b2):null;var l=new s(u);return u.worker?l:l.from(a).doCallback()}})(Wt.API),Wt.API.addJS=function(n){return iC=n,this.internal.events.subscribe("postPutResources",function(){gv=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(gv+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),rC=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+iC+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){gv!==void 0&&rC!==void 0&&this.internal.out("/Names <</JavaScript "+gv+" 0 R>>")}),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=t.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],a=r.exec(s);if(a!=null){var u=a[1];t.internal.newObjectDeferredBegin(u,!1)}t.internal.write(s)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,h=[];for(o=0;o<l;o++){var d=t.internal.newObject();h.push(d);var m=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<h.length;o++)t.internal.write("(page_"+(o+1)+")"+h[o]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,i,o){var s={title:i,options:o,children:[]};return r==null&&(r=this.root),r.children.push(s),s},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<r.children.length;o++){var s=r.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(r)),o>0&&this.line("/Prev "+this.makeRef(r.children[o-1])),o<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var a=this.count=this.count_r({count:0},s);if(a>0&&this.line("/Count "+a),s.options&&s.options.pageNumber){var u=t.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var l=0;l<r.children.length;l++)this.renderItems(r.children[l])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,i){for(var o=0;o<i.children.length;o++)r.count++,this.count_r(r,i.children[o]);return r.count}}])})(Wt.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,r,i,o,s,a){var u,l=this.decode.DCT_DECODE,h=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=s||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,u=(function(d){for(var m,p=256*d.charCodeAt(4)+d.charCodeAt(5),y=d.length,b={width:0,height:0,numcomponents:1},x=4;x<y;x+=2){if(x+=p,e.indexOf(d.charCodeAt(x+1))!==-1){m=256*d.charCodeAt(x+5)+d.charCodeAt(x+6),b={width:256*d.charCodeAt(x+7)+d.charCodeAt(x+8),height:m,numcomponents:d.charCodeAt(x+9)};break}p=256*d.charCodeAt(x+2)+d.charCodeAt(x+3)}return b})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),u.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}h={data:t,width:u.width,height:u.height,colorSpace:a,bitsPerComponent:8,filter:l,index:r,alias:i}}return h}})(Wt.API),Wt.API.processPNG=function(n,e,t,r){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var i,o=Wq(n,{checkCrc:!0}),s=o.width,a=o.height,u=o.channels,l=o.palette,h=o.depth;i=l&&u===1?(function(C){for(var A=C.width,M=C.height,k=C.data,O=C.palette,j=C.depth,X=!1,ue=[],ge=[],he=void 0,$=!1,le=0,ae=0;ae<O.length;ae++){var J=uA(O[ae],4),W=J[0],Q=J[1],ne=J[2],fe=J[3];ue.push(W,Q,ne),fe!=null&&(fe===0?(le++,ge.length<1&&ge.push(ae)):fe<255&&($=!0))}if($||le>1){X=!0,ge=void 0;var ve=A*M;he=new Uint8Array(ve);for(var we=new DataView(k.buffer),Se=0;Se<ve;Se++){var Ce=_2(we,Se,j),Fe=uA(O[Ce],4)[3];he[Se]=Fe}}else le===0&&(ge=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:X?8:void 0,colorBytes:k,alphaBytes:he,needSMask:X,palette:ue,mask:ge}})(o):u===2||u===4?(function(C){for(var A=C.data,M=C.width,k=C.height,O=C.channels,j=C.depth,X=O===2?"DeviceGray":"DeviceRGB",ue=O-1,ge=M*k,he=ue,$=ge*he,le=1*ge,ae=Math.ceil($*j/8),J=Math.ceil(le*j/8),W=new Uint8Array(ae),Q=new Uint8Array(J),ne=new DataView(A.buffer),fe=new DataView(W.buffer),ve=new DataView(Q.buffer),we=!1,Se=0;Se<ge;Se++){for(var Ce=Se*O,Fe=0;Fe<he;Fe++)dC(fe,_2(ne,Ce+Fe,j),Se*he+Fe,j);var qe=_2(ne,Ce+he,j);qe<(1<<j)-1&&(we=!0),dC(ve,qe,1*Se,j)}return{colorSpace:X,colorsPerPixel:ue,sMaskBitsPerComponent:we?j:void 0,colorBytes:W,alphaBytes:Q,needSMask:we}})(o):(function(C){var A=C.data,M=C.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:M,colorsPerPixel:M==="DeviceGray"?1:3,colorBytes:A instanceof Uint16Array?(function(k){for(var O=k.length,j=new Uint8Array(2*O),X=new DataView(j.buffer,j.byteOffset,j.byteLength),ue=0;ue<O;ue++)X.setUint16(2*ue,k[ue],!1);return j})(A):A,needSMask:!1}})(o);var d,m,p,y=i,b=y.colorSpace,x=y.colorsPerPixel,E=y.sMaskBitsPerComponent,T=y.colorBytes,P=y.alphaBytes,I=y.needSMask,D=y.palette,U=y.mask,L=null;return r!==Wt.API.image_compression.NONE&&typeof Cw=="function"?(L=(function(C){var A;switch(C){case Wt.API.image_compression.FAST:A=11;break;case Wt.API.image_compression.MEDIUM:A=13;break;case Wt.API.image_compression.SLOW:A=14;break;default:A=12}return A})(r),d=this.decode.FLATE_DECODE,m="/Predictor ".concat(L," /Colors ").concat(x," /BitsPerComponent ").concat(h," /Columns ").concat(s),n=uC(T,Math.ceil(s*x*h/8),x,h,r),I&&(p=uC(P,Math.ceil(s*E/8),1,E,r))):(d=void 0,m=void 0,n=T,I&&(p=P)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:t,data:n,index:e,filter:d,decodeParameters:m,transparency:U,palette:D,sMask:p,predictor:L,width:s,height:a,bitsPerComponent:h,sMaskBitsPerComponent:E,colorSpace:b}}},(function(n){n.processGIF89A=function(e,t,r,i){var o=new cH(e),s=o.width,a=o.height,u=[];o.decodeAndBlitFrameRGBA(0,u);var l={data:u,width:s,height:a},h=new E2(100).encode(l,100);return n.processJPEG.call(this,h,t,r,i)},n.processGIF87A=n.processGIF89A})(Wt.API),pu.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},pu.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){_r.log("bit decode error:"+t)}},pu.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+8*i*4,a=0;a<8&&8*i+a<this.width;a++){var u=this.palette[o>>7-a&1];this.data[s+4*a]=u.blue,this.data[s+4*a+1]=u.green,this.data[s+4*a+2]=u.red,this.data[s+4*a+3]=255}t!==0&&(this.pos+=4-t)}},pu.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<n;i++){var o=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+2*i*4,a=o>>4,u=15&o,l=this.palette[a];if(this.data[s]=l.blue,this.data[s+1]=l.green,this.data[s+2]=l.red,this.data[s+3]=255,2*i+1>=this.width)break;l=this.palette[u],this.data[s+4]=l.blue,this.data[s+4+1]=l.green,this.data[s+4+2]=l.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},pu.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}n!==0&&(this.pos+=4-n)}},pu.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,a=(o>>5&e)/e*255|0,u=(o>>10&e)/e*255|0,l=o>>15?255:0,h=r*this.width*4+4*i;this.data[h]=u,this.data[h+1]=a,this.data[h+2]=s,this.data[h+3]=l}this.pos+=n}},pu.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,u=(s>>5&t)/t*255|0,l=(s>>11)/e*255|0,h=i*this.width*4+4*o;this.data[h]=l,this.data[h+1]=u,this.data[h+2]=a,this.data[h+3]=255}this.pos+=n}},pu.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*t;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=r,this.data[s+3]=255}this.pos+=this.width%4}},pu.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=o,this.data[a+1]=i,this.data[a+2]=r,this.data[a+3]=s}},pu.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,r,i){var o=new pu(e,!1),s=o.width,a=o.height,u={data:o.getData(),width:s,height:a},l=new E2(100).encode(u,100);return n.processJPEG.call(this,l,t,r,i)}})(Wt.API),mC.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,r,i){var o=new mC(e),s=o.width,a=o.height,u={data:o.getData(),width:s,height:a},l=new E2(100).encode(u,100);return n.processJPEG.call(this,l,t,r,i)}})(Wt.API),Wt.API.processRGBA=function(n,e,t){for(var r=n.data,i=r.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),a=0,u=0,l=0;l<i;l+=4){var h=r[l],d=r[l+1],m=r[l+2],p=r[l+3];o[a++]=h,o[a++]=d,o[a++]=m,s[u++]=p}var y=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:y,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},Wt.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},nd=Wt.API,vv=nd.getCharWidthsArray=function(n,e){var t,r,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:i.metadata.Unicode.widths,u=a.fof?a.fof:1,l=e.kerning?e.kerning:i.metadata.Unicode.kerning,h=l.fof?l.fof:1,d=e.doKerning!==!1,m=0,p=n.length,y=0,b=a[0]||u,x=[];for(t=0;t<p;t++)r=n.charCodeAt(t),typeof i.metadata.widthOfString=="function"?x.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+s*(1e3/o)||0)/1e3):(m=d&&fr(l[r])==="object"&&!isNaN(parseInt(l[r][y],10))?l[r][y]/h:0,x.push((a[r]||b)/u+m)),y=r;return x},oC=nd.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return nd.processArabic&&(n=nd.processArabic(n)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(n,t,i)/t:vv.apply(this,arguments).reduce(function(o,s){return o+s},0)},sC=function(n,e,t,r){for(var i=[],o=0,s=n.length,a=0;o!==s&&a+e[o]<t;)a+=e[o],o++;i.push(n.slice(0,o));var u=o;for(a=0;o!==s;)a+e[o]>r&&(i.push(n.slice(u,o)),a=0,u=o),a+=e[o],o++;return u!==o&&i.push(n.slice(u,o)),i},aC=function(n,e,t){t||(t={});var r,i,o,s,a,u,l,h=[],d=[h],m=t.textIndent||0,p=0,y=0,b=n.split(" "),x=vv.apply(this,[" ",t])[0];if(u=t.lineIndent===-1?b[0].length+2:t.lineIndent||0){var E=Array(u).join(" "),T=[];b.map(function(I){(I=I.split(/\s*\n/)).length>1?T=T.concat(I.map(function(D,U){return(U&&D.length?`
`:"")+D})):T.push(I[0])}),b=T,u=oC.apply(this,[E,t])}for(o=0,s=b.length;o<s;o++){var P=0;if(r=b[o],u&&r[0]==`
`&&(r=r.substr(1),P=1),m+p+(y=(i=vv.apply(this,[r,t])).reduce(function(I,D){return I+D},0))>e||P){if(y>e){for(a=sC.apply(this,[r,i,e-(m+p),e]),h.push(a.shift()),h=[a.pop()];a.length;)d.push([a.shift()]);y=i.slice(r.length-(h[0]?h[0].length:0)).reduce(function(I,D){return I+D},0)}else h=[r];d.push(h),m=y+u,p=x}else h.push(r),m+=p+y,p=x}return l=u?function(I,D){return(D?E:"")+I.join(" ")}:function(I){return I.join(" ")},d.map(l)},nd.splitTextToSize=function(n,e,t){var r,i=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var d=this.internal.getFont(h.fontName,h.fontStyle),m="Unicode";return d.metadata[m]?{widths:d.metadata[m].widths||{0:1},kerning:d.metadata[m].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(n)?n:String(n).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=t.lineIndent;var a,u,l=[];for(a=0,u=r.length;a<u;a++)l=l.concat(aC.apply(this,[r[a],s,o]));return l},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",r={},i={},o=0;o<16;o++)r[t[o]]=e[o],i[e[o]]=t[o];var s=function(m){return"0x"+parseInt(m,10).toString(16)},a=n.__fontmetrics__.compress=function(m){var p,y,b,x,E=["{"];for(var T in m){if(p=m[T],isNaN(parseInt(T,10))?y="'"+T+"'":(T=parseInt(T,10),y=(y=s(T).slice(2)).slice(0,-1)+i[y.slice(-1)]),typeof p=="number")p<0?(b=s(p).slice(3),x="-"):(b=s(p).slice(2),x=""),b=x+b.slice(0,-1)+i[b.slice(-1)];else{if(fr(p)!=="object")throw new Error("Don't know what to do with value type "+fr(p)+".");b=a(p)}E.push(y+b)}return E.push("}"),E.join("")},u=n.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,y,b,x,E={},T=1,P=E,I=[],D="",U="",L=m.length-1,C=1;C<L;C+=1)(x=m[C])=="'"?p?(b=p.join(""),p=void 0):p=[]:p?p.push(x):x=="{"?(I.push([P,b]),P={},b=void 0):x=="}"?((y=I.pop())[0][y[1]]=P,b=void 0,P=y[0]):x=="-"?T=-1:b===void 0?r.hasOwnProperty(x)?(D+=r[x],b=parseInt(D,16)*T,T=1,D=""):D+=x:r.hasOwnProperty(x)?(U+=r[x],P[b]=parseInt(U,16)*T,T=1,b=void 0,U=""):U+=x;return E},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},d={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(m){var p=m.font,y=d.Unicode[p.postScriptName];y&&(p.metadata.Unicode={},p.metadata.Unicode.widths=y.widths,p.metadata.Unicode.kerning=y.kerning);var b=h.Unicode[p.postScriptName];b&&(p.metadata.Unicode.encoding=b,p.encoding=b.codePages[0])}])})(Wt.API),(function(n){var e=function(t){for(var r=t.length,i=new Uint8Array(r),o=0;o<r;o++)i[o]=t.charCodeAt(o);return i};n.API.events.push(["addFont",function(t){var r=void 0,i=t.font,o=t.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(kv(a)),s.metadata=n.API.TTFFont.open(a),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,r)}}])})(Wt),Wt.API.addSvgAsImage=function(n,e,t,r,i,o,s,a){if(isNaN(e)||isNaN(t))throw _r.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(i))throw _r.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=r,u.height=i;var l=u.getContext("2d");l.fillStyle="#fff",l.fillRect(0,0,u.width,u.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(pn.canvg?Promise.resolve(pn.canvg):n2(()=>import("./index.es-B9__QCHh.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(l,n,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(h)}).then(function(){d.addImage(u.toDataURL("image/jpeg",1),e,t,r,i,s,a)})},Wt.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,t);return this},Wt.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var r,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(s),u=[],l=0,h=0,d=0;function m(y,b){var x,E=!1;for(x=0;x<y.length;x+=1)y[x]===b&&(E=!0);return E}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var p=a.length;for(d=0;d<p;d+=1)t[a[d]].value=t[a[d]].defaultValue,t[a[d]].explicitSet=!1}if(fr(n)==="object"){for(i in n)if(o=n[i],m(a,i)&&o!==void 0){if(t[i].type==="boolean"&&typeof o=="boolean")t[i].value=o;else if(t[i].type==="name"&&m(t[i].valueSet,o))t[i].value=o;else if(t[i].type==="integer"&&Number.isInteger(o))t[i].value=o;else if(t[i].type==="array"){for(l=0;l<o.length;l+=1)if(r=!0,o[l].length===1&&typeof o[l][0]=="number")u.push(String(o[l]-1));else if(o[l].length>1){for(h=0;h<o[l].length;h+=1)typeof o[l][h]!="number"&&(r=!1);r===!0&&u.push([o[l][0]-1,o[l][1]-1].join(" "))}t[i].value="["+u.join(" ")+"]"}else t[i].value=t[i].defaultValue;t[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,b=[];for(y in t)t[y].explicitSet===!0&&(t[y].type==="name"?b.push("/"+y+" /"+t[y].value):b.push("/"+y+" "+t[y].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(r)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),l=o.length+s.length+a.length+i.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+a+u),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(Wt.API),(function(n){var e=n.API,t=e.pdfEscape16=function(o,s){for(var a,u=s.metadata.Unicode.widths,l=["","0","00","000","0000"],h=[""],d=0,m=o.length;d<m;++d){if(a=s.metadata.characterToGlyph(o.charCodeAt(d)),s.metadata.glyIdsUsed.push(a),s.metadata.toUnicode[a]=o.charCodeAt(d),u.indexOf(a)==-1&&(u.push(a),u.push([parseInt(s.metadata.widthOfGlyph(a),10)])),a=="0")return h.join("");a=a.toString(16),h.push(l[4-a.length],a)}return h.join("")},r=function(o){var s,a,u,l,h,d,m;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],d=0,m=(a=Object.keys(o).sort(function(p,y){return p-y})).length;d<m;d++)s=a[d],u.length>=100&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(l=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),u.push("<"+s+"><"+l+">"));return u.length&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),h+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var a=s.font,u=s.out,l=s.newObject,h=s.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="Identity-H"){for(var d=a.metadata.Unicode.widths,m=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),p="",y=0;y<m.length;y++)p+=String.fromCharCode(m[y]);var b=l();h({data:p,addLength1:!0,objectId:b}),u("endobj");var x=l();h({data:r(a.metadata.toUnicode),addLength1:!0,objectId:x}),u("endobj");var E=l();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+ud(a.fontName)),u("/FontFile2 "+b+" 0 R"),u("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),u("/Flags "+a.metadata.flags),u("/StemV "+a.metadata.stemV),u("/ItalicAngle "+a.metadata.italicAngle),u("/Ascent "+a.metadata.ascender),u("/Descent "+a.metadata.decender),u("/CapHeight "+a.metadata.capHeight),u(">>"),u("endobj");var T=l();u("<<"),u("/Type /Font"),u("/BaseFont /"+ud(a.fontName)),u("/FontDescriptor "+E+" 0 R"),u("/W "+n.API.PDFObject.convert(d)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+a.encoding+")"),u(">>"),u(">>"),u("endobj"),a.objectNumber=l(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+x+" 0 R"),u("/BaseFont /"+ud(a.fontName)),u("/Encoding /"+a.encoding),u("/DescendantFonts ["+T+" 0 R]"),u(">>"),u("endobj"),a.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var a=s.font,u=s.out,l=s.newObject,h=s.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var d=a.metadata.rawData,m="",p=0;p<d.length;p++)m+=String.fromCharCode(d[p]);var y=l();h({data:m,addLength1:!0,objectId:y}),u("endobj");var b=l();h({data:r(a.metadata.toUnicode),addLength1:!0,objectId:b}),u("endobj");var x=l();u("<<"),u("/Descent "+a.metadata.decender),u("/CapHeight "+a.metadata.capHeight),u("/StemV "+a.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+y+" 0 R"),u("/Flags 96"),u("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),u("/FontName /"+ud(a.fontName)),u("/ItalicAngle "+a.metadata.italicAngle),u("/Ascent "+a.metadata.ascender),u(">>"),u("endobj"),a.objectNumber=l();for(var E=0;E<a.metadata.hmtx.widths.length;E++)a.metadata.hmtx.widths[E]=parseInt(a.metadata.hmtx.widths[E]*(1e3/a.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+ud(a.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),u("endobj"),a.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,a=o.text||"",u=o.x,l=o.y,h=o.options||{},d=o.mutex||{},m=d.pdfEscape,p=d.activeFontKey,y=d.fonts,b=p,x="",E=0,T="",P=y[b].encoding;if(y[b].encoding!=="Identity-H")return{text:a,x:u,y:l,options:h,mutex:d};for(T=a,b=p,Array.isArray(a)&&(T=a[0]),E=0;E<T.length;E+=1)y[b].metadata.hasOwnProperty("cmap")&&(s=y[b].metadata.cmap.unicode.codeMap[T[E].charCodeAt(0)]),s||T[E].charCodeAt(0)<256&&y[b].metadata.hasOwnProperty("Unicode")?x+=T[E]:x+="";var I="";return parseInt(b.slice(1))<14||P==="WinAnsiEncoding"?I=m(x,b).split("").map(function(D){return D.charCodeAt(0).toString(16)}).join(""):P==="Identity-H"&&(I=t(x,y[b])),d.isHex=!0,{text:I,x:u,y:l,options:h,mutex:d}};e.events.push(["postProcessText",function(o){var s=o.text||"",a=[],u={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var l=0;for(l=0;l<s.length;l+=1)Array.isArray(s[l])&&s[l].length===3?a.push([i(Object.assign({},u,{text:s[l][0]})).text,s[l][1],s[l][2]]):a.push(i(Object.assign({},u,{text:s[l]})).text);o.text=a}else o.text=i(Object.assign({},u,{text:s})).text}])})(Wt),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,r){return e.call(this),this.internal.vFS[t]=r,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(Wt.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(r){var i,o,s,a,u,l,h,d=e,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],E=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),T=!1,P=0;this.__bidiEngine__={};var I=function(k){var O=k.charCodeAt(),j=O>>8,X=b[j];return X!==void 0?d[256*X+(255&O)]:j===252||j===253?"AL":E.test(j)?"L":j===8?"R":"N"},D=function(k){for(var O,j=0;j<k.length;j++){if((O=I(k.charAt(j)))==="L")return!1;if(O==="R")return!0}return!1},U=function(k,O,j,X){var ue,ge,he,$,le=O[X];switch(le){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":T=!1;break;case"N":case"AN":break;case"EN":T&&(le="AN");break;case"AL":T=!0,le="R";break;case"WS":case"BN":le="N";break;case"CS":X<1||X+1>=O.length||(ue=j[X-1])!=="EN"&&ue!=="AN"||(ge=O[X+1])!=="EN"&&ge!=="AN"?le="N":T&&(ge="AN"),le=ge===ue?ge:"N";break;case"ES":le=(ue=X>0?j[X-1]:"B")==="EN"&&X+1<O.length&&O[X+1]==="EN"?"EN":"N";break;case"ET":if(X>0&&j[X-1]==="EN"){le="EN";break}if(T){le="N";break}for(he=X+1,$=O.length;he<$&&O[he]==="ET";)he++;le=he<$&&O[he]==="EN"?"EN":"N";break;case"NSM":if(s&&!a){for($=O.length,he=X+1;he<$&&O[he]==="NSM";)he++;if(he<$){var ae=k[X],J=ae>=1425&&ae<=2303||ae===64286;if(ue=O[he],J&&(ue==="R"||ue==="AL")){le="R";break}}}le=X<1||(ue=O[X-1])==="B"?"N":j[X-1];break;case"B":T=!1,i=!0,le=P;break;case"S":o=!0,le="N"}return le},L=function(k,O,j){var X=k.split("");return j&&C(X,j,{hiLevel:P}),X.reverse(),O&&O.reverse(),X.join("")},C=function(k,O,j){var X,ue,ge,he,$,le=-1,ae=k.length,J=0,W=[],Q=P?p:m,ne=[];for(T=!1,i=!1,o=!1,ue=0;ue<ae;ue++)ne[ue]=I(k[ue]);for(ge=0;ge<ae;ge++){if($=J,W[ge]=U(k,ne,W,ge),X=240&(J=Q[$][y[W[ge]]]),J&=15,O[ge]=he=Q[J][5],X>0)if(X===16){for(ue=le;ue<ge;ue++)O[ue]=1;le=-1}else le=-1;if(Q[J][6])le===-1&&(le=ge);else if(le>-1){for(ue=le;ue<ge;ue++)O[ue]=he;le=-1}ne[ge]==="B"&&(O[ge]=0),j.hiLevel|=he}o&&(function(fe,ve,we){for(var Se=0;Se<we;Se++)if(fe[Se]==="S"){ve[Se]=P;for(var Ce=Se-1;Ce>=0&&fe[Ce]==="WS";Ce--)ve[Ce]=P}})(ne,O,ae)},A=function(k,O,j,X,ue){if(!(ue.hiLevel<k)){if(k===1&&P===1&&!i)return O.reverse(),void(j&&j.reverse());for(var ge,he,$,le,ae=O.length,J=0;J<ae;){if(X[J]>=k){for($=J+1;$<ae&&X[$]>=k;)$++;for(le=J,he=$-1;le<he;le++,he--)ge=O[le],O[le]=O[he],O[he]=ge,j&&(ge=j[le],j[le]=j[he],j[he]=ge);J=$}J++}}},M=function(k,O,j){var X=k.split(""),ue={hiLevel:P};return j||(j=[]),C(X,j,ue),(function(ge,he,$){if($.hiLevel!==0&&h)for(var le,ae=0;ae<ge.length;ae++)he[ae]===1&&(le=x.indexOf(ge[ae]))>=0&&(ge[ae]=x[le+1])})(X,j,ue),A(2,X,O,j,ue),A(1,X,O,j,ue),X.join("")};return this.__bidiEngine__.doBidiReorder=function(k,O,j){if((function(ue,ge){if(ge)for(var he=0;he<ue.length;he++)ge[he]=he;a===void 0&&(a=D(ue)),l===void 0&&(l=D(ue))})(k,O),s||!u||l)if(s&&u&&a^l)P=a?1:0,k=L(k,O,j);else if(!s&&u&&l)P=a?1:0,k=M(k,O,j),k=L(k,O);else if(!s||a||u||l){if(s&&!u&&a^l)k=L(k,O),a?(P=0,k=M(k,O,j)):(P=1,k=M(k,O,j),k=L(k,O));else if(s&&a&&!u&&l)P=1,k=M(k,O,j),k=L(k,O);else if(!s&&!u&&a^l){var X=h;a?(P=1,k=M(k,O,j),P=0,h=!1,k=M(k,O,j),h=X):(P=0,k=M(k,O,j),k=L(k,O),P=1,h=!1,k=M(k,O,j),h=X,k=L(k,O))}}else P=0,k=M(k,O,j);else P=a?1:0,k=M(k,O,j);return k},this.__bidiEngine__.setOptions=function(k){k&&(s=k.isInputVisual,u=k.isOutputVisual,a=k.isInputRtl,l=k.isOutputRtl,h=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(r){var i=r.text;r.x,r.y;var o=r.options||{};r.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var a=0;for(s=[],a=0;a<i.length;a+=1)Object.prototype.toString.call(i[a])==="[object Array]"?s.push([t.doBidiReorder(i[a][0]),i[a][1],i[a][2]]):s.push([t.doBidiReorder(i[a])]);r.text=s}else r.text=t.doBidiReorder(i);t.setOptions({isInputVisual:!0})}])})(Wt),Wt.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new hh(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new AH(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new hH(this.contents),this.head=new dH(this),this.name=new yH(this),this.cmap=new FN(this),this.toUnicode={},this.hhea=new pH(this),this.maxp=new wH(this),this.hmtx=new bH(this),this.post=new gH(this),this.os2=new mH(this),this.loca=new SH(this),this.glyf=new xH(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,r,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,a,u,l;for(l=[],s=0,a=(u=this.bbox).length;s<a;s++)e=u[s],l.push(Math.round(e*this.scaleFactor));return l}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(t=i>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,r){var i,o,s,a;for(s=0,o=0,a=(e=""+e).length;0<=a?o<a:o>a;o=0<=a?++o:--o)i=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/t)||0;return s*(t/1e3)},n.prototype.lineHeight=function(e,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},n})();var Tu,hh=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},n.prototype.writeString=function(e){var t,r,i;for(i=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)i.push(this.writeByte(e.charCodeAt(t)));return i},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,r,i,o,s,a,u;return e=this.readByte(),t=this.readByte(),r=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),a=this.readByte(),u=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^a)+(255^u)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*i+16777216*o+65536*s+256*a+u},n.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},n.prototype.write=function(e){var t,r,i,o;for(o=[],r=0,i=e.length;r<i;r++)t=e[r],o.push(this.writeByte(t));return o},n})(),hH=(function(){var n;function e(t){var r,i,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(t){var r,i,o,s,a,u,l,h,d,m,p,y,b;for(b in p=Object.keys(t).length,u=Math.log(2),d=16*Math.floor(Math.log(p)/u),s=Math.floor(d/u),h=16*p-d,(i=new hh).writeInt(this.scalarType),i.writeShort(p),i.writeShort(d),i.writeShort(s),i.writeShort(h),o=16*p,l=i.pos+o,a=null,y=[],t)for(m=t[b],i.writeString(b),i.writeInt(n(m)),i.writeInt(l),i.writeInt(m.length),y=y.concat(m),b==="head"&&(a=l),l+=m.length;l%4;)y.push(0),l++;return i.write(y),r=2981146554-n(i.data),i.pos=a+8,i.writeUInt32(r),i.data},n=function(t){var r,i,o,s;for(t=BN.call(t);t.length%4;)t.push(0);for(o=new hh(t),i=0,r=0,s=t.length;r<s;r=r+=4)i+=o.readUInt32();return 4294967295&i},e})(),fH={}.hasOwnProperty,bl=function(n,e){for(var t in e)fH.call(e,t)&&(n[t]=e[t]);function r(){this.constructor=n}return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};Tu=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var dH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var t;return(t=new hh).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},n})(),gC=(function(){function n(e,t){var r,i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=e.readByte();break;case 4:for(p=e.readUInt16(),m=p/2,e.pos+=6,o=(function(){var I,D;for(D=[],u=I=0;0<=m?I<m:I>m;u=0<=m?++I:--I)D.push(e.readUInt16());return D})(),e.pos+=2,b=(function(){var I,D;for(D=[],u=I=0;0<=m?I<m:I>m;u=0<=m?++I:--I)D.push(e.readUInt16());return D})(),l=(function(){var I,D;for(D=[],u=I=0;0<=m?I<m:I>m;u=0<=m?++I:--I)D.push(e.readUInt16());return D})(),h=(function(){var I,D;for(D=[],u=I=0;0<=m?I<m:I>m;u=0<=m?++I:--I)D.push(e.readUInt16());return D})(),i=(this.length-e.pos+this.offset)/2,a=(function(){var I,D;for(D=[],u=I=0;0<=i?I<i:I>i;u=0<=i?++I:--I)D.push(e.readUInt16());return D})(),u=E=0,P=o.length;E<P;u=++E)for(x=o[u],r=T=y=b[u];y<=x?T<=x:T>=x;r=y<=x?++T:--T)h[u]===0?s=r+l[u]:(s=a[h[u]/2+(r-y)-(m-u)]||0)!==0&&(s+=l[u]),this.codeMap[r]=65535&s}e.pos=d}return n.encode=function(e,t){var r,i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,I,D,U,L,C,A,M,k,O,j,X,ue,ge,he,$,le,ae,J,W,Q,ne,fe,ve,we,Se,Ce,Fe,qe,Ne;switch(X=new hh,s=Object.keys(e).sort(function(Oe,Qe){return Oe-Qe}),t){case"macroman":for(b=0,x=(function(){var Oe=[];for(y=0;y<256;++y)Oe.push(0);return Oe})(),T={0:0},o={},ue=0,le=s.length;ue<le;ue++)T[Ce=e[i=s[ue]]]==null&&(T[Ce]=++b),o[i]={old:e[i],new:T[e[i]]},x[i]=T[e[i]];return X.writeUInt16(1),X.writeUInt16(0),X.writeUInt32(12),X.writeUInt16(0),X.writeUInt16(262),X.writeUInt16(0),X.write(x),{charMap:o,subtable:X.data,maxGlyphID:b+1};case"unicode":for(O=[],d=[],P=0,T={},r={},E=l=null,ge=0,ae=s.length;ge<ae;ge++)T[D=e[i=s[ge]]]==null&&(T[D]=++P),r[i]={old:D,new:T[D]},a=T[D]-i,E!=null&&a===l||(E&&d.push(E),O.push(i),l=a),E=i;for(E&&d.push(E),d.push(65535),O.push(65535),M=2*(A=O.length),C=2*Math.pow(Math.log(A)/Math.LN2,2),m=Math.log(C/2)/Math.LN2,L=2*A-C,u=[],U=[],p=[],y=he=0,J=O.length;he<J;y=++he){if(k=O[y],h=d[y],k===65535){u.push(0),U.push(0);break}if(k-(j=r[k].new)>=32768)for(u.push(0),U.push(2*(p.length+A-y)),i=$=k;k<=h?$<=h:$>=h;i=k<=h?++$:--$)p.push(r[i].new);else u.push(j-k),U.push(0)}for(X.writeUInt16(3),X.writeUInt16(1),X.writeUInt32(12),X.writeUInt16(4),X.writeUInt16(16+8*A+2*p.length),X.writeUInt16(0),X.writeUInt16(M),X.writeUInt16(C),X.writeUInt16(m),X.writeUInt16(L),we=0,W=d.length;we<W;we++)i=d[we],X.writeUInt16(i);for(X.writeUInt16(0),Se=0,Q=O.length;Se<Q;Se++)i=O[Se],X.writeUInt16(i);for(Fe=0,ne=u.length;Fe<ne;Fe++)a=u[Fe],X.writeUInt16(a);for(qe=0,fe=U.length;qe<fe;qe++)I=U[qe],X.writeUInt16(I);for(Ne=0,ve=p.length;Ne<ve;Ne++)b=p[Ne],X.writeUInt16(b);return{charMap:r,subtable:X.data,maxGlyphID:P+1}}},n})(),FN=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="cmap",n.prototype.parse=function(e){var t,r,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)t=new gC(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(e,t){var r,i;return t==null&&(t="macroman"),r=gC.encode(e,t),(i=new hh).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},n})(),pH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n})(),mH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,r;for(r=[],t=0;t<10;++t)r.push(e.readByte());return r})(),this.charRange=(function(){var t,r;for(r=[],t=0;t<4;++t)r.push(e.readInt());return r})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,r;for(r=[],t=0;t<2;t=++t)r.push(e.readInt());return r})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n})(),gH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="post",n.prototype.parse=function(e){var t,r,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var o;for(r=e.readUInt16(),this.glyphNameIndex=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)t=e.readByte(),i.push(this.names.push(e.readString(t)));return i;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var s,a,u;for(u=[],o=s=0,a=this.file.maxp.numGlyphs;0<=a?s<a:s>a;o=0<=a?++s:--s)u.push(e.readUInt32());return u}).call(this)}},n})(),vH=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},yH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="name",n.prototype.parse=function(e){var t,r,i,o,s,a,u,l,h,d,m;for(e.pos=this.offset,e.readShort(),t=e.readShort(),a=e.readShort(),r=[],o=0;0<=t?o<t:o>t;o=0<=t?++o:--o)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+a+e.readShort()});for(u={},o=h=0,d=r.length;h<d;o=++h)i=r[o],e.pos=i.offset,l=e.readString(i.length),s=new vH(l,i),u[m=i.nameID]==null&&(u[m]=[]),u[i.nameID].push(s);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},n})(),wH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n})(),bH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="hmtx",n.prototype.parse=function(e){var t,r,i,o,s,a,u;for(e.pos=this.offset,this.metrics=[],t=0,a=this.file.hhea.numberOfMetrics;0<=a?t<a:t>a;t=0<=a?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var l,h;for(h=[],t=l=0;0<=i?l<i:l>i;t=0<=i?++l:--l)h.push(e.readInt16());return h})(),this.widths=(function(){var l,h,d,m;for(m=[],l=0,h=(d=this.metrics).length;l<h;l++)o=d[l],m.push(o.advance);return m}).call(this),r=this.widths[this.widths.length-1],u=[],t=s=0;0<=i?s<i:s>i;t=0<=i?++s:--s)u.push(this.widths.push(r));return u},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n})(),BN=[].slice,xH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var t,r,i,o,s,a,u,l,h,d;return e in this.cache?this.cache[e]:(o=this.file.loca,t=this.file.contents,r=o.indexOf(e),(i=o.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+r,s=(a=new hh(t.read(i))).readShort(),l=a.readShort(),d=a.readShort(),u=a.readShort(),h=a.readShort(),this.cache[e]=s===-1?new EH(a,l,d,u,h):new _H(a,s,l,d,u,h),this.cache[e]))},n.prototype.encode=function(e,t,r){var i,o,s,a,u;for(s=[],o=[],a=0,u=t.length;a<u;a++)i=e[t[a]],o.push(s.length),i&&(s=s.concat(i.encode(r)));return o.push(s.length),{table:s,offsets:o}},n})(),_H=(function(){function n(e,t,r,i,o,s){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),EH=(function(){function n(e,t,r,i,o){var s,a;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;a=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&a;)s.pos+=1&a?4:2,128&a?s.pos+=8:64&a?s.pos+=4:8&a&&(s.pos+=2)}return n.prototype.encode=function(){var e,t,r;for(t=new hh(BN.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),SH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="loca",n.prototype.parse=function(e){var t,r;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var i,o;for(o=[],r=0,i=this.length;r<i;r+=2)o.push(2*e.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],r=0,i=this.length;r<i;r+=4)o.push(e.readUInt32());return o}).call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,t){for(var r=new Uint32Array(this.offsets.length),i=0,o=0,s=0;s<r.length;++s)if(r[s]=i,o<t.length&&t[o]==s){++o,r[s]=i;var a=this.offsets[s],u=this.offsets[s+1]-a;u>0&&(i+=u)}for(var l=new Array(4*r.length),h=0;h<r.length;++h)l[4*h+3]=255&r[h],l[4*h+2]=(65280&r[h])>>8,l[4*h+1]=(16711680&r[h])>>16,l[4*h]=(4278190080&r[h])>>24;return l},n})(),AH=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,r,i,o;for(t in i=this.font.cmap.tables[0].codeMap,e={},o=this.subset)r=o[t],e[t]=i[r];return e},n.prototype.glyphsFor=function(e){var t,r,i,o,s,a,u;for(i={},s=0,a=e.length;s<a;s++)i[o=e[s]]=this.font.glyf.glyphFor(o);for(o in t=[],i)(r=i[o])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(o in u=this.glyphsFor(t))r=u[o],i[o]=r;return i},n.prototype.encode=function(e,t){var r,i,o,s,a,u,l,h,d,m,p,y,b,x,E;for(i in r=FN.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),p={0:0},E=r.charMap)p[(u=E[i]).old]=u.new;for(y in m=r.maxGlyphID,s)y in p||(p[y]=m++);return h=(function(T){var P,I;for(P in I={},T)I[T[P]]=P;return I})(p),d=Object.keys(h).sort(function(T,P){return T-P}),b=(function(){var T,P,I;for(I=[],T=0,P=d.length;T<P;T++)a=d[T],I.push(h[a]);return I})(),o=this.font.glyf.encode(s,b,p),l=this.font.loca.encode(o.offsets,b),x={cmap:this.font.cmap.raw(),glyf:o.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},n})();Wt.API.PDFObject=(function(){var n;function e(){}return n=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},e.convert=function(t){var r,i,o,s;if(Array.isArray(t))return"["+(function(){var a,u,l;for(l=[],a=0,u=t.length;a<u;a++)r=t[a],l.push(e.convert(r));return l})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(i in o=["<<"],t)s=t[i],o.push("/"+i+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+t},e})();const CH=()=>{const{incidentLog:n,addIncident:e,deleteIncident:t,setActiveMode:r,playSound:i,speak:o}=Eu(),[s,a]=$e.useState({title:"",location:"",details:"",severity:"Low"}),[u,l]=$e.useState(null),h=y=>{const b=y.toLowerCase();let x=[];(b.includes("fight")||b.includes("brawl"))&&x.push(" Increase security presence in sector."),(b.includes("weapon")||b.includes("gun")||b.includes("knife"))&&x.push(" CRITICAL: Contact Police immediately. Lockdown perimeter."),(b.includes("iron")||b.includes("knuckle"))&&x.push(" MANDATORY: Metal detector wands at entry."),(b.includes("drug")||b.includes("pill"))&&x.push(" Search bathrooms and VIP areas."),(b.includes("overcrowd")||b.includes("full"))&&x.push(" Halt entry. Check fire exits."),x.length>0?(l(x),b.includes("weapon")&&o("High alert. Weapon protocol suggested.")):l(null)},d=y=>{a({...s,details:y.target.value}),h(y.target.value)},m=()=>{s.title&&(e(s),a({title:"",location:"",details:"",severity:"Low"}),l(null))},p=y=>{const b=new Wt;b.setFillColor(0,0,0),b.rect(0,0,210,40,"F"),b.setTextColor(0,229,255),b.setFont("helvetica","bold"),b.setFontSize(22),b.text("T-FORCE SECURITY SITREP",15,20),b.setFontSize(10),b.text("INTERNAL CLASSIFIED REPORT",15,30),b.setTextColor(0,0,0),b.setFontSize(14),b.text(`INCIDENT: ${y.title}`,15,60),b.setFontSize(12),b.text(`DATE: ${y.date}`,15,70),b.text(`LOCATION: ${y.location}`,15,80),b.text(`SEVERITY: ${y.severity.toUpperCase()}`,15,90),b.line(15,95,195,95),b.setFont("helvetica","normal"),b.text("DETAILS:",15,110);const x=b.splitTextToSize(y.details,180);b.text(x,15,120),b.setTextColor(150),b.setFontSize(10),b.text("Generated by JARVIS Operational Unit",15,280),b.save(`T-Force_Report_${y.id}.pdf`),o("Report compiled and downloaded.")};return se.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[se.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[se.jsxs("div",{className:"flex items-center gap-3",children:[se.jsx("i",{className:"fas fa-file-alt text-cyan text-xl animate-pulse"}),se.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"INCIDENT LOG"})]}),se.jsx("button",{onClick:()=>{i("click"),r("HOME")},className:"text-cyan hover:text-white",children:se.jsx("i",{className:"fas fa-times text-2xl"})})]}),se.jsxs("div",{className:"flex-1 overflow-y-auto p-6 no-scrollbar",children:[se.jsxs("div",{className:"bg-cyan/5 border border-cyan/30 p-4 rounded mb-6",children:[se.jsxs("div",{className:"mb-4",children:[se.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"INCIDENT TYPE"}),se.jsx("input",{type:"text",value:s.title,onChange:y=>a({...s,title:y.target.value}),className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none focus:border-cyan",placeholder:"E.g., Fight at Bar"})]}),se.jsxs("div",{className:"flex gap-4 mb-4",children:[se.jsxs("div",{className:"flex-1",children:[se.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"LOCATION"}),se.jsx("input",{type:"text",value:s.location,onChange:y=>a({...s,location:y.target.value}),className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Mykonos Club"})]}),se.jsxs("div",{children:[se.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"SEVERITY"}),se.jsxs("select",{value:s.severity,onChange:y=>a({...s,severity:y.target.value}),className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none",children:[se.jsx("option",{children:"Low"}),se.jsx("option",{children:"Medium"}),se.jsx("option",{children:"High"}),se.jsx("option",{children:"Critical"})]})]})]}),se.jsxs("div",{className:"mb-4",children:[se.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"DETAILS"}),se.jsx("textarea",{value:s.details,onChange:d,rows:"4",className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Describe the situation..."})]}),u&&se.jsxs("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-500/50 rounded",children:[se.jsx("div",{className:"text-red-500 font-orbitron text-xs mb-2",children:" TACTICAL ANALYSIS:"}),u.map((y,b)=>se.jsx("div",{className:"text-red-300 text-xs font-mono",children:y},b))]}),se.jsx("button",{onClick:m,className:"w-full py-3 bg-cyan/20 border border-cyan text-cyan font-orbitron tracking-widest hover:bg-cyan/40",children:"LOG INCIDENT"})]}),se.jsx("div",{className:"space-y-4",children:n.map(y=>se.jsxs("div",{className:"border border-white/10 p-4 rounded bg-white/5 flex justify-between items-start",children:[se.jsxs("div",{children:[se.jsx("div",{className:"text-cyan font-bold font-orbitron",children:y.title}),se.jsxs("div",{className:"text-xs text-gray-400 font-mono mb-2",children:[y.date," | ",y.location]}),se.jsx("div",{className:"text-sm text-gray-300",children:y.details}),se.jsxs("div",{className:`mt-2 text-xs font-bold ${y.severity==="Critical"?"text-red-500":"text-cyan-dim"}`,children:["LEVEL: ",y.severity.toUpperCase()]})]}),se.jsxs("div",{className:"flex flex-col gap-2",children:[se.jsx("button",{onClick:()=>p(y),className:"p-2 border border-cyan/30 text-cyan rounded hover:bg-cyan/10",title:"Download PDF",children:se.jsx("i",{className:"fas fa-file-pdf"})}),se.jsx("button",{onClick:()=>t(y.id),className:"p-2 border border-red-500/30 text-red-500 rounded hover:bg-red-500/10",title:"Delete",children:se.jsx("i",{className:"fas fa-trash"})})]})]},y.id))})]})]})},IH=()=>{const{leadsLog:n,addLead:e,updateLeadStatus:t,deleteLead:r,setActiveMode:i,playSound:o,speak:s}=Eu(),[a,u]=$e.useState({name:"",location:"",type:"Factory"}),l=m=>{o("click"),s(`Initiating reconnaissance for ${m}.`),window.open(`https://www.google.com/maps/search/${m}+near+me`,"_blank")},h=()=>{a.name&&(e(a),u({name:"",location:"",type:"Factory"}))},d=m=>m==="Potential"?"text-gray-400 border-gray-500":m==="Contacted"?"text-orange-400 border-orange-500":m==="Contracted"?"text-green-400 border-green-500":"text-red-400 border-red-500";return se.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[se.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[se.jsxs("div",{className:"flex items-center gap-3",children:[se.jsx("i",{className:"fas fa-satellite-dish text-cyan text-xl animate-pulse"}),se.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"RECON / SALES"})]}),se.jsx("button",{onClick:()=>{o("click"),i("HOME")},className:"text-cyan hover:text-white",children:se.jsx("i",{className:"fas fa-times text-2xl"})})]}),se.jsxs("div",{className:"flex-1 overflow-y-auto p-6 no-scrollbar",children:[se.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[se.jsxs("button",{onClick:()=>l("Factories"),className:"p-4 border border-cyan/30 rounded bg-cyan/5 text-cyan hover:bg-cyan/20",children:[se.jsx("i",{className:"fas fa-industry text-2xl mb-2"}),se.jsx("div",{className:"font-orbitron text-xs",children:"FIND FACTORIES"})]}),se.jsxs("button",{onClick:()=>l("Hotels"),className:"p-4 border border-cyan/30 rounded bg-cyan/5 text-cyan hover:bg-cyan/20",children:[se.jsx("i",{className:"fas fa-hotel text-2xl mb-2"}),se.jsx("div",{className:"font-orbitron text-xs",children:"FIND HOTELS"})]})]}),se.jsxs("div",{className:"mb-6 border-t border-cyan/10 pt-4",children:[se.jsx("div",{className:"text-cyan-dim font-mono text-xs mb-2",children:"MANUAL LEAD ENTRY"}),se.jsxs("div",{className:"flex flex-col gap-3",children:[se.jsx("input",{type:"text",value:a.name,onChange:m=>u({...a,name:m.target.value}),className:"bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Business Name"}),se.jsx("input",{type:"text",value:a.location,onChange:m=>u({...a,location:m.target.value}),className:"bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Location"}),se.jsx("button",{onClick:h,className:"bg-cyan text-black font-bold py-2 rounded hover:bg-cyan/80",children:"ADD TARGET"})]})]}),se.jsx("div",{className:"space-y-3",children:n.map(m=>se.jsxs("div",{className:`border p-4 rounded flex justify-between items-center ${d(m.status)} bg-black`,children:[se.jsxs("div",{children:[se.jsx("div",{className:"font-bold font-orbitron",children:m.name}),se.jsxs("div",{className:"text-xs opacity-70",children:[m.location," | ",m.dateAdded]})]}),se.jsxs("div",{className:"flex flex-col items-end gap-2",children:[se.jsxs("select",{value:m.status,onChange:p=>t(m.id,p.target.value),className:"bg-black border border-white/20 text-xs p-1 outline-none rounded text-white",children:[se.jsx("option",{children:"Potential"}),se.jsx("option",{children:"Contacted"}),se.jsx("option",{children:"Meeting Set"}),se.jsx("option",{children:"Contracted"}),se.jsx("option",{children:"Dead Lead"})]}),se.jsx("button",{onClick:()=>r(m.id),className:"text-xs text-red-500 hover:text-red-300",children:"REMOVE"})]})]},m.id))})]})]})},TH=()=>{};var vC={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},kH=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[t++],s=n[t++],a=n[t++],u=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const o=n[t++],s=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},jN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const o=n[i],s=i+1<n.length,a=s?n[i+1]:0,u=i+2<n.length,l=u?n[i+2]:0,h=o>>2,d=(o&3)<<4|a>>4;let m=(a&15)<<2|l>>6,p=l&63;u||(p=64,s||(m=64)),r.push(t[h],t[d],t[m],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(VN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):kH(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const o=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const l=i<n.length?t[n.charAt(i)]:64;++i;const d=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||a==null||l==null||d==null)throw new NH;const m=o<<2|a>>4;if(r.push(m),l!==64){const p=a<<4&240|l>>2;if(r.push(p),d!==64){const y=l<<6&192|d;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class NH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const RH=function(n){const e=VN(n);return jN.encodeByteArray(e,!0)},E0=function(n){return RH(n).replace(/\./g,"")},UN=function(n){try{return jN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PH(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DH=()=>PH().__FIREBASE_DEFAULTS__,LH=()=>{if(typeof process>"u"||typeof vC>"u")return;const n=vC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},MH=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&UN(n[1]);return e&&JSON.parse(e)},u1=()=>{try{return TH()||DH()||LH()||MH()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},zN=n=>{var e,t;return(t=(e=u1())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},OH=n=>{const e=zN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},WN=()=>{var n;return(n=u1())==null?void 0:n.config},qN=n=>{var e;return(e=u1())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FH{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sp(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function HN(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BH(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[E0(JSON.stringify(t)),E0(JSON.stringify(s)),""].join(".")}const lm={};function VH(){const n={prod:[],emulator:[]};for(const e of Object.keys(lm))lm[e]?n.emulator.push(e):n.prod.push(e);return n}function jH(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let yC=!1;function GN(n,e){if(typeof window>"u"||typeof document>"u"||!sp(window.location.host)||lm[n]===e||lm[n]||yC)return;lm[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",o=VH().prod.length>0;function s(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function l(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{yC=!0,s()},m}function h(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function d(){const m=jH(r),p=t("text"),y=document.getElementById(p)||document.createElement("span"),b=t("learnmore"),x=document.getElementById(b)||document.createElement("a"),E=t("preprendIcon"),T=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const P=m.element;a(P),h(x,b);const I=l();u(T,E),P.append(T,y,x,I),document.body.appendChild(P)}o?(y.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function UH(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ls())}function zH(){var e;const n=(e=u1())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function WH(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function qH(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function HH(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GH(){const n=ls();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function $H(){return!zH()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KH(){try{return typeof indexedDB=="object"}catch{return!1}}function XH(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YH="FirebaseError";class lc extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=YH,Object.setPrototypeOf(this,lc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,eg.prototype.create)}}class eg{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?QH(o,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new lc(i,a,r)}}function QH(n,e){return n.replace(JH,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const JH=/\{\$([^}]+)}/g;function ZH(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function pf(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const o=n[i],s=e[i];if(wC(o)&&wC(s)){if(!pf(o,s))return!1}else if(o!==s)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function wC(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tg(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Kp(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Xp(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function eG(n,e){const t=new tG(n,e);return t.subscribe.bind(t)}class tG{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");nG(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=S2),i.error===void 0&&(i.error=S2),i.complete===void 0&&(i.complete=S2);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function nG(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function S2(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(n){return n&&n._delegate?n._delegate:n}class mf{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rG{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new FH;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(oG(e))try{this.getOrInitializeService({instanceIdentifier:Yh})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Yh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yh){return this.instances.has(e)}getOptions(e=Yh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&s.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:iG(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yh){return this.component?this.component.multipleInstances?e:Yh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iG(n){return n===Yh?void 0:n}function oG(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sG{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new rG(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Fn||(Fn={}));const aG={debug:Fn.DEBUG,verbose:Fn.VERBOSE,info:Fn.INFO,warn:Fn.WARN,error:Fn.ERROR,silent:Fn.SILENT},uG=Fn.INFO,lG={[Fn.DEBUG]:"log",[Fn.VERBOSE]:"log",[Fn.INFO]:"info",[Fn.WARN]:"warn",[Fn.ERROR]:"error"},cG=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=lG[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Xx{constructor(e){this.name=e,this._logLevel=uG,this._logHandler=cG,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aG[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fn.DEBUG,...e),this._logHandler(this,Fn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fn.VERBOSE,...e),this._logHandler(this,Fn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fn.INFO,...e),this._logHandler(this,Fn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fn.WARN,...e),this._logHandler(this,Fn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fn.ERROR,...e),this._logHandler(this,Fn.ERROR,...e)}}const hG=(n,e)=>e.some(t=>n instanceof t);let bC,xC;function fG(){return bC||(bC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dG(){return xC||(xC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $N=new WeakMap,Lw=new WeakMap,KN=new WeakMap,A2=new WeakMap,Yx=new WeakMap;function pG(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Zc(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&$N.set(t,n)}).catch(()=>{}),Yx.set(e,n),e}function mG(n){if(Lw.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Lw.set(n,e)}let Mw={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Lw.get(n);if(e==="objectStoreNames")return n.objectStoreNames||KN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zc(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function gG(n){Mw=n(Mw)}function vG(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(C2(this),e,...t);return KN.set(r,e.sort?e.sort():[e]),Zc(r)}:dG().includes(n)?function(...e){return n.apply(C2(this),e),Zc($N.get(this))}:function(...e){return Zc(n.apply(C2(this),e))}}function yG(n){return typeof n=="function"?vG(n):(n instanceof IDBTransaction&&mG(n),hG(n,fG())?new Proxy(n,Mw):n)}function Zc(n){if(n instanceof IDBRequest)return pG(n);if(A2.has(n))return A2.get(n);const e=yG(n);return e!==n&&(A2.set(n,e),Yx.set(e,n)),e}const C2=n=>Yx.get(n);function wG(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(n,e),a=Zc(s);return r&&s.addEventListener("upgradeneeded",u=>{r(Zc(s.result),u.oldVersion,u.newVersion,Zc(s.transaction),u)}),t&&s.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const bG=["get","getKey","getAll","getAllKeys","count"],xG=["put","add","delete","clear"],I2=new Map;function _C(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(I2.get(e))return I2.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=xG.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||bG.includes(t)))return;const o=async function(s,...a){const u=this.transaction(s,i?"readwrite":"readonly");let l=u.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[t](...a),i&&u.done]))[0]};return I2.set(e,o),o}gG(n=>({...n,get:(e,t,r)=>_C(e,t)||n.get(e,t,r),has:(e,t)=>!!_C(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _G{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(EG(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function EG(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ow="@firebase/app",EC="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ec=new Xx("@firebase/app"),SG="@firebase/app-compat",AG="@firebase/analytics-compat",CG="@firebase/analytics",IG="@firebase/app-check-compat",TG="@firebase/app-check",kG="@firebase/auth",NG="@firebase/auth-compat",RG="@firebase/database",PG="@firebase/data-connect",DG="@firebase/database-compat",LG="@firebase/functions",MG="@firebase/functions-compat",OG="@firebase/installations",FG="@firebase/installations-compat",BG="@firebase/messaging",VG="@firebase/messaging-compat",jG="@firebase/performance",UG="@firebase/performance-compat",zG="@firebase/remote-config",WG="@firebase/remote-config-compat",qG="@firebase/storage",HG="@firebase/storage-compat",GG="@firebase/firestore",$G="@firebase/ai",KG="@firebase/firestore-compat",XG="firebase",YG="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="[DEFAULT]",QG={[Ow]:"fire-core",[SG]:"fire-core-compat",[CG]:"fire-analytics",[AG]:"fire-analytics-compat",[TG]:"fire-app-check",[IG]:"fire-app-check-compat",[kG]:"fire-auth",[NG]:"fire-auth-compat",[RG]:"fire-rtdb",[PG]:"fire-data-connect",[DG]:"fire-rtdb-compat",[LG]:"fire-fn",[MG]:"fire-fn-compat",[OG]:"fire-iid",[FG]:"fire-iid-compat",[BG]:"fire-fcm",[VG]:"fire-fcm-compat",[jG]:"fire-perf",[UG]:"fire-perf-compat",[zG]:"fire-rc",[WG]:"fire-rc-compat",[qG]:"fire-gcs",[HG]:"fire-gcs-compat",[GG]:"fire-fst",[KG]:"fire-fst-compat",[$G]:"fire-vertex","fire-js":"fire-js",[XG]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0=new Map,JG=new Map,Bw=new Map;function SC(n,e){try{n.container.addComponent(e)}catch(t){ec.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Gd(n){const e=n.name;if(Bw.has(e))return ec.debug(`There were multiple attempts to register component ${e}.`),!1;Bw.set(e,n);for(const t of S0.values())SC(t,n);for(const t of JG.values())SC(t,n);return!0}function Qx(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function vu(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZG={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},eh=new eg("app","Firebase",ZG);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e${constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new mf("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw eh.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ap=YG;function XN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Fw,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw eh.create("bad-app-name",{appName:String(i)});if(t||(t=WN()),!t)throw eh.create("no-options");const o=S0.get(i);if(o){if(pf(t,o.options)&&pf(r,o.config))return o;throw eh.create("duplicate-app",{appName:i})}const s=new sG(i);for(const u of Bw.values())s.addComponent(u);const a=new e$(t,r,s);return S0.set(i,a),a}function YN(n=Fw){const e=S0.get(n);if(!e&&n===Fw&&WN())return XN();if(!e)throw eh.create("no-app",{appName:n});return e}function th(n,e,t){let r=QG[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const s=[`Unable to register library "${r}" with version "${e}":`];i&&s.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ec.warn(s.join(" "));return}Gd(new mf(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t$="firebase-heartbeat-database",n$=1,Rm="firebase-heartbeat-store";let T2=null;function QN(){return T2||(T2=wG(t$,n$,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Rm)}catch(t){console.warn(t)}}}}).catch(n=>{throw eh.create("idb-open",{originalErrorMessage:n.message})})),T2}async function r$(n){try{const t=(await QN()).transaction(Rm),r=await t.objectStore(Rm).get(JN(n));return await t.done,r}catch(e){if(e instanceof lc)ec.warn(e.message);else{const t=eh.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ec.warn(t.message)}}}async function AC(n,e){try{const r=(await QN()).transaction(Rm,"readwrite");await r.objectStore(Rm).put(e,JN(n)),await r.done}catch(t){if(t instanceof lc)ec.warn(t.message);else{const r=eh.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ec.warn(r.message)}}}function JN(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i$=1024,o$=30;class s${constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new u$(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=CC();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>o$){const s=l$(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ec.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=CC(),{heartbeatsToSend:r,unsentEntries:i}=a$(this._heartbeatsCache.heartbeats),o=E0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ec.warn(t),""}}}function CC(){return new Date().toISOString().substring(0,10)}function a$(n,e=i$){const t=[];let r=n.slice();for(const i of n){const o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),IC(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),IC(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class u${constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return KH()?XH().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await r$(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return AC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return AC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function IC(n){return E0(JSON.stringify({version:2,heartbeats:n})).length}function l$(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c$(n){Gd(new mf("platform-logger",e=>new _G(e),"PRIVATE")),Gd(new mf("heartbeat",e=>new s$(e),"PRIVATE")),th(Ow,EC,n),th(Ow,EC,"esm2020"),th("fire-js","")}c$("");var h$="firebase",f$="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */th(h$,f$,"app");function ZN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const d$=ZN,eR=new eg("auth","Firebase",ZN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A0=new Xx("@firebase/auth");function p$(n,...e){A0.logLevel<=Fn.WARN&&A0.warn(`Auth (${ap}): ${n}`,...e)}function Lv(n,...e){A0.logLevel<=Fn.ERROR&&A0.error(`Auth (${ap}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(n,...e){throw Jx(n,...e)}function hl(n,...e){return Jx(n,...e)}function tR(n,e,t){const r={...d$(),[e]:t};return new eg("auth","Firebase",r).create(e,{appName:n.name})}function nh(n){return tR(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Jx(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return eR.create(n,...e)}function cn(n,e,...t){if(!n)throw Jx(e,...t)}function Xl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Lv(e),new Error(e)}function tc(n,e){n||Xl(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vw(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function m$(){return TC()==="http:"||TC()==="https:"}function TC(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g$(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(m$()||qH()||"connection"in navigator)?navigator.onLine:!0}function v$(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,t){this.shortDelay=e,this.longDelay=t,tc(t>e,"Short delay should be less than long delay!"),this.isMobile=UH()||HH()}get(){return g$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(n,e){tc(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Xl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Xl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Xl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w$=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],b$=new ng(3e4,6e4);function Cf(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function _h(n,e,t,r,i={}){return rR(n,i,async()=>{let o={},s={};r&&(e==="GET"?s=r:o={body:JSON.stringify(r)});const a=tg({key:n.config.apiKey,...s}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const l={method:e,headers:u,...o};return WH()||(l.referrerPolicy="no-referrer"),n.emulatorConfig&&sp(n.emulatorConfig.host)&&(l.credentials="include"),nR.fetch()(await iR(n,n.config.apiHost,t,a),l)})}async function rR(n,e,t){n._canInitEmulator=!1;const r={...y$,...e};try{const i=new _$(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw yv(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[u,l]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw yv(n,"credential-already-in-use",s);if(u==="EMAIL_EXISTS")throw yv(n,"email-already-in-use",s);if(u==="USER_DISABLED")throw yv(n,"user-disabled",s);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw tR(n,h,l);_u(n,h)}}catch(i){if(i instanceof lc)throw i;_u(n,"network-request-failed",{message:String(i)})}}async function l1(n,e,t,r,i={}){const o=await _h(n,e,t,r,i);return"mfaPendingCredential"in o&&_u(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function iR(n,e,t,r){const i=`${e}${t}?${r}`,o=n,s=o.config.emulator?Zx(n.config,i):`${n.config.apiScheme}://${i}`;return w$.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}function x$(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class _${clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(hl(this.auth,"network-request-failed")),b$.get())})}}function yv(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=hl(n,e,r);return i.customData._tokenResponse=t,i}function kC(n){return n!==void 0&&n.enterprise!==void 0}class E${constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return x$(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function S$(n,e){return _h(n,"GET","/v2/recaptchaConfig",Cf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A$(n,e){return _h(n,"POST","/v1/accounts:delete",e)}async function C0(n,e){return _h(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function C$(n,e=!1){const t=ku(n),r=await t.getIdToken(e),i=e_(r);cn(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:cm(k2(i.auth_time)),issuedAtTime:cm(k2(i.iat)),expirationTime:cm(k2(i.exp)),signInProvider:s||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function k2(n){return Number(n)*1e3}function e_(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Lv("JWT malformed, contained fewer than 3 sections"),null;try{const i=UN(t);return i?JSON.parse(i):(Lv("Failed to decode base64 JWT payload"),null)}catch(i){return Lv("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function NC(n){const e=e_(n);return cn(e,"internal-error"),cn(typeof e.exp<"u","internal-error"),cn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pm(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof lc&&I$(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function I$({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=cm(this.lastLoginAt),this.creationTime=cm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I0(n){var d;const e=n.auth,t=await n.getIdToken(),r=await Pm(n,C0(e,{idToken:t}));cn(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const o=(d=i.providerUserInfo)!=null&&d.length?oR(i.providerUserInfo):[],s=N$(n.providerData,o),a=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!(s!=null&&s.length),l=a?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new jw(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(n,h)}async function k$(n){const e=ku(n);await I0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function N$(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function oR(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R$(n,e){const t=await rR(n,{},async()=>{const r=tg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=await iR(n,i,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:a,body:r};return n.emulatorConfig&&sp(n.emulatorConfig.host)&&(u.credentials="include"),nR.fetch()(s,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function P$(n,e){return _h(n,"POST","/v2/accounts:revokeToken",Cf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){cn(e.idToken,"internal-error"),cn(typeof e.idToken<"u","internal-error"),cn(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):NC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){cn(e.length!==0,"internal-error");const t=NC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(cn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:o}=await R$(e,t);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:o}=t,s=new Rd;return r&&(cn(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(cn(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(cn(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rd,this.toJSON())}_performRefresh(){return Xl("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(n,e){cn(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class wu{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new T$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new jw(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Pm(this,this.stsTokenManager.getToken(this.auth,e));return cn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return C$(this,e)}reload(){return k$(this)}_assign(e){this!==e&&(cn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new wu({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){cn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await I0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vu(this.auth.app))return Promise.reject(nh(this.auth));const e=await this.getIdToken();return await Pm(this,A$(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,u=t._redirectEventId??void 0,l=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:d,emailVerified:m,isAnonymous:p,providerData:y,stsTokenManager:b}=t;cn(d&&b,e,"internal-error");const x=Rd.fromJSON(this.name,b);cn(typeof d=="string",e,"internal-error"),Vc(r,e.name),Vc(i,e.name),cn(typeof m=="boolean",e,"internal-error"),cn(typeof p=="boolean",e,"internal-error"),Vc(o,e.name),Vc(s,e.name),Vc(a,e.name),Vc(u,e.name),Vc(l,e.name),Vc(h,e.name);const E=new wu({uid:d,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:p,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:x,createdAt:l,lastLoginAt:h});return y&&Array.isArray(y)&&(E.providerData=y.map(T=>({...T}))),u&&(E._redirectEventId=u),E}static async _fromIdTokenResponse(e,t,r=!1){const i=new Rd;i.updateFromServerResponse(t);const o=new wu({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await I0(o),o}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];cn(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?oR(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),a=new Rd;a.updateFromIdToken(r);const u=new wu({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new jw(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(u,l),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC=new Map;function Yl(n){tc(n instanceof Function,"Expected a class definition");let e=RC.get(n);return e?(tc(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,RC.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}sR.type="NONE";const PC=sR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(n,e,t){return`firebase:${n}:${e}:${t}`}class Pd{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=Mv(this.userKey,i.apiKey,o),this.fullPersistenceKey=Mv("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await C0(this.auth,{idToken:e}).catch(()=>{});return t?wu._fromGetAccountInfoResponse(this.auth,t,e):null}return wu._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Pd(Yl(PC),e,r);const i=(await Promise.all(t.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let o=i[0]||Yl(PC);const s=Mv(r,e.config.apiKey,e.name);let a=null;for(const l of t)try{const h=await l._get(s);if(h){let d;if(typeof h=="string"){const m=await C0(e,{idToken:h}).catch(()=>{});if(!m)break;d=await wu._fromGetAccountInfoResponse(e,m,h)}else d=wu._fromJSON(e,h);l!==o&&(a=d),o=l;break}}catch{}const u=i.filter(l=>l._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new Pd(o,e,r):(o=u[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async l=>{if(l!==o)try{await l._remove(s)}catch{}})),new Pd(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(cR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fR(e))return"Blackberry";if(dR(e))return"Webos";if(uR(e))return"Safari";if((e.includes("chrome/")||lR(e))&&!e.includes("edge/"))return"Chrome";if(hR(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function aR(n=ls()){return/firefox\//i.test(n)}function uR(n=ls()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function lR(n=ls()){return/crios\//i.test(n)}function cR(n=ls()){return/iemobile/i.test(n)}function hR(n=ls()){return/android/i.test(n)}function fR(n=ls()){return/blackberry/i.test(n)}function dR(n=ls()){return/webos/i.test(n)}function t_(n=ls()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function D$(n=ls()){var e;return t_(n)&&!!((e=window.navigator)!=null&&e.standalone)}function L$(){return GH()&&document.documentMode===10}function pR(n=ls()){return t_(n)||hR(n)||dR(n)||fR(n)||/windows phone/i.test(n)||cR(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(n,e=[]){let t;switch(n){case"Browser":t=DC(ls());break;case"Worker":t=`${DC(ls())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ap}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M${constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=o=>new Promise((s,a)=>{try{const u=e(o);s(u)}catch(u){a(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O$(n,e={}){return _h(n,"GET","/v2/passwordPolicy",Cf(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F$=6;class B${constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??F$,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V${constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new LC(this),this.idTokenSubscription=new LC(this),this.beforeStateQueue=new M$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=eR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yl(t)),this._initializationPromise=this.queue(async()=>{var r,i,o;if(!this._deleted&&(this.persistenceManager=await Pd.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await C0(this,{idToken:e}),r=await wu._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(vu(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=(o=this.redirectUser)==null?void 0:o._redirectEventId,a=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!s||s===a)&&(u!=null&&u.user)&&(r=u.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return cn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await I0(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=v$()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vu(this.app))return Promise.reject(nh(this));const t=e?ku(e):null;return t&&cn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&cn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vu(this.app)?Promise.reject(nh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vu(this.app)?Promise.reject(nh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Yl(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await O$(this),t=new B$(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new eg("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await P$(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Yl(e)||this._popupRedirectResolver;cn(t,this,"argument-error"),this.redirectPersistenceManager=await Pd.create(this,[Yl(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(cn(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{s=!0,u()}}else{const u=e.addObserver(t);return()=>{s=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return cn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(vu(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&p$(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function up(n){return ku(n)}class LC{constructor(e){this.auth=e,this.observer=null,this.addObserver=eG(t=>this.observer=t)}get next(){return cn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function j$(n){c1=n}function gR(n){return c1.loadJS(n)}function U$(){return c1.recaptchaEnterpriseScript}function z$(){return c1.gapiScript}function W$(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class q${constructor(){this.enterprise=new H$}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class H${ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const G$="recaptcha-enterprise",vR="NO_RECAPTCHA";class $${constructor(e){this.type=G$,this.auth=up(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(s,a)=>{S$(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const l=new E$(u);return o.tenantId==null?o._agentRecaptchaConfig=l:o._tenantRecaptchaConfigs[o.tenantId]=l,s(l.siteKey)}}).catch(u=>{a(u)})})}function i(o,s,a){const u=window.grecaptcha;kC(u)?u.enterprise.ready(()=>{u.enterprise.execute(o,{action:e}).then(l=>{s(l)}).catch(()=>{s(vR)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new q$().execute("siteKey",{action:"verify"}):new Promise((o,s)=>{r(this.auth).then(a=>{if(!t&&kC(window.grecaptcha))i(a,o,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let u=U$();u.length!==0&&(u+=a),gR(u).then(()=>{i(a,o,s)}).catch(l=>{s(l)})}}).catch(a=>{s(a)})})}}async function MC(n,e,t,r=!1,i=!1){const o=new $$(n);let s;if(i)s=vR;else try{s=await o.verify(t)}catch{s=await o.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const u=a.phoneEnrollmentInfo.phoneNumber,l=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:l,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const u=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function OC(n,e,t,r,i){var o;if((o=n._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await MC(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await MC(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K$(n,e){const t=Qx(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),o=t.getOptions();if(pf(o,e??{}))return i;_u(i,"already-initialized")}return t.initialize({options:e})}function X$(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Yl);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Y$(n,e,t){const r=up(n);cn(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,o=yR(e),{host:s,port:a}=Q$(e),u=a===null?"":`:${a}`,l={url:`${o}//${s}${u}/`},h=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){cn(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),cn(pf(l,r.config.emulator)&&pf(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=l,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,sp(s)?(HN(`${o}//${s}${u}`),GN("Auth",!0)):J$()}function yR(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Q$(n){const e=yR(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:FC(r.substr(o.length+1))}}else{const[o,s]=r.split(":");return{host:o,port:FC(s)}}}function FC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function J$(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Xl("not implemented")}_getIdTokenResponse(e){return Xl("not implemented")}_linkToIdToken(e,t){return Xl("not implemented")}_getReauthenticationResolver(e){return Xl("not implemented")}}async function Z$(n,e){return _h(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eK(n,e){return l1(n,"POST","/v1/accounts:signInWithPassword",Cf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tK(n,e){return l1(n,"POST","/v1/accounts:signInWithEmailLink",Cf(n,e))}async function nK(n,e){return l1(n,"POST","/v1/accounts:signInWithEmailLink",Cf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm extends n_{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Dm(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Dm(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return OC(e,t,"signInWithPassword",eK);case"emailLink":return tK(e,{email:this._email,oobCode:this._password});default:_u(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return OC(e,r,"signUpPassword",Z$);case"emailLink":return nK(e,{idToken:t,email:this._email,oobCode:this._password});default:_u(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dd(n,e){return l1(n,"POST","/v1/accounts:signInWithIdp",Cf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rK="http://localhost";class gf extends n_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new gf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_u("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...o}=t;if(!r||!i)return null;const s=new gf(r,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const t=this.buildRequest();return Dd(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Dd(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Dd(e,t)}buildRequest(){const e={requestUri:rK,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=tg(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iK(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function oK(n){const e=Kp(Xp(n)).link,t=e?Kp(Xp(e)).deep_link_id:null,r=Kp(Xp(n)).deep_link_id;return(r?Kp(Xp(r)).link:null)||r||t||e||n}class r_{constructor(e){const t=Kp(Xp(e)),r=t.apiKey??null,i=t.oobCode??null,o=iK(t.mode??null);cn(r&&i&&o,"argument-error"),this.apiKey=r,this.operation=o,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=oK(e);try{return new r_(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(){this.providerId=lp.PROVIDER_ID}static credential(e,t){return Dm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=r_.parseLink(t);return cn(r,"argument-error"),Dm._fromEmailAndCode(e,r.code,r.tenantId)}}lp.PROVIDER_ID="password";lp.EMAIL_PASSWORD_SIGN_IN_METHOD="password";lp.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg extends wR{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc extends rg{constructor(){super("facebook.com")}static credential(e){return gf._fromParams({providerId:Uc.PROVIDER_ID,signInMethod:Uc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uc.credentialFromTaggedObject(e)}static credentialFromError(e){return Uc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uc.credential(e.oauthAccessToken)}catch{return null}}}Uc.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uc.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc extends rg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return gf._fromParams({providerId:zc.PROVIDER_ID,signInMethod:zc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return zc.credentialFromTaggedObject(e)}static credentialFromError(e){return zc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return zc.credential(t,r)}catch{return null}}}zc.GOOGLE_SIGN_IN_METHOD="google.com";zc.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc extends rg{constructor(){super("github.com")}static credential(e){return gf._fromParams({providerId:Wc.PROVIDER_ID,signInMethod:Wc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wc.credentialFromTaggedObject(e)}static credentialFromError(e){return Wc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wc.credential(e.oauthAccessToken)}catch{return null}}}Wc.GITHUB_SIGN_IN_METHOD="github.com";Wc.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc extends rg{constructor(){super("twitter.com")}static credential(e,t){return gf._fromParams({providerId:qc.PROVIDER_ID,signInMethod:qc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return qc.credentialFromTaggedObject(e)}static credentialFromError(e){return qc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return qc.credential(t,r)}catch{return null}}}qc.TWITTER_SIGN_IN_METHOD="twitter.com";qc.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const o=await wu._fromIdTokenResponse(e,r,i),s=BC(r);return new $d({user:o,providerId:s,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=BC(r);return new $d({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function BC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0 extends lc{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,T0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new T0(e,t,r,i)}}function bR(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?T0._fromErrorAndOperation(n,o,e,r):o})}async function sK(n,e,t=!1){const r=await Pm(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return $d._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aK(n,e,t=!1){const{auth:r}=n;if(vu(r.app))return Promise.reject(nh(r));const i="reauthenticate";try{const o=await Pm(n,bR(r,i,e,n),t);cn(o.idToken,r,"internal-error");const s=e_(o.idToken);cn(s,r,"internal-error");const{sub:a}=s;return cn(n.uid===a,r,"user-mismatch"),$d._forOperation(n,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&_u(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xR(n,e,t=!1){if(vu(n.app))return Promise.reject(nh(n));const r="signIn",i=await bR(n,r,e),o=await $d._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(o.user),o}async function uK(n,e){return xR(up(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lK(n){const e=up(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function cK(n,e,t){return vu(n.app)?Promise.reject(nh(n)):uK(ku(n),lp.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&lK(n),r})}function hK(n,e,t,r){return ku(n).onIdTokenChanged(e,t,r)}function fK(n,e,t){return ku(n).beforeAuthStateChanged(e,t)}function dK(n,e,t,r){return ku(n).onAuthStateChanged(e,t,r)}function pK(n){return ku(n).signOut()}const k0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(k0,"1"),this.storage.removeItem(k0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mK=1e3,gK=10;class ER extends _R{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((s,a,u)=>{this.notifyListeners(s,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(r);!t&&this.localCache[r]===s||this.notifyListeners(r,s)},o=this.storage.getItem(r);L$()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,gK):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},mK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ER.type="LOCAL";const vK=ER;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR extends _R{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}SR.type="SESSION";const AR=SR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yK(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new h1(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:o}=t.data,s=this.handlersMap[i];if(!(s!=null&&s.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(s).map(async l=>l(t.origin,o)),u=await yK(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}h1.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wK{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,u)=>{const l=i_("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(d){const m=d;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(m.data.response);break;default:clearTimeout(h),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fl(){return window}function bK(n){fl().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CR(){return typeof fl().WorkerGlobalScope<"u"&&typeof fl().importScripts=="function"}async function xK(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _K(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function EK(){return CR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IR="firebaseLocalStorageDb",SK=1,N0="firebaseLocalStorage",TR="fbase_key";class ig{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function f1(n,e){return n.transaction([N0],e?"readwrite":"readonly").objectStore(N0)}function AK(){const n=indexedDB.deleteDatabase(IR);return new ig(n).toPromise()}function Uw(){const n=indexedDB.open(IR,SK);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(N0,{keyPath:TR})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(N0)?e(r):(r.close(),await AK(),e(await Uw()))})})}async function VC(n,e,t){const r=f1(n,!0).put({[TR]:e,value:t});return new ig(r).toPromise()}async function CK(n,e){const t=f1(n,!1).get(e),r=await new ig(t).toPromise();return r===void 0?null:r.value}function jC(n,e){const t=f1(n,!0).delete(e);return new ig(t).toPromise()}const IK=800,TK=3;class kR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Uw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>TK)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return CR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=h1._getInstance(EK()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await xK(),!this.activeServiceWorker)return;this.sender=new wK(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_K()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Uw();return await VC(e,k0,"1"),await jC(e,k0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>VC(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>CK(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>jC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=f1(i,!1).getAll();return new ig(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),IK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kR.type="LOCAL";const kK=kR;new ng(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NK(n,e){return e?Yl(e):(cn(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_ extends n_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Dd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Dd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Dd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function RK(n){return xR(n.auth,new o_(n),n.bypassAuthState)}function PK(n){const{auth:e,user:t}=n;return cn(t,e,"internal-error"),aK(t,new o_(n),n.bypassAuthState)}async function DK(n){const{auth:e,user:t}=n;return cn(t,e,"internal-error"),sK(t,new o_(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return RK;case"linkViaPopup":case"linkViaRedirect":return DK;case"reauthViaPopup":case"reauthViaRedirect":return PK;default:_u(this.auth,"internal-error")}}resolve(e){tc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){tc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LK=new ng(2e3,1e4);class wd extends NR{constructor(e,t,r,i,o){super(e,t,i,o),this.provider=r,this.authWindow=null,this.pollId=null,wd.currentPopupAction&&wd.currentPopupAction.cancel(),wd.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return cn(e,this.auth,"internal-error"),e}async onExecution(){tc(this.filter.length===1,"Popup operations only handle one event");const e=i_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(hl(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(hl(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wd.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(hl(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,LK.get())};e()}}wd.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MK="pendingRedirect",Ov=new Map;class OK extends NR{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Ov.get(this.auth._key());if(!e){try{const r=await FK(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ov.set(this.auth._key(),e)}return this.bypassAuthState||Ov.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function FK(n,e){const t=jK(e),r=VK(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function BK(n,e){Ov.set(n._key(),e)}function VK(n){return Yl(n._redirectPersistence)}function jK(n){return Mv(MK,n.config.apiKey,n.name)}async function UK(n,e,t=!1){if(vu(n.app))return Promise.reject(nh(n));const r=up(n),i=NK(r,e),s=await new OK(r,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zK=600*1e3;class WK{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qK(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!RR(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(hl(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zK&&this.cachedEventUids.clear(),this.cachedEventUids.has(UC(e))}saveEventToCache(e){this.cachedEventUids.add(UC(e)),this.lastProcessedEventTime=Date.now()}}function UC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function RR({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function qK(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return RR(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HK(n,e={}){return _h(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GK=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$K=/^https?/;async function KK(n){if(n.config.emulator)return;const{authorizedDomains:e}=await HK(n);for(const t of e)try{if(XK(t))return}catch{}_u(n,"unauthorized-domain")}function XK(n){const e=Vw(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!$K.test(t))return!1;if(GK.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YK=new ng(3e4,6e4);function zC(){const n=fl().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function QK(n){return new Promise((e,t)=>{var i,o,s;function r(){zC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zC(),t(hl(n,"network-request-failed"))},timeout:YK.get()})}if((o=(i=fl().gapi)==null?void 0:i.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((s=fl().gapi)!=null&&s.load)r();else{const a=W$("iframefcb");return fl()[a]=()=>{gapi.load?r():t(hl(n,"network-request-failed"))},gR(`${z$()}?onload=${a}`).catch(u=>t(u))}}).catch(e=>{throw Fv=null,e})}let Fv=null;function JK(n){return Fv=Fv||QK(n),Fv}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZK=new ng(5e3,15e3),eX="__/auth/iframe",tX="emulator/auth/iframe",nX={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rX=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iX(n){const e=n.config;cn(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Zx(e,tX):`https://${n.config.authDomain}/${eX}`,r={apiKey:e.apiKey,appName:n.name,v:ap},i=rX.get(n.config.apiHost);i&&(r.eid=i);const o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${tg(r).slice(1)}`}async function oX(n){const e=await JK(n),t=fl().gapi;return cn(t,n,"internal-error"),e.open({where:document.body,url:iX(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nX,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const s=hl(n,"network-request-failed"),a=fl().setTimeout(()=>{o(s)},ZK.get());function u(){fl().clearTimeout(a),i(r)}r.ping(u).then(u,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sX={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},aX=500,uX=600,lX="_blank",cX="http://localhost";class WC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function hX(n,e,t,r=aX,i=uX){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u={...sX,width:r.toString(),height:i.toString(),top:o,left:s},l=ls().toLowerCase();t&&(a=lR(l)?lX:t),aR(l)&&(e=e||cX,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[p,y])=>`${m}${p}=${y},`,"");if(D$(l)&&a!=="_self")return fX(e||"",a),new WC(null);const d=window.open(e||"",a,h);cn(d,n,"popup-blocked");try{d.focus()}catch{}return new WC(d)}function fX(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dX="__/auth/handler",pX="emulator/auth/handler",mX=encodeURIComponent("fac");async function qC(n,e,t,r,i,o){cn(n.config.authDomain,n,"auth-domain-config-required"),cn(n.config.apiKey,n,"invalid-api-key");const s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:ap,eventId:i};if(e instanceof wR){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",ZH(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries({}))s[h]=d}if(e instanceof rg){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(s.scopes=h.join(","))}n.tenantId&&(s.tid=n.tenantId);const a=s;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const u=await n._getAppCheckToken(),l=u?`#${mX}=${encodeURIComponent(u)}`:"";return`${gX(n)}?${tg(a).slice(1)}${l}`}function gX({config:n}){return n.emulator?Zx(n,pX):`https://${n.authDomain}/${dX}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N2="webStorageSupport";class vX{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=AR,this._completeRedirectFn=UK,this._overrideRedirectResult=BK}async _openPopup(e,t,r,i){var s;tc((s=this.eventManagers[e._key()])==null?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await qC(e,t,r,Vw(),i);return hX(e,o,i_())}async _openRedirect(e,t,r,i){await this._originValidation(e);const o=await qC(e,t,r,Vw(),i);return bK(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(tc(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await oX(e),r=new WK(e);return t.register("authEvent",i=>(cn(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(N2,{type:N2},i=>{var s;const o=(s=i==null?void 0:i[0])==null?void 0:s[N2];o!==void 0&&t(!!o),_u(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=KK(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return pR()||uR()||t_()}}const yX=vX;var HC="@firebase/auth",GC="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wX{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){cn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bX(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function xX(n){Gd(new mf("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;cn(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mR(n)},l=new V$(r,i,o,u);return X$(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Gd(new mf("auth-internal",e=>{const t=up(e.getProvider("auth").getImmediate());return(r=>new wX(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),th(HC,GC,bX(n)),th(HC,GC,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _X=300,EX=qN("authIdTokenMaxAge")||_X;let $C=null;const SX=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>EX)return;const i=t==null?void 0:t.token;$C!==i&&($C=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function AX(n=YN()){const e=Qx(n,"auth");if(e.isInitialized())return e.getImmediate();const t=K$(n,{popupRedirectResolver:yX,persistence:[kK,vK,AR]}),r=qN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const s=SX(o.toString());fK(t,s,()=>s(t.currentUser)),hK(t,a=>s(a))}}const i=zN("auth");return i&&Y$(t,`http://${i}`),t}function CX(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}j$({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const o=hl("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",CX().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});xX("Browser");var KC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rh,PR;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(L,C){function A(){}A.prototype=C.prototype,L.F=C.prototype,L.prototype=new A,L.prototype.constructor=L,L.D=function(M,k,O){for(var j=Array(arguments.length-2),X=2;X<arguments.length;X++)j[X-2]=arguments[X];return C.prototype[k].apply(M,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(L,C,A){A||(A=0);const M=Array(16);if(typeof C=="string")for(var k=0;k<16;++k)M[k]=C.charCodeAt(A++)|C.charCodeAt(A++)<<8|C.charCodeAt(A++)<<16|C.charCodeAt(A++)<<24;else for(k=0;k<16;++k)M[k]=C[A++]|C[A++]<<8|C[A++]<<16|C[A++]<<24;C=L.g[0],A=L.g[1],k=L.g[2];let O=L.g[3],j;j=C+(O^A&(k^O))+M[0]+3614090360&4294967295,C=A+(j<<7&4294967295|j>>>25),j=O+(k^C&(A^k))+M[1]+3905402710&4294967295,O=C+(j<<12&4294967295|j>>>20),j=k+(A^O&(C^A))+M[2]+606105819&4294967295,k=O+(j<<17&4294967295|j>>>15),j=A+(C^k&(O^C))+M[3]+3250441966&4294967295,A=k+(j<<22&4294967295|j>>>10),j=C+(O^A&(k^O))+M[4]+4118548399&4294967295,C=A+(j<<7&4294967295|j>>>25),j=O+(k^C&(A^k))+M[5]+1200080426&4294967295,O=C+(j<<12&4294967295|j>>>20),j=k+(A^O&(C^A))+M[6]+2821735955&4294967295,k=O+(j<<17&4294967295|j>>>15),j=A+(C^k&(O^C))+M[7]+4249261313&4294967295,A=k+(j<<22&4294967295|j>>>10),j=C+(O^A&(k^O))+M[8]+1770035416&4294967295,C=A+(j<<7&4294967295|j>>>25),j=O+(k^C&(A^k))+M[9]+2336552879&4294967295,O=C+(j<<12&4294967295|j>>>20),j=k+(A^O&(C^A))+M[10]+4294925233&4294967295,k=O+(j<<17&4294967295|j>>>15),j=A+(C^k&(O^C))+M[11]+2304563134&4294967295,A=k+(j<<22&4294967295|j>>>10),j=C+(O^A&(k^O))+M[12]+1804603682&4294967295,C=A+(j<<7&4294967295|j>>>25),j=O+(k^C&(A^k))+M[13]+4254626195&4294967295,O=C+(j<<12&4294967295|j>>>20),j=k+(A^O&(C^A))+M[14]+2792965006&4294967295,k=O+(j<<17&4294967295|j>>>15),j=A+(C^k&(O^C))+M[15]+1236535329&4294967295,A=k+(j<<22&4294967295|j>>>10),j=C+(k^O&(A^k))+M[1]+4129170786&4294967295,C=A+(j<<5&4294967295|j>>>27),j=O+(A^k&(C^A))+M[6]+3225465664&4294967295,O=C+(j<<9&4294967295|j>>>23),j=k+(C^A&(O^C))+M[11]+643717713&4294967295,k=O+(j<<14&4294967295|j>>>18),j=A+(O^C&(k^O))+M[0]+3921069994&4294967295,A=k+(j<<20&4294967295|j>>>12),j=C+(k^O&(A^k))+M[5]+3593408605&4294967295,C=A+(j<<5&4294967295|j>>>27),j=O+(A^k&(C^A))+M[10]+38016083&4294967295,O=C+(j<<9&4294967295|j>>>23),j=k+(C^A&(O^C))+M[15]+3634488961&4294967295,k=O+(j<<14&4294967295|j>>>18),j=A+(O^C&(k^O))+M[4]+3889429448&4294967295,A=k+(j<<20&4294967295|j>>>12),j=C+(k^O&(A^k))+M[9]+568446438&4294967295,C=A+(j<<5&4294967295|j>>>27),j=O+(A^k&(C^A))+M[14]+3275163606&4294967295,O=C+(j<<9&4294967295|j>>>23),j=k+(C^A&(O^C))+M[3]+4107603335&4294967295,k=O+(j<<14&4294967295|j>>>18),j=A+(O^C&(k^O))+M[8]+1163531501&4294967295,A=k+(j<<20&4294967295|j>>>12),j=C+(k^O&(A^k))+M[13]+2850285829&4294967295,C=A+(j<<5&4294967295|j>>>27),j=O+(A^k&(C^A))+M[2]+4243563512&4294967295,O=C+(j<<9&4294967295|j>>>23),j=k+(C^A&(O^C))+M[7]+1735328473&4294967295,k=O+(j<<14&4294967295|j>>>18),j=A+(O^C&(k^O))+M[12]+2368359562&4294967295,A=k+(j<<20&4294967295|j>>>12),j=C+(A^k^O)+M[5]+4294588738&4294967295,C=A+(j<<4&4294967295|j>>>28),j=O+(C^A^k)+M[8]+2272392833&4294967295,O=C+(j<<11&4294967295|j>>>21),j=k+(O^C^A)+M[11]+1839030562&4294967295,k=O+(j<<16&4294967295|j>>>16),j=A+(k^O^C)+M[14]+4259657740&4294967295,A=k+(j<<23&4294967295|j>>>9),j=C+(A^k^O)+M[1]+2763975236&4294967295,C=A+(j<<4&4294967295|j>>>28),j=O+(C^A^k)+M[4]+1272893353&4294967295,O=C+(j<<11&4294967295|j>>>21),j=k+(O^C^A)+M[7]+4139469664&4294967295,k=O+(j<<16&4294967295|j>>>16),j=A+(k^O^C)+M[10]+3200236656&4294967295,A=k+(j<<23&4294967295|j>>>9),j=C+(A^k^O)+M[13]+681279174&4294967295,C=A+(j<<4&4294967295|j>>>28),j=O+(C^A^k)+M[0]+3936430074&4294967295,O=C+(j<<11&4294967295|j>>>21),j=k+(O^C^A)+M[3]+3572445317&4294967295,k=O+(j<<16&4294967295|j>>>16),j=A+(k^O^C)+M[6]+76029189&4294967295,A=k+(j<<23&4294967295|j>>>9),j=C+(A^k^O)+M[9]+3654602809&4294967295,C=A+(j<<4&4294967295|j>>>28),j=O+(C^A^k)+M[12]+3873151461&4294967295,O=C+(j<<11&4294967295|j>>>21),j=k+(O^C^A)+M[15]+530742520&4294967295,k=O+(j<<16&4294967295|j>>>16),j=A+(k^O^C)+M[2]+3299628645&4294967295,A=k+(j<<23&4294967295|j>>>9),j=C+(k^(A|~O))+M[0]+4096336452&4294967295,C=A+(j<<6&4294967295|j>>>26),j=O+(A^(C|~k))+M[7]+1126891415&4294967295,O=C+(j<<10&4294967295|j>>>22),j=k+(C^(O|~A))+M[14]+2878612391&4294967295,k=O+(j<<15&4294967295|j>>>17),j=A+(O^(k|~C))+M[5]+4237533241&4294967295,A=k+(j<<21&4294967295|j>>>11),j=C+(k^(A|~O))+M[12]+1700485571&4294967295,C=A+(j<<6&4294967295|j>>>26),j=O+(A^(C|~k))+M[3]+2399980690&4294967295,O=C+(j<<10&4294967295|j>>>22),j=k+(C^(O|~A))+M[10]+4293915773&4294967295,k=O+(j<<15&4294967295|j>>>17),j=A+(O^(k|~C))+M[1]+2240044497&4294967295,A=k+(j<<21&4294967295|j>>>11),j=C+(k^(A|~O))+M[8]+1873313359&4294967295,C=A+(j<<6&4294967295|j>>>26),j=O+(A^(C|~k))+M[15]+4264355552&4294967295,O=C+(j<<10&4294967295|j>>>22),j=k+(C^(O|~A))+M[6]+2734768916&4294967295,k=O+(j<<15&4294967295|j>>>17),j=A+(O^(k|~C))+M[13]+1309151649&4294967295,A=k+(j<<21&4294967295|j>>>11),j=C+(k^(A|~O))+M[4]+4149444226&4294967295,C=A+(j<<6&4294967295|j>>>26),j=O+(A^(C|~k))+M[11]+3174756917&4294967295,O=C+(j<<10&4294967295|j>>>22),j=k+(C^(O|~A))+M[2]+718787259&4294967295,k=O+(j<<15&4294967295|j>>>17),j=A+(O^(k|~C))+M[9]+3951481745&4294967295,L.g[0]=L.g[0]+C&4294967295,L.g[1]=L.g[1]+(k+(j<<21&4294967295|j>>>11))&4294967295,L.g[2]=L.g[2]+k&4294967295,L.g[3]=L.g[3]+O&4294967295}r.prototype.v=function(L,C){C===void 0&&(C=L.length);const A=C-this.blockSize,M=this.C;let k=this.h,O=0;for(;O<C;){if(k==0)for(;O<=A;)i(this,L,O),O+=this.blockSize;if(typeof L=="string"){for(;O<C;)if(M[k++]=L.charCodeAt(O++),k==this.blockSize){i(this,M),k=0;break}}else for(;O<C;)if(M[k++]=L[O++],k==this.blockSize){i(this,M),k=0;break}}this.h=k,this.o+=C},r.prototype.A=function(){var L=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);L[0]=128;for(var C=1;C<L.length-8;++C)L[C]=0;C=this.o*8;for(var A=L.length-8;A<L.length;++A)L[A]=C&255,C/=256;for(this.v(L),L=Array(16),C=0,A=0;A<4;++A)for(let M=0;M<32;M+=8)L[C++]=this.g[A]>>>M&255;return L};function o(L,C){var A=a;return Object.prototype.hasOwnProperty.call(A,L)?A[L]:A[L]=C(L)}function s(L,C){this.h=C;const A=[];let M=!0;for(let k=L.length-1;k>=0;k--){const O=L[k]|0;M&&O==C||(A[k]=O,M=!1)}this.g=A}var a={};function u(L){return-128<=L&&L<128?o(L,function(C){return new s([C|0],C<0?-1:0)}):new s([L|0],L<0?-1:0)}function l(L){if(isNaN(L)||!isFinite(L))return d;if(L<0)return x(l(-L));const C=[];let A=1;for(let M=0;L>=A;M++)C[M]=L/A|0,A*=4294967296;return new s(C,0)}function h(L,C){if(L.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(L.charAt(0)=="-")return x(h(L.substring(1),C));if(L.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=l(Math.pow(C,8));let M=d;for(let O=0;O<L.length;O+=8){var k=Math.min(8,L.length-O);const j=parseInt(L.substring(O,O+k),C);k<8?(k=l(Math.pow(C,k)),M=M.j(k).add(l(j))):(M=M.j(A),M=M.add(l(j)))}return M}var d=u(0),m=u(1),p=u(16777216);n=s.prototype,n.m=function(){if(b(this))return-x(this).m();let L=0,C=1;for(let A=0;A<this.g.length;A++){const M=this.i(A);L+=(M>=0?M:4294967296+M)*C,C*=4294967296}return L},n.toString=function(L){if(L=L||10,L<2||36<L)throw Error("radix out of range: "+L);if(y(this))return"0";if(b(this))return"-"+x(this).toString(L);const C=l(Math.pow(L,6));var A=this;let M="";for(;;){const k=I(A,C).g;A=E(A,k.j(C));let O=((A.g.length>0?A.g[0]:A.h)>>>0).toString(L);if(A=k,y(A))return O+M;for(;O.length<6;)O="0"+O;M=O+M}},n.i=function(L){return L<0?0:L<this.g.length?this.g[L]:this.h};function y(L){if(L.h!=0)return!1;for(let C=0;C<L.g.length;C++)if(L.g[C]!=0)return!1;return!0}function b(L){return L.h==-1}n.l=function(L){return L=E(this,L),b(L)?-1:y(L)?0:1};function x(L){const C=L.g.length,A=[];for(let M=0;M<C;M++)A[M]=~L.g[M];return new s(A,~L.h).add(m)}n.abs=function(){return b(this)?x(this):this},n.add=function(L){const C=Math.max(this.g.length,L.g.length),A=[];let M=0;for(let k=0;k<=C;k++){let O=M+(this.i(k)&65535)+(L.i(k)&65535),j=(O>>>16)+(this.i(k)>>>16)+(L.i(k)>>>16);M=j>>>16,O&=65535,j&=65535,A[k]=j<<16|O}return new s(A,A[A.length-1]&-2147483648?-1:0)};function E(L,C){return L.add(x(C))}n.j=function(L){if(y(this)||y(L))return d;if(b(this))return b(L)?x(this).j(x(L)):x(x(this).j(L));if(b(L))return x(this.j(x(L)));if(this.l(p)<0&&L.l(p)<0)return l(this.m()*L.m());const C=this.g.length+L.g.length,A=[];for(var M=0;M<2*C;M++)A[M]=0;for(M=0;M<this.g.length;M++)for(let k=0;k<L.g.length;k++){const O=this.i(M)>>>16,j=this.i(M)&65535,X=L.i(k)>>>16,ue=L.i(k)&65535;A[2*M+2*k]+=j*ue,T(A,2*M+2*k),A[2*M+2*k+1]+=O*ue,T(A,2*M+2*k+1),A[2*M+2*k+1]+=j*X,T(A,2*M+2*k+1),A[2*M+2*k+2]+=O*X,T(A,2*M+2*k+2)}for(L=0;L<C;L++)A[L]=A[2*L+1]<<16|A[2*L];for(L=C;L<2*C;L++)A[L]=0;return new s(A,0)};function T(L,C){for(;(L[C]&65535)!=L[C];)L[C+1]+=L[C]>>>16,L[C]&=65535,C++}function P(L,C){this.g=L,this.h=C}function I(L,C){if(y(C))throw Error("division by zero");if(y(L))return new P(d,d);if(b(L))return C=I(x(L),C),new P(x(C.g),x(C.h));if(b(C))return C=I(L,x(C)),new P(x(C.g),C.h);if(L.g.length>30){if(b(L)||b(C))throw Error("slowDivide_ only works with positive integers.");for(var A=m,M=C;M.l(L)<=0;)A=D(A),M=D(M);var k=U(A,1),O=U(M,1);for(M=U(M,2),A=U(A,2);!y(M);){var j=O.add(M);j.l(L)<=0&&(k=k.add(A),O=j),M=U(M,1),A=U(A,1)}return C=E(L,k.j(C)),new P(k,C)}for(k=d;L.l(C)>=0;){for(A=Math.max(1,Math.floor(L.m()/C.m())),M=Math.ceil(Math.log(A)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),O=l(A),j=O.j(C);b(j)||j.l(L)>0;)A-=M,O=l(A),j=O.j(C);y(O)&&(O=m),k=k.add(O),L=E(L,j)}return new P(k,L)}n.B=function(L){return I(this,L).h},n.and=function(L){const C=Math.max(this.g.length,L.g.length),A=[];for(let M=0;M<C;M++)A[M]=this.i(M)&L.i(M);return new s(A,this.h&L.h)},n.or=function(L){const C=Math.max(this.g.length,L.g.length),A=[];for(let M=0;M<C;M++)A[M]=this.i(M)|L.i(M);return new s(A,this.h|L.h)},n.xor=function(L){const C=Math.max(this.g.length,L.g.length),A=[];for(let M=0;M<C;M++)A[M]=this.i(M)^L.i(M);return new s(A,this.h^L.h)};function D(L){const C=L.g.length+1,A=[];for(let M=0;M<C;M++)A[M]=L.i(M)<<1|L.i(M-1)>>>31;return new s(A,L.h)}function U(L,C){const A=C>>5;C%=32;const M=L.g.length-A,k=[];for(let O=0;O<M;O++)k[O]=C>0?L.i(O+A)>>>C|L.i(O+A+1)<<32-C:L.i(O+A);return new s(k,L.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,PR=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,rh=s}).apply(typeof KC<"u"?KC:typeof self<"u"?self:typeof window<"u"?window:{});var wv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var DR,Yp,LR,Bv,zw,MR,OR,FR;(function(){var n,e=Object.defineProperty;function t(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof wv=="object"&&wv];for(var B=0;B<w.length;++B){var q=w[B];if(q&&q.Math==Math)return q}throw Error("Cannot find global object")}var r=t(this);function i(w,B){if(B)e:{var q=r;w=w.split(".");for(var re=0;re<w.length-1;re++){var Re=w[re];if(!(Re in q))break e;q=q[Re]}w=w[w.length-1],re=q[w],B=B(re),B!=re&&B!=null&&e(q,w,{configurable:!0,writable:!0,value:B})}}i("Symbol.dispose",function(w){return w||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(w){return w||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(w){return w||function(B){var q=[],re;for(re in B)Object.prototype.hasOwnProperty.call(B,re)&&q.push([re,B[re]]);return q}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},s=this||self;function a(w){var B=typeof w;return B=="object"&&w!=null||B=="function"}function u(w,B,q){return w.call.apply(w.bind,arguments)}function l(w,B,q){return l=u,l.apply(null,arguments)}function h(w,B){var q=Array.prototype.slice.call(arguments,1);return function(){var re=q.slice();return re.push.apply(re,arguments),w.apply(this,re)}}function d(w,B){function q(){}q.prototype=B.prototype,w.Z=B.prototype,w.prototype=new q,w.prototype.constructor=w,w.Ob=function(re,Re,Ve){for(var at=Array(arguments.length-2),on=2;on<arguments.length;on++)at[on-2]=arguments[on];return B.prototype[Re].apply(re,at)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?w=>w&&AsyncContext.Snapshot.wrap(w):w=>w;function p(w){const B=w.length;if(B>0){const q=Array(B);for(let re=0;re<B;re++)q[re]=w[re];return q}return[]}function y(w,B){for(let re=1;re<arguments.length;re++){const Re=arguments[re];var q=typeof Re;if(q=q!="object"?q:Re?Array.isArray(Re)?"array":q:"null",q=="array"||q=="object"&&typeof Re.length=="number"){q=w.length||0;const Ve=Re.length||0;w.length=q+Ve;for(let at=0;at<Ve;at++)w[q+at]=Re[at]}else w.push(Re)}}class b{constructor(B,q){this.i=B,this.j=q,this.h=0,this.g=null}get(){let B;return this.h>0?(this.h--,B=this.g,this.g=B.next,B.next=null):B=this.i(),B}}function x(w){s.setTimeout(()=>{throw w},0)}function E(){var w=L;let B=null;return w.g&&(B=w.g,w.g=w.g.next,w.g||(w.h=null),B.next=null),B}class T{constructor(){this.h=this.g=null}add(B,q){const re=P.get();re.set(B,q),this.h?this.h.next=re:this.g=re,this.h=re}}var P=new b(()=>new I,w=>w.reset());class I{constructor(){this.next=this.g=this.h=null}set(B,q){this.h=B,this.g=q,this.next=null}reset(){this.next=this.g=this.h=null}}let D,U=!1,L=new T,C=()=>{const w=Promise.resolve(void 0);D=()=>{w.then(A)}};function A(){for(var w;w=E();){try{w.h.call(w.g)}catch(q){x(q)}var B=P;B.j(w),B.h<100&&(B.h++,w.next=B.g,B.g=w)}U=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(w,B){this.type=w,this.g=this.target=B,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var w=!1,B=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const q=()=>{};s.addEventListener("test",q,B),s.removeEventListener("test",q,B)}catch{}return w})();function j(w){return/^[\s\xa0]*$/.test(w)}function X(w,B){k.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w&&this.init(w,B)}d(X,k),X.prototype.init=function(w,B){const q=this.type=w.type,re=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;this.target=w.target||w.srcElement,this.g=B,B=w.relatedTarget,B||(q=="mouseover"?B=w.fromElement:q=="mouseout"&&(B=w.toElement)),this.relatedTarget=B,re?(this.clientX=re.clientX!==void 0?re.clientX:re.pageX,this.clientY=re.clientY!==void 0?re.clientY:re.pageY,this.screenX=re.screenX||0,this.screenY=re.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=w.pointerType,this.state=w.state,this.i=w,w.defaultPrevented&&X.Z.h.call(this)},X.prototype.h=function(){X.Z.h.call(this);const w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var ue="closure_listenable_"+(Math.random()*1e6|0),ge=0;function he(w,B,q,re,Re){this.listener=w,this.proxy=null,this.src=B,this.type=q,this.capture=!!re,this.ha=Re,this.key=++ge,this.da=this.fa=!1}function $(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function le(w,B,q){for(const re in w)B.call(q,w[re],re,w)}function ae(w,B){for(const q in w)B.call(void 0,w[q],q,w)}function J(w){const B={};for(const q in w)B[q]=w[q];return B}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(w,B){let q,re;for(let Re=1;Re<arguments.length;Re++){re=arguments[Re];for(q in re)w[q]=re[q];for(let Ve=0;Ve<W.length;Ve++)q=W[Ve],Object.prototype.hasOwnProperty.call(re,q)&&(w[q]=re[q])}}function ne(w){this.src=w,this.g={},this.h=0}ne.prototype.add=function(w,B,q,re,Re){const Ve=w.toString();w=this.g[Ve],w||(w=this.g[Ve]=[],this.h++);const at=ve(w,B,re,Re);return at>-1?(B=w[at],q||(B.fa=!1)):(B=new he(B,this.src,Ve,!!re,Re),B.fa=q,w.push(B)),B};function fe(w,B){const q=B.type;if(q in w.g){var re=w.g[q],Re=Array.prototype.indexOf.call(re,B,void 0),Ve;(Ve=Re>=0)&&Array.prototype.splice.call(re,Re,1),Ve&&($(B),w.g[q].length==0&&(delete w.g[q],w.h--))}}function ve(w,B,q,re){for(let Re=0;Re<w.length;++Re){const Ve=w[Re];if(!Ve.da&&Ve.listener==B&&Ve.capture==!!q&&Ve.ha==re)return Re}return-1}var we="closure_lm_"+(Math.random()*1e6|0),Se={};function Ce(w,B,q,re,Re){if(Array.isArray(B)){for(let Ve=0;Ve<B.length;Ve++)Ce(w,B[Ve],q,re,Re);return null}return q=gt(q),w&&w[ue]?w.J(B,q,a(re)?!!re.capture:!1,Re):Fe(w,B,q,!1,re,Re)}function Fe(w,B,q,re,Re,Ve){if(!B)throw Error("Invalid event type");const at=a(Re)?!!Re.capture:!!Re;let on=rt(w);if(on||(w[we]=on=new ne(w)),q=on.add(B,q,re,at,Ve),q.proxy)return q;if(re=qe(),q.proxy=re,re.src=w,re.listener=q,w.addEventListener)O||(Re=at),Re===void 0&&(Re=!1),w.addEventListener(B.toString(),re,Re);else if(w.attachEvent)w.attachEvent(Qe(B.toString()),re);else if(w.addListener&&w.removeListener)w.addListener(re);else throw Error("addEventListener and attachEvent are unavailable.");return q}function qe(){function w(q){return B.call(w.src,w.listener,q)}const B=te;return w}function Ne(w,B,q,re,Re){if(Array.isArray(B))for(var Ve=0;Ve<B.length;Ve++)Ne(w,B[Ve],q,re,Re);else re=a(re)?!!re.capture:!!re,q=gt(q),w&&w[ue]?(w=w.i,Ve=String(B).toString(),Ve in w.g&&(B=w.g[Ve],q=ve(B,q,re,Re),q>-1&&($(B[q]),Array.prototype.splice.call(B,q,1),B.length==0&&(delete w.g[Ve],w.h--)))):w&&(w=rt(w))&&(B=w.g[B.toString()],w=-1,B&&(w=ve(B,q,re,Re)),(q=w>-1?B[w]:null)&&Oe(q))}function Oe(w){if(typeof w!="number"&&w&&!w.da){var B=w.src;if(B&&B[ue])fe(B.i,w);else{var q=w.type,re=w.proxy;B.removeEventListener?B.removeEventListener(q,re,w.capture):B.detachEvent?B.detachEvent(Qe(q),re):B.addListener&&B.removeListener&&B.removeListener(re),(q=rt(B))?(fe(q,w),q.h==0&&(q.src=null,B[we]=null)):$(w)}}}function Qe(w){return w in Se?Se[w]:Se[w]="on"+w}function te(w,B){if(w.da)w=!0;else{B=new X(B,this);const q=w.listener,re=w.ha||w.src;w.fa&&Oe(w),w=q.call(re,B)}return w}function rt(w){return w=w[we],w instanceof ne?w:null}var zt="__closure_events_fn_"+(Math.random()*1e9>>>0);function gt(w){return typeof w=="function"?w:(w[zt]||(w[zt]=function(B){return w.handleEvent(B)}),w[zt])}function He(){M.call(this),this.i=new ne(this),this.M=this,this.G=null}d(He,M),He.prototype[ue]=!0,He.prototype.removeEventListener=function(w,B,q,re){Ne(this,w,B,q,re)};function ft(w,B){var q,re=w.G;if(re)for(q=[];re;re=re.G)q.push(re);if(w=w.M,re=B.type||B,typeof B=="string")B=new k(B,w);else if(B instanceof k)B.target=B.target||w;else{var Re=B;B=new k(re,w),Q(B,Re)}Re=!0;let Ve,at;if(q)for(at=q.length-1;at>=0;at--)Ve=B.g=q[at],Re=lt(Ve,re,!0,B)&&Re;if(Ve=B.g=w,Re=lt(Ve,re,!0,B)&&Re,Re=lt(Ve,re,!1,B)&&Re,q)for(at=0;at<q.length;at++)Ve=B.g=q[at],Re=lt(Ve,re,!1,B)&&Re}He.prototype.N=function(){if(He.Z.N.call(this),this.i){var w=this.i;for(const B in w.g){const q=w.g[B];for(let re=0;re<q.length;re++)$(q[re]);delete w.g[B],w.h--}}this.G=null},He.prototype.J=function(w,B,q,re){return this.i.add(String(w),B,!1,q,re)},He.prototype.K=function(w,B,q,re){return this.i.add(String(w),B,!0,q,re)};function lt(w,B,q,re){if(B=w.i.g[String(B)],!B)return!0;B=B.concat();let Re=!0;for(let Ve=0;Ve<B.length;++Ve){const at=B[Ve];if(at&&!at.da&&at.capture==q){const on=at.listener,gr=at.ha||at.src;at.fa&&fe(w.i,at),Re=on.call(gr,re)!==!1&&Re}}return Re&&!re.defaultPrevented}function Et(w,B){if(typeof w!="function")if(w&&typeof w.handleEvent=="function")w=l(w.handleEvent,w);else throw Error("Invalid listener argument");return Number(B)>2147483647?-1:s.setTimeout(w,B||0)}function pt(w){w.g=Et(()=>{w.g=null,w.i&&(w.i=!1,pt(w))},w.l);const B=w.h;w.h=null,w.m.apply(null,B)}class En extends M{constructor(B,q){super(),this.m=B,this.l=q,this.h=null,this.i=!1,this.g=null}j(B){this.h=arguments,this.g?this.i=!0:pt(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $t(w){M.call(this),this.h=w,this.g={}}d($t,M);var Qt=[];function an(w){le(w.g,function(B,q){this.g.hasOwnProperty(q)&&Oe(B)},w),w.g={}}$t.prototype.N=function(){$t.Z.N.call(this),an(this)},$t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qt=s.JSON.stringify,vt=s.JSON.parse,en=class{stringify(w){return s.JSON.stringify(w,void 0)}parse(w){return s.JSON.parse(w,void 0)}};function yt(){}function dr(){}var mn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function rn(){k.call(this,"d")}d(rn,k);function un(){k.call(this,"c")}d(un,k);var On={},Ot=null;function Bn(){return Ot=Ot||new He}On.Ia="serverreachability";function Ht(w){k.call(this,On.Ia,w)}d(Ht,k);function Jt(w){const B=Bn();ft(B,new Ht(B))}On.STAT_EVENT="statevent";function jn(w,B){k.call(this,On.STAT_EVENT,w),this.stat=B}d(jn,k);function Dt(w){const B=Bn();ft(B,new jn(B,w))}On.Ja="timingevent";function Gt(w,B){k.call(this,On.Ja,w),this.size=B}d(Gt,k);function Cn(w,B){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){w()},B)}function Mo(){this.g=!0}Mo.prototype.ua=function(){this.g=!1};function ai(w,B,q,re,Re,Ve){w.info(function(){if(w.g)if(Ve){var at="",on=Ve.split("&");for(let Nn=0;Nn<on.length;Nn++){var gr=on[Nn].split("=");if(gr.length>1){const vr=gr[0];gr=gr[1];const fi=vr.split("_");at=fi.length>=2&&fi[1]=="type"?at+(vr+"="+gr+"&"):at+(vr+"=redacted&")}}}else at=null;else at=Ve;return"XMLHTTP REQ ("+re+") [attempt "+Re+"]: "+B+`
`+q+`
`+at})}function As(w,B,q,re,Re,Ve,at){w.info(function(){return"XMLHTTP RESP ("+re+") [ attempt "+Re+"]: "+B+`
`+q+`
`+Ve+" "+at})}function ui(w,B,q,re){w.info(function(){return"XMLHTTP TEXT ("+B+"): "+go(w,q)+(re?" "+re:"")})}function Kt(w,B){w.info(function(){return"TIMEOUT: "+B})}Mo.prototype.info=function(){};function go(w,B){if(!w.g)return B;if(!B)return null;try{const Ve=JSON.parse(B);if(Ve){for(w=0;w<Ve.length;w++)if(Array.isArray(Ve[w])){var q=Ve[w];if(!(q.length<2)){var re=q[1];if(Array.isArray(re)&&!(re.length<1)){var Re=re[0];if(Re!="noop"&&Re!="stop"&&Re!="close")for(let at=1;at<re.length;at++)re[at]=""}}}}return qt(Ve)}catch{return B}}var Yi={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},li={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},vo;function Xn(){}d(Xn,yt),Xn.prototype.g=function(){return new XMLHttpRequest},vo=new Xn;function or(w){return encodeURIComponent(String(w))}function Rr(w){var B=1;w=w.split(":");const q=[];for(;B>0&&w.length;)q.push(w.shift()),B--;return w.length&&q.push(w.join(":")),q}function Ei(w,B,q,re){this.j=w,this.i=B,this.l=q,this.S=re||1,this.V=new $t(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ks}function Ks(){this.i=null,this.g="",this.h=!1}var Oo={},Fo={};function Vr(w,B,q){w.M=1,w.A=Is(Bo(B)),w.u=q,w.R=!0,yo(w,null)}function yo(w,B){w.F=Date.now(),hs(w),w.B=Bo(w.A);var q=w.B,re=w.S;Array.isArray(re)||(re=[String(re)]),Sl(q.i,"t",re),w.C=0,q=w.j.L,w.h=new Ks,w.g=wt(w.j,q?B:null,!w.u),w.P>0&&(w.O=new En(l(w.Y,w,w.g),w.P)),B=w.V,q=w.g,re=w.ba;var Re="readystatechange";Array.isArray(Re)||(Re&&(Qt[0]=Re.toString()),Re=Qt);for(let Ve=0;Ve<Re.length;Ve++){const at=Ce(q,Re[Ve],re||B.handleEvent,!1,B.h||B);if(!at)break;B.g[at.key]=at}B=w.J?J(w.J):{},w.u?(w.v||(w.v="POST"),B["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.B,w.v,w.u,B)):(w.v="GET",w.g.ea(w.B,w.v,null,B)),Jt(),ai(w.i,w.v,w.B,w.l,w.S,w.u)}Ei.prototype.ba=function(w){w=w.target;const B=this.O;B&&jo(w)==3?B.j():this.Y(w)},Ei.prototype.Y=function(w){try{if(w==this.g)e:{const on=jo(this.g),gr=this.g.ya(),Nn=this.g.ca();if(!(on<3)&&(on!=3||this.g&&(this.h.h||this.g.la()||Mu(this.g)))){this.K||on!=4||gr==7||(gr==8||Nn<=0?Jt(3):Jt(2)),Xs(this);var B=this.g.ca();this.X=B;var q=wo(this);if(this.o=B==200,As(this.i,this.v,this.B,this.l,this.S,on,B),this.o){if(this.U&&!this.L){t:{if(this.g){var re,Re=this.g;if((re=Re.g?Re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(re)){var Ve=re;break t}}Ve=null}if(w=Ve)ui(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Qn(this,w);else{this.o=!1,this.m=3,Dt(12),Ys(this),Cs(this);break e}}if(this.R){w=!0;let vr;for(;!this.K&&this.C<q.length;)if(vr=cs(this,q),vr==Fo){on==4&&(this.m=4,Dt(14),w=!1),ui(this.i,this.l,null,"[Incomplete Response]");break}else if(vr==Oo){this.m=4,Dt(15),ui(this.i,this.l,q,"[Invalid Chunk]"),w=!1;break}else ui(this.i,this.l,vr,null),Qn(this,vr);if(xa(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),on!=4||q.length!=0||this.h.h||(this.m=1,Dt(16),w=!1),this.o=this.o&&w,!w)ui(this.i,this.l,q,"[Invalid Chunked Response]"),Ys(this),Cs(this);else if(q.length>0&&!this.W){this.W=!0;var at=this.j;at.g==this&&at.aa&&!at.P&&(at.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),ka(at),at.P=!0,Dt(11))}}else ui(this.i,this.l,q,null),Qn(this,q);on==4&&Ys(this),this.o&&!this.K&&(on==4?pe(this.j,this):(this.o=!1,hs(this)))}else Ou(this.g),B==400&&q.indexOf("Unknown SID")>0?(this.m=3,Dt(12)):(this.m=0,Dt(13)),Ys(this),Cs(this)}}}catch{}finally{}};function wo(w){if(!xa(w))return w.g.la();const B=Mu(w.g);if(B==="")return"";let q="";const re=B.length,Re=jo(w.g)==4;if(!w.h.i){if(typeof TextDecoder>"u")return Ys(w),Cs(w),"";w.h.i=new s.TextDecoder}for(let Ve=0;Ve<re;Ve++)w.h.h=!0,q+=w.h.i.decode(B[Ve],{stream:!(Re&&Ve==re-1)});return B.length=0,w.h.g+=q,w.C=0,w.h.g}function xa(w){return w.g?w.v=="GET"&&w.M!=2&&w.j.Aa:!1}function cs(w,B){var q=w.C,re=B.indexOf(`
`,q);return re==-1?Fo:(q=Number(B.substring(q,re)),isNaN(q)?Oo:(re+=1,re+q>B.length?Fo:(B=B.slice(re,re+q),w.C=re+q,B)))}Ei.prototype.cancel=function(){this.K=!0,Ys(this)};function hs(w){w.T=Date.now()+w.H,_a(w,w.H)}function _a(w,B){if(w.D!=null)throw Error("WatchDog timer not null");w.D=Cn(l(w.aa,w),B)}function Xs(w){w.D&&(s.clearTimeout(w.D),w.D=null)}Ei.prototype.aa=function(){this.D=null;const w=Date.now();w-this.T>=0?(Kt(this.i,this.B),this.M!=2&&(Jt(),Dt(17)),Ys(this),this.m=2,Cs(this)):_a(this,this.T-w)};function Cs(w){w.j.I==0||w.K||pe(w.j,w)}function Ys(w){Xs(w);var B=w.O;B&&typeof B.dispose=="function"&&B.dispose(),w.O=null,an(w.V),w.g&&(B=w.g,w.g=null,B.abort(),B.dispose())}function Qn(w,B){try{var q=w.j;if(q.I!=0&&(q.g==w||Nu(q.h,w))){if(!w.L&&Nu(q.h,w)&&q.I==3){try{var re=q.Ba.g.parse(B)}catch{re=null}if(Array.isArray(re)&&re.length==3){var Re=re;if(Re[0]==0){e:if(!q.v){if(q.g)if(q.g.F+3e3<w.F)H(q),Bi(q);else break e;to(q),Dt(18)}}else q.xa=Re[1],0<q.xa-q.K&&Re[2]<37500&&q.F&&q.A==0&&!q.C&&(q.C=Cn(l(q.Va,q),6e3));Qs(q.h)<=1&&q.ta&&(q.ta=void 0)}else ke(q,11)}else if((w.L||q.g==w)&&H(q),!j(B))for(Re=q.Ba.g.parse(B),B=0;B<Re.length;B++){let Nn=Re[B];const vr=Nn[0];if(!(vr<=q.K))if(q.K=vr,Nn=Nn[1],q.I==2)if(Nn[0]=="c"){q.M=Nn[1],q.ba=Nn[2];const fi=Nn[3];fi!=null&&(q.ka=fi,q.j.info("VER="+q.ka));const no=Nn[4];no!=null&&(q.za=no,q.j.info("SVER="+q.za));const yr=Nn[5];yr!=null&&typeof yr=="number"&&yr>0&&(re=1.5*yr,q.O=re,q.j.info("backChannelRequestTimeoutMs_="+re)),re=q;const ro=w.g;if(ro){const Ps=ro.g?ro.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ps){var Ve=re.h;Ve.g||Ps.indexOf("spdy")==-1&&Ps.indexOf("quic")==-1&&Ps.indexOf("h2")==-1||(Ve.j=Ve.l,Ve.g=new Set,Ve.h&&(Ea(Ve,Ve.h),Ve.h=null))}if(re.G){const Za=ro.g?ro.g.getResponseHeader("X-HTTP-Session-Id"):null;Za&&(re.wa=Za,Tn(re.J,re.G,Za))}}q.I=3,q.l&&q.l.ra(),q.aa&&(q.T=Date.now()-w.F,q.j.info("Handshake RTT: "+q.T+"ms")),re=q;var at=w;if(re.na=et(re,re.L?re.ba:null,re.W),at.L){Sa(re.h,at);var on=at,gr=re.O;gr&&(on.H=gr),on.D&&(Xs(on),hs(on)),re.g=at}else hi(re);q.i.length>0&&ms(q)}else Nn[0]!="stop"&&Nn[0]!="close"||ke(q,7);else q.I==3&&(Nn[0]=="stop"||Nn[0]=="close"?Nn[0]=="stop"?ke(q,7):ea(q):Nn[0]!="noop"&&q.l&&q.l.qa(Nn),q.A=0)}}Jt(4)}catch{}}var cc=class{constructor(w,B){this.g=w,this.map=B}};function Ka(w){this.l=w||10,s.PerformanceNavigationTiming?(w=s.performance.getEntriesByType("navigation"),w=w.length>0&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qi(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function Qs(w){return w.h?1:w.g?w.g.size:0}function Nu(w,B){return w.h?w.h==B:w.g?w.g.has(B):!1}function Ea(w,B){w.g?w.g.add(B):w.h=B}function Sa(w,B){w.h&&w.h==B?w.h=null:w.g&&w.g.has(B)&&w.g.delete(B)}Ka.prototype.cancel=function(){if(this.i=Ji(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function Ji(w){if(w.h!=null)return w.i.concat(w.h.G);if(w.g!=null&&w.g.size!==0){let B=w.i;for(const q of w.g.values())B=B.concat(q.G);return B}return p(w.i)}var xl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pr(w,B){if(w){w=w.split("&");for(let q=0;q<w.length;q++){const re=w[q].indexOf("=");let Re,Ve=null;re>=0?(Re=w[q].substring(0,re),Ve=w[q].substring(re+1)):Re=w[q],B(Re,Ve?decodeURIComponent(Ve.replace(/\+/g," ")):"")}}}function bo(w){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let B;w instanceof bo?(this.l=w.l,pr(this,w.j),this.o=w.o,this.g=w.g,fs(this,w.u),this.h=w.h,Oi(this,Ya(w.i)),this.m=w.m):w&&(B=String(w).match(xl))?(this.l=!1,pr(this,B[1]||"",!0),this.o=Si(B[2]||""),this.g=Si(B[3]||"",!0),fs(this,B[4]),this.h=Si(B[5]||"",!0),Oi(this,B[6]||"",!0),this.m=Si(B[7]||"")):(this.l=!1,this.i=new An(null,this.l))}bo.prototype.toString=function(){const w=[];var B=this.j;B&&w.push(br(B,Ru,!0),":");var q=this.g;return(q||B=="file")&&(w.push("//"),(B=this.o)&&w.push(br(B,Ru,!0),"@"),w.push(or(q).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),q=this.u,q!=null&&w.push(":",String(q))),(q=this.h)&&(this.g&&q.charAt(0)!="/"&&w.push("/"),w.push(br(q,q.charAt(0)=="/"?Xa:_l,!0))),(q=this.i.toString())&&w.push("?",q),(q=this.m)&&w.push("#",br(q,Pu)),w.join("")},bo.prototype.resolve=function(w){const B=Bo(this);let q=!!w.j;q?pr(B,w.j):q=!!w.o,q?B.o=w.o:q=!!w.g,q?B.g=w.g:q=w.u!=null;var re=w.h;if(q)fs(B,w.u);else if(q=!!w.h){if(re.charAt(0)!="/")if(this.g&&!this.h)re="/"+re;else{var Re=B.h.lastIndexOf("/");Re!=-1&&(re=B.h.slice(0,Re+1)+re)}if(Re=re,Re==".."||Re==".")re="";else if(Re.indexOf("./")!=-1||Re.indexOf("/.")!=-1){re=Re.lastIndexOf("/",0)==0,Re=Re.split("/");const Ve=[];for(let at=0;at<Re.length;){const on=Re[at++];on=="."?re&&at==Re.length&&Ve.push(""):on==".."?((Ve.length>1||Ve.length==1&&Ve[0]!="")&&Ve.pop(),re&&at==Re.length&&Ve.push("")):(Ve.push(on),re=!0)}re=Ve.join("/")}else re=Re}return q?B.h=re:q=w.i.toString()!=="",q?Oi(B,Ya(w.i)):q=!!w.m,q&&(B.m=w.m),B};function Bo(w){return new bo(w)}function pr(w,B,q){w.j=q?Si(B,!0):B,w.j&&(w.j=w.j.replace(/:$/,""))}function fs(w,B){if(B){if(B=Number(B),isNaN(B)||B<0)throw Error("Bad port number "+B);w.u=B}else w.u=null}function Oi(w,B,q){B instanceof An?(w.i=B,Zi(w.i,w.l)):(q||(B=br(B,Ts)),w.i=new An(B,w.l))}function Tn(w,B,q){w.i.set(B,q)}function Is(w){return Tn(w,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),w}function Si(w,B){return w?B?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function br(w,B,q){return typeof w=="string"?(w=encodeURI(w).replace(B,ds),q&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function ds(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var Ru=/[#\/\?@]/g,_l=/[#\?:]/g,Xa=/[#\?]/g,Ts=/[#\?@]/g,Pu=/#/g;function An(w,B){this.h=this.g=null,this.i=w||null,this.j=!!B}function xo(w){w.g||(w.g=new Map,w.h=0,w.i&&Pr(w.i,function(B,q){w.add(decodeURIComponent(B.replace(/\+/g," ")),q)}))}n=An.prototype,n.add=function(w,B){xo(this),this.i=null,w=ps(this,w);let q=this.g.get(w);return q||this.g.set(w,q=[]),q.push(B),this.h+=1,this};function Js(w,B){xo(w),B=ps(w,B),w.g.has(B)&&(w.i=null,w.h-=w.g.get(B).length,w.g.delete(B))}function Du(w,B){return xo(w),B=ps(w,B),w.g.has(B)}n.forEach=function(w,B){xo(this),this.g.forEach(function(q,re){q.forEach(function(Re){w.call(B,Re,re,this)},this)},this)};function El(w,B){xo(w);let q=[];if(typeof B=="string")Du(w,B)&&(q=q.concat(w.g.get(ps(w,B))));else for(w=Array.from(w.g.values()),B=0;B<w.length;B++)q=q.concat(w[B]);return q}n.set=function(w,B){return xo(this),this.i=null,w=ps(this,w),Du(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[B]),this.h+=1,this},n.get=function(w,B){return w?(w=El(this,w),w.length>0?String(w[0]):B):B};function Sl(w,B,q){Js(w,B),q.length>0&&(w.i=null,w.g.set(ps(w,B),p(q)),w.h+=q.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],B=Array.from(this.g.keys());for(let re=0;re<B.length;re++){var q=B[re];const Re=or(q);q=El(this,q);for(let Ve=0;Ve<q.length;Ve++){let at=Re;q[Ve]!==""&&(at+="="+or(q[Ve])),w.push(at)}}return this.i=w.join("&")};function Ya(w){const B=new An;return B.i=w.i,w.g&&(B.g=new Map(w.g),B.h=w.h),B}function ps(w,B){return B=String(B),w.j&&(B=B.toLowerCase()),B}function Zi(w,B){B&&!w.j&&(xo(w),w.i=null,w.g.forEach(function(q,re){const Re=re.toLowerCase();re!=Re&&(Js(this,re),Sl(this,Re,q))},w)),w.j=B}function ks(w,B){const q=new Mo;if(s.Image){const re=new Image;re.onload=h(jr,q,"TestLoadImage: loaded",!0,B,re),re.onerror=h(jr,q,"TestLoadImage: error",!1,B,re),re.onabort=h(jr,q,"TestLoadImage: abort",!1,B,re),re.ontimeout=h(jr,q,"TestLoadImage: timeout",!1,B,re),s.setTimeout(function(){re.ontimeout&&re.ontimeout()},1e4),re.src=w}else B(!1)}function eo(w,B){const q=new Mo,re=new AbortController,Re=setTimeout(()=>{re.abort(),jr(q,"TestPingServer: timeout",!1,B)},1e4);fetch(w,{signal:re.signal}).then(Ve=>{clearTimeout(Re),Ve.ok?jr(q,"TestPingServer: ok",!0,B):jr(q,"TestPingServer: server error",!1,B)}).catch(()=>{clearTimeout(Re),jr(q,"TestPingServer: error",!1,B)})}function jr(w,B,q,re,Re){try{Re&&(Re.onload=null,Re.onerror=null,Re.onabort=null,Re.ontimeout=null),re(q)}catch{}}function Qa(){this.g=new en}function Xt(w){this.i=w.Sb||null,this.h=w.ab||!1}d(Xt,yt),Xt.prototype.g=function(){return new _o(this.i,this.h)};function _o(w,B){He.call(this),this.H=w,this.o=B,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(_o,He),n=_o.prototype,n.open=function(w,B){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=w,this.D=B,this.readyState=1,ci(this)},n.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const B={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};w&&(B.body=w),(this.H||s).fetch(new Request(this.D,B)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Aa(this)),this.readyState=0},n.Pa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,ci(this)),this.g&&(this.readyState=3,ci(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;hc(this)}else w.text().then(this.Oa.bind(this),this.ga.bind(this))};function hc(w){w.j.read().then(w.Ma.bind(w)).catch(w.ga.bind(w))}n.Ma=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var B=w.value?w.value:new Uint8Array(0);(B=this.B.decode(B,{stream:!w.done}))&&(this.response=this.responseText+=B)}w.done?Aa(this):ci(this),this.readyState==3&&hc(this)}},n.Oa=function(w){this.g&&(this.response=this.responseText=w,Aa(this))},n.Na=function(w){this.g&&(this.response=w,Aa(this))},n.ga=function(){this.g&&Aa(this)};function Aa(w){w.readyState=4,w.l=null,w.j=null,w.B=null,ci(w)}n.setRequestHeader=function(w,B){this.A.append(w,B)},n.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],B=this.h.entries();for(var q=B.next();!q.done;)q=q.value,w.push(q[0]+": "+q[1]),q=B.next();return w.join(`\r
`)};function ci(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(_o.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function Ns(w){let B="";return le(w,function(q,re){B+=re,B+=":",B+=q,B+=`\r
`}),B}function Lu(w,B,q){e:{for(re in q){var re=!1;break e}re=!0}re||(q=Ns(q),typeof w=="string"?q!=null&&or(q):Tn(w,B,q))}function Jn(w){He.call(this),this.headers=new Map,this.L=w||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(Jn,He);var Ja=/^https?$/i,Al=["POST","PUT"];n=Jn.prototype,n.Fa=function(w){this.H=w},n.ea=function(w,B,q,re){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);B=B?B.toUpperCase():"GET",this.D=w,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():vo.g(),this.g.onreadystatechange=m(l(this.Ca,this));try{this.B=!0,this.g.open(B,String(w),!0),this.B=!1}catch(Ve){Vo(this,Ve);return}if(w=q||"",q=new Map(this.headers),re)if(Object.getPrototypeOf(re)===Object.prototype)for(var Re in re)q.set(Re,re[Re]);else if(typeof re.keys=="function"&&typeof re.get=="function")for(const Ve of re.keys())q.set(Ve,re.get(Ve));else throw Error("Unknown input type for opt_headers: "+String(re));re=Array.from(q.keys()).find(Ve=>Ve.toLowerCase()=="content-type"),Re=s.FormData&&w instanceof s.FormData,!(Array.prototype.indexOf.call(Al,B,void 0)>=0)||re||Re||q.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ve,at]of q)this.g.setRequestHeader(Ve,at);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(w),this.v=!1}catch(Ve){Vo(this,Ve)}};function Vo(w,B){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=B,w.o=5,Ca(w),Zs(w)}function Ca(w){w.A||(w.A=!0,ft(w,"complete"),ft(w,"error"))}n.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=w||7,ft(this,"complete"),ft(this,"abort"),Zs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zs(this,!0)),Jn.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Fi(this):this.Xa())},n.Xa=function(){Fi(this)};function Fi(w){if(w.h&&typeof o<"u"){if(w.v&&jo(w)==4)setTimeout(w.Ca.bind(w),0);else if(ft(w,"readystatechange"),jo(w)==4){w.h=!1;try{const Ve=w.ca();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var B=!0;break e;default:B=!1}var q;if(!(q=B)){var re;if(re=Ve===0){let at=String(w.D).match(xl)[1]||null;!at&&s.self&&s.self.location&&(at=s.self.location.protocol.slice(0,-1)),re=!Ja.test(at?at.toLowerCase():"")}q=re}if(q)ft(w,"complete"),ft(w,"success");else{w.o=6;try{var Re=jo(w)>2?w.g.statusText:""}catch{Re=""}w.l=Re+" ["+w.ca()+"]",Ca(w)}}finally{Zs(w)}}}}function Zs(w,B){if(w.g){w.m&&(clearTimeout(w.m),w.m=null);const q=w.g;w.g=null,B||ft(w,"ready");try{q.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function jo(w){return w.g?w.g.readyState:0}n.ca=function(){try{return jo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(w){if(this.g){var B=this.g.responseText;return w&&B.indexOf(w)==0&&(B=B.substring(w.length)),vt(B)}};function Mu(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.F){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch{return null}}function Ou(w){const B={};w=(w.g&&jo(w)>=2&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let re=0;re<w.length;re++){if(j(w[re]))continue;var q=Rr(w[re]);const Re=q[0];if(q=q[1],typeof q!="string")continue;q=q.trim();const Ve=B[Re]||[];B[Re]=Ve,Ve.push(q)}ae(B,function(re){return re.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ai(w,B,q){return q&&q.internalChannelParams&&q.internalChannelParams[w]||B}function Ia(w){this.za=0,this.i=[],this.j=new Mo,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ai("failFast",!1,w),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ai("baseRetryDelayMs",5e3,w),this.Za=Ai("retryDelaySeedMs",1e4,w),this.Ta=Ai("forwardChannelMaxRetries",2,w),this.va=Ai("forwardChannelRequestTimeoutMs",2e4,w),this.ma=w&&w.xmlHttpFactory||void 0,this.Ua=w&&w.Rb||void 0,this.Aa=w&&w.useFetchStreams||!1,this.O=void 0,this.L=w&&w.supportsCrossDomainXhr||!1,this.M="",this.h=new Ka(w&&w.concurrentRequestLimit),this.Ba=new Qa,this.S=w&&w.fastHandshake||!1,this.R=w&&w.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=w&&w.Pb||!1,w&&w.ua&&this.j.ua(),w&&w.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&w&&w.detectBufferingProxy||!1,this.ia=void 0,w&&w.longPollingTimeout&&w.longPollingTimeout>0&&(this.ia=w.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ia.prototype,n.ka=8,n.I=1,n.connect=function(w,B,q,re){Dt(0),this.W=w,this.H=B||{},q&&re!==void 0&&(this.H.OSID=q,this.H.OAID=re),this.F=this.X,this.J=et(this,null,this.W),ms(this)};function ea(w){if(Rs(w),w.I==3){var B=w.V++,q=Bo(w.J);if(Tn(q,"SID",w.M),Tn(q,"RID",B),Tn(q,"TYPE","terminate"),Ci(w,q),B=new Ei(w,w.j,B),B.M=2,B.A=Is(Bo(q)),q=!1,s.navigator&&s.navigator.sendBeacon)try{q=s.navigator.sendBeacon(B.A.toString(),"")}catch{}!q&&s.Image&&(new Image().src=B.A,q=!0),q||(B.g=wt(B.j,null),B.g.ea(B.A)),B.F=Date.now(),hs(B)}Xe(w)}function Bi(w){w.g&&(ka(w),w.g.cancel(),w.g=null)}function Rs(w){Bi(w),w.v&&(s.clearTimeout(w.v),w.v=null),H(w),w.h.cancel(),w.m&&(typeof w.m=="number"&&s.clearTimeout(w.m),w.m=null)}function ms(w){if(!Qi(w.h)&&!w.m){w.m=!0;var B=w.Ea;D||C(),U||(D(),U=!0),L.add(B,w),w.D=0}}function Cl(w,B){return Qs(w.h)>=w.h.j-(w.m?1:0)?!1:w.m?(w.i=B.G.concat(w.i),!0):w.I==1||w.I==2||w.D>=(w.Sa?0:w.Ta)?!1:(w.m=Cn(l(w.Ea,w,B),be(w,w.D)),w.D++,!0)}n.Ea=function(w){if(this.m)if(this.m=null,this.I==1){if(!w){this.V=Math.floor(Math.random()*1e5),w=this.V++;const Re=new Ei(this,this.j,w);let Ve=this.o;if(this.U&&(Ve?(Ve=J(Ve),Q(Ve,this.U)):Ve=this.U),this.u!==null||this.R||(Re.J=Ve,Ve=null),this.S)e:{for(var B=0,q=0;q<this.i.length;q++){t:{var re=this.i[q];if("__data__"in re.map&&(re=re.map.__data__,typeof re=="string")){re=re.length;break t}re=void 0}if(re===void 0)break;if(B+=re,B>4096){B=q;break e}if(B===4096||q===this.i.length-1){B=q+1;break e}}B=1e3}else B=1e3;B=gs(this,Re,B),q=Bo(this.J),Tn(q,"RID",w),Tn(q,"CVER",22),this.G&&Tn(q,"X-HTTP-Session-Id",this.G),Ci(this,q),Ve&&(this.R?B="headers="+or(Ns(Ve))+"&"+B:this.u&&Lu(q,this.u,Ve)),Ea(this.h,Re),this.Ra&&Tn(q,"TYPE","init"),this.S?(Tn(q,"$req",B),Tn(q,"SID","null"),Re.U=!0,Vr(Re,q,null)):Vr(Re,q,B),this.I=2}}else this.I==3&&(w?Ta(this,w):this.i.length==0||Qi(this.h)||Ta(this))};function Ta(w,B){var q;B?q=B.l:q=w.V++;const re=Bo(w.J);Tn(re,"SID",w.M),Tn(re,"RID",q),Tn(re,"AID",w.K),Ci(w,re),w.u&&w.o&&Lu(re,w.u,w.o),q=new Ei(w,w.j,q,w.D+1),w.u===null&&(q.J=w.o),B&&(w.i=B.G.concat(w.i)),B=gs(w,q,1e3),q.H=Math.round(w.va*.5)+Math.round(w.va*.5*Math.random()),Ea(w.h,q),Vr(q,re,B)}function Ci(w,B){w.H&&le(w.H,function(q,re){Tn(B,re,q)}),w.l&&le({},function(q,re){Tn(B,re,q)})}function gs(w,B,q){q=Math.min(w.i.length,q);const re=w.l?l(w.l.Ka,w.l,w):null;e:{var Re=w.i;let on=-1;for(;;){const gr=["count="+q];on==-1?q>0?(on=Re[0].g,gr.push("ofs="+on)):on=0:gr.push("ofs="+on);let Nn=!0;for(let vr=0;vr<q;vr++){var Ve=Re[vr].g;const fi=Re[vr].map;if(Ve-=on,Ve<0)on=Math.max(0,Re[vr].g-100),Nn=!1;else try{Ve="req"+Ve+"_"||"";try{var at=fi instanceof Map?fi:Object.entries(fi);for(const[no,yr]of at){let ro=yr;a(yr)&&(ro=qt(yr)),gr.push(Ve+no+"="+encodeURIComponent(ro))}}catch(no){throw gr.push(Ve+"type="+encodeURIComponent("_badmap")),no}}catch{re&&re(fi)}}if(Nn){at=gr.join("&");break e}}at=void 0}return w=w.i.splice(0,q),B.G=w,at}function hi(w){if(!w.g&&!w.v){w.Y=1;var B=w.Da;D||C(),U||(D(),U=!0),L.add(B,w),w.A=0}}function to(w){return w.g||w.v||w.A>=3?!1:(w.Y++,w.v=Cn(l(w.Da,w),be(w,w.A)),w.A++,!0)}n.Da=function(){if(this.v=null,N(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var w=4*this.T;this.j.info("BP detection timer enabled: "+w),this.B=Cn(l(this.Wa,this),w)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Dt(10),Bi(this),N(this))};function ka(w){w.B!=null&&(s.clearTimeout(w.B),w.B=null)}function N(w){w.g=new Ei(w,w.j,"rpc",w.Y),w.u===null&&(w.g.J=w.o),w.g.P=0;var B=Bo(w.na);Tn(B,"RID","rpc"),Tn(B,"SID",w.M),Tn(B,"AID",w.K),Tn(B,"CI",w.F?"0":"1"),!w.F&&w.ia&&Tn(B,"TO",w.ia),Tn(B,"TYPE","xmlhttp"),Ci(w,B),w.u&&w.o&&Lu(B,w.u,w.o),w.O&&(w.g.H=w.O);var q=w.g;w=w.ba,q.M=1,q.A=Is(Bo(B)),q.u=null,q.R=!0,yo(q,w)}n.Va=function(){this.C!=null&&(this.C=null,Bi(this),to(this),Dt(19))};function H(w){w.C!=null&&(s.clearTimeout(w.C),w.C=null)}function pe(w,B){var q=null;if(w.g==B){H(w),ka(w),w.g=null;var re=2}else if(Nu(w.h,B))q=B.G,Sa(w.h,B),re=1;else return;if(w.I!=0){if(B.o)if(re==1){q=B.u?B.u.length:0,B=Date.now()-B.F;var Re=w.D;re=Bn(),ft(re,new Gt(re,q)),ms(w)}else hi(w);else if(Re=B.m,Re==3||Re==0&&B.X>0||!(re==1&&Cl(w,B)||re==2&&to(w)))switch(q&&q.length>0&&(B=w.h,B.i=B.i.concat(q)),Re){case 1:ke(w,5);break;case 4:ke(w,10);break;case 3:ke(w,6);break;default:ke(w,2)}}}function be(w,B){let q=w.Qa+Math.floor(Math.random()*w.Za);return w.isActive()||(q*=2),q*B}function ke(w,B){if(w.j.info("Error code "+B),B==2){var q=l(w.bb,w),re=w.Ua;const Re=!re;re=new bo(re||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||pr(re,"https"),Is(re),Re?ks(re.toString(),q):eo(re.toString(),q)}else Dt(2);w.I=0,w.l&&w.l.pa(B),Xe(w),Rs(w)}n.bb=function(w){w?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function Xe(w){if(w.I=0,w.ja=[],w.l){const B=Ji(w.h);(B.length!=0||w.i.length!=0)&&(y(w.ja,B),y(w.ja,w.i),w.h.i.length=0,p(w.i),w.i.length=0),w.l.oa()}}function et(w,B,q){var re=q instanceof bo?Bo(q):new bo(q);if(re.g!="")B&&(re.g=B+"."+re.g),fs(re,re.u);else{var Re=s.location;re=Re.protocol,B=B?B+"."+Re.hostname:Re.hostname,Re=+Re.port;const Ve=new bo(null);re&&pr(Ve,re),B&&(Ve.g=B),Re&&fs(Ve,Re),q&&(Ve.h=q),re=Ve}return q=w.G,B=w.wa,q&&B&&Tn(re,q,B),Tn(re,"VER",w.ka),Ci(w,re),re}function wt(w,B,q){if(B&&!w.L)throw Error("Can't create secondary domain capable XhrIo object.");return B=w.Aa&&!w.ma?new Jn(new Xt({ab:q})):new Jn(w.ma),B.Fa(w.L),B}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function It(){}n=It.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Zt(){}Zt.prototype.g=function(w,B){return new Ft(w,B)};function Ft(w,B){He.call(this),this.g=new Ia(B),this.l=w,this.h=B&&B.messageUrlParams||null,w=B&&B.messageHeaders||null,B&&B.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=B&&B.initMessageHeaders||null,B&&B.messageContentType&&(w?w["X-WebChannel-Content-Type"]=B.messageContentType:w={"X-WebChannel-Content-Type":B.messageContentType}),B&&B.sa&&(w?w["X-WebChannel-Client-Profile"]=B.sa:w={"X-WebChannel-Client-Profile":B.sa}),this.g.U=w,(w=B&&B.Qb)&&!j(w)&&(this.g.u=w),this.A=B&&B.supportsCrossDomainXhr||!1,this.v=B&&B.sendRawJson||!1,(B=B&&B.httpSessionIdParam)&&!j(B)&&(this.g.G=B,w=this.h,w!==null&&B in w&&(w=this.h,B in w&&delete w[B])),this.j=new sr(this)}d(Ft,He),Ft.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ft.prototype.close=function(){ea(this.g)},Ft.prototype.o=function(w){var B=this.g;if(typeof w=="string"){var q={};q.__data__=w,w=q}else this.v&&(q={},q.__data__=qt(w),w=q);B.i.push(new cc(B.Ya++,w)),B.I==3&&ms(B)},Ft.prototype.N=function(){this.g.l=null,delete this.j,ea(this.g),delete this.g,Ft.Z.N.call(this)};function kn(w){rn.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var B=w.__sm__;if(B){e:{for(const q in B){w=q;break e}w=void 0}(this.i=w)&&(w=this.i,B=B!==null&&w in B?B[w]:void 0),this.data=B}else this.data=w}d(kn,rn);function mr(){un.call(this),this.status=1}d(mr,un);function sr(w){this.g=w}d(sr,It),sr.prototype.ra=function(){ft(this.g,"a")},sr.prototype.qa=function(w){ft(this.g,new kn(w))},sr.prototype.pa=function(w){ft(this.g,new mr)},sr.prototype.oa=function(){ft(this.g,"b")},Zt.prototype.createWebChannel=Zt.prototype.g,Ft.prototype.send=Ft.prototype.o,Ft.prototype.open=Ft.prototype.m,Ft.prototype.close=Ft.prototype.close,FR=function(){return new Zt},OR=function(){return Bn()},MR=On,zw={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Yi.NO_ERROR=0,Yi.TIMEOUT=8,Yi.HTTP_ERROR=6,Bv=Yi,li.COMPLETE="complete",LR=li,dr.EventType=mn,mn.OPEN="a",mn.CLOSE="b",mn.ERROR="c",mn.MESSAGE="d",He.prototype.listen=He.prototype.J,Yp=dr,Jn.prototype.listenOnce=Jn.prototype.K,Jn.prototype.getLastError=Jn.prototype.Ha,Jn.prototype.getLastErrorCode=Jn.prototype.ya,Jn.prototype.getStatus=Jn.prototype.ca,Jn.prototype.getResponseJson=Jn.prototype.La,Jn.prototype.getResponseText=Jn.prototype.la,Jn.prototype.send=Jn.prototype.ea,Jn.prototype.setWithCredentials=Jn.prototype.Fa,DR=Jn}).apply(typeof wv<"u"?wv:typeof self<"u"?self:typeof window<"u"?window:{});const XC="@firebase/firestore",YC="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ns.UNAUTHENTICATED=new ns(null),ns.GOOGLE_CREDENTIALS=new ns("google-credentials-uid"),ns.FIRST_PARTY=new ns("first-party-uid"),ns.MOCK_USER=new ns("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cp="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf=new Xx("@firebase/firestore");function ld(){return vf.logLevel}function St(n,...e){if(vf.logLevel<=Fn.DEBUG){const t=e.map(s_);vf.debug(`Firestore (${cp}): ${n}`,...t)}}function nc(n,...e){if(vf.logLevel<=Fn.ERROR){const t=e.map(s_);vf.error(`Firestore (${cp}): ${n}`,...t)}}function Kd(n,...e){if(vf.logLevel<=Fn.WARN){const t=e.map(s_);vf.warn(`Firestore (${cp}): ${n}`,...t)}}function s_(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,BR(n,r,t)}function BR(n,e,t){let r=`FIRESTORE (${cp}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw nc(r),new Error(r)}function Qr(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||BR(e,i,r)}function Wn(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ht={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Yt extends lc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class IX{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ns.UNAUTHENTICATED)))}shutdown(){}}class TX{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class kX{constructor(e){this.t=e,this.currentUser=ns.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Qr(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let o=new Ld;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ld,e.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const u=o;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},a=u=>{St("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((u=>a(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(St("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ld)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(St("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Qr(typeof r.accessToken=="string",31837,{l:r}),new VR(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Qr(e===null||typeof e=="string",2055,{h:e}),new ns(e)}}class NX{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=ns.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class RX{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new NX(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ns.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class QC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class PX{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vu(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Qr(this.o===void 0,3512);const r=o=>{o.error!=null&&St("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.m;return this.m=o.token,St("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>r(o)))};const i=o=>{St("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):St("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new QC(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Qr(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new QC(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DX(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=DX(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}}function Vn(n,e){return n<e?-1:n>e?1:0}function Ww(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),o=e.charAt(r);if(i!==o)return R2(i)===R2(o)?Vn(i,o):R2(i)?1:-1}return Vn(n.length,e.length)}const LX=55296,MX=57343;function R2(n){const e=n.charCodeAt(0);return e>=LX&&e<=MX}function Xd(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC="__name__";class Ju{constructor(e,t,r){t===void 0?t=0:t>e.length&&_n(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&_n(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ju.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ju?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const o=Ju.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Vn(e.length,t.length)}static compareSegments(e,t){const r=Ju.isNumericId(e),i=Ju.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Ju.extractNumericId(e).compare(Ju.extractNumericId(t)):Ww(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return rh.fromString(e.substring(4,e.length-2))}}class Kr extends Ju{construct(e,t,r){return new Kr(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Yt(ht.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Kr(t)}static emptyPath(){return new Kr([])}}const OX=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ss extends Ju{construct(e,t,r){return new Ss(e,t,r)}static isValidIdentifier(e){return OX.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ss.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===JC}static keyField(){return new Ss([JC])}static fromServerFormat(e){const t=[];let r="",i=0;const o=()=>{if(r.length===0)throw new Yt(ht.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let s=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Yt(ht.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Yt(ht.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Yt(ht.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ss(t)}static emptyPath(){return new Ss([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.path=e}static fromPath(e){return new hn(Kr.fromString(e))}static fromName(e){return new hn(Kr.fromString(e).popFirst(5))}static empty(){return new hn(Kr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Kr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Kr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new hn(new Kr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FX(n,e,t){if(!t)throw new Yt(ht.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function BX(n,e,t,r){if(e===!0&&r===!0)throw new Yt(ht.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ZC(n){if(hn.isDocumentKey(n))throw new Yt(ht.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function VX(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function jX(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":_n(12329,{type:typeof n})}function Vv(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Yt(ht.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=jX(n);throw new Yt(ht.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(n,e){const t={typeString:n};return e&&(t.value=e),t}function og(n,e){if(!VX(n))throw new Yt(ht.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const s=n[r];if(i&&typeof s!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new Yt(ht.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=-62135596800,t4=1e6;class Pi{static now(){return Pi.fromMillis(Date.now())}static fromDate(e){return Pi.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*t4);return new Pi(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Yt(ht.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Yt(ht.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<e4)throw new Yt(ht.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Yt(ht.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/t4}_compareTo(e){return this.seconds===e.seconds?Vn(this.nanoseconds,e.nanoseconds):Vn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Pi._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(og(e,Pi._jsonSchema))return new Pi(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-e4;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Pi._jsonSchemaVersion="firestore/timestamp/1.0",Pi._jsonSchema={type:Mi("string",Pi._jsonSchemaVersion),seconds:Mi("number"),nanoseconds:Mi("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{static fromTimestamp(e){return new xn(e)}static min(){return new xn(new Pi(0,0))}static max(){return new xn(new Pi(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lm=-1;function UX(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=xn.fromTimestamp(r===1e9?new Pi(t+1,0):new Pi(t,r));return new fh(i,hn.empty(),e)}function zX(n){return new fh(n.readTime,n.key,Lm)}class fh{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new fh(xn.min(),hn.empty(),Lm)}static max(){return new fh(xn.max(),hn.empty(),Lm)}}function WX(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=hn.comparator(n.documentKey,e.documentKey),t!==0?t:Vn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qX="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class HX{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d1(n){if(n.code!==ht.FAILED_PRECONDITION||n.message!==qX)throw n;St("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_n(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new tt(((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof tt?t:tt.resolve(t)}catch(t){return tt.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):tt.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):tt.reject(t)}static resolve(e){return new tt(((t,r)=>{t(e)}))}static reject(e){return new tt(((t,r)=>{r(e)}))}static waitFor(e){return new tt(((t,r)=>{let i=0,o=0,s=!1;e.forEach((a=>{++i,a.next((()=>{++o,s&&o===i&&t()}),(u=>r(u)))})),s=!0,o===i&&t()}))}static or(e){let t=tt.resolve(!1);for(const r of e)t=t.next((i=>i?tt.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,o)=>{r.push(t.call(this,i,o))})),this.waitFor(r)}static mapArray(e,t){return new tt(((r,i)=>{const o=e.length,s=new Array(o);let a=0;for(let u=0;u<o;u++){const l=u;t(e[l]).next((h=>{s[l]=h,++a,a===o&&r(s)}),(h=>i(h)))}}))}static doWhile(e,t){return new tt(((r,i)=>{const o=()=>{e()===!0?t().next((()=>{o()}),i):r()};o()}))}}function GX(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function hp(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}p1.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $X=-1;function m1(n){return n==null}function qw(n){return n===0&&1/n==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR="";function KX(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=n4(e)),e=XX(n.get(t),e);return n4(e)}function XX(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const o=n.charAt(i);switch(o){case"\0":t+="";break;case UR:t+="";break;default:t+=o}}return t}function n4(n){return n+UR+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r4(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function sg(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function YX(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,t){this.comparator=e,this.root=t||Ro.EMPTY}insert(e,t){return new _i(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ro.BLACK,null,null))}remove(e){return new _i(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ro.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bv(this.root,e,this.comparator,!1)}getReverseIterator(){return new bv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bv(this.root,e,this.comparator,!0)}}class bv{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ro{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??Ro.RED,this.left=i??Ro.EMPTY,this.right=o??Ro.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new Ro(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ro.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ro.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ro.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ro.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _n(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _n(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _n(27949);return e+(this.isRed()?0:1)}}Ro.EMPTY=null,Ro.RED=!0,Ro.BLACK=!1;Ro.EMPTY=new class{constructor(){this.size=0}get key(){throw _n(57766)}get value(){throw _n(16141)}get color(){throw _n(16727)}get left(){throw _n(29726)}get right(){throw _n(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new Ro(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e){this.comparator=e,this.data=new _i(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new i4(this.data.getIterator())}getIteratorFrom(e){return new i4(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Gi)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Gi(this.comparator);return t.data=e,t}}class i4{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e){this.fields=e,e.sort(Ss.comparator)}static empty(){return new Kc([])}unionWith(e){let t=new Gi(Ss.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Kc(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xd(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new zR("Invalid base64 string: "+o):o}})(e);return new Lo(t)}static fromUint8Array(e){const t=(function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o})(e);return new Lo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Vn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Lo.EMPTY_BYTE_STRING=new Lo("");const QX=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dh(n){if(Qr(!!n,39018),typeof n=="string"){let e=0;const t=QX.exec(n);if(Qr(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vi(n.seconds),nanos:vi(n.nanos)}}function vi(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ph(n){return typeof n=="string"?Lo.fromBase64String(n):Lo.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR="server_timestamp",qR="__type__",HR="__previous_value__",GR="__local_write_time__";function a_(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[qR])==null?void 0:r.stringValue)===WR}function g1(n){const e=n.mapValue.fields[HR];return a_(e)?g1(e):e}function Mm(n){const e=dh(n.mapValue.fields[GR].timestampValue);return new Pi(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JX{constructor(e,t,r,i,o,s,a,u,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l,this.isUsingEmulator=h}}const R0="(default)";class Om{constructor(e,t){this.projectId=e,this.database=t||R0}static empty(){return new Om("","")}get isDefaultDatabase(){return this.database===R0}isEqual(e){return e instanceof Om&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZX="__type__",eY="__max__",xv={mapValue:{}},tY="__vector__",Hw="value";function mh(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?a_(n)?4:rY(n)?9007199254740991:nY(n)?10:11:_n(28295,{value:n})}function ml(n,e){if(n===e)return!0;const t=mh(n);if(t!==mh(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Mm(n).isEqual(Mm(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=dh(i.timestampValue),a=dh(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return ph(i.bytesValue).isEqual(ph(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return vi(i.geoPointValue.latitude)===vi(o.geoPointValue.latitude)&&vi(i.geoPointValue.longitude)===vi(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return vi(i.integerValue)===vi(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=vi(i.doubleValue),a=vi(o.doubleValue);return s===a?qw(s)===qw(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return Xd(n.arrayValue.values||[],e.arrayValue.values||[],ml);case 10:case 11:return(function(i,o){const s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(r4(s)!==r4(a))return!1;for(const u in s)if(s.hasOwnProperty(u)&&(a[u]===void 0||!ml(s[u],a[u])))return!1;return!0})(n,e);default:return _n(52216,{left:n})}}function Fm(n,e){return(n.values||[]).find((t=>ml(t,e)))!==void 0}function Yd(n,e){if(n===e)return 0;const t=mh(n),r=mh(e);if(t!==r)return Vn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Vn(n.booleanValue,e.booleanValue);case 2:return(function(o,s){const a=vi(o.integerValue||o.doubleValue),u=vi(s.integerValue||s.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1})(n,e);case 3:return o4(n.timestampValue,e.timestampValue);case 4:return o4(Mm(n),Mm(e));case 5:return Ww(n.stringValue,e.stringValue);case 6:return(function(o,s){const a=ph(o),u=ph(s);return a.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){const a=o.split("/"),u=s.split("/");for(let l=0;l<a.length&&l<u.length;l++){const h=Vn(a[l],u[l]);if(h!==0)return h}return Vn(a.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){const a=Vn(vi(o.latitude),vi(s.latitude));return a!==0?a:Vn(vi(o.longitude),vi(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return s4(n.arrayValue,e.arrayValue);case 10:return(function(o,s){var m,p,y,b;const a=o.fields||{},u=s.fields||{},l=(m=a[Hw])==null?void 0:m.arrayValue,h=(p=u[Hw])==null?void 0:p.arrayValue,d=Vn(((y=l==null?void 0:l.values)==null?void 0:y.length)||0,((b=h==null?void 0:h.values)==null?void 0:b.length)||0);return d!==0?d:s4(l,h)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===xv.mapValue&&s===xv.mapValue)return 0;if(o===xv.mapValue)return 1;if(s===xv.mapValue)return-1;const a=o.fields||{},u=Object.keys(a),l=s.fields||{},h=Object.keys(l);u.sort(),h.sort();for(let d=0;d<u.length&&d<h.length;++d){const m=Ww(u[d],h[d]);if(m!==0)return m;const p=Yd(a[u[d]],l[h[d]]);if(p!==0)return p}return Vn(u.length,h.length)})(n.mapValue,e.mapValue);default:throw _n(23264,{he:t})}}function o4(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Vn(n,e);const t=dh(n),r=dh(e),i=Vn(t.seconds,r.seconds);return i!==0?i:Vn(t.nanos,r.nanos)}function s4(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const o=Yd(t[i],r[i]);if(o)return o}return Vn(t.length,r.length)}function Qd(n){return Gw(n)}function Gw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=dh(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ph(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return hn.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const o of t.values||[])i?i=!1:r+=",",r+=Gw(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const s of r)o?o=!1:i+=",",i+=`${s}:${Gw(t.fields[s])}`;return i+"}"})(n.mapValue):_n(61005,{value:n})}function jv(n){switch(mh(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=g1(n);return e?16+jv(e):16;case 5:return 2*n.stringValue.length;case 6:return ph(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,o)=>i+jv(o)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return sg(r.fields,((o,s)=>{i+=o.length+jv(s)})),i})(n.mapValue);default:throw _n(13486,{value:n})}}function $w(n){return!!n&&"integerValue"in n}function u_(n){return!!n&&"arrayValue"in n}function a4(n){return!!n&&"nullValue"in n}function u4(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function P2(n){return!!n&&"mapValue"in n}function nY(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[ZX])==null?void 0:r.stringValue)===tY}function hm(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return sg(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=hm(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hm(n.arrayValue.values[t]);return e}return{...n}}function rY(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===eY}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e){this.value=e}static empty(){return new nl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!P2(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hm(t)}setAll(e){let t=Ss.emptyPath(),r={},i=[];e.forEach(((s,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=hm(s):i.push(a.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){const t=this.field(e.popLast());P2(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ml(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];P2(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){sg(t,((i,o)=>e[i]=o));for(const i of r)delete e[i]}clone(){return new nl(hm(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new is(e,0,xn.min(),xn.min(),xn.min(),nl.empty(),0)}static newFoundDocument(e,t,r,i){return new is(e,1,t,xn.min(),r,i,0)}static newNoDocument(e,t){return new is(e,2,t,xn.min(),xn.min(),nl.empty(),0)}static newUnknownDocument(e,t){return new is(e,3,t,xn.min(),xn.min(),nl.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(xn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof is&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new is(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,t){this.position=e,this.inclusive=t}}function l4(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const o=e[i],s=n.position[i];if(o.field.isKeyField()?r=hn.comparator(hn.fromName(s.referenceValue),t.key):r=Yd(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function c4(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ml(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e,t="asc"){this.field=e,this.dir=t}}function iY(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{}class Wi extends $R{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new sY(e,t,r):t==="array-contains"?new lY(e,r):t==="in"?new cY(e,r):t==="not-in"?new hY(e,r):t==="array-contains-any"?new fY(e,r):new Wi(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new aY(e,r):new uY(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yd(t,this.value)):t!==null&&mh(this.value)===mh(t)&&this.matchesComparison(Yd(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _n(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gl extends $R{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gl(e,t)}matches(e){return KR(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function KR(n){return n.op==="and"}function XR(n){return oY(n)&&KR(n)}function oY(n){for(const e of n.filters)if(e instanceof gl)return!1;return!0}function Kw(n){if(n instanceof Wi)return n.field.canonicalString()+n.op.toString()+Qd(n.value);if(XR(n))return n.filters.map((e=>Kw(e))).join(",");{const e=n.filters.map((t=>Kw(t))).join(",");return`${n.op}(${e})`}}function YR(n,e){return n instanceof Wi?(function(r,i){return i instanceof Wi&&r.op===i.op&&r.field.isEqual(i.field)&&ml(r.value,i.value)})(n,e):n instanceof gl?(function(r,i){return i instanceof gl&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((o,s,a)=>o&&YR(s,i.filters[a])),!0):!1})(n,e):void _n(19439)}function QR(n){return n instanceof Wi?(function(t){return`${t.field.canonicalString()} ${t.op} ${Qd(t.value)}`})(n):n instanceof gl?(function(t){return t.op.toString()+" {"+t.getFilters().map(QR).join(" ,")+"}"})(n):"Filter"}class sY extends Wi{constructor(e,t,r){super(e,t,r),this.key=hn.fromName(r.referenceValue)}matches(e){const t=hn.comparator(e.key,this.key);return this.matchesComparison(t)}}class aY extends Wi{constructor(e,t){super(e,"in",t),this.keys=JR("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class uY extends Wi{constructor(e,t){super(e,"not-in",t),this.keys=JR("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function JR(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((r=>hn.fromName(r.referenceValue)))}class lY extends Wi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return u_(t)&&Fm(t.arrayValue,this.value)}}class cY extends Wi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Fm(this.value.arrayValue,t)}}class hY extends Wi{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fm(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Fm(this.value.arrayValue,t)}}class fY extends Wi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!u_(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Fm(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dY{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}}function h4(n,e=null,t=[],r=[],i=null,o=null,s=null){return new dY(n,e,t,r,i,o,s)}function l_(n){const e=Wn(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Kw(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),m1(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Qd(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Qd(r))).join(",")),e.Te=t}return e.Te}function c_(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!iY(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!YR(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!c4(n.startAt,e.startAt)&&c4(n.endAt,e.endAt)}function Xw(n){return hn.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function pY(n,e,t,r,i,o,s,a){return new v1(n,e,t,r,i,o,s,a)}function h_(n){return new v1(n)}function f4(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function mY(n){return n.collectionGroup!==null}function fm(n){const e=Wn(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Gi(Ss.comparator);return s.filters.forEach((u=>{u.getFlattenedFilters().forEach((l=>{l.isInequality()&&(a=a.add(l.field))}))})),a})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new D0(o,r))})),t.has(Ss.keyField().canonicalString())||e.Ie.push(new D0(Ss.keyField(),r))}return e.Ie}function dl(n){const e=Wn(n);return e.Ee||(e.Ee=gY(e,fm(n))),e.Ee}function gY(n,e){if(n.limitType==="F")return h4(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new D0(i.field,o)}));const t=n.endAt?new P0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new P0(n.startAt.position,n.startAt.inclusive):null;return h4(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Yw(n,e,t){return new v1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function y1(n,e){return c_(dl(n),dl(e))&&n.limitType===e.limitType}function ZR(n){return`${l_(dl(n))}|lt:${n.limitType}`}function cd(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>QR(i))).join(", ")}]`),m1(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Qd(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Qd(i))).join(",")),`Target(${r})`})(dl(n))}; limitType=${n.limitType})`}function w1(n,e){return e.isFoundDocument()&&(function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):hn.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(const o of fm(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(s,a,u){const l=l4(s,a,u);return s.inclusive?l<=0:l<0})(r.startAt,fm(r),i)||r.endAt&&!(function(s,a,u){const l=l4(s,a,u);return s.inclusive?l>=0:l>0})(r.endAt,fm(r),i))})(n,e)}function vY(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function eP(n){return(e,t)=>{let r=!1;for(const i of fm(n)){const o=yY(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function yY(n,e,t){const r=n.field.isKeyField()?hn.comparator(e.key,t.key):(function(o,s,a){const u=s.data.field(o),l=a.data.field(o);return u!==null&&l!==null?Yd(u,l):_n(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return _n(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){sg(this.inner,((t,r)=>{for(const[i,o]of r)e(i,o)}))}isEmpty(){return YX(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wY=new _i(hn.comparator);function gh(){return wY}const tP=new _i(hn.comparator);function Qp(...n){let e=tP;for(const t of n)e=e.insert(t.key,t);return e}function bY(n){let e=tP;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function nf(){return dm()}function nP(){return dm()}function dm(){return new If((n=>n.toString()),((n,e)=>n.isEqual(e)))}const xY=new Gi(hn.comparator);function Kn(...n){let e=xY;for(const t of n)e=e.add(t);return e}const _Y=new Gi(Vn);function EY(){return _Y}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SY(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qw(e)?"-0":e}}function AY(n){return{integerValue:""+n}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this._=void 0}}function CY(n,e,t){return n instanceof Qw?(function(i,o){const s={fields:{[qR]:{stringValue:WR},[GR]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&a_(o)&&(o=g1(o)),o&&(s.fields[HR]=o),{mapValue:s}})(t,e):n instanceof L0?rP(n,e):n instanceof M0?iP(n,e):(function(i,o){const s=TY(i,o),a=d4(s)+d4(i.Ae);return $w(s)&&$w(i.Ae)?AY(a):SY(i.serializer,a)})(n,e)}function IY(n,e,t){return n instanceof L0?rP(n,e):n instanceof M0?iP(n,e):t}function TY(n,e){return n instanceof Jw?(function(r){return $w(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}class Qw extends b1{}class L0 extends b1{constructor(e){super(),this.elements=e}}function rP(n,e){const t=oP(e);for(const r of n.elements)t.some((i=>ml(i,r)))||t.push(r);return{arrayValue:{values:t}}}class M0 extends b1{constructor(e){super(),this.elements=e}}function iP(n,e){let t=oP(e);for(const r of n.elements)t=t.filter((i=>!ml(i,r)));return{arrayValue:{values:t}}}class Jw extends b1{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function d4(n){return vi(n.integerValue||n.doubleValue)}function oP(n){return u_(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function kY(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof L0&&i instanceof L0||r instanceof M0&&i instanceof M0?Xd(r.elements,i.elements,ml):r instanceof Jw&&i instanceof Jw?ml(r.Ae,i.Ae):r instanceof Qw&&i instanceof Qw})(n.transform,e.transform)}class uf{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new uf}static exists(e){return new uf(void 0,e)}static updateTime(e){return new uf(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Uv(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class f_{}function sP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new RY(n.key,uf.none()):new d_(n.key,n.data,uf.none());{const t=n.data,r=nl.empty();let i=new Gi(Ss.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new x1(n.key,r,new Kc(i.toArray()),uf.none())}}function NY(n,e,t){n instanceof d_?(function(i,o,s){const a=i.value.clone(),u=m4(i.fieldTransforms,o,s.transformResults);a.setAll(u),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof x1?(function(i,o,s){if(!Uv(i.precondition,o))return void o.convertToUnknownDocument(s.version);const a=m4(i.fieldTransforms,o,s.transformResults),u=o.data;u.setAll(aP(i)),u.setAll(a),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()})(n,e,t):(function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function pm(n,e,t,r){return n instanceof d_?(function(o,s,a,u){if(!Uv(o.precondition,s))return a;const l=o.value.clone(),h=g4(o.fieldTransforms,u,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null})(n,e,t,r):n instanceof x1?(function(o,s,a,u){if(!Uv(o.precondition,s))return a;const l=g4(o.fieldTransforms,u,s),h=s.data;return h.setAll(aP(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((d=>d.field)))})(n,e,t,r):(function(o,s,a){return Uv(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function p4(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Xd(r,i,((o,s)=>kY(o,s)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class d_ extends f_{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class x1 extends f_{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function aP(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function m4(n,e,t){const r=new Map;Qr(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,IY(s,a,t[i]))}return r}function g4(n,e,t){const r=new Map;for(const i of n){const o=i.transform,s=t.data.field(i.field);r.set(i.field,CY(o,s,e))}return r}class RY extends f_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PY{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&NY(o,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=pm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=pm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=nP();return this.mutations.forEach((i=>{const o=e.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;const u=sP(s,a);u!==null&&r.set(i.key,u),s.isValidDocument()||s.convertToNoDocument(xn.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Kn())}isEqual(e){return this.batchId===e.batchId&&Xd(this.mutations,e.mutations,((t,r)=>p4(t,r)))&&Xd(this.baseMutations,e.baseMutations,((t,r)=>p4(t,r)))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DY{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LY{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ri,Un;function uP(n){if(n===void 0)return nc("GRPC error has no .code"),ht.UNKNOWN;switch(n){case Ri.OK:return ht.OK;case Ri.CANCELLED:return ht.CANCELLED;case Ri.UNKNOWN:return ht.UNKNOWN;case Ri.DEADLINE_EXCEEDED:return ht.DEADLINE_EXCEEDED;case Ri.RESOURCE_EXHAUSTED:return ht.RESOURCE_EXHAUSTED;case Ri.INTERNAL:return ht.INTERNAL;case Ri.UNAVAILABLE:return ht.UNAVAILABLE;case Ri.UNAUTHENTICATED:return ht.UNAUTHENTICATED;case Ri.INVALID_ARGUMENT:return ht.INVALID_ARGUMENT;case Ri.NOT_FOUND:return ht.NOT_FOUND;case Ri.ALREADY_EXISTS:return ht.ALREADY_EXISTS;case Ri.PERMISSION_DENIED:return ht.PERMISSION_DENIED;case Ri.FAILED_PRECONDITION:return ht.FAILED_PRECONDITION;case Ri.ABORTED:return ht.ABORTED;case Ri.OUT_OF_RANGE:return ht.OUT_OF_RANGE;case Ri.UNIMPLEMENTED:return ht.UNIMPLEMENTED;case Ri.DATA_LOSS:return ht.DATA_LOSS;default:return _n(39323,{code:n})}}(Un=Ri||(Ri={}))[Un.OK=0]="OK",Un[Un.CANCELLED=1]="CANCELLED",Un[Un.UNKNOWN=2]="UNKNOWN",Un[Un.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Un[Un.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Un[Un.NOT_FOUND=5]="NOT_FOUND",Un[Un.ALREADY_EXISTS=6]="ALREADY_EXISTS",Un[Un.PERMISSION_DENIED=7]="PERMISSION_DENIED",Un[Un.UNAUTHENTICATED=16]="UNAUTHENTICATED",Un[Un.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Un[Un.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Un[Un.ABORTED=10]="ABORTED",Un[Un.OUT_OF_RANGE=11]="OUT_OF_RANGE",Un[Un.UNIMPLEMENTED=12]="UNIMPLEMENTED",Un[Un.INTERNAL=13]="INTERNAL",Un[Un.UNAVAILABLE=14]="UNAVAILABLE",Un[Un.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MY(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OY=new rh([4294967295,4294967295],0);function v4(n){const e=MY().encode(n),t=new PR;return t.update(e),new Uint8Array(t.digest())}function y4(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new rh([t,r],0),new rh([i,o],0)]}class p_{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Jp(`Invalid padding: ${t}`);if(r<0)throw new Jp(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Jp(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Jp(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=rh.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(rh.fromNumber(r)));return i.compare(OY)===1&&(i=new rh([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=v4(e),[r,i]=y4(t);for(let o=0;o<this.hashCount;o++){const s=this.ye(r,i,o);if(!this.we(s))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new p_(o,i,t);return r.forEach((a=>s.insert(a))),s}insert(e){if(this.ge===0)return;const t=v4(e),[r,i]=y4(t);for(let o=0;o<this.hashCount;o++){const s=this.ye(r,i,o);this.Se(s)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Jp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,ag.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new _1(xn.min(),i,new _i(Vn),gh(),Kn())}}class ag{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new ag(r,t,Kn(),Kn(),Kn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class lP{constructor(e,t){this.targetId=e,this.Ce=t}}class cP{constructor(e,t,r=Lo.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class w4{constructor(){this.ve=0,this.Fe=b4(),this.Me=Lo.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Kn(),t=Kn(),r=Kn();return this.Fe.forEach(((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:_n(38017,{changeType:o})}})),new ag(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=b4()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Qr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class FY{constructor(e){this.Ge=e,this.ze=new Map,this.je=gh(),this.Je=_v(),this.He=_v(),this.Ye=new _i(Vn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:_n(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const o=i.target;if(Xw(o))if(r===0){const s=new hn(o.path);this.et(t,s,is.newNoDocument(s,xn.min()))}else Qr(r===1,20013,{expectedCount:r});else{const s=this._t(t);if(s!==r){const a=this.ut(e),u=a?this.ct(a,e,s):1;if(u!==0){this.it(t);const l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,l)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t;let s,a;try{s=ph(r).toUint8Array()}catch(u){if(u instanceof zR)return Kd("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new p_(s,i,o)}catch(u){return Kd(u instanceof Jp?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((o=>{const s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(t,o,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((o,s)=>{const a=this.ot(s);if(a){if(o.current&&Xw(a.target)){const u=new hn(a.target.path);this.It(u).has(s)||this.Et(s,u)||this.et(s,u,is.newNoDocument(u,e))}o.Be&&(t.set(s,o.ke()),o.qe())}}));let r=Kn();this.He.forEach(((o,s)=>{let a=!0;s.forEachWhile((u=>{const l=this.ot(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(r=r.add(o))})),this.je.forEach(((o,s)=>s.setReadTime(e)));const i=new _1(e,t,this.Ye,this.je,r);return this.je=gh(),this.Je=_v(),this.He=_v(),this.Ye=new _i(Vn),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new w4,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Gi(Vn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Gi(Vn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||St("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new w4),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function _v(){return new _i(hn.comparator)}function b4(){return new _i(hn.comparator)}const BY={asc:"ASCENDING",desc:"DESCENDING"},VY={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jY={and:"AND",or:"OR"};class UY{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Zw(n,e){return n.useProto3Json||m1(e)?e:{value:e}}function zY(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function WY(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Md(n){return Qr(!!n,49232),xn.fromTimestamp((function(t){const r=dh(t);return new Pi(r.seconds,r.nanos)})(n))}function qY(n,e){return eb(n,e).canonicalString()}function eb(n,e){const t=(function(i){return new Kr(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function hP(n){const e=Kr.fromString(n);return Qr(gP(e),10190,{key:e.toString()}),e}function D2(n,e){const t=hP(e);if(t.get(1)!==n.databaseId.projectId)throw new Yt(ht.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Yt(ht.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new hn(dP(t))}function fP(n,e){return qY(n.databaseId,e)}function HY(n){const e=hP(n);return e.length===4?Kr.emptyPath():dP(e)}function x4(n){return new Kr(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function dP(n){return Qr(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function GY(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:_n(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(l,h){return l.useProto3Json?(Qr(h===void 0||typeof h=="string",58123),Lo.fromBase64String(h||"")):(Qr(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Lo.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(l){const h=l.code===void 0?ht.UNKNOWN:uP(l.code);return new Yt(h,l.message||"")})(s);t=new cP(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=D2(n,r.document.name),o=Md(r.document.updateTime),s=r.document.createTime?Md(r.document.createTime):xn.min(),a=new nl({mapValue:{fields:r.document.fields}}),u=is.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new zv(l,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=D2(n,r.document),o=r.readTime?Md(r.readTime):xn.min(),s=is.newNoDocument(i,o),a=r.removedTargetIds||[];t=new zv([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=D2(n,r.document),o=r.removedTargetIds||[];t=new zv([],o,i,null)}else{if(!("filter"in e))return _n(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,s=new LY(i,o),a=r.targetId;t=new lP(a,s)}}return t}function $Y(n,e){return{documents:[fP(n,e.path)]}}function KY(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=fP(n,i);const o=(function(l){if(l.length!==0)return mP(gl.create(l,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const s=(function(l){if(l.length!==0)return l.map((h=>(function(m){return{field:hd(m.field),direction:QY(m.dir)}})(h)))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=Zw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{ft:t,parent:i}}function XY(n){let e=HY(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Qr(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=(function(d){const m=pP(d);return m instanceof gl&&XR(m)?m.getFilters():[m]})(t.where));let s=[];t.orderBy&&(s=(function(d){return d.map((m=>(function(y){return new D0(fd(y.field),(function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(m)))})(t.orderBy));let a=null;t.limit&&(a=(function(d){let m;return m=typeof d=="object"?d.value:d,m1(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(d){const m=!!d.before,p=d.values||[];return new P0(p,m)})(t.startAt));let l=null;return t.endAt&&(l=(function(d){const m=!d.before,p=d.values||[];return new P0(p,m)})(t.endAt)),pY(e,i,s,o,a,"F",u,l)}function YY(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _n(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function pP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=fd(t.unaryFilter.field);return Wi.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=fd(t.unaryFilter.field);return Wi.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=fd(t.unaryFilter.field);return Wi.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=fd(t.unaryFilter.field);return Wi.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _n(61313);default:return _n(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Wi.create(fd(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _n(58110);default:return _n(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return gl.create(t.compositeFilter.filters.map((r=>pP(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return _n(1026)}})(t.compositeFilter.op))})(n):_n(30097,{filter:n})}function QY(n){return BY[n]}function JY(n){return VY[n]}function ZY(n){return jY[n]}function hd(n){return{fieldPath:n.canonicalString()}}function fd(n){return Ss.fromServerFormat(n.fieldPath)}function mP(n){return n instanceof Wi?(function(t){if(t.op==="=="){if(u4(t.value))return{unaryFilter:{field:hd(t.field),op:"IS_NAN"}};if(a4(t.value))return{unaryFilter:{field:hd(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(u4(t.value))return{unaryFilter:{field:hd(t.field),op:"IS_NOT_NAN"}};if(a4(t.value))return{unaryFilter:{field:hd(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hd(t.field),op:JY(t.op),value:t.value}}})(n):n instanceof gl?(function(t){const r=t.getFilters().map((i=>mP(i)));return r.length===1?r[0]:{compositeFilter:{op:ZY(t.op),filters:r}}})(n):_n(54877,{filter:n})}function gP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,t,r,i,o=xn.min(),s=xn.min(),a=Lo.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Xc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Xc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eQ{constructor(e){this.yt=e}}function tQ(n){const e=XY({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Yw(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nQ{constructor(){this.Cn=new rQ}addToCollectionParentIndex(e,t){return this.Cn.add(t),tt.resolve()}getCollectionParents(e,t){return tt.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return tt.resolve()}deleteFieldIndex(e,t){return tt.resolve()}deleteAllFieldIndexes(e){return tt.resolve()}createTargetIndexes(e,t){return tt.resolve()}getDocumentsMatchingTarget(e,t){return tt.resolve(null)}getIndexType(e,t){return tt.resolve(0)}getFieldIndexes(e,t){return tt.resolve([])}getNextCollectionGroupToUpdate(e){return tt.resolve(null)}getMinOffset(e,t){return tt.resolve(fh.min())}getMinOffsetFromCollectionGroup(e,t){return tt.resolve(fh.min())}updateCollectionGroup(e,t,r){return tt.resolve()}updateIndexEntries(e,t){return tt.resolve()}}class rQ{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Gi(Kr.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Gi(Kr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vP=41943040;class Us{static withCacheSize(e){return new Us(e,Us.DEFAULT_COLLECTION_PERCENTILE,Us.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Us.DEFAULT_COLLECTION_PERCENTILE=10,Us.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Us.DEFAULT=new Us(vP,Us.DEFAULT_COLLECTION_PERCENTILE,Us.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Us.DISABLED=new Us(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Jd(0)}static cr(){return new Jd(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4="LruGarbageCollector",iQ=1048576;function S4([n,e],[t,r]){const i=Vn(n,t);return i===0?Vn(e,r):i}class oQ{constructor(e){this.Ir=e,this.buffer=new Gi(S4),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();S4(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class sQ{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){St(E4,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hp(t)?St(E4,"Ignoring IndexedDB error during garbage collection: ",t):await d1(t)}await this.Vr(3e5)}))}}class aQ{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return tt.resolve(p1.ce);const r=new oQ(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(St("LruGarbageCollector","Garbage collection skipped; disabled"),tt.resolve(_4)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(St("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_4):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,o,s,a,u,l;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(St("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,s=Date.now(),this.nthSequenceNumber(e,i)))).next((d=>(r=d,a=Date.now(),this.removeTargets(e,r,t)))).next((d=>(o=d,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((d=>(l=Date.now(),ld()<=Fn.DEBUG&&St("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(l-u)+`ms
Total Duration: ${l-h}ms`),tt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:d}))))}}function uQ(n,e){return new aQ(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lQ{constructor(){this.changes=new If((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,is.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?tt.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cQ{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hQ{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&pm(r.mutation,i,Kc.empty(),Pi.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Kn()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Kn()){const i=nf();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((o=>{let s=Qp();return o.forEach(((a,u)=>{s=s.insert(a,u.overlayedDocument)})),s}))))}getOverlayedDocuments(e,t){const r=nf();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Kn())))}populateOverlays(e,t,r){const i=[];return r.forEach((o=>{t.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(e,i).next((o=>{o.forEach(((s,a)=>{t.set(s,a)}))}))}computeViews(e,t,r,i){let o=gh();const s=dm(),a=(function(){return dm()})();return t.forEach(((u,l)=>{const h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof x1)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),pm(h.mutation,l,h.mutation.getFieldMask(),Pi.now())):s.set(l.key,Kc.empty())})),this.recalculateAndSaveOverlays(e,o).next((u=>(u.forEach(((l,h)=>s.set(l,h))),t.forEach(((l,h)=>a.set(l,new cQ(h,s.get(l)??null)))),a)))}recalculateAndSaveOverlays(e,t){const r=dm();let i=new _i(((s,a)=>s-a)),o=Kn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((s=>{for(const a of s)a.keys().forEach((u=>{const l=t.get(u);if(l===null)return;let h=r.get(u)||Kc.empty();h=a.applyToLocalView(l,h),r.set(u,h);const d=(i.get(a.batchId)||Kn()).add(u);i=i.insert(a.batchId,d)}))})).next((()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),l=u.key,h=u.value,d=nP();h.forEach((m=>{if(!o.has(m)){const p=sP(t.get(m),r.get(m));p!==null&&d.set(m,p),o=o.add(m)}})),s.push(this.documentOverlayCache.saveOverlays(e,l,d))}return tt.waitFor(s)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(s){return hn.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mY(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):tt.resolve(nf());let a=Lm,u=o;return s.next((l=>tt.forEach(l,((h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),o.get(h)?tt.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,l,o))).next((()=>this.computeViews(e,u,l,Kn()))).next((h=>({batchId:a,changes:bY(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new hn(t)).next((r=>{let i=Qp();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const o=t.collectionGroup;let s=Qp();return this.indexManager.getCollectionParents(e,o).next((a=>tt.forEach(a,(u=>{const l=(function(d,m){return new v1(m,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(t,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next((h=>{h.forEach(((d,m)=>{s=s.insert(d,m)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i)))).next((s=>{o.forEach(((u,l)=>{const h=l.getKey();s.get(h)===null&&(s=s.insert(h,is.newInvalidDocument(h)))}));let a=Qp();return s.forEach(((u,l)=>{const h=o.get(u);h!==void 0&&pm(h.mutation,l,Kc.empty(),Pi.now()),w1(t,l)&&(a=a.insert(u,l))})),a}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fQ{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return tt.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Md(i.createTime)}})(t)),tt.resolve()}getNamedQuery(e,t){return tt.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:tQ(i.bundledQuery),readTime:Md(i.readTime)}})(t)),tt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dQ{constructor(){this.overlays=new _i(hn.comparator),this.qr=new Map}getOverlay(e,t){return tt.resolve(this.overlays.get(t))}getOverlays(e,t){const r=nf();return tt.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&r.set(i,o)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,o)=>{this.St(e,t,o)})),tt.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(r)),tt.resolve()}getOverlaysForCollection(e,t,r){const i=nf(),o=t.length+1,s=new hn(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&u.largestBatchId>r&&i.set(u.getKey(),u)}return tt.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new _i(((l,h)=>l-h));const s=this.overlays.getIterator();for(;s.hasNext();){const l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=nf(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const a=nf(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((l,h)=>a.set(l,h))),!(a.size()>=i)););return tt.resolve(a)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new DY(t,r));let o=this.qr.get(t);o===void 0&&(o=Kn(),this.qr.set(t,o)),this.qr.set(t,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pQ{constructor(){this.sessionToken=Lo.EMPTY_BYTE_STRING}getSessionToken(e){return tt.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,tt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(){this.Qr=new Gi(ho.$r),this.Ur=new Gi(ho.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new ho(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new ho(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new hn(new Kr([])),r=new ho(t,e),i=new ho(t,e+1),o=[];return this.Ur.forEachInRange([r,i],(s=>{this.Gr(s),o.push(s.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new hn(new Kr([])),r=new ho(t,e),i=new ho(t,e+1);let o=Kn();return this.Ur.forEachInRange([r,i],(s=>{o=o.add(s.key)})),o}containsKey(e){const t=new ho(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ho{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return hn.comparator(e.key,t.key)||Vn(e.Yr,t.Yr)}static Kr(e,t){return Vn(e.Yr,t.Yr)||hn.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mQ{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Gi(ho.$r)}checkEmpty(e){return tt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new PY(o,t,r,i);this.mutationQueue.push(s);for(const a of i)this.Zr=this.Zr.add(new ho(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return tt.resolve(s)}lookupMutationBatch(e,t){return tt.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),o=i<0?0:i;return tt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return tt.resolve(this.mutationQueue.length===0?$X:this.tr-1)}getAllMutationBatches(e){return tt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ho(t,0),i=new ho(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,i],(s=>{const a=this.Xr(s.Yr);o.push(a)})),tt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Gi(Vn);return t.forEach((i=>{const o=new ho(i,0),s=new ho(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,s],(a=>{r=r.add(a.Yr)}))})),tt.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let o=r;hn.isDocumentKey(o)||(o=o.child(""));const s=new ho(new hn(o),0);let a=new Gi(Vn);return this.Zr.forEachWhile((u=>{const l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.Yr)),!0)}),s),tt.resolve(this.ti(a))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Qr(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return tt.forEach(t.mutations,(i=>{const o=new ho(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new ho(t,0),i=this.Zr.firstAfterOrEqual(r);return tt.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,tt.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gQ{constructor(e){this.ri=e,this.docs=(function(){return new _i(hn.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return tt.resolve(r?r.document.mutableCopy():is.newInvalidDocument(t))}getEntries(e,t){let r=gh();return t.forEach((i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():is.newInvalidDocument(i))})),tt.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=gh();const s=t.path,a=new hn(s.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:l,value:{document:h}}=u.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||WX(zX(h),r)<=0||(i.has(h.key)||w1(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return tt.resolve(o)}getAllFromCollectionGroup(e,t,r,i){_n(9500)}ii(e,t){return tt.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new vQ(this)}getSize(e){return tt.resolve(this.size)}}class vQ extends lQ{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),tt.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yQ{constructor(e){this.persistence=e,this.si=new If((t=>l_(t)),c_),this.lastRemoteSnapshotVersion=xn.min(),this.highestTargetId=0,this.oi=0,this._i=new m_,this.targetCount=0,this.ai=Jd.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),tt.resolve()}getLastRemoteSnapshotVersion(e){return tt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return tt.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),tt.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),tt.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Jd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,tt.resolve()}updateTargetData(e,t){return this.Pr(t),tt.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,tt.resolve()}removeTargets(e,t,r){let i=0;const o=[];return this.si.forEach(((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.si.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)})),tt.waitFor(o).next((()=>i))}getTargetCount(e){return tt.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return tt.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),tt.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach((s=>{o.push(i.markPotentiallyOrphaned(e,s))})),tt.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),tt.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return tt.resolve(r)}containsKey(e,t){return tt.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e,t){this.ui={},this.overlays={},this.ci=new p1(0),this.li=!1,this.li=!0,this.hi=new pQ,this.referenceDelegate=e(this),this.Pi=new yQ(this),this.indexManager=new nQ,this.remoteDocumentCache=(function(i){return new gQ(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new eQ(t),this.Ii=new fQ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new dQ,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new mQ(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){St("MemoryPersistence","Starting transaction:",e);const i=new wQ(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((o=>this.referenceDelegate.di(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ai(e,t){return tt.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class wQ extends HX{constructor(e){super(),this.currentSequenceNumber=e}}class g_{constructor(e){this.persistence=e,this.Ri=new m_,this.Vi=null}static mi(e){return new g_(e)}get fi(){if(this.Vi)return this.Vi;throw _n(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),tt.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),tt.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),tt.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((o=>this.fi.add(o.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return tt.forEach(this.fi,(r=>{const i=hn.fromPath(r);return this.gi(e,i).next((o=>{o||t.removeEntry(i,xn.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return tt.or([()=>tt.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class O0{constructor(e,t){this.persistence=e,this.pi=new If((r=>KX(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=uQ(this,t)}static mi(e,t){return new O0(e,t)}Ei(){}di(e){return tt.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return tt.forEach(this.pi,((r,i)=>this.br(e,r,i).next((o=>o?tt.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,(s=>this.br(e,s,t).next((a=>{a||(r++,o.removeEntry(s,xn.min()))})))).next((()=>o.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),tt.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),tt.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),tt.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),tt.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=jv(e.data.value)),t}br(e,t,r){return tt.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return tt.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=Kn(),i=Kn();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new v_(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bQ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xQ{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return $H()?8:GX(ls())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const o={result:null};return this.ys(e,t).next((s=>{o.result=s})).next((()=>{if(!o.result)return this.ws(e,t,i,r).next((s=>{o.result=s}))})).next((()=>{if(o.result)return;const s=new bQ;return this.Ss(e,t,s).next((a=>{if(o.result=a,this.Vs)return this.bs(e,t,s,a.size)}))})).next((()=>o.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(ld()<=Fn.DEBUG&&St("QueryEngine","SDK will not create cache indexes for query:",cd(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),tt.resolve()):(ld()<=Fn.DEBUG&&St("QueryEngine","Query:",cd(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(ld()<=Fn.DEBUG&&St("QueryEngine","The SDK decides to create cache indexes for query:",cd(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dl(t))):tt.resolve())}ys(e,t){if(f4(t))return tt.resolve(null);let r=dl(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Yw(t,null,"F"),r=dl(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((o=>{const s=Kn(...o);return this.ps.getDocuments(e,s).next((a=>this.indexManager.getMinOffset(e,r).next((u=>{const l=this.Ds(t,a);return this.Cs(t,l,s,u.readTime)?this.ys(e,Yw(t,null,"F")):this.vs(e,l,t,u)}))))})))))}ws(e,t,r,i){return f4(t)||i.isEqual(xn.min())?tt.resolve(null):this.ps.getDocuments(e,r).next((o=>{const s=this.Ds(t,o);return this.Cs(t,s,r,i)?tt.resolve(null):(ld()<=Fn.DEBUG&&St("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),cd(t)),this.vs(e,s,t,UX(i,Lm)).next((a=>a)))}))}Ds(e,t){let r=new Gi(eP(e));return t.forEach(((i,o)=>{w1(e,o)&&(r=r.add(o))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,t,r){return ld()<=Fn.DEBUG&&St("QueryEngine","Using full collection scan to execute query:",cd(t)),this.ps.getDocumentsMatchingQuery(e,t,fh.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((o=>(t.forEach((s=>{o=o.insert(s.key,s)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y_="LocalStore",_Q=3e8;class EQ{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new _i(Vn),this.xs=new If((o=>l_(o)),c_),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hQ(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function SQ(n,e,t,r){return new EQ(n,e,t,r)}async function wP(n,e){const t=Wn(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((o=>(i=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((o=>{const s=[],a=[];let u=Kn();for(const l of i){s.push(l.batchId);for(const h of l.mutations)u=u.add(h.key)}for(const l of o){a.push(l.batchId);for(const h of l.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((l=>({Ls:l,removedBatchIds:s,addedBatchIds:a})))}))}))}function bP(n){const e=Wn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function AQ(n,e){const t=Wn(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const s=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const a=[];e.targetChanges.forEach(((h,d)=>{const m=i.get(d);if(!m)return;a.push(t.Pi.removeMatchingKeys(o,h.removedDocuments,d).next((()=>t.Pi.addMatchingKeys(o,h.addedDocuments,d))));let p=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(Lo.EMPTY_BYTE_STRING,xn.min()).withLastLimboFreeSnapshotVersion(xn.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,r)),i=i.insert(d,p),(function(b,x,E){return b.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=_Q?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0})(m,p,h)&&a.push(t.Pi.updateTargetData(o,p))}));let u=gh(),l=Kn();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))})),a.push(CQ(o,s,e.documentUpdates).next((h=>{u=h.ks,l=h.qs}))),!r.isEqual(xn.min())){const h=t.Pi.getLastRemoteSnapshotVersion(o).next((d=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r)));a.push(h)}return tt.waitFor(a).next((()=>s.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,u,l))).next((()=>u))})).then((o=>(t.Ms=i,o)))}function CQ(n,e,t){let r=Kn(),i=Kn();return t.forEach((o=>r=r.add(o))),e.getEntries(n,r).next((o=>{let s=gh();return t.forEach(((a,u)=>{const l=o.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(xn.min())?(e.removeEntry(a,u.readTime),s=s.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),s=s.insert(a,u)):St(y_,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)})),{ks:s,qs:i}}))}function IQ(n,e){const t=Wn(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((o=>o?(i=o,tt.resolve(i)):t.Pi.allocateTargetId(r).next((s=>(i=new Xc(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function tb(n,e,t){const r=Wn(n),i=r.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,(s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!hp(s))throw s;St(y_,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function A4(n,e,t){const r=Wn(n);let i=xn.min(),o=Kn();return r.persistence.runTransaction("Execute query","readwrite",(s=>(function(u,l,h){const d=Wn(u),m=d.xs.get(h);return m!==void 0?tt.resolve(d.Ms.get(m)):d.Pi.getTargetData(l,h)})(r,s,dl(e)).next((a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(s,a.targetId).next((u=>{o=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(s,e,t?i:xn.min(),t?o:Kn()))).next((a=>(TQ(r,vY(e),a),{documents:a,Qs:o})))))}function TQ(n,e,t){let r=n.Os.get(e)||xn.min();t.forEach(((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),n.Os.set(e,r)}class C4{constructor(){this.activeTargetIds=EY()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class kQ{constructor(){this.Mo=new C4,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new C4,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NQ{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4="ConnectivityMonitor";class T4{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){St(I4,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){St(I4,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ev=null;function nb(){return Ev===null?Ev=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ev++,"0x"+Ev.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2="RestConnection",RQ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class PQ{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===R0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,o){const s=nb(),a=this.zo(e,t.toUriEncodedString());St(L2,`Sending RPC '${e}' ${s}:`,a,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,o);const{host:l}=new URL(a),h=sp(l);return this.Jo(e,a,u,r,h).then((d=>(St(L2,`Received RPC '${e}' ${s}: `,d),d)),(d=>{throw Kd(L2,`RPC '${e}' ${s} failed with error: `,d,"url: ",a,"request:",r),d}))}Ho(e,t,r,i,o,s){return this.Go(e,t,r,i,o)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+cp})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,o)=>e[o]=i)),r&&r.headers.forEach(((i,o)=>e[o]=i))}zo(e,t){const r=RQ[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DQ{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo="WebChannelConnection";class LQ extends PQ{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,o){const s=nb();return new Promise(((a,u)=>{const l=new DR;l.setWithCredentials(!0),l.listenOnce(LR.COMPLETE,(()=>{try{switch(l.getLastErrorCode()){case Bv.NO_ERROR:const d=l.getResponseJson();St(Zo,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),a(d);break;case Bv.TIMEOUT:St(Zo,`RPC '${e}' ${s} timed out`),u(new Yt(ht.DEADLINE_EXCEEDED,"Request time out"));break;case Bv.HTTP_ERROR:const m=l.getStatus();if(St(Zo,`RPC '${e}' ${s} failed with status:`,m,"response text:",l.getResponseText()),m>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const y=p==null?void 0:p.error;if(y&&y.status&&y.message){const b=(function(E){const T=E.toLowerCase().replace(/_/g,"-");return Object.values(ht).indexOf(T)>=0?T:ht.UNKNOWN})(y.status);u(new Yt(b,y.message))}else u(new Yt(ht.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new Yt(ht.UNAVAILABLE,"Connection failed."));break;default:_n(9055,{l_:e,streamId:s,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{St(Zo,`RPC '${e}' ${s} completed.`)}}));const h=JSON.stringify(i);St(Zo,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=nb(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=FR(),a=OR(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=o.join("");St(Zo,`Creating RPC '${e}' stream ${i}: ${h}`,u);const d=s.createWebChannel(h,u);this.I_(d);let m=!1,p=!1;const y=new DQ({Yo:x=>{p?St(Zo,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(m||(St(Zo,`Opening RPC '${e}' stream ${i} transport.`),d.open(),m=!0),St(Zo,`RPC '${e}' stream ${i} sending:`,x),d.send(x))},Zo:()=>d.close()}),b=(x,E,T)=>{x.listen(E,(P=>{try{T(P)}catch(I){setTimeout((()=>{throw I}),0)}}))};return b(d,Yp.EventType.OPEN,(()=>{p||(St(Zo,`RPC '${e}' stream ${i} transport opened.`),y.o_())})),b(d,Yp.EventType.CLOSE,(()=>{p||(p=!0,St(Zo,`RPC '${e}' stream ${i} transport closed`),y.a_(),this.E_(d))})),b(d,Yp.EventType.ERROR,(x=>{p||(p=!0,Kd(Zo,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),y.a_(new Yt(ht.UNAVAILABLE,"The operation could not be completed")))})),b(d,Yp.EventType.MESSAGE,(x=>{var E;if(!p){const T=x.data[0];Qr(!!T,16349);const P=T,I=(P==null?void 0:P.error)||((E=P[0])==null?void 0:E.error);if(I){St(Zo,`RPC '${e}' stream ${i} received error:`,I);const D=I.status;let U=(function(A){const M=Ri[A];if(M!==void 0)return uP(M)})(D),L=I.message;U===void 0&&(U=ht.INTERNAL,L="Unknown error status: "+D+" with message "+I.message),p=!0,y.a_(new Yt(U,L)),d.close()}else St(Zo,`RPC '${e}' stream ${i} received:`,T),y.u_(T)}})),b(a,MR.STAT_EVENT,(x=>{x.stat===zw.PROXY?St(Zo,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===zw.NOPROXY&&St(Zo,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function M2(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xP(n){return new UY(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&St("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4="PersistentStream";class MQ{constructor(e,t,r,i,o,s,a,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _P(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ht.RESOURCE_EXHAUSTED?(nc(t.toString()),nc("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ht.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Yt(ht.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return St(k4,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(St(k4,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class OQ extends MQ{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=GY(this.serializer,e),r=(function(o){if(!("targetChange"in o))return xn.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?xn.min():s.readTime?Md(s.readTime):xn.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=x4(this.serializer),t.addTarget=(function(o,s){let a;const u=s.target;if(a=Xw(u)?{documents:$Y(o,u)}:{query:KY(o,u).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=WY(o,s.resumeToken);const l=Zw(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(xn.min())>0){a.readTime=zY(o,s.snapshotVersion.toTimestamp());const l=Zw(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a})(this.serializer,e);const r=YY(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=x4(this.serializer),t.removeTarget=e,this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FQ{}class BQ extends FQ{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Yt(ht.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,s])=>this.connection.Go(e,eb(t,r),i,o,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ht.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Yt(ht.UNKNOWN,o.toString())}))}Ho(e,t,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Ho(e,eb(t,r),i,s,a,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ht.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Yt(ht.UNKNOWN,s.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class VQ{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(nc(t),this.aa=!1):St("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd="RemoteStore";class jQ{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((s=>{r.enqueueAndForget((async()=>{lg(this)&&(St(Zd,"Restarting streams for network reachability change."),await(async function(u){const l=Wn(u);l.Ea.add(4),await ug(l),l.Ra.set("Unknown"),l.Ea.delete(4),await E1(l)})(this))}))})),this.Ra=new VQ(r,i)}}async function E1(n){if(lg(n))for(const e of n.da)await e(!0)}async function ug(n){for(const e of n.da)await e(!1)}function EP(n,e){const t=Wn(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),__(t)?x_(t):fp(t).O_()&&b_(t,e))}function w_(n,e){const t=Wn(n),r=fp(t);t.Ia.delete(e),r.O_()&&SP(t,e),t.Ia.size===0&&(r.O_()?r.L_():lg(t)&&t.Ra.set("Unknown"))}function b_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(xn.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}fp(n).Y_(e)}function SP(n,e){n.Va.Ue(e),fp(n).Z_(e)}function x_(n){n.Va=new FY({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),fp(n).start(),n.Ra.ua()}function __(n){return lg(n)&&!fp(n).x_()&&n.Ia.size>0}function lg(n){return Wn(n).Ea.size===0}function AP(n){n.Va=void 0}async function UQ(n){n.Ra.set("Online")}async function zQ(n){n.Ia.forEach(((e,t)=>{b_(n,e)}))}async function WQ(n,e){AP(n),__(n)?(n.Ra.ha(e),x_(n)):n.Ra.set("Unknown")}async function qQ(n,e,t){if(n.Ra.set("Online"),e instanceof cP&&e.state===2&&e.cause)try{await(async function(i,o){const s=o.cause;for(const a of o.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,s),i.Ia.delete(a),i.Va.removeTarget(a))})(n,e)}catch(r){St(Zd,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await N4(n,r)}else if(e instanceof zv?n.Va.Ze(e):e instanceof lP?n.Va.st(e):n.Va.tt(e),!t.isEqual(xn.min()))try{const r=await bP(n.localStore);t.compareTo(r)>=0&&await(function(o,s){const a=o.Va.Tt(s);return a.targetChanges.forEach(((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const h=o.Ia.get(l);h&&o.Ia.set(l,h.withResumeToken(u.resumeToken,s))}})),a.targetMismatches.forEach(((u,l)=>{const h=o.Ia.get(u);if(!h)return;o.Ia.set(u,h.withResumeToken(Lo.EMPTY_BYTE_STRING,h.snapshotVersion)),SP(o,u);const d=new Xc(h.target,u,l,h.sequenceNumber);b_(o,d)})),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){St(Zd,"Failed to raise snapshot:",r),await N4(n,r)}}async function N4(n,e,t){if(!hp(e))throw e;n.Ea.add(1),await ug(n),n.Ra.set("Offline"),t||(t=()=>bP(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{St(Zd,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await E1(n)}))}async function R4(n,e){const t=Wn(n);t.asyncQueue.verifyOperationInProgress(),St(Zd,"RemoteStore received new credentials");const r=lg(t);t.Ea.add(3),await ug(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await E1(t)}async function HQ(n,e){const t=Wn(n);e?(t.Ea.delete(2),await E1(t)):e||(t.Ea.add(2),await ug(t),t.Ra.set("Unknown"))}function fp(n){return n.ma||(n.ma=(function(t,r,i){const o=Wn(t);return o.sa(),new OQ(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Xo:UQ.bind(null,n),t_:zQ.bind(null,n),r_:WQ.bind(null,n),H_:qQ.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),__(n)?x_(n):n.Ra.set("Unknown")):(await n.ma.stop(),AP(n))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Ld,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((s=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){const s=Date.now()+r,a=new E_(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Yt(ht.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function CP(n,e){if(nc("AsyncQueue",`${e}: ${n}`),hp(n))return new Yt(ht.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{static emptySet(e){return new Od(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||hn.comparator(t.key,r.key):(t,r)=>hn.comparator(t.key,r.key),this.keyedMap=Qp(),this.sortedSet=new _i(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Od)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Od;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(){this.ga=new _i(hn.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):_n(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class ep{constructor(e,t,r,i,o,s,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){const s=[];return t.forEach((a=>{s.push({type:0,doc:a})})),new ep(e,t,Od.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&y1(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GQ{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class $Q{constructor(){this.queries=D4(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Wn(t),o=i.queries;i.queries=D4(),o.forEach(((s,a)=>{for(const u of a.Sa)u.onError(r)}))})(this,new Yt(ht.ABORTED,"Firestore shutting down"))}}function D4(){return new If((n=>ZR(n)),y1)}async function KQ(n,e){const t=Wn(n);let r=3;const i=e.query;let o=t.queries.get(i);o?!o.ba()&&e.Da()&&(r=2):(o=new GQ,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(s){const a=CP(s,`Initialization of query '${cd(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&S_(t)}async function XQ(n,e){const t=Wn(n),r=e.query;let i=3;const o=t.queries.get(r);if(o){const s=o.Sa.indexOf(e);s>=0&&(o.Sa.splice(s,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function YQ(n,e){const t=Wn(n);let r=!1;for(const i of e){const o=i.query,s=t.queries.get(o);if(s){for(const a of s.Sa)a.Fa(i)&&(r=!0);s.wa=i}}r&&S_(t)}function QQ(n,e,t){const r=Wn(n),i=r.queries.get(e);if(i)for(const o of i.Sa)o.onError(t);r.queries.delete(e)}function S_(n){n.Ca.forEach((e=>{e.next()}))}var rb,L4;(L4=rb||(rb={})).Ma="default",L4.Cache="cache";class JQ{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new ep(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ep.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==rb.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e){this.key=e}}class TP{constructor(e){this.key=e}}class ZQ{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Kn(),this.mutatedKeys=Kn(),this.eu=eP(e),this.tu=new Od(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new P4,i=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,d)=>{const m=i.get(h),p=w1(this.query,d)?d:null,y=!!m&&this.mutatedKeys.has(m.key),b=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let x=!1;m&&p?m.data.isEqual(p.data)?y!==b&&(r.track({type:3,doc:p}),x=!0):this.su(m,p)||(r.track({type:2,doc:p}),x=!0,(u&&this.eu(p,u)>0||l&&this.eu(p,l)<0)&&(a=!0)):!m&&p?(r.track({type:0,doc:p}),x=!0):m&&!p&&(r.track({type:1,doc:m}),x=!0,(u||l)&&(a=!0)),x&&(p?(s=s.add(p),o=b?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))})),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{tu:s,iu:r,Cs:a,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort(((h,d)=>(function(p,y){const b=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _n(20277,{Rt:x})}};return b(p)-b(y)})(h.type,d.type)||this.eu(h.doc,d.doc))),this.ou(r),i=i??!1;const a=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,l=u!==this.Za;return this.Za=u,s.length!==0||l?{snapshot:new ep(this.query,e.tu,o,s,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new P4,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Kn(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new TP(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new IP(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Kn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ep.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const A_="SyncEngine";class eJ{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class tJ{constructor(e){this.key=e,this.hu=!1}}class nJ{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new If((a=>ZR(a)),y1),this.Iu=new Map,this.Eu=new Set,this.du=new _i(hn.comparator),this.Au=new Map,this.Ru=new m_,this.Vu={},this.mu=new Map,this.fu=Jd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function rJ(n,e,t=!0){const r=DP(n);let i;const o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await kP(r,e,t,!0),i}async function iJ(n,e){const t=DP(n);await kP(t,e,!0,!1)}async function kP(n,e,t,r){const i=await IQ(n.localStore,dl(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t);let a;return r&&(a=await oJ(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&EP(n.remoteStore,i),a}async function oJ(n,e,t,r,i){n.pu=(d,m,p)=>(async function(b,x,E,T){let P=x.view.ru(E);P.Cs&&(P=await A4(b.localStore,x.query,!1).then((({documents:L})=>x.view.ru(L,P))));const I=T&&T.targetChanges.get(x.targetId),D=T&&T.targetMismatches.get(x.targetId)!=null,U=x.view.applyChanges(P,b.isPrimaryClient,I,D);return O4(b,x.targetId,U.au),U.snapshot})(n,d,m,p);const o=await A4(n.localStore,e,!0),s=new ZQ(e,o.Qs),a=s.ru(o.documents),u=ag.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,u);O4(n,t,l.au);const h=new eJ(e,t,s);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),l.snapshot}async function sJ(n,e,t){const r=Wn(n),i=r.Tu.get(e),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter((s=>!y1(s,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await tb(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&w_(r.remoteStore,i.targetId),ib(r,i.targetId)})).catch(d1)):(ib(r,i.targetId),await tb(r.localStore,i.targetId,!0))}async function aJ(n,e){const t=Wn(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),w_(t.remoteStore,r.targetId))}async function NP(n,e){const t=Wn(n);try{const r=await AQ(t.localStore,e);e.targetChanges.forEach(((i,o)=>{const s=t.Au.get(o);s&&(Qr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Qr(s.hu,14607):i.removedDocuments.size>0&&(Qr(s.hu,42227),s.hu=!1))})),await PP(t,r,e)}catch(r){await d1(r)}}function M4(n,e,t){const r=Wn(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((o,s)=>{const a=s.view.va(e);a.snapshot&&i.push(a.snapshot)})),(function(s,a){const u=Wn(s);u.onlineState=a;let l=!1;u.queries.forEach(((h,d)=>{for(const m of d.Sa)m.va(a)&&(l=!0)})),l&&S_(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function uJ(n,e,t){const r=Wn(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),o=i&&i.key;if(o){let s=new _i(hn.comparator);s=s.insert(o,is.newNoDocument(o,xn.min()));const a=Kn().add(o),u=new _1(xn.min(),new Map,new _i(Vn),s,a);await NP(r,u),r.du=r.du.remove(o),r.Au.delete(e),C_(r)}else await tb(r.localStore,e,!1).then((()=>ib(r,e,t))).catch(d1)}function ib(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||RP(n,r)}))}function RP(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(w_(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),C_(n))}function O4(n,e,t){for(const r of t)r instanceof IP?(n.Ru.addReference(r.key,e),lJ(n,r)):r instanceof TP?(St(A_,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||RP(n,r.key)):_n(19791,{wu:r})}function lJ(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(St(A_,"New document in limbo: "+t),n.Eu.add(r),C_(n))}function C_(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new hn(Kr.fromString(e)),r=n.fu.next();n.Au.set(r,new tJ(t)),n.du=n.du.insert(t,r),EP(n.remoteStore,new Xc(dl(h_(t.path)),r,"TargetPurposeLimboResolution",p1.ce))}}async function PP(n,e,t){const r=Wn(n),i=[],o=[],s=[];r.Tu.isEmpty()||(r.Tu.forEach(((a,u)=>{s.push(r.pu(u,e,t).then((l=>{var h;if((l||t)&&r.isPrimaryClient){const d=l?!l.fromCache:(h=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(l){i.push(l);const d=v_.As(u.targetId,l);o.push(d)}})))})),await Promise.all(s),r.Pu.H_(i),await(async function(u,l){const h=Wn(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>tt.forEach(l,(m=>tt.forEach(m.Es,(p=>h.persistence.referenceDelegate.addReference(d,m.targetId,p))).next((()=>tt.forEach(m.ds,(p=>h.persistence.referenceDelegate.removeReference(d,m.targetId,p)))))))))}catch(d){if(!hp(d))throw d;St(y_,"Failed to update sequence numbers: "+d)}for(const d of l){const m=d.targetId;if(!d.fromCache){const p=h.Ms.get(m),y=p.snapshotVersion,b=p.withLastLimboFreeSnapshotVersion(y);h.Ms=h.Ms.insert(m,b)}}})(r.localStore,o))}async function cJ(n,e){const t=Wn(n);if(!t.currentUser.isEqual(e)){St(A_,"User change. New user:",e.toKey());const r=await wP(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach((a=>{a.forEach((u=>{u.reject(new Yt(ht.CANCELLED,s))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await PP(t,r.Ls)}}function hJ(n,e){const t=Wn(n),r=t.Au.get(e);if(r&&r.hu)return Kn().add(r.key);{let i=Kn();const o=t.Iu.get(e);if(!o)return i;for(const s of o){const a=t.Tu.get(s);i=i.unionWith(a.view.nu)}return i}}function DP(n){const e=Wn(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=NP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hJ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=uJ.bind(null,e),e.Pu.H_=YQ.bind(null,e.eventManager),e.Pu.yu=QQ.bind(null,e.eventManager),e}class F0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xP(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return SQ(this.persistence,new xQ,e.initialUser,this.serializer)}Cu(e){return new yP(g_.mi,this.serializer)}Du(e){return new kQ}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}F0.provider={build:()=>new F0};class fJ extends F0{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Qr(this.persistence.referenceDelegate instanceof O0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new sQ(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Us.withCacheSize(this.cacheSizeBytes):Us.DEFAULT;return new yP((r=>O0.mi(r,t)),this.serializer)}}class ob{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>M4(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=cJ.bind(null,this.syncEngine),await HQ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new $Q})()}createDatastore(e){const t=xP(e.databaseInfo.databaseId),r=(function(o){return new LQ(o)})(e.databaseInfo);return(function(o,s,a,u){return new BQ(o,s,a,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,o,s,a){return new jQ(r,i,o,s,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>M4(this.syncEngine,t,0)),(function(){return T4.v()?new T4:new NQ})())}createSyncEngine(e,t){return(function(i,o,s,a,u,l,h){const d=new nJ(i,o,s,a,u,l);return h&&(d.gu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const o=Wn(i);St(Zd,"RemoteStore shutting down."),o.Ea.add(5),await ug(o),o.Aa.shutdown(),o.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}ob.provider={build:()=>new ob};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dJ{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):nc("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh="FirestoreClient";class pJ{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ns.UNAUTHENTICATED,this.clientId=jR.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async s=>{St(vh,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,(s=>(St(vh,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ld;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=CP(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function O2(n,e){n.asyncQueue.verifyOperationInProgress(),St(vh,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await wP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function F4(n,e){n.asyncQueue.verifyOperationInProgress();const t=await mJ(n);St(vh,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>R4(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>R4(e.remoteStore,i))),n._onlineComponents=e}async function mJ(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){St(vh,"Using user provided OfflineComponentProvider");try{await O2(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ht.FAILED_PRECONDITION||i.code===ht.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Kd("Error using user provided cache. Falling back to memory cache: "+t),await O2(n,new F0)}}else St(vh,"Using default OfflineComponentProvider"),await O2(n,new fJ(void 0));return n._offlineComponents}async function gJ(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(St(vh,"Using user provided OnlineComponentProvider"),await F4(n,n._uninitializedComponentsProvider._online)):(St(vh,"Using default OnlineComponentProvider"),await F4(n,new ob))),n._onlineComponents}async function B4(n){const e=await gJ(n),t=e.eventManager;return t.onListen=rJ.bind(null,e.syncEngine),t.onUnlisten=sJ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=iJ.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=aJ.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LP(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V4=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP="firestore.googleapis.com",j4=!0;class U4{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Yt(ht.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=MP,this.ssl=j4}else this.host=e.host,this.ssl=e.ssl??j4;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=vP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<iQ)throw new Yt(ht.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BX("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=LP(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Yt(ht.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Yt(ht.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Yt(ht.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class I_{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new U4({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Yt(ht.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Yt(ht.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new U4(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new IX;switch(r.type){case"firstParty":return new RX(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Yt(ht.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=V4.get(t);r&&(St("ComponentProvider","Removing Datastore"),V4.delete(t),r.terminate())})(this),Promise.resolve()}}function vJ(n,e,t,r={}){var l;n=Vv(n,I_);const i=sp(e),o=n._getSettings(),s={...o,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;i&&(HN(`https://${a}`),GN("Firestore",!0)),o.host!==MP&&o.host!==a&&Kd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...o,host:a,ssl:i,emulatorOptions:r};if(!pf(u,s)&&(n._setSettings(u),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=ns.MOCK_USER;else{h=BH(r.mockUserToken,(l=n._app)==null?void 0:l.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Yt(ht.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new ns(m)}n._authCredentials=new TX(new VR(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new S1(this.firestore,e,this._query)}}class va{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new va(this.firestore,e,this._key)}toJSON(){return{type:va._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(og(t,va._jsonSchema))return new va(e,r||null,new hn(Kr.fromString(t.referencePath)))}}va._jsonSchemaVersion="firestore/documentReference/1.0",va._jsonSchema={type:Mi("string",va._jsonSchemaVersion),referencePath:Mi("string")};class Fd extends S1{constructor(e,t,r){super(e,t,h_(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new va(this.firestore,null,new hn(e))}withConverter(e){return new Fd(this.firestore,e,this._path)}}function z4(n,e,...t){if(n=ku(n),FX("collection","path",e),n instanceof I_){const r=Kr.fromString(e,...t);return ZC(r),new Fd(n,null,r)}{if(!(n instanceof va||n instanceof Fd))throw new Yt(ht.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Kr.fromString(e,...t));return ZC(r),new Fd(n.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4="AsyncQueue";class q4{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _P(this,"async_queue_retry"),this._c=()=>{const r=M2();r&&St(W4,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=M2();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=M2();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ld;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!hp(e))throw e;St(W4,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,nc("INTERNAL UNHANDLED ERROR: ",H4(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=E_.createAndSchedule(this,e,t,r,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&_n(47125,{Pc:H4(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function H4(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G4(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const o of r)if(o in i&&typeof i[o]=="function")return!0;return!1})(n,["next","error","complete"])}class sb extends I_{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new q4,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new q4(e),this._firestoreClient=void 0,await e}}}function yJ(n,e){const t=typeof n=="object"?n:YN(),r=typeof n=="string"?n:R0,i=Qx(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const o=OH("firestore");o&&vJ(i,...o)}return i}function wJ(n){if(n._terminated)throw new Yt(ht.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bJ(n),n._firestoreClient}function bJ(n){var r,i,o;const e=n._freezeSettings(),t=(function(a,u,l,h){return new JX(a,u,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,LP(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new pJ(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new rl(Lo.fromBase64String(e))}catch(t){throw new Yt(ht.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new rl(Lo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:rl._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(og(e,rl._jsonSchema))return rl.fromBase64String(e.bytes)}}rl._jsonSchemaVersion="firestore/bytes/1.0",rl._jsonSchema={type:Mi("string",rl._jsonSchemaVersion),bytes:Mi("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Yt(ht.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ss(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Yt(ht.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Yt(ht.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Vn(this._lat,e._lat)||Vn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ih._jsonSchemaVersion}}static fromJSON(e){if(og(e,ih._jsonSchema))return new ih(e.latitude,e.longitude)}}ih._jsonSchemaVersion="firestore/geoPoint/1.0",ih._jsonSchema={type:Mi("string",ih._jsonSchemaVersion),latitude:Mi("number"),longitude:Mi("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:oh._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(og(e,oh._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new oh(e.vectorValues);throw new Yt(ht.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}oh._jsonSchemaVersion="firestore/vectorValue/1.0",oh._jsonSchema={type:Mi("string",oh._jsonSchemaVersion),vectorValues:Mi("object")};const xJ=new RegExp("[~\\*/\\[\\]]");function _J(n,e,t){if(e.search(xJ)>=0)throw $4(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new OP(...e.split("."))._internalPath}catch{throw $4(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function $4(n,e,t,r,i){let o=`Function ${e}() called with invalid data`;o+=". ";let s="";return new Yt(ht.INVALID_ARGUMENT,o+n+s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new va(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new EJ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(BP("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class EJ extends FP{data(){return super.data()}}function BP(n,e){return typeof e=="string"?_J(n,e):e instanceof OP?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SJ(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Yt(ht.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AJ{convertValue(e,t="none"){switch(mh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ph(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _n(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return sg(e,((i,o)=>{r[i]=this.convertValue(o,t)})),r}convertVectorValue(e){var r,i,o;const t=(o=(i=(r=e.fields)==null?void 0:r[Hw].arrayValue)==null?void 0:i.values)==null?void 0:o.map((s=>vi(s.doubleValue)));return new oh(t)}convertGeoPoint(e){return new ih(vi(e.latitude),vi(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=g1(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Mm(e));default:return null}}convertTimestamp(e){const t=dh(e);return new Pi(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Kr.fromString(e);Qr(gP(r),9688,{name:e});const i=new Om(r.get(1),r.get(3)),o=new hn(r.popFirst(5));return i.isEqual(t)||nc(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}class Zp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class lf extends FP{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Wv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(BP("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Yt(ht.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=lf._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}lf._jsonSchemaVersion="firestore/documentSnapshot/1.0",lf._jsonSchema={type:Mi("string",lf._jsonSchemaVersion),bundleSource:Mi("string","DocumentSnapshot"),bundleName:Mi("string"),bundle:Mi("string")};class Wv extends lf{data(e={}){return super.data(e)}}class Bd{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Zp(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Wv(this._firestore,this._userDataWriter,r.key,r,new Zp(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Yt(ht.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map((a=>{const u=new Wv(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zp(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((a=>o||a.type!==3)).map((a=>{const u=new Wv(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zp(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:CJ(a.type),doc:u,oldIndex:l,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Yt(ht.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jR.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function CJ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _n(61501,{type:n})}}Bd._jsonSchemaVersion="firestore/querySnapshot/1.0",Bd._jsonSchema={type:Mi("string",Bd._jsonSchemaVersion),bundleSource:Mi("string","QuerySnapshot"),bundleName:Mi("string"),bundle:Mi("string")};class VP extends AJ{constructor(e){super(),this.firestore=e}convertBytes(e){return new rl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new va(this.firestore,null,t)}}function K4(n,...e){var u,l,h;n=ku(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||G4(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(G4(e[r])){const d=e[r];e[r]=(u=d.next)==null?void 0:u.bind(d),e[r+1]=(l=d.error)==null?void 0:l.bind(d),e[r+2]=(h=d.complete)==null?void 0:h.bind(d)}let o,s,a;if(n instanceof va)s=Vv(n.firestore,sb),a=h_(n._key.path),o={next:d=>{e[r]&&e[r](IJ(s,n,d))},error:e[r+1],complete:e[r+2]};else{const d=Vv(n,S1);s=Vv(d.firestore,sb),a=d._query;const m=new VP(s);o={next:p=>{e[r]&&e[r](new Bd(s,m,d,p))},error:e[r+1],complete:e[r+2]},SJ(n._query)}return(function(m,p,y,b){const x=new dJ(b),E=new JQ(p,x,y);return m.asyncQueue.enqueueAndForget((async()=>KQ(await B4(m),E))),()=>{x.Nu(),m.asyncQueue.enqueueAndForget((async()=>XQ(await B4(m),E)))}})(wJ(s),a,i,o)}function IJ(n,e,t){const r=t.docs.get(e._key),i=new VP(n);return new lf(n,i,e._key,r,new Zp(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){cp=i})(ap),Gd(new mf("firestore",((r,{instanceIdentifier:i,options:o})=>{const s=r.getProvider("app").getImmediate(),a=new sb(new kX(r.getProvider("auth-internal")),new PX(s,r.getProvider("app-check-internal")),(function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Yt(ht.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Om(l.options.projectId,h)})(s,i),s);return o={useFetchStreams:t,...o},a._setSettings(o),a}),"PUBLIC").setMultipleInstances(!0)),th(XC,YC,e),th(XC,YC,"esm2020")})();const TJ={apiKey:"AIzaSyBwhzGsK-ah7ObMOgpRDlzGghycLNinm6g",authDomain:"tforce-guardian-system.firebaseapp.com",projectId:"tforce-guardian-system",storageBucket:"tforce-guardian-system.firebasestorage.app",messagingSenderId:"194168927826",appId:"1:194168927826:web:18073e1a188b8e4408118b"},jP=XN(TJ),F2=AX(jP),X4=yJ(jP),kJ=()=>{const{setActiveMode:n,playSound:e,speak:t}=Eu(),[r,i]=$e.useState(null),[o,s]=$e.useState(!0),[a,u]=$e.useState("live"),[l,h]=$e.useState([]),[d,m]=$e.useState([]),[p,y]=$e.useState(""),[b,x]=$e.useState(""),[E,T]=$e.useState(""),P=$e.useRef(!1);$e.useEffect(()=>{const L=dK(F2,C=>{i(C),s(!1),C&&!P.current&&(P.current=!0,setTimeout(()=>{t("Guardian uplink established.")},500))});return()=>L()},[]),$e.useEffect(()=>{if(!r||a!=="live")return;const L=K4(z4(X4,"locations"),C=>{const A=C.docs.map(O=>({id:O.id,...O.data()})),M=new Date,k=A.filter(O=>{if(!O.timestamp||!O.timestamp.toDate)return!1;const j=(M-O.timestamp.toDate())/1e3/60;return O.onDuty&&j<60});h(k)});return()=>L()},[r,a]),$e.useEffect(()=>{if(!r||a!=="logs")return;const L=K4(z4(X4,"scan_logs"),C=>{let A=C.docs.map(M=>({id:M.id,...M.data()}));A.sort((M,k)=>{var O,j;return(((O=k.timestamp)==null?void 0:O.seconds)||0)-(((j=M.timestamp)==null?void 0:j.seconds)||0)}),m(A.slice(0,50))});return()=>L()},[r,a]);const I=async L=>{L.preventDefault();try{await cK(F2,p,b)}catch(C){T("Access Denied: "+C.message),e("error")}},D=()=>{pK(F2),e("click"),P.current=!1},U=L=>{if(!L||!L.toDate)return"PENDING...";try{return L.toDate().toLocaleTimeString()}catch{return"ERR"}};return se.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up font-mono",children:[se.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-red-600/30",children:[se.jsxs("div",{className:"flex items-center gap-3",children:[se.jsx("i",{className:"fas fa-shield-alt text-red-600 text-xl animate-pulse"}),se.jsx("h2",{className:"text-red-600 font-bold text-xl tracking-widest",children:"GUARDIAN COMMAND"})]}),se.jsx("button",{onClick:()=>{e("click"),n("HOME")},className:"text-red-600 hover:text-white",children:se.jsx("i",{className:"fas fa-times text-2xl"})})]}),se.jsx("div",{className:"flex-1 overflow-y-auto p-6 no-scrollbar",children:o?se.jsx("div",{className:"text-center text-red-600 mt-20 animate-pulse",children:"ESTABLISHING SECURE CONNECTION..."}):r?se.jsxs(se.Fragment,{children:[se.jsxs("div",{className:"flex gap-4 mb-6 border-b border-white/10 pb-4",children:[se.jsx("button",{onClick:()=>u("live"),className:`px-4 py-2 border ${a==="live"?"border-red-600 bg-red-600/20 text-red-500":"border-gray-700 text-gray-500"}`,children:"ACTIVE UNITS"}),se.jsx("button",{onClick:()=>u("logs"),className:`px-4 py-2 border ${a==="logs"?"border-red-600 bg-red-600/20 text-red-500":"border-gray-700 text-gray-500"}`,children:"SCAN LOGS"}),se.jsx("button",{onClick:D,className:"ml-auto text-xs text-gray-500 hover:text-white",children:"SIGN OUT"})]}),a==="live"&&se.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.length===0&&se.jsx("div",{className:"col-span-full text-center text-gray-500",children:"NO ACTIVE UNITS DETECTED"}),l.map(L=>{var C,A;return se.jsxs("div",{className:"border border-white/20 border-l-4 border-l-green-500 p-4 bg-white/5",children:[se.jsxs("div",{className:"flex justify-between items-start",children:[se.jsx("h3",{className:"font-bold text-lg text-white",children:L.username}),se.jsx("span",{className:"text-green-500 text-xs font-bold animate-pulse",children:" ON DUTY"})]}),se.jsxs("div",{className:"text-gray-400 text-xs mt-1",children:["LAST SIGNAL: ",U(L.timestamp)]}),se.jsxs("div",{className:"bg-black p-2 mt-3 font-mono text-xs text-red-400 border border-white/10 flex justify-between items-center",children:[se.jsxs("span",{children:[(C=L.latitude)==null?void 0:C.toFixed(4),", ",(A=L.longitude)==null?void 0:A.toFixed(4)]}),se.jsxs("a",{href:`http://googleusercontent.com/maps.google.com/6{u.latitude},${L.longitude}`,target:"_blank",rel:"noreferrer",className:"text-white hover:text-red-500",children:[se.jsx("i",{className:"fas fa-map-marker-alt"})," MAP"]})]})]},L.id)})]}),a==="logs"&&se.jsxs("div",{className:"space-y-2",children:[se.jsx("div",{className:"flex justify-between items-center mb-2",children:se.jsx("span",{className:"text-xs text-gray-500",children:"RECENT ACTIVITY"})}),d.map(L=>se.jsxs("div",{className:"border-b border-white/10 p-3 flex justify-between items-center hover:bg-white/5",children:[se.jsxs("div",{children:[se.jsx("div",{className:"font-bold text-white text-sm",children:L.username}),se.jsx("div",{className:"text-gray-500 text-xs",children:U(L.timestamp)})]}),se.jsx("div",{className:"text-right",children:se.jsx("div",{className:"text-red-400 text-sm",children:L.checkpointData||"SCAN"})})]},L.id))]})]}):se.jsxs("div",{className:"max-w-sm mx-auto mt-10 p-6 border border-red-600/50 rounded bg-red-900/10",children:[se.jsx("h3",{className:"text-red-600 text-center text-lg font-bold mb-6",children:"RESTRICTED ACCESS"}),se.jsxs("form",{onSubmit:I,className:"flex flex-col gap-4",children:[se.jsx("input",{type:"email",placeholder:"OFFICER EMAIL",value:p,onChange:L=>y(L.target.value),className:"bg-black border border-red-600/30 p-3 text-white outline-none focus:border-red-600"}),se.jsx("input",{type:"password",placeholder:"ACCESS CODE",value:b,onChange:L=>x(L.target.value),className:"bg-black border border-red-600/30 p-3 text-white outline-none focus:border-red-600"}),E&&se.jsx("div",{className:"text-xs text-red-500 text-center",children:E}),se.jsx("button",{type:"submit",className:"bg-red-600 text-white font-bold py-3 hover:bg-red-700 transition-all",children:"AUTHENTICATE"})]})]})})]})},NJ=()=>{const{systemStatus:n,setSystemStatus:e,playSound:t,speak:r,user:i,battery:o,isListening:s,toggleListening:a,activeMode:u,setActiveMode:l}=Eu(),[h,d]=$e.useState(!1),[m,p]=$e.useState(!1),y=u==="MENU_OPEN",b=()=>{t("startup"),d(!0),e("ONLINE"),setTimeout(()=>{r(`Welcome back, ${i.name}. System secure. Battery at ${o} percent.`)},1e3)};return h?se.jsxs("div",{className:"relative w-screen h-screen bg-black overflow-hidden",children:[se.jsx(RD,{}),u==="HOME"&&se.jsx("div",{onClick:()=>{t("click"),l("MENU_OPEN")},className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-48 h-48 rounded-full z-10 cursor-pointer"}),se.jsxs("div",{className:"absolute top-0 left-0 w-full p-4 flex justify-between items-start z-20 pointer-events-none",children:[se.jsxs("div",{className:"text-cyan-dim font-mono text-xs",children:[se.jsx("div",{className:"border-b border-cyan w-20 mb-1",children:"T-FORCE"}),se.jsxs("div",{children:["OP: ",i.name.toUpperCase()]}),se.jsxs("div",{children:["ACC: ",i.access.toUpperCase()]})]}),se.jsxs("div",{className:"text-right",children:[se.jsxs("div",{className:`text-xl font-orbitron font-bold ${o<20?"text-red-500":"text-cyan"}`,children:[o,"%"]}),se.jsx("div",{className:"text-cyan-dim font-mono text-[10px]",children:"PWR LEVEL"})]})]}),(u==="HOME"||u==="MENU_OPEN")&&se.jsx("div",{className:"absolute bottom-24 left-1/2 transform -translate-x-1/2 z-20",children:se.jsx("button",{onClick:a,className:`
              w-16 h-16 rounded-full border border-cyan flex items-center justify-center
              transition-all duration-300 backdrop-blur-sm
              ${s?"bg-red-500/20 shadow-[0_0_30px_rgba(255,0,0,0.5)] border-red-500 scale-110":"bg-black/50 hover:bg-cyan/20 shadow-[0_0_15px_rgba(0,229,255,0.3)]"}
            `,children:se.jsx("i",{className:`fas fa-microphone text-2xl ${s?"text-red-500 animate-pulse":"text-cyan"}`})})}),se.jsxs("div",{className:"absolute bottom-8 w-full text-center z-20 pointer-events-none",children:[se.jsx("div",{className:"text-cyan font-orbitron tracking-[4px] text-sm animate-pulse",children:n}),se.jsx("div",{className:"text-cyan-dim text-[10px] mt-1 font-mono",children:s?"LISTENING...":u==="MENU_OPEN"?"AWAITING SELECTION":u})]}),se.jsx(sF,{isOpen:y,onClose:()=>l("HOME"),onOpenSettings:()=>{l("HOME"),p(!0)}}),m&&se.jsx(PD,{onClose:()=>p(!1)}),u==="VISION"&&se.jsx(Tz,{}),u==="MEDIA"&&se.jsx(Dz,{}),u==="DATABASE"&&se.jsx(Lz,{}),u==="HUD"&&se.jsx(Mz,{}),u==="OPS"&&se.jsx(CH,{}),u==="RECON"&&se.jsx(IH,{}),u==="GUARDIAN"&&se.jsx(kJ,{})]}):se.jsxs("div",{onClick:b,className:"w-screen h-screen bg-black flex flex-col items-center justify-center cursor-pointer select-none",children:[se.jsx("div",{className:"text-cyan text-6xl animate-pulse mb-4",children:se.jsx("i",{className:"fas fa-fingerprint"})}),se.jsx("div",{className:"text-cyan font-orbitron font-bold text-xl tracking-widest",children:"INITIALIZE JARVIS"}),se.jsx("div",{className:"text-cyan-dim font-mono text-xs mt-2",children:"TOUCH TO AUTHENTICATE"})]})};function RJ(){return se.jsx(ND,{children:se.jsx(NJ,{})})}kD.createRoot(document.getElementById("root")).render(se.jsx($e.StrictMode,{children:se.jsx(RJ,{})}));export{fr as _};
