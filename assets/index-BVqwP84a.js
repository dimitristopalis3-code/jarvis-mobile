(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var G1={exports:{}},kp={},$1={exports:{}},yn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J5;function SP(){if(J5)return yn;J5=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;function p(re){return re===null||typeof re!="object"?null:(re=d&&re[d]||re["@@iterator"],typeof re=="function"?re:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function x(re,j,$){this.props=re,this.context=j,this.refs=b,this.updater=$||m}x.prototype.isReactComponent={},x.prototype.setState=function(re,j){if(typeof re!="object"&&typeof re!="function"&&re!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,re,j,"setState")},x.prototype.forceUpdate=function(re){this.updater.enqueueForceUpdate(this,re,"forceUpdate")};function E(){}E.prototype=x.prototype;function A(re,j,$){this.props=re,this.context=j,this.refs=b,this.updater=$||m}var N=A.prototype=new E;N.constructor=A,w(N,x.prototype),N.isPureReactComponent=!0;var F=Array.isArray,D=Object.prototype.hasOwnProperty,W={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function C(re,j,$){var ne,ce={},ge=null,ye=null;if(j!=null)for(ne in j.ref!==void 0&&(ye=j.ref),j.key!==void 0&&(ge=""+j.key),j)D.call(j,ne)&&!k.hasOwnProperty(ne)&&(ce[ne]=j[ne]);var be=arguments.length-2;if(be===1)ce.children=$;else if(1<be){for(var Ae=Array(be),$e=0;$e<be;$e++)Ae[$e]=arguments[$e+2];ce.children=Ae}if(re&&re.defaultProps)for(ne in be=re.defaultProps,be)ce[ne]===void 0&&(ce[ne]=be[ne]);return{$$typeof:n,type:re,key:ge,ref:ye,props:ce,_owner:W.current}}function L(re,j){return{$$typeof:n,type:re.type,key:j,ref:re.ref,props:re.props,_owner:re._owner}}function B(re){return typeof re=="object"&&re!==null&&re.$$typeof===n}function R(re){var j={"=":"=0",":":"=2"};return"$"+re.replace(/[=:]/g,function($){return j[$]})}var M=/\/+/g;function U(re,j){return typeof re=="object"&&re!==null&&re.key!=null?R(""+re.key):j.toString(36)}function J(re,j,$,ne,ce){var ge=typeof re;(ge==="undefined"||ge==="boolean")&&(re=null);var ye=!1;if(re===null)ye=!0;else switch(ge){case"string":case"number":ye=!0;break;case"object":switch(re.$$typeof){case n:case e:ye=!0}}if(ye)return ye=re,ce=ce(ye),re=ne===""?"."+U(ye,0):ne,F(ce)?($="",re!=null&&($=re.replace(M,"$&/")+"/"),J(ce,j,$,"",function($e){return $e})):ce!=null&&(B(ce)&&(ce=L(ce,$+(!ce.key||ye&&ye.key===ce.key?"":(""+ce.key).replace(M,"$&/")+"/")+re)),j.push(ce)),1;if(ye=0,ne=ne===""?".":ne+":",F(re))for(var be=0;be<re.length;be++){ge=re[be];var Ae=ne+U(ge,be);ye+=J(ge,j,$,Ae,ce)}else if(Ae=p(re),typeof Ae=="function")for(re=Ae.call(re),be=0;!(ge=re.next()).done;)ge=ge.value,Ae=ne+U(ge,be++),ye+=J(ge,j,$,Ae,ce);else if(ge==="object")throw j=String(re),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(re).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.");return ye}function de(re,j,$){if(re==null)return re;var ne=[],ce=0;return J(re,ne,"","",function(ge){return j.call($,ge,ce++)}),ne}function fe(re){if(re._status===-1){var j=re._result;j=j(),j.then(function($){(re._status===0||re._status===-1)&&(re._status=1,re._result=$)},function($){(re._status===0||re._status===-1)&&(re._status=2,re._result=$)}),re._status===-1&&(re._status=0,re._result=j)}if(re._status===1)return re._result.default;throw re._result}var he={current:null},K={transition:null},le={ReactCurrentDispatcher:he,ReactCurrentBatchConfig:K,ReactCurrentOwner:W};function se(){throw Error("act(...) is not supported in production builds of React.")}return yn.Children={map:de,forEach:function(re,j,$){de(re,function(){j.apply(this,arguments)},$)},count:function(re){var j=0;return de(re,function(){j++}),j},toArray:function(re){return de(re,function(j){return j})||[]},only:function(re){if(!B(re))throw Error("React.Children.only expected to receive a single React element child.");return re}},yn.Component=x,yn.Fragment=t,yn.Profiler=i,yn.PureComponent=A,yn.StrictMode=r,yn.Suspense=u,yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=le,yn.act=se,yn.cloneElement=function(re,j,$){if(re==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+re+".");var ne=w({},re.props),ce=re.key,ge=re.ref,ye=re._owner;if(j!=null){if(j.ref!==void 0&&(ge=j.ref,ye=W.current),j.key!==void 0&&(ce=""+j.key),re.type&&re.type.defaultProps)var be=re.type.defaultProps;for(Ae in j)D.call(j,Ae)&&!k.hasOwnProperty(Ae)&&(ne[Ae]=j[Ae]===void 0&&be!==void 0?be[Ae]:j[Ae])}var Ae=arguments.length-2;if(Ae===1)ne.children=$;else if(1<Ae){be=Array(Ae);for(var $e=0;$e<Ae;$e++)be[$e]=arguments[$e+2];ne.children=be}return{$$typeof:n,type:re.type,key:ce,ref:ge,props:ne,_owner:ye}},yn.createContext=function(re){return re={$$typeof:s,_currentValue:re,_currentValue2:re,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},re.Provider={$$typeof:o,_context:re},re.Consumer=re},yn.createElement=C,yn.createFactory=function(re){var j=C.bind(null,re);return j.type=re,j},yn.createRef=function(){return{current:null}},yn.forwardRef=function(re){return{$$typeof:a,render:re}},yn.isValidElement=B,yn.lazy=function(re){return{$$typeof:h,_payload:{_status:-1,_result:re},_init:fe}},yn.memo=function(re,j){return{$$typeof:l,type:re,compare:j===void 0?null:j}},yn.startTransition=function(re){var j=K.transition;K.transition={};try{re()}finally{K.transition=j}},yn.unstable_act=se,yn.useCallback=function(re,j){return he.current.useCallback(re,j)},yn.useContext=function(re){return he.current.useContext(re)},yn.useDebugValue=function(){},yn.useDeferredValue=function(re){return he.current.useDeferredValue(re)},yn.useEffect=function(re,j){return he.current.useEffect(re,j)},yn.useId=function(){return he.current.useId()},yn.useImperativeHandle=function(re,j,$){return he.current.useImperativeHandle(re,j,$)},yn.useInsertionEffect=function(re,j){return he.current.useInsertionEffect(re,j)},yn.useLayoutEffect=function(re,j){return he.current.useLayoutEffect(re,j)},yn.useMemo=function(re,j){return he.current.useMemo(re,j)},yn.useReducer=function(re,j,$){return he.current.useReducer(re,j,$)},yn.useRef=function(re){return he.current.useRef(re)},yn.useState=function(re){return he.current.useState(re)},yn.useSyncExternalStore=function(re,j,$){return he.current.useSyncExternalStore(re,j,$)},yn.useTransition=function(){return he.current.useTransition()},yn.version="18.3.1",yn}var Q5;function kw(){return Q5||(Q5=1,$1.exports=SP()),$1.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z5;function AP(){if(Z5)return kp;Z5=1;var n=kw(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function s(a,u,l){var h,d={},p=null,m=null;l!==void 0&&(p=""+l),u.key!==void 0&&(p=""+u.key),u.ref!==void 0&&(m=u.ref);for(h in u)r.call(u,h)&&!o.hasOwnProperty(h)&&(d[h]=u[h]);if(a&&a.defaultProps)for(h in u=a.defaultProps,u)d[h]===void 0&&(d[h]=u[h]);return{$$typeof:e,type:a,key:p,ref:m,props:d,_owner:i.current}}return kp.Fragment=t,kp.jsx=s,kp.jsxs=s,kp}var e_;function CP(){return e_||(e_=1,G1.exports=AP()),G1.exports}var ae=CP(),qe=kw(),Dg={},K1={exports:{}},_s={},X1={exports:{}},Y1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t_;function IP(){return t_||(t_=1,(function(n){function e(K,le){var se=K.length;K.push(le);e:for(;0<se;){var re=se-1>>>1,j=K[re];if(0<i(j,le))K[re]=le,K[se]=j,se=re;else break e}}function t(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var le=K[0],se=K.pop();if(se!==le){K[0]=se;e:for(var re=0,j=K.length,$=j>>>1;re<$;){var ne=2*(re+1)-1,ce=K[ne],ge=ne+1,ye=K[ge];if(0>i(ce,se))ge<j&&0>i(ye,ce)?(K[re]=ye,K[ge]=se,re=ge):(K[re]=ce,K[ne]=se,re=ne);else if(ge<j&&0>i(ye,se))K[re]=ye,K[ge]=se,re=ge;else break e}}return le}function i(K,le){var se=K.sortIndex-le.sortIndex;return se!==0?se:K.id-le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();n.unstable_now=function(){return s.now()-a}}var u=[],l=[],h=1,d=null,p=3,m=!1,w=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(K){for(var le=t(l);le!==null;){if(le.callback===null)r(l);else if(le.startTime<=K)r(l),le.sortIndex=le.expirationTime,e(u,le);else break;le=t(l)}}function F(K){if(b=!1,N(K),!w)if(t(u)!==null)w=!0,fe(D);else{var le=t(l);le!==null&&he(F,le.startTime-K)}}function D(K,le){w=!1,b&&(b=!1,E(C),C=-1),m=!0;var se=p;try{for(N(le),d=t(u);d!==null&&(!(d.expirationTime>le)||K&&!R());){var re=d.callback;if(typeof re=="function"){d.callback=null,p=d.priorityLevel;var j=re(d.expirationTime<=le);le=n.unstable_now(),typeof j=="function"?d.callback=j:d===t(u)&&r(u),N(le)}else r(u);d=t(u)}if(d!==null)var $=!0;else{var ne=t(l);ne!==null&&he(F,ne.startTime-le),$=!1}return $}finally{d=null,p=se,m=!1}}var W=!1,k=null,C=-1,L=5,B=-1;function R(){return!(n.unstable_now()-B<L)}function M(){if(k!==null){var K=n.unstable_now();B=K;var le=!0;try{le=k(!0,K)}finally{le?U():(W=!1,k=null)}}else W=!1}var U;if(typeof A=="function")U=function(){A(M)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,de=J.port2;J.port1.onmessage=M,U=function(){de.postMessage(null)}}else U=function(){x(M,0)};function fe(K){k=K,W||(W=!0,U())}function he(K,le){C=x(function(){K(n.unstable_now())},le)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(K){K.callback=null},n.unstable_continueExecution=function(){w||m||(w=!0,fe(D))},n.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<K?Math.floor(1e3/K):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(K){switch(p){case 1:case 2:case 3:var le=3;break;default:le=p}var se=p;p=le;try{return K()}finally{p=se}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(K,le){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var se=p;p=K;try{return le()}finally{p=se}},n.unstable_scheduleCallback=function(K,le,se){var re=n.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?re+se:re):se=re,K){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=se+j,K={id:h++,callback:le,priorityLevel:K,startTime:se,expirationTime:j,sortIndex:-1},se>re?(K.sortIndex=se,e(l,K),t(u)===null&&K===t(l)&&(b?(E(C),C=-1):b=!0,he(F,se-re))):(K.sortIndex=j,e(u,K),w||m||(w=!0,fe(D))),K},n.unstable_shouldYield=R,n.unstable_wrapCallback=function(K){var le=p;return function(){var se=p;p=le;try{return K.apply(this,arguments)}finally{p=se}}}})(Y1)),Y1}var n_;function TP(){return n_||(n_=1,X1.exports=IP()),X1.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r_;function kP(){if(r_)return _s;r_=1;var n=kw(),e=TP();function t(c){for(var f="https://reactjs.org/docs/error-decoder.html?invariant="+c,g=1;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function o(c,f){s(c,f),s(c+"Capture",f)}function s(c,f){for(i[c]=f,c=0;c<f.length;c++)r.add(f[c])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,l=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},d={};function p(c){return u.call(d,c)?!0:u.call(h,c)?!1:l.test(c)?d[c]=!0:(h[c]=!0,!1)}function m(c,f,g,_){if(g!==null&&g.type===0)return!1;switch(typeof f){case"function":case"symbol":return!0;case"boolean":return _?!1:g!==null?!g.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function w(c,f,g,_){if(f===null||typeof f>"u"||m(c,f,g,_))return!0;if(_)return!1;if(g!==null)switch(g.type){case 3:return!f;case 4:return f===!1;case 5:return isNaN(f);case 6:return isNaN(f)||1>f}return!1}function b(c,f,g,_,T,V,Y){this.acceptsBooleans=f===2||f===3||f===4,this.attributeName=_,this.attributeNamespace=T,this.mustUseProperty=g,this.propertyName=c,this.type=f,this.sanitizeURL=V,this.removeEmptyString=Y}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){x[c]=new b(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var f=c[0];x[f]=new b(f,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){x[c]=new b(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){x[c]=new b(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){x[c]=new b(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){x[c]=new b(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){x[c]=new b(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){x[c]=new b(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){x[c]=new b(c,5,!1,c.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function A(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var f=c.replace(E,A);x[f]=new b(f,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var f=c.replace(E,A);x[f]=new b(f,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var f=c.replace(E,A);x[f]=new b(f,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){x[c]=new b(c,1,!1,c.toLowerCase(),null,!1,!1)}),x.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){x[c]=new b(c,1,!1,c.toLowerCase(),null,!0,!0)});function N(c,f,g,_){var T=x.hasOwnProperty(f)?x[f]:null;(T!==null?T.type!==0:_||!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(w(f,g,T,_)&&(g=null),_||T===null?p(f)&&(g===null?c.removeAttribute(f):c.setAttribute(f,""+g)):T.mustUseProperty?c[T.propertyName]=g===null?T.type===3?!1:"":g:(f=T.attributeName,_=T.attributeNamespace,g===null?c.removeAttribute(f):(T=T.type,g=T===3||T===4&&g===!0?"":""+g,_?c.setAttributeNS(_,f,g):c.setAttribute(f,g))))}var F=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),W=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),R=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),de=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),he=Symbol.for("react.offscreen"),K=Symbol.iterator;function le(c){return c===null||typeof c!="object"?null:(c=K&&c[K]||c["@@iterator"],typeof c=="function"?c:null)}var se=Object.assign,re;function j(c){if(re===void 0)try{throw Error()}catch(g){var f=g.stack.trim().match(/\n( *(at )?)/);re=f&&f[1]||""}return`
`+re+c}var $=!1;function ne(c,f){if(!c||$)return"";$=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(f)if(f=function(){throw Error()},Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(je){var _=je}Reflect.construct(c,[],f)}else{try{f.call()}catch(je){_=je}c.call(f.prototype)}else{try{throw Error()}catch(je){_=je}c()}}catch(je){if(je&&_&&typeof je.stack=="string"){for(var T=je.stack.split(`
`),V=_.stack.split(`
`),Y=T.length-1,ve=V.length-1;1<=Y&&0<=ve&&T[Y]!==V[ve];)ve--;for(;1<=Y&&0<=ve;Y--,ve--)if(T[Y]!==V[ve]){if(Y!==1||ve!==1)do if(Y--,ve--,0>ve||T[Y]!==V[ve]){var Se=`
`+T[Y].replace(" at new "," at ");return c.displayName&&Se.includes("<anonymous>")&&(Se=Se.replace("<anonymous>",c.displayName)),Se}while(1<=Y&&0<=ve);break}}}finally{$=!1,Error.prepareStackTrace=g}return(c=c?c.displayName||c.name:"")?j(c):""}function ce(c){switch(c.tag){case 5:return j(c.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return c=ne(c.type,!1),c;case 11:return c=ne(c.type.render,!1),c;case 1:return c=ne(c.type,!0),c;default:return""}}function ge(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case k:return"Fragment";case W:return"Portal";case L:return"Profiler";case C:return"StrictMode";case U:return"Suspense";case J:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case R:return(c.displayName||"Context")+".Consumer";case B:return(c._context.displayName||"Context")+".Provider";case M:var f=c.render;return c=c.displayName,c||(c=f.displayName||f.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case de:return f=c.displayName||null,f!==null?f:ge(c.type)||"Memo";case fe:f=c._payload,c=c._init;try{return ge(c(f))}catch{}}return null}function ye(c){var f=c.type;switch(c.tag){case 24:return"Cache";case 9:return(f.displayName||"Context")+".Consumer";case 10:return(f._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=f.render,c=c.displayName||c.name||"",f.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return f;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ge(f);case 8:return f===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f}return null}function be(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function Ae(c){var f=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function $e(c){var f=Ae(c)?"checked":"value",g=Object.getOwnPropertyDescriptor(c.constructor.prototype,f),_=""+c[f];if(!c.hasOwnProperty(f)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var T=g.get,V=g.set;return Object.defineProperty(c,f,{configurable:!0,get:function(){return T.call(this)},set:function(Y){_=""+Y,V.call(this,Y)}}),Object.defineProperty(c,f,{enumerable:g.enumerable}),{getValue:function(){return _},setValue:function(Y){_=""+Y},stopTracking:function(){c._valueTracker=null,delete c[f]}}}}function Ue(c){c._valueTracker||(c._valueTracker=$e(c))}function et(c){if(!c)return!1;var f=c._valueTracker;if(!f)return!0;var g=f.getValue(),_="";return c&&(_=Ae(c)?c.checked?"true":"false":c.value),c=_,c!==g?(f.setValue(c),!0):!1}function Je(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Be(c,f){var g=f.checked;return se({},f,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??c._wrapperState.initialChecked})}function _e(c,f){var g=f.defaultValue==null?"":f.defaultValue,_=f.checked!=null?f.checked:f.defaultChecked;g=be(f.value!=null?f.value:g),c._wrapperState={initialChecked:_,initialValue:g,controlled:f.type==="checkbox"||f.type==="radio"?f.checked!=null:f.value!=null}}function ie(c,f){f=f.checked,f!=null&&N(c,"checked",f,!1)}function ft(c,f){ie(c,f);var g=be(f.value),_=f.type;if(g!=null)_==="number"?(g===0&&c.value===""||c.value!=g)&&(c.value=""+g):c.value!==""+g&&(c.value=""+g);else if(_==="submit"||_==="reset"){c.removeAttribute("value");return}f.hasOwnProperty("value")?Ze(c,f.type,g):f.hasOwnProperty("defaultValue")&&Ze(c,f.type,be(f.defaultValue)),f.checked==null&&f.defaultChecked!=null&&(c.defaultChecked=!!f.defaultChecked)}function dt(c,f,g){if(f.hasOwnProperty("value")||f.hasOwnProperty("defaultValue")){var _=f.type;if(!(_!=="submit"&&_!=="reset"||f.value!==void 0&&f.value!==null))return;f=""+c._wrapperState.initialValue,g||f===c.value||(c.value=f),c.defaultValue=f}g=c.name,g!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,g!==""&&(c.name=g)}function Ze(c,f,g){(f!=="number"||Je(c.ownerDocument)!==c)&&(g==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+g&&(c.defaultValue=""+g))}var at=Array.isArray;function lt(c,f,g,_){if(c=c.options,f){f={};for(var T=0;T<g.length;T++)f["$"+g[T]]=!0;for(g=0;g<c.length;g++)T=f.hasOwnProperty("$"+c[g].value),c[g].selected!==T&&(c[g].selected=T),T&&_&&(c[g].defaultSelected=!0)}else{for(g=""+be(g),f=null,T=0;T<c.length;T++){if(c[T].value===g){c[T].selected=!0,_&&(c[T].defaultSelected=!0);return}f!==null||c[T].disabled||(f=c[T])}f!==null&&(f.selected=!0)}}function ct(c,f){if(f.dangerouslySetInnerHTML!=null)throw Error(t(91));return se({},f,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function xt(c,f){var g=f.value;if(g==null){if(g=f.children,f=f.defaultValue,g!=null){if(f!=null)throw Error(t(92));if(at(g)){if(1<g.length)throw Error(t(93));g=g[0]}f=g}f==null&&(f=""),g=f}c._wrapperState={initialValue:be(g)}}function Vt(c,f){var g=be(f.value),_=be(f.defaultValue);g!=null&&(g=""+g,g!==c.value&&(c.value=g),f.defaultValue==null&&c.defaultValue!==g&&(c.defaultValue=g)),_!=null&&(c.defaultValue=""+_)}function jt(c){var f=c.textContent;f===c._wrapperState.initialValue&&f!==""&&f!==null&&(c.value=f)}function Pt(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lt(c,f){return c==null||c==="http://www.w3.org/1999/xhtml"?Pt(f):c==="http://www.w3.org/2000/svg"&&f==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var Yt,Ut=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(f,g,_,T){MSApp.execUnsafeLocalFunction(function(){return c(f,g,_,T)})}:c})(function(c,f){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=f;else{for(Yt=Yt||document.createElement("div"),Yt.innerHTML="<svg>"+f.valueOf().toString()+"</svg>",f=Yt.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;f.firstChild;)c.appendChild(f.firstChild)}});function en(c,f){if(f){var g=c.firstChild;if(g&&g===c.lastChild&&g.nodeType===3){g.nodeValue=f;return}}c.textContent=f}var pt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ar=["Webkit","ms","Moz","O"];Object.keys(pt).forEach(function(c){ar.forEach(function(f){f=f+c.charAt(0).toUpperCase()+c.substring(1),pt[f]=pt[c]})});function dn(c,f,g){return f==null||typeof f=="boolean"||f===""?"":g||typeof f!="number"||f===0||pt.hasOwnProperty(c)&&pt[c]?(""+f).trim():f+"px"}function qr(c,f){c=c.style;for(var g in f)if(f.hasOwnProperty(g)){var _=g.indexOf("--")===0,T=dn(g,f[g],_);g==="float"&&(g="cssFloat"),_?c.setProperty(g,T):c[g]=T}}var xn=se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gn(c,f){if(f){if(xn[c]&&(f.children!=null||f.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(f.dangerouslySetInnerHTML!=null){if(f.children!=null)throw Error(t(60));if(typeof f.dangerouslySetInnerHTML!="object"||!("__html"in f.dangerouslySetInnerHTML))throw Error(t(61))}if(f.style!=null&&typeof f.style!="object")throw Error(t(62))}}function ho(c,f){if(c.indexOf("-")===-1)return typeof f.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gn=null;function is(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Jn=null,yr=null,ni=null;function Qn(c){if(c=Ac(c)){if(typeof Jn!="function")throw Error(t(280));var f=c.stateNode;f&&(f=Vh(f),Jn(c.stateNode,c.type,f))}}function Wt(c){yr?ni?ni.push(c):ni=[c]:yr=c}function En(){if(yr){var c=yr,f=ni;if(ni=yr=null,Qn(c),f)for(c=0;c<f.length;c++)Qn(f[c])}}function zo(c,f){return c(f)}function Sr(){}var ri=!1;function fo(c,f,g){if(ri)return c(f,g);ri=!0;try{return zo(c,f,g)}finally{ri=!1,(yr!==null||ni!==null)&&(Sr(),En())}}function _t(c,f){var g=c.stateNode;if(g===null)return null;var _=Vh(g);if(_===null)return null;g=_[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(c=c.type,_=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!_;break e;default:c=!1}if(c)return null;if(g&&typeof g!="function")throw Error(t(231,f,typeof g));return g}var Ti=!1;if(a)try{var Lr={};Object.defineProperty(Lr,"passive",{get:function(){Ti=!0}}),window.addEventListener("test",Lr,Lr),window.removeEventListener("test",Lr,Lr)}catch{Ti=!1}function Mr(c,f,g,_,T,V,Y,ve,Se){var je=Array.prototype.slice.call(arguments,3);try{f.apply(g,je)}catch(st){this.onError(st)}}var nr=!1,rr=null,cr=!1,ia=null,Ns={onError:function(c){nr=!0,rr=c}};function ki(c,f,g,_,T,V,Y,ve,Se){nr=!1,rr=null,Mr.apply(Ns,arguments)}function po(c,f,g,_,T,V,Y,ve,Se){if(ki.apply(this,arguments),nr){if(nr){var je=rr;nr=!1,rr=null}else throw Error(t(198));cr||(cr=!0,ia=je)}}function Ar(c){var f=c,g=c;if(c.alternate)for(;f.return;)f=f.return;else{c=f;do f=c,(f.flags&4098)!==0&&(g=f.return),c=f.return;while(c)}return f.tag===3?g:null}function Ni(c){if(c.tag===13){var f=c.memoizedState;if(f===null&&(c=c.alternate,c!==null&&(f=c.memoizedState)),f!==null)return f.dehydrated}return null}function wr(c){if(Ar(c)!==c)throw Error(t(188))}function Wo(c){var f=c.alternate;if(!f){if(f=Ar(c),f===null)throw Error(t(188));return f!==c?null:c}for(var g=c,_=f;;){var T=g.return;if(T===null)break;var V=T.alternate;if(V===null){if(_=T.return,_!==null){g=_;continue}break}if(T.child===V.child){for(V=T.child;V;){if(V===g)return wr(T),c;if(V===_)return wr(T),f;V=V.sibling}throw Error(t(188))}if(g.return!==_.return)g=T,_=V;else{for(var Y=!1,ve=T.child;ve;){if(ve===g){Y=!0,g=T,_=V;break}if(ve===_){Y=!0,_=T,g=V;break}ve=ve.sibling}if(!Y){for(ve=V.child;ve;){if(ve===g){Y=!0,g=V,_=T;break}if(ve===_){Y=!0,_=V,g=T;break}ve=ve.sibling}if(!Y)throw Error(t(189))}}if(g.alternate!==_)throw Error(t(190))}if(g.tag!==3)throw Error(t(188));return g.stateNode.current===g?c:f}function Ps(c){return c=Wo(c),c!==null?Rs(c):null}function Rs(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var f=Rs(c);if(f!==null)return f;c=c.sibling}return null}var Ds=e.unstable_scheduleCallback,oa=e.unstable_cancelCallback,La=e.unstable_shouldYield,ic=e.unstable_requestPaint,$n=e.unstable_now,oc=e.unstable_getCurrentPriorityLevel,os=e.unstable_ImmediatePriority,Ls=e.unstable_UserBlockingPriority,mo=e.unstable_NormalPriority,Ma=e.unstable_LowPriority,sc=e.unstable_IdlePriority,sa=null,Gi=null;function Fa(c){if(Gi&&typeof Gi.onCommitFiberRoot=="function")try{Gi.onCommitFiberRoot(sa,c,void 0,(c.current.flags&128)===128)}catch{}}var ci=Math.clz32?Math.clz32:gl,ir=Math.log,ml=Math.LN2;function gl(c){return c>>>=0,c===0?32:31-(ir(c)/ml|0)|0}var Oa=64,aa=4194304;function ua(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function hi(c,f){var g=c.pendingLanes;if(g===0)return 0;var _=0,T=c.suspendedLanes,V=c.pingedLanes,Y=g&268435455;if(Y!==0){var ve=Y&~T;ve!==0?_=ua(ve):(V&=Y,V!==0&&(_=ua(V)))}else Y=g&~T,Y!==0?_=ua(Y):V!==0&&(_=ua(V));if(_===0)return 0;if(f!==0&&f!==_&&(f&T)===0&&(T=_&-_,V=f&-f,T>=V||T===16&&(V&4194240)!==0))return f;if((_&4)!==0&&(_|=g&16),f=c.entangledLanes,f!==0)for(c=c.entanglements,f&=_;0<f;)g=31-ci(f),T=1<<g,_|=c[g],f&=~T;return _}function Su(c,f){switch(c){case 1:case 2:case 4:return f+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function br(c,f){for(var g=c.suspendedLanes,_=c.pingedLanes,T=c.expirationTimes,V=c.pendingLanes;0<V;){var Y=31-ci(V),ve=1<<Y,Se=T[Y];Se===-1?((ve&g)===0||(ve&_)!==0)&&(T[Y]=Su(ve,f)):Se<=f&&(c.expiredLanes|=ve),V&=~ve}}function fi(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function la(){var c=Oa;return Oa<<=1,(Oa&4194240)===0&&(Oa=64),c}function ca(c){for(var f=[],g=0;31>g;g++)f.push(c);return f}function Ms(c,f,g){c.pendingLanes|=f,f!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,f=31-ci(f),c[f]=g}function jn(c,f){var g=c.pendingLanes&~f;c.pendingLanes=f,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=f,c.mutableReadLanes&=f,c.entangledLanes&=f,f=c.entanglements;var _=c.eventTimes;for(c=c.expirationTimes;0<g;){var T=31-ci(g),V=1<<T;f[T]=0,_[T]=-1,c[T]=-1,g&=~V}}function Fs(c,f){var g=c.entangledLanes|=f;for(c=c.entanglements;g;){var _=31-ci(g),T=1<<_;T&f|c[_]&f&&(c[_]|=f),g&=~T}}var mn=0;function ss(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var ac,Au,uc,as,Ba,ha=!1,qo=[],Cn=null,Ho=null,go=null,Ht=new Map,vo=new Map,us=[],ls="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vl(c,f){switch(c){case"focusin":case"focusout":Cn=null;break;case"dragenter":case"dragleave":Ho=null;break;case"mouseover":case"mouseout":go=null;break;case"pointerover":case"pointerout":Ht.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":vo.delete(f.pointerId)}}function di(c,f,g,_,T,V){return c===null||c.nativeEvent!==V?(c={blockedOn:f,domEventName:g,eventSystemFlags:_,nativeEvent:V,targetContainers:[T]},f!==null&&(f=Ac(f),f!==null&&Au(f)),c):(c.eventSystemFlags|=_,f=c.targetContainers,T!==null&&f.indexOf(T)===-1&&f.push(T),c)}function Cu(c,f,g,_,T){switch(f){case"focusin":return Cn=di(Cn,c,f,g,_,T),!0;case"dragenter":return Ho=di(Ho,c,f,g,_,T),!0;case"mouseover":return go=di(go,c,f,g,_,T),!0;case"pointerover":var V=T.pointerId;return Ht.set(V,di(Ht.get(V)||null,c,f,g,_,T)),!0;case"gotpointercapture":return V=T.pointerId,vo.set(V,di(vo.get(V)||null,c,f,g,_,T)),!0}return!1}function Iu(c){var f=Fu(c.target);if(f!==null){var g=Ar(f);if(g!==null){if(f=g.tag,f===13){if(f=Ni(g),f!==null){c.blockedOn=f,Ba(c.priority,function(){uc(g)});return}}else if(f===3&&g.stateNode.current.memoizedState.isDehydrated){c.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Os(c){if(c.blockedOn!==null)return!1;for(var f=c.targetContainers;0<f.length;){var g=ja(c.domEventName,c.eventSystemFlags,f[0],c.nativeEvent);if(g===null){g=c.nativeEvent;var _=new g.constructor(g.type,g);gn=_,g.target.dispatchEvent(_),gn=null}else return f=Ac(g),f!==null&&Au(f),c.blockedOn=g,!1;f.shift()}return!0}function Va(c,f,g){Os(c)&&g.delete(f)}function lc(){ha=!1,Cn!==null&&Os(Cn)&&(Cn=null),Ho!==null&&Os(Ho)&&(Ho=null),go!==null&&Os(go)&&(go=null),Ht.forEach(Va),vo.forEach(Va)}function $i(c,f){c.blockedOn===f&&(c.blockedOn=null,ha||(ha=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,lc)))}function pi(c){function f(T){return $i(T,c)}if(0<qo.length){$i(qo[0],c);for(var g=1;g<qo.length;g++){var _=qo[g];_.blockedOn===c&&(_.blockedOn=null)}}for(Cn!==null&&$i(Cn,c),Ho!==null&&$i(Ho,c),go!==null&&$i(go,c),Ht.forEach(f),vo.forEach(f),g=0;g<us.length;g++)_=us[g],_.blockedOn===c&&(_.blockedOn=null);for(;0<us.length&&(g=us[0],g.blockedOn===null);)Iu(g),g.blockedOn===null&&us.shift()}var Pi=F.ReactCurrentBatchConfig,fa=!0;function Mn(c,f,g,_){var T=mn,V=Pi.transition;Pi.transition=null;try{mn=1,da(c,f,g,_)}finally{mn=T,Pi.transition=V}}function yl(c,f,g,_){var T=mn,V=Pi.transition;Pi.transition=null;try{mn=4,da(c,f,g,_)}finally{mn=T,Pi.transition=V}}function da(c,f,g,_){if(fa){var T=ja(c,f,g,_);if(T===null)Fh(c,f,_,pa,g),vl(c,_);else if(Cu(T,c,f,g,_))_.stopPropagation();else if(vl(c,_),f&4&&-1<ls.indexOf(c)){for(;T!==null;){var V=Ac(T);if(V!==null&&ac(V),V=ja(c,f,g,_),V===null&&Fh(c,f,_,pa,g),V===T)break;T=V}T!==null&&_.stopPropagation()}else Fh(c,f,_,null,g)}}var pa=null;function ja(c,f,g,_){if(pa=null,c=is(_),c=Fu(c),c!==null)if(f=Ar(c),f===null)c=null;else if(g=f.tag,g===13){if(c=Ni(f),c!==null)return c;c=null}else if(g===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;c=null}else f!==c&&(c=null);return pa=c,null}function Tu(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(oc()){case os:return 1;case Ls:return 4;case mo:case Ma:return 16;case sc:return 536870912;default:return 16}default:return 16}}var Ri=null,Ki=null,xr=null;function wl(){if(xr)return xr;var c,f=Ki,g=f.length,_,T="value"in Ri?Ri.value:Ri.textContent,V=T.length;for(c=0;c<g&&f[c]===T[c];c++);var Y=g-c;for(_=1;_<=Y&&f[g-_]===T[V-_];_++);return xr=T.slice(c,1<_?1-_:void 0)}function Go(c){var f=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&f===13&&(c=13)):c=f,c===10&&(c=13),32<=c||c===13?c:0}function Fr(){return!0}function Ua(){return!1}function hr(c){function f(g,_,T,V,Y){this._reactName=g,this._targetInst=T,this.type=_,this.nativeEvent=V,this.target=Y,this.currentTarget=null;for(var ve in c)c.hasOwnProperty(ve)&&(g=c[ve],this[ve]=g?g(V):V[ve]);return this.isDefaultPrevented=(V.defaultPrevented!=null?V.defaultPrevented:V.returnValue===!1)?Fr:Ua,this.isPropagationStopped=Ua,this}return se(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Fr)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Fr)},persist:function(){},isPersistent:Fr}),f}var $o={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bs=hr($o),cs=se({},$o,{view:0,detail:0}),bl=hr(cs),ma,hs,Ko,Vs=se({},cs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mt,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Ko&&(Ko&&c.type==="mousemove"?(ma=c.screenX-Ko.screenX,hs=c.screenY-Ko.screenY):hs=ma=0,Ko=c),ma)},movementY:function(c){return"movementY"in c?c.movementY:hs}}),ga=hr(Vs),ku=se({},Vs,{dataTransfer:0}),cc=hr(ku),js=se({},cs,{relatedTarget:0}),fs=hr(js),Nu=se({},$o,{animationName:0,elapsedTime:0,pseudoElement:0}),Di=hr(Nu),Pu=se({},$o,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),I=hr(Pu),G=se({},$o,{data:0}),me=hr(G),we={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Re={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},He={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rt(c){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(c):(c=He[c])?!!f[c]:!1}function mt(){return rt}var y=se({},cs,{key:function(c){if(c.key){var f=we[c.key]||c.key;if(f!=="Unidentified")return f}return c.type==="keypress"?(c=Go(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?Re[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mt,charCode:function(c){return c.type==="keypress"?Go(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Go(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),O=hr(y),q=se({},Vs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ee=hr(q),Ne=se({},cs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mt}),Fe=hr(Ne),it=se({},$o,{propertyName:0,elapsedTime:0,pseudoElement:0}),on=hr(it),vn=se({},Vs,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),sn=hr(vn),Fn=[9,13,27,32],Un=a&&"CompositionEvent"in window,Xi=null;a&&"documentMode"in document&&(Xi=document.documentMode);var mi=a&&"TextEvent"in window&&!Xi,Us=a&&(!Un||Xi&&8<Xi&&11>=Xi),zs=" ",hc=!1;function fc(c,f){switch(c){case"keyup":return Fn.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xl(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var _r=!1;function dc(c,f){switch(c){case"compositionend":return xl(f);case"keypress":return f.which!==32?null:(hc=!0,zs);case"textInput":return c=f.data,c===zs&&hc?null:c;default:return null}}function pc(c,f){if(_r)return c==="compositionend"||!Un&&fc(c,f)?(c=wl(),xr=Ki=Ri=null,_r=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return Us&&f.locale!=="ko"?null:f.data;default:return null}}var mc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gc(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f==="input"?!!mc[c.type]:f==="textarea"}function Yi(c,f,g,_){Wt(_),f=Lf(f,"onChange"),0<f.length&&(g=new Bs("onChange","change",null,g,_),c.push({event:g,listeners:f}))}var _l=null,za=null;function Pf(c){Lh(c,0)}function Ji(c){var f=Pl(c);if(et(f))return c}function vc(c,f){if(c==="change")return f}var Nh=!1;if(a){var yc;if(a){var va="oninput"in document;if(!va){var Ru=document.createElement("div");Ru.setAttribute("oninput","return;"),va=typeof Ru.oninput=="function"}yc=va}else yc=!1;Nh=yc&&(!document.documentMode||9<document.documentMode)}function Qi(){_l&&(_l.detachEvent("onpropertychange",Li),za=_l=null)}function Li(c){if(c.propertyName==="value"&&Ji(za)){var f=[];Yi(f,za,c,is(c)),fo(Pf,f)}}function Du(c,f,g){c==="focusin"?(Qi(),_l=f,za=g,_l.attachEvent("onpropertychange",Li)):c==="focusout"&&Qi()}function Wa(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Ji(za)}function qa(c,f){if(c==="click")return Ji(f)}function wc(c,f){if(c==="input"||c==="change")return Ji(f)}function Ha(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var Rn=typeof Object.is=="function"?Object.is:Ha;function Ga(c,f){if(Rn(c,f))return!0;if(typeof c!="object"||c===null||typeof f!="object"||f===null)return!1;var g=Object.keys(c),_=Object.keys(f);if(g.length!==_.length)return!1;for(_=0;_<g.length;_++){var T=g[_];if(!u.call(f,T)||!Rn(c[T],f[T]))return!1}return!0}function Mi(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function Xo(c,f){var g=Mi(c);c=0;for(var _;g;){if(g.nodeType===3){if(_=c+g.textContent.length,c<=f&&_>=f)return{node:g,offset:f-c};c=_}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=Mi(g)}}function El(c,f){return c&&f?c===f?!0:c&&c.nodeType===3?!1:f&&f.nodeType===3?El(c,f.parentNode):"contains"in c?c.contains(f):c.compareDocumentPosition?!!(c.compareDocumentPosition(f)&16):!1:!1}function Ph(){for(var c=window,f=Je();f instanceof c.HTMLIFrameElement;){try{var g=typeof f.contentWindow.location.href=="string"}catch{g=!1}if(g)c=f.contentWindow;else break;f=Je(c.document)}return f}function Sl(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f&&(f==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||f==="textarea"||c.contentEditable==="true")}function Al(c){var f=Ph(),g=c.focusedElem,_=c.selectionRange;if(f!==g&&g&&g.ownerDocument&&El(g.ownerDocument.documentElement,g)){if(_!==null&&Sl(g)){if(f=_.start,c=_.end,c===void 0&&(c=f),"selectionStart"in g)g.selectionStart=f,g.selectionEnd=Math.min(c,g.value.length);else if(c=(f=g.ownerDocument||document)&&f.defaultView||window,c.getSelection){c=c.getSelection();var T=g.textContent.length,V=Math.min(_.start,T);_=_.end===void 0?V:Math.min(_.end,T),!c.extend&&V>_&&(T=_,_=V,V=T),T=Xo(g,V);var Y=Xo(g,_);T&&Y&&(c.rangeCount!==1||c.anchorNode!==T.node||c.anchorOffset!==T.offset||c.focusNode!==Y.node||c.focusOffset!==Y.offset)&&(f=f.createRange(),f.setStart(T.node,T.offset),c.removeAllRanges(),V>_?(c.addRange(f),c.extend(Y.node,Y.offset)):(f.setEnd(Y.node,Y.offset),c.addRange(f)))}}for(f=[],c=g;c=c.parentNode;)c.nodeType===1&&f.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<f.length;g++)c=f[g],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var Cl=a&&"documentMode"in document&&11>=document.documentMode,Yo=null,$a=null,ya=null,Ka=!1;function Xa(c,f,g){var _=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Ka||Yo==null||Yo!==Je(_)||(_=Yo,"selectionStart"in _&&Sl(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),ya&&Ga(ya,_)||(ya=_,_=Lf($a,"onSelect"),0<_.length&&(f=new Bs("onSelect","select",null,f,g),c.push({event:f,listeners:_}),f.target=Yo)))}function Lu(c,f){var g={};return g[c.toLowerCase()]=f.toLowerCase(),g["Webkit"+c]="webkit"+f,g["Moz"+c]="moz"+f,g}var gi={animationend:Lu("Animation","AnimationEnd"),animationiteration:Lu("Animation","AnimationIteration"),animationstart:Lu("Animation","AnimationStart"),transitionend:Lu("Transition","TransitionEnd")},yo={},Zn={};a&&(Zn=document.createElement("div").style,"AnimationEvent"in window||(delete gi.animationend.animation,delete gi.animationiteration.animation,delete gi.animationstart.animation),"TransitionEvent"in window||delete gi.transitionend.transition);function zn(c){if(yo[c])return yo[c];if(!gi[c])return c;var f=gi[c],g;for(g in f)if(f.hasOwnProperty(g)&&g in Zn)return yo[c]=f[g];return c}var Er=zn("animationend"),Or=zn("animationiteration"),wa=zn("animationstart"),bc=zn("transitionend"),Il=new Map,Rh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ba(c,f){Il.set(c,f),o(f,[c])}for(var xc=0;xc<Rh.length;xc++){var Zi=Rh[xc],ds=Zi.toLowerCase(),Rf=Zi[0].toUpperCase()+Zi.slice(1);ba(ds,"on"+Rf)}ba(Er,"onAnimationEnd"),ba(Or,"onAnimationIteration"),ba(wa,"onAnimationStart"),ba("dblclick","onDoubleClick"),ba("focusin","onFocus"),ba("focusout","onBlur"),ba(bc,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zm=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mu));function Dh(c,f,g){var _=c.type||"unknown-event";c.currentTarget=g,po(_,f,void 0,c),c.currentTarget=null}function Lh(c,f){f=(f&4)!==0;for(var g=0;g<c.length;g++){var _=c[g],T=_.event;_=_.listeners;e:{var V=void 0;if(f)for(var Y=_.length-1;0<=Y;Y--){var ve=_[Y],Se=ve.instance,je=ve.currentTarget;if(ve=ve.listener,Se!==V&&T.isPropagationStopped())break e;Dh(T,ve,je),V=Se}else for(Y=0;Y<_.length;Y++){if(ve=_[Y],Se=ve.instance,je=ve.currentTarget,ve=ve.listener,Se!==V&&T.isPropagationStopped())break e;Dh(T,ve,je),V=Se}}}if(cr)throw c=ia,cr=!1,ia=null,c}function er(c,f){var g=f[bo];g===void 0&&(g=f[bo]=new Set);var _=c+"__bubble";g.has(_)||(Mh(f,c,2,!1),g.add(_))}function Df(c,f,g){var _=0;f&&(_|=4),Mh(g,c,_,f)}var _c="_reactListening"+Math.random().toString(36).slice(2);function Tl(c){if(!c[_c]){c[_c]=!0,r.forEach(function(g){g!=="selectionchange"&&(Zm.has(g)||Df(g,!1,c),Df(g,!0,c))});var f=c.nodeType===9?c:c.ownerDocument;f===null||f[_c]||(f[_c]=!0,Df("selectionchange",!1,f))}}function Mh(c,f,g,_){switch(Tu(f)){case 1:var T=Mn;break;case 4:T=yl;break;default:T=da}g=T.bind(null,f,g,c),T=void 0,!Ti||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(T=!0),_?T!==void 0?c.addEventListener(f,g,{capture:!0,passive:T}):c.addEventListener(f,g,!0):T!==void 0?c.addEventListener(f,g,{passive:T}):c.addEventListener(f,g,!1)}function Fh(c,f,g,_,T){var V=_;if((f&1)===0&&(f&2)===0&&_!==null)e:for(;;){if(_===null)return;var Y=_.tag;if(Y===3||Y===4){var ve=_.stateNode.containerInfo;if(ve===T||ve.nodeType===8&&ve.parentNode===T)break;if(Y===4)for(Y=_.return;Y!==null;){var Se=Y.tag;if((Se===3||Se===4)&&(Se=Y.stateNode.containerInfo,Se===T||Se.nodeType===8&&Se.parentNode===T))return;Y=Y.return}for(;ve!==null;){if(Y=Fu(ve),Y===null)return;if(Se=Y.tag,Se===5||Se===6){_=V=Y;continue e}ve=ve.parentNode}}_=_.return}fo(function(){var je=V,st=is(g),ut=[];e:{var ot=Il.get(c);if(ot!==void 0){var Et=Bs,It=c;switch(c){case"keypress":if(Go(g)===0)break e;case"keydown":case"keyup":Et=O;break;case"focusin":It="focus",Et=fs;break;case"focusout":It="blur",Et=fs;break;case"beforeblur":case"afterblur":Et=fs;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Et=ga;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Et=cc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Et=Fe;break;case Er:case Or:case wa:Et=Di;break;case bc:Et=on;break;case"scroll":Et=bl;break;case"wheel":Et=sn;break;case"copy":case"cut":case"paste":Et=I;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Et=ee}var Rt=(f&4)!==0,Kr=!Rt&&c==="scroll",Me=Rt?ot!==null?ot+"Capture":null:ot;Rt=[];for(var ke=je,Oe;ke!==null;){Oe=ke;var ht=Oe.stateNode;if(Oe.tag===5&&ht!==null&&(Oe=ht,Me!==null&&(ht=_t(ke,Me),ht!=null&&Rt.push(Oh(ke,ht,Oe)))),Kr)break;ke=ke.return}0<Rt.length&&(ot=new Et(ot,It,null,g,st),ut.push({event:ot,listeners:Rt}))}}if((f&7)===0){e:{if(ot=c==="mouseover"||c==="pointerover",Et=c==="mouseout"||c==="pointerout",ot&&g!==gn&&(It=g.relatedTarget||g.fromElement)&&(Fu(It)||It[Fi]))break e;if((Et||ot)&&(ot=st.window===st?st:(ot=st.ownerDocument)?ot.defaultView||ot.parentWindow:window,Et?(It=g.relatedTarget||g.toElement,Et=je,It=It?Fu(It):null,It!==null&&(Kr=Ar(It),It!==Kr||It.tag!==5&&It.tag!==6)&&(It=null)):(Et=null,It=je),Et!==It)){if(Rt=ga,ht="onMouseLeave",Me="onMouseEnter",ke="mouse",(c==="pointerout"||c==="pointerover")&&(Rt=ee,ht="onPointerLeave",Me="onPointerEnter",ke="pointer"),Kr=Et==null?ot:Pl(Et),Oe=It==null?ot:Pl(It),ot=new Rt(ht,ke+"leave",Et,g,st),ot.target=Kr,ot.relatedTarget=Oe,ht=null,Fu(st)===je&&(Rt=new Rt(Me,ke+"enter",It,g,st),Rt.target=Oe,Rt.relatedTarget=Kr,ht=Rt),Kr=ht,Et&&It)t:{for(Rt=Et,Me=It,ke=0,Oe=Rt;Oe;Oe=kl(Oe))ke++;for(Oe=0,ht=Me;ht;ht=kl(ht))Oe++;for(;0<ke-Oe;)Rt=kl(Rt),ke--;for(;0<Oe-ke;)Me=kl(Me),Oe--;for(;ke--;){if(Rt===Me||Me!==null&&Rt===Me.alternate)break t;Rt=kl(Rt),Me=kl(Me)}Rt=null}else Rt=null;Et!==null&&eg(ut,ot,Et,Rt,!1),It!==null&&Kr!==null&&eg(ut,Kr,It,Rt,!0)}}e:{if(ot=je?Pl(je):window,Et=ot.nodeName&&ot.nodeName.toLowerCase(),Et==="select"||Et==="input"&&ot.type==="file")var Mt=vc;else if(gc(ot))if(Nh)Mt=wc;else{Mt=Wa;var Gt=Du}else(Et=ot.nodeName)&&Et.toLowerCase()==="input"&&(ot.type==="checkbox"||ot.type==="radio")&&(Mt=qa);if(Mt&&(Mt=Mt(c,je))){Yi(ut,Mt,g,st);break e}Gt&&Gt(c,ot,je),c==="focusout"&&(Gt=ot._wrapperState)&&Gt.controlled&&ot.type==="number"&&Ze(ot,"number",ot.value)}switch(Gt=je?Pl(je):window,c){case"focusin":(gc(Gt)||Gt.contentEditable==="true")&&(Yo=Gt,$a=je,ya=null);break;case"focusout":ya=$a=Yo=null;break;case"mousedown":Ka=!0;break;case"contextmenu":case"mouseup":case"dragend":Ka=!1,Xa(ut,g,st);break;case"selectionchange":if(Cl)break;case"keydown":case"keyup":Xa(ut,g,st)}var $t;if(Un)e:{switch(c){case"compositionstart":var nn="onCompositionStart";break e;case"compositionend":nn="onCompositionEnd";break e;case"compositionupdate":nn="onCompositionUpdate";break e}nn=void 0}else _r?fc(c,g)&&(nn="onCompositionEnd"):c==="keydown"&&g.keyCode===229&&(nn="onCompositionStart");nn&&(Us&&g.locale!=="ko"&&(_r||nn!=="onCompositionStart"?nn==="onCompositionEnd"&&_r&&($t=wl()):(Ri=st,Ki="value"in Ri?Ri.value:Ri.textContent,_r=!0)),Gt=Lf(je,nn),0<Gt.length&&(nn=new me(nn,c,null,g,st),ut.push({event:nn,listeners:Gt}),$t?nn.data=$t:($t=xl(g),$t!==null&&(nn.data=$t)))),($t=mi?dc(c,g):pc(c,g))&&(je=Lf(je,"onBeforeInput"),0<je.length&&(st=new me("onBeforeInput","beforeinput",null,g,st),ut.push({event:st,listeners:je}),st.data=$t))}Lh(ut,f)})}function Oh(c,f,g){return{instance:c,listener:f,currentTarget:g}}function Lf(c,f){for(var g=f+"Capture",_=[];c!==null;){var T=c,V=T.stateNode;T.tag===5&&V!==null&&(T=V,V=_t(c,g),V!=null&&_.unshift(Oh(c,V,T)),V=_t(c,f),V!=null&&_.push(Oh(c,V,T))),c=c.return}return _}function kl(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function eg(c,f,g,_,T){for(var V=f._reactName,Y=[];g!==null&&g!==_;){var ve=g,Se=ve.alternate,je=ve.stateNode;if(Se!==null&&Se===_)break;ve.tag===5&&je!==null&&(ve=je,T?(Se=_t(g,V),Se!=null&&Y.unshift(Oh(g,Se,ve))):T||(Se=_t(g,V),Se!=null&&Y.push(Oh(g,Se,ve)))),g=g.return}Y.length!==0&&c.push({event:f,listeners:Y})}var s1=/\r\n?/g,a1=/\u0000|\uFFFD/g;function tg(c){return(typeof c=="string"?c:""+c).replace(s1,`
`).replace(a1,"")}function Mf(c,f,g){if(f=tg(f),tg(c)!==f&&g)throw Error(t(425))}function Ec(){}var Bh=null,Nl=null;function fp(c,f){return c==="textarea"||c==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var dp=typeof setTimeout=="function"?setTimeout:void 0,ng=typeof clearTimeout=="function"?clearTimeout:void 0,rg=typeof Promise=="function"?Promise:void 0,u1=typeof queueMicrotask=="function"?queueMicrotask:typeof rg<"u"?function(c){return rg.resolve(null).then(c).catch(l1)}:dp;function l1(c){setTimeout(function(){throw c})}function pp(c,f){var g=f,_=0;do{var T=g.nextSibling;if(c.removeChild(g),T&&T.nodeType===8)if(g=T.data,g==="/$"){if(_===0){c.removeChild(T),pi(f);return}_--}else g!=="$"&&g!=="$?"&&g!=="$!"||_++;g=T}while(g);pi(f)}function eo(c){for(;c!=null;c=c.nextSibling){var f=c.nodeType;if(f===1||f===3)break;if(f===8){if(f=c.data,f==="$"||f==="$!"||f==="$?")break;if(f==="/$")return null}}return c}function ps(c){c=c.previousSibling;for(var f=0;c;){if(c.nodeType===8){var g=c.data;if(g==="$"||g==="$!"||g==="$?"){if(f===0)return c;f--}else g==="/$"&&f++}c=c.previousSibling}return null}var wo=Math.random().toString(36).slice(2),xa="__reactFiber$"+wo,Sc="__reactProps$"+wo,Fi="__reactContainer$"+wo,bo="__reactEvents$"+wo,c1="__reactListeners$"+wo,h1="__reactHandles$"+wo;function Fu(c){var f=c[xa];if(f)return f;for(var g=c.parentNode;g;){if(f=g[Fi]||g[xa]){if(g=f.alternate,f.child!==null||g!==null&&g.child!==null)for(c=ps(c);c!==null;){if(g=c[xa])return g;c=ps(c)}return f}c=g,g=c.parentNode}return null}function Ac(c){return c=c[xa]||c[Fi],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Pl(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function Vh(c){return c[Sc]||null}var mp=[],Ya=-1;function Ws(c){return{current:c}}function Wn(c){0>Ya||(c.current=mp[Ya],mp[Ya]=null,Ya--)}function Kn(c,f){Ya++,mp[Ya]=c.current,c.current=f}var Ou={},vi=Ws(Ou),xo=Ws(!1),Rl=Ou;function Cc(c,f){var g=c.type.contextTypes;if(!g)return Ou;var _=c.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===f)return _.__reactInternalMemoizedMaskedChildContext;var T={},V;for(V in g)T[V]=f[V];return _&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=f,c.__reactInternalMemoizedMaskedChildContext=T),T}function _o(c){return c=c.childContextTypes,c!=null}function Ff(){Wn(xo),Wn(vi)}function ig(c,f,g){if(vi.current!==Ou)throw Error(t(168));Kn(vi,f),Kn(xo,g)}function gp(c,f,g){var _=c.stateNode;if(f=f.childContextTypes,typeof _.getChildContext!="function")return g;_=_.getChildContext();for(var T in _)if(!(T in f))throw Error(t(108,ye(c)||"Unknown",T));return se({},g,_)}function Dl(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||Ou,Rl=vi.current,Kn(vi,c),Kn(xo,xo.current),!0}function og(c,f,g){var _=c.stateNode;if(!_)throw Error(t(169));g?(c=gp(c,f,Rl),_.__reactInternalMemoizedMergedChildContext=c,Wn(xo),Wn(vi),Kn(vi,c)):Wn(xo),Kn(xo,g)}var Ja=null,jh=!1,v=!1;function S(c){Ja===null?Ja=[c]:Ja.push(c)}function P(c){jh=!0,S(c)}function z(){if(!v&&Ja!==null){v=!0;var c=0,f=mn;try{var g=Ja;for(mn=1;c<g.length;c++){var _=g[c];do _=_(!0);while(_!==null)}Ja=null,jh=!1}catch(T){throw Ja!==null&&(Ja=Ja.slice(c+1)),Ds(os,z),T}finally{mn=f,v=!1}}return null}var H=[],X=0,Q=null,Z=0,te=[],ue=0,Ee=null,De=1,Le="";function Pe(c,f){H[X++]=Z,H[X++]=Q,Q=c,Z=f}function Qe(c,f,g){te[ue++]=De,te[ue++]=Le,te[ue++]=Ee,Ee=c;var _=De;c=Le;var T=32-ci(_)-1;_&=~(1<<T),g+=1;var V=32-ci(f)+T;if(30<V){var Y=T-T%5;V=(_&(1<<Y)-1).toString(32),_>>=Y,T-=Y,De=1<<32-ci(f)+T|g<<T|_,Le=V+c}else De=1<<V|g<<T|_,Le=c}function ze(c){c.return!==null&&(Pe(c,1),Qe(c,1,0))}function Ce(c){for(;c===Q;)Q=H[--X],H[X]=null,Z=H[--X],H[X]=null;for(;c===Ee;)Ee=te[--ue],te[ue]=null,Le=te[--ue],te[ue]=null,De=te[--ue],te[ue]=null}var Ie=null,Ke=null,Ge=!1,Xe=null;function bt(c,f){var g=Ia(5,null,null,0);g.elementType="DELETED",g.stateNode=f,g.return=c,f=c.deletions,f===null?(c.deletions=[g],c.flags|=16):f.push(g)}function gt(c,f){switch(c.tag){case 5:var g=c.type;return f=f.nodeType!==1||g.toLowerCase()!==f.nodeName.toLowerCase()?null:f,f!==null?(c.stateNode=f,Ie=c,Ke=eo(f.firstChild),!0):!1;case 6:return f=c.pendingProps===""||f.nodeType!==3?null:f,f!==null?(c.stateNode=f,Ie=c,Ke=null,!0):!1;case 13:return f=f.nodeType!==8?null:f,f!==null?(g=Ee!==null?{id:De,overflow:Le}:null,c.memoizedState={dehydrated:f,treeContext:g,retryLane:1073741824},g=Ia(18,null,null,0),g.stateNode=f,g.return=c,c.child=g,Ie=c,Ke=null,!0):!1;default:return!1}}function zt(c){return(c.mode&1)!==0&&(c.flags&128)===0}function yt(c){if(Ge){var f=Ke;if(f){var g=f;if(!gt(c,f)){if(zt(c))throw Error(t(418));f=eo(g.nextSibling);var _=Ie;f&&gt(c,f)?bt(_,g):(c.flags=c.flags&-4097|2,Ge=!1,Ie=c)}}else{if(zt(c))throw Error(t(418));c.flags=c.flags&-4097|2,Ge=!1,Ie=c}}}function In(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Ie=c}function Tn(c){if(c!==Ie)return!1;if(!Ge)return In(c),Ge=!0,!1;var f;if((f=c.tag!==3)&&!(f=c.tag!==5)&&(f=c.type,f=f!=="head"&&f!=="body"&&!fp(c.type,c.memoizedProps)),f&&(f=Ke)){if(zt(c))throw Sn(),Error(t(418));for(;f;)bt(c,f),f=eo(f.nextSibling)}if(In(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,f=0;c;){if(c.nodeType===8){var g=c.data;if(g==="/$"){if(f===0){Ke=eo(c.nextSibling);break e}f--}else g!=="$"&&g!=="$!"&&g!=="$?"||f++}c=c.nextSibling}Ke=null}}else Ke=Ie?eo(c.stateNode.nextSibling):null;return!0}function Sn(){for(var c=Ke;c;)c=eo(c.nextSibling)}function hn(){Ke=Ie=null,Ge=!1}function qn(c){Xe===null?Xe=[c]:Xe.push(c)}var Xn=F.ReactCurrentBatchConfig;function tn(c,f,g){if(c=g.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(t(309));var _=g.stateNode}if(!_)throw Error(t(147,c));var T=_,V=""+c;return f!==null&&f.ref!==null&&typeof f.ref=="function"&&f.ref._stringRef===V?f.ref:(f=function(Y){var ve=T.refs;Y===null?delete ve[V]:ve[V]=Y},f._stringRef=V,f)}if(typeof c!="string")throw Error(t(284));if(!g._owner)throw Error(t(290,c))}return c}function fr(c,f){throw c=Object.prototype.toString.call(f),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":c))}function to(c){var f=c._init;return f(c._payload)}function Cr(c){function f(Me,ke){if(c){var Oe=Me.deletions;Oe===null?(Me.deletions=[ke],Me.flags|=16):Oe.push(ke)}}function g(Me,ke){if(!c)return null;for(;ke!==null;)f(Me,ke),ke=ke.sibling;return null}function _(Me,ke){for(Me=new Map;ke!==null;)ke.key!==null?Me.set(ke.key,ke):Me.set(ke.index,ke),ke=ke.sibling;return Me}function T(Me,ke){return Me=Bc(Me,ke),Me.index=0,Me.sibling=null,Me}function V(Me,ke,Oe){return Me.index=Oe,c?(Oe=Me.alternate,Oe!==null?(Oe=Oe.index,Oe<ke?(Me.flags|=2,ke):Oe):(Me.flags|=2,ke)):(Me.flags|=1048576,ke)}function Y(Me){return c&&Me.alternate===null&&(Me.flags|=2),Me}function ve(Me,ke,Oe,ht){return ke===null||ke.tag!==6?(ke=j1(Oe,Me.mode,ht),ke.return=Me,ke):(ke=T(ke,Oe),ke.return=Me,ke)}function Se(Me,ke,Oe,ht){var Mt=Oe.type;return Mt===k?st(Me,ke,Oe.props.children,ht,Oe.key):ke!==null&&(ke.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===fe&&to(Mt)===ke.type)?(ht=T(ke,Oe.props),ht.ref=tn(Me,ke,Oe),ht.return=Me,ht):(ht=Ag(Oe.type,Oe.key,Oe.props,null,Me.mode,ht),ht.ref=tn(Me,ke,Oe),ht.return=Me,ht)}function je(Me,ke,Oe,ht){return ke===null||ke.tag!==4||ke.stateNode.containerInfo!==Oe.containerInfo||ke.stateNode.implementation!==Oe.implementation?(ke=U1(Oe,Me.mode,ht),ke.return=Me,ke):(ke=T(ke,Oe.children||[]),ke.return=Me,ke)}function st(Me,ke,Oe,ht,Mt){return ke===null||ke.tag!==7?(ke=Kh(Oe,Me.mode,ht,Mt),ke.return=Me,ke):(ke=T(ke,Oe),ke.return=Me,ke)}function ut(Me,ke,Oe){if(typeof ke=="string"&&ke!==""||typeof ke=="number")return ke=j1(""+ke,Me.mode,Oe),ke.return=Me,ke;if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case D:return Oe=Ag(ke.type,ke.key,ke.props,null,Me.mode,Oe),Oe.ref=tn(Me,null,ke),Oe.return=Me,Oe;case W:return ke=U1(ke,Me.mode,Oe),ke.return=Me,ke;case fe:var ht=ke._init;return ut(Me,ht(ke._payload),Oe)}if(at(ke)||le(ke))return ke=Kh(ke,Me.mode,Oe,null),ke.return=Me,ke;fr(Me,ke)}return null}function ot(Me,ke,Oe,ht){var Mt=ke!==null?ke.key:null;if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number")return Mt!==null?null:ve(Me,ke,""+Oe,ht);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case D:return Oe.key===Mt?Se(Me,ke,Oe,ht):null;case W:return Oe.key===Mt?je(Me,ke,Oe,ht):null;case fe:return Mt=Oe._init,ot(Me,ke,Mt(Oe._payload),ht)}if(at(Oe)||le(Oe))return Mt!==null?null:st(Me,ke,Oe,ht,null);fr(Me,Oe)}return null}function Et(Me,ke,Oe,ht,Mt){if(typeof ht=="string"&&ht!==""||typeof ht=="number")return Me=Me.get(Oe)||null,ve(ke,Me,""+ht,Mt);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case D:return Me=Me.get(ht.key===null?Oe:ht.key)||null,Se(ke,Me,ht,Mt);case W:return Me=Me.get(ht.key===null?Oe:ht.key)||null,je(ke,Me,ht,Mt);case fe:var Gt=ht._init;return Et(Me,ke,Oe,Gt(ht._payload),Mt)}if(at(ht)||le(ht))return Me=Me.get(Oe)||null,st(ke,Me,ht,Mt,null);fr(ke,ht)}return null}function It(Me,ke,Oe,ht){for(var Mt=null,Gt=null,$t=ke,nn=ke=0,ji=null;$t!==null&&nn<Oe.length;nn++){$t.index>nn?(ji=$t,$t=null):ji=$t.sibling;var Vn=ot(Me,$t,Oe[nn],ht);if(Vn===null){$t===null&&($t=ji);break}c&&$t&&Vn.alternate===null&&f(Me,$t),ke=V(Vn,ke,nn),Gt===null?Mt=Vn:Gt.sibling=Vn,Gt=Vn,$t=ji}if(nn===Oe.length)return g(Me,$t),Ge&&Pe(Me,nn),Mt;if($t===null){for(;nn<Oe.length;nn++)$t=ut(Me,Oe[nn],ht),$t!==null&&(ke=V($t,ke,nn),Gt===null?Mt=$t:Gt.sibling=$t,Gt=$t);return Ge&&Pe(Me,nn),Mt}for($t=_(Me,$t);nn<Oe.length;nn++)ji=Et($t,Me,nn,Oe[nn],ht),ji!==null&&(c&&ji.alternate!==null&&$t.delete(ji.key===null?nn:ji.key),ke=V(ji,ke,nn),Gt===null?Mt=ji:Gt.sibling=ji,Gt=ji);return c&&$t.forEach(function(Vc){return f(Me,Vc)}),Ge&&Pe(Me,nn),Mt}function Rt(Me,ke,Oe,ht){var Mt=le(Oe);if(typeof Mt!="function")throw Error(t(150));if(Oe=Mt.call(Oe),Oe==null)throw Error(t(151));for(var Gt=Mt=null,$t=ke,nn=ke=0,ji=null,Vn=Oe.next();$t!==null&&!Vn.done;nn++,Vn=Oe.next()){$t.index>nn?(ji=$t,$t=null):ji=$t.sibling;var Vc=ot(Me,$t,Vn.value,ht);if(Vc===null){$t===null&&($t=ji);break}c&&$t&&Vc.alternate===null&&f(Me,$t),ke=V(Vc,ke,nn),Gt===null?Mt=Vc:Gt.sibling=Vc,Gt=Vc,$t=ji}if(Vn.done)return g(Me,$t),Ge&&Pe(Me,nn),Mt;if($t===null){for(;!Vn.done;nn++,Vn=Oe.next())Vn=ut(Me,Vn.value,ht),Vn!==null&&(ke=V(Vn,ke,nn),Gt===null?Mt=Vn:Gt.sibling=Vn,Gt=Vn);return Ge&&Pe(Me,nn),Mt}for($t=_(Me,$t);!Vn.done;nn++,Vn=Oe.next())Vn=Et($t,Me,nn,Vn.value,ht),Vn!==null&&(c&&Vn.alternate!==null&&$t.delete(Vn.key===null?nn:Vn.key),ke=V(Vn,ke,nn),Gt===null?Mt=Vn:Gt.sibling=Vn,Gt=Vn);return c&&$t.forEach(function(EP){return f(Me,EP)}),Ge&&Pe(Me,nn),Mt}function Kr(Me,ke,Oe,ht){if(typeof Oe=="object"&&Oe!==null&&Oe.type===k&&Oe.key===null&&(Oe=Oe.props.children),typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case D:e:{for(var Mt=Oe.key,Gt=ke;Gt!==null;){if(Gt.key===Mt){if(Mt=Oe.type,Mt===k){if(Gt.tag===7){g(Me,Gt.sibling),ke=T(Gt,Oe.props.children),ke.return=Me,Me=ke;break e}}else if(Gt.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===fe&&to(Mt)===Gt.type){g(Me,Gt.sibling),ke=T(Gt,Oe.props),ke.ref=tn(Me,Gt,Oe),ke.return=Me,Me=ke;break e}g(Me,Gt);break}else f(Me,Gt);Gt=Gt.sibling}Oe.type===k?(ke=Kh(Oe.props.children,Me.mode,ht,Oe.key),ke.return=Me,Me=ke):(ht=Ag(Oe.type,Oe.key,Oe.props,null,Me.mode,ht),ht.ref=tn(Me,ke,Oe),ht.return=Me,Me=ht)}return Y(Me);case W:e:{for(Gt=Oe.key;ke!==null;){if(ke.key===Gt)if(ke.tag===4&&ke.stateNode.containerInfo===Oe.containerInfo&&ke.stateNode.implementation===Oe.implementation){g(Me,ke.sibling),ke=T(ke,Oe.children||[]),ke.return=Me,Me=ke;break e}else{g(Me,ke);break}else f(Me,ke);ke=ke.sibling}ke=U1(Oe,Me.mode,ht),ke.return=Me,Me=ke}return Y(Me);case fe:return Gt=Oe._init,Kr(Me,ke,Gt(Oe._payload),ht)}if(at(Oe))return It(Me,ke,Oe,ht);if(le(Oe))return Rt(Me,ke,Oe,ht);fr(Me,Oe)}return typeof Oe=="string"&&Oe!==""||typeof Oe=="number"?(Oe=""+Oe,ke!==null&&ke.tag===6?(g(Me,ke.sibling),ke=T(ke,Oe),ke.return=Me,Me=ke):(g(Me,ke),ke=j1(Oe,Me.mode,ht),ke.return=Me,Me=ke),Y(Me)):g(Me,ke)}return Kr}var Hr=Cr(!0),On=Cr(!1),Oi=Ws(null),Bi=null,dr=null,Gr=null;function yi(){Gr=dr=Bi=null}function Eo(c){var f=Oi.current;Wn(Oi),c._currentValue=f}function ms(c,f,g){for(;c!==null;){var _=c.alternate;if((c.childLanes&f)!==f?(c.childLanes|=f,_!==null&&(_.childLanes|=f)):_!==null&&(_.childLanes&f)!==f&&(_.childLanes|=f),c===g)break;c=c.return}}function pr(c,f){Bi=c,Gr=dr=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&f)!==0&&(ws=!0),c.firstContext=null)}function Br(c){var f=c._currentValue;if(Gr!==c)if(c={context:c,memoizedValue:f,next:null},dr===null){if(Bi===null)throw Error(t(308));dr=c,Bi.dependencies={lanes:0,firstContext:c}}else dr=dr.next=c;return f}var Jo=null;function Bu(c){Jo===null?Jo=[c]:Jo.push(c)}function Qa(c,f,g,_){var T=f.interleaved;return T===null?(g.next=g,Bu(f)):(g.next=T.next,T.next=g),f.interleaved=g,Bn(c,_)}function Bn(c,f){c.lanes|=f;var g=c.alternate;for(g!==null&&(g.lanes|=f),g=c,c=c.return;c!==null;)c.childLanes|=f,g=c.alternate,g!==null&&(g.childLanes|=f),g=c,c=c.return;return g.tag===3?g.stateNode:null}var _a=!1;function Of(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vp(c,f){c=c.updateQueue,f.updateQueue===c&&(f.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function gs(c,f){return{eventTime:c,lane:f,tag:0,payload:null,callback:null,next:null}}function vs(c,f,g){var _=c.updateQueue;if(_===null)return null;if(_=_.shared,(Dn&2)!==0){var T=_.pending;return T===null?f.next=f:(f.next=T.next,T.next=f),_.pending=f,Bn(c,g)}return T=_.interleaved,T===null?(f.next=f,Bu(_)):(f.next=T.next,T.next=f),_.interleaved=f,Bn(c,g)}function Ll(c,f,g){if(f=f.updateQueue,f!==null&&(f=f.shared,(g&4194240)!==0)){var _=f.lanes;_&=c.pendingLanes,g|=_,f.lanes=g,Fs(c,g)}}function ys(c,f){var g=c.updateQueue,_=c.alternate;if(_!==null&&(_=_.updateQueue,g===_)){var T=null,V=null;if(g=g.firstBaseUpdate,g!==null){do{var Y={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};V===null?T=V=Y:V=V.next=Y,g=g.next}while(g!==null);V===null?T=V=f:V=V.next=f}else T=V=f;g={baseState:_.baseState,firstBaseUpdate:T,lastBaseUpdate:V,shared:_.shared,effects:_.effects},c.updateQueue=g;return}c=g.lastBaseUpdate,c===null?g.firstBaseUpdate=f:c.next=f,g.lastBaseUpdate=f}function Za(c,f,g,_){var T=c.updateQueue;_a=!1;var V=T.firstBaseUpdate,Y=T.lastBaseUpdate,ve=T.shared.pending;if(ve!==null){T.shared.pending=null;var Se=ve,je=Se.next;Se.next=null,Y===null?V=je:Y.next=je,Y=Se;var st=c.alternate;st!==null&&(st=st.updateQueue,ve=st.lastBaseUpdate,ve!==Y&&(ve===null?st.firstBaseUpdate=je:ve.next=je,st.lastBaseUpdate=Se))}if(V!==null){var ut=T.baseState;Y=0,st=je=Se=null,ve=V;do{var ot=ve.lane,Et=ve.eventTime;if((_&ot)===ot){st!==null&&(st=st.next={eventTime:Et,lane:0,tag:ve.tag,payload:ve.payload,callback:ve.callback,next:null});e:{var It=c,Rt=ve;switch(ot=f,Et=g,Rt.tag){case 1:if(It=Rt.payload,typeof It=="function"){ut=It.call(Et,ut,ot);break e}ut=It;break e;case 3:It.flags=It.flags&-65537|128;case 0:if(It=Rt.payload,ot=typeof It=="function"?It.call(Et,ut,ot):It,ot==null)break e;ut=se({},ut,ot);break e;case 2:_a=!0}}ve.callback!==null&&ve.lane!==0&&(c.flags|=64,ot=T.effects,ot===null?T.effects=[ve]:ot.push(ve))}else Et={eventTime:Et,lane:ot,tag:ve.tag,payload:ve.payload,callback:ve.callback,next:null},st===null?(je=st=Et,Se=ut):st=st.next=Et,Y|=ot;if(ve=ve.next,ve===null){if(ve=T.shared.pending,ve===null)break;ot=ve,ve=ot.next,ot.next=null,T.lastBaseUpdate=ot,T.shared.pending=null}}while(!0);if(st===null&&(Se=ut),T.baseState=Se,T.firstBaseUpdate=je,T.lastBaseUpdate=st,f=T.shared.interleaved,f!==null){T=f;do Y|=T.lane,T=T.next;while(T!==f)}else V===null&&(T.shared.lanes=0);qh|=Y,c.lanes=Y,c.memoizedState=ut}}function Ml(c,f,g){if(c=f.effects,f.effects=null,c!==null)for(f=0;f<c.length;f++){var _=c[f],T=_.callback;if(T!==null){if(_.callback=null,_=g,typeof T!="function")throw Error(t(191,T));T.call(_)}}}var Ic={},Qo=Ws(Ic),Tc=Ws(Ic),Vu=Ws(Ic);function eu(c){if(c===Ic)throw Error(t(174));return c}function kc(c,f){switch(Kn(Vu,f),Kn(Tc,c),Kn(Qo,Ic),c=f.nodeType,c){case 9:case 11:f=(f=f.documentElement)?f.namespaceURI:Lt(null,"");break;default:c=c===8?f.parentNode:f,f=c.namespaceURI||null,c=c.tagName,f=Lt(f,c)}Wn(Qo),Kn(Qo,f)}function Ea(){Wn(Qo),Wn(Tc),Wn(Vu)}function sg(c){eu(Vu.current);var f=eu(Qo.current),g=Lt(f,c.type);f!==g&&(Kn(Tc,c),Kn(Qo,g))}function yp(c){Tc.current===c&&(Wn(Qo),Wn(Tc))}var or=Ws(0);function qs(c){for(var f=c;f!==null;){if(f.tag===13){var g=f.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var wp=[];function bp(){for(var c=0;c<wp.length;c++)wp[c]._workInProgressVersionPrimary=null;wp.length=0}var Bf=F.ReactCurrentDispatcher,Vf=F.ReactCurrentBatchConfig,Sa=0,ur=null,Vr=null,Ir=null,Nc=!1,tu=!1,Pc=0,f1=0;function $r(){throw Error(t(321))}function jf(c,f){if(f===null)return!1;for(var g=0;g<f.length&&g<c.length;g++)if(!Rn(c[g],f[g]))return!1;return!0}function Uh(c,f,g,_,T,V){if(Sa=V,ur=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,Bf.current=c===null||c.memoizedState===null?XN:YN,c=g(_,T),tu){V=0;do{if(tu=!1,Pc=0,25<=V)throw Error(t(301));V+=1,Ir=Vr=null,f.updateQueue=null,Bf.current=JN,c=g(_,T)}while(tu)}if(Bf.current=hg,f=Vr!==null&&Vr.next!==null,Sa=0,Ir=Vr=ur=null,Nc=!1,f)throw Error(t(300));return c}function Aa(){var c=Pc!==0;return Pc=0,c}function Hs(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ir===null?ur.memoizedState=Ir=c:Ir=Ir.next=c,Ir}function Zo(){if(Vr===null){var c=ur.alternate;c=c!==null?c.memoizedState:null}else c=Vr.next;var f=Ir===null?ur.memoizedState:Ir.next;if(f!==null)Ir=f,Vr=c;else{if(c===null)throw Error(t(310));Vr=c,c={memoizedState:Vr.memoizedState,baseState:Vr.baseState,baseQueue:Vr.baseQueue,queue:Vr.queue,next:null},Ir===null?ur.memoizedState=Ir=c:Ir=Ir.next=c}return Ir}function zh(c,f){return typeof f=="function"?f(c):f}function Uf(c){var f=Zo(),g=f.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=c;var _=Vr,T=_.baseQueue,V=g.pending;if(V!==null){if(T!==null){var Y=T.next;T.next=V.next,V.next=Y}_.baseQueue=T=V,g.pending=null}if(T!==null){V=T.next,_=_.baseState;var ve=Y=null,Se=null,je=V;do{var st=je.lane;if((Sa&st)===st)Se!==null&&(Se=Se.next={lane:0,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null}),_=je.hasEagerState?je.eagerState:c(_,je.action);else{var ut={lane:st,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null};Se===null?(ve=Se=ut,Y=_):Se=Se.next=ut,ur.lanes|=st,qh|=st}je=je.next}while(je!==null&&je!==V);Se===null?Y=_:Se.next=ve,Rn(_,f.memoizedState)||(ws=!0),f.memoizedState=_,f.baseState=Y,f.baseQueue=Se,g.lastRenderedState=_}if(c=g.interleaved,c!==null){T=c;do V=T.lane,ur.lanes|=V,qh|=V,T=T.next;while(T!==c)}else T===null&&(g.lanes=0);return[f.memoizedState,g.dispatch]}function ju(c){var f=Zo(),g=f.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=c;var _=g.dispatch,T=g.pending,V=f.memoizedState;if(T!==null){g.pending=null;var Y=T=T.next;do V=c(V,Y.action),Y=Y.next;while(Y!==T);Rn(V,f.memoizedState)||(ws=!0),f.memoizedState=V,f.baseQueue===null&&(f.baseState=V),g.lastRenderedState=V}return[V,_]}function ag(){}function xp(c,f){var g=ur,_=Zo(),T=f(),V=!Rn(_.memoizedState,T);if(V&&(_.memoizedState=T,ws=!0),_=_.queue,qf(lg.bind(null,g,_,c),[c]),_.getSnapshot!==f||V||Ir!==null&&Ir.memoizedState.tag&1){if(g.flags|=2048,es(9,_p.bind(null,g,_,T,f),void 0,null),Vi===null)throw Error(t(349));(Sa&30)!==0||ug(g,f,T)}return T}function ug(c,f,g){c.flags|=16384,c={getSnapshot:f,value:g},f=ur.updateQueue,f===null?(f={lastEffect:null,stores:null},ur.updateQueue=f,f.stores=[c]):(g=f.stores,g===null?f.stores=[c]:g.push(c))}function _p(c,f,g,_){f.value=g,f.getSnapshot=_,Rc(f)&&zf(c)}function lg(c,f,g){return g(function(){Rc(f)&&zf(c)})}function Rc(c){var f=c.getSnapshot;c=c.value;try{var g=f();return!Rn(c,g)}catch{return!0}}function zf(c){var f=Bn(c,1);f!==null&&su(f,c,1,-1)}function Wh(c){var f=Hs();return typeof c=="function"&&(c=c()),f.memoizedState=f.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zh,lastRenderedState:c},f.queue=c,c=c.dispatch=KN.bind(null,ur,c),[f.memoizedState,c]}function es(c,f,g,_){return c={tag:c,create:f,destroy:g,deps:_,next:null},f=ur.updateQueue,f===null?(f={lastEffect:null,stores:null},ur.updateQueue=f,f.lastEffect=c.next=c):(g=f.lastEffect,g===null?f.lastEffect=c.next=c:(_=g.next,g.next=c,c.next=_,f.lastEffect=c)),c}function nu(){return Zo().memoizedState}function Gs(c,f,g,_){var T=Hs();ur.flags|=c,T.memoizedState=es(1|f,g,void 0,_===void 0?null:_)}function Fl(c,f,g,_){var T=Zo();_=_===void 0?null:_;var V=void 0;if(Vr!==null){var Y=Vr.memoizedState;if(V=Y.destroy,_!==null&&jf(_,Y.deps)){T.memoizedState=es(f,g,V,_);return}}ur.flags|=c,T.memoizedState=es(1|f,g,V,_)}function Wf(c,f){return Gs(8390656,8,c,f)}function qf(c,f){return Fl(2048,8,c,f)}function cg(c,f){return Fl(4,2,c,f)}function Hf(c,f){return Fl(4,4,c,f)}function Gf(c,f){if(typeof f=="function")return c=c(),f(c),function(){f(null)};if(f!=null)return c=c(),f.current=c,function(){f.current=null}}function Xx(c,f,g){return g=g!=null?g.concat([c]):null,Fl(4,4,Gf.bind(null,f,c),g)}function d1(){}function Yx(c,f){var g=Zo();f=f===void 0?null:f;var _=g.memoizedState;return _!==null&&f!==null&&jf(f,_[1])?_[0]:(g.memoizedState=[c,f],c)}function Jx(c,f){var g=Zo();f=f===void 0?null:f;var _=g.memoizedState;return _!==null&&f!==null&&jf(f,_[1])?_[0]:(c=c(),g.memoizedState=[c,f],c)}function Qx(c,f,g){return(Sa&21)===0?(c.baseState&&(c.baseState=!1,ws=!0),c.memoizedState=g):(Rn(g,f)||(g=la(),ur.lanes|=g,qh|=g,c.baseState=!0),f)}function GN(c,f){var g=mn;mn=g!==0&&4>g?g:4,c(!0);var _=Vf.transition;Vf.transition={};try{c(!1),f()}finally{mn=g,Vf.transition=_}}function Zx(){return Zo().memoizedState}function $N(c,f,g){var _=Fc(c);if(g={lane:_,action:g,hasEagerState:!1,eagerState:null,next:null},e5(c))t5(f,g);else if(g=Qa(c,f,g,_),g!==null){var T=ns();su(g,c,_,T),n5(g,f,_)}}function KN(c,f,g){var _=Fc(c),T={lane:_,action:g,hasEagerState:!1,eagerState:null,next:null};if(e5(c))t5(f,T);else{var V=c.alternate;if(c.lanes===0&&(V===null||V.lanes===0)&&(V=f.lastRenderedReducer,V!==null))try{var Y=f.lastRenderedState,ve=V(Y,g);if(T.hasEagerState=!0,T.eagerState=ve,Rn(ve,Y)){var Se=f.interleaved;Se===null?(T.next=T,Bu(f)):(T.next=Se.next,Se.next=T),f.interleaved=T;return}}catch{}finally{}g=Qa(c,f,T,_),g!==null&&(T=ns(),su(g,c,_,T),n5(g,f,_))}}function e5(c){var f=c.alternate;return c===ur||f!==null&&f===ur}function t5(c,f){tu=Nc=!0;var g=c.pending;g===null?f.next=f:(f.next=g.next,g.next=f),c.pending=f}function n5(c,f,g){if((g&4194240)!==0){var _=f.lanes;_&=c.pendingLanes,g|=_,f.lanes=g,Fs(c,g)}}var hg={readContext:Br,useCallback:$r,useContext:$r,useEffect:$r,useImperativeHandle:$r,useInsertionEffect:$r,useLayoutEffect:$r,useMemo:$r,useReducer:$r,useRef:$r,useState:$r,useDebugValue:$r,useDeferredValue:$r,useTransition:$r,useMutableSource:$r,useSyncExternalStore:$r,useId:$r,unstable_isNewReconciler:!1},XN={readContext:Br,useCallback:function(c,f){return Hs().memoizedState=[c,f===void 0?null:f],c},useContext:Br,useEffect:Wf,useImperativeHandle:function(c,f,g){return g=g!=null?g.concat([c]):null,Gs(4194308,4,Gf.bind(null,f,c),g)},useLayoutEffect:function(c,f){return Gs(4194308,4,c,f)},useInsertionEffect:function(c,f){return Gs(4,2,c,f)},useMemo:function(c,f){var g=Hs();return f=f===void 0?null:f,c=c(),g.memoizedState=[c,f],c},useReducer:function(c,f,g){var _=Hs();return f=g!==void 0?g(f):f,_.memoizedState=_.baseState=f,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:f},_.queue=c,c=c.dispatch=$N.bind(null,ur,c),[_.memoizedState,c]},useRef:function(c){var f=Hs();return c={current:c},f.memoizedState=c},useState:Wh,useDebugValue:d1,useDeferredValue:function(c){return Hs().memoizedState=c},useTransition:function(){var c=Wh(!1),f=c[0];return c=GN.bind(null,c[1]),Hs().memoizedState=c,[f,c]},useMutableSource:function(){},useSyncExternalStore:function(c,f,g){var _=ur,T=Hs();if(Ge){if(g===void 0)throw Error(t(407));g=g()}else{if(g=f(),Vi===null)throw Error(t(349));(Sa&30)!==0||ug(_,f,g)}T.memoizedState=g;var V={value:g,getSnapshot:f};return T.queue=V,Wf(lg.bind(null,_,V,c),[c]),_.flags|=2048,es(9,_p.bind(null,_,V,g,f),void 0,null),g},useId:function(){var c=Hs(),f=Vi.identifierPrefix;if(Ge){var g=Le,_=De;g=(_&~(1<<32-ci(_)-1)).toString(32)+g,f=":"+f+"R"+g,g=Pc++,0<g&&(f+="H"+g.toString(32)),f+=":"}else g=f1++,f=":"+f+"r"+g.toString(32)+":";return c.memoizedState=f},unstable_isNewReconciler:!1},YN={readContext:Br,useCallback:Yx,useContext:Br,useEffect:qf,useImperativeHandle:Xx,useInsertionEffect:cg,useLayoutEffect:Hf,useMemo:Jx,useReducer:Uf,useRef:nu,useState:function(){return Uf(zh)},useDebugValue:d1,useDeferredValue:function(c){var f=Zo();return Qx(f,Vr.memoizedState,c)},useTransition:function(){var c=Uf(zh)[0],f=Zo().memoizedState;return[c,f]},useMutableSource:ag,useSyncExternalStore:xp,useId:Zx,unstable_isNewReconciler:!1},JN={readContext:Br,useCallback:Yx,useContext:Br,useEffect:qf,useImperativeHandle:Xx,useInsertionEffect:cg,useLayoutEffect:Hf,useMemo:Jx,useReducer:ju,useRef:nu,useState:function(){return ju(zh)},useDebugValue:d1,useDeferredValue:function(c){var f=Zo();return Vr===null?f.memoizedState=c:Qx(f,Vr.memoizedState,c)},useTransition:function(){var c=ju(zh)[0],f=Zo().memoizedState;return[c,f]},useMutableSource:ag,useSyncExternalStore:xp,useId:Zx,unstable_isNewReconciler:!1};function ru(c,f){if(c&&c.defaultProps){f=se({},f),c=c.defaultProps;for(var g in c)f[g]===void 0&&(f[g]=c[g]);return f}return f}function p1(c,f,g,_){f=c.memoizedState,g=g(_,f),g=g==null?f:se({},f,g),c.memoizedState=g,c.lanes===0&&(c.updateQueue.baseState=g)}var fg={isMounted:function(c){return(c=c._reactInternals)?Ar(c)===c:!1},enqueueSetState:function(c,f,g){c=c._reactInternals;var _=ns(),T=Fc(c),V=gs(_,T);V.payload=f,g!=null&&(V.callback=g),f=vs(c,V,T),f!==null&&(su(f,c,T,_),Ll(f,c,T))},enqueueReplaceState:function(c,f,g){c=c._reactInternals;var _=ns(),T=Fc(c),V=gs(_,T);V.tag=1,V.payload=f,g!=null&&(V.callback=g),f=vs(c,V,T),f!==null&&(su(f,c,T,_),Ll(f,c,T))},enqueueForceUpdate:function(c,f){c=c._reactInternals;var g=ns(),_=Fc(c),T=gs(g,_);T.tag=2,f!=null&&(T.callback=f),f=vs(c,T,_),f!==null&&(su(f,c,_,g),Ll(f,c,_))}};function r5(c,f,g,_,T,V,Y){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(_,V,Y):f.prototype&&f.prototype.isPureReactComponent?!Ga(g,_)||!Ga(T,V):!0}function i5(c,f,g){var _=!1,T=Ou,V=f.contextType;return typeof V=="object"&&V!==null?V=Br(V):(T=_o(f)?Rl:vi.current,_=f.contextTypes,V=(_=_!=null)?Cc(c,T):Ou),f=new f(g,V),c.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=fg,c.stateNode=f,f._reactInternals=c,_&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=T,c.__reactInternalMemoizedMaskedChildContext=V),f}function o5(c,f,g,_){c=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(g,_),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(g,_),f.state!==c&&fg.enqueueReplaceState(f,f.state,null)}function m1(c,f,g,_){var T=c.stateNode;T.props=g,T.state=c.memoizedState,T.refs={},Of(c);var V=f.contextType;typeof V=="object"&&V!==null?T.context=Br(V):(V=_o(f)?Rl:vi.current,T.context=Cc(c,V)),T.state=c.memoizedState,V=f.getDerivedStateFromProps,typeof V=="function"&&(p1(c,f,V,g),T.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(f=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),f!==T.state&&fg.enqueueReplaceState(T,T.state,null),Za(c,g,T,_),T.state=c.memoizedState),typeof T.componentDidMount=="function"&&(c.flags|=4194308)}function $f(c,f){try{var g="",_=f;do g+=ce(_),_=_.return;while(_);var T=g}catch(V){T=`
Error generating stack: `+V.message+`
`+V.stack}return{value:c,source:f,stack:T,digest:null}}function g1(c,f,g){return{value:c,source:null,stack:g??null,digest:f??null}}function v1(c,f){try{console.error(f.value)}catch(g){setTimeout(function(){throw g})}}var QN=typeof WeakMap=="function"?WeakMap:Map;function s5(c,f,g){g=gs(-1,g),g.tag=3,g.payload={element:null};var _=f.value;return g.callback=function(){wg||(wg=!0,R1=_),v1(c,f)},g}function a5(c,f,g){g=gs(-1,g),g.tag=3;var _=c.type.getDerivedStateFromError;if(typeof _=="function"){var T=f.value;g.payload=function(){return _(T)},g.callback=function(){v1(c,f)}}var V=c.stateNode;return V!==null&&typeof V.componentDidCatch=="function"&&(g.callback=function(){v1(c,f),typeof _!="function"&&(Lc===null?Lc=new Set([this]):Lc.add(this));var Y=f.stack;this.componentDidCatch(f.value,{componentStack:Y!==null?Y:""})}),g}function u5(c,f,g){var _=c.pingCache;if(_===null){_=c.pingCache=new QN;var T=new Set;_.set(f,T)}else T=_.get(f),T===void 0&&(T=new Set,_.set(f,T));T.has(g)||(T.add(g),c=fP.bind(null,c,f,g),f.then(c,c))}function l5(c){do{var f;if((f=c.tag===13)&&(f=c.memoizedState,f=f!==null?f.dehydrated!==null:!0),f)return c;c=c.return}while(c!==null);return null}function c5(c,f,g,_,T){return(c.mode&1)===0?(c===f?c.flags|=65536:(c.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(f=gs(-1,1),f.tag=2,vs(g,f,1))),g.lanes|=1),c):(c.flags|=65536,c.lanes=T,c)}var ZN=F.ReactCurrentOwner,ws=!1;function ts(c,f,g,_){f.child=c===null?On(f,null,g,_):Hr(f,c.child,g,_)}function h5(c,f,g,_,T){g=g.render;var V=f.ref;return pr(f,T),_=Uh(c,f,g,_,V,T),g=Aa(),c!==null&&!ws?(f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~T,Ol(c,f,T)):(Ge&&g&&ze(f),f.flags|=1,ts(c,f,_,T),f.child)}function f5(c,f,g,_,T){if(c===null){var V=g.type;return typeof V=="function"&&!V1(V)&&V.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(f.tag=15,f.type=V,d5(c,f,V,_,T)):(c=Ag(g.type,null,_,f,f.mode,T),c.ref=f.ref,c.return=f,f.child=c)}if(V=c.child,(c.lanes&T)===0){var Y=V.memoizedProps;if(g=g.compare,g=g!==null?g:Ga,g(Y,_)&&c.ref===f.ref)return Ol(c,f,T)}return f.flags|=1,c=Bc(V,_),c.ref=f.ref,c.return=f,f.child=c}function d5(c,f,g,_,T){if(c!==null){var V=c.memoizedProps;if(Ga(V,_)&&c.ref===f.ref)if(ws=!1,f.pendingProps=_=V,(c.lanes&T)!==0)(c.flags&131072)!==0&&(ws=!0);else return f.lanes=c.lanes,Ol(c,f,T)}return y1(c,f,g,_,T)}function p5(c,f,g){var _=f.pendingProps,T=_.children,V=c!==null?c.memoizedState:null;if(_.mode==="hidden")if((f.mode&1)===0)f.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kn(Xf,$s),$s|=g;else{if((g&1073741824)===0)return c=V!==null?V.baseLanes|g:g,f.lanes=f.childLanes=1073741824,f.memoizedState={baseLanes:c,cachePool:null,transitions:null},f.updateQueue=null,Kn(Xf,$s),$s|=c,null;f.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=V!==null?V.baseLanes:g,Kn(Xf,$s),$s|=_}else V!==null?(_=V.baseLanes|g,f.memoizedState=null):_=g,Kn(Xf,$s),$s|=_;return ts(c,f,T,g),f.child}function m5(c,f){var g=f.ref;(c===null&&g!==null||c!==null&&c.ref!==g)&&(f.flags|=512,f.flags|=2097152)}function y1(c,f,g,_,T){var V=_o(g)?Rl:vi.current;return V=Cc(f,V),pr(f,T),g=Uh(c,f,g,_,V,T),_=Aa(),c!==null&&!ws?(f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~T,Ol(c,f,T)):(Ge&&_&&ze(f),f.flags|=1,ts(c,f,g,T),f.child)}function g5(c,f,g,_,T){if(_o(g)){var V=!0;Dl(f)}else V=!1;if(pr(f,T),f.stateNode===null)pg(c,f),i5(f,g,_),m1(f,g,_,T),_=!0;else if(c===null){var Y=f.stateNode,ve=f.memoizedProps;Y.props=ve;var Se=Y.context,je=g.contextType;typeof je=="object"&&je!==null?je=Br(je):(je=_o(g)?Rl:vi.current,je=Cc(f,je));var st=g.getDerivedStateFromProps,ut=typeof st=="function"||typeof Y.getSnapshotBeforeUpdate=="function";ut||typeof Y.UNSAFE_componentWillReceiveProps!="function"&&typeof Y.componentWillReceiveProps!="function"||(ve!==_||Se!==je)&&o5(f,Y,_,je),_a=!1;var ot=f.memoizedState;Y.state=ot,Za(f,_,Y,T),Se=f.memoizedState,ve!==_||ot!==Se||xo.current||_a?(typeof st=="function"&&(p1(f,g,st,_),Se=f.memoizedState),(ve=_a||r5(f,g,ve,_,ot,Se,je))?(ut||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount()),typeof Y.componentDidMount=="function"&&(f.flags|=4194308)):(typeof Y.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=_,f.memoizedState=Se),Y.props=_,Y.state=Se,Y.context=je,_=ve):(typeof Y.componentDidMount=="function"&&(f.flags|=4194308),_=!1)}else{Y=f.stateNode,vp(c,f),ve=f.memoizedProps,je=f.type===f.elementType?ve:ru(f.type,ve),Y.props=je,ut=f.pendingProps,ot=Y.context,Se=g.contextType,typeof Se=="object"&&Se!==null?Se=Br(Se):(Se=_o(g)?Rl:vi.current,Se=Cc(f,Se));var Et=g.getDerivedStateFromProps;(st=typeof Et=="function"||typeof Y.getSnapshotBeforeUpdate=="function")||typeof Y.UNSAFE_componentWillReceiveProps!="function"&&typeof Y.componentWillReceiveProps!="function"||(ve!==ut||ot!==Se)&&o5(f,Y,_,Se),_a=!1,ot=f.memoizedState,Y.state=ot,Za(f,_,Y,T);var It=f.memoizedState;ve!==ut||ot!==It||xo.current||_a?(typeof Et=="function"&&(p1(f,g,Et,_),It=f.memoizedState),(je=_a||r5(f,g,je,_,ot,It,Se)||!1)?(st||typeof Y.UNSAFE_componentWillUpdate!="function"&&typeof Y.componentWillUpdate!="function"||(typeof Y.componentWillUpdate=="function"&&Y.componentWillUpdate(_,It,Se),typeof Y.UNSAFE_componentWillUpdate=="function"&&Y.UNSAFE_componentWillUpdate(_,It,Se)),typeof Y.componentDidUpdate=="function"&&(f.flags|=4),typeof Y.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof Y.componentDidUpdate!="function"||ve===c.memoizedProps&&ot===c.memoizedState||(f.flags|=4),typeof Y.getSnapshotBeforeUpdate!="function"||ve===c.memoizedProps&&ot===c.memoizedState||(f.flags|=1024),f.memoizedProps=_,f.memoizedState=It),Y.props=_,Y.state=It,Y.context=Se,_=je):(typeof Y.componentDidUpdate!="function"||ve===c.memoizedProps&&ot===c.memoizedState||(f.flags|=4),typeof Y.getSnapshotBeforeUpdate!="function"||ve===c.memoizedProps&&ot===c.memoizedState||(f.flags|=1024),_=!1)}return w1(c,f,g,_,V,T)}function w1(c,f,g,_,T,V){m5(c,f);var Y=(f.flags&128)!==0;if(!_&&!Y)return T&&og(f,g,!1),Ol(c,f,V);_=f.stateNode,ZN.current=f;var ve=Y&&typeof g.getDerivedStateFromError!="function"?null:_.render();return f.flags|=1,c!==null&&Y?(f.child=Hr(f,c.child,null,V),f.child=Hr(f,null,ve,V)):ts(c,f,ve,V),f.memoizedState=_.state,T&&og(f,g,!0),f.child}function v5(c){var f=c.stateNode;f.pendingContext?ig(c,f.pendingContext,f.pendingContext!==f.context):f.context&&ig(c,f.context,!1),kc(c,f.containerInfo)}function y5(c,f,g,_,T){return hn(),qn(T),f.flags|=256,ts(c,f,g,_),f.child}var b1={dehydrated:null,treeContext:null,retryLane:0};function x1(c){return{baseLanes:c,cachePool:null,transitions:null}}function w5(c,f,g){var _=f.pendingProps,T=or.current,V=!1,Y=(f.flags&128)!==0,ve;if((ve=Y)||(ve=c!==null&&c.memoizedState===null?!1:(T&2)!==0),ve?(V=!0,f.flags&=-129):(c===null||c.memoizedState!==null)&&(T|=1),Kn(or,T&1),c===null)return yt(f),c=f.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((f.mode&1)===0?f.lanes=1:c.data==="$!"?f.lanes=8:f.lanes=1073741824,null):(Y=_.children,c=_.fallback,V?(_=f.mode,V=f.child,Y={mode:"hidden",children:Y},(_&1)===0&&V!==null?(V.childLanes=0,V.pendingProps=Y):V=Cg(Y,_,0,null),c=Kh(c,_,g,null),V.return=f,c.return=f,V.sibling=c,f.child=V,f.child.memoizedState=x1(g),f.memoizedState=b1,c):_1(f,Y));if(T=c.memoizedState,T!==null&&(ve=T.dehydrated,ve!==null))return eP(c,f,Y,_,ve,T,g);if(V){V=_.fallback,Y=f.mode,T=c.child,ve=T.sibling;var Se={mode:"hidden",children:_.children};return(Y&1)===0&&f.child!==T?(_=f.child,_.childLanes=0,_.pendingProps=Se,f.deletions=null):(_=Bc(T,Se),_.subtreeFlags=T.subtreeFlags&14680064),ve!==null?V=Bc(ve,V):(V=Kh(V,Y,g,null),V.flags|=2),V.return=f,_.return=f,_.sibling=V,f.child=_,_=V,V=f.child,Y=c.child.memoizedState,Y=Y===null?x1(g):{baseLanes:Y.baseLanes|g,cachePool:null,transitions:Y.transitions},V.memoizedState=Y,V.childLanes=c.childLanes&~g,f.memoizedState=b1,_}return V=c.child,c=V.sibling,_=Bc(V,{mode:"visible",children:_.children}),(f.mode&1)===0&&(_.lanes=g),_.return=f,_.sibling=null,c!==null&&(g=f.deletions,g===null?(f.deletions=[c],f.flags|=16):g.push(c)),f.child=_,f.memoizedState=null,_}function _1(c,f){return f=Cg({mode:"visible",children:f},c.mode,0,null),f.return=c,c.child=f}function dg(c,f,g,_){return _!==null&&qn(_),Hr(f,c.child,null,g),c=_1(f,f.pendingProps.children),c.flags|=2,f.memoizedState=null,c}function eP(c,f,g,_,T,V,Y){if(g)return f.flags&256?(f.flags&=-257,_=g1(Error(t(422))),dg(c,f,Y,_)):f.memoizedState!==null?(f.child=c.child,f.flags|=128,null):(V=_.fallback,T=f.mode,_=Cg({mode:"visible",children:_.children},T,0,null),V=Kh(V,T,Y,null),V.flags|=2,_.return=f,V.return=f,_.sibling=V,f.child=_,(f.mode&1)!==0&&Hr(f,c.child,null,Y),f.child.memoizedState=x1(Y),f.memoizedState=b1,V);if((f.mode&1)===0)return dg(c,f,Y,null);if(T.data==="$!"){if(_=T.nextSibling&&T.nextSibling.dataset,_)var ve=_.dgst;return _=ve,V=Error(t(419)),_=g1(V,_,void 0),dg(c,f,Y,_)}if(ve=(Y&c.childLanes)!==0,ws||ve){if(_=Vi,_!==null){switch(Y&-Y){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(_.suspendedLanes|Y))!==0?0:T,T!==0&&T!==V.retryLane&&(V.retryLane=T,Bn(c,T),su(_,c,T,-1))}return B1(),_=g1(Error(t(421))),dg(c,f,Y,_)}return T.data==="$?"?(f.flags|=128,f.child=c.child,f=dP.bind(null,c),T._reactRetry=f,null):(c=V.treeContext,Ke=eo(T.nextSibling),Ie=f,Ge=!0,Xe=null,c!==null&&(te[ue++]=De,te[ue++]=Le,te[ue++]=Ee,De=c.id,Le=c.overflow,Ee=f),f=_1(f,_.children),f.flags|=4096,f)}function b5(c,f,g){c.lanes|=f;var _=c.alternate;_!==null&&(_.lanes|=f),ms(c.return,f,g)}function E1(c,f,g,_,T){var V=c.memoizedState;V===null?c.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:_,tail:g,tailMode:T}:(V.isBackwards=f,V.rendering=null,V.renderingStartTime=0,V.last=_,V.tail=g,V.tailMode=T)}function x5(c,f,g){var _=f.pendingProps,T=_.revealOrder,V=_.tail;if(ts(c,f,_.children,g),_=or.current,(_&2)!==0)_=_&1|2,f.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=f.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&b5(c,g,f);else if(c.tag===19)b5(c,g,f);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===f)break e;for(;c.sibling===null;){if(c.return===null||c.return===f)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}_&=1}if(Kn(or,_),(f.mode&1)===0)f.memoizedState=null;else switch(T){case"forwards":for(g=f.child,T=null;g!==null;)c=g.alternate,c!==null&&qs(c)===null&&(T=g),g=g.sibling;g=T,g===null?(T=f.child,f.child=null):(T=g.sibling,g.sibling=null),E1(f,!1,T,g,V);break;case"backwards":for(g=null,T=f.child,f.child=null;T!==null;){if(c=T.alternate,c!==null&&qs(c)===null){f.child=T;break}c=T.sibling,T.sibling=g,g=T,T=c}E1(f,!0,g,null,V);break;case"together":E1(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function pg(c,f){(f.mode&1)===0&&c!==null&&(c.alternate=null,f.alternate=null,f.flags|=2)}function Ol(c,f,g){if(c!==null&&(f.dependencies=c.dependencies),qh|=f.lanes,(g&f.childLanes)===0)return null;if(c!==null&&f.child!==c.child)throw Error(t(153));if(f.child!==null){for(c=f.child,g=Bc(c,c.pendingProps),f.child=g,g.return=f;c.sibling!==null;)c=c.sibling,g=g.sibling=Bc(c,c.pendingProps),g.return=f;g.sibling=null}return f.child}function tP(c,f,g){switch(f.tag){case 3:v5(f),hn();break;case 5:sg(f);break;case 1:_o(f.type)&&Dl(f);break;case 4:kc(f,f.stateNode.containerInfo);break;case 10:var _=f.type._context,T=f.memoizedProps.value;Kn(Oi,_._currentValue),_._currentValue=T;break;case 13:if(_=f.memoizedState,_!==null)return _.dehydrated!==null?(Kn(or,or.current&1),f.flags|=128,null):(g&f.child.childLanes)!==0?w5(c,f,g):(Kn(or,or.current&1),c=Ol(c,f,g),c!==null?c.sibling:null);Kn(or,or.current&1);break;case 19:if(_=(g&f.childLanes)!==0,(c.flags&128)!==0){if(_)return x5(c,f,g);f.flags|=128}if(T=f.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),Kn(or,or.current),_)break;return null;case 22:case 23:return f.lanes=0,p5(c,f,g)}return Ol(c,f,g)}var _5,S1,E5,S5;_5=function(c,f){for(var g=f.child;g!==null;){if(g.tag===5||g.tag===6)c.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},S1=function(){},E5=function(c,f,g,_){var T=c.memoizedProps;if(T!==_){c=f.stateNode,eu(Qo.current);var V=null;switch(g){case"input":T=Be(c,T),_=Be(c,_),V=[];break;case"select":T=se({},T,{value:void 0}),_=se({},_,{value:void 0}),V=[];break;case"textarea":T=ct(c,T),_=ct(c,_),V=[];break;default:typeof T.onClick!="function"&&typeof _.onClick=="function"&&(c.onclick=Ec)}Gn(g,_);var Y;g=null;for(je in T)if(!_.hasOwnProperty(je)&&T.hasOwnProperty(je)&&T[je]!=null)if(je==="style"){var ve=T[je];for(Y in ve)ve.hasOwnProperty(Y)&&(g||(g={}),g[Y]="")}else je!=="dangerouslySetInnerHTML"&&je!=="children"&&je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&je!=="autoFocus"&&(i.hasOwnProperty(je)?V||(V=[]):(V=V||[]).push(je,null));for(je in _){var Se=_[je];if(ve=T!=null?T[je]:void 0,_.hasOwnProperty(je)&&Se!==ve&&(Se!=null||ve!=null))if(je==="style")if(ve){for(Y in ve)!ve.hasOwnProperty(Y)||Se&&Se.hasOwnProperty(Y)||(g||(g={}),g[Y]="");for(Y in Se)Se.hasOwnProperty(Y)&&ve[Y]!==Se[Y]&&(g||(g={}),g[Y]=Se[Y])}else g||(V||(V=[]),V.push(je,g)),g=Se;else je==="dangerouslySetInnerHTML"?(Se=Se?Se.__html:void 0,ve=ve?ve.__html:void 0,Se!=null&&ve!==Se&&(V=V||[]).push(je,Se)):je==="children"?typeof Se!="string"&&typeof Se!="number"||(V=V||[]).push(je,""+Se):je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&(i.hasOwnProperty(je)?(Se!=null&&je==="onScroll"&&er("scroll",c),V||ve===Se||(V=[])):(V=V||[]).push(je,Se))}g&&(V=V||[]).push("style",g);var je=V;(f.updateQueue=je)&&(f.flags|=4)}},S5=function(c,f,g,_){g!==_&&(f.flags|=4)};function Ep(c,f){if(!Ge)switch(c.tailMode){case"hidden":f=c.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?c.tail=null:g.sibling=null;break;case"collapsed":g=c.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?f||c.tail===null?c.tail=null:c.tail.sibling=null:_.sibling=null}}function So(c){var f=c.alternate!==null&&c.alternate.child===c.child,g=0,_=0;if(f)for(var T=c.child;T!==null;)g|=T.lanes|T.childLanes,_|=T.subtreeFlags&14680064,_|=T.flags&14680064,T.return=c,T=T.sibling;else for(T=c.child;T!==null;)g|=T.lanes|T.childLanes,_|=T.subtreeFlags,_|=T.flags,T.return=c,T=T.sibling;return c.subtreeFlags|=_,c.childLanes=g,f}function nP(c,f,g){var _=f.pendingProps;switch(Ce(f),f.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return So(f),null;case 1:return _o(f.type)&&Ff(),So(f),null;case 3:return _=f.stateNode,Ea(),Wn(xo),Wn(vi),bp(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(c===null||c.child===null)&&(Tn(f)?f.flags|=4:c===null||c.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Xe!==null&&(M1(Xe),Xe=null))),S1(c,f),So(f),null;case 5:yp(f);var T=eu(Vu.current);if(g=f.type,c!==null&&f.stateNode!=null)E5(c,f,g,_,T),c.ref!==f.ref&&(f.flags|=512,f.flags|=2097152);else{if(!_){if(f.stateNode===null)throw Error(t(166));return So(f),null}if(c=eu(Qo.current),Tn(f)){_=f.stateNode,g=f.type;var V=f.memoizedProps;switch(_[xa]=f,_[Sc]=V,c=(f.mode&1)!==0,g){case"dialog":er("cancel",_),er("close",_);break;case"iframe":case"object":case"embed":er("load",_);break;case"video":case"audio":for(T=0;T<Mu.length;T++)er(Mu[T],_);break;case"source":er("error",_);break;case"img":case"image":case"link":er("error",_),er("load",_);break;case"details":er("toggle",_);break;case"input":_e(_,V),er("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!V.multiple},er("invalid",_);break;case"textarea":xt(_,V),er("invalid",_)}Gn(g,V),T=null;for(var Y in V)if(V.hasOwnProperty(Y)){var ve=V[Y];Y==="children"?typeof ve=="string"?_.textContent!==ve&&(V.suppressHydrationWarning!==!0&&Mf(_.textContent,ve,c),T=["children",ve]):typeof ve=="number"&&_.textContent!==""+ve&&(V.suppressHydrationWarning!==!0&&Mf(_.textContent,ve,c),T=["children",""+ve]):i.hasOwnProperty(Y)&&ve!=null&&Y==="onScroll"&&er("scroll",_)}switch(g){case"input":Ue(_),dt(_,V,!0);break;case"textarea":Ue(_),jt(_);break;case"select":case"option":break;default:typeof V.onClick=="function"&&(_.onclick=Ec)}_=T,f.updateQueue=_,_!==null&&(f.flags|=4)}else{Y=T.nodeType===9?T:T.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Pt(g)),c==="http://www.w3.org/1999/xhtml"?g==="script"?(c=Y.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof _.is=="string"?c=Y.createElement(g,{is:_.is}):(c=Y.createElement(g),g==="select"&&(Y=c,_.multiple?Y.multiple=!0:_.size&&(Y.size=_.size))):c=Y.createElementNS(c,g),c[xa]=f,c[Sc]=_,_5(c,f,!1,!1),f.stateNode=c;e:{switch(Y=ho(g,_),g){case"dialog":er("cancel",c),er("close",c),T=_;break;case"iframe":case"object":case"embed":er("load",c),T=_;break;case"video":case"audio":for(T=0;T<Mu.length;T++)er(Mu[T],c);T=_;break;case"source":er("error",c),T=_;break;case"img":case"image":case"link":er("error",c),er("load",c),T=_;break;case"details":er("toggle",c),T=_;break;case"input":_e(c,_),T=Be(c,_),er("invalid",c);break;case"option":T=_;break;case"select":c._wrapperState={wasMultiple:!!_.multiple},T=se({},_,{value:void 0}),er("invalid",c);break;case"textarea":xt(c,_),T=ct(c,_),er("invalid",c);break;default:T=_}Gn(g,T),ve=T;for(V in ve)if(ve.hasOwnProperty(V)){var Se=ve[V];V==="style"?qr(c,Se):V==="dangerouslySetInnerHTML"?(Se=Se?Se.__html:void 0,Se!=null&&Ut(c,Se)):V==="children"?typeof Se=="string"?(g!=="textarea"||Se!=="")&&en(c,Se):typeof Se=="number"&&en(c,""+Se):V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&V!=="autoFocus"&&(i.hasOwnProperty(V)?Se!=null&&V==="onScroll"&&er("scroll",c):Se!=null&&N(c,V,Se,Y))}switch(g){case"input":Ue(c),dt(c,_,!1);break;case"textarea":Ue(c),jt(c);break;case"option":_.value!=null&&c.setAttribute("value",""+be(_.value));break;case"select":c.multiple=!!_.multiple,V=_.value,V!=null?lt(c,!!_.multiple,V,!1):_.defaultValue!=null&&lt(c,!!_.multiple,_.defaultValue,!0);break;default:typeof T.onClick=="function"&&(c.onclick=Ec)}switch(g){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(f.flags|=4)}f.ref!==null&&(f.flags|=512,f.flags|=2097152)}return So(f),null;case 6:if(c&&f.stateNode!=null)S5(c,f,c.memoizedProps,_);else{if(typeof _!="string"&&f.stateNode===null)throw Error(t(166));if(g=eu(Vu.current),eu(Qo.current),Tn(f)){if(_=f.stateNode,g=f.memoizedProps,_[xa]=f,(V=_.nodeValue!==g)&&(c=Ie,c!==null))switch(c.tag){case 3:Mf(_.nodeValue,g,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&Mf(_.nodeValue,g,(c.mode&1)!==0)}V&&(f.flags|=4)}else _=(g.nodeType===9?g:g.ownerDocument).createTextNode(_),_[xa]=f,f.stateNode=_}return So(f),null;case 13:if(Wn(or),_=f.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(Ge&&Ke!==null&&(f.mode&1)!==0&&(f.flags&128)===0)Sn(),hn(),f.flags|=98560,V=!1;else if(V=Tn(f),_!==null&&_.dehydrated!==null){if(c===null){if(!V)throw Error(t(318));if(V=f.memoizedState,V=V!==null?V.dehydrated:null,!V)throw Error(t(317));V[xa]=f}else hn(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;So(f),V=!1}else Xe!==null&&(M1(Xe),Xe=null),V=!0;if(!V)return f.flags&65536?f:null}return(f.flags&128)!==0?(f.lanes=g,f):(_=_!==null,_!==(c!==null&&c.memoizedState!==null)&&_&&(f.child.flags|=8192,(f.mode&1)!==0&&(c===null||(or.current&1)!==0?wi===0&&(wi=3):B1())),f.updateQueue!==null&&(f.flags|=4),So(f),null);case 4:return Ea(),S1(c,f),c===null&&Tl(f.stateNode.containerInfo),So(f),null;case 10:return Eo(f.type._context),So(f),null;case 17:return _o(f.type)&&Ff(),So(f),null;case 19:if(Wn(or),V=f.memoizedState,V===null)return So(f),null;if(_=(f.flags&128)!==0,Y=V.rendering,Y===null)if(_)Ep(V,!1);else{if(wi!==0||c!==null&&(c.flags&128)!==0)for(c=f.child;c!==null;){if(Y=qs(c),Y!==null){for(f.flags|=128,Ep(V,!1),_=Y.updateQueue,_!==null&&(f.updateQueue=_,f.flags|=4),f.subtreeFlags=0,_=g,g=f.child;g!==null;)V=g,c=_,V.flags&=14680066,Y=V.alternate,Y===null?(V.childLanes=0,V.lanes=c,V.child=null,V.subtreeFlags=0,V.memoizedProps=null,V.memoizedState=null,V.updateQueue=null,V.dependencies=null,V.stateNode=null):(V.childLanes=Y.childLanes,V.lanes=Y.lanes,V.child=Y.child,V.subtreeFlags=0,V.deletions=null,V.memoizedProps=Y.memoizedProps,V.memoizedState=Y.memoizedState,V.updateQueue=Y.updateQueue,V.type=Y.type,c=Y.dependencies,V.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),g=g.sibling;return Kn(or,or.current&1|2),f.child}c=c.sibling}V.tail!==null&&$n()>Yf&&(f.flags|=128,_=!0,Ep(V,!1),f.lanes=4194304)}else{if(!_)if(c=qs(Y),c!==null){if(f.flags|=128,_=!0,g=c.updateQueue,g!==null&&(f.updateQueue=g,f.flags|=4),Ep(V,!0),V.tail===null&&V.tailMode==="hidden"&&!Y.alternate&&!Ge)return So(f),null}else 2*$n()-V.renderingStartTime>Yf&&g!==1073741824&&(f.flags|=128,_=!0,Ep(V,!1),f.lanes=4194304);V.isBackwards?(Y.sibling=f.child,f.child=Y):(g=V.last,g!==null?g.sibling=Y:f.child=Y,V.last=Y)}return V.tail!==null?(f=V.tail,V.rendering=f,V.tail=f.sibling,V.renderingStartTime=$n(),f.sibling=null,g=or.current,Kn(or,_?g&1|2:g&1),f):(So(f),null);case 22:case 23:return O1(),_=f.memoizedState!==null,c!==null&&c.memoizedState!==null!==_&&(f.flags|=8192),_&&(f.mode&1)!==0?($s&1073741824)!==0&&(So(f),f.subtreeFlags&6&&(f.flags|=8192)):So(f),null;case 24:return null;case 25:return null}throw Error(t(156,f.tag))}function rP(c,f){switch(Ce(f),f.tag){case 1:return _o(f.type)&&Ff(),c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 3:return Ea(),Wn(xo),Wn(vi),bp(),c=f.flags,(c&65536)!==0&&(c&128)===0?(f.flags=c&-65537|128,f):null;case 5:return yp(f),null;case 13:if(Wn(or),c=f.memoizedState,c!==null&&c.dehydrated!==null){if(f.alternate===null)throw Error(t(340));hn()}return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 19:return Wn(or),null;case 4:return Ea(),null;case 10:return Eo(f.type._context),null;case 22:case 23:return O1(),null;case 24:return null;default:return null}}var mg=!1,Ao=!1,iP=typeof WeakSet=="function"?WeakSet:Set,Ct=null;function Kf(c,f){var g=c.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(_){jr(c,f,_)}else g.current=null}function A1(c,f,g){try{g()}catch(_){jr(c,f,_)}}var A5=!1;function oP(c,f){if(Bh=fa,c=Ph(),Sl(c)){if("selectionStart"in c)var g={start:c.selectionStart,end:c.selectionEnd};else e:{g=(g=c.ownerDocument)&&g.defaultView||window;var _=g.getSelection&&g.getSelection();if(_&&_.rangeCount!==0){g=_.anchorNode;var T=_.anchorOffset,V=_.focusNode;_=_.focusOffset;try{g.nodeType,V.nodeType}catch{g=null;break e}var Y=0,ve=-1,Se=-1,je=0,st=0,ut=c,ot=null;t:for(;;){for(var Et;ut!==g||T!==0&&ut.nodeType!==3||(ve=Y+T),ut!==V||_!==0&&ut.nodeType!==3||(Se=Y+_),ut.nodeType===3&&(Y+=ut.nodeValue.length),(Et=ut.firstChild)!==null;)ot=ut,ut=Et;for(;;){if(ut===c)break t;if(ot===g&&++je===T&&(ve=Y),ot===V&&++st===_&&(Se=Y),(Et=ut.nextSibling)!==null)break;ut=ot,ot=ut.parentNode}ut=Et}g=ve===-1||Se===-1?null:{start:ve,end:Se}}else g=null}g=g||{start:0,end:0}}else g=null;for(Nl={focusedElem:c,selectionRange:g},fa=!1,Ct=f;Ct!==null;)if(f=Ct,c=f.child,(f.subtreeFlags&1028)!==0&&c!==null)c.return=f,Ct=c;else for(;Ct!==null;){f=Ct;try{var It=f.alternate;if((f.flags&1024)!==0)switch(f.tag){case 0:case 11:case 15:break;case 1:if(It!==null){var Rt=It.memoizedProps,Kr=It.memoizedState,Me=f.stateNode,ke=Me.getSnapshotBeforeUpdate(f.elementType===f.type?Rt:ru(f.type,Rt),Kr);Me.__reactInternalSnapshotBeforeUpdate=ke}break;case 3:var Oe=f.stateNode.containerInfo;Oe.nodeType===1?Oe.textContent="":Oe.nodeType===9&&Oe.documentElement&&Oe.removeChild(Oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ht){jr(f,f.return,ht)}if(c=f.sibling,c!==null){c.return=f.return,Ct=c;break}Ct=f.return}return It=A5,A5=!1,It}function Sp(c,f,g){var _=f.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var T=_=_.next;do{if((T.tag&c)===c){var V=T.destroy;T.destroy=void 0,V!==void 0&&A1(f,g,V)}T=T.next}while(T!==_)}}function gg(c,f){if(f=f.updateQueue,f=f!==null?f.lastEffect:null,f!==null){var g=f=f.next;do{if((g.tag&c)===c){var _=g.create;g.destroy=_()}g=g.next}while(g!==f)}}function C1(c){var f=c.ref;if(f!==null){var g=c.stateNode;switch(c.tag){case 5:c=g;break;default:c=g}typeof f=="function"?f(c):f.current=c}}function C5(c){var f=c.alternate;f!==null&&(c.alternate=null,C5(f)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(f=c.stateNode,f!==null&&(delete f[xa],delete f[Sc],delete f[bo],delete f[c1],delete f[h1])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function I5(c){return c.tag===5||c.tag===3||c.tag===4}function T5(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||I5(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function I1(c,f,g){var _=c.tag;if(_===5||_===6)c=c.stateNode,f?g.nodeType===8?g.parentNode.insertBefore(c,f):g.insertBefore(c,f):(g.nodeType===8?(f=g.parentNode,f.insertBefore(c,g)):(f=g,f.appendChild(c)),g=g._reactRootContainer,g!=null||f.onclick!==null||(f.onclick=Ec));else if(_!==4&&(c=c.child,c!==null))for(I1(c,f,g),c=c.sibling;c!==null;)I1(c,f,g),c=c.sibling}function T1(c,f,g){var _=c.tag;if(_===5||_===6)c=c.stateNode,f?g.insertBefore(c,f):g.appendChild(c);else if(_!==4&&(c=c.child,c!==null))for(T1(c,f,g),c=c.sibling;c!==null;)T1(c,f,g),c=c.sibling}var no=null,iu=!1;function Dc(c,f,g){for(g=g.child;g!==null;)k5(c,f,g),g=g.sibling}function k5(c,f,g){if(Gi&&typeof Gi.onCommitFiberUnmount=="function")try{Gi.onCommitFiberUnmount(sa,g)}catch{}switch(g.tag){case 5:Ao||Kf(g,f);case 6:var _=no,T=iu;no=null,Dc(c,f,g),no=_,iu=T,no!==null&&(iu?(c=no,g=g.stateNode,c.nodeType===8?c.parentNode.removeChild(g):c.removeChild(g)):no.removeChild(g.stateNode));break;case 18:no!==null&&(iu?(c=no,g=g.stateNode,c.nodeType===8?pp(c.parentNode,g):c.nodeType===1&&pp(c,g),pi(c)):pp(no,g.stateNode));break;case 4:_=no,T=iu,no=g.stateNode.containerInfo,iu=!0,Dc(c,f,g),no=_,iu=T;break;case 0:case 11:case 14:case 15:if(!Ao&&(_=g.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){T=_=_.next;do{var V=T,Y=V.destroy;V=V.tag,Y!==void 0&&((V&2)!==0||(V&4)!==0)&&A1(g,f,Y),T=T.next}while(T!==_)}Dc(c,f,g);break;case 1:if(!Ao&&(Kf(g,f),_=g.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=g.memoizedProps,_.state=g.memoizedState,_.componentWillUnmount()}catch(ve){jr(g,f,ve)}Dc(c,f,g);break;case 21:Dc(c,f,g);break;case 22:g.mode&1?(Ao=(_=Ao)||g.memoizedState!==null,Dc(c,f,g),Ao=_):Dc(c,f,g);break;default:Dc(c,f,g)}}function N5(c){var f=c.updateQueue;if(f!==null){c.updateQueue=null;var g=c.stateNode;g===null&&(g=c.stateNode=new iP),f.forEach(function(_){var T=pP.bind(null,c,_);g.has(_)||(g.add(_),_.then(T,T))})}}function ou(c,f){var g=f.deletions;if(g!==null)for(var _=0;_<g.length;_++){var T=g[_];try{var V=c,Y=f,ve=Y;e:for(;ve!==null;){switch(ve.tag){case 5:no=ve.stateNode,iu=!1;break e;case 3:no=ve.stateNode.containerInfo,iu=!0;break e;case 4:no=ve.stateNode.containerInfo,iu=!0;break e}ve=ve.return}if(no===null)throw Error(t(160));k5(V,Y,T),no=null,iu=!1;var Se=T.alternate;Se!==null&&(Se.return=null),T.return=null}catch(je){jr(T,f,je)}}if(f.subtreeFlags&12854)for(f=f.child;f!==null;)P5(f,c),f=f.sibling}function P5(c,f){var g=c.alternate,_=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(ou(f,c),Uu(c),_&4){try{Sp(3,c,c.return),gg(3,c)}catch(Rt){jr(c,c.return,Rt)}try{Sp(5,c,c.return)}catch(Rt){jr(c,c.return,Rt)}}break;case 1:ou(f,c),Uu(c),_&512&&g!==null&&Kf(g,g.return);break;case 5:if(ou(f,c),Uu(c),_&512&&g!==null&&Kf(g,g.return),c.flags&32){var T=c.stateNode;try{en(T,"")}catch(Rt){jr(c,c.return,Rt)}}if(_&4&&(T=c.stateNode,T!=null)){var V=c.memoizedProps,Y=g!==null?g.memoizedProps:V,ve=c.type,Se=c.updateQueue;if(c.updateQueue=null,Se!==null)try{ve==="input"&&V.type==="radio"&&V.name!=null&&ie(T,V),ho(ve,Y);var je=ho(ve,V);for(Y=0;Y<Se.length;Y+=2){var st=Se[Y],ut=Se[Y+1];st==="style"?qr(T,ut):st==="dangerouslySetInnerHTML"?Ut(T,ut):st==="children"?en(T,ut):N(T,st,ut,je)}switch(ve){case"input":ft(T,V);break;case"textarea":Vt(T,V);break;case"select":var ot=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!V.multiple;var Et=V.value;Et!=null?lt(T,!!V.multiple,Et,!1):ot!==!!V.multiple&&(V.defaultValue!=null?lt(T,!!V.multiple,V.defaultValue,!0):lt(T,!!V.multiple,V.multiple?[]:"",!1))}T[Sc]=V}catch(Rt){jr(c,c.return,Rt)}}break;case 6:if(ou(f,c),Uu(c),_&4){if(c.stateNode===null)throw Error(t(162));T=c.stateNode,V=c.memoizedProps;try{T.nodeValue=V}catch(Rt){jr(c,c.return,Rt)}}break;case 3:if(ou(f,c),Uu(c),_&4&&g!==null&&g.memoizedState.isDehydrated)try{pi(f.containerInfo)}catch(Rt){jr(c,c.return,Rt)}break;case 4:ou(f,c),Uu(c);break;case 13:ou(f,c),Uu(c),T=c.child,T.flags&8192&&(V=T.memoizedState!==null,T.stateNode.isHidden=V,!V||T.alternate!==null&&T.alternate.memoizedState!==null||(P1=$n())),_&4&&N5(c);break;case 22:if(st=g!==null&&g.memoizedState!==null,c.mode&1?(Ao=(je=Ao)||st,ou(f,c),Ao=je):ou(f,c),Uu(c),_&8192){if(je=c.memoizedState!==null,(c.stateNode.isHidden=je)&&!st&&(c.mode&1)!==0)for(Ct=c,st=c.child;st!==null;){for(ut=Ct=st;Ct!==null;){switch(ot=Ct,Et=ot.child,ot.tag){case 0:case 11:case 14:case 15:Sp(4,ot,ot.return);break;case 1:Kf(ot,ot.return);var It=ot.stateNode;if(typeof It.componentWillUnmount=="function"){_=ot,g=ot.return;try{f=_,It.props=f.memoizedProps,It.state=f.memoizedState,It.componentWillUnmount()}catch(Rt){jr(_,g,Rt)}}break;case 5:Kf(ot,ot.return);break;case 22:if(ot.memoizedState!==null){L5(ut);continue}}Et!==null?(Et.return=ot,Ct=Et):L5(ut)}st=st.sibling}e:for(st=null,ut=c;;){if(ut.tag===5){if(st===null){st=ut;try{T=ut.stateNode,je?(V=T.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none"):(ve=ut.stateNode,Se=ut.memoizedProps.style,Y=Se!=null&&Se.hasOwnProperty("display")?Se.display:null,ve.style.display=dn("display",Y))}catch(Rt){jr(c,c.return,Rt)}}}else if(ut.tag===6){if(st===null)try{ut.stateNode.nodeValue=je?"":ut.memoizedProps}catch(Rt){jr(c,c.return,Rt)}}else if((ut.tag!==22&&ut.tag!==23||ut.memoizedState===null||ut===c)&&ut.child!==null){ut.child.return=ut,ut=ut.child;continue}if(ut===c)break e;for(;ut.sibling===null;){if(ut.return===null||ut.return===c)break e;st===ut&&(st=null),ut=ut.return}st===ut&&(st=null),ut.sibling.return=ut.return,ut=ut.sibling}}break;case 19:ou(f,c),Uu(c),_&4&&N5(c);break;case 21:break;default:ou(f,c),Uu(c)}}function Uu(c){var f=c.flags;if(f&2){try{e:{for(var g=c.return;g!==null;){if(I5(g)){var _=g;break e}g=g.return}throw Error(t(160))}switch(_.tag){case 5:var T=_.stateNode;_.flags&32&&(en(T,""),_.flags&=-33);var V=T5(c);T1(c,V,T);break;case 3:case 4:var Y=_.stateNode.containerInfo,ve=T5(c);I1(c,ve,Y);break;default:throw Error(t(161))}}catch(Se){jr(c,c.return,Se)}c.flags&=-3}f&4096&&(c.flags&=-4097)}function sP(c,f,g){Ct=c,R5(c)}function R5(c,f,g){for(var _=(c.mode&1)!==0;Ct!==null;){var T=Ct,V=T.child;if(T.tag===22&&_){var Y=T.memoizedState!==null||mg;if(!Y){var ve=T.alternate,Se=ve!==null&&ve.memoizedState!==null||Ao;ve=mg;var je=Ao;if(mg=Y,(Ao=Se)&&!je)for(Ct=T;Ct!==null;)Y=Ct,Se=Y.child,Y.tag===22&&Y.memoizedState!==null?M5(T):Se!==null?(Se.return=Y,Ct=Se):M5(T);for(;V!==null;)Ct=V,R5(V),V=V.sibling;Ct=T,mg=ve,Ao=je}D5(c)}else(T.subtreeFlags&8772)!==0&&V!==null?(V.return=T,Ct=V):D5(c)}}function D5(c){for(;Ct!==null;){var f=Ct;if((f.flags&8772)!==0){var g=f.alternate;try{if((f.flags&8772)!==0)switch(f.tag){case 0:case 11:case 15:Ao||gg(5,f);break;case 1:var _=f.stateNode;if(f.flags&4&&!Ao)if(g===null)_.componentDidMount();else{var T=f.elementType===f.type?g.memoizedProps:ru(f.type,g.memoizedProps);_.componentDidUpdate(T,g.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var V=f.updateQueue;V!==null&&Ml(f,V,_);break;case 3:var Y=f.updateQueue;if(Y!==null){if(g=null,f.child!==null)switch(f.child.tag){case 5:g=f.child.stateNode;break;case 1:g=f.child.stateNode}Ml(f,Y,g)}break;case 5:var ve=f.stateNode;if(g===null&&f.flags&4){g=ve;var Se=f.memoizedProps;switch(f.type){case"button":case"input":case"select":case"textarea":Se.autoFocus&&g.focus();break;case"img":Se.src&&(g.src=Se.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(f.memoizedState===null){var je=f.alternate;if(je!==null){var st=je.memoizedState;if(st!==null){var ut=st.dehydrated;ut!==null&&pi(ut)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ao||f.flags&512&&C1(f)}catch(ot){jr(f,f.return,ot)}}if(f===c){Ct=null;break}if(g=f.sibling,g!==null){g.return=f.return,Ct=g;break}Ct=f.return}}function L5(c){for(;Ct!==null;){var f=Ct;if(f===c){Ct=null;break}var g=f.sibling;if(g!==null){g.return=f.return,Ct=g;break}Ct=f.return}}function M5(c){for(;Ct!==null;){var f=Ct;try{switch(f.tag){case 0:case 11:case 15:var g=f.return;try{gg(4,f)}catch(Se){jr(f,g,Se)}break;case 1:var _=f.stateNode;if(typeof _.componentDidMount=="function"){var T=f.return;try{_.componentDidMount()}catch(Se){jr(f,T,Se)}}var V=f.return;try{C1(f)}catch(Se){jr(f,V,Se)}break;case 5:var Y=f.return;try{C1(f)}catch(Se){jr(f,Y,Se)}}}catch(Se){jr(f,f.return,Se)}if(f===c){Ct=null;break}var ve=f.sibling;if(ve!==null){ve.return=f.return,Ct=ve;break}Ct=f.return}}var aP=Math.ceil,vg=F.ReactCurrentDispatcher,k1=F.ReactCurrentOwner,Ca=F.ReactCurrentBatchConfig,Dn=0,Vi=null,ii=null,ro=0,$s=0,Xf=Ws(0),wi=0,Ap=null,qh=0,yg=0,N1=0,Cp=null,bs=null,P1=0,Yf=1/0,Bl=null,wg=!1,R1=null,Lc=null,bg=!1,Mc=null,xg=0,Ip=0,D1=null,_g=-1,Eg=0;function ns(){return(Dn&6)!==0?$n():_g!==-1?_g:_g=$n()}function Fc(c){return(c.mode&1)===0?1:(Dn&2)!==0&&ro!==0?ro&-ro:Xn.transition!==null?(Eg===0&&(Eg=la()),Eg):(c=mn,c!==0||(c=window.event,c=c===void 0?16:Tu(c.type)),c)}function su(c,f,g,_){if(50<Ip)throw Ip=0,D1=null,Error(t(185));Ms(c,g,_),((Dn&2)===0||c!==Vi)&&(c===Vi&&((Dn&2)===0&&(yg|=g),wi===4&&Oc(c,ro)),xs(c,_),g===1&&Dn===0&&(f.mode&1)===0&&(Yf=$n()+500,jh&&z()))}function xs(c,f){var g=c.callbackNode;br(c,f);var _=hi(c,c===Vi?ro:0);if(_===0)g!==null&&oa(g),c.callbackNode=null,c.callbackPriority=0;else if(f=_&-_,c.callbackPriority!==f){if(g!=null&&oa(g),f===1)c.tag===0?P(O5.bind(null,c)):S(O5.bind(null,c)),u1(function(){(Dn&6)===0&&z()}),g=null;else{switch(ss(_)){case 1:g=os;break;case 4:g=Ls;break;case 16:g=mo;break;case 536870912:g=sc;break;default:g=mo}g=H5(g,F5.bind(null,c))}c.callbackPriority=f,c.callbackNode=g}}function F5(c,f){if(_g=-1,Eg=0,(Dn&6)!==0)throw Error(t(327));var g=c.callbackNode;if(Jf()&&c.callbackNode!==g)return null;var _=hi(c,c===Vi?ro:0);if(_===0)return null;if((_&30)!==0||(_&c.expiredLanes)!==0||f)f=Sg(c,_);else{f=_;var T=Dn;Dn|=2;var V=V5();(Vi!==c||ro!==f)&&(Bl=null,Yf=$n()+500,Gh(c,f));do try{cP();break}catch(ve){B5(c,ve)}while(!0);yi(),vg.current=V,Dn=T,ii!==null?f=0:(Vi=null,ro=0,f=wi)}if(f!==0){if(f===2&&(T=fi(c),T!==0&&(_=T,f=L1(c,T))),f===1)throw g=Ap,Gh(c,0),Oc(c,_),xs(c,$n()),g;if(f===6)Oc(c,_);else{if(T=c.current.alternate,(_&30)===0&&!uP(T)&&(f=Sg(c,_),f===2&&(V=fi(c),V!==0&&(_=V,f=L1(c,V))),f===1))throw g=Ap,Gh(c,0),Oc(c,_),xs(c,$n()),g;switch(c.finishedWork=T,c.finishedLanes=_,f){case 0:case 1:throw Error(t(345));case 2:$h(c,bs,Bl);break;case 3:if(Oc(c,_),(_&130023424)===_&&(f=P1+500-$n(),10<f)){if(hi(c,0)!==0)break;if(T=c.suspendedLanes,(T&_)!==_){ns(),c.pingedLanes|=c.suspendedLanes&T;break}c.timeoutHandle=dp($h.bind(null,c,bs,Bl),f);break}$h(c,bs,Bl);break;case 4:if(Oc(c,_),(_&4194240)===_)break;for(f=c.eventTimes,T=-1;0<_;){var Y=31-ci(_);V=1<<Y,Y=f[Y],Y>T&&(T=Y),_&=~V}if(_=T,_=$n()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*aP(_/1960))-_,10<_){c.timeoutHandle=dp($h.bind(null,c,bs,Bl),_);break}$h(c,bs,Bl);break;case 5:$h(c,bs,Bl);break;default:throw Error(t(329))}}}return xs(c,$n()),c.callbackNode===g?F5.bind(null,c):null}function L1(c,f){var g=Cp;return c.current.memoizedState.isDehydrated&&(Gh(c,f).flags|=256),c=Sg(c,f),c!==2&&(f=bs,bs=g,f!==null&&M1(f)),c}function M1(c){bs===null?bs=c:bs.push.apply(bs,c)}function uP(c){for(var f=c;;){if(f.flags&16384){var g=f.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var _=0;_<g.length;_++){var T=g[_],V=T.getSnapshot;T=T.value;try{if(!Rn(V(),T))return!1}catch{return!1}}}if(g=f.child,f.subtreeFlags&16384&&g!==null)g.return=f,f=g;else{if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Oc(c,f){for(f&=~N1,f&=~yg,c.suspendedLanes|=f,c.pingedLanes&=~f,c=c.expirationTimes;0<f;){var g=31-ci(f),_=1<<g;c[g]=-1,f&=~_}}function O5(c){if((Dn&6)!==0)throw Error(t(327));Jf();var f=hi(c,0);if((f&1)===0)return xs(c,$n()),null;var g=Sg(c,f);if(c.tag!==0&&g===2){var _=fi(c);_!==0&&(f=_,g=L1(c,_))}if(g===1)throw g=Ap,Gh(c,0),Oc(c,f),xs(c,$n()),g;if(g===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=f,$h(c,bs,Bl),xs(c,$n()),null}function F1(c,f){var g=Dn;Dn|=1;try{return c(f)}finally{Dn=g,Dn===0&&(Yf=$n()+500,jh&&z())}}function Hh(c){Mc!==null&&Mc.tag===0&&(Dn&6)===0&&Jf();var f=Dn;Dn|=1;var g=Ca.transition,_=mn;try{if(Ca.transition=null,mn=1,c)return c()}finally{mn=_,Ca.transition=g,Dn=f,(Dn&6)===0&&z()}}function O1(){$s=Xf.current,Wn(Xf)}function Gh(c,f){c.finishedWork=null,c.finishedLanes=0;var g=c.timeoutHandle;if(g!==-1&&(c.timeoutHandle=-1,ng(g)),ii!==null)for(g=ii.return;g!==null;){var _=g;switch(Ce(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Ff();break;case 3:Ea(),Wn(xo),Wn(vi),bp();break;case 5:yp(_);break;case 4:Ea();break;case 13:Wn(or);break;case 19:Wn(or);break;case 10:Eo(_.type._context);break;case 22:case 23:O1()}g=g.return}if(Vi=c,ii=c=Bc(c.current,null),ro=$s=f,wi=0,Ap=null,N1=yg=qh=0,bs=Cp=null,Jo!==null){for(f=0;f<Jo.length;f++)if(g=Jo[f],_=g.interleaved,_!==null){g.interleaved=null;var T=_.next,V=g.pending;if(V!==null){var Y=V.next;V.next=T,_.next=Y}g.pending=_}Jo=null}return c}function B5(c,f){do{var g=ii;try{if(yi(),Bf.current=hg,Nc){for(var _=ur.memoizedState;_!==null;){var T=_.queue;T!==null&&(T.pending=null),_=_.next}Nc=!1}if(Sa=0,Ir=Vr=ur=null,tu=!1,Pc=0,k1.current=null,g===null||g.return===null){wi=1,Ap=f,ii=null;break}e:{var V=c,Y=g.return,ve=g,Se=f;if(f=ro,ve.flags|=32768,Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var je=Se,st=ve,ut=st.tag;if((st.mode&1)===0&&(ut===0||ut===11||ut===15)){var ot=st.alternate;ot?(st.updateQueue=ot.updateQueue,st.memoizedState=ot.memoizedState,st.lanes=ot.lanes):(st.updateQueue=null,st.memoizedState=null)}var Et=l5(Y);if(Et!==null){Et.flags&=-257,c5(Et,Y,ve,V,f),Et.mode&1&&u5(V,je,f),f=Et,Se=je;var It=f.updateQueue;if(It===null){var Rt=new Set;Rt.add(Se),f.updateQueue=Rt}else It.add(Se);break e}else{if((f&1)===0){u5(V,je,f),B1();break e}Se=Error(t(426))}}else if(Ge&&ve.mode&1){var Kr=l5(Y);if(Kr!==null){(Kr.flags&65536)===0&&(Kr.flags|=256),c5(Kr,Y,ve,V,f),qn($f(Se,ve));break e}}V=Se=$f(Se,ve),wi!==4&&(wi=2),Cp===null?Cp=[V]:Cp.push(V),V=Y;do{switch(V.tag){case 3:V.flags|=65536,f&=-f,V.lanes|=f;var Me=s5(V,Se,f);ys(V,Me);break e;case 1:ve=Se;var ke=V.type,Oe=V.stateNode;if((V.flags&128)===0&&(typeof ke.getDerivedStateFromError=="function"||Oe!==null&&typeof Oe.componentDidCatch=="function"&&(Lc===null||!Lc.has(Oe)))){V.flags|=65536,f&=-f,V.lanes|=f;var ht=a5(V,ve,f);ys(V,ht);break e}}V=V.return}while(V!==null)}U5(g)}catch(Mt){f=Mt,ii===g&&g!==null&&(ii=g=g.return);continue}break}while(!0)}function V5(){var c=vg.current;return vg.current=hg,c===null?hg:c}function B1(){(wi===0||wi===3||wi===2)&&(wi=4),Vi===null||(qh&268435455)===0&&(yg&268435455)===0||Oc(Vi,ro)}function Sg(c,f){var g=Dn;Dn|=2;var _=V5();(Vi!==c||ro!==f)&&(Bl=null,Gh(c,f));do try{lP();break}catch(T){B5(c,T)}while(!0);if(yi(),Dn=g,vg.current=_,ii!==null)throw Error(t(261));return Vi=null,ro=0,wi}function lP(){for(;ii!==null;)j5(ii)}function cP(){for(;ii!==null&&!La();)j5(ii)}function j5(c){var f=q5(c.alternate,c,$s);c.memoizedProps=c.pendingProps,f===null?U5(c):ii=f,k1.current=null}function U5(c){var f=c;do{var g=f.alternate;if(c=f.return,(f.flags&32768)===0){if(g=nP(g,f,$s),g!==null){ii=g;return}}else{if(g=rP(g,f),g!==null){g.flags&=32767,ii=g;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{wi=6,ii=null;return}}if(f=f.sibling,f!==null){ii=f;return}ii=f=c}while(f!==null);wi===0&&(wi=5)}function $h(c,f,g){var _=mn,T=Ca.transition;try{Ca.transition=null,mn=1,hP(c,f,g,_)}finally{Ca.transition=T,mn=_}return null}function hP(c,f,g,_){do Jf();while(Mc!==null);if((Dn&6)!==0)throw Error(t(327));g=c.finishedWork;var T=c.finishedLanes;if(g===null)return null;if(c.finishedWork=null,c.finishedLanes=0,g===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var V=g.lanes|g.childLanes;if(jn(c,V),c===Vi&&(ii=Vi=null,ro=0),(g.subtreeFlags&2064)===0&&(g.flags&2064)===0||bg||(bg=!0,H5(mo,function(){return Jf(),null})),V=(g.flags&15990)!==0,(g.subtreeFlags&15990)!==0||V){V=Ca.transition,Ca.transition=null;var Y=mn;mn=1;var ve=Dn;Dn|=4,k1.current=null,oP(c,g),P5(g,c),Al(Nl),fa=!!Bh,Nl=Bh=null,c.current=g,sP(g),ic(),Dn=ve,mn=Y,Ca.transition=V}else c.current=g;if(bg&&(bg=!1,Mc=c,xg=T),V=c.pendingLanes,V===0&&(Lc=null),Fa(g.stateNode),xs(c,$n()),f!==null)for(_=c.onRecoverableError,g=0;g<f.length;g++)T=f[g],_(T.value,{componentStack:T.stack,digest:T.digest});if(wg)throw wg=!1,c=R1,R1=null,c;return(xg&1)!==0&&c.tag!==0&&Jf(),V=c.pendingLanes,(V&1)!==0?c===D1?Ip++:(Ip=0,D1=c):Ip=0,z(),null}function Jf(){if(Mc!==null){var c=ss(xg),f=Ca.transition,g=mn;try{if(Ca.transition=null,mn=16>c?16:c,Mc===null)var _=!1;else{if(c=Mc,Mc=null,xg=0,(Dn&6)!==0)throw Error(t(331));var T=Dn;for(Dn|=4,Ct=c.current;Ct!==null;){var V=Ct,Y=V.child;if((Ct.flags&16)!==0){var ve=V.deletions;if(ve!==null){for(var Se=0;Se<ve.length;Se++){var je=ve[Se];for(Ct=je;Ct!==null;){var st=Ct;switch(st.tag){case 0:case 11:case 15:Sp(8,st,V)}var ut=st.child;if(ut!==null)ut.return=st,Ct=ut;else for(;Ct!==null;){st=Ct;var ot=st.sibling,Et=st.return;if(C5(st),st===je){Ct=null;break}if(ot!==null){ot.return=Et,Ct=ot;break}Ct=Et}}}var It=V.alternate;if(It!==null){var Rt=It.child;if(Rt!==null){It.child=null;do{var Kr=Rt.sibling;Rt.sibling=null,Rt=Kr}while(Rt!==null)}}Ct=V}}if((V.subtreeFlags&2064)!==0&&Y!==null)Y.return=V,Ct=Y;else e:for(;Ct!==null;){if(V=Ct,(V.flags&2048)!==0)switch(V.tag){case 0:case 11:case 15:Sp(9,V,V.return)}var Me=V.sibling;if(Me!==null){Me.return=V.return,Ct=Me;break e}Ct=V.return}}var ke=c.current;for(Ct=ke;Ct!==null;){Y=Ct;var Oe=Y.child;if((Y.subtreeFlags&2064)!==0&&Oe!==null)Oe.return=Y,Ct=Oe;else e:for(Y=ke;Ct!==null;){if(ve=Ct,(ve.flags&2048)!==0)try{switch(ve.tag){case 0:case 11:case 15:gg(9,ve)}}catch(Mt){jr(ve,ve.return,Mt)}if(ve===Y){Ct=null;break e}var ht=ve.sibling;if(ht!==null){ht.return=ve.return,Ct=ht;break e}Ct=ve.return}}if(Dn=T,z(),Gi&&typeof Gi.onPostCommitFiberRoot=="function")try{Gi.onPostCommitFiberRoot(sa,c)}catch{}_=!0}return _}finally{mn=g,Ca.transition=f}}return!1}function z5(c,f,g){f=$f(g,f),f=s5(c,f,1),c=vs(c,f,1),f=ns(),c!==null&&(Ms(c,1,f),xs(c,f))}function jr(c,f,g){if(c.tag===3)z5(c,c,g);else for(;f!==null;){if(f.tag===3){z5(f,c,g);break}else if(f.tag===1){var _=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Lc===null||!Lc.has(_))){c=$f(g,c),c=a5(f,c,1),f=vs(f,c,1),c=ns(),f!==null&&(Ms(f,1,c),xs(f,c));break}}f=f.return}}function fP(c,f,g){var _=c.pingCache;_!==null&&_.delete(f),f=ns(),c.pingedLanes|=c.suspendedLanes&g,Vi===c&&(ro&g)===g&&(wi===4||wi===3&&(ro&130023424)===ro&&500>$n()-P1?Gh(c,0):N1|=g),xs(c,f)}function W5(c,f){f===0&&((c.mode&1)===0?f=1:(f=aa,aa<<=1,(aa&130023424)===0&&(aa=4194304)));var g=ns();c=Bn(c,f),c!==null&&(Ms(c,f,g),xs(c,g))}function dP(c){var f=c.memoizedState,g=0;f!==null&&(g=f.retryLane),W5(c,g)}function pP(c,f){var g=0;switch(c.tag){case 13:var _=c.stateNode,T=c.memoizedState;T!==null&&(g=T.retryLane);break;case 19:_=c.stateNode;break;default:throw Error(t(314))}_!==null&&_.delete(f),W5(c,g)}var q5;q5=function(c,f,g){if(c!==null)if(c.memoizedProps!==f.pendingProps||xo.current)ws=!0;else{if((c.lanes&g)===0&&(f.flags&128)===0)return ws=!1,tP(c,f,g);ws=(c.flags&131072)!==0}else ws=!1,Ge&&(f.flags&1048576)!==0&&Qe(f,Z,f.index);switch(f.lanes=0,f.tag){case 2:var _=f.type;pg(c,f),c=f.pendingProps;var T=Cc(f,vi.current);pr(f,g),T=Uh(null,f,_,c,T,g);var V=Aa();return f.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(f.tag=1,f.memoizedState=null,f.updateQueue=null,_o(_)?(V=!0,Dl(f)):V=!1,f.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,Of(f),T.updater=fg,f.stateNode=T,T._reactInternals=f,m1(f,_,c,g),f=w1(null,f,_,!0,V,g)):(f.tag=0,Ge&&V&&ze(f),ts(null,f,T,g),f=f.child),f;case 16:_=f.elementType;e:{switch(pg(c,f),c=f.pendingProps,T=_._init,_=T(_._payload),f.type=_,T=f.tag=gP(_),c=ru(_,c),T){case 0:f=y1(null,f,_,c,g);break e;case 1:f=g5(null,f,_,c,g);break e;case 11:f=h5(null,f,_,c,g);break e;case 14:f=f5(null,f,_,ru(_.type,c),g);break e}throw Error(t(306,_,""))}return f;case 0:return _=f.type,T=f.pendingProps,T=f.elementType===_?T:ru(_,T),y1(c,f,_,T,g);case 1:return _=f.type,T=f.pendingProps,T=f.elementType===_?T:ru(_,T),g5(c,f,_,T,g);case 3:e:{if(v5(f),c===null)throw Error(t(387));_=f.pendingProps,V=f.memoizedState,T=V.element,vp(c,f),Za(f,_,null,g);var Y=f.memoizedState;if(_=Y.element,V.isDehydrated)if(V={element:_,isDehydrated:!1,cache:Y.cache,pendingSuspenseBoundaries:Y.pendingSuspenseBoundaries,transitions:Y.transitions},f.updateQueue.baseState=V,f.memoizedState=V,f.flags&256){T=$f(Error(t(423)),f),f=y5(c,f,_,g,T);break e}else if(_!==T){T=$f(Error(t(424)),f),f=y5(c,f,_,g,T);break e}else for(Ke=eo(f.stateNode.containerInfo.firstChild),Ie=f,Ge=!0,Xe=null,g=On(f,null,_,g),f.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(hn(),_===T){f=Ol(c,f,g);break e}ts(c,f,_,g)}f=f.child}return f;case 5:return sg(f),c===null&&yt(f),_=f.type,T=f.pendingProps,V=c!==null?c.memoizedProps:null,Y=T.children,fp(_,T)?Y=null:V!==null&&fp(_,V)&&(f.flags|=32),m5(c,f),ts(c,f,Y,g),f.child;case 6:return c===null&&yt(f),null;case 13:return w5(c,f,g);case 4:return kc(f,f.stateNode.containerInfo),_=f.pendingProps,c===null?f.child=Hr(f,null,_,g):ts(c,f,_,g),f.child;case 11:return _=f.type,T=f.pendingProps,T=f.elementType===_?T:ru(_,T),h5(c,f,_,T,g);case 7:return ts(c,f,f.pendingProps,g),f.child;case 8:return ts(c,f,f.pendingProps.children,g),f.child;case 12:return ts(c,f,f.pendingProps.children,g),f.child;case 10:e:{if(_=f.type._context,T=f.pendingProps,V=f.memoizedProps,Y=T.value,Kn(Oi,_._currentValue),_._currentValue=Y,V!==null)if(Rn(V.value,Y)){if(V.children===T.children&&!xo.current){f=Ol(c,f,g);break e}}else for(V=f.child,V!==null&&(V.return=f);V!==null;){var ve=V.dependencies;if(ve!==null){Y=V.child;for(var Se=ve.firstContext;Se!==null;){if(Se.context===_){if(V.tag===1){Se=gs(-1,g&-g),Se.tag=2;var je=V.updateQueue;if(je!==null){je=je.shared;var st=je.pending;st===null?Se.next=Se:(Se.next=st.next,st.next=Se),je.pending=Se}}V.lanes|=g,Se=V.alternate,Se!==null&&(Se.lanes|=g),ms(V.return,g,f),ve.lanes|=g;break}Se=Se.next}}else if(V.tag===10)Y=V.type===f.type?null:V.child;else if(V.tag===18){if(Y=V.return,Y===null)throw Error(t(341));Y.lanes|=g,ve=Y.alternate,ve!==null&&(ve.lanes|=g),ms(Y,g,f),Y=V.sibling}else Y=V.child;if(Y!==null)Y.return=V;else for(Y=V;Y!==null;){if(Y===f){Y=null;break}if(V=Y.sibling,V!==null){V.return=Y.return,Y=V;break}Y=Y.return}V=Y}ts(c,f,T.children,g),f=f.child}return f;case 9:return T=f.type,_=f.pendingProps.children,pr(f,g),T=Br(T),_=_(T),f.flags|=1,ts(c,f,_,g),f.child;case 14:return _=f.type,T=ru(_,f.pendingProps),T=ru(_.type,T),f5(c,f,_,T,g);case 15:return d5(c,f,f.type,f.pendingProps,g);case 17:return _=f.type,T=f.pendingProps,T=f.elementType===_?T:ru(_,T),pg(c,f),f.tag=1,_o(_)?(c=!0,Dl(f)):c=!1,pr(f,g),i5(f,_,T),m1(f,_,T,g),w1(null,f,_,!0,c,g);case 19:return x5(c,f,g);case 22:return p5(c,f,g)}throw Error(t(156,f.tag))};function H5(c,f){return Ds(c,f)}function mP(c,f,g,_){this.tag=c,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ia(c,f,g,_){return new mP(c,f,g,_)}function V1(c){return c=c.prototype,!(!c||!c.isReactComponent)}function gP(c){if(typeof c=="function")return V1(c)?1:0;if(c!=null){if(c=c.$$typeof,c===M)return 11;if(c===de)return 14}return 2}function Bc(c,f){var g=c.alternate;return g===null?(g=Ia(c.tag,f,c.key,c.mode),g.elementType=c.elementType,g.type=c.type,g.stateNode=c.stateNode,g.alternate=c,c.alternate=g):(g.pendingProps=f,g.type=c.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=c.flags&14680064,g.childLanes=c.childLanes,g.lanes=c.lanes,g.child=c.child,g.memoizedProps=c.memoizedProps,g.memoizedState=c.memoizedState,g.updateQueue=c.updateQueue,f=c.dependencies,g.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},g.sibling=c.sibling,g.index=c.index,g.ref=c.ref,g}function Ag(c,f,g,_,T,V){var Y=2;if(_=c,typeof c=="function")V1(c)&&(Y=1);else if(typeof c=="string")Y=5;else e:switch(c){case k:return Kh(g.children,T,V,f);case C:Y=8,T|=8;break;case L:return c=Ia(12,g,f,T|2),c.elementType=L,c.lanes=V,c;case U:return c=Ia(13,g,f,T),c.elementType=U,c.lanes=V,c;case J:return c=Ia(19,g,f,T),c.elementType=J,c.lanes=V,c;case he:return Cg(g,T,V,f);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case B:Y=10;break e;case R:Y=9;break e;case M:Y=11;break e;case de:Y=14;break e;case fe:Y=16,_=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return f=Ia(Y,g,f,T),f.elementType=c,f.type=_,f.lanes=V,f}function Kh(c,f,g,_){return c=Ia(7,c,_,f),c.lanes=g,c}function Cg(c,f,g,_){return c=Ia(22,c,_,f),c.elementType=he,c.lanes=g,c.stateNode={isHidden:!1},c}function j1(c,f,g){return c=Ia(6,c,null,f),c.lanes=g,c}function U1(c,f,g){return f=Ia(4,c.children!==null?c.children:[],c.key,f),f.lanes=g,f.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},f}function vP(c,f,g,_,T){this.tag=f,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ca(0),this.expirationTimes=ca(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ca(0),this.identifierPrefix=_,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function z1(c,f,g,_,T,V,Y,ve,Se){return c=new vP(c,f,g,ve,Se),f===1?(f=1,V===!0&&(f|=8)):f=0,V=Ia(3,null,null,f),c.current=V,V.stateNode=c,V.memoizedState={element:_,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},Of(V),c}function yP(c,f,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:_==null?null:""+_,children:c,containerInfo:f,implementation:g}}function G5(c){if(!c)return Ou;c=c._reactInternals;e:{if(Ar(c)!==c||c.tag!==1)throw Error(t(170));var f=c;do{switch(f.tag){case 3:f=f.stateNode.context;break e;case 1:if(_o(f.type)){f=f.stateNode.__reactInternalMemoizedMergedChildContext;break e}}f=f.return}while(f!==null);throw Error(t(171))}if(c.tag===1){var g=c.type;if(_o(g))return gp(c,g,f)}return f}function $5(c,f,g,_,T,V,Y,ve,Se){return c=z1(g,_,!0,c,T,V,Y,ve,Se),c.context=G5(null),g=c.current,_=ns(),T=Fc(g),V=gs(_,T),V.callback=f??null,vs(g,V,T),c.current.lanes=T,Ms(c,T,_),xs(c,_),c}function Ig(c,f,g,_){var T=f.current,V=ns(),Y=Fc(T);return g=G5(g),f.context===null?f.context=g:f.pendingContext=g,f=gs(V,Y),f.payload={element:c},_=_===void 0?null:_,_!==null&&(f.callback=_),c=vs(T,f,Y),c!==null&&(su(c,T,Y,V),Ll(c,T,Y)),Y}function Tg(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function K5(c,f){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var g=c.retryLane;c.retryLane=g!==0&&g<f?g:f}}function W1(c,f){K5(c,f),(c=c.alternate)&&K5(c,f)}function wP(){return null}var X5=typeof reportError=="function"?reportError:function(c){console.error(c)};function q1(c){this._internalRoot=c}kg.prototype.render=q1.prototype.render=function(c){var f=this._internalRoot;if(f===null)throw Error(t(409));Ig(c,f,null,null)},kg.prototype.unmount=q1.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var f=c.containerInfo;Hh(function(){Ig(null,c,null,null)}),f[Fi]=null}};function kg(c){this._internalRoot=c}kg.prototype.unstable_scheduleHydration=function(c){if(c){var f=as();c={blockedOn:null,target:c,priority:f};for(var g=0;g<us.length&&f!==0&&f<us[g].priority;g++);us.splice(g,0,c),g===0&&Iu(c)}};function H1(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function Ng(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function Y5(){}function bP(c,f,g,_,T){if(T){if(typeof _=="function"){var V=_;_=function(){var je=Tg(Y);V.call(je)}}var Y=$5(f,_,c,0,null,!1,!1,"",Y5);return c._reactRootContainer=Y,c[Fi]=Y.current,Tl(c.nodeType===8?c.parentNode:c),Hh(),Y}for(;T=c.lastChild;)c.removeChild(T);if(typeof _=="function"){var ve=_;_=function(){var je=Tg(Se);ve.call(je)}}var Se=z1(c,0,!1,null,null,!1,!1,"",Y5);return c._reactRootContainer=Se,c[Fi]=Se.current,Tl(c.nodeType===8?c.parentNode:c),Hh(function(){Ig(f,Se,g,_)}),Se}function Pg(c,f,g,_,T){var V=g._reactRootContainer;if(V){var Y=V;if(typeof T=="function"){var ve=T;T=function(){var Se=Tg(Y);ve.call(Se)}}Ig(f,Y,c,T)}else Y=bP(g,f,c,T,_);return Tg(Y)}ac=function(c){switch(c.tag){case 3:var f=c.stateNode;if(f.current.memoizedState.isDehydrated){var g=ua(f.pendingLanes);g!==0&&(Fs(f,g|1),xs(f,$n()),(Dn&6)===0&&(Yf=$n()+500,z()))}break;case 13:Hh(function(){var _=Bn(c,1);if(_!==null){var T=ns();su(_,c,1,T)}}),W1(c,1)}},Au=function(c){if(c.tag===13){var f=Bn(c,134217728);if(f!==null){var g=ns();su(f,c,134217728,g)}W1(c,134217728)}},uc=function(c){if(c.tag===13){var f=Fc(c),g=Bn(c,f);if(g!==null){var _=ns();su(g,c,f,_)}W1(c,f)}},as=function(){return mn},Ba=function(c,f){var g=mn;try{return mn=c,f()}finally{mn=g}},Jn=function(c,f,g){switch(f){case"input":if(ft(c,g),f=g.name,g.type==="radio"&&f!=null){for(g=c;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+f)+'][type="radio"]'),f=0;f<g.length;f++){var _=g[f];if(_!==c&&_.form===c.form){var T=Vh(_);if(!T)throw Error(t(90));et(_),ft(_,T)}}}break;case"textarea":Vt(c,g);break;case"select":f=g.value,f!=null&&lt(c,!!g.multiple,f,!1)}},zo=F1,Sr=Hh;var xP={usingClientEntryPoint:!1,Events:[Ac,Pl,Vh,Wt,En,F1]},Tp={findFiberByHostInstance:Fu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_P={bundleType:Tp.bundleType,version:Tp.version,rendererPackageName:Tp.rendererPackageName,rendererConfig:Tp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:F.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=Ps(c),c===null?null:c.stateNode},findFiberByHostInstance:Tp.findFiberByHostInstance||wP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rg.isDisabled&&Rg.supportsFiber)try{sa=Rg.inject(_P),Gi=Rg}catch{}}return _s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xP,_s.createPortal=function(c,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!H1(f))throw Error(t(200));return yP(c,f,null,g)},_s.createRoot=function(c,f){if(!H1(c))throw Error(t(299));var g=!1,_="",T=X5;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(_=f.identifierPrefix),f.onRecoverableError!==void 0&&(T=f.onRecoverableError)),f=z1(c,1,!1,null,null,g,!1,_,T),c[Fi]=f.current,Tl(c.nodeType===8?c.parentNode:c),new q1(f)},_s.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var f=c._reactInternals;if(f===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=Ps(f),c=c===null?null:c.stateNode,c},_s.flushSync=function(c){return Hh(c)},_s.hydrate=function(c,f,g){if(!Ng(f))throw Error(t(200));return Pg(null,c,f,!0,g)},_s.hydrateRoot=function(c,f,g){if(!H1(c))throw Error(t(405));var _=g!=null&&g.hydratedSources||null,T=!1,V="",Y=X5;if(g!=null&&(g.unstable_strictMode===!0&&(T=!0),g.identifierPrefix!==void 0&&(V=g.identifierPrefix),g.onRecoverableError!==void 0&&(Y=g.onRecoverableError)),f=$5(f,null,c,1,g??null,T,!1,V,Y),c[Fi]=f.current,Tl(c),_)for(c=0;c<_.length;c++)g=_[c],T=g._getVersion,T=T(g._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[g,T]:f.mutableSourceEagerHydrationData.push(g,T);return new kg(f)},_s.render=function(c,f,g){if(!Ng(f))throw Error(t(200));return Pg(null,c,f,!1,g)},_s.unmountComponentAtNode=function(c){if(!Ng(c))throw Error(t(40));return c._reactRootContainer?(Hh(function(){Pg(null,null,c,!1,function(){c._reactRootContainer=null,c[Fi]=null})}),!0):!1},_s.unstable_batchedUpdates=F1,_s.unstable_renderSubtreeIntoContainer=function(c,f,g,_){if(!Ng(g))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return Pg(c,f,g,!1,_)},_s.version="18.3.1-next-f1338f8080-20240426",_s}var i_;function NP(){if(i_)return K1.exports;i_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),K1.exports=kP(),K1.exports}var o_;function PP(){if(o_)return Dg;o_=1;var n=NP();return Dg.createRoot=n.createRoot,Dg.hydrateRoot=n.hydrateRoot,Dg}var RP=PP();const SC=qe.createContext(),DP=({children:n})=>{const[e,t]=qe.useState(!1),[r,i]=qe.useState(!1),[o,s]=qe.useState("STANDBY"),[a,u]=qe.useState("HOME"),[l,h]=qe.useState(null),[d]=qe.useState({name:"Jim",access:"Admin"}),[p,m]=qe.useState(100),w=qe.useRef(!1),[b,x]=qe.useState([]),[E,A]=qe.useState(0),[N,F]=qe.useState({speed:0,heading:0,altitude:0,accuracy:0}),D=(Be,_e)=>{try{const ie=localStorage.getItem(Be);return ie?JSON.parse(ie):_e}catch{return _e}},[W,k]=qe.useState(()=>D("jarvis_face_db_v2",[])),[C,L]=qe.useState(()=>D("jarvis_incidents",[])),[B,R]=qe.useState(()=>D("jarvis_leads",[]));qe.useEffect(()=>{localStorage.setItem("jarvis_face_db_v2",JSON.stringify(W))},[W]),qe.useEffect(()=>{localStorage.setItem("jarvis_incidents",JSON.stringify(C))},[C]),qe.useEffect(()=>{localStorage.setItem("jarvis_leads",JSON.stringify(B))},[B]);const M=Be=>{L(_e=>[{...Be,id:Date.now(),date:new Date().toLocaleString()},..._e]),j("Incident logged.")},U=Be=>L(_e=>_e.filter(ie=>ie.id!==Be)),J=Be=>{R(_e=>[{...Be,id:Date.now(),status:"Potential",dateAdded:new Date().toLocaleDateString()},..._e]),j("Target added.")},de=(Be,_e)=>{R(ie=>ie.map(ft=>ft.id===Be?{...ft,status:_e}:ft)),j("Status updated.")},fe=Be=>R(_e=>_e.filter(ie=>ie.id!==Be)),he=Be=>{const _e=[...W];_e.splice(Be,1),k(_e),j("Record deleted.")},K=(Be,_e)=>{const ie=[...W];ie[Be]={...ie[Be],..._e},k(ie),j("Record updated.")},le=Be=>{k(_e=>[..._e,{...Be,dateAdded:new Date().toLocaleDateString()}]),j("Identity added.")},se=()=>{k([]),j("Database wiped.")};qe.useEffect(()=>{const Be=()=>{const _e=window.speechSynthesis.getVoices();if(_e.length>0){x(_e);const ie=localStorage.getItem("jarvis_voice_index");if(ie)A(parseInt(ie));else{const ft=_e.findIndex(dt=>dt.name.includes("Google UK English Male"));ft!==-1&&A(ft)}}};Be(),window.speechSynthesis.onvoiceschanged=Be},[]);const re=Be=>{A(Be),localStorage.setItem("jarvis_voice_index",Be)},j=(Be,_e=!1)=>{if(!window.speechSynthesis)return;if(window.speechSynthesis.cancel(),$.current)try{$.current.stop()}catch{}i(!0);const ie=new SpeechSynthesisUtterance(Be);b.length>0&&(ie.voice=b[E]),ie.rate=1,ie.pitch=1,ie.onend=()=>{i(!1),(w.current||_e)&&setTimeout(()=>be(),200)},window.speechSynthesis.speak(ie)},$=qe.useRef(null),[ne,ce]=qe.useState("IDLE"),[ge,ye]=qe.useState({});qe.useEffect(()=>{const Be=window.SpeechRecognition||window.webkitSpeechRecognition;if(Be){const _e=new Be;_e.continuous=!1,_e.interimResults=!1,_e.lang="en-US",_e.onstart=()=>{},_e.onend=()=>{w.current&&!r?setTimeout(()=>{try{_e.start()}catch{setTimeout(()=>{if(w.current)try{_e.start()}catch{}},200)}},200):w.current||t(!1)},_e.onresult=ie=>{const ft=ie.results[0][0].transcript.toLowerCase().trim();$e(ft)},$.current=_e}},[ne,a,r]);const be=()=>{if($.current&&!r)try{$.current.start()}catch{}},Ae=()=>{e?(w.current=!1,t(!1),$.current&&$.current.stop(),j("Listening paused.")):(w.current=!0,t(!0),be(),Je("startup"))},$e=Be=>{if(h({text:Be,time:Date.now()}),ne!=="IDLE"){Ue(Be);return}if(Be==="jarvis"||Be==="hey jarvis"||Be==="hello"){u("MENU_OPEN"),j("Sir?",!0);return}Be.includes("open")||Be.includes("start")||Be.includes("let's")?Be.includes("drive")||Be.includes("hud")?(u("HUD"),j("Driving protocols initiated.")):Be.includes("vision")||Be.includes("camera")?(u("VISION"),j("Visual sensors active.")):Be.includes("media")||Be.includes("music")?(u("MEDIA"),j("Media player ready.")):Be.includes("database")?(u("DATABASE"),j("Accessing records.")):Be.includes("ops")||Be.includes("incident")?(u("OPS"),j("Operations center online.")):Be.includes("recon")||Be.includes("sales")?(u("RECON"),j("Sales targeting engaged.")):Be.includes("guardian")?u("GUARDIAN"):Be.includes("comms")&&(u("COMMS_MENU"),j("Comms channels open.")):Be.includes("drive home")?(j("Setting coordinates for Home Base."),window.open("https://www.google.com/maps/dir/?api=1&destination=Home","_blank")):Be.includes("open maps")?(j("Opening global positioning."),window.open("https://www.google.com/maps","_blank")):Be.includes("close")||Be.includes("exit")||Be.includes("stop")?a!=="HOME"?(u("MENU_OPEN"),j("Module closed. Anything else?",!0)):(u("HOME"),j("Standing by.")):Be.includes("yes")&&a==="MENU_OPEN"?j("Awaiting command.",!0):Be.includes("no")&&a==="MENU_OPEN"&&(u("HOME"),j("Interface minimized."))},Ue=Be=>{const _e={...ge};if(ne==="ASK_NAME")_e.name=Be.replace(/\./g,""),ye(_e),ce("ASK_GENDER"),j(`Registered ${_e.name}. Male or Female?`,!0);else if(ne==="ASK_GENDER")_e.gender=Be.includes("female")?"Female":"Male",ye(_e),ce("ASK_AGE"),j("Age?",!0);else if(ne==="ASK_AGE")_e.age=Be.replace(/\D/g,"")||"Unknown",ye(_e),ce("ASK_ACCESS"),j("Access Level?",!0);else if(ne==="ASK_ACCESS"){let ie="No Access";Be.includes("admin")&&(ie="Admin"),Be.includes("medium")&&(ie="Medium"),Be.includes("missing")&&(ie="Missing"),_e.accessLevel=ie,_e.dateAdded=new Date().toLocaleDateString(),k(ft=>[...ft,_e]),ce("IDLE"),ye({}),j("Identity archived.")}},et=Be=>{ne==="SCANNING"&&(ye({descriptor:Be}),ce("ASK_NAME"),j("Target captured. Who is this person?",!0))};qe.useEffect(()=>{"getBattery"in navigator&&navigator.getBattery().then(ie=>m(Math.round(ie.level*100)));const Be=navigator.geolocation.watchPosition(ie=>F(ft=>({...ft,speed:ie.coords.speed?Math.round(ie.coords.speed*3.6):0,altitude:Math.round(ie.coords.altitude||0)})),ie=>{},{enableHighAccuracy:!0}),_e=ie=>{ie.webkitCompassHeading?F(ft=>({...ft,heading:ie.webkitCompassHeading})):ie.alpha&&F(ft=>({...ft,heading:360-ie.alpha}))};return window.addEventListener("deviceorientation",_e),()=>{navigator.geolocation.clearWatch(Be),window.removeEventListener("deviceorientation",_e)}},[]);const Je=Be=>{try{const _e=window.AudioContext||window.webkitAudioContext;if(!_e)return;const ie=new _e,ft=ie.createOscillator(),dt=ie.createGain();ft.connect(dt),dt.connect(ie.destination),Be==="click"?(ft.frequency.value=800,dt.gain.value=.1,dt.gain.exponentialRampToValueAtTime(.01,ie.currentTime+.1),ft.start(),ft.stop(ie.currentTime+.1)):Be==="startup"&&(ft.frequency.value=150,ft.frequency.exponentialRampToValueAtTime(600,ie.currentTime+.4),dt.gain.value=.1,dt.gain.linearRampToValueAtTime(0,ie.currentTime+.4),ft.start(),ft.stop(ie.currentTime+.4))}catch{}};return ae.jsx(SC.Provider,{value:{isListening:e,toggleListening:Ae,isSpeaking:r,speak:j,systemStatus:o,setSystemStatus:s,activeMode:a,setActiveMode:u,user:d,battery:p,playSound:Je,availableVoices:b,selectedVoiceIndex:E,changeVoice:re,conversationState:ne,triggerInterview:et,faceDatabase:W,deletePerson:he,updatePerson:K,addPerson:le,clearDatabase:se,hudData:N,incidentLog:C,addIncident:M,deleteIncident:U,leadsLog:B,addLead:J,updateLeadStatus:de,deleteLead:fe,lastCommand:l},children:n})},vu=()=>qe.useContext(SC),LP=()=>{const n=qe.useRef(null),{isSpeaking:e,isListening:t,activeMode:r}=vu();return qe.useEffect(()=>{const i=n.current,o=i.getContext("2d");let s,a=0;const u={cyan:"#00E5FF",cyanDim:"rgba(0, 229, 255, 0.2)",white:"#FFFFFF",orange:"#FF8C00",alert:"#FF0000"},l=()=>{i.width=window.innerWidth,i.height=window.innerHeight};window.addEventListener("resize",l),l();const h=(p,m,w,b=0,x=[])=>{o.beginPath(),o.arc(0,0,p,0,Math.PI*2),o.strokeStyle=w,o.lineWidth=m,o.shadowBlur=b,o.shadowColor=w,o.setLineDash(x),o.stroke(),o.setLineDash([])},d=()=>{a++;const p=i.width,m=i.height,w=p/2,b=m/2,x=Math.min(p,m)*(p<768?.35:.25);o.clearRect(0,0,p,m),o.translate(w,b);const A=a*.0015,N=r==="WARNING"?u.alert:u.cyan,F=r==="WARNING"?u.alert:u.white;o.save(),o.rotate(A);for(let k=0;k<72;k++){o.rotate(Math.PI*2/72),o.beginPath();const C=k%4===0?1.15:1.1;o.moveTo(x*1.05,0),o.lineTo(x*C,0),o.strokeStyle=N,o.lineWidth=k%4===0?3:1.5,o.shadowBlur=10,o.shadowColor=N,o.stroke()}o.restore(),o.save(),o.rotate(-A*1.2),h(x*.95,x*.08,u.cyanDim,5,[x*.2,x*.05,x*.05,x*.05]),o.rotate(Math.PI/3),h(x*.95,x*.02,N,15,[x*.3,x*1.5]),o.restore(),o.save(),o.rotate(A*1.5),h(x*.85,2,N,5,[5,10]),o.restore(),o.save(),o.rotate(-A*.8),h(x*.7,8,u.cyanDim,10),h(x*.7,4,N,20,[x*.5,x*1.2]),r!=="WARNING"&&(o.beginPath(),o.arc(0,0,x*.7,Math.PI*.5,Math.PI*.85),o.strokeStyle=u.orange,o.lineWidth=10,o.shadowBlur=30,o.shadowColor=u.orange,o.stroke(),o.beginPath(),o.arc(0,0,x*.7,Math.PI*.52,Math.PI*.83),o.strokeStyle=u.white,o.lineWidth=3,o.shadowBlur=10,o.shadowColor=u.white,o.stroke()),o.restore(),o.save(),o.rotate(A*2),h(x*.55,3,N,5,[10,15]);for(let k=0;k<4;k++)o.rotate(Math.PI/2),o.beginPath(),o.moveTo(x*.5,0),o.lineTo(x*.6,0),o.lineWidth=6,o.stroke();o.restore(),o.save(),o.rotate(-A*3),o.shadowBlur=20,o.shadowColor=N;for(let k=0;k<12;k++)o.rotate(Math.PI*2/12),o.beginPath(),o.moveTo(x*.3,0),o.lineTo(x*.45,x*.05),o.strokeStyle=N,o.lineWidth=2,o.stroke();o.restore();const D=1+Math.sin(a*.05)*.1,W=e?Math.random()*.2:0;o.save(),o.beginPath(),o.arc(0,0,x*.25*D,0,Math.PI*2),o.fillStyle=F,o.shadowBlur=50*D,o.shadowColor=F,o.fill(),h(x*.28*D,5,N,30),W>0&&h(x*.2*(1+W),10,u.white,40),o.restore(),o.resetTransform(),s=requestAnimationFrame(d)};return d(),()=>{window.removeEventListener("resize",l),cancelAnimationFrame(s)}},[e,t,r]),ae.jsx("canvas",{ref:n,className:"fixed top-0 left-0 w-full h-full z-0 pointer-events-none"})},MP=({onClose:n})=>{const{availableVoices:e,selectedVoiceIndex:t,changeVoice:r,playSound:i}=vu();return ae.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-md flex flex-col p-6 animate-fade-in",children:[ae.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-cyan/30 pb-4",children:[ae.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"SYSTEM CONFIG"}),ae.jsx("button",{onClick:()=>{i("click"),n()},className:"text-cyan hover:text-white",children:ae.jsx("i",{className:"fas fa-times text-2xl"})})]}),ae.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar",children:[ae.jsx("h3",{className:"text-cyan-dim font-mono text-xs mb-4",children:"VOCAL SYNTHESIS MODULE"}),ae.jsxs("div",{className:"flex flex-col gap-2",children:[e.length===0&&ae.jsx("div",{className:"text-red-500 font-mono text-sm",children:"LOADING VOICE PACKS..."}),e.map((o,s)=>ae.jsxs("button",{onClick:()=>{i("click"),r(s)},className:`
                p-4 text-left font-mono text-sm border transition-all
                ${t===s?"border-cyan bg-cyan/10 text-cyan shadow-[0_0_10px_rgba(0,229,255,0.2)]":"border-white/10 text-gray-500 hover:border-cyan/50 hover:text-cyan/70"}
              `,children:[ae.jsx("div",{className:"font-bold truncate",children:o.name}),ae.jsx("div",{className:"text-[10px] opacity-70",children:o.lang})]},s))]})]}),ae.jsx("div",{className:"mt-6 text-center text-cyan-dim text-[10px] font-mono",children:"T-FORCE SECURITY PROTOCOLS VER 1.0"})]})},Nw=qe.createContext({});function Pw(n){const e=qe.useRef(null);return e.current===null&&(e.current=n()),e.current}const y0=qe.createContext(null),Rw=qe.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class FP extends qe.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function OP({children:n,isPresent:e}){const t=qe.useId(),r=qe.useRef(null),i=qe.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=qe.useContext(Rw);return qe.useInsertionEffect(()=>{const{width:s,height:a,top:u,left:l}=i.current;if(e||!r.current||!s||!a)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return o&&(h.nonce=o),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${a}px !important;
            top: ${u}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),ae.jsx(FP,{isPresent:e,childRef:r,sizeRef:i,children:qe.cloneElement(n,{ref:r})})}const BP=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:o,mode:s})=>{const a=Pw(VP),u=qe.useId(),l=qe.useCallback(d=>{a.set(d,!0);for(const p of a.values())if(!p)return;r&&r()},[a,r]),h=qe.useMemo(()=>({id:u,initial:e,isPresent:t,custom:i,onExitComplete:l,register:d=>(a.set(d,!1),()=>a.delete(d))}),o?[Math.random(),l]:[t,l]);return qe.useMemo(()=>{a.forEach((d,p)=>a.set(p,!1))},[t]),qe.useEffect(()=>{!t&&!a.size&&r&&r()},[t]),s==="popLayout"&&(n=ae.jsx(OP,{isPresent:t,children:n})),ae.jsx(y0.Provider,{value:h,children:n})};function VP(){return new Map}function AC(n=!0){const e=qe.useContext(y0);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,o=qe.useId();qe.useEffect(()=>{n&&i(o)},[n]);const s=qe.useCallback(()=>n&&r&&r(o),[o,r,n]);return!t&&r?[!1,s]:[!0]}const Lg=n=>n.key||"";function s_(n){const e=[];return qe.Children.forEach(n,t=>{qe.isValidElement(t)&&e.push(t)}),e}const Dw=typeof window<"u",CC=Dw?qe.useLayoutEffect:qe.useEffect,jP=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:o="sync",propagate:s=!1})=>{const[a,u]=AC(s),l=qe.useMemo(()=>s_(n),[n]),h=s&&!a?[]:l.map(Lg),d=qe.useRef(!0),p=qe.useRef(l),m=Pw(()=>new Map),[w,b]=qe.useState(l),[x,E]=qe.useState(l);CC(()=>{d.current=!1,p.current=l;for(let F=0;F<x.length;F++){const D=Lg(x[F]);h.includes(D)?m.delete(D):m.get(D)!==!0&&m.set(D,!1)}},[x,h.length,h.join("-")]);const A=[];if(l!==w){let F=[...l];for(let D=0;D<x.length;D++){const W=x[D],k=Lg(W);h.includes(k)||(F.splice(D,0,W),A.push(W))}o==="wait"&&A.length&&(F=A),E(s_(F)),b(l);return}const{forceRender:N}=qe.useContext(Nw);return ae.jsx(ae.Fragment,{children:x.map(F=>{const D=Lg(F),W=s&&!a?!1:l===x||h.includes(D),k=()=>{if(m.has(D))m.set(D,!0);else return;let C=!0;m.forEach(L=>{L||(C=!1)}),C&&(N==null||N(),E(p.current),s&&(u==null||u()),r&&r())};return ae.jsx(BP,{isPresent:W,initial:!d.current||t?void 0:!1,custom:W?void 0:e,presenceAffectsLayout:i,mode:o,onExitComplete:W?void 0:k,children:F},D)})})},ta=n=>n;let IC=ta;function Lw(n){let e;return()=>(e===void 0&&(e=n()),e)}const jd=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Hl=n=>n*1e3,Gl=n=>n/1e3,UP={useManualTiming:!1};function zP(n){let e=new Set,t=new Set,r=!1,i=!1;const o=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1};function a(l){o.has(l)&&(u.schedule(l),n()),l(s)}const u={schedule:(l,h=!1,d=!1)=>{const m=d&&r?e:t;return h&&o.add(l),m.has(l)||m.add(l),l},cancel:l=>{t.delete(l),o.delete(l)},process:l=>{if(s=l,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(a),e.clear(),r=!1,i&&(i=!1,u.process(l))}};return u}const Mg=["read","resolveKeyframes","update","preRender","render","postRender"],WP=40;function TC(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>t=!0,s=Mg.reduce((E,A)=>(E[A]=zP(o),E),{}),{read:a,resolveKeyframes:u,update:l,preRender:h,render:d,postRender:p}=s,m=()=>{const E=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(E-i.timestamp,WP),1),i.timestamp=E,i.isProcessing=!0,a.process(i),u.process(i),l.process(i),h.process(i),d.process(i),p.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(m))},w=()=>{t=!0,r=!0,i.isProcessing||n(m)};return{schedule:Mg.reduce((E,A)=>{const N=s[A];return E[A]=(F,D=!1,W=!1)=>(t||w(),N.schedule(F,D,W)),E},{}),cancel:E=>{for(let A=0;A<Mg.length;A++)s[Mg[A]].cancel(E)},state:i,steps:s}}const{schedule:vr,cancel:hh,state:io,steps:J1}=TC(typeof requestAnimationFrame<"u"?requestAnimationFrame:ta,!0),kC=qe.createContext({strict:!1}),a_={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ud={};for(const n in a_)Ud[n]={isEnabled:e=>a_[n].some(t=>!!e[t])};function qP(n){for(const e in n)Ud[e]={...Ud[e],...n[e]}}const HP=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Cv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||HP.has(n)}let NC=n=>!Cv(n);function GP(n){n&&(NC=e=>e.startsWith("on")?!Cv(e):n(e))}try{GP(require("@emotion/is-prop-valid").default)}catch{}function $P(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(NC(i)||t===!0&&Cv(i)||!e&&!Cv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function KP(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const w0=qe.createContext({});function sm(n){return typeof n=="string"||Array.isArray(n)}function b0(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Mw=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Fw=["initial",...Mw];function x0(n){return b0(n.animate)||Fw.some(e=>sm(n[e]))}function PC(n){return!!(x0(n)||n.variants)}function XP(n,e){if(x0(n)){const{initial:t,animate:r}=n;return{initial:t===!1||sm(t)?t:void 0,animate:sm(r)?r:void 0}}return n.inherit!==!1?e:{}}function YP(n){const{initial:e,animate:t}=XP(n,qe.useContext(w0));return qe.useMemo(()=>({initial:e,animate:t}),[u_(e),u_(t)])}function u_(n){return Array.isArray(n)?n.join(" "):n}const JP=Symbol.for("motionComponentSymbol");function pd(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function QP(n,e,t){return qe.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):pd(t)&&(t.current=r))},[e])}const Ow=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),ZP="framerAppearId",RC="data-"+Ow(ZP),{schedule:Bw}=TC(queueMicrotask,!1),DC=qe.createContext({});function eR(n,e,t,r,i){var o,s;const{visualElement:a}=qe.useContext(w0),u=qe.useContext(kC),l=qe.useContext(y0),h=qe.useContext(Rw).reducedMotion,d=qe.useRef(null);r=r||u.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:h}));const p=d.current,m=qe.useContext(DC);p&&!p.projection&&i&&(p.type==="html"||p.type==="svg")&&tR(d.current,t,i,m);const w=qe.useRef(!1);qe.useInsertionEffect(()=>{p&&w.current&&p.update(t,l)});const b=t[RC],x=qe.useRef(!!b&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,b))&&((s=window.MotionHasOptimisedAnimation)===null||s===void 0?void 0:s.call(window,b)));return CC(()=>{p&&(w.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),Bw.render(p.render),x.current&&p.animationState&&p.animationState.animateChanges())}),qe.useEffect(()=>{p&&(!x.current&&p.animationState&&p.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var E;(E=window.MotionHandoffMarkAsComplete)===null||E===void 0||E.call(window,b)}),x.current=!1))}),p}function tR(n,e,t,r){const{layoutId:i,layout:o,drag:s,dragConstraints:a,layoutScroll:u,layoutRoot:l}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:LC(n.parent)),n.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:!!s||a&&pd(a),visualElement:n,animationType:typeof o=="string"?o:"both",initialPromotionConfig:r,layoutScroll:u,layoutRoot:l})}function LC(n){if(n)return n.options.allowProjection!==!1?n.projection:LC(n.parent)}function nR({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var o,s;n&&qP(n);function a(l,h){let d;const p={...qe.useContext(Rw),...l,layoutId:rR(l)},{isStatic:m}=p,w=YP(l),b=r(l,m);if(!m&&Dw){iR();const x=oR(p);d=x.MeasureLayout,w.visualElement=eR(i,b,p,e,x.ProjectionNode)}return ae.jsxs(w0.Provider,{value:w,children:[d&&w.visualElement?ae.jsx(d,{visualElement:w.visualElement,...p}):null,t(i,l,QP(b,w.visualElement,h),b,m,w.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${(s=(o=i.displayName)!==null&&o!==void 0?o:i.name)!==null&&s!==void 0?s:""})`}`;const u=qe.forwardRef(a);return u[JP]=i,u}function rR({layoutId:n}){const e=qe.useContext(Nw).id;return e&&n!==void 0?e+"-"+n:n}function iR(n,e){qe.useContext(kC).strict}function oR(n){const{drag:e,layout:t}=Ud;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(n)||t!=null&&t.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const sR=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Vw(n){return typeof n!="string"||n.includes("-")?!1:!!(sR.indexOf(n)>-1||/[A-Z]/u.test(n))}function l_(n){const e=[{},{}];return n==null||n.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function jw(n,e,t,r){if(typeof e=="function"){const[i,o]=l_(r);e=e(t!==void 0?t:n.custom,i,o)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,o]=l_(r);e=e(t!==void 0?t:n.custom,i,o)}return e}const o2=n=>Array.isArray(n),aR=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),uR=n=>o2(n)?n[n.length-1]||0:n,Vo=n=>!!(n&&n.getVelocity);function uv(n){const e=Vo(n)?n.get():n;return aR(e)?e.toValue():e}function lR({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,o){const s={latestValues:cR(r,i,o,n),renderState:e()};return t&&(s.onMount=a=>t({props:r,current:a,...s}),s.onUpdate=a=>t(a)),s}const MC=n=>(e,t)=>{const r=qe.useContext(w0),i=qe.useContext(y0),o=()=>lR(n,e,r,i);return t?o():Pw(o)};function cR(n,e,t,r){const i={},o=r(n,{});for(const p in o)i[p]=uv(o[p]);let{initial:s,animate:a}=n;const u=x0(n),l=PC(n);e&&l&&!u&&n.inherit!==!1&&(s===void 0&&(s=e.initial),a===void 0&&(a=e.animate));let h=t?t.initial===!1:!1;h=h||s===!1;const d=h?a:s;if(d&&typeof d!="boolean"&&!b0(d)){const p=Array.isArray(d)?d:[d];for(let m=0;m<p.length;m++){const w=jw(n,p[m]);if(w){const{transitionEnd:b,transition:x,...E}=w;for(const A in E){let N=E[A];if(Array.isArray(N)){const F=h?N.length-1:0;N=N[F]}N!==null&&(i[A]=N)}for(const A in b)i[A]=b[A]}}}return i}const tp=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_f=new Set(tp),FC=n=>e=>typeof e=="string"&&e.startsWith(n),OC=FC("--"),hR=FC("var(--"),Uw=n=>hR(n)?fR.test(n.split("/*")[0].trim()):!1,fR=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,BC=(n,e)=>e&&typeof n=="number"?e.transform(n):n,$l=(n,e,t)=>t>e?e:t<n?n:t,np={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},am={...np,transform:n=>$l(0,1,n)},Fg={...np,default:1},Tm=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Hc=Tm("deg"),Zu=Tm("%"),Kt=Tm("px"),dR=Tm("vh"),pR=Tm("vw"),c_={...Zu,parse:n=>Zu.parse(n)/100,transform:n=>Zu.transform(n*100)},mR={borderWidth:Kt,borderTopWidth:Kt,borderRightWidth:Kt,borderBottomWidth:Kt,borderLeftWidth:Kt,borderRadius:Kt,radius:Kt,borderTopLeftRadius:Kt,borderTopRightRadius:Kt,borderBottomRightRadius:Kt,borderBottomLeftRadius:Kt,width:Kt,maxWidth:Kt,height:Kt,maxHeight:Kt,top:Kt,right:Kt,bottom:Kt,left:Kt,padding:Kt,paddingTop:Kt,paddingRight:Kt,paddingBottom:Kt,paddingLeft:Kt,margin:Kt,marginTop:Kt,marginRight:Kt,marginBottom:Kt,marginLeft:Kt,backgroundPositionX:Kt,backgroundPositionY:Kt},gR={rotate:Hc,rotateX:Hc,rotateY:Hc,rotateZ:Hc,scale:Fg,scaleX:Fg,scaleY:Fg,scaleZ:Fg,skew:Hc,skewX:Hc,skewY:Hc,distance:Kt,translateX:Kt,translateY:Kt,translateZ:Kt,x:Kt,y:Kt,z:Kt,perspective:Kt,transformPerspective:Kt,opacity:am,originX:c_,originY:c_,originZ:Kt},h_={...np,transform:Math.round},zw={...mR,...gR,zIndex:h_,size:Kt,fillOpacity:am,strokeOpacity:am,numOctaves:h_},vR={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},yR=tp.length;function wR(n,e,t){let r="",i=!0;for(let o=0;o<yR;o++){const s=tp[o],a=n[s];if(a===void 0)continue;let u=!0;if(typeof a=="number"?u=a===(s.startsWith("scale")?1:0):u=parseFloat(a)===0,!u||t){const l=BC(a,zw[s]);if(!u){i=!1;const h=vR[s]||s;r+=`${h}(${l}) `}t&&(e[s]=l)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function Ww(n,e,t){const{style:r,vars:i,transformOrigin:o}=n;let s=!1,a=!1;for(const u in e){const l=e[u];if(_f.has(u)){s=!0;continue}else if(OC(u)){i[u]=l;continue}else{const h=BC(l,zw[u]);u.startsWith("origin")?(a=!0,o[u]=h):r[u]=h}}if(e.transform||(s||t?r.transform=wR(e,n.transform,t):r.transform&&(r.transform="none")),a){const{originX:u="50%",originY:l="50%",originZ:h=0}=o;r.transformOrigin=`${u} ${l} ${h}`}}const bR={offset:"stroke-dashoffset",array:"stroke-dasharray"},xR={offset:"strokeDashoffset",array:"strokeDasharray"};function _R(n,e,t=1,r=0,i=!0){n.pathLength=1;const o=i?bR:xR;n[o.offset]=Kt.transform(-r);const s=Kt.transform(e),a=Kt.transform(t);n[o.array]=`${s} ${a}`}function f_(n,e,t){return typeof n=="string"?n:Kt.transform(e+t*n)}function ER(n,e,t){const r=f_(e,n.x,n.width),i=f_(t,n.y,n.height);return`${r} ${i}`}function qw(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:o,pathLength:s,pathSpacing:a=1,pathOffset:u=0,...l},h,d){if(Ww(n,l,d),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:m,dimensions:w}=n;p.transform&&(w&&(m.transform=p.transform),delete p.transform),w&&(i!==void 0||o!==void 0||m.transform)&&(m.transformOrigin=ER(w,i!==void 0?i:.5,o!==void 0?o:.5)),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),r!==void 0&&(p.scale=r),s!==void 0&&_R(p,s,a,u,!1)}const Hw=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),VC=()=>({...Hw(),attrs:{}}),Gw=n=>typeof n=="string"&&n.toLowerCase()==="svg";function jC(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const o in t)n.style.setProperty(o,t[o])}const UC=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function zC(n,e,t,r){jC(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(UC.has(i)?i:Ow(i),e.attrs[i])}const Iv={};function SR(n){Object.assign(Iv,n)}function WC(n,{layout:e,layoutId:t}){return _f.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Iv[n]||n==="opacity")}function $w(n,e,t){var r;const{style:i}=n,o={};for(const s in i)(Vo(i[s])||e.style&&Vo(e.style[s])||WC(s,n)||((r=t==null?void 0:t.getValue(s))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(o[s]=i[s]);return o}function qC(n,e,t){const r=$w(n,e,t);for(const i in n)if(Vo(n[i])||Vo(e[i])){const o=tp.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[o]=n[i]}return r}function AR(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const d_=["x","y","width","height","cx","cy","r"],CR={useVisualState:MC({scrapeMotionValuesFromProps:qC,createRenderState:VC,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let o=!!n.drag;if(!o){for(const a in i)if(_f.has(a)){o=!0;break}}if(!o)return;let s=!e;if(e)for(let a=0;a<d_.length;a++){const u=d_[a];n[u]!==e[u]&&(s=!0)}s&&vr.read(()=>{AR(t,r),vr.render(()=>{qw(r,i,Gw(t.tagName),n.transformTemplate),zC(t,r)})})}})},IR={useVisualState:MC({scrapeMotionValuesFromProps:$w,createRenderState:Hw})};function HC(n,e,t){for(const r in e)!Vo(e[r])&&!WC(r,t)&&(n[r]=e[r])}function TR({transformTemplate:n},e){return qe.useMemo(()=>{const t=Hw();return Ww(t,e,n),Object.assign({},t.vars,t.style)},[e])}function kR(n,e){const t=n.style||{},r={};return HC(r,t,n),Object.assign(r,TR(n,e)),r}function NR(n,e){const t={},r=kR(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function PR(n,e,t,r){const i=qe.useMemo(()=>{const o=VC();return qw(o,e,Gw(r),n.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(n.style){const o={};HC(o,n.style,n),i.style={...o,...i.style}}return i}function RR(n=!1){return(t,r,i,{latestValues:o},s)=>{const u=(Vw(t)?PR:NR)(r,o,s,t),l=$P(r,typeof t=="string",n),h=t!==qe.Fragment?{...l,...u,ref:i}:{},{children:d}=r,p=qe.useMemo(()=>Vo(d)?d.get():d,[d]);return qe.createElement(t,{...h,children:p})}}function DR(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const s={...Vw(r)?CR:IR,preloadedFeatures:n,useRender:RR(i),createVisualElement:e,Component:r};return nR(s)}}function GC(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function _0(n,e,t){const r=n.getProps();return jw(r,e,t!==void 0?t:r.custom,n)}const LR=Lw(()=>window.ScrollTimeline!==void 0);class MR{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(LR()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,o)=>{i&&i(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class FR extends MR{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Kw(n,e){return n?n[e]||n.default||n:void 0}const s2=2e4;function $C(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<s2;)e+=t,r=n.next(e);return e>=s2?1/0:e}function Xw(n){return typeof n=="function"}function p_(n,e){n.timeline=e,n.onfinish=null}const Yw=n=>Array.isArray(n)&&typeof n[0]=="number",OR={linearEasing:void 0};function BR(n,e){const t=Lw(n);return()=>{var r;return(r=OR[e])!==null&&r!==void 0?r:t()}}const Tv=BR(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),KC=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let o=0;o<i;o++)r+=n(jd(0,i-1,o))+", ";return`linear(${r.substring(0,r.length-2)})`};function XC(n){return!!(typeof n=="function"&&Tv()||!n||typeof n=="string"&&(n in a2||Tv())||Yw(n)||Array.isArray(n)&&n.every(XC))}const Op=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,a2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Op([0,.65,.55,1]),circOut:Op([.55,0,1,.45]),backIn:Op([.31,.01,.66,-.59]),backOut:Op([.33,1.53,.69,.99])};function YC(n,e){if(n)return typeof n=="function"&&Tv()?KC(n,e):Yw(n)?Op(n):Array.isArray(n)?n.map(t=>YC(t,e)||a2.easeOut):a2[n]}const lu={x:!1,y:!1};function JC(){return lu.x||lu.y}function VR(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const o=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return o?Array.from(o):[]}return Array.from(n)}function QC(n,e){const t=VR(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function m_(n){return e=>{e.pointerType==="touch"||JC()||n(e)}}function jR(n,e,t={}){const[r,i,o]=QC(n,t),s=m_(a=>{const{target:u}=a,l=e(a);if(typeof l!="function"||!u)return;const h=m_(d=>{l(d),u.removeEventListener("pointerleave",h)});u.addEventListener("pointerleave",h,i)});return r.forEach(a=>{a.addEventListener("pointerenter",s,i)}),o}const ZC=(n,e)=>e?n===e?!0:ZC(n,e.parentElement):!1,Jw=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,UR=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function zR(n){return UR.has(n.tagName)||n.tabIndex!==-1}const Bp=new WeakSet;function g_(n){return e=>{e.key==="Enter"&&n(e)}}function Q1(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const WR=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=g_(()=>{if(Bp.has(t))return;Q1(t,"down");const i=g_(()=>{Q1(t,"up")}),o=()=>Q1(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",o,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function v_(n){return Jw(n)&&!JC()}function qR(n,e,t={}){const[r,i,o]=QC(n,t),s=a=>{const u=a.currentTarget;if(!v_(a)||Bp.has(u))return;Bp.add(u);const l=e(a),h=(m,w)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",p),!(!v_(m)||!Bp.has(u))&&(Bp.delete(u),typeof l=="function"&&l(m,{success:w}))},d=m=>{h(m,t.useGlobalTarget||ZC(u,m.target))},p=m=>{h(m,!1)};window.addEventListener("pointerup",d,i),window.addEventListener("pointercancel",p,i)};return r.forEach(a=>{!zR(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(t.useGlobalTarget?window:a).addEventListener("pointerdown",s,i),a.addEventListener("focus",l=>WR(l,i),i)}),o}function HR(n){return n==="x"||n==="y"?lu[n]?null:(lu[n]=!0,()=>{lu[n]=!1}):lu.x||lu.y?null:(lu.x=lu.y=!0,()=>{lu.x=lu.y=!1})}const e4=new Set(["width","height","top","left","right","bottom",...tp]);let lv;function GR(){lv=void 0}const el={now:()=>(lv===void 0&&el.set(io.isProcessing||UP.useManualTiming?io.timestamp:performance.now()),lv),set:n=>{lv=n,queueMicrotask(GR)}};function Qw(n,e){n.indexOf(e)===-1&&n.push(e)}function Zw(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class eb{constructor(){this.subscriptions=[]}add(e){return Qw(this.subscriptions,e),()=>Zw(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let o=0;o<i;o++){const s=this.subscriptions[o];s&&s(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function t4(n,e){return e?n*(1e3/e):0}const y_=30,$R=n=>!isNaN(parseFloat(n));class KR{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const o=el.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=el.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=$R(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new eb);const r=this.events[e].add(t);return e==="change"?()=>{r(),vr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=el.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>y_)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,y_);return t4(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function um(n,e){return new KR(n,e)}function XR(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,um(t))}function YR(n,e){const t=_0(n,e);let{transitionEnd:r={},transition:i={},...o}=t||{};o={...o,...r};for(const s in o){const a=uR(o[s]);XR(n,s,a)}}function JR(n){return!!(Vo(n)&&n.add)}function u2(n,e){const t=n.getValue("willChange");if(JR(t))return t.add(e)}function n4(n){return n.props[RC]}const r4=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,QR=1e-7,ZR=12;function eD(n,e,t,r,i){let o,s,a=0;do s=e+(t-e)/2,o=r4(s,r,i)-n,o>0?t=s:e=s;while(Math.abs(o)>QR&&++a<ZR);return s}function km(n,e,t,r){if(n===e&&t===r)return ta;const i=o=>eD(o,0,1,n,t);return o=>o===0||o===1?o:r4(i(o),e,r)}const i4=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,o4=n=>e=>1-n(1-e),s4=km(.33,1.53,.69,.99),tb=o4(s4),a4=i4(tb),u4=n=>(n*=2)<1?.5*tb(n):.5*(2-Math.pow(2,-10*(n-1))),nb=n=>1-Math.sin(Math.acos(n)),l4=o4(nb),c4=i4(nb),h4=n=>/^0[^.\s]+$/u.test(n);function tD(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||h4(n):!0}const Gp=n=>Math.round(n*1e5)/1e5,rb=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function nD(n){return n==null}const rD=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,ib=(n,e)=>t=>!!(typeof t=="string"&&rD.test(t)&&t.startsWith(n)||e&&!nD(t)&&Object.prototype.hasOwnProperty.call(t,e)),f4=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,o,s,a]=r.match(rb);return{[n]:parseFloat(i),[e]:parseFloat(o),[t]:parseFloat(s),alpha:a!==void 0?parseFloat(a):1}},iD=n=>$l(0,255,n),Z1={...np,transform:n=>Math.round(iD(n))},sf={test:ib("rgb","red"),parse:f4("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+Z1.transform(n)+", "+Z1.transform(e)+", "+Z1.transform(t)+", "+Gp(am.transform(r))+")"};function oD(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const l2={test:ib("#"),parse:oD,transform:sf.transform},md={test:ib("hsl","hue"),parse:f4("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Zu.transform(Gp(e))+", "+Zu.transform(Gp(t))+", "+Gp(am.transform(r))+")"},Po={test:n=>sf.test(n)||l2.test(n)||md.test(n),parse:n=>sf.test(n)?sf.parse(n):md.test(n)?md.parse(n):l2.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?sf.transform(n):md.transform(n)},sD=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function aD(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(rb))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(sD))===null||t===void 0?void 0:t.length)||0)>0}const d4="number",p4="color",uD="var",lD="var(",w_="${}",cD=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function lm(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let o=0;const a=e.replace(cD,u=>(Po.test(u)?(r.color.push(o),i.push(p4),t.push(Po.parse(u))):u.startsWith(lD)?(r.var.push(o),i.push(uD),t.push(u)):(r.number.push(o),i.push(d4),t.push(parseFloat(u))),++o,w_)).split(w_);return{values:t,split:a,indexes:r,types:i}}function m4(n){return lm(n).values}function g4(n){const{split:e,types:t}=lm(n),r=e.length;return i=>{let o="";for(let s=0;s<r;s++)if(o+=e[s],i[s]!==void 0){const a=t[s];a===d4?o+=Gp(i[s]):a===p4?o+=Po.transform(i[s]):o+=i[s]}return o}}const hD=n=>typeof n=="number"?0:n;function fD(n){const e=m4(n);return g4(n)(e.map(hD))}const fh={test:aD,parse:m4,createTransformer:g4,getAnimatableNone:fD},dD=new Set(["brightness","contrast","saturate","opacity"]);function pD(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(rb)||[];if(!r)return n;const i=t.replace(r,"");let o=dD.has(e)?1:0;return r!==t&&(o*=100),e+"("+o+i+")"}const mD=/\b([a-z-]*)\(.*?\)/gu,c2={...fh,getAnimatableNone:n=>{const e=n.match(mD);return e?e.map(pD).join(" "):n}},gD={...zw,color:Po,backgroundColor:Po,outlineColor:Po,fill:Po,stroke:Po,borderColor:Po,borderTopColor:Po,borderRightColor:Po,borderBottomColor:Po,borderLeftColor:Po,filter:c2,WebkitFilter:c2},ob=n=>gD[n];function v4(n,e){let t=ob(n);return t!==c2&&(t=fh),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const vD=new Set(["auto","none","0"]);function yD(n,e,t){let r=0,i;for(;r<n.length&&!i;){const o=n[r];typeof o=="string"&&!vD.has(o)&&lm(o).values.length&&(i=n[r]),r++}if(i&&t)for(const o of e)n[o]=v4(t,i)}const b_=n=>n===np||n===Kt,x_=(n,e)=>parseFloat(n.split(", ")[e]),__=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return x_(i[1],e);{const o=r.match(/^matrix\((.+)\)$/u);return o?x_(o[1],n):0}},wD=new Set(["x","y","z"]),bD=tp.filter(n=>!wD.has(n));function xD(n){const e=[];return bD.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const zd={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:__(4,13),y:__(5,14)};zd.translateX=zd.x;zd.translateY=zd.y;const cf=new Set;let h2=!1,f2=!1;function y4(){if(f2){const n=Array.from(cf).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=xD(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([o,s])=>{var a;(a=r.getValue(o))===null||a===void 0||a.set(s)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}f2=!1,h2=!1,cf.forEach(n=>n.complete()),cf.clear()}function w4(){cf.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(f2=!0)})}function _D(){w4(),y4()}class sb{constructor(e,t,r,i,o,s=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=o,this.isAsync=s}scheduleResolve(){this.isScheduled=!0,this.isAsync?(cf.add(this),h2||(h2=!0,vr.read(w4),vr.resolveKeyframes(y4))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const s=i==null?void 0:i.get(),a=e[e.length-1];if(s!==void 0)e[0]=s;else if(r&&t){const u=r.readValue(t,a);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=a),i&&s===void 0&&i.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),cf.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,cf.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const b4=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),ED=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function SD(n){const e=ED.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function x4(n,e,t=1){const[r,i]=SD(n);if(!r)return;const o=window.getComputedStyle(e).getPropertyValue(r);if(o){const s=o.trim();return b4(s)?parseFloat(s):s}return Uw(i)?x4(i,e,t+1):i}const _4=n=>e=>e.test(n),AD={test:n=>n==="auto",parse:n=>n},E4=[np,Kt,Zu,Hc,pR,dR,AD],E_=n=>E4.find(_4(n));class S4 extends sb{constructor(e,t,r,i,o){super(e,t,r,i,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let l=e[u];if(typeof l=="string"&&(l=l.trim(),Uw(l))){const h=x4(l,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=l)}}if(this.resolveNoneKeyframes(),!e4.has(r)||e.length!==2)return;const[i,o]=e,s=E_(i),a=E_(o);if(s!==a)if(b_(s)&&b_(a))for(let u=0;u<e.length;u++){const l=e[u];typeof l=="string"&&(e[u]=parseFloat(l))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)tD(e[i])&&r.push(i);r.length&&yD(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=zd[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const o=t.getValue(r);o&&o.jump(this.measuredOrigin,!1);const s=i.length-1,a=i[s];i[s]=zd[r](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,l])=>{t.getValue(u).set(l)}),this.resolveNoneKeyframes()}}const S_=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(fh.test(n)||n==="0")&&!n.startsWith("url("));function CD(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function ID(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const o=n[n.length-1],s=S_(i,e),a=S_(o,e);return!s||!a?!1:CD(n)||(t==="spring"||Xw(t))&&r}const TD=n=>n!==null;function E0(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(TD),o=e&&t!=="loop"&&e%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const kD=40;class A4{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:s="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=el.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:o,repeatType:s,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>kD?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&_D(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=el.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:o,delay:s,onComplete:a,onUpdate:u,isGenerator:l}=this.options;if(!l&&!ID(e,r,i,o))if(s)this.options.duration=0;else{u&&u(E0(e,this.options,t)),a&&a(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Nr=(n,e,t)=>n+(e-n)*t;function ey(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function ND({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,o=0,s=0;if(!e)i=o=s=t;else{const a=t<.5?t*(1+e):t+e-t*e,u=2*t-a;i=ey(u,a,n+1/3),o=ey(u,a,n),s=ey(u,a,n-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(s*255),alpha:r}}function kv(n,e){return t=>t>0?e:n}const ty=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},PD=[l2,sf,md],RD=n=>PD.find(e=>e.test(n));function A_(n){const e=RD(n);if(!e)return!1;let t=e.parse(n);return e===md&&(t=ND(t)),t}const C_=(n,e)=>{const t=A_(n),r=A_(e);if(!t||!r)return kv(n,e);const i={...t};return o=>(i.red=ty(t.red,r.red,o),i.green=ty(t.green,r.green,o),i.blue=ty(t.blue,r.blue,o),i.alpha=Nr(t.alpha,r.alpha,o),sf.transform(i))},DD=(n,e)=>t=>e(n(t)),Nm=(...n)=>n.reduce(DD),d2=new Set(["none","hidden"]);function LD(n,e){return d2.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function MD(n,e){return t=>Nr(n,e,t)}function ab(n){return typeof n=="number"?MD:typeof n=="string"?Uw(n)?kv:Po.test(n)?C_:BD:Array.isArray(n)?C4:typeof n=="object"?Po.test(n)?C_:FD:kv}function C4(n,e){const t=[...n],r=t.length,i=n.map((o,s)=>ab(o)(o,e[s]));return o=>{for(let s=0;s<r;s++)t[s]=i[s](o);return t}}function FD(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=ab(n[i])(n[i],e[i]));return i=>{for(const o in r)t[o]=r[o](i);return t}}function OD(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const s=e.types[o],a=n.indexes[s][i[s]],u=(t=n.values[a])!==null&&t!==void 0?t:0;r[o]=u,i[s]++}return r}const BD=(n,e)=>{const t=fh.createTransformer(e),r=lm(n),i=lm(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?d2.has(n)&&!i.values.length||d2.has(e)&&!r.values.length?LD(n,e):Nm(C4(OD(r,i),i.values),t):kv(n,e)};function I4(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Nr(n,e,t):ab(n)(n,e)}const VD=5;function T4(n,e,t){const r=Math.max(e-VD,0);return t4(t-n(r),e-r)}const Wr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},ny=.001;function jD({duration:n=Wr.duration,bounce:e=Wr.bounce,velocity:t=Wr.velocity,mass:r=Wr.mass}){let i,o,s=1-e;s=$l(Wr.minDamping,Wr.maxDamping,s),n=$l(Wr.minDuration,Wr.maxDuration,Gl(n)),s<1?(i=l=>{const h=l*s,d=h*n,p=h-t,m=p2(l,s),w=Math.exp(-d);return ny-p/m*w},o=l=>{const d=l*s*n,p=d*t+t,m=Math.pow(s,2)*Math.pow(l,2)*n,w=Math.exp(-d),b=p2(Math.pow(l,2),s);return(-i(l)+ny>0?-1:1)*((p-m)*w)/b}):(i=l=>{const h=Math.exp(-l*n),d=(l-t)*n+1;return-ny+h*d},o=l=>{const h=Math.exp(-l*n),d=(t-l)*(n*n);return h*d});const a=5/n,u=zD(i,o,a);if(n=Hl(n),isNaN(u))return{stiffness:Wr.stiffness,damping:Wr.damping,duration:n};{const l=Math.pow(u,2)*r;return{stiffness:l,damping:s*2*Math.sqrt(r*l),duration:n}}}const UD=12;function zD(n,e,t){let r=t;for(let i=1;i<UD;i++)r=r-n(r)/e(r);return r}function p2(n,e){return n*Math.sqrt(1-e*e)}const WD=["duration","bounce"],qD=["stiffness","damping","mass"];function I_(n,e){return e.some(t=>n[t]!==void 0)}function HD(n){let e={velocity:Wr.velocity,stiffness:Wr.stiffness,damping:Wr.damping,mass:Wr.mass,isResolvedFromDuration:!1,...n};if(!I_(n,qD)&&I_(n,WD))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,o=2*$l(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Wr.mass,stiffness:i,damping:o}}else{const t=jD(n);e={...e,...t,mass:Wr.mass},e.isResolvedFromDuration=!0}return e}function k4(n=Wr.visualDuration,e=Wr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const o=t.keyframes[0],s=t.keyframes[t.keyframes.length-1],a={done:!1,value:o},{stiffness:u,damping:l,mass:h,duration:d,velocity:p,isResolvedFromDuration:m}=HD({...t,velocity:-Gl(t.velocity||0)}),w=p||0,b=l/(2*Math.sqrt(u*h)),x=s-o,E=Gl(Math.sqrt(u/h)),A=Math.abs(x)<5;r||(r=A?Wr.restSpeed.granular:Wr.restSpeed.default),i||(i=A?Wr.restDelta.granular:Wr.restDelta.default);let N;if(b<1){const D=p2(E,b);N=W=>{const k=Math.exp(-b*E*W);return s-k*((w+b*E*x)/D*Math.sin(D*W)+x*Math.cos(D*W))}}else if(b===1)N=D=>s-Math.exp(-E*D)*(x+(w+E*x)*D);else{const D=E*Math.sqrt(b*b-1);N=W=>{const k=Math.exp(-b*E*W),C=Math.min(D*W,300);return s-k*((w+b*E*x)*Math.sinh(C)+D*x*Math.cosh(C))/D}}const F={calculatedDuration:m&&d||null,next:D=>{const W=N(D);if(m)a.done=D>=d;else{let k=0;b<1&&(k=D===0?Hl(w):T4(N,D,W));const C=Math.abs(k)<=r,L=Math.abs(s-W)<=i;a.done=C&&L}return a.value=a.done?s:W,a},toString:()=>{const D=Math.min($C(F),s2),W=KC(k=>F.next(D*k).value,D,30);return D+"ms "+W}};return F}function T_({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:s,min:a,max:u,restDelta:l=.5,restSpeed:h}){const d=n[0],p={done:!1,value:d},m=C=>a!==void 0&&C<a||u!==void 0&&C>u,w=C=>a===void 0?u:u===void 0||Math.abs(a-C)<Math.abs(u-C)?a:u;let b=t*e;const x=d+b,E=s===void 0?x:s(x);E!==x&&(b=E-d);const A=C=>-b*Math.exp(-C/r),N=C=>E+A(C),F=C=>{const L=A(C),B=N(C);p.done=Math.abs(L)<=l,p.value=p.done?E:B};let D,W;const k=C=>{m(p.value)&&(D=C,W=k4({keyframes:[p.value,w(p.value)],velocity:T4(N,C,p.value),damping:i,stiffness:o,restDelta:l,restSpeed:h}))};return k(0),{calculatedDuration:null,next:C=>{let L=!1;return!W&&D===void 0&&(L=!0,F(C),k(C)),D!==void 0&&C>=D?W.next(C-D):(!L&&F(C),p)}}}const GD=km(.42,0,1,1),$D=km(0,0,.58,1),N4=km(.42,0,.58,1),KD=n=>Array.isArray(n)&&typeof n[0]!="number",XD={linear:ta,easeIn:GD,easeInOut:N4,easeOut:$D,circIn:nb,circInOut:c4,circOut:l4,backIn:tb,backInOut:a4,backOut:s4,anticipate:u4},k_=n=>{if(Yw(n)){IC(n.length===4);const[e,t,r,i]=n;return km(e,t,r,i)}else if(typeof n=="string")return XD[n];return n};function YD(n,e,t){const r=[],i=t||I4,o=n.length-1;for(let s=0;s<o;s++){let a=i(n[s],n[s+1]);if(e){const u=Array.isArray(e)?e[s]||ta:e;a=Nm(u,a)}r.push(a)}return r}function JD(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const o=n.length;if(IC(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const s=n[0]===n[1];n[0]>n[o-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=YD(e,r,i),u=a.length,l=h=>{if(s&&h<n[0])return e[0];let d=0;if(u>1)for(;d<n.length-2&&!(h<n[d+1]);d++);const p=jd(n[d],n[d+1],h);return a[d](p)};return t?h=>l($l(n[0],n[o-1],h)):l}function QD(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=jd(0,e,r);n.push(Nr(t,1,i))}}function ZD(n){const e=[0];return QD(e,n.length-1),e}function eL(n,e){return n.map(t=>t*e)}function tL(n,e){return n.map(()=>e||N4).splice(0,n.length-1)}function Nv({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=KD(r)?r.map(k_):k_(r),o={done:!1,value:e[0]},s=eL(t&&t.length===e.length?t:ZD(e),n),a=JD(s,e,{ease:Array.isArray(i)?i:tL(e,i)});return{calculatedDuration:n,next:u=>(o.value=a(u),o.done=u>=n,o)}}const nL=n=>{const e=({timestamp:t})=>n(t);return{start:()=>vr.update(e,!0),stop:()=>hh(e),now:()=>io.isProcessing?io.timestamp:el.now()}},rL={decay:T_,inertia:T_,tween:Nv,keyframes:Nv,spring:k4},iL=n=>n/100;class ub extends A4{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:r,element:i,keyframes:o}=this.options,s=(i==null?void 0:i.KeyframeResolver)||sb,a=(u,l)=>this.onKeyframesResolved(u,l);this.resolver=new s(o,a,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o,velocity:s=0}=this.options,a=Xw(t)?t:rL[t]||Nv;let u,l;a!==Nv&&typeof e[0]!="number"&&(u=Nm(iL,I4(e[0],e[1])),e=[0,100]);const h=a({...this.options,keyframes:e});o==="mirror"&&(l=a({...this.options,keyframes:[...e].reverse(),velocity:-s})),h.calculatedDuration===null&&(h.calculatedDuration=$C(h));const{calculatedDuration:d}=h,p=d+i,m=p*(r+1)-i;return{generator:h,mirroredGenerator:l,mapPercentToKeyframes:u,calculatedDuration:d,resolvedDuration:p,totalDuration:m}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:i,generator:o,mirroredGenerator:s,mapPercentToKeyframes:a,keyframes:u,calculatedDuration:l,totalDuration:h,resolvedDuration:d}=r;if(this.startTime===null)return o.next(0);const{delay:p,repeat:m,repeatType:w,repeatDelay:b,onUpdate:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const E=this.currentTime-p*(this.speed>=0?1:-1),A=this.speed>=0?E<0:E>h;this.currentTime=Math.max(E,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let N=this.currentTime,F=o;if(m){const C=Math.min(this.currentTime,h)/d;let L=Math.floor(C),B=C%1;!B&&C>=1&&(B=1),B===1&&L--,L=Math.min(L,m+1),!!(L%2)&&(w==="reverse"?(B=1-B,b&&(B-=b/d)):w==="mirror"&&(F=s)),N=$l(0,1,B)*d}const D=A?{done:!1,value:u[0]}:F.next(N);a&&(D.value=a(D.value));let{done:W}=D;!A&&l!==null&&(W=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&W);return k&&i!==void 0&&(D.value=E0(u,this.options,i)),x&&x(D.value),k&&this.finish(),D}get duration(){const{resolved:e}=this;return e?Gl(e.calculatedDuration):0}get time(){return Gl(this.currentTime)}set time(e){e=Hl(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Gl(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=nL,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const oL=new Set(["opacity","clipPath","filter","transform"]);function sL(n,e,t,{delay:r=0,duration:i=300,repeat:o=0,repeatType:s="loop",ease:a="easeInOut",times:u}={}){const l={[e]:t};u&&(l.offset=u);const h=YC(a,i);return Array.isArray(h)&&(l.easing=h),n.animate(l,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:o+1,direction:s==="reverse"?"alternate":"normal"})}const aL=Lw(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Pv=10,uL=2e4;function lL(n){return Xw(n.type)||n.type==="spring"||!XC(n.ease)}function cL(n,e){const t=new ub({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let o=0;for(;!r.done&&o<uL;)r=t.sample(o),i.push(r.value),o+=Pv;return{times:void 0,keyframes:i,duration:o-Pv,ease:"linear"}}const P4={anticipate:u4,backInOut:a4,circInOut:c4};function hL(n){return n in P4}class N_ extends A4{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:o}=this.options;this.resolver=new S4(o,(s,a)=>this.onKeyframesResolved(s,a),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:o,type:s,motionValue:a,name:u,startTime:l}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof o=="string"&&Tv()&&hL(o)&&(o=P4[o]),lL(this.options)){const{onComplete:d,onUpdate:p,motionValue:m,element:w,...b}=this.options,x=cL(e,b);e=x.keyframes,e.length===1&&(e[1]=e[0]),r=x.duration,i=x.times,o=x.ease,s="keyframes"}const h=sL(a.owner.current,u,e,{...this.options,duration:r,times:i,ease:o});return h.startTime=l??this.calcStartTime(),this.pendingTimeline?(p_(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:d}=this.options;a.set(E0(e,this.options,t)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:s,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Gl(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Gl(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Hl(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return ta;const{animation:r}=t;p_(r,e)}return ta}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:o,ease:s,times:a}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:l,onUpdate:h,onComplete:d,element:p,...m}=this.options,w=new ub({...m,keyframes:r,duration:i,type:o,ease:s,times:a,isGenerator:!0}),b=Hl(this.time);l.setWithVelocity(w.sample(b-Pv).value,w.sample(b).value,Pv)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:o,damping:s,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:l}=t.owner.getProps();return aL()&&r&&oL.has(r)&&!u&&!l&&!i&&o!=="mirror"&&s!==0&&a!=="inertia"}}const fL={type:"spring",stiffness:500,damping:25,restSpeed:10},dL=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),pL={type:"keyframes",duration:.8},mL={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},gL=(n,{keyframes:e})=>e.length>2?pL:_f.has(n)?n.startsWith("scale")?dL(e[1]):fL:mL;function vL({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:o,repeatType:s,repeatDelay:a,from:u,elapsed:l,...h}){return!!Object.keys(h).length}const lb=(n,e,t,r={},i,o)=>s=>{const a=Kw(r,n)||{},u=a.delay||r.delay||0;let{elapsed:l=0}=r;l=l-Hl(u);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-l,onUpdate:p=>{e.set(p),a.onUpdate&&a.onUpdate(p)},onComplete:()=>{s(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:o?void 0:i};vL(a)||(h={...h,...gL(n,h)}),h.duration&&(h.duration=Hl(h.duration)),h.repeatDelay&&(h.repeatDelay=Hl(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let d=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(d=!0)),d&&!o&&e.get()!==void 0){const p=E0(h.keyframes,a);if(p!==void 0)return vr.update(()=>{h.onUpdate(p),h.onComplete()}),new FR([])}return!o&&N_.supports(h)?new N_(h):new ub(h)};function yL({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function R4(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var o;let{transition:s=n.getDefaultTransition(),transitionEnd:a,...u}=e;r&&(s=r);const l=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const d in u){const p=n.getValue(d,(o=n.latestValues[d])!==null&&o!==void 0?o:null),m=u[d];if(m===void 0||h&&yL(h,d))continue;const w={delay:t,...Kw(s||{},d)};let b=!1;if(window.MotionHandoffAnimation){const E=n4(n);if(E){const A=window.MotionHandoffAnimation(E,d,vr);A!==null&&(w.startTime=A,b=!0)}}u2(n,d),p.start(lb(d,p,m,n.shouldReduceMotion&&e4.has(d)?{type:!1}:w,n,b));const x=p.animation;x&&l.push(x)}return a&&Promise.all(l).then(()=>{vr.update(()=>{a&&YR(n,a)})}),l}function m2(n,e,t={}){var r;const i=_0(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:o=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(o=t.transitionOverride);const s=i?()=>Promise.all(R4(n,i,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(l=0)=>{const{delayChildren:h=0,staggerChildren:d,staggerDirection:p}=o;return wL(n,e,h+l,d,p,t)}:()=>Promise.resolve(),{when:u}=o;if(u){const[l,h]=u==="beforeChildren"?[s,a]:[a,s];return l().then(()=>h())}else return Promise.all([s(),a(t.delay)])}function wL(n,e,t=0,r=0,i=1,o){const s=[],a=(n.variantChildren.size-1)*r,u=i===1?(l=0)=>l*r:(l=0)=>a-l*r;return Array.from(n.variantChildren).sort(bL).forEach((l,h)=>{l.notify("AnimationStart",e),s.push(m2(l,e,{...o,delay:t+u(h)}).then(()=>l.notify("AnimationComplete",e)))}),Promise.all(s)}function bL(n,e){return n.sortNodePosition(e)}function xL(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(o=>m2(n,o,t));r=Promise.all(i)}else if(typeof e=="string")r=m2(n,e,t);else{const i=typeof e=="function"?_0(n,e,t.custom):e;r=Promise.all(R4(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const _L=Fw.length;function D4(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?D4(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<_L;t++){const r=Fw[t],i=n.props[r];(sm(i)||i===!1)&&(e[r]=i)}return e}const EL=[...Mw].reverse(),SL=Mw.length;function AL(n){return e=>Promise.all(e.map(({animation:t,options:r})=>xL(n,t,r)))}function CL(n){let e=AL(n),t=P_(),r=!0;const i=u=>(l,h)=>{var d;const p=_0(n,h,u==="exit"?(d=n.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(p){const{transition:m,transitionEnd:w,...b}=p;l={...l,...b,...w}}return l};function o(u){e=u(n)}function s(u){const{props:l}=n,h=D4(n.parent)||{},d=[],p=new Set;let m={},w=1/0;for(let x=0;x<SL;x++){const E=EL[x],A=t[E],N=l[E]!==void 0?l[E]:h[E],F=sm(N),D=E===u?A.isActive:null;D===!1&&(w=x);let W=N===h[E]&&N!==l[E]&&F;if(W&&r&&n.manuallyAnimateOnMount&&(W=!1),A.protectedKeys={...m},!A.isActive&&D===null||!N&&!A.prevProp||b0(N)||typeof N=="boolean")continue;const k=IL(A.prevProp,N);let C=k||E===u&&A.isActive&&!W&&F||x>w&&F,L=!1;const B=Array.isArray(N)?N:[N];let R=B.reduce(i(E),{});D===!1&&(R={});const{prevResolvedValues:M={}}=A,U={...M,...R},J=he=>{C=!0,p.has(he)&&(L=!0,p.delete(he)),A.needsAnimating[he]=!0;const K=n.getValue(he);K&&(K.liveStyle=!1)};for(const he in U){const K=R[he],le=M[he];if(m.hasOwnProperty(he))continue;let se=!1;o2(K)&&o2(le)?se=!GC(K,le):se=K!==le,se?K!=null?J(he):p.add(he):K!==void 0&&p.has(he)?J(he):A.protectedKeys[he]=!0}A.prevProp=N,A.prevResolvedValues=R,A.isActive&&(m={...m,...R}),r&&n.blockInitialAnimation&&(C=!1),C&&(!(W&&k)||L)&&d.push(...B.map(he=>({animation:he,options:{type:E}})))}if(p.size){const x={};p.forEach(E=>{const A=n.getBaseTarget(E),N=n.getValue(E);N&&(N.liveStyle=!0),x[E]=A??null}),d.push({animation:x})}let b=!!d.length;return r&&(l.initial===!1||l.initial===l.animate)&&!n.manuallyAnimateOnMount&&(b=!1),r=!1,b?e(d):Promise.resolve()}function a(u,l){var h;if(t[u].isActive===l)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(p=>{var m;return(m=p.animationState)===null||m===void 0?void 0:m.setActive(u,l)}),t[u].isActive=l;const d=s(u);for(const p in t)t[p].protectedKeys={};return d}return{animateChanges:s,setActive:a,setAnimateFunction:o,getState:()=>t,reset:()=>{t=P_(),r=!0}}}function IL(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!GC(e,n):!1}function Xh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function P_(){return{animate:Xh(!0),whileInView:Xh(),whileHover:Xh(),whileTap:Xh(),whileDrag:Xh(),whileFocus:Xh(),exit:Xh()}}class Ah{constructor(e){this.isMounted=!1,this.node=e}update(){}}class TL extends Ah{constructor(e){super(e),e.animationState||(e.animationState=CL(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();b0(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let kL=0;class NL extends Ah{constructor(){super(...arguments),this.id=kL++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const PL={animation:{Feature:TL},exit:{Feature:NL}};function cm(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function Pm(n){return{point:{x:n.pageX,y:n.pageY}}}const RL=n=>e=>Jw(e)&&n(e,Pm(e));function $p(n,e,t,r){return cm(n,e,RL(t),r)}const R_=(n,e)=>Math.abs(n-e);function DL(n,e){const t=R_(n.x,e.x),r=R_(n.y,e.y);return Math.sqrt(t**2+r**2)}class L4{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=iy(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,m=DL(d.offset,{x:0,y:0})>=3;if(!p&&!m)return;const{point:w}=d,{timestamp:b}=io;this.history.push({...w,timestamp:b});const{onStart:x,onMove:E}=this.handlers;p||(x&&x(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),E&&E(this.lastMoveEvent,d)},this.handlePointerMove=(d,p)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=ry(p,this.transformPagePoint),vr.update(this.updatePoint,!0)},this.handlePointerUp=(d,p)=>{this.end();const{onEnd:m,onSessionEnd:w,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=iy(d.type==="pointercancel"?this.lastMoveEventInfo:ry(p,this.transformPagePoint),this.history);this.startEvent&&m&&m(d,x),w&&w(d,x)},!Jw(e))return;this.dragSnapToOrigin=o,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const s=Pm(e),a=ry(s,this.transformPagePoint),{point:u}=a,{timestamp:l}=io;this.history=[{...u,timestamp:l}];const{onSessionStart:h}=t;h&&h(e,iy(a,this.history)),this.removeListeners=Nm($p(this.contextWindow,"pointermove",this.handlePointerMove),$p(this.contextWindow,"pointerup",this.handlePointerUp),$p(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),hh(this.updatePoint)}}function ry(n,e){return e?{point:e(n.point)}:n}function D_(n,e){return{x:n.x-e.x,y:n.y-e.y}}function iy({point:n},e){return{point:n,delta:D_(n,M4(e)),offset:D_(n,LL(e)),velocity:ML(e,.1)}}function LL(n){return n[0]}function M4(n){return n[n.length-1]}function ML(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=M4(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Hl(e)));)t--;if(!r)return{x:0,y:0};const o=Gl(i.timestamp-r.timestamp);if(o===0)return{x:0,y:0};const s={x:(i.x-r.x)/o,y:(i.y-r.y)/o};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}const F4=1e-4,FL=1-F4,OL=1+F4,O4=.01,BL=0-O4,VL=0+O4;function ra(n){return n.max-n.min}function jL(n,e,t){return Math.abs(n-e)<=t}function L_(n,e,t,r=.5){n.origin=r,n.originPoint=Nr(e.min,e.max,n.origin),n.scale=ra(t)/ra(e),n.translate=Nr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=FL&&n.scale<=OL||isNaN(n.scale))&&(n.scale=1),(n.translate>=BL&&n.translate<=VL||isNaN(n.translate))&&(n.translate=0)}function Kp(n,e,t,r){L_(n.x,e.x,t.x,r?r.originX:void 0),L_(n.y,e.y,t.y,r?r.originY:void 0)}function M_(n,e,t){n.min=t.min+e.min,n.max=n.min+ra(e)}function UL(n,e,t){M_(n.x,e.x,t.x),M_(n.y,e.y,t.y)}function F_(n,e,t){n.min=e.min-t.min,n.max=n.min+ra(e)}function Xp(n,e,t){F_(n.x,e.x,t.x),F_(n.y,e.y,t.y)}function zL(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Nr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Nr(t,n,r.max):Math.min(n,t)),n}function O_(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function WL(n,{top:e,left:t,bottom:r,right:i}){return{x:O_(n.x,t,i),y:O_(n.y,e,r)}}function B_(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function qL(n,e){return{x:B_(n.x,e.x),y:B_(n.y,e.y)}}function HL(n,e){let t=.5;const r=ra(n),i=ra(e);return i>r?t=jd(e.min,e.max-r,n.min):r>i&&(t=jd(n.min,n.max-i,e.min)),$l(0,1,t)}function GL(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const g2=.35;function $L(n=g2){return n===!1?n=0:n===!0&&(n=g2),{x:V_(n,"left","right"),y:V_(n,"top","bottom")}}function V_(n,e,t){return{min:j_(n,e),max:j_(n,t)}}function j_(n,e){return typeof n=="number"?n:n[e]||0}const U_=()=>({translate:0,scale:1,origin:0,originPoint:0}),gd=()=>({x:U_(),y:U_()}),z_=()=>({min:0,max:0}),Xr=()=>({x:z_(),y:z_()});function ka(n){return[n("x"),n("y")]}function B4({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function KL({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function XL(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function oy(n){return n===void 0||n===1}function v2({scale:n,scaleX:e,scaleY:t}){return!oy(n)||!oy(e)||!oy(t)}function Jh(n){return v2(n)||V4(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function V4(n){return W_(n.x)||W_(n.y)}function W_(n){return n&&n!=="0%"}function Rv(n,e,t){const r=n-t,i=e*r;return t+i}function q_(n,e,t,r,i){return i!==void 0&&(n=Rv(n,i,r)),Rv(n,t,r)+e}function y2(n,e=0,t=1,r,i){n.min=q_(n.min,e,t,r,i),n.max=q_(n.max,e,t,r,i)}function j4(n,{x:e,y:t}){y2(n.x,e.translate,e.scale,e.originPoint),y2(n.y,t.translate,t.scale,t.originPoint)}const H_=.999999999999,G_=1.0000000000001;function YL(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let o,s;for(let a=0;a<i;a++){o=t[a],s=o.projectionDelta;const{visualElement:u}=o.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&yd(n,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),s&&(e.x*=s.x.scale,e.y*=s.y.scale,j4(n,s)),r&&Jh(o.latestValues)&&yd(n,o.latestValues))}e.x<G_&&e.x>H_&&(e.x=1),e.y<G_&&e.y>H_&&(e.y=1)}function vd(n,e){n.min=n.min+e,n.max=n.max+e}function $_(n,e,t,r,i=.5){const o=Nr(n.min,n.max,i);y2(n,e,t,o,r)}function yd(n,e){$_(n.x,e.x,e.scaleX,e.scale,e.originX),$_(n.y,e.y,e.scaleY,e.scale,e.originY)}function U4(n,e){return B4(XL(n.getBoundingClientRect(),e))}function JL(n,e,t){const r=U4(n,t),{scroll:i}=e;return i&&(vd(r.x,i.offset.x),vd(r.y,i.offset.y)),r}const z4=({current:n})=>n?n.ownerDocument.defaultView:null,QL=new WeakMap;class ZL{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Xr(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Pm(h).point)},o=(h,d)=>{const{drag:p,dragPropagation:m,onDragStart:w}=this.getProps();if(p&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=HR(p),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ka(x=>{let E=this.getAxisMotionValue(x).get()||0;if(Zu.test(E)){const{projection:A}=this.visualElement;if(A&&A.layout){const N=A.layout.layoutBox[x];N&&(E=ra(N)*(parseFloat(E)/100))}}this.originPoint[x]=E}),w&&vr.postRender(()=>w(h,d)),u2(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},s=(h,d)=>{const{dragPropagation:p,dragDirectionLock:m,onDirectionLock:w,onDrag:b}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:x}=d;if(m&&this.currentDirection===null){this.currentDirection=e6(x),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",d.point,x),this.updateAxis("y",d.point,x),this.visualElement.render(),b&&b(h,d)},a=(h,d)=>this.stop(h,d),u=()=>ka(h=>{var d;return this.getAnimationState(h)==="paused"&&((d=this.getAxisMotionValue(h).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:l}=this.getProps();this.panSession=new L4(e,{onSessionStart:i,onStart:o,onMove:s,onSessionEnd:a,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:l,contextWindow:z4(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&vr.postRender(()=>o(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Og(e,i,this.currentDirection))return;const o=this.getAxisMotionValue(e);let s=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(s=zL(s,this.constraints[e],this.elastic[e])),o.set(s)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,o=this.constraints;t&&pd(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=WL(i.layoutBox,t):this.constraints=!1,this.elastic=$L(r),o!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&ka(s=>{this.constraints!==!1&&this.getAxisMotionValue(s)&&(this.constraints[s]=GL(i.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!pd(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=JL(r,i.root,this.visualElement.getTransformPagePoint());let s=qL(i.layout.layoutBox,o);if(t){const a=t(KL(s));this.hasMutatedConstraints=!!a,a&&(s=B4(a))}return s}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:o,dragSnapToOrigin:s,onDragTransitionEnd:a}=this.getProps(),u=this.constraints||{},l=ka(h=>{if(!Og(h,t,this.currentDirection))return;let d=u&&u[h]||{};s&&(d={min:0,max:0});const p=i?200:1e6,m=i?40:1e7,w={type:"inertia",velocity:r?e[h]:0,bounceStiffness:p,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...o,...d};return this.startAxisValueAnimation(h,w)});return Promise.all(l).then(a)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return u2(this.visualElement,e),r.start(lb(e,r,0,t,this.visualElement,!1))}stopAnimation(){ka(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ka(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ka(t=>{const{drag:r}=this.getProps();if(!Og(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(t);if(i&&i.layout){const{min:s,max:a}=i.layout.layoutBox[t];o.set(e[t]-Nr(s,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!pd(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};ka(s=>{const a=this.getAxisMotionValue(s);if(a&&this.constraints!==!1){const u=a.get();i[s]=HL({min:u,max:u},this.constraints[s])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ka(s=>{if(!Og(s,e,null))return;const a=this.getAxisMotionValue(s),{min:u,max:l}=this.constraints[s];a.set(Nr(u,l,i[s]))})}addListeners(){if(!this.visualElement.current)return;QL.set(this.visualElement,this);const e=this.visualElement.current,t=$p(e,"pointerdown",u=>{const{drag:l,dragListener:h=!0}=this.getProps();l&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();pd(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),vr.read(r);const s=cm(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:l})=>{this.isDragging&&l&&(ka(h=>{const d=this.getAxisMotionValue(h);d&&(this.originPoint[h]+=u[h].translate,d.set(d.get()+u[h].translate))}),this.visualElement.render())}));return()=>{s(),t(),o(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:s=g2,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:o,dragElastic:s,dragMomentum:a}}}function Og(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function e6(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class t6 extends Ah{constructor(e){super(e),this.removeGroupControls=ta,this.removeListeners=ta,this.controls=new ZL(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ta}unmount(){this.removeGroupControls(),this.removeListeners()}}const K_=n=>(e,t)=>{n&&vr.postRender(()=>n(e,t))};class n6 extends Ah{constructor(){super(...arguments),this.removePointerDownListener=ta}onPointerDown(e){this.session=new L4(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:z4(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:K_(e),onStart:K_(t),onMove:r,onEnd:(o,s)=>{delete this.session,i&&vr.postRender(()=>i(o,s))}}}mount(){this.removePointerDownListener=$p(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const cv={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function X_(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Np={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Kt.test(n))n=parseFloat(n);else return n;const t=X_(n,e.target.x),r=X_(n,e.target.y);return`${t}% ${r}%`}},r6={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=fh.parse(n);if(i.length>5)return r;const o=fh.createTransformer(n),s=typeof i[0]!="number"?1:0,a=t.x.scale*e.x,u=t.y.scale*e.y;i[0+s]/=a,i[1+s]/=u;const l=Nr(a,u,.5);return typeof i[2+s]=="number"&&(i[2+s]/=l),typeof i[3+s]=="number"&&(i[3+s]/=l),o(i)}};class i6 extends qe.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:o}=e;SR(o6),o&&(t.group&&t.group.add(o),r&&r.register&&i&&r.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),cv.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:o}=this.props,s=r.projection;return s&&(s.isPresent=o,i||e.layoutDependency!==t||t===void 0?s.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?s.promote():s.relegate()||vr.postRender(()=>{const a=s.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Bw.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function W4(n){const[e,t]=AC(),r=qe.useContext(Nw);return ae.jsx(i6,{...n,layoutGroup:r,switchLayoutGroup:qe.useContext(DC),isPresent:e,safeToRemove:t})}const o6={borderRadius:{...Np,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Np,borderTopRightRadius:Np,borderBottomLeftRadius:Np,borderBottomRightRadius:Np,boxShadow:r6};function s6(n,e,t){const r=Vo(n)?n:um(n);return r.start(lb("",r,e,t)),r.animation}function a6(n){return n instanceof SVGElement&&n.tagName!=="svg"}const u6=(n,e)=>n.depth-e.depth;class l6{constructor(){this.children=[],this.isDirty=!1}add(e){Qw(this.children,e),this.isDirty=!0}remove(e){Zw(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(u6),this.isDirty=!1,this.children.forEach(e)}}function c6(n,e){const t=el.now(),r=({timestamp:i})=>{const o=i-t;o>=e&&(hh(r),n(o-e))};return vr.read(r,!0),()=>hh(r)}const q4=["TopLeft","TopRight","BottomLeft","BottomRight"],h6=q4.length,Y_=n=>typeof n=="string"?parseFloat(n):n,J_=n=>typeof n=="number"||Kt.test(n);function f6(n,e,t,r,i,o){i?(n.opacity=Nr(0,t.opacity!==void 0?t.opacity:1,d6(r)),n.opacityExit=Nr(e.opacity!==void 0?e.opacity:1,0,p6(r))):o&&(n.opacity=Nr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let s=0;s<h6;s++){const a=`border${q4[s]}Radius`;let u=Q_(e,a),l=Q_(t,a);if(u===void 0&&l===void 0)continue;u||(u=0),l||(l=0),u===0||l===0||J_(u)===J_(l)?(n[a]=Math.max(Nr(Y_(u),Y_(l),r),0),(Zu.test(l)||Zu.test(u))&&(n[a]+="%")):n[a]=l}(e.rotate||t.rotate)&&(n.rotate=Nr(e.rotate||0,t.rotate||0,r))}function Q_(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const d6=H4(0,.5,l4),p6=H4(.5,.95,ta);function H4(n,e,t){return r=>r<n?0:r>e?1:t(jd(n,e,r))}function Z_(n,e){n.min=e.min,n.max=e.max}function Ta(n,e){Z_(n.x,e.x),Z_(n.y,e.y)}function eE(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function tE(n,e,t,r,i){return n-=e,n=Rv(n,1/t,r),i!==void 0&&(n=Rv(n,1/i,r)),n}function m6(n,e=0,t=1,r=.5,i,o=n,s=n){if(Zu.test(e)&&(e=parseFloat(e),e=Nr(s.min,s.max,e/100)-s.min),typeof e!="number")return;let a=Nr(o.min,o.max,r);n===o&&(a-=e),n.min=tE(n.min,e,t,a,i),n.max=tE(n.max,e,t,a,i)}function nE(n,e,[t,r,i],o,s){m6(n,e[t],e[r],e[i],e.scale,o,s)}const g6=["x","scaleX","originX"],v6=["y","scaleY","originY"];function rE(n,e,t,r){nE(n.x,e,g6,t?t.x:void 0,r?r.x:void 0),nE(n.y,e,v6,t?t.y:void 0,r?r.y:void 0)}function iE(n){return n.translate===0&&n.scale===1}function G4(n){return iE(n.x)&&iE(n.y)}function oE(n,e){return n.min===e.min&&n.max===e.max}function y6(n,e){return oE(n.x,e.x)&&oE(n.y,e.y)}function sE(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function $4(n,e){return sE(n.x,e.x)&&sE(n.y,e.y)}function aE(n){return ra(n.x)/ra(n.y)}function uE(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class w6{constructor(){this.members=[]}add(e){Qw(this.members,e),e.scheduleRender()}remove(e){if(Zw(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){r=o;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function b6(n,e,t){let r="";const i=n.x.translate/e.x,o=n.y.translate/e.y,s=(t==null?void 0:t.z)||0;if((i||o||s)&&(r=`translate3d(${i}px, ${o}px, ${s}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:l,rotate:h,rotateX:d,rotateY:p,skewX:m,skewY:w}=t;l&&(r=`perspective(${l}px) ${r}`),h&&(r+=`rotate(${h}deg) `),d&&(r+=`rotateX(${d}deg) `),p&&(r+=`rotateY(${p}deg) `),m&&(r+=`skewX(${m}deg) `),w&&(r+=`skewY(${w}deg) `)}const a=n.x.scale*e.x,u=n.y.scale*e.y;return(a!==1||u!==1)&&(r+=`scale(${a}, ${u})`),r||"none"}const Qh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Vp=typeof window<"u"&&window.MotionDebug!==void 0,sy=["","X","Y","Z"],x6={visibility:"hidden"},lE=1e3;let _6=0;function ay(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function K4(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=n4(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:o}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",vr,!(i||o))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&K4(r)}function X4({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(s={},a=e==null?void 0:e()){this.id=_6++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Vp&&(Qh.totalNodes=Qh.resolvedTargetDeltas=Qh.recalculatedProjection=0),this.nodes.forEach(A6),this.nodes.forEach(N6),this.nodes.forEach(P6),this.nodes.forEach(C6),Vp&&window.MotionDebug.record(Qh)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new l6)}addEventListener(s,a){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new eb),this.eventHandlers.get(s).add(a)}notifyListeners(s,...a){const u=this.eventHandlers.get(s);u&&u.notify(...a)}hasListeners(s){return this.eventHandlers.has(s)}mount(s,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=a6(s),this.instance=s;const{layoutId:u,layout:l,visualElement:h}=this.options;if(h&&!h.current&&h.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(l||u)&&(this.isLayoutDirty=!0),n){let d;const p=()=>this.root.updateBlockedByResize=!1;n(s,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=c6(p,250),cv.hasAnimatedSinceResize&&(cv.hasAnimatedSinceResize=!1,this.nodes.forEach(hE))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&h&&(u||l)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:p,hasRelativeTargetChanged:m,layout:w})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||h.getDefaultTransition()||F6,{onLayoutAnimationStart:x,onLayoutAnimationComplete:E}=h.getProps(),A=!this.targetLayout||!$4(this.targetLayout,w)||m,N=!p&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||N||p&&(A||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,N);const F={...Kw(b,"layout"),onPlay:x,onComplete:E};(h.shouldReduceMotion||this.options.layoutRoot)&&(F.delay=0,F.type=!1),this.startAnimation(F)}else p||hE(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=w})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,hh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(R6),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&K4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const d=this.path[h];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:u}=this.options;if(a===void 0&&!u)return;const l=this.getTransformTemplate();this.prevTransformTemplateValue=l?l(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(cE);return}this.isUpdating||this.nodes.forEach(T6),this.isUpdating=!1,this.nodes.forEach(k6),this.nodes.forEach(E6),this.nodes.forEach(S6),this.clearAllSnapshots();const a=el.now();io.delta=$l(0,1e3/60,a-io.timestamp),io.timestamp=a,io.isProcessing=!0,J1.update.process(io),J1.preRender.process(io),J1.render.process(io),io.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Bw.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(I6),this.sharedNodes.forEach(D6)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,vr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){vr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Xr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(a=!1),a){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:s,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const s=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!G4(this.projectionDelta),u=this.getTransformTemplate(),l=u?u(this.latestValues,""):void 0,h=l!==this.prevTransformTemplateValue;s&&(a||Jh(this.latestValues)||h)&&(i(this.instance,l),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const a=this.measurePageBox();let u=this.removeElementScroll(a);return s&&(u=this.removeTransform(u)),O6(u),{animationId:this.root.animationId,measuredBox:a,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var s;const{visualElement:a}=this.options;if(!a)return Xr();const u=a.measureViewportBox();if(!(((s=this.scroll)===null||s===void 0?void 0:s.wasRoot)||this.path.some(B6))){const{scroll:h}=this.root;h&&(vd(u.x,h.offset.x),vd(u.y,h.offset.y))}return u}removeElementScroll(s){var a;const u=Xr();if(Ta(u,s),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return u;for(let l=0;l<this.path.length;l++){const h=this.path[l],{scroll:d,options:p}=h;h!==this.root&&d&&p.layoutScroll&&(d.wasRoot&&Ta(u,s),vd(u.x,d.offset.x),vd(u.y,d.offset.y))}return u}applyTransform(s,a=!1){const u=Xr();Ta(u,s);for(let l=0;l<this.path.length;l++){const h=this.path[l];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&yd(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Jh(h.latestValues)&&yd(u,h.latestValues)}return Jh(this.latestValues)&&yd(u,this.latestValues),u}removeTransform(s){const a=Xr();Ta(a,s);for(let u=0;u<this.path.length;u++){const l=this.path[u];if(!l.instance||!Jh(l.latestValues))continue;v2(l.latestValues)&&l.updateSnapshot();const h=Xr(),d=l.measurePageBox();Ta(h,d),rE(a,l.latestValues,l.snapshot?l.snapshot.layoutBox:void 0,h)}return Jh(this.latestValues)&&rE(a,this.latestValues),a}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==io.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){var a;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==u;if(!(s||l&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:p}=this.options;if(!(!this.layout||!(d||p))){if(this.resolvedRelativeTargetAt=io.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Xr(),this.relativeTargetOrigin=Xr(),Xp(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Ta(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Xr(),this.targetWithTransforms=Xr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),UL(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ta(this.target,this.layout.layoutBox),j4(this.target,this.targetDelta)):Ta(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Xr(),this.relativeTargetOrigin=Xr(),Xp(this.relativeTargetOrigin,this.target,m.target),Ta(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Vp&&Qh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||v2(this.parent.latestValues)||V4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var s;const a=this.getLead(),u=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty)&&(l=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===io.timestamp&&(l=!1),l)return;const{layout:h,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||d))return;Ta(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;YL(this.layoutCorrected,this.treeScale,this.path,u),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=Xr());const{target:w}=a;if(!w){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(eE(this.prevProjectionDelta.x,this.projectionDelta.x),eE(this.prevProjectionDelta.y,this.projectionDelta.y)),Kp(this.projectionDelta,this.layoutCorrected,w,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!uE(this.projectionDelta.x,this.prevProjectionDelta.x)||!uE(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",w)),Vp&&Qh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),s){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=gd(),this.projectionDelta=gd(),this.projectionDeltaWithTransform=gd()}setAnimationOrigin(s,a=!1){const u=this.snapshot,l=u?u.latestValues:{},h={...this.latestValues},d=gd();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const p=Xr(),m=u?u.source:void 0,w=this.layout?this.layout.source:void 0,b=m!==w,x=this.getStack(),E=!x||x.members.length<=1,A=!!(b&&!E&&this.options.crossfade===!0&&!this.path.some(M6));this.animationProgress=0;let N;this.mixTargetDelta=F=>{const D=F/1e3;fE(d.x,s.x,D),fE(d.y,s.y,D),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Xp(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),L6(this.relativeTarget,this.relativeTargetOrigin,p,D),N&&y6(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=Xr()),Ta(N,this.relativeTarget)),b&&(this.animationValues=h,f6(h,l,this.latestValues,D,A,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(hh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=vr.update(()=>{cv.hasAnimatedSinceResize=!0,this.currentAnimation=s6(0,lE,{...s,onUpdate:a=>{this.mixTargetDelta(a),s.onUpdate&&s.onUpdate(a)},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(lE),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:a,target:u,layout:l,latestValues:h}=s;if(!(!a||!u||!l)){if(this!==s&&this.layout&&l&&Y4(this.options.animationType,this.layout.layoutBox,l.layoutBox)){u=this.target||Xr();const d=ra(this.layout.layoutBox.x);u.x.min=s.target.x.min,u.x.max=u.x.min+d;const p=ra(this.layout.layoutBox.y);u.y.min=s.target.y.min,u.y.max=u.y.min+p}Ta(a,u),yd(a,h),Kp(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(s,a){this.sharedNodes.has(s)||this.sharedNodes.set(s,new w6),this.sharedNodes.get(s).add(a);const l=a.options.initialPromotionConfig;a.promote({transition:l?l.transition:void 0,preserveFollowOpacity:l&&l.shouldPreserveFollowOpacity?l.shouldPreserveFollowOpacity(a):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){var s;const{layoutId:a}=this.options;return a?((s=this.getStack())===null||s===void 0?void 0:s.lead)||this:this}getPrevLead(){var s;const{layoutId:a}=this.options;return a?(s=this.getStack())===null||s===void 0?void 0:s.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:a,preserveFollowOpacity:u}={}){const l=this.getStack();l&&l.promote(this,u),s&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetSkewAndRotation(){const{visualElement:s}=this.options;if(!s)return;let a=!1;const{latestValues:u}=s;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(a=!0),!a)return;const l={};u.z&&ay("z",s,l,this.animationValues);for(let h=0;h<sy.length;h++)ay(`rotate${sy[h]}`,s,l,this.animationValues),ay(`skew${sy[h]}`,s,l,this.animationValues);s.render();for(const h in l)s.setStaticValue(h,l[h]),this.animationValues&&(this.animationValues[h]=l[h]);s.scheduleRender()}getProjectionStyles(s){var a,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return x6;const l={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,l.opacity="",l.pointerEvents=uv(s==null?void 0:s.pointerEvents)||"",l.transform=h?h(this.latestValues,""):"none",l;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const b={};return this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=uv(s==null?void 0:s.pointerEvents)||""),this.hasProjected&&!Jh(this.latestValues)&&(b.transform=h?h({},""):"none",this.hasProjected=!1),b}const p=d.animationValues||d.latestValues;this.applyTransformsToTarget(),l.transform=b6(this.projectionDeltaWithTransform,this.treeScale,p),h&&(l.transform=h(p,l.transform));const{x:m,y:w}=this.projectionDelta;l.transformOrigin=`${m.origin*100}% ${w.origin*100}% 0`,d.animationValues?l.opacity=d===this?(u=(a=p.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:l.opacity=d===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const b in Iv){if(p[b]===void 0)continue;const{correct:x,applyTo:E}=Iv[b],A=l.transform==="none"?p[b]:x(p[b],d);if(E){const N=E.length;for(let F=0;F<N;F++)l[E[F]]=A}else l[b]=A}return this.options.layoutId&&(l.pointerEvents=d===this?uv(s==null?void 0:s.pointerEvents)||"":"none"),l}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>{var a;return(a=s.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(cE),this.root.sharedNodes.clear()}}}function E6(n){n.updateLayout()}function S6(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:o}=n.options,s=t.source!==n.layout.source;o==="size"?ka(d=>{const p=s?t.measuredBox[d]:t.layoutBox[d],m=ra(p);p.min=r[d].min,p.max=p.min+m}):Y4(o,t.layoutBox,r)&&ka(d=>{const p=s?t.measuredBox[d]:t.layoutBox[d],m=ra(r[d]);p.max=p.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[d].max=n.relativeTarget[d].min+m)});const a=gd();Kp(a,r,t.layoutBox);const u=gd();s?Kp(u,n.applyTransform(i,!0),t.measuredBox):Kp(u,r,t.layoutBox);const l=!G4(a);let h=!1;if(!n.resumeFrom){const d=n.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:p,layout:m}=d;if(p&&m){const w=Xr();Xp(w,t.layoutBox,p.layoutBox);const b=Xr();Xp(b,r,m.layoutBox),$4(w,b)||(h=!0),d.options.layoutRoot&&(n.relativeTarget=b,n.relativeTargetOrigin=w,n.relativeParent=d)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:u,layoutDelta:a,hasLayoutChanged:l,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function A6(n){Vp&&Qh.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function C6(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function I6(n){n.clearSnapshot()}function cE(n){n.clearMeasurements()}function T6(n){n.isLayoutDirty=!1}function k6(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function hE(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function N6(n){n.resolveTargetDelta()}function P6(n){n.calcProjection()}function R6(n){n.resetSkewAndRotation()}function D6(n){n.removeLeadSnapshot()}function fE(n,e,t){n.translate=Nr(e.translate,0,t),n.scale=Nr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function dE(n,e,t,r){n.min=Nr(e.min,t.min,r),n.max=Nr(e.max,t.max,r)}function L6(n,e,t,r){dE(n.x,e.x,t.x,r),dE(n.y,e.y,t.y,r)}function M6(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const F6={duration:.45,ease:[.4,0,.1,1]},pE=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),mE=pE("applewebkit/")&&!pE("chrome/")?Math.round:ta;function gE(n){n.min=mE(n.min),n.max=mE(n.max)}function O6(n){gE(n.x),gE(n.y)}function Y4(n,e,t){return n==="position"||n==="preserve-aspect"&&!jL(aE(e),aE(t),.2)}function B6(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const V6=X4({attachResizeListener:(n,e)=>cm(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),uy={current:void 0},J4=X4({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!uy.current){const n=new V6({});n.mount(window),n.setOptions({layoutScroll:!0}),uy.current=n}return uy.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),j6={pan:{Feature:n6},drag:{Feature:t6,ProjectionNode:J4,MeasureLayout:W4}};function vE(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,o=r[i];o&&vr.postRender(()=>o(e,Pm(e)))}class U6 extends Ah{mount(){const{current:e}=this.node;e&&(this.unmount=jR(e,t=>(vE(this.node,t,"Start"),r=>vE(this.node,r,"End"))))}unmount(){}}class z6 extends Ah{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Nm(cm(this.node.current,"focus",()=>this.onFocus()),cm(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function yE(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),o=r[i];o&&vr.postRender(()=>o(e,Pm(e)))}class W6 extends Ah{mount(){const{current:e}=this.node;e&&(this.unmount=qR(e,t=>(yE(this.node,t,"Start"),(r,{success:i})=>yE(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const w2=new WeakMap,ly=new WeakMap,q6=n=>{const e=w2.get(n.target);e&&e(n)},H6=n=>{n.forEach(q6)};function G6({root:n,...e}){const t=n||document;ly.has(t)||ly.set(t,{});const r=ly.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(H6,{root:n,...e})),r[i]}function $6(n,e,t){const r=G6(e);return w2.set(n,t),r.observe(n),()=>{w2.delete(n),r.unobserve(n)}}const K6={some:0,all:1};class X6 extends Ah{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:o}=e,s={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:K6[i]},a=u=>{const{isIntersecting:l}=u;if(this.isInView===l||(this.isInView=l,o&&!l&&this.hasEnteredView))return;l&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",l);const{onViewportEnter:h,onViewportLeave:d}=this.node.getProps(),p=l?h:d;p&&p(u)};return $6(this.node.current,s,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Y6(e,t))&&this.startObserver()}unmount(){}}function Y6({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const J6={inView:{Feature:X6},tap:{Feature:W6},focus:{Feature:z6},hover:{Feature:U6}},Q6={layout:{ProjectionNode:J4,MeasureLayout:W4}},b2={current:null},Q4={current:!1};function Z6(){if(Q4.current=!0,!!Dw)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>b2.current=n.matches;n.addListener(e),e()}else b2.current=!1}const eM=[...E4,Po,fh],tM=n=>eM.find(_4(n)),wE=new WeakMap;function nM(n,e,t){for(const r in e){const i=e[r],o=t[r];if(Vo(i))n.addValue(r,i);else if(Vo(o))n.addValue(r,um(i,{owner:n}));else if(o!==i)if(n.hasValue(r)){const s=n.getValue(r);s.liveStyle===!0?s.jump(i):s.hasAnimated||s.set(i)}else{const s=n.getStaticValue(r);n.addValue(r,um(s!==void 0?s:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const bE=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class rM{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:o,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=sb,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=el.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,vr.render(this.render,!1,!0))};const{latestValues:u,renderState:l,onUpdate:h}=s;this.onUpdate=h,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=x0(t),this.isVariantNode=PC(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in p){const w=p[m];u[m]!==void 0&&Vo(w)&&w.set(u[m],!1)}}mount(e){this.current=e,wE.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),Q4.current||Z6(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:b2.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){wE.delete(this.current),this.projection&&this.projection.unmount(),hh(this.notifyUpdate),hh(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=_f.has(e),i=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&vr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),o=t.on("renderRequest",this.scheduleRender);let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),o(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ud){const t=Ud[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Xr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<bE.length;r++){const i=bE[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o="on"+i,s=e[o];s&&(this.propEventSubscriptions[i]=this.on(i,s))}this.prevMotionValues=nM(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=um(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(b4(i)||h4(i))?i=parseFloat(i):!tM(i)&&fh.test(t)&&(i=v4(e,t)),this.setBaseTarget(e,Vo(i)?i.get():i)),Vo(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const s=jw(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);s&&(i=s[e])}if(r&&i!==void 0)return i;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!Vo(o)?o:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new eb),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class Z4 extends rM{constructor(){super(...arguments),this.KeyframeResolver=S4}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Vo(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function iM(n){return window.getComputedStyle(n)}class oM extends Z4{constructor(){super(...arguments),this.type="html",this.renderInstance=jC}readValueFromInstance(e,t){if(_f.has(t)){const r=ob(t);return r&&r.default||0}else{const r=iM(e),i=(OC(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return U4(e,t)}build(e,t,r){Ww(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return $w(e,t,r)}}class sM extends Z4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Xr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(_f.has(t)){const r=ob(t);return r&&r.default||0}return t=UC.has(t)?t:Ow(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return qC(e,t,r)}build(e,t,r){qw(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){zC(e,t,r,i)}mount(e){this.isSVGTag=Gw(e.tagName),super.mount(e)}}const aM=(n,e)=>Vw(n)?new sM(e):new oM(e,{allowProjection:n!==qe.Fragment}),uM=DR({...PL,...J6,...j6,...Q6},aM),xE=KP(uM),lM=({isOpen:n,onClose:e,onOpenSettings:t})=>{const{activeMode:r,setActiveMode:i,playSound:o,speak:s}=vu(),[a,u]=qe.useState(null);qe.useEffect(()=>{u(r==="COMMS_MENU"?"COMMS":null)},[r]);const l=160,m=r==="COMMS_MENU"?[{id:"whatsapp",label:"WHATSAPP",icon:"fab fa-whatsapp",angle:225,url:"https://wa.me/"},{id:"messenger",label:"MESSENGER",icon:"fab fa-facebook-messenger",angle:180,url:"https://m.me/"},{id:"viber",label:"VIBER",icon:"fab fa-viber",angle:135,url:"viber://forward?text=Status%20Check"},{id:"facebook",label:"FACEBOOK",icon:"fab fa-facebook-f",angle:90,url:"https://facebook.com/"},{id:"instagram",label:"INSTAGRAM",icon:"fab fa-instagram",angle:45,url:"https://instagram.com/"},{id:"x",label:"X",icon:"fab fa-x-twitter",angle:0,url:"https://x.com/"},{id:"youtube",label:"YOUTUBE",icon:"fab fa-youtube",angle:-45,url:"https://youtube.com/"},{id:"back",label:"BACK",icon:"fa-undo",angle:-90,action:()=>{i("MENU_OPEN")}}]:[{id:"hud",label:"DRIVE",icon:"fa-car",angle:-90,action:()=>{i("HUD"),s("Driving protocols initiated.")}},{id:"database",label:"DATABASE",icon:"fa-database",angle:-45,action:()=>{i("DATABASE"),s("Accessing personnel records.")}},{id:"recon",label:"RECON",icon:"fa-search-location",angle:0,action:()=>{i("RECON"),s("Sales targeting engaged.")}},{id:"ops",label:"OPS LOG",icon:"fa-file-medical-alt",angle:45,action:()=>{i("OPS"),s("Operations center online.")}},{id:"media",label:"MEDIA",icon:"fa-music",angle:90,action:()=>{i("MEDIA"),s("Media player ready.")}},{id:"vision",label:"VISION",icon:"fa-eye",angle:135,action:()=>{i("VISION"),s("Vision systems active.")}},{id:"guardian",label:"GUARDIAN",icon:"fa-shield-alt",angle:180,action:()=>{i("GUARDIAN")}},{id:"comms",label:"COMMS",icon:"fa-comments",angle:225,action:()=>{i("COMMS_MENU"),s("Comms open.")}}],w=x=>{const E=x*Math.PI/180;return{x:Math.cos(E)*l,y:Math.sin(E)*l*.8}},b=x=>{o("click"),x.url?(s(`Opening ${x.label}`),x.url.startsWith("viber://")||x.url.startsWith("whatsapp://")?window.location.href=x.url:window.open(x.url,"_blank")):x.action&&x.action()};return ae.jsx(jP,{children:n&&ae.jsx(xE.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 backdrop-blur-[2px]",onClick:()=>{e()},children:ae.jsxs("div",{className:"relative w-0 h-0 flex items-center justify-center",onClick:x=>x.stopPropagation(),children:[ae.jsx("div",{className:"absolute w-32 h-32 rounded-full cursor-pointer",onClick:()=>{e()}}),m.map((x,E)=>{const A=w(x.angle);return ae.jsxs(xE.button,{initial:{x:0,y:0,scale:0,opacity:0},animate:{x:A.x,y:A.y,scale:1,opacity:1},exit:{x:0,y:0,scale:0,opacity:0},transition:{type:"spring",stiffness:200,damping:20,delay:E*.03},onClick:()=>b(x),className:`
                    absolute w-20 h-20 rounded-full border border-cyan/50 bg-black/80
                    flex flex-col items-center justify-center gap-1
                    shadow-[0_0_15px_rgba(0,229,255,0.2)]
                    hover:scale-110 hover:border-cyan hover:bg-cyan/20 hover:shadow-[0_0_25px_rgba(0,229,255,0.6)]
                    active:scale-95 transition-all
                    ${x.id==="back"?"border-red-500/50 text-red-500 hover:border-red-500":"text-cyan"}
                  `,children:[ae.jsx("i",{className:`fas ${x.icon} text-2xl`}),ae.jsx("span",{className:"font-orbitron text-[8px] tracking-wider mt-1",children:x.label}),ae.jsx("div",{className:"absolute top-1/2 left-1/2 w-[160px] h-[1px] bg-cyan/20 -z-10 origin-left pointer-events-none",style:{transform:`rotate(${x.angle+180}deg)`,width:`${l}px`,left:"50%",top:"50%"}})]},x.id)})]})})})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e3=function(n,e){return(e3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])})(n,e)};function yu(n,e){function t(){this.constructor=n}e3(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function kt(n,e,t,r){return new(t||(t=Promise))((function(i,o){function s(l){try{u(r.next(l))}catch(h){o(h)}}function a(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):new t((function(h){h(l.value)})).then(s,a)}u((r=r.apply(n,[])).next())}))}function Nt(n,e){var t,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(i=2&h[0]?r.return:h[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,h[1])).done)return i;switch(r=0,i&&(h=[2&h[0],i.value]),h[0]){case 0:case 1:i=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,r=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(h[0]===6||h[0]===2)){s=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){s.label=h[1];break}if(h[0]===6&&s.label<i[1]){s.label=i[1],i=h;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(h);break}i[2]&&s.ops.pop(),s.trys.pop();continue}h=e.call(n,s)}catch(d){h=[6,d],r=0}finally{t=i=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([u,l])}}}var cM=(function(){function n(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return n.prototype.setPlatform=function(e,t){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},n.prototype.registerFlag=function(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){var i=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+i+"."),this.set(e,i)}},n.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},n.prototype.getNumber=function(e){return this.get(e)},n.prototype.getBool=function(e){return this.get(e)},n.prototype.getFlags=function(){return this.flags},Object.defineProperty(n.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),n.prototype.set=function(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)},n.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},n.prototype.setFlags=function(e){this.flags=Object.assign({},e)},n.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},n.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var t,r,i=(t=this.global.location.search,r={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(o){for(var s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];return hM(r,s[0],s[1]),s.join("=")})),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach((function(o){var s=o.split(":"),a=s[0],u=s[1];e.urlFlags[a]=(function(l,h){if((h=h.toLowerCase())==="true"||h==="false")return h==="true";if(""+ +h===h)return+h;throw new Error("Could not parse value flag value "+h+" for flag "+l+".")})(a,u)}))}},n})();function hM(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function Ye(){return t3}var t3=null,Dv=new Map,x2=new Map;function n3(n,e){var t=i3(n,e);return Dv.get(t)}function fM(n){return x2.get(n)}function _E(n){for(var e=Dv.entries(),t=[];;){var r=e.next(),i=r.done,o=r.value;if(i)break;var s=o[0],a=o[1];s.split("_")[0]===n&&t.push(a)}return t}function r3(n){var e=n.kernelName,t=n.backendName,r=i3(e,t);if(Dv.has(r))throw new Error("The kernel '"+e+"' for backend '"+t+"' is already registered");Dv.set(r,n)}function dM(n){var e=n.kernelName;x2.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),x2.set(e,n)}function i3(n,e){return e+"_"+n}function _2(n,e,t){return Math.max(n,Math.min(e,t))}function o3(n){return n%2==0?n:n+1}function pM(n){for(var e=0,t=0;t<n.length;t++)e+=n[t];return e}function pe(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function Yn(n,e,t){t===void 0&&(t=""),pe(qi(n,e),(function(){return t+" Shapes "+n+" and "+e+" must match"}))}function rp(n){pe(n!=null,(function(){return"The input to the tensor constructor must be a non-null value."}))}function Wd(n,e,t){if(e===void 0&&(e=[]),t===void 0&&(t=!1),e==null&&(e=[]),Array.isArray(n)||tl(n)&&!t)for(var r=0;r<n.length;++r)Wd(n[r],e,t);else e.push(n);return e}function Dt(n){if(n.length===0)return 1;for(var e=n[0],t=1;t<n.length;t++)e*=n[t];return e}function qi(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function ei(n){return n%1==0}function mM(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;var e=Math.exp(2*n);return(e-1)/(e+1)}function E2(n){var e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function xd(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function EE(n,e,t){return e===void 0&&(e=function(r){return 0}),new Promise((function(r,i){var o=0,s=function(){if(n())r();else{o++;var a=e(o);t!=null&&o>=t?i():setTimeout(s,a)}};s()}))}function gM(n,e){for(var t=1,r=-1,i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(n[i]<0)throw Error("Shapes can not be < 0. Found "+n[i]+" at dim "+i);if(r===-1){if(e>0&&e!==t)throw Error("Size("+e+") must match the product of shape "+n);return n}if(t===0)throw Error("Cannot infer the missing size in ["+n+"] when there are 0 elements");if(e%t!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+t);var o=n.slice();return o[r]=e/t,o}function Ii(n,e){var t=e.length;return pe((n=n==null?e.map((function(r,i){return i})):[].concat(n)).every((function(r){return r>=-t&&r<t})),(function(){return"All values in axis param must be in range [-"+t+", "+t+") but got axis "+n})),pe(n.every((function(r){return ei(r)})),(function(){return"All values in axis param must be integers but got axis "+n})),n.map((function(r){return r<0?t+r:r}))}function rf(n,e){for(var t=[],r=[],i=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||i?null:Ii(e,n).sort(),s=0,a=0;a<n.length;++a){if(o!=null){if(o[s]===a&&n[a]!==1)throw new Error("Can't squeeze axis "+a+" since its dim '"+n[a]+"' is not 1");(o[s]==null||o[s]>a)&&n[a]===1&&(t.push(n[a]),r.push(a)),o[s]<=a&&s++}n[a]!==1&&(t.push(n[a]),r.push(a))}return{newShape:t,keptDims:r}}function hm(n,e){var t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else{if(n!=="bool")throw new Error("Unknown data type "+n);t=new Uint8Array(e)}return t}function Lv(n,e){var t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else{if(n!=="string")throw new Error("Unknown data type "+n);t=new Array(e)}return t}function vM(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function yM(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function wM(n,e){return e!=="complex64"&&(e!=="float32"||n==="complex64")&&(e!=="int32"||n==="float32"||n==="complex64")&&(e!=="bool"||n!=="bool")}function tl(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array}function s3(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error("Unknown dtype "+n)}function bM(n){if(n==null)return 0;var e=0;return n.forEach((function(t){return e+=t.length})),e}function cb(n){return typeof n=="string"||n instanceof String}function xM(n){return typeof n=="boolean"}function _M(n){return typeof n=="number"}function Rm(n){return Array.isArray(n)?Rm(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array?"int32":_M(n)?"float32":cb(n)?"string":xM(n)?"bool":"float32"}function S2(n){return!!(n&&n.constructor&&n.call&&n.apply)}function A2(n,e){for(var t=e;t<n;++t)if(n%t==0)return t;return n}function nl(n){var e=n.length;if(e<2)return[];var t=new Array(e-1);t[e-2]=n[e-1];for(var r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function a3(n,e,t){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Wd(n)),t&&vM(n,e),(function(o,s){return o instanceof Float32Array&&s==="float32"||o instanceof Int32Array&&s==="int32"||o instanceof Uint8Array&&s==="bool"})(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){for(var r=new Uint8Array(n.length),i=0;i<r.length;++i)Math.round(n[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function SE(n,e){if(n.length===0)return e[0];var t=n.reduce((function(r,i){return r*i}));if(t===0)return[];if(t!==e.length)throw new Error("["+n+"] does not match the input size.");return(function r(i,o,s){var a=new Array;if(o.length===1)for(var u=o[0],l=0;l<u;l++)a[l]=s[i+l];else{u=o[0];var h=o.slice(1),d=h.reduce((function(p,m){return p*m}));for(l=0;l<u;l++)a[l]=r(i+l*d,h,s)}return a})(0,n,e)}function u3(n,e){for(var t=Dm(n,e),r=0;r<t.length;r++)t[r]=1;return t}function Dm(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error("Unknown data type "+e)}function Gu(){return Ye().platform.now()}function l3(n){n.forEach((function(e){pe(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+n+"]."}))}))}function EM(n,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",Ye().platform.encode(n,e)}function Mv(n,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",Ye().platform.decode(n,e)}function AE(n,e,t){if(e===0)return 0;if(e===1)return n[0];for(var r=n[n.length-1],i=0;i<n.length-1;++i)r+=t[i]*n[i];return r}function SM(n,e,t){if(e===0)return[];if(e===1)return[n];for(var r=new Array(e),i=0;i<r.length-1;++i)r[i]=Math.floor(n/t[i]),n-=r[i]*t[i];return r[r.length-1]=n,r}var AM=(function(){function n(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new CM)}return n.prototype.profileKernel=function(e,t,r){var i,o=this,s=this.backendTimer.time((function(){i=r()}));return i.forEach((function(a){a.data().then((function(u){(function(l,h,d){if(h!=="float32")return!1;for(var p=0;p<l.length;p++){var m=l[p];if(isNaN(m)||!isFinite(m))return console.warn("Found "+m+" in the result of '"+d+"'"),!0}})(u,a.dtype,e),s.then((function(l){var h="";l.getExtraProfileInfo!=null&&(h=l.getExtraProfileInfo()),o.logger.logKernelProfile(e,a,u,l.kernelMs,t,h)}))}))})),i},n})(),CM=(function(){function n(){}return n.prototype.logKernelProfile=function(e,t,r,i,o,s){var a=typeof i=="number"?xd(i+"ms",9):i.error,u=xd(e,25),l=t.rank,h=t.size,d=xd(t.shape.toString(),14),p="";for(var m in o){var w=o[m].shape||t.shape,b=w.length;p+=m+": "+b+"D "+(b>0?w:"")+" "}console.log("%c"+u+"	%c"+a+"	%c"+l+"D "+d+"	%c"+h+"	%c"+p+"	%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},n})(),CE=20,Pp=3,cy=7;function IM(n,e,t,r){var i=nl(e),o=(function(l,h,d,p){var m=Dt(h),w=p[p.length-1],b=new Array(w).fill(0),x=h.length,E=d==="complex64"?Dp(l):l;if(x>1)for(var A=0;A<m/w;A++)for(var N=A*w,F=0;F<w;F++)b[F]=Math.max(b[F],Rp(E[N+F],0,d).length);return b})(n,e,t,i),s=e.length,a=(function l(h,d,p,m,w,b){b===void 0&&(b=!0);var x=p==="complex64"?2:1,E=d[0],A=d.length;if(A===0)return p==="complex64"?[Rp(Dp(h)[0],0,p)]:p==="bool"?[c3(h[0])]:[h[0].toString()];if(A===1){if(E>CE){var N=Pp*x,F=Array.from(h.slice(0,N)),D=Array.from(h.slice((E-Pp)*x,E*x));return p==="complex64"&&(F=Dp(F),D=Dp(D)),["["+F.map((function(de,fe){return Rp(de,w[fe],p)})).join(", ")+", ..., "+D.map((function(de,fe){return Rp(de,w[E-Pp+fe],p)})).join(", ")+"]"]}return["["+(p==="complex64"?Dp(h):Array.from(h)).map((function(de,fe){return Rp(de,w[fe],p)})).join(", ")+"]"]}var W=d.slice(1),k=m.slice(1),C=m[0]*x,L=[];if(E>CE){for(var B=0;B<Pp;B++){var R=(M=B*C)+C;L.push.apply(L,l(h.slice(M,R),W,p,k,w,!1))}for(L.push("..."),B=E-Pp;B<E;B++)R=(M=B*C)+C,L.push.apply(L,l(h.slice(M,R),W,p,k,w,B===E-1))}else for(B=0;B<E;B++){var M;R=(M=B*C)+C,L.push.apply(L,l(h.slice(M,R),W,p,k,w,B===E-1))}var U=A===2?",":"";for(L[0]="["+L[0]+U,B=1;B<L.length-1;B++)L[B]=" "+L[B]+U;var J=`,
`;for(B=2;B<A;B++)J+=`
`;return L[L.length-1]=" "+L[L.length-1]+"]"+(b?"":J),L})(n,e,t,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+t),u.push("  rank: "+s),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(a.map((function(l){return"    "+l})).join(`
`)),u.join(`
`)}function Rp(n,e,t){return xd(Array.isArray(n)?parseFloat(n[0].toFixed(cy))+" + "+parseFloat(n[1].toFixed(cy))+"j":cb(n)?"'"+n+"'":t==="bool"?c3(n):parseFloat(n.toFixed(cy)).toString(),e)}function c3(n){return n===0?"false":"true"}function Dp(n){for(var e=[],t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}var fm=(function(){function n(e,t,r){var i=this;if(this.dtype=t,this.shape=e.slice(),this.size=Dt(e),r!=null){var o=r.length;pe(o===this.size,(function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+i.size+"'."}))}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Lv(t,this.size),this.strides=nl(e)}return n.prototype.set=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),pe(r.length===this.rank,(function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+t.rank+")"}));var o=this.locToIndex(r);this.values[o]=e},n.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length===0&&(e=[0]);for(var r=0,i=0,o=e;i<o.length;i++){var s=o[i];if(s<0||s>=this.shape[r]){var a="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(a)}r++}for(var u=e[e.length-1],l=0;l<e.length-1;++l)u+=this.strides[l]*e[l];return this.values[u]},n.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var t=e[e.length-1],r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t},n.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var t=new Array(this.shape.length),r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.toTensor=function(){return $u().makeTensor(this.values,this.shape,this.dtype)},n})(),$u=null,We=null,h3=null,Tr=(function(){function n(e,t,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Dt(e),this.strides=nl(e),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return n.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},n.prototype.asScalar=function(){return this.throwIfDisposed(),pe(this.size===1,(function(){return"The array must have only 1 element."})),this.reshape([])},n.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},n.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},n.prototype.as3D=function(e,t,r){return this.throwIfDisposed(),this.reshape([e,t,r])},n.prototype.as4D=function(e,t,r,i){return this.throwIfDisposed(),this.reshape([e,t,r,i])},n.prototype.as5D=function(e,t,r,i,o){return this.throwIfDisposed(),this.reshape([e,t,r,i,o])},n.prototype.asType=function(e){return this.throwIfDisposed(),We.cast(this,e)},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.buffer=function(){return kt(this,void 0,void 0,(function(){var e;return Nt(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,We.buffer(this.shape,this.dtype,e)]}}))}))},n.prototype.bufferSync=function(){return We.buffer(this.shape,this.dtype,this.dataSync())},n.prototype.array=function(){return kt(this,void 0,void 0,(function(){var e;return Nt(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,SE(this.shape,e)]}}))}))},n.prototype.arraySync=function(){return SE(this.shape,this.dataSync())},n.prototype.data=function(){return kt(this,void 0,void 0,(function(){var e,t;return Nt(this,(function(r){switch(r.label){case 0:return this.throwIfDisposed(),e=$u().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:t=r.sent();try{return[2,t.map((function(i){return Mv(i)}))]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,e]}}))}))},n.prototype.dataSync=function(){this.throwIfDisposed();var e=$u().readSync(this.dataId);if(this.dtype==="string")try{return e.map((function(t){return Mv(t)}))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},n.prototype.bytes=function(){return kt(this,void 0,void 0,(function(){var e;return Nt(this,(function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,$u().read(this.dataId)];case 1:return e=t.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}}))}))},n.prototype.dispose=function(){this.isDisposed||($u().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(n.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),n.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},n.prototype.toFloat=function(){return this.asType("float32")},n.prototype.toInt=function(){return this.asType("int32")},n.prototype.toBool=function(){return this.asType("bool")},n.prototype.print=function(e){return e===void 0&&(e=!1),We.print(this,e)},n.prototype.reshape=function(e){return this.throwIfDisposed(),We.reshape(this,e)},n.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},n.prototype.expandDims=function(e){return e===void 0&&(e=0),We.expandDims(this,e)},n.prototype.cumsum=function(e,t,r){return e===void 0&&(e=0),t===void 0&&(t=!1),r===void 0&&(r=!1),We.cumsum(this,e,t,r)},n.prototype.squeeze=function(e){return this.throwIfDisposed(),We.squeeze(this,e)},n.prototype.clone=function(){return this.throwIfDisposed(),We.clone(this)},n.prototype.oneHot=function(e,t,r){return this.throwIfDisposed(),We.oneHot(this,e,t,r)},n.prototype.toString=function(e){return e===void 0&&(e=!1),IM(this.dataSync(),this.shape,this.dtype,e)},n.prototype.tile=function(e){return this.throwIfDisposed(),We.tile(this,e)},n.prototype.gather=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),We.gather(this,e,t)},n.prototype.matMul=function(e,t,r){return t===void 0&&(t=!1),r===void 0&&(r=!1),this.throwIfDisposed(),We.matMul(this,e,t,r)},n.prototype.dot=function(e){return this.throwIfDisposed(),We.dot(this,e)},n.prototype.norm=function(e,t,r){return e===void 0&&(e="euclidean"),t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),We.norm(this,e,t,r)},n.prototype.slice=function(e,t){return this.throwIfDisposed(),We.slice(this,e,t)},n.prototype.reverse=function(e){return this.throwIfDisposed(),We.reverse(this,e)},n.prototype.concat=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),e instanceof n&&(e=[e]),We.concat([this].concat(e),t)},n.prototype.split=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),We.split(this,e,t)},n.prototype.stack=function(e,t){return t===void 0&&(t=0),We.stack([this,e],t)},n.prototype.unstack=function(e){return e===void 0&&(e=0),We.unstack(this,e)},n.prototype.pad=function(e,t){return t===void 0&&(t=0),We.pad(this,e,t)},n.prototype.batchNormalization=function(e,t,r,i,o){return r===void 0&&(r=.001),h3("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,o,i,r)},n.prototype.batchNorm=function(e,t,r,i,o){return o===void 0&&(o=.001),this.throwIfDisposed(),We.batchNorm(this,e,t,r,i,o)},n.prototype.all=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.all(this,e,t)},n.prototype.any=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.any(this,e,t)},n.prototype.logSumExp=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.logSumExp(this,e,t)},n.prototype.sum=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.sum(this,e,t)},n.prototype.prod=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.prod(this,e,t)},n.prototype.mean=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.mean(this,e,t)},n.prototype.min=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.min(this,e,t)},n.prototype.max=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.max(this,e,t)},n.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),We.argMin(this,e)},n.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),We.argMax(this,e)},n.prototype.cast=function(e){return this.throwIfDisposed(),We.cast(this,e)},n.prototype.add=function(e){return this.throwIfDisposed(),We.add(this,e)},n.prototype.addStrict=function(e){return this.throwIfDisposed(),We.addStrict(this,e)},n.prototype.atan2=function(e){return this.throwIfDisposed(),We.atan2(this,e)},n.prototype.sub=function(e){return this.throwIfDisposed(),We.sub(this,e)},n.prototype.subStrict=function(e){return this.throwIfDisposed(),We.subStrict(this,e)},n.prototype.pow=function(e){return this.throwIfDisposed(),We.pow(this,e)},n.prototype.powStrict=function(e){return this.throwIfDisposed(),We.powStrict(this,e)},n.prototype.mul=function(e){return this.throwIfDisposed(),We.mul(this,e)},n.prototype.mulStrict=function(e){return this.throwIfDisposed(),We.mulStrict(this,e)},n.prototype.div=function(e){return this.throwIfDisposed(),We.div(this,e)},n.prototype.divNoNan=function(e){return this.throwIfDisposed(),We.divNoNan(this,e)},n.prototype.floorDiv=function(e){return this.throwIfDisposed(),We.floorDiv(this,e)},n.prototype.divStrict=function(e){return this.throwIfDisposed(),We.divStrict(this,e)},n.prototype.minimum=function(e){return this.throwIfDisposed(),We.minimum(this,e)},n.prototype.minimumStrict=function(e){return this.throwIfDisposed(),We.minimumStrict(this,e)},n.prototype.maximum=function(e){return this.throwIfDisposed(),We.maximum(this,e)},n.prototype.maximumStrict=function(e){return this.throwIfDisposed(),We.maximumStrict(this,e)},n.prototype.mod=function(e){return this.throwIfDisposed(),We.mod(this,e)},n.prototype.modStrict=function(e){return this.throwIfDisposed(),We.modStrict(this,e)},n.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),We.squaredDifferenceStrict(this,e)},n.prototype.transpose=function(e){return this.throwIfDisposed(),We.transpose(this,e)},n.prototype.notEqual=function(e){return this.throwIfDisposed(),We.notEqual(this,e)},n.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),We.notEqualStrict(this,e)},n.prototype.less=function(e){return this.throwIfDisposed(),We.less(this,e)},n.prototype.lessStrict=function(e){return this.throwIfDisposed(),We.lessStrict(this,e)},n.prototype.equal=function(e){return this.throwIfDisposed(),We.equal(this,e)},n.prototype.equalStrict=function(e){return this.throwIfDisposed(),We.equalStrict(this,e)},n.prototype.lessEqual=function(e){return this.throwIfDisposed(),We.lessEqual(this,e)},n.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),We.lessEqualStrict(this,e)},n.prototype.greater=function(e){return this.throwIfDisposed(),We.greater(this,e)},n.prototype.greaterStrict=function(e){return this.throwIfDisposed(),We.greaterStrict(this,e)},n.prototype.greaterEqual=function(e){return this.throwIfDisposed(),We.greaterEqual(this,e)},n.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),We.greaterEqualStrict(this,e)},n.prototype.logicalAnd=function(e){return this.throwIfDisposed(),We.logicalAnd(this,e)},n.prototype.logicalOr=function(e){return this.throwIfDisposed(),We.logicalOr(this,e)},n.prototype.logicalNot=function(){return this.throwIfDisposed(),We.logicalNot(this)},n.prototype.logicalXor=function(e){return this.throwIfDisposed(),We.logicalXor(this,e)},n.prototype.where=function(e,t){return this.throwIfDisposed(),We.where(e,this,t)},n.prototype.neg=function(){return this.throwIfDisposed(),We.neg(this)},n.prototype.ceil=function(){return this.throwIfDisposed(),We.ceil(this)},n.prototype.floor=function(){return this.throwIfDisposed(),We.floor(this)},n.prototype.sign=function(){return this.throwIfDisposed(),We.sign(this)},n.prototype.isNaN=function(){return this.throwIfDisposed(),We.isNaN(this)},n.prototype.isInf=function(){return this.throwIfDisposed(),We.isInf(this)},n.prototype.isFinite=function(){return this.throwIfDisposed(),We.isFinite(this)},n.prototype.exp=function(){return this.throwIfDisposed(),We.exp(this)},n.prototype.expm1=function(){return this.throwIfDisposed(),We.expm1(this)},n.prototype.log=function(){return this.throwIfDisposed(),We.log(this)},n.prototype.log1p=function(){return this.throwIfDisposed(),We.log1p(this)},n.prototype.sqrt=function(){return this.throwIfDisposed(),We.sqrt(this)},n.prototype.rsqrt=function(){return this.throwIfDisposed(),We.rsqrt(this)},n.prototype.square=function(){return this.throwIfDisposed(),We.square(this)},n.prototype.reciprocal=function(){return this.throwIfDisposed(),We.reciprocal(this)},n.prototype.abs=function(){return this.throwIfDisposed(),We.abs(this)},n.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),We.clipByValue(this,e,t)},n.prototype.relu=function(){return this.throwIfDisposed(),We.relu(this)},n.prototype.relu6=function(){return this.throwIfDisposed(),We.relu6(this)},n.prototype.elu=function(){return this.throwIfDisposed(),We.elu(this)},n.prototype.selu=function(){return this.throwIfDisposed(),We.selu(this)},n.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),We.leakyRelu(this,e)},n.prototype.prelu=function(e){return this.throwIfDisposed(),We.prelu(this,e)},n.prototype.sigmoid=function(){return this.throwIfDisposed(),We.sigmoid(this)},n.prototype.logSigmoid=function(){return this.throwIfDisposed(),We.logSigmoid(this)},n.prototype.softplus=function(){return this.throwIfDisposed(),We.softplus(this)},n.prototype.zerosLike=function(){return this.throwIfDisposed(),We.zerosLike(this)},n.prototype.onesLike=function(){return this.throwIfDisposed(),We.onesLike(this)},n.prototype.sin=function(){return this.throwIfDisposed(),We.sin(this)},n.prototype.cos=function(){return this.throwIfDisposed(),We.cos(this)},n.prototype.tan=function(){return this.throwIfDisposed(),We.tan(this)},n.prototype.asin=function(){return this.throwIfDisposed(),We.asin(this)},n.prototype.acos=function(){return this.throwIfDisposed(),We.acos(this)},n.prototype.atan=function(){return this.throwIfDisposed(),We.atan(this)},n.prototype.sinh=function(){return this.throwIfDisposed(),We.sinh(this)},n.prototype.cosh=function(){return this.throwIfDisposed(),We.cosh(this)},n.prototype.tanh=function(){return this.throwIfDisposed(),We.tanh(this)},n.prototype.asinh=function(){return this.throwIfDisposed(),We.asinh(this)},n.prototype.acosh=function(){return this.throwIfDisposed(),We.acosh(this)},n.prototype.atanh=function(){return this.throwIfDisposed(),We.atanh(this)},n.prototype.erf=function(){return this.throwIfDisposed(),We.erf(this)},n.prototype.round=function(){return this.throwIfDisposed(),We.round(this)},n.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),We.step(this,e)},n.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),We.softmax(this,e)},n.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),We.logSoftmax(this,e)},n.prototype.resizeBilinear=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),We.image.resizeBilinear(this,e,t)},n.prototype.resizeNearestNeighbor=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),We.image.resizeNearestNeighbor(this,e,t)},n.prototype.conv1d=function(e,t,r,i,o,s){return i===void 0&&(i="NWC"),o===void 0&&(o=1),this.throwIfDisposed(),We.conv1d(this,e,t,r,i,o,s)},n.prototype.conv2d=function(e,t,r,i,o,s){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),We.conv2d(this,e,t,r,i,o,s)},n.prototype.conv2dTranspose=function(e,t,r,i,o){return this.throwIfDisposed(),We.conv2dTranspose(this,e,t,r,i,o)},n.prototype.depthwiseConv2D=function(e,t,r,i,o,s){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),We.depthwiseConv2d(this,e,t,r,i,o,s)},n.prototype.separableConv2d=function(e,t,r,i,o,s){return o===void 0&&(o=[1,1]),s===void 0&&(s="NHWC"),this.throwIfDisposed(),We.separableConv2d(this,e,t,r,i,o,s)},n.prototype.avgPool=function(e,t,r,i){return this.throwIfDisposed(),We.avgPool(this,e,t,r,i)},n.prototype.maxPool=function(e,t,r,i){return this.throwIfDisposed(),We.maxPool(this,e,t,r,i)},n.prototype.localResponseNormalization=function(e,t,r,i){return e===void 0&&(e=5),t===void 0&&(t=1),r===void 0&&(r=1),i===void 0&&(i=.5),We.localResponseNormalization(this,e,t,r,i)},n.prototype.pool=function(e,t,r,i,o){return this.throwIfDisposed(),We.pool(this,e,t,r,i,o)},n.prototype.variable=function(e,t,r){return e===void 0&&(e=!0),this.throwIfDisposed(),$u().makeVariable(this,e,t,r)},n.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),We.unsortedSegmentSum(this,e,t)},n.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),We.batchToSpaceND(this,e,t)},n.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),We.spaceToBatchND(this,e,t)},n.prototype.topk=function(e,t){return e===void 0&&(e=1),t===void 0&&(t=!0),this.throwIfDisposed(),We.topk(this,e,t)},n.prototype.stridedSlice=function(e,t,r,i,o,s,a,u){return i===void 0&&(i=0),o===void 0&&(o=0),s===void 0&&(s=0),a===void 0&&(a=0),u===void 0&&(u=0),this.throwIfDisposed(),We.stridedSlice(this,e,t,r,i,o,s,a,u)},n.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),We.depthToSpace(this,e,t)},n.prototype.fft=function(){return this.throwIfDisposed(),We.spectral.fft(this)},n.prototype.ifft=function(){return this.throwIfDisposed(),We.spectral.ifft(this)},n.prototype.rfft=function(){return this.throwIfDisposed(),We.spectral.rfft(this)},n.prototype.irfft=function(){return this.throwIfDisposed(),We.spectral.irfft(this)},n})();Object.defineProperty(Tr,Symbol.hasInstance,{value:function(n){return!!n&&n.dataId!=null&&n.shape!=null&&n.dtype!=null}});var IE,C2,I2,T2,k2,qd=(function(n){function e(t,r,i,o){var s=n.call(this,t.shape,t.dtype,t.dataId,o)||this;return s.trainable=r,s.name=i,s}return yu(e,n),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!qi(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");$u().disposeTensor(this),this.dataId=t.dataId,$u().incRef(this,null)},e.prototype.dispose=function(){$u().disposeVariable(this),this.isDisposedInternal=!0},e})(Tr);Object.defineProperty(qd,Symbol.hasInstance,{value:function(n){return n instanceof Tr&&n.assign!=null&&n.assign instanceof Function}}),(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(IE||(IE={})),(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(C2||(C2={})),(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(I2||(I2={})),(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(T2||(T2={})),(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(k2||(k2={}));var TM={float32:T2,int32:C2,bool:I2,complex64:k2};function so(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error("Can not upcast "+n+" with "+e)}return TM[n][e]}function hy(n){return so(n,"int32")}function Dr(n,e){if(n.dtype===e.dtype)return[n,e];var t=so(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function kM(n,e){pe(n.dtype===e.dtype,(function(){return"The dtypes of the first("+n.dtype+") and second("+e.dtype+") input must match"}))}function f3(n){var e=[];return(function t(r,i,o){if(r!=null){if(r instanceof Tr)return void i.push(r);if(s=r,!(!Array.isArray(s)&&typeof s!="object")){var s,a=r;for(var u in a){var l=a[u];o.has(l)||(o.add(l),t(l,i,o))}}}})(n,e,new Set),e}var fy,TE=(function(){function n(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return n.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},n})(),NM=(function(){function n(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new TE}return n.prototype.ready=function(){return kt(this,void 0,void 0,(function(){var e,t,r;return Nt(this,(function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then((function(){}))];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),t=0,i.label=1;case 1:return t<e.length?(r=e[t],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(n.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),n.prototype.backendNames=function(){return Object.keys(this.registryFactory)},n.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},n.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},n.prototype.registerBackend=function(e,t,r){return r===void 0&&(r=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:r},!0)},n.prototype.setBackend=function(e){return kt(this,void 0,void 0,(function(){var t,r,i;return Nt(this,(function(o){switch(o.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),r=t.success,t.asyncInit?[4,r]:[3,2]);case 1:return i=o.sent(),[3,3];case 2:i=r,o.label=3;case 3:if(!i)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new AM(this.backendInstance),[2,!0]}}))}))},n.prototype.setupRegisteredKernels=function(){var e=this;_E(this.backendName).forEach((function(t){t.setupFunc!=null&&t.setupFunc(e.backendInstance)}))},n.prototype.disposeRegisteredKernels=function(e){var t=this;_E(e).forEach((function(r){r.disposeFunc!=null&&r.disposeFunc(t.registry[e])}))},n.prototype.initializeBackend=function(e){var t=this,r=this.registryFactory[e];if(r==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var o=++this.pendingBackendInitId,s=i.then((function(a){return!(o<t.pendingBackendInitId)&&(t.registry[e]=a,t.pendingBackendInit=null,!0)})).catch((function(a){return!(o<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(a.stack||a.message),!1)}));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[e]=i,{success:!0,asyncInit:!1}}catch(a){return console.warn("Initialization of backend "+e+" failed"),console.warn(a.stack||a.message),{success:!1,asyncInit:!1}}},n.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},n.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,r){return e.registryFactory[r].priority-e.registryFactory[t].priority}))},n.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var r=e[t],i=this.initializeBackend(r),o=i.success,s=i.asyncInit;if(s||o)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},n.prototype.moveData=function(e,t){var r=this.state.tensorInfo.get(t),i=r.backend,o=this.readSync(t);i.disposeData(t),r.backend=e,e.move(t,o,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},n.prototype.tidy=function(e,t){var r,i=this,o=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}return this.scopedRun((function(){return i.startScope(o)}),(function(){return i.endScope(r)}),(function(){return(r=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r}))},n.prototype.scopedRun=function(e,t,r){e();try{var i=r();return t(),i}catch(o){throw t(),o}},n.prototype.nextTensorId=function(){return n.nextTensorId++},n.prototype.nextVariableId=function(){return n.nextVariableId++},n.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),r={x:e};return this.addTapeNode(this.state.activeScope.name,r,[t],(function(i){return{x:function(){return i.toFloat()}}}),[]),t},n.prototype.runKernel=function(e,t,r,i,o){return this.runKernelFunc(null,t,null,e,r,i,o)},n.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},n.prototype.checkKernelForMemLeak=function(e,t,r){var i=this.backend.numDataIds(),o=0;r.forEach((function(u){o+=u.dtype==="complex64"?3:1}));var s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=i-t-o-s;if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+e+"'")},n.prototype.runKernelFunc=function(e,t,r,i,o,s,a){var u,l=this;s===void 0&&(s=[]),a===void 0&&(a=[]);var h=[],d=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");var p,m=function(A){d&&(h=A.map((function(N){return l.keep(l.clone(N))})))},w=this.state.numBytes,b=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var x,E=n3(i,this.backendName);return p=E!=null?function(){var A=l.backend.numDataIds();x=E.kernelFunc({inputs:t,attrs:o,backend:l.backend});var N=Array.isArray(x)?x:[x];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,A,N);var F=N.map((function(W){var k=W.dataId,C=W.shape,L=W.dtype;return l.makeTensorFromDataId(k,C,L)})),D=F.filter((function(W,k){return a[k]}));return m((s||[]).slice().concat(D)),F}:function(){var A=l.backend.numDataIds();x=l.tidy((function(){return e(l.backend,m)}));var N=Array.isArray(x)?x:[x];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,A,N),N},this.scopedRun((function(){return l.state.kernelDepth++}),(function(){return l.state.kernelDepth--}),(function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(i,t,(function(){return p()})):p()})),d&&this.addTapeNode(i,t,u,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-w,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-b,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(A){return t[A].shape})),outputShapes:u.map((function(A){return A.shape}))}),Array.isArray(x)?u:u[0]},n.prototype.makeTensor=function(e,t,r,i){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var o=e;r==="string"&&cb(e[0])&&(o=e.map((function(h){return EM(h)})));var s=i.write(o,t,r),a=new Tr(t,r,s,this.nextTensorId());if(this.incRef(a,i),r==="string"){var u=this.state.tensorInfo.get(s),l=bM(o);this.state.numBytes+=l-u.bytes,u.bytes=l}return a},n.prototype.makeTensorFromDataId=function(e,t,r,i){var o=new Tr(t,r=r||"float32",e,this.nextTensorId());return this.incRef(o,i),o},n.prototype.makeVariable=function(e,t,r,i){t===void 0&&(t=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==e.dtype&&(e=e.asType(i));var o=new qd(e,t,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},n.prototype.incRef=function(e,t){var r=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(i=e.size*s3(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof qd||this.track(e)},n.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},n.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},n.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},n.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},n.prototype.profile=function(e){return kt(this,void 0,void 0,(function(){var t,r;return Nt(this,(function(i){return this.state.profiling=!0,t=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(o){return o.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]}))}))},n.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},n.prototype.addTapeNode=function(e,t,r,i,o){var s=this,a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:o},u=fM(e);u!=null&&(i=u.gradFunc),i!=null&&(a.gradient=function(l){return l=l.map((function(h,d){if(h==null){var p=r[d],m=Dm(p.size,p.dtype);return s.makeTensor(m,p.shape,p.dtype)}return h})),i(l.length>1?l:l[0],o)}),this.state.activeTape.push(a)},n.prototype.keep=function(e){return e.kept=!0,e},n.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},n.prototype.endTape=function(){this.state.gradientDepth--},n.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},n.prototype.endScope=function(e){for(var t=this,r=f3(e),i=new Set(r.map((function(u){return u.id}))),o=0;o<this.state.activeScope.track.length;o++){var s=this.state.activeScope.track[o];s.kept||i.has(s.id)||s.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach((function(u){u.kept||u.scopeId!==a.id||t.track(u)}))},n.prototype.gradients=function(e,t,r,i){var o=this;if(i===void 0&&(i=!1),pe(t.length>0,(function(){return"gradients() received an empty list of xs."})),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var s=this.scopedRun((function(){return o.startTape()}),(function(){return o.endTape()}),(function(){return o.tidy("forward",e)}));pe(s instanceof Tr,(function(){return"The result y returned by f() must be a tensor."}));var a=(function(u,l,h){for(var d={},p={},m=0;m<l.length;m++)d[l[m].id]=!0;for(m=0;m<u.length;m++){var w=(W=u[m]).inputs;for(var b in w){for(var x=w[b],E=!1,A=0;A<l.length;A++)if(d[x.id]){W.outputs.forEach((function(B){return d[B.id]=!0})),E=!0,p[W.id]=!0;break}if(E)break}}var N={};N[h.id]=!0;var F={};for(m=u.length-1;m>=0;m--)for(w=(W=u[m]).inputs,A=0;A<W.outputs.length;A++)if(N[W.outputs[A].id]){for(var b in w)N[w[b].id]=!0,F[W.id]=!0;break}var D=[];for(m=0;m<u.length;m++){var W;if(p[(W=u[m]).id]&&F[W.id]){var k={};for(var b in W.inputs){var C=W.inputs[b];d[C.id]&&(k[b]=C)}var L=Object.assign({},W);L.inputs=k,L.outputs=W.outputs,D.push(L)}}return D})(this.state.activeTape,t,s);if(!i&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var u,l,h={};h[s.id]=r??(u=s.shape,l=u3(Dt(u),"float32"),Te.makeTensor(l,u,"float32")),(function(p,m,w){for(var b=function(E){var A=m[E],N=[];if(A.outputs.forEach((function(k){var C=p[k.id];C!=null?N.push(C):N.push(null)})),A.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+A.kernelName+".");var F=A.gradient(N),D=function(k){if(!(k in F))throw new Error("Cannot backprop through input "+k+". Available gradients found: "+Object.keys(F)+".");var C=w((function(){return F[k]()}));if(C.dtype!=="float32")throw new Error("Error in gradient for op "+A.kernelName+". The gradient of input "+k+" must have 'float32' dtype, but has '"+C.dtype+"'");var L=A.inputs[k];if(!qi(C.shape,L.shape))throw new Error("Error in gradient for op "+A.kernelName+". The gradient of input '"+k+"' has shape '"+C.shape+"', which does not match the shape of the input '"+L.shape+"'");if(p[L.id]==null)p[L.id]=C;else{var B=p[L.id];p[L.id]=B.add(C),B.dispose()}};for(var W in A.inputs)D(W)},x=m.length-1;x>=0;x--)b(x)})(h,a,(function(p){return o.tidy(p)}));var d=t.map((function(p){return h[p.id]}));return o.state.gradientDepth===0&&(o.state.activeTape.forEach((function(p){for(var m=0,w=p.saved;m<w.length;m++)w[m].dispose()})),o.state.activeTape=null),{value:s,grads:d}}))},n.prototype.customGrad=function(e){var t=this;return pe(S2(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var r,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];pe(i.every((function(a){return a instanceof Tr})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var s={};return i.forEach((function(a,u){s[u]=a})),t.runKernelFunc((function(a,u){return pe((r=e.apply(void 0,i.concat([u]))).value instanceof Tr,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),pe(S2(r.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),r.value}),s,(function(a,u){var l=r.gradFunc(a,u),h=Array.isArray(l)?l:[l];pe(h.length===i.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),pe(h.every((function(p){return p instanceof Tr})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var d={};return h.forEach((function(p,m){d[m]=function(){return p}})),d}))}},n.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},n.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},n.prototype.time=function(e){return kt(this,void 0,void 0,(function(){var t,r;return Nt(this,(function(i){switch(i.label){case 0:return t=Gu(),[4,this.backend.time(e)];case 1:return(r=i.sent()).wallMs=Gu()-t,[2,r]}}))}))},n.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(n.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),n.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new TE,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},n.nextTensorId=0,n.nextVariableId=0,n})(),Te=(function(){var n=(function(){if(fy==null){var t=void 0;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else{if(typeof self>"u")throw new Error("Could not find a global object");t=self}fy=t}return fy})();if(n._tfengine==null){var e=new cM(n);n._tfengine=new NM(e)}return(function(t){t3=t})(n._tfengine.ENV),$u=function(){return n._tfengine},n._tfengine})();function d3(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Vl=Ye();Vl.registerFlag("DEBUG",(function(){return!1}),(function(n){n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Vl.registerFlag("IS_BROWSER",(function(){return d3()})),Vl.registerFlag("IS_NODE",(function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0})),Vl.registerFlag("IS_CHROME",(function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Vl.registerFlag("PROD",(function(){return!1})),Vl.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Vl.getBool("DEBUG")})),Vl.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Vl.registerFlag("IS_TEST",(function(){return!1}));var dm,Ys,Xs,Zh={},dy={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function PM(n,e){Zh[n]=e}function hl(n){n in Zh||(Zh[n]=(function(t){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=(function(i){if(typeof OffscreenCanvas<"u"&&i===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")})(t);return r.addEventListener("webglcontextlost",(function(i){i.preventDefault(),delete Zh[t]}),!1),t===1?r.getContext("webgl",dy)||r.getContext("experimental-webgl",dy):r.getContext("webgl2",dy)})(n));var e=Zh[n];return e.isContextLost()?(delete Zh[n],hl(n)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Zh[n])}function S0(n,e){return[e,n]}function Yp(n){var e=Dt(n);return E2(Math.ceil(e/4))}function Lm(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function hb(n,e){var t,r,i,o,s,a,u,l,h,d=n;return Ye().getNumber("WEBGL_VERSION")===2?(t=d.R32F,r=d.R16F,i=d.RGBA16F,o=d.RGBA32F,s=d.RED,a=4,u=1,l=d.HALF_FLOAT,h=d.FLOAT):(t=n.RGBA,r=n.RGBA,i=n.RGBA,o=d.RGBA,s=n.RGBA,a=4,u=4,l=e!=null?e.HALF_FLOAT_OES:null,h=n.FLOAT),{internalFormatFloat:t,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:n.RGBA,downloadUnpackNumChannels:a,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:h}}function Ft(n,e,t){var r=t();return e&&(function(i){var o=i.getError();if(o!==i.NO_ERROR)throw new Error("WebGL Error: "+MM(i,o))})(n),r}(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(dm||(dm={})),(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(Ys||(Ys={})),(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Xs||(Xs={}));var RM=596e-10,DM=65504;function LM(n){return!!(Ye().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||RM<Math.abs(n)&&Math.abs(n)<DM)}function MM(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function Bg(n,e,t){return Jl(n,e,(function(){return n.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function FM(n,e,t){var r=Jl(n,e,(function(){return n.createShader(n.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Ft(n,e,(function(){return n.shaderSource(r,t)})),Ft(n,e,(function(){return n.compileShader(r)})),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function OM(n,e,t){var r=Jl(n,e,(function(){return n.createShader(n.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Ft(n,e,(function(){return n.shaderSource(r,t)})),Ft(n,e,(function(){return n.compileShader(r)})),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw(function(i,o){var s=BM.exec(o);if(s==null)return console.log("Couldn't parse line number in error: "+o),void console.log(i);for(var a=+s[1],u=i.split(`
`),l=u.length.toString().length+2,h=u.map((function(x,E){return xd((E+1).toString(),l)+x})),d=0,p=0;p<h.length;p++)d=Math.max(h[p].length,d);var m=h.slice(0,a-1),w=h.slice(a-1,a),b=h.slice(a);console.log(m.join(`
`)),console.log(o.split(`
`)[0]),console.log("%c "+xd(w[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(b.join(`
`))})(t,n.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var py,my,BM=/ERROR: [0-9]+:([0-9]+):/g;function VM(n,e){return Jl(n,e,(function(){return n.createProgram()}),"Unable to create WebGLProgram.")}function jM(n,e,t){if(Ft(n,e,(function(){return n.linkProgram(t)})),n.getProgramParameter(t,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function gy(n,e,t){if(Ft(n,e,(function(){return n.validateProgram(t)})),n.getProgramParameter(t,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function UM(n,e,t){var r=Jl(n,e,(function(){return n.createBuffer()}),"Unable to create WebGLBuffer");return Ft(n,e,(function(){return n.bindBuffer(n.ARRAY_BUFFER,r)})),Ft(n,e,(function(){return n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)})),r}function zM(n,e,t){var r=Jl(n,e,(function(){return n.createBuffer()}),"Unable to create WebGLBuffer");return Ft(n,e,(function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r)})),Ft(n,e,(function(){return n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)})),r}function WM(n,e){return Jl(n,e,(function(){return n.createTexture()}),"Unable to create WebGLTexture.")}function qM(n,e){var t=Ye().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){var r="["+n+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t)throw r="["+n+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+t+"x"+t+"]")+".")}function HM(n,e){return Jl(n,e,(function(){return n.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function kE(n,e,t,r,i,o,s,a){var u=n.getAttribLocation(t,r);return u!==-1&&(Ft(n,e,(function(){return n.bindBuffer(n.ARRAY_BUFFER,i)})),Ft(n,e,(function(){return n.vertexAttribPointer(u,o,n.FLOAT,!1,s,a)})),Ft(n,e,(function(){return n.enableVertexAttribArray(u)})),!0)}function GM(n,e,t,r){JM(n,r),Ft(n,e,(function(){return n.activeTexture(n.TEXTURE0+r)})),Ft(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,t)}))}function $M(n,e,t,r){return Jl(n,e,(function(){return n.getUniformLocation(t,r)}),'uniform "'+r+'" not present in program.')}function KM(n,e,t){return n.getUniformLocation(e,t)}function XM(n,e,t,r,i,o){Ft(n,e,(function(){return GM(n,e,r,o)})),Ft(n,e,(function(){return n.uniform1i(i,o)}))}function vy(n,e,t,r){Ft(n,e,(function(){return n.bindFramebuffer(n.FRAMEBUFFER,r)})),Ft(n,e,(function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0)}))}function NE(n,e,t){Ft(n,e,(function(){return n.bindFramebuffer(n.FRAMEBUFFER,t)})),Ft(n,e,(function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0)}))}function Vg(n){var e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+YM(n,e))}function YM(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function Jl(n,e,t,r){var i=Ft(n,e,(function(){return t()}));if(i==null)throw new Error(r);return i}function JM(n,e){var t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+t+"]")+".")}function Fv(n,e){return e===void 0&&(e=2),Dt(n.slice(0,n.length-e))}function Ov(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function yy(n){var e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Fv(n)].concat(Ov(n))),e}function QM(n,e){var t;e===void 0&&(e=!1);var r=Ye().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,(n=n.map((function(l,h){return h>=n.length-2?o3(n[h]):n[h]}))).length===1&&(n=[2,n[0]])),n.length!==2){var i=rf(n);n=i.newShape}var o=Dt(n);if(n.length<=1&&o<=r)return[1,o];if(n.length===2&&n[0]<=r&&n[1]<=r)return n;if(n.length===3&&n[0]*n[1]<=r&&n[2]<=r)return[n[0]*n[1],n[2]];if(n.length===3&&n[0]<=r&&n[1]*n[2]<=r)return[n[0],n[1]*n[2]];if(n.length===4&&n[0]*n[1]*n[2]<=r&&n[3]<=r)return[n[0]*n[1]*n[2],n[3]];if(n.length===4&&n[0]<=r&&n[1]*n[2]*n[3]<=r)return[n[0],n[1]*n[2]*n[3]];if(e){var s=Fv(n),a=2,u=2;return n.length&&(a=(t=Ov(n))[0],u=t[1]),E2(o=s*(a/2)*(u/2)).map((function(l){return 2*l}))}return E2(o)}function jg(n){return n%2==0}function Ug(n,e){if(qi(n=n.slice(-2),e=e.slice(-2))||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){var t=n.slice(-1)[0],r=e.slice(-1)[0];if(t===r||jg(t)&&jg(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&jg(n[0])&&jg(e[0])}function ZM(n){if(py==null){var e=hl(n);py=e.getParameter(e.MAX_TEXTURE_SIZE)}return py}function eF(n){if(my==null){var e=hl(n);my=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,my)}function tF(n){if(n===0)return 0;var e=hl(n);return Ra(e,"EXT_disjoint_timer_query_webgl2")&&n===2?2:Ra(e,"EXT_disjoint_timer_query")?1:0}function Ra(n,e){return n.getExtension(e)!=null}function PE(n){try{if(hl(n)!=null)return!0}catch{return!1}return!1}function nF(n){if(n===0)return!1;var e=hl(n);if(n===1){if(!Ra(e,"OES_texture_float"))return!1}else if(!Ra(e,"EXT_color_buffer_float"))return!1;return N2(e)}function rF(n){if(n===0)return!1;var e=hl(n);if(n!==1){if(Ra(e,"EXT_color_buffer_float"))return N2(e);if(Ra(e,"EXT_color_buffer_half_float")){var t=e.getExtension("EXT_color_buffer_half_float");return(function(r,i){var o=hb(r,i),s=r.createTexture();r.bindTexture(r.TEXTURE_2D,s),r.texImage2D(r.TEXTURE_2D,0,o.internalFormatHalfFloat,1,1,0,o.textureFormatFloat,o.textureTypeHalfFloat,null);var a=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,a),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,s,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(s),r.deleteFramebuffer(a),u})(e,t)}return!1}return!!Ra(e,"OES_texture_float")&&!!Ra(e,"WEBGL_color_buffer_float")&&N2(e)}function N2(n){var e=hb(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);var i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(r),i}function iF(n){return n===2&&hl(n).fenceSync!=null}var rn=Ye();function p3(n){Ye().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function At(n,e){return Te.tidy(n,e)}function Cs(n){f3(n).forEach((function(e){return e.dispose()}))}function oF(n){return Te.keep(n)}function Bv(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];Ye().getBool("IS_TEST")||console.warn.apply(console,n)}function Ch(n,e){var t=n;if(tl(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];for(var r=[];Array.isArray(t)||tl(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&Ye().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&(function i(o,s,a){if(a=a||[],!Array.isArray(o)&&!tl(o))return void pe(s.length===0,(function(){return"Element arr["+a.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"}));pe(s.length>0,(function(){return"Element arr["+a.join("][")+"] should be a primitive, but is an array of "+o.length+" elements"})),pe(o.length===s[0],(function(){return"Element arr["+a.join("][")+"] should have "+s[0]+" elements, but has "+o.length+" elements"}));for(var u=s.slice(1),l=0;l<o.length;++l)i(o[l],u,a.concat(l))})(n,r,[]),r}function RE(n,e,t,r){if(n!=null&&(n!=="numeric"&&n!==e||n==="numeric"&&e==="string"))throw new Error("Argument '"+t+"' passed to '"+r+"' must be "+n+" tensor, but got "+e+" tensor")}function oe(n,e,t,r){if(r===void 0&&(r="numeric"),n instanceof Tr)return RE(r,n.dtype,e,t),n;var i=Rm(n);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),RE(r,i,e,t),n==null||!tl(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){var o=n==null?"null":n.constructor.name;throw new Error("Argument '"+e+"' passed to '"+t+"' must be a Tensor or TensorLike, but got '"+o+"'")}var s=Ch(n,i);tl(n)||Array.isArray(n)||(n=[n]);var a=i!=="string"?a3(n,i,Ye().getBool("DEBUG")):Wd(n,[],!0);return Te.makeTensor(a,s,i)}function Vv(n,e,t,r){if(r===void 0&&(r="numeric"),!Array.isArray(n))throw new Error("Argument "+e+" passed to "+t+" must be a `Tensor[]` or `TensorLike[]`");return n.map((function(i,o){return oe(i,e+"["+o+"]",t)}),r)}function m3(n,e){for(var t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function sF(n,e,t){for(var r=n.length+e.length,i=[],o=0,s=0,a=0;a<r;a++)t.indexOf(a)===-1?i.push(n[o++]):i.push(e[s++]);return i}function Ro(n,e){for(var t=[],r=n.length,i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);return[t,e.map((function(o){return n[o]}))]}function Is(n,e){return sF(n,e.map((function(t){return 1})),e)}function Ks(n,e,t){pe(m3(e,t),(function(){return n+" supports only inner-most axes for now. Got axes "+e+" and rank-"+t+" input."}))}function fl(n,e){if(m3(n,e))return null;for(var t=[],r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach((function(i){return t.push(i)})),t}function fb(n){return n.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function dl(n,e){for(var t=[],r=e-n;r<e;++r)t.push(r);return t}function aF(n,e){var t=n[0].length;n.forEach((function(i,o){pe(i.length===t,(function(){return"Error in concat"+t+"D: rank of tensors["+o+"] must be the same as the rank of the rest ("+t+")"}))})),pe(e>=0&&e<t,(function(){return"Error in concat"+t+"D: axis must be between 0 and "+(t-1)+"."}));var r=n[0];n.forEach((function(i,o){for(var s=0;s<t;s++)pe(s===e||i[s]===r[s],(function(){return"Error in concat"+t+"D: Shape of tensors["+o+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."}))}))}function Hd(n,e){for(var t=n[0].slice(),r=1;r<n.length;r++)t[e]+=n[r][e];return t}function xe(n){var e=Object.keys(n);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var t=e[0],r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1));var i=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];Te.startScope(t);try{var a=r.apply(void 0,o);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Te.endScope(a),a}catch(u){throw Te.endScope(null),u}};return Object.defineProperty(i,"name",{value:t,configurable:!0}),i}rn.registerFlag("HAS_WEBGL",(function(){return rn.getNumber("WEBGL_VERSION")>0})),rn.registerFlag("WEBGL_VERSION",(function(){return PE(2)?2:PE(1)?1:0})),rn.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return rn.get("WEBGL_VERSION")===2})),rn.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),rn.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),rn.registerFlag("WEBGL_PACK",(function(){return rn.getBool("HAS_WEBGL")})),rn.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return rn.getBool("WEBGL_PACK")})),rn.registerFlag("WEBGL_PACK_CLIP",(function(){return rn.getBool("WEBGL_PACK")})),rn.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),rn.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return rn.getBool("WEBGL_PACK")})),rn.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return rn.getBool("WEBGL_PACK")})),rn.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return rn.getBool("WEBGL_PACK")})),rn.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return rn.getBool("WEBGL_PACK")})),rn.registerFlag("WEBGL_PACK_REDUCE",(function(){return rn.getBool("WEBGL_PACK")})),rn.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return rn.getBool("WEBGL_PACK")})),rn.registerFlag("WEBGL_CONV_IM2COL",(function(){return rn.getBool("WEBGL_PACK")})),rn.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return ZM(rn.getNumber("WEBGL_VERSION"))})),rn.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return eF(rn.getNumber("WEBGL_VERSION"))})),rn.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var n=rn.getNumber("WEBGL_VERSION");return n===0?0:tF(n)})),rn.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return rn.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(n=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))));var n})),rn.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return nF(rn.getNumber("WEBGL_VERSION"))})),rn.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!rn.getBool("WEBGL_FORCE_F16_TEXTURES")&&rn.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),rn.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return rF(rn.getNumber("WEBGL_VERSION"))})),rn.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return iF(rn.getNumber("WEBGL_VERSION"))})),rn.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return rn.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),h3=p3;var oo=xe({complex_:function(n,e){var t=oe(n,"real","complex"),r=oe(e,"imag","complex");return Yn(t.shape,r.shape,"real and imag shapes, "+t.shape+" and "+r.shape+", must match in call to tf.complex()."),Te.runKernelFunc((function(i){return i.complex(t,r)}),{$real:t,$imag:r})}}),Pa=xe({real_:function(n){var e=oe(n,"input","real");return Te.runKernelFunc((function(t){return t.real(e)}),{$input:e})}}),Ku=xe({imag_:function(n){var e=oe(n,"input","imag");return Te.runKernelFunc((function(t){return t.imag(e)}),{$input:e})}});function uo(n,e,t){return Ih(n,e,Ch(n,t),t)}function Ih(n,e,t,r){if(r==null&&(r=Rm(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!tl(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){l3(e);var i=Dt(e),o=Dt(t);pe(i===o,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o}));for(var s=0;s<t.length;++s){var a=t[s],u=s!==t.length-1||a!==Dt(e.slice(s));pe(t[s]===e[s]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+t+") does not match the provided shape ("+e+"). "}))}}return tl(n)||Array.isArray(n)||(n=[n]),e=e||t,n=r!=="string"?a3(n,r,Ye().getBool("DEBUG")):Wd(n,[],!0),Te.makeTensor(n,e,r)}function wt(n,e){if((tl(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&tl(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ih(n,[],[],e)}function ai(n,e){rp(n);var t=Ch(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ih(n,null,t,e)}function th(n,e,t){if(rp(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Ch(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ih(n,e,r,t)}function db(n,e,t){if(rp(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Ch(n,t);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ih(n,e,r,t)}function Ss(n,e,t){if(rp(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Ch(n,t);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ih(n,e,r,t)}function uF(n,e,t){if(rp(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Ch(n,t);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ih(n,e,r,t)}function lF(n,e,t){if(rp(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Ch(n,t);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Ih(n,e=e||r,r,t)}function cF(n,e,t,r){return e===void 0&&(e=!0),Te.makeVariable(n,e,t,r)}function ip(n,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=ip(n,"float32"),r=mr(n,"float32");return oo(t,r)}var i=u3(Dt(n),e);return Te.makeTensor(i,n,e)}function mr(n,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=mr(n,"float32"),r=mr(n,"float32");return oo(t,r)}var i=Dm(Dt(n),e);return Te.makeTensor(i,n,e)}function rl(n,e,t){return Te.runKernelFunc((function(r){return r.fill(n,e,t)}),{})}function hF(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");return Te.runKernelFunc((function(r){return r.linspace(n,e,t)}),{})}function jv(n,e,t,r){if(t===void 0&&(t=1),r===void 0&&(r="float32"),t===0)throw new Error("Cannot have a step of zero");if(n===e||n<e&&t<0||e<n&&t>1)return mr([0],r);var i=Dm(Math.abs(Math.ceil((e-n)/t)),r);e<n&&t===1&&(t=-1),i[0]=n;for(var o=1;o<i.length;o++)i[o]=i[o-1]+t;return ai(i,r)}var g3=xe({onesLike_:function(n){var e=oe(n,"x","onesLike");if(e.dtype==="complex64"){var t=g3(Pa(e)),r=Nn(Ku(e));return oo(t,r)}return Te.runKernelFunc((function(i){return i.onesLike(e)}),{$x:e},(function(i,o){return{$x:function(){return Nn(i)}}}))}}),Nn=xe({zerosLike_:function(n){var e=oe(n,"x","zerosLike");return Te.runKernelFunc((function(t){return t.zerosLike(e)}),{$x:e},(function(t,r){return{$x:function(){return Nn(t)}}}))}}),_i=xe({concat_:function(n,e){e===void 0&&(e=0),pe(n.length>=1,(function(){return"Pass at least one tensor to concat"}));var t=Vv(n,"tensors","concat");t[0].dtype==="complex64"&&t.forEach((function(a){if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+a.dtype+". ")})),e=Ii(e,t[0].shape)[0];var r=Hd(t.map((function(a){return a.shape})),e);if(Dt(r)===0)return uo([],r);if((t=t.filter((function(a){return a.size>0}))).length===1)return t[0];var i=t.map((function(a){return a.shape}));aF(i,e);var o=t,s={axis:e};return Te.runKernelFunc((function(a){return a.concat(t,e)}),o,(function(a){var u=i.map((function(l){return l[e]}));return pb(a,u,e).map((function(l){return function(){return l}}))}),"Concat",s)}}),fF=xe({concat1d_:function(n){return _i(n,0)}}),dF=xe({concat2d_:function(n,e){return _i(n,e)}}),pF=xe({concat3d_:function(n,e){return _i(n,e)}}),mF=xe({concat4d_:function(n,e){return _i(n,e)}}),pb=xe({split_:function(n,e,t){t===void 0&&(t=0);var r,i=oe(n,"x","split");return t=Ii(t,i.shape)[0],typeof e=="number"?(pe(i.shape[t]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[t]/e)):(pe(i.shape[t]===e.reduce((function(o,s){return o+s})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),Te.runKernelFunc((function(o){return o.split(i,r,t)}),{$x:i},(function(o){return{$x:function(){return _i(o,t)}}}))}});function Ef(n,e){return n(e={exports:{}},e.exports),e.exports}var gF=Ef((function(n){(function(e,t,r){function i(a){var u,l=this,h=(u=4022871197,function(d){d=d.toString();for(var p=0;p<d.length;p++){var m=.02519603282416938*(u+=d.charCodeAt(p));m-=u=m>>>0,u=(m*=u)>>>0,u+=4294967296*(m-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var d=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=h(" "),l.s1=h(" "),l.s2=h(" "),l.s0-=h(a),l.s0<0&&(l.s0+=1),l.s1-=h(a),l.s1<0&&(l.s1+=1),l.s2-=h(a),l.s2<0&&(l.s2+=1),h=null}function o(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function s(a,u){var l=new i(a),h=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.alea=s})(0,n)})),vF=Ef((function(n){(function(e,t,r){function i(a){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},a===(0|a)?u.x=a:l+=a;for(var h=0;h<l.length+64;h++)u.x^=0|l.charCodeAt(h),u.next()}function o(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u}function s(a,u){var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var p=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=l.next,d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xor128=s})(0,n)})),yF=Ef((function(n){(function(e,t,r){function i(a){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,a===(0|a)?u.x=a:l+=a;for(var h=0;h<l.length+64;h++)u.x^=0|l.charCodeAt(h),h==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u.v=a.v,u.d=a.d,u}function s(a,u){var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var p=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=l.next,d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xorwow=s})(0,n)})),wF=Ef((function(n){(function(e,t,r){function i(a){var u=this;u.next=function(){var l,h,d=u.x,p=u.i;return l=d[p],h=(l^=l>>>7)^l<<24,h^=(l=d[p+1&7])^l>>>10,h^=(l=d[p+3&7])^l>>>3,h^=(l=d[p+4&7])^l<<7,l=d[p+7&7],h^=(l^=l<<13)^l<<9,d[p]=h,u.i=p+1&7,h},(function(l,h){var d,p=[];if(h===(0|h))p[0]=h;else for(h=""+h,d=0;d<h.length;++d)p[7&d]=p[7&d]<<15^h.charCodeAt(d)+p[d+1&7]<<13;for(;p.length<8;)p.push(0);for(d=0;d<8&&p[d]===0;++d);for(d==8?p[7]=-1:p[d],l.x=p,l.i=0,d=256;d>0;--d)l.next()})(u,a)}function o(a,u){return u.x=a.x.slice(),u.i=a.i,u}function s(a,u){a==null&&(a=+new Date);var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var p=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=l.next,d.quick=d,h&&(h.x&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xorshift7=s})(0,n)})),bF=Ef((function(n){(function(e,t,r){function i(a){var u=this;u.next=function(){var l,h,d=u.w,p=u.X,m=u.i;return u.w=d=d+1640531527|0,h=p[m+34&127],l=p[m=m+1&127],h^=h<<13,l^=l<<17,h^=h>>>15,l^=l>>>12,h=p[m]=h^l,u.i=m,h+(d^d>>>16)|0},(function(l,h){var d,p,m,w,b,x=[],E=128;for(h===(0|h)?(p=h,h=null):(h+="\0",p=0,E=Math.max(E,h.length)),m=0,w=-32;w<E;++w)h&&(p^=h.charCodeAt((w+32)%h.length)),w===0&&(b=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,w>=0&&(b=b+1640531527|0,m=(d=x[127&w]^=p+b)==0?m+1:0);for(m>=128&&(x[127&(h&&h.length||0)]=-1),m=127,w=512;w>0;--w)p=x[m+34&127],d=x[m=m+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,x[m]=p^d;l.w=b,l.X=x,l.i=m})(u,a)}function o(a,u){return u.i=a.i,u.w=a.w,u.X=a.X.slice(),u}function s(a,u){a==null&&(a=+new Date);var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var p=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=l.next,d.quick=d,h&&(h.X&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xor4096=s})(0,n)})),xF=Ef((function(n){(function(e,t,r){function i(a){var u=this,l="";u.next=function(){var d=u.b,p=u.c,m=u.d,w=u.a;return d=d<<25^d>>>7^p,p=p-m|0,m=m<<24^m>>>8^w,w=w-d|0,u.b=d=d<<20^d>>>12^p,u.c=p=p-m|0,u.d=m<<16^p>>>16^w,u.a=w-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,a===Math.floor(a)?(u.a=a/4294967296|0,u.b=0|a):l+=a;for(var h=0;h<l.length+20;h++)u.b^=0|l.charCodeAt(h),u.next()}function o(a,u){return u.a=a.a,u.b=a.b,u.c=a.c,u.d=a.d,u}function s(a,u){var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var p=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=l.next,d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.tychei=s})(0,n)})),ef=Ef((function(n){(function(e,t){var r,i=this,o=256,s=6,a="random",u=t.pow(o,s),l=t.pow(2,52),h=2*l,d=o-1;function p(E,A,N){var F=[],D=b((function C(L,B){var R,M=[],U=typeof L;if(B&&U=="object")for(R in L)try{M.push(C(L[R],B-1))}catch{}return M.length?M:U=="string"?L:L+"\0"})((A=A==1?{entropy:!0}:A||{}).entropy?[E,x(e)]:E??(function(){try{var C;return r&&(C=r.randomBytes)?C=C(o):(C=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(C)),x(C)}catch{var L=i.navigator,B=L&&L.plugins;return[+new Date,i,B,i.screen,x(e)]}})(),3),F),W=new m(F),k=function(){for(var C=W.g(s),L=u,B=0;C<l;)C=(C+B)*o,L*=o,B=W.g(1);for(;C>=h;)C/=2,L/=2,B>>>=1;return(C+B)/L};return k.int32=function(){return 0|W.g(4)},k.quick=function(){return W.g(4)/4294967296},k.double=k,b(x(W.S),e),(A.pass||N||function(C,L,B,R){return R&&(R.S&&w(R,W),C.state=function(){return w(W,{})}),B?(t[a]=C,L):C})(k,D,"global"in A?A.global:this==t,A.state)}function m(E){var A,N=E.length,F=this,D=0,W=F.i=F.j=0,k=F.S=[];for(N||(E=[N++]);D<o;)k[D]=D++;for(D=0;D<o;D++)k[D]=k[W=d&W+E[D%N]+(A=k[D])],k[W]=A;(F.g=function(C){for(var L,B=0,R=F.i,M=F.j,U=F.S;C--;)L=U[R=d&R+1],B=B*o+U[d&(U[R]=U[M=d&M+L])+(U[M]=L)];return F.i=R,F.j=M,B})(o)}function w(E,A){return A.i=E.i,A.j=E.j,A.S=E.S.slice(),A}function b(E,A){for(var N,F=E+"",D=0;D<F.length;)A[d&D]=d&(N^=19*A[d&D])+F.charCodeAt(D++);return x(A)}function x(E){return String.fromCharCode.apply(0,E)}if(t["seed"+a]=p,b(t.random(),e),n.exports){n.exports=p;try{r=require("crypto")}catch{}}})([],Math)}));ef.alea=gF,ef.xor128=vF,ef.xorwow=yF,ef.xorshift7=wF,ef.xor4096=bF,ef.tychei=xF;var A0=ef.alea,mb=(function(){function n(e,t,r,i,o){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=o||Math.random();this.random=A0(s.toString())}return n.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,r,i=!1;!i;){var o=void 0,s=void 0,a=void 0;do a=(o=2*this.random()-1)*o+(s=2*this.random()-1)*s;while(a>=1||a===0);var u=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*o*u,r=this.mean+this.stdDev*s*u,this.truncated&&!this.isValidTruncated(t)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(t)},n.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},n.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},n})(),_F=(function(){function n(e,t,r,i){this.alpha=e,this.beta=1/t,this.dtype=r;var o=i||Math.random();this.randu=A0(o.toString()),this.randn=new mb(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return n.prototype.nextValue=function(){for(var e,t,r,i,o,s;;){do i=this.randn.nextValue(),s=1+this.c*i;while(s<=0);if(s*=s*s,t=1-.331*(e=i*i)*e,r=.5*e+this.d*(1-s+Math.log(s)),(o=this.randu())<t||Math.log(o)<r)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},n.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},n})(),EF=(function(){function n(e,t,r,i){var o=this;if(e===void 0&&(e=0),t===void 0&&(t=1),this.canReturnFloat=function(){return o.dtype==null||o.dtype==="float32"},this.min=e,this.range=t-e,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=A0(i)}return n.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},n.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},n})();function un(n,e,t){return e===void 0&&(e="float32"),e=e||"float32",l3(n),new fm(n,e,t)}function SF(n,e){e===void 0&&(e=!1),console.log(n.toString(e))}var v3=xe({batchToSpaceND_:function(n,e,t){var r=oe(n,"x","batchToSpaceND"),i=e.reduce((function(o,s){return o*s}));return pe(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),pe(t.length===e.length,(function(){return"crops.length is "+t.length+" but should be equal to blockShape.length  "+e.length})),pe(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),Te.runKernelFunc((function(o){return o.batchToSpaceND(r,e,t)}),{$x:r},(function(o){return{$x:function(){return o.spaceToBatchND(e,t)}}}))}}),AF=xe({broadcastTo_:function(n,e){var t=oe(n,"broadcastTo","x"),r=t.shape;if(e.some((function(u){return!(u>0)||u%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<t.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+t.rank+".");if(e.length>t.rank){for(var i=t.shape.slice();i.length<e.length;)i.unshift(1);t=t.reshape(i)}for(var o=Array.from(e),s=e.length-1;s>=0;s--)if(t.shape[s]===e[s])o[s]=1;else if(t.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var a=o.map((function(u,l){return u>1?l:-1})).filter((function(u){return u>=0}));return a.length===0?t.clone():Te.runKernelFunc((function(u){return u.tile(t,o)}),{input:t},(function(u){return{input:function(){return u.sum(a,!0)}}}))}}),CF=xe({cast_:function(n,e){var t=oe(n,"x","cast");if(!yM(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:e};return Te.runKernelFunc((function(i){return i.cast(t,e)}),{x:t},(function(i){return{x:function(){return i.clone()}}}),"Cast",r)}}),IF=xe({clone_:function(n){var e=oe(n,"x","clone",null);return Te.runKernelFunc((function(){return Te.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),TF=xe({cumsum_:function(n,e,t,r){e===void 0&&(e=0),t===void 0&&(t=!1),r===void 0&&(r=!1);var i=oe(n,"x","cumsum"),o=fl([e|=0],i.rank),s=i;o!=null&&(s=i.transpose(o));var a=dl(1,i.rank)[0],u=Te.runKernelFunc((function(l){return l.cumsum(s,a,t,r)}),{permutedX:s},(function(l){return{permutedX:function(){return l.cumsum(e,t,!r)}}}));return o!=null&&(u=u.transpose(o)),u}}),kF=xe({depthToSpace_:function(n,e,t){t===void 0&&(t="NHWC");var r=oe(n,"x","depthToSpace"),i=t==="NHWC"?r.shape[1]:r.shape[2],o=t==="NHWC"?r.shape[2]:r.shape[3],s=t==="NHWC"?r.shape[3]:r.shape[1];return pe(i*e>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+`  for depthToSpace with input shape
      `+r.shape})),pe(o*e>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+e+` for depthToSpace with input shape
          `+r.shape})),pe(s%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+s+" for depthToSpace with input shape "+r.shape})),Te.runKernelFunc((function(a){return a.depthToSpace(r,e,t)}),{$x:r})}}),Na=xe({expandDims_:function(n,e){e===void 0&&(e=0);var t=oe(n,"x","expandDims",null);pe(e<=t.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=t.shape.slice();return e<0&&(pe(-(t.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(t.rank+1)+", "+t.rank+"]"})),e=t.rank+e+1),r.splice(e,0,1),du(t,r)}}),y3=xe({eye_:function(n,e,t,r){r===void 0&&(r="float32"),e==null&&(e=n);for(var i=un([n,e],r),o=n<=e?n:e,s=0;s<o;++s)i.set(1,s,s);var a=i.toTensor().as2D(n,e);if(t==null)return a;if(t.length===1)return _d(Na(a,0),[t[0],1,1]);if(t.length===2)return _d(Na(Na(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return _d(Na(Na(Na(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+t.length+"D.")}}),NF=xe({multinomial_:function(n,e,t,r){r===void 0&&(r=!1);var i=oe(n,"logits","multinomial"),o=i.size,s=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);t=t||Math.random();var a=s===1?i.as2D(1,-1):i,u=Te.runKernelFunc((function(l){return l.multinomial(a,r,e,t)}),{logits2D:a});return s===1?u.as1D():u}}),P2=xe({oneHot_:function(n,e,t,r){if(t===void 0&&(t=1),r===void 0&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=oe(n,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),Te.runKernelFunc((function(s){return s.oneHot(i,e,t,r)}),{$indices:i},(function(s){return{$indices:function(){return mr(i.shape,"float32")}}})).reshape(o)}}),Sf=xe({pad_:function(n,e,t){t===void 0&&(t=0);var r=oe(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:e,constantValue:t};return Te.runKernelFunc((function(o){return o.pad(r,e,t)}),{x:r},(function(o){var s=e.map((function(a){return a[0]}));return{x:function(){return o.slice(s,r.shape)}}}),"PadV2",i)}}),PF=xe({pad1d_:function(n,e,t){return t===void 0&&(t=0),pe(e.length===2,(function(){return"Invalid number of paddings. Must be length of 2."})),Sf(n,[e],t)}}),RF=xe({pad2d_:function(n,e,t){return t===void 0&&(t=0),pe(e.length===2&&e[0].length===2&&e[1].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Sf(n,e,t)}}),DF=xe({pad3d_:function(n,e,t){return t===void 0&&(t=0),pe(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Sf(n,e,t)}}),LF=xe({pad4d_:function(n,e,t){return t===void 0&&(t=0),pe(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Sf(n,e,t)}}),MF=xe({rand_:function(n,e,t){var r=Dt(n),i=null;if(t==null||t==="float32")i=new Float32Array(r);else if(t==="int32")i=new Int32Array(r);else{if(t!=="bool")throw new Error("Unknown data type "+t);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return Te.makeTensor(i,n,t)}}),FF=xe({randomNormal_:function(n,e,t,r,i){if(e===void 0&&(e=0),t===void 0&&(t=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new mb(e,t,r,!1,i),s=un(n,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),OF=xe({randomGamma_:function(n,e,t,r,i){if(t===void 0&&(t=1),r===void 0&&(r="float32"),t==null&&(t=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var o=new _F(e,t,r,i),s=un(n,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),w3=xe({randomUniform_:function(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=1),r===void 0&&(r="float32");for(var o=un(n,r),s=new EF(e,t,null,i),a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),du=xe({reshape_:function(n,e){var t=oe(n,"x","reshape",null);e=gM(e,t.size),pe(t.size===Dt(e),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:e};return Te.runKernelFunc((function(i){return i.reshape(t,e)}),{x:t},(function(i){return{x:function(){return i.reshape(t.shape)}}}),"Reshape",r)}}),b3=xe({spaceToBatchND_:function(n,e,t){var r=oe(n,"x","spaceToBatchND");return pe(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),pe(t.length===e.length,(function(){return"paddings.shape[0] "+t.length+" must be equal to [blockShape] "+e.length})),pe(r.shape.reduce((function(i,o,s){return s>0&&s<=e.length?i&&(o+t[s-1][0]+t[s-1][1])%e[s-1]==0:i}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+t.toString()+" must be divisible by blockShapes "+e.toString()})),Te.runKernelFunc((function(i){return i.spaceToBatchND(r,e,t)}),{$x:r},(function(i){return{$x:function(){return i.batchToSpaceND(e,t)}}}))}}),x3=xe({squeeze_:function(n,e){var t=oe(n,"x","squeeze");return du(t,rf(t.shape,e).newShape)}}),na=xe({stack_:function(n,e){e===void 0&&(e=0);var t=Vv(n,"tensors","stack");if(pe(t.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),t.length===1)return t[0].expandDims(e);var r=t[0].rank,i=t[0].shape,o=t[0].dtype;pe(e<=r,(function(){return"Axis must be <= rank of the tensor"})),t.forEach((function(a){Yn(i,a.shape,"All tensors passed to stack must have matching shapes")})),t.forEach((function(a){pe(o===a.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var s=t.map((function(a){return a.expandDims(e)}));return _i(s,e)}}),_d=xe({tile_:function(n,e){var t=oe(n,"x","tile",null);pe(t.rank===e.length,(function(){return"Error in transpose: rank of input "+t.rank+" must match length of reps "+e+"."}));var r=[t],i={reps:e};return Te.runKernelFunc((function(o,s){var a=o.tile(t,e);return s([t]),a}),{x:t},(function(o,s){var a=s[0];return{x:function(){var u=Nn(a);if(a.rank===1)for(var l=0;l<e[0];++l)u=u.add(o.slice([l*a.shape[0]],[a.shape[0]]));else if(a.rank===2)for(l=0;l<e[0];++l)for(var h=0;h<e[1];++h)u=u.add(o.slice([l*a.shape[0],h*a.shape[1]],[a.shape[0],a.shape[1]]));else if(a.rank===3)for(l=0;l<e[0];++l)for(h=0;h<e[1];++h)for(var d=0;d<e[2];++d)u=u.add(o.slice([l*a.shape[0],h*a.shape[1],d*a.shape[2]],[a.shape[0],a.shape[1],a.shape[2]]));else{if(a.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+a.rank+" tensors yet.");for(l=0;l<e[0];++l)for(h=0;h<e[1];++h)for(d=0;d<e[2];++d)for(var p=0;p<e[3];++p)u=u.add(o.slice([l*a.shape[0],h*a.shape[1],d*a.shape[2],p*a.shape[3]],[a.shape[0],a.shape[1],a.shape[2],a.shape[3]]))}return u}}}),"Tile",i,r)}}),BF=xe({truncatedNormal_:function(n,e,t,r,i){if(e===void 0&&(e=0),t===void 0&&(t=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new mb(e,t,r,!0,i),s=un(n,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),Ei=xe({unstack_:function(n,e){e===void 0&&(e=0),e=e||0;var t=oe(n,"x","unstack");pe(e>=-t.shape.length&&e<t.shape.length,(function(){return"Axis = "+e+" is not in [-"+t.shape.length+", "+t.shape.length+")"})),e<0&&(e+=t.shape.length);var r={axis:e};return Te.runKernelFunc((function(i){return i.unstack(t,e)}),{x:t},(function(i){return{x:function(){return na(i,e)}}}),"Unpack",r)}}),VF=function(n,e){return kt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h,d;return Nt(this,(function(p){switch(p.label){case 0:return t=oe(n,"x","setdiff1d"),r=oe(e,"y","setdiff1d"),pe(t.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+t.dtype+") and y ("+r.dtype+")."})),pe(t.rank===1,(function(){return"x should be 1D tensor, but got x ("+t.shape+")."})),pe(r.rank===1,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,t.data()];case 1:return i=p.sent(),[4,r.data()];case 2:for(o=p.sent(),s=new Set(o),a=0,h=0;h<i.length;h++)s.has(i[h])||a++;for(u=new fm([a],t.dtype),l=new fm([a],"int32"),h=0,d=0;h<i.length;h++)s.has(i[h])||(u.values[d]=i[h],l.values[d]=h,d++);return[2,[u.toTensor(),l.toTensor()]]}}))}))};function Uv(n,e,t,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(n[0]/t),i=i.concat(n.slice(1));else{i=i.concat(n[0]);for(var o=e.length,s=0;s<o;++s)i=i.concat([n[s+1]/e[s],e[s]]);i=i.concat(n.slice(o+1))}return i}function zv(n,e,t){t===void 0&&(t=!0);var r=[];if(t){r.push(e);for(var i=e+1;i<n;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],s=[];for(i=1;i<n;++i)i>=2*e+1||i%2==1?s.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,s)}return r}function Wv(n,e,t,r){r===void 0&&(r=!0);var i=[];r?i.push(n[0]/t):i.push(n[0]*t);for(var o=1;o<n.length;++o)o<=e.length?r?i.push(e[o-1]*n[o]):i.push(n[o]/e[o-1]):i.push(n[o]);return i}function _3(n,e){for(var t=[0],r=0;r<e;++r)t.push(n[r][0]);return t}function E3(n,e,t){for(var r=n.slice(0,1),i=0;i<t;++i)r.push(n[i+1]-e[i][0]-e[i][1]);return r}function S3(n,e){if(n.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+n.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>n.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+n.rank);if(n.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+n.shape+".");for(var t=e.shape,r=t[t.length-1],i=1,o=0;o<t.length-1;++o)i*=t[o];var s=n.shape,a=t.slice();a.pop();var u=1;for(o=r;o<n.rank;++o)u*=s[o],a.push(s[o]);var l=nl(n.shape).map((function(h){return h/u})).concat([1]).slice(0,r);return[a,i,u,l]}var A3=30;function wy(n){return n<=A3?n:A2(n,Math.floor(Math.sqrt(n)))}function jF(n,e,t){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+t.shape+", indices.shape: "+e.shape+", shape: "+n+", sliceDim: "+r+", and batchDim: "+i+".";if(t.rank<i)throw new Error(o+" update.rank < "+i+". ");if(n.length<r+(t.rank-i))throw new Error(o+" Output shape length < "+(r+(t.rank-i)));if(t.rank!==i+n.length-r)throw new Error(o+" update.rank != "+(i+n.length-r));for(var s=0;s<i;++s)if(t.shape[s]!==e.shape[s])throw new Error(o+" updates.shape["+s+"] ("+t.shape[s]+") != indices.shape["+s+"] ("+e.shape[s]+").");for(s=0;s<t.rank-i;++s)if(t.shape[s+i]!==n[s+r])throw new Error(o+" updates.shape["+(s+i)+"] ("+t.shape[s+i]+") != shape["+(s+i)+"] ("+n[s+i]+")")}function UF(n,e,t){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(n.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+n.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+t);if(t.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(n.size===0)throw new Error("Updates specified for empty output. updates shape: "+n.shape)}jF(t,e,n)}function qv(n,e,t){for(var r=e.shape.length,i=r>1?e.shape[r-1]:1,o=t.length,s=1,a=i;a<o;++a)s*=t[a];var u=i<1?1:i;return{sliceRank:i,numUpdates:Dt(e.shape)/u,sliceSize:s,strides:nl(t.slice(0,i)).concat([1]),outputSize:Dt(t)}}function zF(n,e,t){pe(n.rank===e.length,(function(){return"Error in slice"+n.rank+"D: Length of begin "+e+" must match the rank of the array ("+n.rank+")."})),pe(n.rank===t.length,(function(){return"Error in slice"+n.rank+"D: Length of size "+t+" must match the rank of the array ("+n.rank+")."}));for(var r=function(o){pe(e[o]+t[o]<=n.shape[o],(function(){return"Error in slice"+n.rank+"D: begin["+o+"] + size["+o+"] ("+(e[o]+t[o])+") would overflow input.shape["+o+"] ("+n.shape[o]+")"}))},i=0;i<n.rank;++i)r(i)}function DE(n){for(var e=[],t=0;n>0;)1&n&&e.push(t),n/=2,t++;return e}function gb(n,e,t){for(var r=[],i=0;i<n.length;i++)r[i]=Math.ceil((e[i]-n[i])/t[i]);return r}function WF(n,e,t,r,i){var o=e[i],s=t[i]||1;(n&1<<i||o==null)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),o=_2(0,o,a-1)}function qF(n,e,t,r,i){var o=e[i],s=t[i]||1;(n&1<<i||o==null)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),o=s>0?_2(0,o,a):_2(-1,o,a-1)}function C3(n,e,t){for(var r=t.length,i=0;i<t.length;i++)if(t[i]>1){r=i;break}for(i=r+1;i<t.length;i++)if(e[i]>0||t[i]!==n[i])return!1;return!0}function I3(n,e){for(var t=n.length>0?n[n.length-1]:1,r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function HF(n,e){pe(S2(n),(function(){return"The f passed in variableGrads(f) must be a function"})),pe(e==null||Array.isArray(e)&&e.every((function(h){return h instanceof qd})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var t=e!=null;if(!t)for(var r in e=[],Te.registeredVariables)e.push(Te.registeredVariables[r]);var i=t?e.filter((function(h){return!h.trainable})):null,o=e.length;pe((e=e.filter((function(h){return h.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."}));var s=Te.gradients(n,e,null,!0),a=s.value,u=s.grads;pe(u.some((function(h){return h!=null})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),pe(a.rank===0,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+a.rank+" tensor"}));var l={};return e.forEach((function(h,d){u[d]!=null&&(l[h.name]=u[d])})),i!=null&&i.forEach((function(h){return l[h.name]=null})),{value:a,grads:l}}function C0(n){return Te.customGrad(n)}var Ql=xe({softmax_:function(n,e){e===void 0&&(e=-1);var t=oe(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and dim was "+e);return Te.runKernelFunc((function(r,i){var o=r.softmax(t,e);return i([o]),o}),{logits:t},(function(r,i){var o=i[0],s=r.mul(o);return{logits:function(){return s.sub(s.sum([e],!0).mul(o))}}}),"Softmax",{dim:e},[],[!0])}}),GF=xe({logSoftmax_:function(n,e){e===void 0&&(e=-1);var t=oe(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and axis was "+e);return C0((function(r,i){var o=r.max(e,!0),s=r.sub(o),a=s.toFloat().sub(s.exp().sum(e,!0).log());return i([a]),{value:a,gradFunc:function(u,l){var h=l[0].exp();return u.sub(u.sum(e,!0).mul(h))}}}))(t)}}),T3=(function(){function n(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return n.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},n.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},n.prototype.has=function(e){return this.data.has(e)},n.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},n.prototype.numDataIds=function(){return this.dataIdsCount},n})(),k3=(function(){function n(){}return n.prototype.time=function(e){return Ve("time")},n.prototype.read=function(e){return Ve("read")},n.prototype.readSync=function(e){return Ve("readSync")},n.prototype.numDataIds=function(){return Ve("numDataIds")},n.prototype.disposeData=function(e){return Ve("disposeData")},n.prototype.write=function(e,t,r){return Ve("write")},n.prototype.move=function(e,t,r,i){return Ve("move")},n.prototype.memory=function(){return Ve("memory")},n.prototype.floatPrecision=function(){return Ve("floatPrecision")},n.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},n.prototype.batchMatMul=function(e,t,r,i){return Ve("batchMatMul")},n.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,Ve("fusedBatchMatMul")},n.prototype.slice=function(e,t,r){return Ve("slice")},n.prototype.stridedSlice=function(e,t,r,i){return Ve("stridedSlice")},n.prototype.unstack=function(e,t){return Ve("unstack")},n.prototype.reverse=function(e,t){return Ve("reverse")},n.prototype.concat=function(e,t){return Ve("concat")},n.prototype.neg=function(e){return Ve("neg")},n.prototype.add=function(e,t){return Ve("add")},n.prototype.addN=function(e){return Ve("addN")},n.prototype.subtract=function(e,t){return Ve("subtract")},n.prototype.multiply=function(e,t){return Ve("multiply")},n.prototype.realDivide=function(e,t){return Ve("realDivide")},n.prototype.floorDiv=function(e,t){return Ve("floorDiv")},n.prototype.sum=function(e,t){return Ve("sum")},n.prototype.prod=function(e,t){return Ve("prod")},n.prototype.unsortedSegmentSum=function(e,t,r){return Ve("unsortedSegmentSum")},n.prototype.argMin=function(e,t){return Ve("argMin")},n.prototype.argMax=function(e,t){return Ve("argMax")},n.prototype.equal=function(e,t){return Ve("equal")},n.prototype.notEqual=function(e,t){return Ve("notEqual")},n.prototype.less=function(e,t){return Ve("less")},n.prototype.lessEqual=function(e,t){return Ve("lessEqual")},n.prototype.greater=function(e,t){return Ve("greater")},n.prototype.greaterEqual=function(e,t){return Ve("greaterEqual")},n.prototype.logicalNot=function(e){return Ve("logicalNot")},n.prototype.logicalAnd=function(e,t){return Ve("logicalAnd")},n.prototype.logicalOr=function(e,t){return Ve("logicalOr")},n.prototype.where=function(e){return Ve("where")},n.prototype.select=function(e,t,r){return Ve("select")},n.prototype.topk=function(e,t,r){return Ve("topk")},n.prototype.min=function(e,t){return Ve("min")},n.prototype.minimum=function(e,t){return Ve("minimum")},n.prototype.mod=function(e,t){return Ve("mod")},n.prototype.max=function(e,t){return Ve("max")},n.prototype.maximum=function(e,t){return Ve("maximum")},n.prototype.all=function(e,t){return Ve("all")},n.prototype.any=function(e,t){return Ve("any")},n.prototype.squaredDifference=function(e,t){return Ve("squaredDifference")},n.prototype.ceil=function(e){return Ve("ceil")},n.prototype.floor=function(e){return Ve("floor")},n.prototype.round=function(e){return Ve("round")},n.prototype.sign=function(e){return Ve("sign")},n.prototype.isNaN=function(e){return Ve("isNaN")},n.prototype.isInf=function(e){return Ve("isInf")},n.prototype.isFinite=function(e){return Ve("isFinite")},n.prototype.pow=function(e,t){return Ve("pow")},n.prototype.exp=function(e){return Ve("exp")},n.prototype.expm1=function(e){return Ve("expm1")},n.prototype.softmax=function(e,t){return Ve("softmax")},n.prototype.log=function(e){return Ve("log")},n.prototype.log1p=function(e){return Ve("log1p")},n.prototype.sqrt=function(e){return Ve("sqrt")},n.prototype.rsqrt=function(e){return Ve("rsqrt")},n.prototype.square=function(e){return Ve("square")},n.prototype.reciprocal=function(e){return Ve("reciprocal")},n.prototype.relu=function(e){return Ve("relu")},n.prototype.relu6=function(e){return Ve("relu6")},n.prototype.prelu=function(e,t){return Ve("prelu")},n.prototype.elu=function(e){return Ve("elu")},n.prototype.eluDer=function(e,t){return Ve("eluDer")},n.prototype.selu=function(e){return Ve("selu")},n.prototype.int=function(e){return Ve("int")},n.prototype.clip=function(e,t,r){return Ve("clip")},n.prototype.abs=function(e){return Ve("abs")},n.prototype.complexAbs=function(e){return Ve("complexAbs")},n.prototype.sigmoid=function(e){return Ve("sigmoid")},n.prototype.softplus=function(e){return Ve("softplus")},n.prototype.sin=function(e){return Ve("sin")},n.prototype.cos=function(e){return Ve("cos")},n.prototype.tan=function(e){return Ve("tan")},n.prototype.asin=function(e){return Ve("asin")},n.prototype.acos=function(e){return Ve("acos")},n.prototype.atan=function(e){return Ve("atan")},n.prototype.atan2=function(e,t){return Ve("atan2")},n.prototype.sinh=function(e){return Ve("sinh")},n.prototype.cosh=function(e){return Ve("cosh")},n.prototype.tanh=function(e){return Ve("tanh")},n.prototype.asinh=function(e){return Ve("asinh")},n.prototype.acosh=function(e){return Ve("acosh")},n.prototype.atanh=function(e){return Ve("atanh")},n.prototype.erf=function(e){return Ve("erf")},n.prototype.step=function(e,t){return Ve("step")},n.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Ve("fusedConv2d")},n.prototype.conv2d=function(e,t,r){return Ve("conv2d")},n.prototype.conv2dDerInput=function(e,t,r){return Ve("conv2dDerInput")},n.prototype.conv2dDerFilter=function(e,t,r){return Ve("conv2dDerFilter")},n.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Ve("fusedDepthwiseConv2D")},n.prototype.depthwiseConv2D=function(e,t,r){return Ve("depthwiseConv2D")},n.prototype.depthwiseConv2DDerInput=function(e,t,r){return Ve("depthwiseConv2DDerInput")},n.prototype.depthwiseConv2DDerFilter=function(e,t,r){return Ve("depthwiseConv2DDerFilter")},n.prototype.conv3d=function(e,t,r){return Ve("conv3d")},n.prototype.conv3dDerInput=function(e,t,r){return Ve("conv3dDerInput")},n.prototype.conv3dDerFilter=function(e,t,r){return Ve("conv3dDerFilter")},n.prototype.maxPool=function(e,t){return Ve("maxPool")},n.prototype.maxPoolBackprop=function(e,t,r,i){return Ve("maxPoolBackprop")},n.prototype.avgPool=function(e,t){return Ve("avgPool")},n.prototype.avgPoolBackprop=function(e,t,r){return Ve("avgPoolBackprop")},n.prototype.avgPool3d=function(e,t){return Ve("avgPool3d")},n.prototype.avgPool3dBackprop=function(e,t,r){return Ve("avgPool3dBackprop")},n.prototype.maxPool3d=function(e,t){return Ve("maxPool3d")},n.prototype.maxPool3dBackprop=function(e,t,r,i){return Ve("maxPool3dBackprop")},n.prototype.reshape=function(e,t){return Ve("reshape")},n.prototype.cast=function(e,t){return Ve("cast")},n.prototype.tile=function(e,t){return Ve("tile")},n.prototype.pad=function(e,t,r){return Ve("pad")},n.prototype.transpose=function(e,t){return Ve("transpose")},n.prototype.gather=function(e,t,r){return Ve("gather")},n.prototype.gatherND=function(e,t){return Ve("gatherND")},n.prototype.scatterND=function(e,t,r){return Ve("scatterND")},n.prototype.batchToSpaceND=function(e,t,r){return Ve("batchToSpaceND")},n.prototype.spaceToBatchND=function(e,t,r){return Ve("spaceToBatchND")},n.prototype.resizeBilinear=function(e,t,r,i){return Ve("resizeBilinear")},n.prototype.resizeBilinearBackprop=function(e,t,r){return Ve("resizeBilinearBackprop")},n.prototype.resizeNearestNeighbor=function(e,t,r,i){return Ve("resizeNearestNeighbor")},n.prototype.resizeNearestNeighborBackprop=function(e,t,r){return Ve("resizeNearestNeighborBackprop")},n.prototype.batchNormalization=function(e,t,r,i,o,s){return Ve("batchNormalization")},n.prototype.localResponseNormalization4D=function(e,t,r,i,o){return Ve("localResponseNormalization4D")},n.prototype.LRNGrad=function(e,t,r,i,o,s,a){return Ve("LRNGrad")},n.prototype.multinomial=function(e,t,r,i){return Ve("multinomial")},n.prototype.oneHot=function(e,t,r,i){return Ve("oneHot")},n.prototype.cumsum=function(e,t,r,i){return Ve("cumsum")},n.prototype.nonMaxSuppression=function(e,t,r,i,o){return Ve("nonMaxSuppression")},n.prototype.fft=function(e){return Ve("fft")},n.prototype.ifft=function(e){return Ve("ifft")},n.prototype.complex=function(e,t){return Ve("complex")},n.prototype.real=function(e){return Ve("real")},n.prototype.imag=function(e){return Ve("imag")},n.prototype.cropAndResize=function(e,t,r,i,o,s){return Ve("cropAndResize")},n.prototype.depthToSpace=function(e,t,r){return Ve("depthToSpace")},n.prototype.split=function(e,t,r){return Ve("split")},n.prototype.sparseToDense=function(e,t,r,i){return Ve("sparseToDense")},n.prototype.diag=function(e){return Ve("diag")},n.prototype.fill=function(e,t,r){return Ve("fill")},n.prototype.onesLike=function(e){return Ve("onesLike")},n.prototype.zerosLike=function(e){return Ve("zerosLike")},n.prototype.linspace=function(e,t,r){return Ve("linspace")},n.prototype.dispose=function(){return Ve("dispose")},n})();function Ve(n){throw new Error("'"+n+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Yc(n,e){for(var t=n.length,r=[],i=0;i<t;i++){var o=t-1-i,s=n[o]||1;(e[e.length-1-i]||1)>1&&s===1&&r.unshift(o)}return r}function Ai(n,e){for(var t=[],r=0;r<e.length;r++){var i=n[n.length-r-1],o=e.length-r-1,s=e[o];(i==null||i===1&&s>1)&&t.unshift(o)}return t}function _n(n,e){for(var t=[],r=Math.max(n.length,e.length),i=0;i<r;i++){var o=n[n.length-i-1];o==null&&(o=1);var s=e[e.length-i-1];if(s==null&&(s=1),o===1)t.unshift(s);else if(s===1)t.unshift(o);else{if(o!==s)throw Error("Operands could not be broadcast together with shapes "+n+" and "+e+".");t.unshift(o)}}return t}function pm(n,e,t,r,i,o,s){s===void 0&&(s="channelsLast");var a,u=$v(e),l=u[0],h=u[1];if(s==="channelsLast")a=[l,h,n[3],n[3]];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);a=[l,h,n[1],n[1]]}return Af(n,a,t,r,i,o,!1,s)}function Hv(n,e,t,r,i,o,s){s===void 0&&(s="NDHWC");var a,u,l=R2(e),h=l[0],d=l[1],p=l[2];if(s==="NDHWC")u="channelsLast",a=[h,d,p,n[4],n[4]];else{if(s!=="NCDHW")throw new Error("Unknown dataFormat "+s);u="channelsFirst",a=[h,d,p,n[1],n[1]]}return Gv(n,a,t,r,i,!1,u,o)}function Af(n,e,t,r,i,o,s,a){s===void 0&&(s=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1],l=u[0],h=u[1],d=u[2],p=u[3];if(a==="channelsLast")l=n[0],h=n[1],d=n[2],p=n[3];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=n[0],p=n[1],h=n[2],d=n[3]}var m,w=e[0],b=e[1],x=e[3],E=$v(t),A=E[0],N=E[1],F=$v(r),D=F[0],W=F[1],k=Ed(w,D),C=Ed(b,W),L=(function(J,de,fe,he,K,le,se,re){var j,$,ne;if(typeof J=="number"){j={top:J,bottom:J,left:J,right:J,type:J===0?"VALID":"NUMBER"};var ce=(function(Ue,et,Je,Be,_e){Be==null&&(Be=N3(Ue,et,Je));var ie=Ue[0],ft=Ue[1],dt=Jp((ie-et+2*Be)/Je+1,_e);pe(ei(dt),(function(){return"The output # of rows ("+dt+") must be an integer. Change the stride and/or zero pad parameters"}));var Ze=Jp((ft-et+2*Be)/Je+1,_e);return pe(ei(Ze),(function(){return"The output # of columns ("+Ze+") must be an integer. Change the stride and/or zero pad parameters"})),[dt,Ze]})([de,fe],le,he,J,re);$=ce[0],ne=ce[1]}else if(J==="same"){$=Math.ceil(de/he),ne=Math.ceil(fe/K);var ge=Math.max(0,($-1)*he+le-de),ye=Math.max(0,(ne-1)*K+se-fe),be=Math.floor(ge/2),Ae=ge-be,$e=Math.floor(ye/2);j={top:be,bottom:Ae,left:$e,right:ye-$e,type:"SAME"}}else{if(J!=="valid")throw Error("Unknown padding parameter: "+J);j={top:0,bottom:0,left:0,right:0,type:"VALID"},$=Math.ceil((de-le+1)/he),ne=Math.ceil((fe-se+1)/K)}return{padInfo:j,outHeight:$,outWidth:ne}})(i,h,d,A,N,k,C,o),B=L.padInfo,R=L.outHeight,M=L.outWidth,U=s?x*p:x;return a==="channelsFirst"?m=[l,U,R,M]:a==="channelsLast"&&(m=[l,R,M,U]),{batchSize:l,dataFormat:a,inHeight:h,inWidth:d,inChannels:p,outHeight:R,outWidth:M,outChannels:U,padInfo:B,strideHeight:A,strideWidth:N,filterHeight:w,filterWidth:b,effectiveFilterHeight:k,effectiveFilterWidth:C,dilationHeight:D,dilationWidth:W,inShape:n,outShape:m,filterShape:e}}function Gv(n,e,t,r,i,o,s,a){o===void 0&&(o=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],h=u[1],d=u[2],p=u[3],m=u[4];if(s==="channelsLast")l=n[0],h=n[1],d=n[2],p=n[3],m=n[4];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=n[0],m=n[1],h=n[2],d=n[3],p=n[4]}var w,b=e[0],x=e[1],E=e[2],A=e[4],N=R2(t),F=N[0],D=N[1],W=N[2],k=R2(r),C=k[0],L=k[1],B=k[2],R=Ed(b,C),M=Ed(x,L),U=Ed(E,B),J=(function(se,re,j,$,ne,ce,ge,ye,be,Ae,$e){var Ue,et,Je,Be;if(typeof se=="number"){Ue={top:se,bottom:se,left:se,right:se,front:se,back:se,type:se===0?"VALID":"NUMBER"};var _e=(function(Vt,jt,Pt,Lt,Yt,Ut){Yt==null&&(Yt=N3(Vt,jt,Lt));var en=Vt[0],pt=Vt[1],ar=Vt[2],dn=Jp((en-jt+2*Yt)/Lt+1,Ut);pe(ei(dn),(function(){return"The output # of depths ("+dn+") must be an integer. Change the stride and/or zero pad parameters"}));var qr=Jp((pt-jt+2*Yt)/Lt+1,Ut);pe(ei(qr),(function(){return"The output # of rows ("+qr+") must be an integer. Change the stride and/or zero pad parameters"}));var xn=Jp((ar-jt+2*Yt)/Lt+1,Ut);return pe(ei(xn),(function(){return"The output # of columns ("+xn+") must be an integer. Change the stride and/or zero pad parameters"})),[dn,qr,xn,Pt]})([re,j,$,1],ye,1,ne,se,$e);et=_e[0],Je=_e[1],Be=_e[2]}else if(se==="same"){et=Math.ceil(re/ne),Je=Math.ceil(j/ce),Be=Math.ceil($/ge);var ie=(et-1)*ne+ye-re,ft=(Je-1)*ce+be-j,dt=(Be-1)*ge+Ae-$,Ze=Math.floor(ie/2),at=ie-Ze,lt=Math.floor(ft/2),ct=ft-lt,xt=Math.floor(dt/2);Ue={top:lt,bottom:ct,left:xt,right:dt-xt,front:Ze,back:at,type:"SAME"}}else{if(se!=="valid")throw Error("Unknown padding parameter: "+se);Ue={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},et=Math.ceil((re-ye+1)/ne),Je=Math.ceil((j-be+1)/ce),Be=Math.ceil(($-Ae+1)/ge)}return{padInfo:Ue,outDepth:et,outHeight:Je,outWidth:Be}})(i,h,d,p,F,D,W,R,M,U,a),de=J.padInfo,fe=J.outDepth,he=J.outHeight,K=J.outWidth,le=o?A*m:A;return s==="channelsFirst"?w=[l,le,fe,he,K]:s==="channelsLast"&&(w=[l,fe,he,K,le]),{batchSize:l,dataFormat:s,inDepth:h,inHeight:d,inWidth:p,inChannels:m,outDepth:fe,outHeight:he,outWidth:K,outChannels:le,padInfo:de,strideDepth:F,strideHeight:D,strideWidth:W,filterDepth:b,filterHeight:x,filterWidth:E,effectiveFilterDepth:R,effectiveFilterHeight:M,effectiveFilterWidth:U,dilationDepth:C,dilationHeight:L,dilationWidth:B,inShape:n,outShape:w,filterShape:e}}function N3(n,e,t,r){r===void 0&&(r=1);var i=Ed(e,r);return Math.floor((n[0]*(t-1)-t+i)/2)}function $v(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function R2(n){return typeof n=="number"?[n,n,n]:n}function Ed(n,e){return e<=1?n:n+(n-1)*(e-1)}function Jp(n,e){if(!e)return n;switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error("Unknown roundingMode "+e)}}function Gd(n){var e=$v(n),t=e[0],r=e[1],i=e[2];return t===1&&r===1&&i===1}function Ts(n,e){return Gd(n)||Gd(e)}function vb(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+n)}function P3(n,e,t){if(e==="complex64"){if(n.dtype==="complex64")return n.clone();var r=mr(n.shape),i=n.toFloat(),o=t.complex(i,r);return r.dispose(),i.dispose(),o}if(!wM(n.dtype,e))return Te.makeTensorFromDataId(n.dataId,n.shape,e);if(n.dtype==="complex64"){var s=t.real(n);return o=s.cast(e),s.dispose(),o}if(e==="int32")return t.int(n);if(e==="bool"){var a=wt(0,n.dtype);return o=t.notEqual(n,a),a.dispose(),o}throw new Error("Error in Cast: failed to cast "+n.dtype+" to "+e)}function D2(n,e){return Te.makeTensorFromDataId(n.dataId,e,n.dtype)}function R3(n,e,t){var r=(e-n)/(t-1),i=Dm(t,"float32");i[0]=n;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return ai(i,"float32")}function L2(n,e){if(n.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+n.length+", imag: "+e.length+".");for(var t=new Float32Array(2*n.length),r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function LE(n,e){return{real:n[2*e],imag:n[2*e+1]}}function $F(n,e,t,r){n[2*r]=e,n[2*r+1]=t}function KF(n,e,t){var r=(t?2:-2)*Math.PI*(n/e);return{real:Math.cos(r),imag:Math.sin(r)}}function XF(n,e,t){var r=(function(o,s,a){return(function(u,l,h){for(var d=0,p=u.length,m=0,w=!1;d<p;){var b=h(l,u[m=d+(p-d>>>1)]);b>0?d=m+1:(p=m,w=!b)}return w?d:-d-1})(o,s,a||YF)})(n,e,t),i=r<0?-(r+1):r;n.splice(i,0,e)}function YF(n,e){return n>e?1:n<e?-1:0}function yb(n,e,t,r,i){return D3(n,e,t,r,i,0).selectedIndices}function wb(n,e,t,r,i,o){var s=D3(n,e,t,r,i,o);return s.numValidOutputs.dispose(),{selectedIndices:s.selectedIndices,selectedScores:s.selectedScores}}function D3(n,e,t,r,i,o,s,a){a===void 0&&(a=!1);for(var u=Array.from(e).map((function(F,D){return{score:F,boxIndex:D,suppressBeginIndex:0}})).filter((function(F){return F.score>i})).sort(ME),l=o>0?-.5/o:0,h=[],d=[];h.length<t&&u.length>0;){var p=u.pop(),m=p.score,w=p.boxIndex,b=p.suppressBeginIndex;if(m<i)break;for(var x=!1,E=h.length-1;E>=b;--E){var A=JF(n,w,h[E]);if(A>=r){x=!0;break}if(p.score=p.score*QF(r,l,A),p.score<=i)break}p.suppressBeginIndex=h.length,x||(p.score===m?(h.push(w),d.push(p.score)):p.score>i&&XF(u,p,ME))}var N=h.length;return a&&(h.fill(0,N),d.fill(0,N)),{selectedIndices:ai(h,"int32"),selectedScores:ai(d,"float32"),numValidOutputs:wt(N,"int32")}}function JF(n,e,t){var r=n.subarray(4*e,4*e+4),i=n.subarray(4*t,4*t+4),o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),h=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),m=(a-o)*(u-s),w=(d-l)*(p-h);if(m<=0||w<=0)return 0;var b=Math.max(o,l),x=Math.max(s,h),E=Math.min(a,d),A=Math.min(u,p),N=Math.max(E-b,0)*Math.max(A-x,0);return N/(m+w-N)}function QF(n,e,t){var r=Math.exp(e*t*t);return t<=n?r:0}function ME(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}function L3(n,e,t){var r=new Array(n.rank).fill(0),i=n.shape.slice();return e.map((function(o){i[t]=o;var s=n.slice(r,i);return r[t]+=o,s}))}function M3(n,e){for(var t=new Array(n.rank),r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];var i=un(t,n.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),s=new Array(n.rank),a=0;a<s.length;a++)s[a]=o[a]%n.shape[a];var u=n.locToIndex(s);i.values[r]=n.values[u]}return i.toTensor()}function F3(n,e,t,r,i){for(var o=e[e.length-1],s=[n.length/o,o],a=s[0],u=s[1],l=hm(t,a*r),h=hm("int32",a*r),d=0;d<a;d++){for(var p=d*u,m=n.subarray(p,p+u),w=[],b=0;b<m.length;b++)w.push({value:m[b],index:b});w.sort((function(F,D){return D.value-F.value}));var x=d*r,E=l.subarray(x,x+r),A=h.subarray(x,x+r);for(b=0;b<r;b++)E[b]=w[b].value,A[b]=w[b].index}var N=e.slice();return N[N.length-1]=r,[uo(l,N,t),uo(h,N,"int32")]}function bb(n,e){for(var t=[],r=0;r<e.length;r++)e[r]&&t.push(r);var i=un(n,"int32"),o=un([t.length,n.length],"int32");for(r=0;r<t.length;r++){var s=i.indexToLoc(t[r]),a=r*n.length;o.values.set(s,a)}return o.toTensor()}var ZF=function(n,e){this.outputShape=[],this.outputShape=n,this.variableNames=e.map((function(i,o){return"T"+o}));var t=[];this.variableNames.forEach((function(i){t.push("float v"+i+" = get"+i+"AtOutCoords();")}));var r=this.variableNames.map((function(i){return"v"+i})).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},eO=function(n,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=e.map((function(i,o){return"T"+o}));var t=[];this.variableNames.forEach((function(i){t.push("vec4 v"+i+" = get"+i+"AtOutCoords();")}));var r=this.variableNames.map((function(i){return"v"+i})).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},tO=function(n,e,t){this.variableNames=["A"];var r=n.windowSize,i=n.batchSize,o=n.inSize,s=Math.ceil(o/r);t||this.variableNames.push("bestIndicesA"),this.outputShape=[i,s];var a=e==="max"?">":"<",u=t?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+a+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function O3(n,e){return["x","y","z","w","u","v"].slice(0,e).map((function(t){return n+"."+t}))}function As(n,e){return e===1?[n]:O3(n,e)}function Fo(){var n,e,t,r,i,o,s,a,u,l;return Ye().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",i="texture",o="outputColor",s="out vec4 outputColor;",a=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",i="texture2D",o="gl_FragColor",s="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:i,output:o,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:u,defineRound:l}}function af(n,e,t){t===void 0&&(t="index");var r=nl(e);return r.map((function(i,o){return"int "+n[o]+" = "+t+" / "+i+"; "+(o===r.length-1?"int "+n[o+1]+" = "+t+" - "+n[o]+" * "+i:"index -= "+n[o]+" * "+i)+";"})).join("")}function xb(n){var e=nl(n).map((function(t){return t.toString()}));return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var B3=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function nO(n,e,t,r){var i=[];n.forEach((function(m){var w=Dt(m.shapeInfo.logicalShape);m.shapeInfo.isUniform?i.push("uniform float "+m.name+(w>1?"["+w+"]":"")+";"):(i.push("uniform sampler2D "+m.name+";"),i.push("uniform int offset"+m.name+";"))}));var o,s,a=i.join(`
`),u=n.map((function(m){return(function(w,b,x){x===void 0&&(x=!1);var E="";E+=x?V3(w):id(w);var A=w.shapeInfo.logicalShape,N=b.logicalShape;return A.length<=N.length&&(E+=x?(function(F,D){var W,k=F.name,C=k.charAt(0).toUpperCase()+k.slice(1),L="get"+C+"AtOutCoords",B=F.shapeInfo.logicalShape.length,R=D.logicalShape.length,M=Yc(F.shapeInfo.logicalShape,D.logicalShape),U=lr(R),J=R-B,de=["x","y","z","w","u","v"];W=B===0?"":R<2&&M.length>=1?"coords = 0;":M.map((function(j){return"coords."+de[j+J]+" = 0;"})).join(`
`);var fe="";fe=R<2&&B>0?"coords":F.shapeInfo.logicalShape.map((function(j,$){return"coords."+de[$+J]})).join(", ");var he="return outputValue;",K=Dt(F.shapeInfo.logicalShape)===1,le=Dt(D.logicalShape)===1;if(B!==1||K||le){if(K&&!le)he=R===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(M.length){var se=B-2,re=B-1;M.indexOf(se)>-1&&M.indexOf(re)>-1?he="return vec4(outputValue.x);":M.indexOf(se)>-1?he="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":M.indexOf(re)>-1&&(he="return vec4(outputValue.xx, outputValue.zz);")}}else he=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+L+`() {
      `+U+` coords = getOutputCoords();
      `+W+`
      vec4 outputValue = get`+C+"("+fe+`);
      `+he+`
    }
  `})(w,b):(function(F,D){var W=F.name,k=W.charAt(0).toUpperCase()+W.slice(1),C="get"+k+"AtOutCoords",L=D.texShape,B=F.shapeInfo.texShape,R=F.shapeInfo.logicalShape.length,M=D.logicalShape.length;if(!F.shapeInfo.isUniform&&R===M&&F.shapeInfo.flatOffset==null&&qi(B,L))return`
      float `+C+`() {
        return sampleTexture(`+W+`, resultUV);
      }
    `;var U,J=lr(M),de=Yc(F.shapeInfo.logicalShape,D.logicalShape),fe=M-R,he=["x","y","z","w","u","v"];U=R===0?"":M<2&&de.length>=1?"coords = 0;":de.map((function(le){return"coords."+he[le+fe]+" = 0;"})).join(`
`);var K="";return K=M<2&&R>0?"coords":F.shapeInfo.logicalShape.map((function(le,se){return"coords."+he[se+fe]})).join(", "),`
    float `+C+`() {
      `+J+` coords = getOutputCoords();
      `+U+`
      return get`+k+"("+K+`);
    }
  `})(w,b)),E})(m,e,r)})).join(`
`),l=e.texShape,h=Fo(),d=(function(m){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+m.texture2D+`(textureSampler, uv).r;
    }
  `})(h),p=(function(m){return m.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+m.varyingFs+` vec2 resultUV;
    `+m.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+m.defineSpecialNaN+`
    `+m.defineSpecialInf+`
    `+m.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+rO+`
    `+iO+`
    `+oO+`
  `})(h);return e.isPacked?(o=(function(m,w){switch(m.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(F,D){var W=[Math.ceil(D[0]/2),Math.ceil(D[1]/2)];return W[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+W[1]+`.0);
      }
    `:W[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+W[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+W[0]+", "+W[1]+`));
      return 2 * (resTexRC.x * `+W[1]+` + resTexRC.y);
    }
  `})(0,w);case 2:return(function(F,D){var W=[Math.ceil(D[0]/2),Math.ceil(D[1]/2)];if(qi(F,D))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+W[0]+", "+W[1]+`));
      }
    `;var k=Math.ceil(F[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+W[0]+", "+W[1]+`));

      int index = resTexRC.x * `+W[1]+` + resTexRC.y;
      int r = 2 * (index / `+k+`);
      int c = imod(index, `+k+`) * 2;

      return ivec2(r, c);
    }
  `})(m,w);case 3:return b=m,x=w,E=[Math.ceil(x[0]/2),Math.ceil(x[1]/2)],A=Math.ceil(b[2]/2),N=A*Math.ceil(b[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      int b = index / `+N+`;
      index -= b * `+N+`;

      int r = 2 * (index / `+A+`);
      int c = imod(index, `+A+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return(function(F,D){for(var W=[Math.ceil(D[0]/2),Math.ceil(D[1]/2)],k=Math.ceil(F[F.length-1]/2),C=k*Math.ceil(F[F.length-2]/2),L=C,B="",R="b, r, c",M=2;M<F.length-1;M++)L*=F[F.length-M-1],B=`
      int b`+M+" = index / "+L+`;
      index -= b`+M+" * "+L+`;
    `+B,R="b"+M+", "+R;return`
    ivec`+F.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+W[0]+", "+W[1]+`));
      int index = resTexRC.x * `+W[1]+` + resTexRC.y;

      `+B+`

      int b = index / `+C+`;
      index -= b * `+C+`;

      int r = 2 * (index / `+k+`);
      int c = imod(index, `+k+`) * 2;

      return ivec`+F.length+"("+R+`);
    }
  `})(m,w)}var b,x,E,A,N})(e.logicalShape,l),s=(function(m){return`
    void setOutput(vec4 val) {
      `+m.output+` = val;
    }
  `})(h)):(o=(function(m,w){switch(m.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(E,A){return A[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+A[1]+`.0);
      }
    `:A[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+A[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+A[0]+", "+A[1]+`));
      return resTexRC.x * `+A[1]+` + resTexRC.y;
    }
  `})(0,w);case 2:return(function(E,A){return qi(E,A)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+A[0]+", "+A[1]+`));
      }
    `:E[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+A[0]+", "+A[1]+`));
        int index = resTexRC.x * `+A[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:E[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+A[0]+", "+A[1]+`));
        int index = resTexRC.x * `+A[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+A[0]+", "+A[1]+`));
      int index = resTexRC.x * `+A[1]+` + resTexRC.y;
      int r = index / `+E[1]+`;
      int c = index - r * `+E[1]+`;
      return ivec2(r, c);
    }
  `})(m,w);case 3:return b=w,x=af(["r","c","d"],m),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+b[0]+", "+b[1]+`));
      int index = resTexRC.x * `+b[1]+` + resTexRC.y;
      `+x+`
      return ivec3(r, c, d);
    }
  `;case 4:return(function(E,A){var N=af(["r","c","d","d2"],E);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+A[0]+", "+A[1]+`));
      int index = resTexRC.x * `+A[1]+` + resTexRC.y;
      `+N+`
      return ivec4(r, c, d, d2);
    }
  `})(m,w);case 5:return(function(E,A){var N=af(["r","c","d","d2","d3"],E);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+A[0]+`,
                             `+A[1]+`));

      int index = resTexRC.x * `+A[1]+` + resTexRC.y;

      `+N+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `})(m,w);case 6:return(function(E,A){var N=af(["r","c","d","d2","d3","d4"],E);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+A[0]+", "+A[1]+`));
      int index = resTexRC.x * `+A[1]+` + resTexRC.y;

      `+N+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `})(m,w);default:throw new Error(m.length+"-D output sampling is not yet supported")}var b,x})(e.logicalShape,l),s=(function(m){return`
    void setOutput(float val) {
      `+m.output+` = vec4(val, 0, 0, 0);
    }
  `})(h)),r&&(p+=sO),[p,d,s,a,o,u,t].join(`
`)}function id(n){var e=n.shapeInfo.logicalShape;switch(e.length){case 0:return(function(t){var r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var o=t.shapeInfo.texShape,s=o[0],a=o[1];if(s===1&&a===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=t.shapeInfo.texShape,l=u[0],h=u[1],d=Yh(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+l+", "+h+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `})(n);case 1:return(function(t){var r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+Qf(t)+`
      }
    `;var o=t.shapeInfo.texShape,s=o[0],a=o[1];if(a===1&&s===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Yh(r);return a===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+s+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+a+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+s+", "+a+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `})(n);case 2:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=t.shapeInfo.texShape;if(s!=null&&qi(r,s)){var a=s[0],u=s[1];return`
    float `+o+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+a+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var l=rf(r),h=l.newShape,d=l.keptDims,p=h;if(p.length<r.length){var m=od(t,p);return`
      `+id(m)+`
      float `+o+`(int row, int col) {
        return `+o+"("+sd(["row","col"],d)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Qf(t)+`
      }
    `;var w=s[0],b=s[1],x=Yh(i);return b===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+x+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+w+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:w===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+x+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+b+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+o+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+x+`;
    vec2 uv = uvFromFlat(`+w+", "+b+`, index);
    return sampleTexture(`+i+`, uv);
  }
`})(n);case 3:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=r[1]*r[2],a=r[2],u=rf(r),l=u.newShape,h=u.keptDims,d=l;if(d.length<r.length){var p=od(t,d);return`
        `+id(p)+`
        float `+o+`(int row, int col, int depth) {
          return `+o+"("+sd(["row","col","depth"],h)+`);
        }
      `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+s+", "+a+`, 1)));
        `+Qf(t)+`
      }
    `;var m=t.shapeInfo.texShape,w=m[0],b=m[1],x=t.shapeInfo.flatOffset;if(b===s&&x==null)return`
        float `+o+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+a+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+b+".0, "+w+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(b===a&&x==null)return`
    float `+o+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+b+".0, "+w+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var E=Yh(i);return`
      float `+o+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+s+" + col * "+a+" + depth + "+E+`;
        vec2 uv = uvFromFlat(`+w+", "+b+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `})(n);case 4:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=r[3],a=r[2]*s,u=r[1]*a,l=rf(r),h=l.newShape,d=l.keptDims;if(h.length<r.length){var p=od(t,h);return`
      `+id(p)+`
      float `+o+`(int row, int col, int depth, int depth2) {
        return `+o+"("+sd(["row","col","depth","depth2"],d)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+a+", "+s+`, 1)));
        `+Qf(t)+`
      }
    `;var m=t.shapeInfo.flatOffset,w=t.shapeInfo.texShape,b=w[0],x=w[1];if(x===u&&m==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+a+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+b+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(x===s&&m==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+b+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var E=Yh(i);return`
    float `+o+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+a+` +
          depth * `+s+` + depth2;
      vec2 uv = uvFromFlat(`+b+", "+x+", index + "+E+`);
      return sampleTexture(`+i+`, uv);
    }
  `})(n);case 5:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=r[4],a=r[3]*s,u=r[2]*a,l=r[1]*u,h=rf(r),d=h.newShape,p=h.keptDims;if(d.length<r.length){var m=od(t,d);return`
      `+id(m)+`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        return `+o+"("+sd(["row","col","depth","depth2","depth3"],p)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+a+", "+s+`)) +
          depth3;
        `+Qf(t)+`
      }
    `;var w=t.shapeInfo.flatOffset,b=t.shapeInfo.texShape,x=b[0],E=b[1];if(E===l&&w==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+a+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+E+".0, "+x+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(E===s&&w==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+E+".0, "+x+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var A=Yh(i);return`
    float `+o+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+a+` +
          depth2 * `+s+" + depth3 + "+A+`;
      vec2 uv = uvFromFlat(`+x+", "+E+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `})(n);case 6:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=rf(r),a=s.newShape,u=s.keptDims;if(a.length<r.length){var l=od(t,a);return`
      `+id(l)+`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+o+"("+sd(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var h=r[5],d=r[4]*h,p=r[3]*d,m=r[2]*p,w=r[1]*m;if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+w+", "+m+", "+p+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+h+`, 1)));
        `+Qf(t)+`
      }
    `;var b=t.shapeInfo.flatOffset,x=t.shapeInfo.texShape,E=x[0],A=x[1];if(A===w&&b==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+m+", "+p+", "+d+", "+h+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+A+".0, "+E+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(A===h&&b==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+A+".0, "+E+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var N=Yh(i);return`
    float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+w+" + col * "+m+" + depth * "+p+` +
          depth2 * `+d+" + depth3 * "+h+" + depth4 + "+N+`;
      vec2 uv = uvFromFlat(`+E+", "+A+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `})(n);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function V3(n){var e,t,r;switch(n.shapeInfo.logicalShape.length){case 0:return e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Fo(),`
    vec4 `+t+`() {
      return `+r.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return(function(i){var o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),a=i.shapeInfo.texShape,u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=Fo();return`
    vec4 `+s+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+o+`, uv);
    }
  `})(n);case 2:return(function(i){var o=i.shapeInfo.logicalShape,s=i.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),u=i.shapeInfo.texShape,l=u[0],h=u[1],d=Fo();if(u!=null&&qi(o,u))return`
      vec4 `+a+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+h+".0, "+l+`.0);

        return `+d.texture2D+"("+s+`, uv);
      }
    `;var p=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],m=Math.ceil(o[1]/2);return`
    vec4 `+a+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+m+", "+p[0]+", "+p[1]+`, row, col);
      return `+d.texture2D+"("+s+`, uv);
    }
  `})(n);case 3:return(function(i){var o=i.shapeInfo.logicalShape,s=i.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),u=i.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(o[0]===1){var h=o.slice(1),d=od(i,h);return`
        `+V3(d)+`
        vec4 `+a+`(int b, int row, int col) {
          return `+a+"("+sd(["b","row","col"],[1,2])+`);
        }
      `}var p=l[0],m=l[1],w=Math.ceil(o[2]/2),b=w*Math.ceil(o[1]/2),x=Fo();return`
    vec4 `+a+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+p+", "+m+", "+b+", "+w+`, b, row, col);
      return `+x.texture2D+"("+s+`, uv);
    }
  `})(n);default:return(function(i){for(var o=i.shapeInfo.logicalShape,s=o.length,a=i.name,u="get"+a.charAt(0).toUpperCase()+a.slice(1),l=i.shapeInfo.texShape,h=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=h[0],p=h[1],m=Math.ceil(o[s-1]/2),w=m*Math.ceil(o[s-2]/2),b="int b, int row, int col",x="b * "+w+" + (row / 2) * "+m+" + (col / 2)",E=2;E<s-1;E++)b="int b"+E+", "+b,w*=o[s-E-1],x="b"+E+" * "+w+" + "+x;var A=Fo();return`
    vec4 `+u+"("+b+`) {
      int index = `+x+`;
      int texR = index / `+p+`;
      int texC = index - texR * `+p+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+p+", "+d+`);
      return `+A.texture2D+"("+a+`, uv);
    }
  `})(n)}}var rO=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,iO=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,oO=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,sO=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Yh(n){return"offset"+n}function Qf(n){var e=n.name,t=Dt(n.shapeInfo.logicalShape);return t<2?"return "+e+";":`
    for (int i = 0; i < `+t+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function lr(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error("GPU for rank "+n+" is not yet supported")}function od(n,e){var t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function sd(n,e){return e.map((function(t){return n[t]})).join(", ")}var aO=function(n,e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,pe(n.length>2,(function(){return"Packed arg"+(t.charAt(0).toUpperCase()+t.slice(1))+" supports only inputs with rank above 2."}));var i=n[n.length-1],o=Math.ceil(i/e);this.outputShape=n.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");var s,a,u=this.outputShape,l=u.length,h=lr(l),d=As("coords",l);if(o===1){var p=lr(a=l+1);s=`
        `+p+" sourceLocR = "+p+"("+d.join()+`, 0);
        ++`+d[l-1]+`;
        `+p+" sourceLocG = "+p+"("+d.join()+`, 0);
        ++`+d[l-2]+`;
        `+p+" sourceLocA = "+p+"("+d.join()+`, 0);
        --`+d[l-1]+`;
        `+p+" sourceLocB = "+p+"("+d.join()+`, 0);
        --`+d[l-2]+";"}else a=l,s=`
        `+h+` sourceLocR = coords;
        ++`+d[l-1]+`;
        `+h+` sourceLocG = coords;
        ++`+d[l-2]+`;
        `+h+` sourceLocA = coords;
        --`+d[l-1]+`;
        `+h+` sourceLocB = coords;
        --`+d[l-2]+";";var m=["x","y","z","w","u","v"].slice(0,a),w="."+m[a-1],b=m.map((function(C){return"int "+C})),x=As("sourceLocR",a-1).concat("inIdx.r"),E=As("sourceLocG",a-1).concat("inIdx.g"),A=As("sourceLocB",a-1).concat("inIdx.b"),N=As("sourceLocA",a-1).concat("inIdx.a"),F=t==="max"?"greaterThan":"lessThan",D=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+E.join()+`),
                             getBestIndicesAChannel(`+A.join()+`),
                             getBestIndicesAChannel(`+N.join()+")));",W=`vec4(
            getAChannel(`+x.join()+`),
            hasNextCol ? getAChannel(`+E.join()+`) : 0.,
            hasNextRow ? getAChannel(`+A.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+N.join()+") : 0.)",k=r?"":`
      float getBestIndicesAChannel(`+b.join()+`) {
        return getChannel(getBestIndicesA(`+m.join()+`),
                                          vec2(`+m.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+b.join()+`) {
        return getChannel(getA(`+m.join()+`),
                               vec2(`+m.slice(-2).join()+`));
      }
      `+k+`
      void main() {
        `+h+` coords = getOutputCoords();
        bool hasNextCol = `+d[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+d[l-2]+" < "+(u[l-2]-1)+`;
        `+s+`
        ivec4 srcIdx = ivec4(sourceLocR`+w+", sourceLocG"+w+`,
          sourceLocB`+w+", sourceLocA"+w+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+W+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+D+`
          vec4 candidate = `+W+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+F+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},uO=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=n.dilationHeight,s=n.dilationWidth,a=n.effectiveFilterHeight,u=n.effectiveFilterWidth,l=a-1-n.padInfo.top,h=u-1-n.padInfo.left,d=1/(e*t);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+h+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
            wR += `+o+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+s+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},lO=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var e=n.filterDepth,t=n.filterHeight,r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,h=n.effectiveFilterDepth,d=n.effectiveFilterHeight,p=n.effectiveFilterWidth,m=h-1-n.padInfo.front,w=d-1-n.padInfo.top,b=p-1-n.padInfo.left,x=1/(e*t*r);this.userCode=`
      const ivec3 pads = ivec3(`+m+", "+w+", "+b+`);
      const float avgMultiplier = float(`+x+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+h+`;
            wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+p+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},cO=function(n,e,t,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],_n(n,e),_n(n,t);var s="0.0";r!=null&&(_n(n,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="1.0";i!=null&&(_n(n,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+s+`;
        float scale = `+a+`;
        float inv = scale * inversesqrt(variance + float(`+o+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},hO=function(n,e,t,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],_n(n,e),_n(n,t);var s="vec4(0.0)";r!=null&&(_n(n,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="vec4(1.0)";i!=null&&(_n(n,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        vec4 offset = `+s+`;
        vec4 scale = `+a+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+o+`));

        setOutput((x - mean) * inv + offset);
      }
    `},fO="return areal * breal - aimag * bimag;",dO="return areal * bimag + aimag * breal;",FE=function(n,e,t){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=_n(e,t),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+n+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},by="return a + b;",xy="return a - b;",OE="return a * b;",j3="return (a < 0.) ? b * a : a;",Ur=function(n,e,t){this.variableNames=["A","B"],this.outputShape=_n(e,t),this.userCode=`
      float binaryOperation(float a, float b) {
        `+n+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},U3=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Ul=function(n,e,t,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_n(e,t);var i=this.outputShape.length,o="";if(r)if(i===0||Dt(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          `+lr(i)+` coords = getOutputCoords();
        `,i===1)o+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var s=As("coords",i);o+=`
            bool nextRowOutOfBounds =
              (`+s[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+s[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+n+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+o+`

        setOutput(result);
      }
    `},pO=(function(){function n(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return n.prototype.getCustomSetupFunc=function(e,t){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,e),i.gl.uniform1f(r.maxLoc,t)}},n})(),mO=(function(){function n(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return n.prototype.getCustomSetupFunc=function(e,t){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,e),i.gl.uniform1f(r.maxLoc,t)}},n})(),gO=function(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},vO=function(n){this.outputShape=[],this.outputShape=Hd(n,1),this.variableNames=n.map((function(a,u){return"T"+u}));var e=new Array(n.length-1);e[0]=n[0][1];for(var t=1;t<e.length;t++)e[t]=e[t-1]+n[t][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(t=1;t<e.length;t++){var i=e[t-1];r.push("else if (yC < "+e[t]+") setOutput(getT"+t+"(yR, yC-"+i+"));")}var o=e.length,s=e[e.length-1];r.push("else setOutput(getT"+o+"(yR, yC-"+s+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},yO=function(n,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Hd(n,e);var t=this.outputShape,r=t.length,i=lr(r),o=As("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=n.map((function(x,E){return"T"+E}));var a=new Array(n.length-1);a[0]=n[0][e];for(var u=1;u<a.length;u++)a[u]=a[u-1]+n[u][e];var l=s[e],h=s.slice(-2),d=s.join(),p="if ("+l+" < "+a[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+h.join()+`));
        }`;for(u=1;u<a.length;u++){var m=a[u-1];p+=`
        if (`+l+" < "+a[u]+"  && "+l+" >= "+a[u-1]+`) {
          return getChannel(
            getT`+u+"("+zg(s,l,m)+`),
            vec2(`+zg(h,l,m)+`));
        }`}var w=a.length,b=a[a.length-1];p+=`
        return getChannel(
          getT`+w+"("+zg(s,l,b)+`),
          vec2(`+zg(h,l,b)+"));",this.userCode=`
      float getValue(`+s.map((function(x){return"int "+x}))+`) {
        `+p+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+o+`), 0., 0., 0.);

        `+o[r-1]+" = "+o[r-1]+` + 1;
        if (`+o[r-1]+" < "+t[r-1]+`) {
          result.g = getValue(`+o+`);
        }

        `+o[r-2]+" = "+o[r-2]+` + 1;
        if (`+o[r-2]+" < "+t[r-2]+`) {
          result.a = getValue(`+o+`);
        }

        `+o[r-1]+" = "+o[r-1]+` - 1;
        if (`+o[r-2]+" < "+t[r-2]+` &&
            `+o[r-1]+" < "+t[r-1]+`) {
          result.b = getValue(`+o+`);
        }
        setOutput(result);
      }
    `};function zg(n,e,t){var r=n.indexOf(e);return n.map((function(i,o){return o===r?i+" - "+t:i})).join()}var wO=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideHeight,t=n.strideWidth,r=n.padInfo.top,i=n.padInfo.left,o=n.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+i+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              if (`+o+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},bO=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=n.dataFormat==="channelsLast",s=e-1-n.padInfo.top,a=t-1-n.padInfo.left,u=o?1:2,l=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+h+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {

              if (`+o+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},xO=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideDepth,t=n.strideHeight,r=n.strideWidth,i=n.padInfo.front,o=n.padInfo.top,s=n.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yF = 0; yF < `+n.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+i+`;

            if (xF < 0 || xF >= `+n.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+n.outHeight+`; yR++) {
              int xR = wR + yR * `+t+" - "+o+`;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+n.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+s+`;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},_O=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterDepth,t=n.filterHeight,r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=e-1-n.padInfo.front,u=t-1-n.padInfo.top,l=r-1-n.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+a+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+n.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+t+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+t+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},EO=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideHeight,t=n.strideWidth,r=n.padInfo.top,i=n.padInfo.left,o=n.outChannels/n.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+o+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+i+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},SO=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=e-1-n.padInfo.top,s=t-1-n.padInfo.left,a=n.outChannels/n.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+a+`; dm++) {
              int d2 = d1 * `+a+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},BE=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var i=n.padInfo.top,o=n.padInfo.left,s=n.strideHeight,a=n.strideWidth,u=n.dilationHeight,l=n.dilationWidth,h=n.filterHeight,d=n.filterWidth,p=4*Math.floor(n.inChannels/4),m=n.inChannels%4,w=n.dataFormat==="channelsLast",b=w?1:2,x=w?2:3,E=w?3:1,A="",N="";t&&(A=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,N="result = activation(result);");var F=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+A+`

      const ivec2 strides = ivec2(`+s+", "+a+`);
      const ivec2 pads = ivec2(`+i+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+E+`];

        ivec2 xRCCorner =
            ivec2(coords[`+b+"], coords["+x+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+h+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+n.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+p+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+w+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(m===1)+`) {

              if (`+w+`) {
                dotProd +=
                    getX(batch, xR, xC, `+p+`) *
                    getW(wR, wC, `+p+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+p+`, xR, xC) *
                    getW(wR, wC, `+p+`, d2);
              }

            } else if (`+(m===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+p+`, d2),
                getW(wR, wC, `+p+` + 1, d2)
              );

              if (`+w+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+p+`),
                  getX(batch, xR, xC, `+p+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+p+`, xR, xC),
                  getX(batch, `+p+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(m===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+p+`, d2),
                getW(wR, wC, `+p+` + 1, d2),
                getW(wR, wC, `+p+` + 2, d2)
              );

              if (`+w+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+p+`),
                  getX(batch, xR, xC, `+p+` + 1),
                  getX(batch, xR, xC, `+p+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+p+`, xR, xC),
                  getX(batch, `+p+` + 1, xR, xC),
                  getX(batch, `+p+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+F+`
        `+N+`
        setOutput(result);
      }
    `},AO=function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var e=n.padInfo.front,t=n.padInfo.top,r=n.padInfo.left,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,h=n.filterDepth,d=n.filterHeight,p=n.filterWidth,m=4*Math.floor(n.inChannels/4),w=n.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+o+", "+s+`);
      const ivec3 pads = ivec3(`+e+", "+t+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+h+`; wF++) {
          int xF = xFCorner + wF * `+a+`;

          if (xF < 0 || xF >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+p+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+m+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(w===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+m+`) *
                  getW(wF, wR, wC, `+m+`, d2);
              } else if (`+(w===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+m+`),
                  getX(batch, xF, xR, xC, `+m+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+m+`, d2),
                  getW(wF, wR, wC, `+m+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(w===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+m+`),
                  getX(batch, xF, xR, xC, `+m+` + 1),
                  getX(batch, xF, xR, xC, `+m+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+m+`, d2),
                  getW(wF, wR, wC, `+m+` + 1, d2),
                  getW(wF, wR, wC, `+m+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},VE=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var i=n.inHeight,o=n.inWidth,s=n.padInfo.top,a=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,h=n.dilationHeight,d=n.dilationWidth,p=n.filterHeight,m=n.filterWidth,w=n.outChannels/n.inChannels,b="",x="";t&&(b=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,x="result = activation(result);");var E=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+b+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+w+`;
        int q = d2 - d1 * `+w+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+p+`; wR++) {
          int xR = xRCorner + wR * `+h+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+m+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+o+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+E+`
        `+x+`
        setOutput(result);
      }
    `},jE=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.outShape;for(var i=n.inHeight,o=n.inWidth,s=n.padInfo.top,a=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,h=n.dilationHeight,d=n.dilationWidth,p=n.filterHeight,m=n.filterWidth,w=m,b="int xR; int xC; int xCOffset;",x=0;x<p;x++)for(var E=0;E<m;E++)b+=`
          vec4 xTexelR`+x+"C"+2*E+` = vec4(0.);
          vec4 wR`+x+"C"+E+` = vec4(0.);
          vec4 xR`+x+"C"+E+" = vec4(0.);";for(x=0;x<p;x++)for(var A=0;A<w;A++){if(b+=`
          xR = xRCorner + `+x*h+`;
          xC = xCCorner + `+(E=2*A)*d+`;
        `,l===1){if(E<m&&(b+=a%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    xTexelR`+x+"C"+E+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+x+"C"+E+" = vec4(previous.zw, xTexelR"+x+"C"+E+`.xy);
                } else {
                  xR`+x+"C"+E+" = vec4(0, 0, xTexelR"+x+"C"+E+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                xR`+x+"C"+E+" = xTexelR"+x+"C"+E+`;
              `,E+1<m)){var N=a%2==0?o3(d):d;d%2==0&&a%2==1||d%2!=0&&a%2!=1?(b+=`
                  xCOffset = xC + `+a%2+" + "+N+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(b+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+o+`) {
                      xTexelR`+x+"C"+E+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+x+"C"+E+` = vec4(0.);
                    }
                  `),b+=`
                  xR`+x+"C"+(E+1)+` = vec4(
                    xTexelR`+x+"C"+E+".zw, xTexelR"+x+"C"+(E+2)+`.xy);
                `):b+=`
                  xCOffset = xC + `+N+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+x+"C"+(E+1)+" = xTexelR"+x+"C"+(E+2)+`;
                `}}else E<m&&(b+=`
              if(xR >= 0 && xR < `+i+`) {
            `,a%2==1?(b+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+o+`) {
                  xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+x+"C"+(E+2)+` = vec4(0.);
                }

                xR`+x+"C"+E+` = vec4(
                  xTexelR`+x+"C"+E+".zw, xTexelR"+x+"C"+(E+2)+`.zw);
              `,E+1<m&&(b+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+o+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+x+"C"+(E+1)+" = vec4(xTexelR"+x+"C"+(E+2)+`.xy, final.xy);
                `)):(b+=`
                if(xC >= 0 && xC < `+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+x+"C"+(E+2)+` = vec4(0.);
                }

                xR`+x+"C"+E+` = vec4(
                  xTexelR`+x+"C"+E+".xy, xTexelR"+x+"C"+(E+2)+`.xy);
              `,E+1<m&&(b+=`
                  xR`+x+"C"+(E+1)+` = vec4(
                    xTexelR`+x+"C"+E+".zw, xTexelR"+x+"C"+(E+2)+`.zw);
                `)),b+="}");E<m&&(b+=`
            vec4 wTexelR`+x+"C"+E+" = getW("+x+", "+E+`, d1, q);
            wR`+x+"C"+E+" = vec4(wTexelR"+x+"C"+E+".xz, wTexelR"+x+"C"+E+`.xz);
          `,E+1<m&&(b+=`
              vec4 wTexelR`+x+"C"+(E+1)+" = getW("+x+", "+(E+1)+`, d1, q);
              wR`+x+"C"+(E+1)+` =
                vec4(wTexelR`+x+"C"+(E+1)+".xz, wTexelR"+x+"C"+(E+1)+".xz);"))}for(x=0;x<p;x++)for(E=0;E<m;E++)b+="dotProd += xR"+x+"C"+E+" * wR"+x+"C"+E+";";var F="",D="";t&&(F=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`vec4 activation(vec4 x) {
          `+t+`
        }`,D="result = activation(result);");var W=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+F+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+b+`

        vec4 result = dotProd;
        `+W+`
        `+D+`
        setOutput(result);
      }
    `},CO=function(n,e,t,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=n[0],s=n[1],a=n[2],u=n[3],l=e[0],h=t[0],d=t[1];this.outputShape=[l,h,d,u];var p=r==="bilinear"?1:0,m=[s-1+".0",a-1+".0"],w=m[0],b=m[1],x=h>1?[""+(s-1)/(h-1),"(y2-y1) * height_ratio","y1*"+w+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+w],E=x[0],A=x[1],N=x[2],F=d>1?[""+(a-1)/(d-1),"(x2-x1) * width_ratio","x1*"+b+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+b],D=F[0],W=F[1],k=F[2];this.userCode=`
      const float height_ratio = float(`+E+`);
      const float width_ratio = float(`+D+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+o+`) {
          return;
        }

        float height_scale = `+A+`;
        float width_scale = `+W+`;

        float in_y = `+N+`;
        if( in_y < 0.0 || in_y > `+w+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+k+`;
        if( in_x < 0.0 || in_x > `+b+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+p+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},IO=function(n,e,t){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=n[n.length-1],o=t?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(t?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+lr(r)+` coords = getOutputCoords();
        int end = `+UE(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+o+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+UE(r,"coords")+` = idx;
          val += getX(`+(function(s,a){if(s===1)return""+a;if(s===2)return a+".x, "+a+".y";if(s===3)return a+".x, "+a+".y, "+a+".z";if(s===4)return a+".x, "+a+".y, "+a+".z, "+a+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")})(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function UE(n,e){if(n===1)return""+e;if(n===2)return e+".y";if(n===3)return e+".z";if(n===4)return e+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}var TO=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=dm.DENSE;var e=Yp(n),t=Fo();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+af(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+t.output+` = result;
      }
    `},kO=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=dm.DENSE;var e=Yp(n),t=Fo();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+af(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+t.output+` = result;
      }
    `},NO=(function(){function n(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+t+`;
      int offset_h = imod(h, `+t+`);
      int in_w = w / `+t+`;
      int offset_w = imod(w, `+t+`);
      int offset_d = (offset_h * `+t+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return n.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},n.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},n.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},n.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},n.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},n})(),PO=function(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},RO=function(n){this.variableNames=["A"],this.outTexUsage=Ys.DOWNLOAD;var e=Fo();this.outputShape=n,this.userCode=`
      `+B3+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `},DO=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ys.DOWNLOAD;var e=Fo();this.outputShape=n,this.userCode=`
      `+B3+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `},LO=function(n,e,t){t===void 0&&(t=!1),this.variableNames=["A"];var r=Fo(),i=e[0],o=e[1];this.outputShape=n;var s="result";t&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      `+xb(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+o+`;
        int c = imod(flatIndex, `+o+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+s+`, 0., 0., 0.);
      }
    `},MO=function(n,e,t){t===void 0&&(t=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Fo(),i=e[0],o=e[1];this.outputShape=n;var s="",a="result";t&&(a="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var h=2*u+l;s+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+n[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+n[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+o+`;
              c = imod(flatIndex, `+o+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+h+`] = values[0];
              } else if(offset == 1) {
                result[`+h+`] = values[1];
              } else if(offset == 2) {
                result[`+h+`] = values[2];
              } else {
                result[`+h+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+xb(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+s+`

        `+r.output+" = "+a+`;
      }
    `},FO="return real * expR - imag * expI;",OO="return real * expI + imag * expR;",zE=function(n,e,t){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=t?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=t?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+n+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+o+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},BO=(function(){function n(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;return function(r,i){t.valueLoc==null&&(t.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(t.valueLoc,e)}},n})(),VO=function(n,e,t){this.variableNames=["A","indices"];var r=n.slice();r[t]=e,this.outputShape=r,this.rank=r.length;var i=lr(this.rank),o=(function(s,a){var u=s.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],h=[],d=0;d<s.length;d++)d===a?h.push("int(getIndices("+l[d]+"))"):h.push(""+l[d]);return h.join()})(n,t);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},jO=function(n,e,t){this.sliceDim=n,this.strides=e,this.variableNames=["x","indices"],this.outputShape=t;var r=lr(e.length),i=lr(t.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+o+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function UO(n,e){var t=Fo();return FM(n,e,t.version+`
    precision highp float;
    `+t.attribute+` vec3 clipSpacePos;
    `+t.attribute+` vec2 uv;
    `+t.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function zO(n,e){return UM(n,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function WO(n,e){return zM(n,e,new Uint16Array([0,1,2,2,1,3]))}function Mm(n,e,t,r,i,o,s){qM(t,r);var a=WM(n,e),u=n.TEXTURE_2D;return Ft(n,e,(function(){return n.bindTexture(u,a)})),Ft(n,e,(function(){return n.texParameteri(u,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)})),Ft(n,e,(function(){return n.texParameteri(u,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)})),Ft(n,e,(function(){return n.texParameteri(u,n.TEXTURE_MIN_FILTER,n.NEAREST)})),Ft(n,e,(function(){return n.texParameteri(u,n.TEXTURE_MAG_FILTER,n.NEAREST)})),Ft(n,e,(function(){return n.texImage2D(u,0,i,t,r,0,o,s,null)})),Ft(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,null)})),a}function qO(n,e,t,r,i){var o=S0(t,r);return Mm(n,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,n.FLOAT)}function HO(n,e,t,r,i){var o=S0(t,r);return Mm(n,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function GO(n,e,t,r,i){var o=S0(t,r);return Mm(n,e,o[0],o[1],n.RGBA,n.RGBA,n.UNSIGNED_BYTE)}function $O(n,e,t,r,i){var o=Lm(t,r);return Mm(n,e,o[0],o[1],i.internalFormatPackedFloat,n.RGBA,n.FLOAT)}function KO(n,e,t,r,i){var o=Lm(t,r);return Mm(n,e,o[0],o[1],i.internalFormatPackedHalfFloat,n.RGBA,i.textureTypeHalfFloat)}function XO(n,e,t,r){return Ft(n,e,(function(){return n.bindBuffer(n.ARRAY_BUFFER,r)})),kE(n,e,t,"clipSpacePos",r,3,20,0)&&kE(n,e,t,"uv",r,2,20,12)}function YO(n,e,t,r,i,o,s){var a,u,l;Ft(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,t)})),o instanceof Uint8Array?(a=new Uint8Array(r*i*4),u=n.UNSIGNED_BYTE,l=n.RGBA):(a=new Float32Array(r*i*4),u=n.FLOAT,l=s.internalFormatPackedFloat),a.set(o),Ft(n,e,(function(){return n.texImage2D(n.TEXTURE_2D,0,l,r,i,0,n.RGBA,u,a)})),Ft(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,null)}))}function JO(n,e,t,r){Ft(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,t)})),r.data instanceof Uint8Array?Ft(n,e,(function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r.width,r.height,0,n.RGBA,n.UNSIGNED_BYTE,r.data)})):Ft(n,e,(function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)})),Ft(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,null)}))}function QO(n,e,t,r,i){var o=n.createBuffer();Ft(n,e,(function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,o)}));var s=16*t*r;return Ft(n,e,(function(){return n.bufferData(n.PIXEL_PACK_BUFFER,s,n.STREAM_READ)})),Ft(n,e,(function(){return n.readPixels(0,0,r,t,n.RGBA,n.FLOAT,0)})),Ft(n,e,(function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,null)})),o}function ZO(n,e,t){var r=n,i=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function e8(n,e,t,r,i){var o=S0(t,r),s=o[0],a=o[1],u=new Uint8Array(t*r*4);return Ft(n,e,(function(){return n.readPixels(0,0,s,a,i.downloadTextureFormat,n.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function t8(n,e,t,r,i,o,s,a){var u=n,l=new Float32Array((function(h,d){var p=Lm(h,d);return p[0]*p[1]*4})(o,s));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function n8(n,e,t,r){var i=new Float32Array(t*r*4);return Ft(n,e,(function(){return n.readPixels(0,0,r,t,n.RGBA,n.FLOAT,i)})),i}var r8=(function(){function n(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=Ye().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,PM(t,e)):this.gl=hl(t);var r="WEBGL_color_buffer_float";if(Ye().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Bg(this.gl,this.debug,"OES_texture_float"),Ra(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Bg(this.gl,this.debug,"OES_texture_half_float");else if(Ye().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Ra(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Bg(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Ye().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Ra(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Ra(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=zO(this.gl,this.debug),this.indexBuffer=WO(this.gl,this.debug),this.framebuffer=HM(this.gl,this.debug),this.textureConfig=hb(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(n.prototype,"debug",{get:function(){return Ye().getBool("DEBUG")},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Ft(t,this.debug,(function(){return t.finish()})),Ft(t,this.debug,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Ft(t,this.debug,(function(){return t.deleteFramebuffer(e.framebuffer)})),Ft(t,this.debug,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),Ft(t,this.debug,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),Ft(t,this.debug,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},n.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),qO(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),HO(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),GO(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),JO(this.gl,this.debug,e,t)},n.prototype.uploadDenseMatrixToTexture=function(e,t,r,i){this.throwIfDisposed(),YO(this.gl,this.debug,e,t,r,i,this.textureConfig)},n.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),KO(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),$O(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(NE(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Ft(this.gl,this.debug,(function(){return t.gl.deleteTexture(e)}))},n.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,r){var i=this;return this.downloadMatrixDriver(e,(function(){return e8(i.gl,i.debug,t,r,i.textureConfig)}))},n.prototype.downloadPackedMatrixFromBuffer=function(e,t,r,i,o,s){return t8(this.gl,e,0,0,0,o,s,this.textureConfig)},n.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return ZO(this.gl,e,t)},n.prototype.createBufferFromTexture=function(e,t,r){this.bindTextureToFrameBuffer(e);var i=QO(this.gl,this.debug,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},n.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},n.prototype.createFence=function(e){var t,r,i=this;if(Ye().getBool("WEBGL_FENCE_API_ENABLED")){var o=e,s=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=function(){var a=o.clientWaitSync(s,0,0);return a===o.ALREADY_SIGNALED||a===o.CONDITION_SATISFIED},t=s}else Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(t,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:t,isFencePassed:r}},n.prototype.downloadMatrixFromPackedTexture=function(e,t,r){var i=this;return this.downloadMatrixDriver(e,(function(){return n8(i.gl,i.debug,t,r)}))},n.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,r=OM(t,this.debug,e),i=UO(t,this.debug),o=VM(t,this.debug);return Ft(t,this.debug,(function(){return t.attachShader(o,i)})),Ft(t,this.debug,(function(){return t.attachShader(o,r)})),jM(t,this.debug,o),this.debug&&gy(t,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=XO(t,this.debug,this.program,this.vertexBuffer)),o},n.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&Ft(this.gl,this.debug,(function(){return t.gl.deleteProgram(e)}))},n.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&gy(this.gl,this.debug,this.program),Ft(this.gl,this.debug,(function(){return t.gl.useProgram(e)}))},n.prototype.getUniformLocation=function(e,t,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?$M(this.gl,this.debug,e,t):KM(this.gl,e,t)},n.prototype.getAttributeLocation=function(e,t){var r=this;return this.throwIfDisposed(),Ft(this.gl,this.debug,(function(){return r.gl.getAttribLocation(e,t)}))},n.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},n.prototype.setInputMatrixTexture=function(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),XM(this.gl,this.debug,this.program,e,t,r)},n.prototype.setOutputMatrixTexture=function(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)},n.prototype.setOutputPackedMatrixTexture=function(e,t,r){this.throwIfDisposed();var i=Lm(t,r),o=i[0],s=i[1];this.setOutputMatrixTextureDriver(e,o,s)},n.prototype.setOutputMatrixWriteRegion=function(e,t,r,i){this.setOutputMatrixWriteRegionDriver(r,e,i,t)},n.prototype.setOutputPackedMatrixWriteRegion=function(e,t,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},n.prototype.debugValidate=function(){this.program!=null&&gy(this.gl,this.debug,this.program),Vg(this.gl)},n.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),Ft(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},n.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),Ft(this.gl,this.debug,(function(){return e.gl.finish()}))},n.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Bg(this.gl,this.debug,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},n.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},n.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},n.prototype.beginQuery=function(){if(Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),r=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),o=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,o),o},n.prototype.endQuery=function(){if(Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT)}},n.prototype.waitForQueryAndGetTime=function(e){return kt(this,void 0,void 0,(function(){var t=this;return Nt(this,(function(r){switch(r.label){case 0:return[4,EE((function(){return t.disposed||t.isQueryAvailable(e,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return r.sent(),[2,this.getQueryTime(e,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},n.prototype.getQueryTime=function(e,t){if(t===0)return null;if(t===2){var r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(e,i.QUERY_RESULT_EXT)/1e6},n.prototype.isQueryAvailable=function(e,t){if(t===0)return!0;if(t===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint},n.prototype.pollFence=function(e){var t=this;return new Promise((function(r){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return r()}))}))},n.prototype.pollItems=function(){for(var e=(function(r){for(var i=0;i<r.length&&r[i]();++i);return i-1})(this.itemsToPoll.map((function(r){return r.isDoneFn}))),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},n.prototype.addItemToPoll=function(e,t){var r=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||EE((function(){return r.pollItems(),r.itemsToPoll.length===0}))},n.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),vy(this.gl,this.debug,e,this.framebuffer),this.debug&&Vg(this.gl)},n.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(vy(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Vg(this.gl)):NE(this.gl,this.debug,this.framebuffer)},n.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var r=t();return this.unbindTextureToFrameBuffer(),r},n.prototype.setOutputMatrixTextureDriver=function(e,t,r){this.throwIfDisposed();var i=this.gl;vy(i,this.debug,e,this.framebuffer),this.debug&&Vg(i),this.outputTexture=e,Ft(i,this.debug,(function(){return i.viewport(0,0,t,r)})),Ft(i,this.debug,(function(){return i.scissor(0,0,t,r)}))},n.prototype.setOutputMatrixWriteRegionDriver=function(e,t,r,i){var o=this;this.throwIfDisposed(),Ft(this.gl,this.debug,(function(){return o.gl.scissor(e,t,r,i)}))},n.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},n.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},n})();function WE(n,e){if(n.length!==e.length)throw Error("Binary was compiled with "+n.length+" inputs, but was executed with "+e.length+" inputs");n.forEach((function(t,r){var i=t.logicalShape,o=e[r],s=o.shape;if(!qi(i,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+s+" must match");if(!t.isUniform||!o.isUniform){var a=t.texShape,u=o.isUniform?null:o.texData.texShape;if(!qi(a,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+u+" must match")}}))}var i8=function(n,e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var r=t.filterWidth,i=t.inChannels,o=t.strideWidth,s=t.strideHeight,a=t.padInfo,u=t.outWidth,l=t.dilationWidth,h=t.dilationHeight,d=t.dataFormat,p=a.left,m=a.top,w=i*r,b=Fo(),x=d==="channelsLast",E=x?0:1,A=x?1:2,N="",F=0;F<=1;F++)for(var D=0;D<=1;D++)N+=`
          blockIndex = rc.y + `+D+`;
          pos = rc.x + `+F+`;

          if(blockIndex < `+n[1]+" && pos < "+n[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+s+" - "+m+`;
            d0 = offsetY + `+h+" * (pos / "+w+`);

            if(d0 < `+e[E]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+o+". - "+p+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+w+".) / "+i+`.));

              if(d1 < `+e[A]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+x+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*F+D)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*F+D)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+N+`

        `+b.output+` = result;
      }
    `},o8=function(n,e,t,r,i){this.variableNames=["x"],this.outputShape=[];var o,s=e,a=n[3]-1;this.outputShape=n;var u="float("+t+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+s+"; j <= "+s+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+a+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+o+`;
        setOutput(val);
      }
    `},s8=function(n,e,t,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=e,this.bias=t,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+t+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},a8=function(n,e,t,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=e,a=n[3]-1;this.outputShape=n;var u="float("+t+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+s+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+s+"; j <= "+s+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+a+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+o+`;
        setOutput(result);
      }
    `},u8=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var e=n.strideHeight,t=n.strideWidth,r=n.dilationHeight,i=n.effectiveFilterHeight,o=n.effectiveFilterWidth,s=i-1-n.padInfo.top,a=o-1-n.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+o+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+t+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+o+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},l8=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var e=n.strideDepth,t=n.strideHeight,r=n.strideWidth,i=n.dilationDepth,o=n.dilationHeight,s=n.dilationWidth,a=n.effectiveFilterDepth,u=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=a-1-n.padInfo.front,d=u-1-n.padInfo.top,p=l-1-n.padInfo.left,m=a*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+d+", "+p+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+a+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+o+`) {
            float dyR = float(dyRCorner + wR) / `+t+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+m+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},_y=function(n,e,t,r,i,o,s){t===void 0&&(t=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),o===void 0&&(o=null),s===void 0&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var a=t?n[1]:n[2],u=Math.ceil(a/2),l=t?"i * 2, rc.y":"rc.y, i * 2",h=r?"rc.z, i * 2":"i * 2, rc.z",d=t?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",w="";o&&(m=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+o+`
        }`:`vec4 activation(vec4 x) {
          `+o+`
        }`,w="result = activation(result);");var b=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+m+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+h+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+p[0]+`);
          result += (`+d[1]+" * "+p[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+b+`

        `+w+`

        setOutput(result);
      }
    `},c8=(function(){function n(e,t,r){this.variableNames=["probs"],this.outputShape=[e,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(t-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(t-1)+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;return function(r,i){t.seedLoc==null&&(t.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(t.seedLoc,e)}},n})(),h8=function(n,e,t,r){this.variableNames=["indices"],this.outputShape=[n,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+t+`),
                      float(index == coords.y)));
      }
    `},f8=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n;var e=n.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var t=As("rc",e),r=lr(e),i=(function(a,u,l){if(a===1)return"rc > "+u[0];for(var h="",d=a-2;d<a;d++)h+=l[d]+" >= "+u[d],d<a-1&&(h+="||");return h})(e,n,t),o=(function(a,u,l,h){if(a===1)return"";var d=h.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `})(e,n[n.length-1],n[n.length-2],t),s=(function(a,u){var l=a.length,h=(function(d,p){for(var m=[],w=0;w<=1;w++)for(var b=0;b<=1;b++){for(var x=(w===0?"r":"rp1")+", "+(b===0?"c":"cp1"),E=2;E<d;E++)x=p[p.length-1-E]+","+x;m.push(x)}return m})(l,u);return l===1?`getA(rc),
            rc + 1 >= `+a[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+h[0]+`),
          cEdge ? 0. : getA(`+h[1]+`),
          rEdge ? 0. : getA(`+h[2]+`),
          rEdge || cEdge ? 0. : getA(`+h[3]+")"})(n,t);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+o+`

            setOutput(vec4(`+s+`));
          }
        }
      `}},d8=function(n,e,t){this.variableNames=["x"],this.outputShape=e.map((function(u,l){return u[0]+n[l]+u[1]}));var r=n.length,i=lr(r),o=e.map((function(u){return u[0]})).join(","),s=e.map((function(u,l){return u[0]+n[l]})).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+o+`);
      `+i+" end = "+i+"("+s+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+t+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+a+`));
        }
      }
    `:`
        int start = `+o+`;
        int end = `+s+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+t+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},p8=function(n,e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(x,E){return x[0]+n[E]+x[1]}));for(var r=n.length,i=lr(r),o=e.map((function(x){return x[0]})).join(","),s=e.map((function(x,E){return x[0]+n[E]})).join(","),a=As("rc",r),u=As("source",r),l=a[r-1]+" < "+this.outputShape[r-1],h=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[i+" rc = outputLoc;",a[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+a[r-2]+` += 1;
       if(`+a[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+a[r-1]+` += 1;
         if(`+l+") {"],p=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",m="",w=0,b=r===1?2:4;w<b;w++)m+=`
        `+d[w]+`
        if (`+p+`) {
          result[`+w+"] = float("+t+`);
        } else {
          `+i+` source = rc - start;
          result[`+w+"] = getChannel(getX("+u.join()+"), "+h+`);
        }
      `;m+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+o+`);
      const `+i+" end = "+i+"("+s+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+m+`
        setOutput(result);
      }
    `},Ey=function(n,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,i=n.strideHeight,o=n.strideWidth,s=n.dilationHeight,a=n.dilationWidth,u=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=n.padInfo.top,d=n.padInfo.left;this.outputShape=n.outShape;var p=e==="avg",m="0.0";if(p||(m="-1.0 / 1e-20"),t)this.userCode=`
        const ivec2 strides = ivec2(`+i+", "+o+`);
        const ivec2 pads = ivec2(`+h+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+s+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var w=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(w="avgValue / count");var b=4*Math.floor(r/4),x=r%4,E=`
      if (`+p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+i+", "+o+`);
      const ivec2 pads = ivec2(`+h+", "+d+`);
      const float initializationValue = `+m+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+m+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+s+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+a+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              getValue(batch, xR, xC + 2 * `+a+`, d),
              getValue(batch, xR, xC + 3 * `+a+`, d)
            );

            `+E+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(x===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+E+`
          } else if (`+(x===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              initializationValue,
              initializationValue
            );

            `+E+`
          } else if (`+(x===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              getValue(batch, xR, xC + 2 * `+a+`, d),
              initializationValue
            );

            `+E+`
          }
        }
        setOutput(`+w+`);
      }
    `}},Sy=function(n,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,h=n.effectiveFilterDepth,d=n.effectiveFilterHeight,p=n.effectiveFilterWidth,m=n.padInfo.front,w=n.padInfo.top,b=n.padInfo.left;this.outputShape=n.outShape;var x=e==="avg",E="0.0";if(x||(E="-1.0 / 1e-20"),t)this.userCode=`
        const ivec3 strides =
            ivec3(`+i+", "+o+", "+s+`);
        const ivec3 pads = ivec3(`+m+", "+w+", "+b+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+h+`;
              wD += `+a+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+n.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+p+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+p+` +
                      wR * `+p+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var A=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(A="avgValue / count");var N=4*Math.floor(r/4),F=r%4,D=`
      if (`+x+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+i+", "+o+", "+s+`);
      const ivec3 pads = ivec3(`+m+", "+w+", "+b+`);
      const float initializationValue = `+E+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+E+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+h+`;
            wD += `+a+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+N+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+D+`
            }

            int xC = xCCorner + `+N+`;
            if (`+(F===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+D+`
            } else if (`+(F===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+D+`
            } else if (`+(F===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+D+`
            }
          }
          setOutput(`+A+`);
        }
      }
    `}},m8=function(n,e){this.variableNames=["x"];var t=n.windowSize,r=n.batchSize,i=n.inSize,o=Math.ceil(i/t);this.outputShape=[r,o];var s="0.0",a="";e==="prod"?s="1.0":e==="min"?(s="1.0 / 1e-20",a="min"):e==="max"&&(s="-1.0 / 1e-20",a="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?u="sumValue":e==="prod"?u="prodValue":e==="all"?u="allValue":e==="any"&&(u="anyValue");var l=4*Math.floor(t/4),h=t%4,d=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+a+`(values, minMaxValue);
      }
    `,p="vec4";e==="all"?(s="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):e==="any"&&(s="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");var m="";i%t>0&&(m=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+s+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+m+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+t+`;

        vec4 minMaxValue = vec4(`+s+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(h===1)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(h===2)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(h===3)+`) {
          `+p+" values = "+p+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},g8=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var t="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),t+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+af(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+xb(n)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+n[1]+`;
        int cols = `+n[2]+`;

        `+t+`

        setOutput(result);
      }
    `},v8=function(n,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=n.shape,a=s[1],u=s[2],l=[t&&a>1?i-1:i,t&&u>1?o-1:o],h=[t&&a>1?a-1:a,t&&u>1?u-1:u],d=l[0]/h[0],p=l[1]/h[1],m=1/d,w=1/p,b=2*Math.ceil(m)+2,x=2*Math.ceil(w)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+p+`);

        const float invHeightScale = float(`+m+`);
        const float invWidthScale = float(`+w+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+x+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+a+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(o-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},y8=function(n,e,t,r){this.variableNames=["A"],this.outputShape=[];var i=n[0],o=n[1],s=n[2],a=n[3];this.outputShape=[i,e,t,a];var u=[r&&e>1?o-1:o,r&&t>1?s-1:s],l=[r&&e>1?e-1:e,r&&t>1?t-1:t];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},w8=function(n,e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=n[0],o=n[1],s=n[2],a=n[3];this.outputShape=[i,e,t,a];var u=[r&&e>1?o-1:o,r&&t>1?s-1:s],l=[r&&e>1?e-1:e,r&&t>1?t-1:t];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+o+".0, "+s+`.0,
                                     `+s+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(a-1)+`;
        bool hasNextRow = coords.z < `+(t-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},b8=function(n,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=n.shape,a=s[1],u=s[2],l=[t&&a>1?i-1:i,t&&u>1?o-1:o],h=[t&&a>1?a-1:a,t&&u>1?u-1:u],d=l[0]/h[0],p=l[1]/h[1],m=1/d,w=1/p,b=2*Math.ceil(m)+2,x=2*Math.ceil(w)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+p+`);

        const float invHeightScale = float(`+m+`);
        const float invWidthScale = float(`+w+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+x+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+a+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+h[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+h[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+t+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+o+`) - 1),
                `+t+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},x8=function(n,e,t,r){this.variableNames=["A"],this.outputShape=[];var i=n[0],o=n[1],s=n[2],a=n[3];this.outputShape=[i,e,t,a];var u=[r&&e>1?o-1:o,r&&t>1?s-1:s],l=[r&&e>1?e-1:e,r&&t>1?t-1:t],h=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+h+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},_8=function(n,e){this.variableNames=["x"];var t=n.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");if(this.outputShape=n,t!==1){var r=n.map((function(o,s){return(function(a){return e.indexOf(a)!==-1&&n[a]!==1?n[a]+" - coords["+a+"] - 1":"coords["+a+"]"})(s)})).join(","),i=lr(t);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+n[0]+` - coord - 1));
        }
      `},E8=function(n,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var t=n.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");this.outputShape=n;var r=As("rc",t),i=r[t-1]+" + 1 < "+this.outputShape[t-1],o=r[t-2]+" + 1 < "+this.outputShape[t-2],s=lr(t);function a(u){var l=n.map((function(h,d){return(function(p,m){return e.indexOf(p)!==-1&&n[p]!==1?n[p]+" - "+m[p]+" - 1":""+m[p]})(d,u)}));return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=t===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+n[0]+` - rc - 1),
            `+n[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+n[0]+` - (rc  + 1) - 1),
                `+n[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+s+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+(function(u){return a(u)})(r.slice())+`;
          if(`+i+`){
            result.g = `+(function(u){return u[t-1]="("+u[t-1]+" + 1)",a(u)})(r.slice())+`;
          }
          if(`+o+`) {
            result.b = `+(function(u){return u[t-2]="("+u[t-2]+" + 1)",a(u)})(r.slice())+`;
            if(`+i+`) {
              result.a = `+(function(u){return u[t-1]="("+u[t-1]+" + 1)",u[t-2]="("+u[t-2]+" + 1)",a(u)})(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},qE=function(n,e,t,r,i,o,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var a=lr(i.length),u=lr(o.length),l="";t===1?l="i":t===2&&(l="i, j");var h="getIndices("+l+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var p="getUpdates("+d+")",m=e>1?"strides[j]":"strides";this.userCode=`
        `+a+" strides = "+a+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+n+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+h+`);
              flattenedIndex += index * `+m+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+p+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},S8=function(n,e){this.variableNames=["x","segmentIds"];var t=n.windowSize,r=n.batchSize,i=n.inSize,o=n.numSegments,s=o*Math.ceil(i/t);this.outputShape=[r,s];var a=4*Math.floor(t/4),u=t%4,l=`
        sumValue += dot(values, segFilter);
    `,h="";i%t>0&&(h=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var d="";i%t>0&&(d=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+o+")) * float("+t+`));
        int currentSeg = int(mod(float(outIdx), float(`+o+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+a+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+a+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},A8=function(n,e,t){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,t>4)throw Error("Where for rank "+t+" is not yet supported");if(t===1)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],a=[],u=0;u<e.length;u++)a.push(""+o[u]),u<n&&s.push(""+o[u]);r=s.join(),i=a.join()}var l=lr(t);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `},C8=(function(){function n(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,r=lr(this.rank),i="uniform int start["+this.rank+"];",o=(function(s){if(s===1)return"sourceLoc";if(s<=6)return Ay.slice(0,s).map((function(a){return"sourceLoc."+a})).join(",");throw Error("Slicing for rank "+s+" is not yet supported")})(this.rank);t=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+e.map((function(s,a){return"sourceLoc."+Ay[a]+" = start["+a+"] + coords."+Ay[a]+";"})).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+t+`
        setOutput(getSource(`+o+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,i){t.startLoc==null&&(t.startLoc=r.getUniformLocationNoThrow(i,"start"),t.startLoc==null)||r.gl.uniform1iv(t.startLoc,e)}},n})(),Ay=["x","y","z","w","u","v"],I8=(function(){function n(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=lr(this.rank),r=As("coords",this.rank),i=As("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",s="getChannel(getSource("+i.join()+"), "+o+")",a=`
      result.x = `+s+`;
      if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+s+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+s+`;
        if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+s+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+t+"("+e.map((function(h,d){return"start["+d+"]"})).join()+");":e.map((function(h,d){return i[d]+" = "+r[d]+" + start["+d+"];"})).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+t+` coords = getOutputCoords();
        `+t+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+a+`
        `+u+`
        setOutput(result);
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,i){t.startLoc==null&&(t.startLoc=r.getUniformLocationNoThrow(i,"start"),t.startLoc==null)||r.gl.uniform1iv(t.startLoc,e)}},n})(),T8=function(n,e,t){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=lr(t.length),o=lr(t.length),s="";if(r===1)s="coords * strides + begin";else{var a=0;s=t.map((function(u,l){return a++,t.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(a-1)+"] * strides["+l+"] + begin["+l+"]"})).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+n+`);
      `+i+" strides = "+i+"("+e+`);

      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+s+`));
      }
    `},k8=(function(){function n(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return n.prototype.acquireTexture=function(e,t,r){var i,o=HE(t,r),s=GE(e,o,r);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[s].shift();return this.usedTextures[s].push(a),a}return this.numUsedTextures++,this.log(),o===Xs.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===Xs.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===Xs.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===Xs.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===Xs.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[s].push(i),i},n.prototype.releaseTexture=function(e,t,r,i){if(this.freeTextures!=null){var o=GE(t,HE(r,i),i);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(e),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[o],a=s.indexOf(e);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(a,1),this.log()}},n.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},n.prototype.getNumUsedTextures=function(){return this.numUsedTextures},n.prototype.getNumFreeTextures=function(){return this.numFreeTextures},n.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(r){e.gpgpu.deleteMatrixTexture(r)}));for(var t in this.usedTextures)this.usedTextures[t].forEach((function(i){e.gpgpu.deleteMatrixTexture(i)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},n})();function HE(n,e){if(n===Ys.UPLOAD)return Xs.PACKED_2X2_FLOAT32;if(n===Ys.RENDER||n==null)return(function(t){return Ye().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Xs.PACKED_2X2_FLOAT32:Xs.UNPACKED_FLOAT32:t?Xs.PACKED_2X2_FLOAT16:Xs.UNPACKED_FLOAT16})(e);if(n===Ys.DOWNLOAD||n===Ys.PIXELS)return Xs.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+n)}function GE(n,e,t){return n[0]+"_"+n[1]+"_"+e+"_"+t}var N8=function(n,e){this.variableNames=["A"];for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[r]*e[r];this.outputShape=t,this.rank=t.length;var i=lr(this.rank),o=(function(s){var a=s.length;if(a>5)throw Error("Tile for rank "+a+" is not yet supported");if(a===1)return"imod(resRC, "+s[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],h=0;h<s.length;h++)l.push("imod("+u[h]+", "+s[h]+")");return l.join()})(n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},P8=function(n,e){this.variableNames=["A"];for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[e[r]];this.outputShape=t,this.rank=t.length;var i=lr(this.rank),o=(function(s){var a=s.length;if(a>6)throw Error("Transpose for rank "+a+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(a),h=0;h<s.length;h++)l[s[h]]=u[h];return l.join()})(e);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+o+`));
    }
    `},R8=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[e[r]];if(this.outputShape=t,this.rank=t.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=lr(this.rank),o=O3("rc",this.rank),s=new Array(this.rank);for(r=0;r<e.length;r++)s[e[r]]=o[r];var a="vec2("+s.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+t[this.rank-1],l="getChannel(getA("+s.join()+"), "+a+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+o[this.rank-1]+`;
      if(++`+o[this.rank-2]+" < "+t[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},_b=1.7580993408473768,Eb=1.0507009873554805,pn=function(n,e){this.variableNames=["A"],this.outputShape=n,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},wu="if (isnan(x)) return x;",D8="return x;",$E="return abs(x);",z3=wu+`
  return (x < 0.0) ? 0.0 : x;
`,W3=wu+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,q3="return (x >= 0.0) ? x : (exp(x) - 1.0);",L8=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+_b+`;
  float scale = `+Eb+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,KE="return -x;",XE="return ceil(x);",YE="return floor(x);",JE="return exp(x);",QE="return exp(x) - 1.0;",M8=wu+`
  return sin(x);
`,F8=wu+`
  return cos(x);
`,O8=wu+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,B8=wu+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,V8=wu+`
  return atan(x);
`,j8=wu+"return log(x + sqrt(x * x + 1.0));",U8=wu+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,z8=wu+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Wg="return x;",W8="return x;",H3=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,G3=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,$3=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Lp=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},q8=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n;var e=n.length,t=As("rc",e),r=lr(e),i=(function(a,u){if(a===1)return"rc";for(var l="",h=0;h<a;h++)l+=u[h],h<a-1&&(l+=",");return l})(e,t),o=t.slice(-2),s=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+s+`));
      }
    `},qg={};function Hg(n,e){if(e===void 0&&(e=!1),n==="linear")return e?W8:D8;if(n==="relu")return e?H3:z3;if(n==="elu")return e?$3:q3;if(n==="relu6")return e?G3:W3;if(n==="prelu")return e?U3:j3;throw new Error("Activation "+n+" has not been implemented for the WebGL backend.")}var H8=600,G8=(function(n){function e(t){var r,i=n.call(this)||this;if(i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!Ye().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(t==null){var o=hl(Ye().getNumber("WEBGL_VERSION"));i.binaryCache=((r=Ye().getNumber("WEBGL_VERSION"))in qg||(qg[r]={}),qg[r]),i.gpgpu=new r8(o),i.canvas=o.canvas,i.gpgpuCreatedLocally=!0}else i.gpgpu=t,i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=t.gl.canvas;return i.textureManager=new k8(i.gpgpu),i.numMBBeforeWarning=Ye().global.screen==null?1024:Ye().global.screen.height*Ye().global.screen.width*window.devicePixelRatio*H8/1024/1024,i.texData=new T3(i,Te),i}return yu(e,n),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(t,r,i){if(Ye().getBool("DEBUG")&&this.checkNumericalProblems(t),i==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var o={};return this.texData.set(o,{shape:r,dtype:i,values:t,usage:Ys.UPLOAD}),o},e.prototype.move=function(t,r,i,o){if(Ye().getBool("DEBUG")&&this.checkNumericalProblems(r),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:i,dtype:o,values:r,usage:Ys.UPLOAD})},e.prototype.readSync=function(t){var r=this.texData.get(t),i=r.values,o=r.dtype,s=r.complexTensors,a=r.slice,u=r.shape,l=r.isPacked;if(a!=null){var h=void 0;h=l?new Lp(u,Wg):new pn(u,Wg);var d=this.runWebGLProgram(h,[{dataId:t,shape:u,dtype:o}],o),p=this.readSync(d.dataId);return this.disposeData(d.dataId),p}if(i!=null)return this.convertAndCacheOnCPU(t);if(o==="string")return i;var m,w,b=this.activeTimers!=null;return b&&(m=Gu()),o==="complex64"?w=L2(s.real.dataSync(),s.imag.dataSync()):w=this.getValuesFromTexture(t),b&&(this.downloadWaitMs+=Gu()-m),this.convertAndCacheOnCPU(t,w)},e.prototype.read=function(t){return kt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d,p,m,w,b,x,E,A,N,F,D,W,k,C;return Nt(this,(function(L){switch(L.label){case 0:if(this.pendingRead.has(t))return r=this.pendingRead.get(t),[2,new Promise((function(B){return r.push(B)}))];if(i=this.texData.get(t),o=i.values,s=i.shape,a=i.slice,u=i.dtype,l=i.complexTensors,h=i.isPacked,a!=null)return d=void 0,d=h?new Lp(s,Wg):new pn(s,Wg),p=this.runWebGLProgram(d,[{dataId:t,shape:s,dtype:u}],u),m=this.read(p.dataId),this.disposeData(p.dataId),[2,m];if(o!=null)return[2,this.convertAndCacheOnCPU(t)];if(!Ye().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Ye().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return w=null,u!=="complex64"&&Ye().get("WEBGL_BUFFER_SUPPORTED")&&(b=this.decode(t),x=this.texData.get(b.dataId),w=(C=this.gpgpu).createBufferFromTexture.apply(C,[x.texture].concat(Yp(s)))),this.pendingRead.set(t,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:L.sent(),L.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return A=L.sent(),N=A[0],F=A[1],E=L2(N,F),[3,5];case 4:w==null?E=this.getValuesFromTexture(t):(D=Dt(s),E=this.gpgpu.downloadFloat32MatrixFromBuffer(w,D)),L.label=5;case 5:return b!=null&&this.disposeData(b.dataId),W=this.convertAndCacheOnCPU(t,E),k=this.pendingRead.get(t),this.pendingRead.delete(t),k.forEach((function(B){return B(W)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,W]}}))}))},e.prototype.checkNumericalProblems=function(t){if(t!=null)for(var r=0;r<t.length;r++){var i=t[r];if(!LM(i))throw Ye().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(t){var r,i=this.texData.get(t),o=i.shape,s=i.dtype,a=i.isPacked,u=Dt(o);if(Ye().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(t),h=this.texData.get(l.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[h.texture].concat(Yp(o))).subarray(0,u);return this.disposeData(l.dataId),d}var p=Ye().getBool("WEBGL_PACK")&&a===!0,m=p?yy(o):o,w=p?new DO(m):new RO(m),b=this.runWebGLProgram(w,[{shape:m,dtype:s,dataId:t}],"float32"),x=this.texData.get(b.dataId),E=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(x.texture,x.texShape[0],x.texShape[1]).subarray(0,u);return this.disposeData(b.dataId),E},e.prototype.time=function(t){return kt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l;return Nt(this,(function(h){switch(h.label){case 0:return r=this.activeTimers,i=[],o=!1,this.programTimersStack==null?(this.programTimersStack=i,o=!0):this.activeTimers.push(i),this.activeTimers=i,t(),s=Wd(this.activeTimers.map((function(d){return d.query}))).filter((function(d){return d!=null})),a=Wd(this.activeTimers.map((function(d){return d.name}))).filter((function(d){return d!=null})),this.activeTimers=r,o&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(s)]:[3,2];case 1:return l=h.sent(),u.kernelMs=pM(l),u.getExtraProfileInfo=function(){return l.map((function(d,p){return{name:a[p],ms:d}})).map((function(d){return d.name+": "+d.ms})).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},h.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Gu(),endMs:null}},e.prototype.endTimer=function(t){return Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=Gu(),t)},e.prototype.getQueryTime=function(t){return kt(this,void 0,void 0,(function(){var r;return Nt(this,(function(i){return Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(r=t).endMs-r.startMs]}))}))},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var r=this.texData.get(t).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var r=this.texData.get(t),i=r.texture,o=r.dtype,s=r.texShape,a=r.usage,u=r.isPacked,l=r.slice,h=l&&l.origDataId||t,d=this.dataRefCount.get(h);d>1?this.dataRefCount.set(h,d-1):(this.dataRefCount.delete(h),i!=null&&(this.numBytesInGPU-=this.computeBytes(s,o),this.textureManager.releaseTexture(i,s,a,u)));var p=this.texData.get(t);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return Ye().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=Te.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&t.every((function(o){return i.texData.get(o.dataId).texture==null&&o.size<r}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,r){var i=this.makeOutput(t.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:Te.keep(t.clone()),imag:Te.keep(r.clone())},i},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,r,i){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,r,i);if(Dt(i)===0)return uo([],i,t.dtype);var o=this.texData.get(t.dataId).isPacked,s=C3(t.shape,r,i);if(o||!s){var a=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new I8(i):new C8(i),u=a.getCustomSetupFunc(r);return this.compileAndRun(a,[t],null,u)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,r,i)},e.prototype.shallowSlice=function(t,r,i){var o=this.texData.get(t.dataId),s=this.makeOutput(i,t.dtype),a=this.texData.get(s.dataId);Object.assign(a,o),a.shape=i,a.dtype=t.dtype;var u=I3(r,t.strides);o.slice&&(u+=o.slice.flatOffset),a.slice={flatOffset:u,origDataId:o.slice&&o.slice.origDataId||t.dataId};var l=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,l+1),s},e.prototype.stridedSlice=function(t,r,i,o){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,r,i,o);var s=gb(r,i,o);if(s.some((function(u){return u===0})))return uo([],s);var a=new T8(r,o,s);return this.compileAndRun(a,[t])},e.prototype.reverse=function(t,r){var i=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new E8(t.shape,r):new _8(t.shape,r);return this.compileAndRun(i,[t])},e.prototype.concat=function(t,r){if(t[0].dtype==="complex64"){var i=t.map((function(m){return Pa(m)})),o=t.map((function(m){return Ku(m)}));return oo(this.concat(i,r),this.concat(o,r))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,r);if(t.length===1)return t[0];if(t.length>Ye().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(t.length/2),a=this.concat(t.slice(0,s),r),u=this.concat(t.slice(s),r);return this.concat([a,u],r)}if(Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var l=new yO(t.map((function(m){return m.shape})),r);return this.compileAndRun(l,t)}var h=Hd(t.map((function(m){return m.shape})),r),d=t.map((function(m){return m.as2D(-1,Dt(m.shape.slice(r)))})),p=new vO(d.map((function(m){return m.shape})));return this.compileAndRun(p,d).reshape(h)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,KE,t.dtype);var r=new pn(t.shape,KE);return this.compileAndRun(r,[t])},e.prototype.batchMatMul=function(t,r,i,o){var s=i?t.shape[2]:t.shape[1],a=o?r.shape[1]:r.shape[2],u=i?t.shape[1]:t.shape[2],l=t.shape[0];if((s===1||a===1)&&u>1e3){i&&(t=t.transpose([0,2,1])),o&&(r=r.transpose([0,2,1]));var h=a===1?t:t.as3D(l,u,1),d=a===1?2:1,p=a===1?r.as3D(l,1,u):r;return this.multiply(h,p).sum(d,!0)}var m=so(t.dtype,r.dtype),w=new _y(t.shape,[l,s,a],i,o);return this.compileAndRun(w,[t,r],m)},e.prototype.fusedBatchMatMul=function(t){var r=t.a,i=t.b,o=t.transposeA,s=t.transposeB,a=t.bias,u=t.activation,l=t.preluActivationWeights,h=o?r.shape[2]:r.shape[1],d=s?i.shape[1]:i.shape[2],p=r.shape[0],m=so(r.dtype,i.dtype),w=a!=null,b=l!=null,x=u?Hg(u,!0):null,E=new _y(r.shape,[p,h,d],o,s,w,x,b),A=[r,i];return a&&A.push(a),l&&A.push(l),this.compileAndRun(E,A,m)},e.prototype.multiply=function(t,r){if(t.dtype==="complex64"){var i=this.texData.get(t.dataId),o=this.texData.get(r.dataId),s=new FE(fO,t.shape,r.shape),a=new FE(dO,t.shape,r.shape),u=[this.makeComplexComponentTensorInfo(t,i.complexTensors.real),this.makeComplexComponentTensorInfo(t,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,o.complexTensors.real),this.makeComplexComponentTensorInfo(r,o.complexTensors.imag)],l=this.compileAndRun(s,u),h=this.compileAndRun(a,u),d=this.complex(l,h);return l.dispose(),h.dispose(),d}if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.multiply(t,r);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,OE,t.dtype);var p=new Ur(OE,t.shape,r.shape);return this.compileAndRun(p,[t,r],t.dtype)},e.prototype.batchNormalization=function(t,r,i,o,s,a){var u=[t,r,i],l=null;a!=null&&(l=a.shape,u.push(a));var h=null;if(s!=null&&(h=s.shape,u.push(s)),Ye().getBool("WEBGL_PACK_NORMALIZATION")){var d=new hO(t.shape,r.shape,i.shape,l,h,o);return this.compileAndRun(d,u)}var p=new cO(t.shape,r.shape,i.shape,l,h,o);return this.compileAndRun(p,u)},e.prototype.localResponseNormalization4D=function(t,r,i,o,s){var a=Ye().getBool("WEBGL_PACK_NORMALIZATION")?new a8(t.shape,r,i,o,s):new o8(t.shape,r,i,o,s);return this.compileAndRun(a,[t])},e.prototype.LRNGrad=function(t,r,i,o,s,a,u){var l=new s8(r.shape,o,s,a,u);return this.compileAndRun(l,[r,i,t])},e.prototype.tile=function(t,r){if(t.dtype==="string"){var i=this.readSync(t.dataId).map((function(s){return Mv(s)}));return M3(un(t.shape,t.dtype,i),r)}var o=new N8(t.shape,r);return this.compileAndRun(o,[t])},e.prototype.pad=function(t,r,i){var o=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new p8(t.shape,r,i):new d8(t.shape,r,i);return this.compileAndRun(o,[t])},e.prototype.transpose=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,r);var i=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new R8(t.shape,r):new P8(t.shape,r);return this.compileAndRun(i,[t])},e.prototype.gather=function(t,r,i){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.gather(t,r,i);var o=new VO(t.shape,r.size,i);return this.compileAndRun(o,[t,r])},e.prototype.batchToSpaceND=function(t,r,i){pe(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var o=r.reduce((function(d,p){return d*p})),s=Uv(t.shape,r,o),a=zv(s.length,r.length),u=Wv(t.shape,r,o),l=_3(i,r.length),h=E3(u,i,r.length);return t.reshape(s).transpose(a).reshape(u).slice(l,h)},e.prototype.spaceToBatchND=function(t,r,i){pe(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var o=r.reduce((function(p,m){return p*m})),s=[[0,0]];s.push.apply(s,i);for(var a=1+r.length;a<t.shape.length;++a)s.push([0,0]);var u=t.pad(s),l=Uv(u.shape,r,o,!1),h=zv(l.length,r.length,!1),d=Wv(u.shape,r,o,!1);return u.reshape(l).transpose(h).reshape(d)},e.prototype.reduce=function(t,r,i){var o=t.shape[0],s=t.shape[1],a=wy(s),u=new m8({windowSize:a,inSize:s,batchSize:o},r),l=this.compileAndRun(u,[t],i);return l.shape[1]===1?l:this.reduce(l,r,i)},e.prototype.argReduce=function(t,r,i){i===void 0&&(i=null);var o=t.shape[0],s=t.shape[1];i!=null&&(o=i.shape[0],s=i.shape[1]);var a=wy(s),u=new tO({windowSize:a,inSize:s,batchSize:o},r,i==null),l=[t];i!=null&&l.push(i);var h=this.compileAndRun(u,l,"int32");return h.shape[1]===1?h:this.argReduce(t,r,h)},e.prototype.argReducePacked=function(t,r,i){i===void 0&&(i=null);var o=i!=null?i.shape:t.shape,s=wy(o[o.length-1]),a=new aO(o,s,r,i==null),u=i==null?[t]:[t,i],l=this.compileAndRun(a,u,"int32");return l.rank===t.rank?this.argReducePacked(t,r,l):l},e.prototype.sum=function(t,r){Ks("sum",r,t.rank);var i=Ro(t.shape,r),o=i[0],s=Dt(i[1]),a=t.as2D(-1,s),u=hy(t.dtype);return this.reduce(a,"sum",u).reshape(o)},e.prototype.prod=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,r);var i=Ro(t.shape,r),o=i[0],s=Dt(i[1]),a=t.as2D(-1,s),u=hy(t.dtype);return this.reduce(a,"prod",u).reshape(o)},e.prototype.unsortedSegmentSum=function(t,r,i){var o=0,s=fl([o],t.rank),a=t;s!=null&&(a=t.transpose(s),o=dl(1,t.rank)[0]);var u=(function(m,w,b){for(var x=[],E=m.length,A=0;A<E;A++)A!==w?x.push(m[A]):x.push(b);return x})(a.shape,o,i),l=Dt([a.shape[o]]),h=a.as2D(-1,l),d=hy(t.dtype),p=this.segOpCompute(h,"unsortedSegmentSum",r,d,i).reshape(u);return s!=null&&(p=p.transpose(fb(s))),p},e.prototype.segOpCompute=function(t,r,i,o,s){var a=t.shape[0],u=t.shape[1],l=(function(p,m){var w,b=!1;for(p<=A3?(w=p,b=!0):w=A2(p,Math.floor(Math.sqrt(p)));!b;)w>m||w===p?b=!0:w=A2(p,w+1);return w})(u,s),h=new S8({windowSize:l,inSize:u,batchSize:a,numSegments:s}),d=this.compileAndRun(h,[t,i],o);return d.shape[1]===s?d:(i=jv(0,s).tile([u/l]),this.segOpCompute(d,r,i,o,s))},e.prototype.argMinMaxReduce=function(t,r,i){var o=[r];if(Ks("arg"+i.charAt(0).toUpperCase()+i.slice(1),o,t.rank),!Ye().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var s=Ro(t.shape,o),a=s[0],u=Dt(s[1]),l=t.as2D(-1,u);return this.argReduce(l,i).reshape(a)}return this.argReducePacked(t,i)},e.prototype.argMin=function(t,r){return this.argMinMaxReduce(t,r,"min")},e.prototype.argMax=function(t,r){return this.argMinMaxReduce(t,r,"max")},e.prototype.cumsum=function(t,r,i,o){if(r!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+r);var s=new IO(t.shape,i,o);return this.compileAndRun(s,[t])},e.prototype.equal=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(equal(a, b));
`,"bool");var i=new Ur("return float(a == b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.notEqual=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new Ur("return float(a != b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.less=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.less(t,r);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new Ur("return float(a < b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.lessEqual=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new Ur("return float(a <= b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.greater=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.greater(t,r);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new Ur("return float(a > b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.greaterEqual=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new Ur("return float(a >= b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.logicalNot=function(t){var r=new pn(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[t])},e.prototype.logicalAnd=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new Ur("return float(a >= 1.0 && b >= 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.logicalOr=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new Ur("return float(a >= 1.0 || b >= 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.select=function(t,r,i){var o=new A8(t.rank,r.shape,r.rank);return this.compileAndRun(o,[t,r,i],so(r.dtype,i.dtype))},e.prototype.where=function(t){Bv("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=t.dataSync();return bb(t.shape,r)},e.prototype.topk=function(t,r,i){return F3(t.dataSync(),t.shape,t.dtype,r)},e.prototype.min=function(t,r){Ks("min",r,t.rank);var i=Ro(t.shape,r),o=i[0],s=Dt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"min",a.dtype).reshape(o)},e.prototype.minimum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.minimum(t,r);var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ul(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new Ur(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.mod=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ul(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new Ur(`if (b == 0.0) return NAN;
  return mod(a, b);`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.max=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,r);Ks("max",r,t.rank);var i=Ro(t.shape,r),o=i[0],s=Dt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"max",a.dtype).reshape(o)},e.prototype.maximum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.maximum(t,r);var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ul(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new Ur(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.all=function(t,r){Ks("all",r,t.rank);var i=Ro(t.shape,r),o=i[0],s=Dt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"all",a.dtype).reshape(o)},e.prototype.any=function(t,r){Ks("any",r,t.rank);var i=Ro(t.shape,r),o=i[0],s=Dt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"any",a.dtype).reshape(o)},e.prototype.realDivide=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var i=new Ur(`
if (a == b) {
  return 1.0;
};
return a / b;`,t.shape,r.shape);return this.compileAndRun(i,[t,r],"float32")},e.prototype.floorDiv=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new Ur(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,t.shape,r.shape);return this.compileAndRun(i,[t,r],"int32")},e.prototype.add=function(t,r){if(t.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(t,r,by);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.add(t,r);var i=so(t.dtype,r.dtype);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,by,i);var o=new Ur(by,t.shape,r.shape);return this.compileAndRun(o,[t,r],i)},e.prototype.packedUnaryOp=function(t,r,i){var o=new Lp(t.shape,r);return this.compileAndRun(o,[t],i)},e.prototype.packedBinaryOp=function(t,r,i,o,s){s===void 0&&(s=!1);var a=new Ul(i,t.shape,r.shape,s);return this.compileAndRun(a,[t,r],o)},e.prototype.complexSeparableBinaryOp=function(t,r,i){var o=this,s=this.texData.get(t.dataId),a=this.texData.get(r.dataId),u=[[s.complexTensors.real,a.complexTensors.real],[s.complexTensors.imag,a.complexTensors.imag]].map((function(p){var m=p[0],w=p[1],b=o.makeComplexComponentTensorInfo(t,m),x=o.makeComplexComponentTensorInfo(r,w),E=new Ur(i,t.shape,r.shape);return o.compileAndRun(E,[b,x],so(m.dtype,w.dtype))})),l=u[0],h=u[1],d=this.complex(l,h);return l.dispose(),h.dispose(),d},e.prototype.makeComplexComponentTensorInfo=function(t,r){return{dataId:r.dataId,dtype:r.dtype,shape:t.shape}},e.prototype.addN=function(t){if(t.length===1)return t[0];if(t.length>Ye().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(t.length/2),i=this.addN(t.slice(0,r)),o=this.addN(t.slice(r));return this.addN([i,o])}var s=t.map((function(l){return l.dtype})).reduce((function(l,h){return so(l,h)})),a=t.map((function(l){return l.shape})),u=Ye().getBool("WEBGL_PACK")?new eO(t[0].shape,a):new ZF(t[0].shape,a);return this.compileAndRun(u,t,s)},e.prototype.subtract=function(t,r){if(t.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(t,r,xy);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.subtract(t,r);var i=so(t.dtype,r.dtype);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,xy,t.dtype);var o=new Ur(xy,t.shape,r.shape);return this.compileAndRun(o,[t,r],i)},e.prototype.pow=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ul(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new Ur(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,t.shape,r.shape),o=so(t.dtype,r.dtype);return this.compileAndRun(i,[t,r],o)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,XE,t.dtype);var r=new pn(t.shape,XE);return this.compileAndRun(r,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,YE,t.dtype);var r=new pn(t.shape,YE);return this.compileAndRun(r,[t])},e.prototype.sign=function(t){var r=new pn(t.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[t])},e.prototype.isNaN=function(t){var r=new pn(t.shape,"return float(isnan(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.isInf=function(t){var r=new pn(t.shape,"return float(isinf(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.isFinite=function(t){var r=new pn(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.round=function(t){var r=new pn(t.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,JE,t.dtype);var r=new pn(t.shape,JE);return this.compileAndRun(r,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,QE,t.dtype);var r=new pn(t.shape,QE);return this.compileAndRun(r,[t])},e.prototype.softmax=function(t,r){var i=Ii([r],t.shape),o=this.max(t,i),s=Is(o.shape,i),a=this.subtract(t,o.reshape(s)),u=this.exp(a),l=this.sum(u,i).reshape(s);return this.realDivide(u,l)},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,t.dtype);var r=new pn(t.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[t])},e.prototype.log1p=function(t){var r=new pn(t.shape,"return log(1.0 + x);");return this.compileAndRun(r,[t])},e.prototype.sqrt=function(t){var r=new pn(t.shape,"return sqrt(x);");return this.compileAndRun(r,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var r=new pn(t.shape,"return inversesqrt(x);");return this.compileAndRun(r,[t])},e.prototype.reciprocal=function(t){var r=new pn(t.shape,"return 1.0 / x;");return this.compileAndRun(r,[t])},e.prototype.relu=function(t){var r;return r=Ye().getBool("WEBGL_PACK")?new Lp(t.shape,H3):new pn(t.shape,z3),this.compileAndRun(r,[t])},e.prototype.relu6=function(t){var r;return r=Ye().getBool("WEBGL_PACK")?new Lp(t.shape,G3):new pn(t.shape,W3),this.compileAndRun(r,[t])},e.prototype.prelu=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ul(U3,t.shape,r.shape):new Ur(j3,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.elu=function(t){if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,$3,t.dtype);var r=new pn(t.shape,q3);return this.compileAndRun(r,[t])},e.prototype.eluDer=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ul(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,t.shape,r.shape):new Ur("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.selu=function(t){var r=new pn(t.shape,L8);return this.compileAndRun(r,[t])},e.prototype.int=function(t){var r=new pn(t.shape,"return float(int(x));");return this.compileAndRun(r,[t],"int32")},e.prototype.clip=function(t,r,i){var o,s=(o=Ye().getBool("WEBGL_PACK_CLIP")?new mO(t.shape):new pO(t.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(o,[t],null,s)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,$E,t.dtype);var r=new pn(t.shape,$E);return this.compileAndRun(r,[t])},e.prototype.complexAbs=function(t){var r=this.texData.get(t.dataId),i=new gO(t.shape),o=[this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)];return this.compileAndRun(i,o)},e.prototype.sigmoid=function(t){var r=new pn(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[t])},e.prototype.softplus=function(t){var r=new pn(t.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[t])},e.prototype.sin=function(t){var r=new pn(t.shape,M8);return this.compileAndRun(r,[t])},e.prototype.cos=function(t){var r=new pn(t.shape,F8);return this.compileAndRun(r,[t])},e.prototype.tan=function(t){var r=new pn(t.shape,"return tan(x);");return this.compileAndRun(r,[t])},e.prototype.asin=function(t){var r=new pn(t.shape,O8);return this.compileAndRun(r,[t])},e.prototype.acos=function(t){var r=new pn(t.shape,B8);return this.compileAndRun(r,[t])},e.prototype.atan=function(t){var r=new pn(t.shape,V8);return this.compileAndRun(r,[t])},e.prototype.atan2=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ul(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new Ur(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.sinh=function(t){var r=new pn(t.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[t])},e.prototype.cosh=function(t){var r=new pn(t.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[t])},e.prototype.tanh=function(t){var r=new pn(t.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[t])},e.prototype.asinh=function(t){var r=new pn(t.shape,j8);return this.compileAndRun(r,[t])},e.prototype.acosh=function(t){var r=new pn(t.shape,U8);return this.compileAndRun(r,[t])},e.prototype.atanh=function(t){var r=new pn(t.shape,z8);return this.compileAndRun(r,[t])},e.prototype.erf=function(t){var r=new pn(t.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[t])},e.prototype.step=function(t,r){var i=new pn(t.shape,(function(o){return o===void 0&&(o=0),wu+`
    return x > 0.0 ? 1.0 : float(`+o+`);
  `})(r));return this.compileAndRun(i,[t])},e.prototype.conv2dByMatMul=function(t,r,i,o,s,a){var u=t.shape,l=this.texData.get(t.dataId),h=i.inChannels,d=u[0]*u[1]*u[2],p=i.outChannels,m=i.dataFormat==="channelsLast",w=(d===1||p===1)&&h>1e3,b=u[2]%2!=0&&!!l.isPacked;if(w||!Ye().getBool("WEBGL_LAZILY_UNPACK")||!Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!b){var x=m?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],E=this.reshape(t,[1,x,i.inChannels]),A=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:E,b:A,transposeA:!1,transposeB:!1,bias:o,activation:s,preluActivationWeights:a}),i.outShape)}var N=m?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),F={dataId:t.dataId,shape:[1,N,i.inChannels],dtype:t.dtype},D=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,pe(Ug(l.shape,F.shape),(function(){return"packed reshape "+l.shape+" to "+F.shape+" isn't free"}));var W=this.reshape(r,[1,i.inChannels,i.outChannels]),k=this.fusedBatchMatMul({a:F,b:W,transposeA:!1,transposeB:!1,bias:o,activation:s,preluActivationWeights:a}),C=this.texData.get(k.dataId);return pe(C.isPacked,(function(){return"batchMatMul result is expected to be packed"})),l.shape=D,C.shape=i.outShape,Te.makeTensorFromDataId(k.dataId,i.outShape,k.dtype)},e.prototype.conv2dWithIm2Row=function(t,r,i,o,s,a){var u=i.filterWidth,l=i.filterHeight,h=i.inChannels,d=i.outWidth,p=i.outHeight,m=i.dataFormat==="channelsLast",w=u*l*h,b=p*d,x=[w,b],E=t.squeeze([0]),A=r.reshape([1,w,-1]),N=new i8(x,E.shape,i),F=this.compileAndRun(N,[E]).reshape([1,x[0],x[1]]),D=o!=null,W=a!=null,k=s?Hg(s,!0):null,C=new _y(F.shape,[1,b,i.outChannels],!0,!1,D,k,W),L=[F,A];o&&L.push(o),W&&L.push(a);var B=this.compileAndRun(C,L);return m?B.reshape([1,p,d,i.outChannels]):B.reshape([1,i.outChannels,p,d])},e.prototype.fusedConv2d=function(t){var r=t.input,i=t.filter,o=t.convInfo,s=t.bias,a=t.activation,u=t.preluActivationWeights;if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,o,s,a,u);if(Ye().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,o,s,a,u);var l=s!=null,h=u!=null,d=a?Hg(a,!1):null,p=new BE(o,l,d,h),m=[r,i];return s&&m.push(s),u&&m.push(u),this.compileAndRun(p,m)},e.prototype.conv2d=function(t,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(t,r,i);if(Ye().getBool("WEBGL_CONV_IM2COL")&&t.shape[0]===1)return this.conv2dWithIm2Row(t,r,i);var o=new BE(i);return this.compileAndRun(o,[t,r])},e.prototype.conv2dDerInput=function(t,r,i){var o=new bO(i);return this.compileAndRun(o,[t,r])},e.prototype.conv2dDerFilter=function(t,r,i){var o=new wO(i);return this.compileAndRun(o,[t,r])},e.prototype.fusedDepthwiseConv2D=function(t){var r,i=t.input,o=t.filter,s=t.convInfo,a=t.bias,u=t.activation,l=t.preluActivationWeights,h=Ye().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,d=u?Hg(u,h):null,p=[i,o],m=a!=null,w=l!=null;return m&&p.push(a),w&&p.push(l),h?(r=new jE(s,m,d,w),this.compileAndRun(r,p)):(r=new VE(s,m,d,w),this.compileAndRun(r,p))},e.prototype.depthwiseConv2D=function(t,r,i){var o;return Ye().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(o=new jE(i),this.compileAndRun(o,[t,r])):(o=new VE(i),this.compileAndRun(o,[t,r]))},e.prototype.depthwiseConv2DDerInput=function(t,r,i){var o=new SO(i);return this.compileAndRun(o,[t,r])},e.prototype.depthwiseConv2DDerFilter=function(t,r,i){var o=new EO(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3d=function(t,r,i){var o=new AO(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3dDerInput=function(t,r,i){var o=new _O(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3dDerFilter=function(t,r,i){var o=new xO(i);return this.compileAndRun(o,[t,r])},e.prototype.maxPool=function(t,r){var i=new Ey(r,"max",!1);return this.compileAndRun(i,[t])},e.prototype.avgPool=function(t,r){var i=new Ey(r,"avg",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.maxPoolBackprop=function(t,r,i,o){var s=new Ey(o,"max",!0),a=this.compileAndRun(s,[r]),u=new u8(o),l=this.compileAndRun(u,[t,a],r.dtype);return a.dispose(),l},e.prototype.avgPoolBackprop=function(t,r,i){var o=new uO(i);return this.compileAndRun(o,[t],r.dtype)},e.prototype.cast=function(t,r){return P3(t,r,this)},e.prototype.unstack=function(t,r){for(var i=t.shape[r],o=new Array(t.rank-1),s=0,a=0;a<t.rank;a++)a!==r&&(o[s++]=t.shape[a]);var u=new Array(t.rank).fill(0),l=t.shape.slice();l[r]=1;var h=new Array(i);for(a=0;a<h.length;a++)u[r]=a,h[a]=this.slice(t,u,l).reshape(o);return h},e.prototype.avgPool3d=function(t,r){var i=new Sy(r,"avg",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,r,i){var o=new lO(i);return this.compileAndRun(o,[t],r.dtype)},e.prototype.maxPool3d=function(t,r){var i=new Sy(r,"max",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,r,i,o){var s=new Sy(o,"max",!0),a=this.compileAndRun(s,[r]),u=new l8(o),l=this.compileAndRun(u,[t,a],r.dtype);return a.dispose(),l},e.prototype.reshape=function(t,r){var i=this.texData.get(t.dataId);if(i.isPacked&&!Ug(t.shape,r)&&(i.texture===null||!Ug(i.shape,r))){var o=this.packedReshape(t,r);return Te.makeTensorFromDataId(o.dataId,o.shape,o.dtype)}return D2(t,r)},e.prototype.resizeBilinear=function(t,r,i,o){var s=Ye().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new w8(t.shape,r,i,o):new y8(t.shape,r,i,o);return this.compileAndRun(s,[t],"float32")},e.prototype.resizeBilinearBackprop=function(t,r,i){var o=new v8(t,r,i);return this.compileAndRun(o,[t])},e.prototype.resizeNearestNeighbor=function(t,r,i,o){var s=new x8(t.shape,r,i,o);return this.compileAndRun(s,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,r,i){var o=new b8(t,r,i);return this.compileAndRun(o,[t])},e.prototype.multinomial=function(t,r,i,o){var s=r?t:Ql(t),a=s.shape[0],u=s.shape[1],l=new c8(a,u,i),h=l.getCustomSetupFunc(o);return this.compileAndRun(l,[s],"int32",h)},e.prototype.oneHot=function(t,r,i,o){var s=new h8(t.size,r,i,o);return this.compileAndRun(s,[t])},e.prototype.diag=function(t){var r=new PO(t.size);return this.compileAndRun(r,[t])},e.prototype.nonMaxSuppression=function(t,r,i,o,s){return Bv("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),yb(t.dataSync(),r.dataSync(),i,o,s)},e.prototype.cropAndResize=function(t,r,i,o,s,a){var u=new CO(t.shape,r.shape,o,s,a);return this.compileAndRun(u,[t,r,i],"float32")},e.prototype.depthToSpace=function(t,r,i){pe(r>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+r}));var o=t.shape[0],s=i==="NHWC"?t.shape[1]:t.shape[2],a=i==="NHWC"?t.shape[2]:t.shape[3],u=i==="NHWC"?t.shape[3]:t.shape[1],l=s*r,h=a*r,d=u/(r*r),p=new NO(i==="NHWC"?[o,l,h,d]:[o,d,l,h],r,i);return this.compileAndRun(p,[t])},e.prototype.split=function(t,r,i){return L3(t,r,i)},e.prototype.scatterND=function(t,r,i){var o=qv(0,t,i),s=o.sliceRank,a=o.numUpdates,u=o.sliceSize,l=o.strides,h=o.outputSize,d=[h/u,u],p=t.reshape([a,s]),m=r.reshape([a,u]);if(h===0)return D2(uo([]),i);var w=wt(0),b=new qE(a,s,p.rank,m.rank,l,d);return this.compileAndRun(b,[m,p,w]).reshape(i)},e.prototype.sparseToDense=function(t,r,i,o){var s=qv(0,t,i),a=s.sliceRank,u=s.numUpdates,l=s.strides,h=s.outputSize,d=new qE(u,a,t.rank,r.rank,l,[h,1]);return this.compileAndRun(d,[r,t,o]).reshape(i)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,r){var i=this.texData.get(t.dataId),o=new zE(FO,t.shape,r),s=new zE(OO,t.shape,r),a=[this.makeComplexComponentTensorInfo(t,i.complexTensors.real),this.makeComplexComponentTensorInfo(t,i.complexTensors.imag)],u=this.compileAndRun(o,a),l=this.compileAndRun(s,a),h=this.complex(u,l).as2D(t.shape[0],t.shape[1]);return u.dispose(),l.dispose(),h},e.prototype.gatherND=function(t,r){var i=r.shape,o=i[i.length-1],s=S3(t,r),a=s[0],u=s[1],l=s[2],h=s[3],d=r.reshape([u,o]),p=t.reshape([t.size/l,l]),m=new jO(o,h,[u,l]);return this.compileAndRun(m,[p,d]).reshape(a)},e.prototype.fill=function(t,r,i){if((i=i||Rm(r))==="string"){var o=Lv(i,Dt(t));return o.fill(r),Te.makeTensor(o,t,i,this)}var s=new BO(t,r),a=s.getCustomSetupFunc(r);return this.compileAndRun(s,[],i,a)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,t.dtype==="string"?"":0,t.dtype)},e.prototype.linspace=function(t,r,i){return R3(t,r,i)},e.prototype.makeTensorInfo=function(t,r){var i=this.write(null,t,r);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:r}},e.prototype.makeOutput=function(t,r){var i=this.makeTensorInfo(t,r).dataId;return Te.makeTensorFromDataId(i,t,r,this)},e.prototype.unpackTensor=function(t){var r=new q8(t.shape);return this.runWebGLProgram(r,[t],t.dtype)},e.prototype.packTensor=function(t){var r=new f8(t.shape);return this.runWebGLProgram(r,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,r){var i=[Fv(t.shape)].concat(Ov(t.shape)),o={dtype:t.dtype,shape:i,dataId:t.dataId},s=[Fv(r)].concat(Ov(r)),a=new g8(s,i),u=this.runWebGLProgram(a,[o],t.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},e.prototype.decode=function(t){var r,i=this.texData.get(t),o=i.isPacked,s=i.shape,a=i.dtype,u=yy(s);return r=o?new kO(u):new TO(u),{dtype:a,shape:s,dataId:this.runWebGLProgram(r,[{shape:u,dtype:a,dataId:t}],a,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,r,i,o,s){var a=this;s===void 0&&(s=!1);var u=this.makeTensorInfo(t.outputShape,i),l=this.texData.get(u.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===dm.DENSE){var h=Yp(t.outputShape);l.texShape=h.map((function(N){return 2*N}))}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),Dt(u.shape)===0)return l.values=hm(u.dtype,0),u;var d=[],p=r.map((function(N){if(N.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var F=a.texData.get(N.dataId);if(F.texture==null){if(!t.packedInputs&&Dt(N.shape)<=Ye().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:N.shape,texData:null,isUniform:!0,uniformValues:F.values};t.packedInputs&&(F.isPacked=!0,F.shape=N.shape)}else if(!!F.isPacked!=!!t.packedInputs)N=F.isPacked?a.unpackTensor(N):a.packTensor(N),d.push(N),F=a.texData.get(N.dataId);else if(F.isPacked&&!Ug(F.shape,N.shape)){var D=N,W=N.shape;N.shape=F.shape,N=a.packedReshape(N,W),d.push(N),F=a.texData.get(N.dataId),D.shape=W}return a.uploadToGPU(N.dataId),{shape:N.shape,texData:F,isUniform:!1}}));this.uploadToGPU(u.dataId);var m,w={shape:u.shape,texData:l,isUniform:!1},b=(function(N,F,D){var W="";F.concat(D).forEach((function(L){var B=L.texData!=null&&L.texData.slice!=null&&L.texData.slice.flatOffset>0,R=L.isUniform?"uniform":L.texData.texShape;W+=L.shape+"_"+R+"_"+B}));var k=N.userCode,C=N.constructor.name;return C+="_"+W+"_"+k})(t,p,w),x=this.getAndSaveBinary(b,(function(){return(function(N,F,D,W){var k=F.userCode,C=D.map((function(K,le){var se={logicalShape:K.shape,texShape:K.isUniform?null:K.texData.texShape,isUniform:K.isUniform,isPacked:!K.isUniform&&K.texData.isPacked,flatOffset:null};return K.texData!=null&&K.texData.slice!=null&&K.texData.slice.flatOffset>0&&(se.flatOffset=K.texData.slice.flatOffset),{name:F.variableNames[le],shapeInfo:se}})),L=C.map((function(K){return K.shapeInfo})),B={logicalShape:W.shape,texShape:W.texData.texShape,isUniform:!1,isPacked:W.texData.isPacked,flatOffset:null},R=nO(C,B,k,F.packedInputs),M=N.createProgram(R),U=null,J=N.getUniformLocation(M,"NAN",!1);Ye().getNumber("WEBGL_VERSION")===1&&(U=N.getUniformLocation(M,"INFINITY",!1));for(var de={},fe=0;fe<F.variableNames.length;fe++){var he=F.variableNames[fe];de[he]=N.getUniformLocation(M,he,!1),de["offset"+he]=N.getUniformLocation(M,"offset"+he,!1)}return{program:F,source:R,webGLProgram:M,uniformLocations:de,inShapeInfos:L,outShapeInfo:B,infLoc:U,nanLoc:J}})(a.gpgpu,t,p,w)})),E=this.activeTimers!=null;if(E&&(m=this.startTimer()),(function(N,F,D,W,k){WE(F.inShapeInfos,D),WE([F.outShapeInfo],[W]);var C=W.texData.texture,L=W.texData.texShape;W.texData.isPacked?N.setOutputPackedMatrixTexture(C,L[0],L[1]):N.setOutputMatrixTexture(C,L[0],L[1]),N.setProgram(F.webGLProgram),Ye().getNumber("WEBGL_VERSION")===1&&F.infLoc!==null&&N.gl.uniform1f(F.infLoc,1/0),F.nanLoc!==null&&N.gl.uniform1f(F.nanLoc,NaN),D.forEach((function(B,R){var M=F.program.variableNames[R],U=F.uniformLocations[M],J=F.uniformLocations["offset"+M];if(U!=null)if(B.isUniform)if(Dt(B.shape)<2)N.gl.uniform1f(U,B.uniformValues[0]);else{var de=B.uniformValues;de instanceof Float32Array||(de=new Float32Array(de)),N.gl.uniform1fv(U,de)}else B.texData.slice!=null&&J!=null&&N.gl.uniform1i(J,B.texData.slice.flatOffset),N.setInputMatrixTexture(B.texData.texture,U,R)})),k!=null&&k(N,F.webGLProgram),N.executeProgram()})(this.gpgpu,x,p,w,o),d.forEach((function(N){return a.disposeData(N.dataId)})),E&&(m=this.endTimer(m),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(m)})),!Ye().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&s===!1){var A=this.unpackTensor(u);return this.disposeData(u.dataId),A}return u},e.prototype.compileAndRun=function(t,r,i,o,s){s===void 0&&(s=!1),i=i||r[0].dtype;var a=this.runWebGLProgram(t,r,i,o,s);return Te.makeTensorFromDataId(a.dataId,a.shape,a.dtype)},e.prototype.getAndSaveBinary=function(t,r){return t in this.binaryCache||(this.binaryCache[t]=r()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var t=this;this.disposed||(Ye().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(r){t.gpgpu.deleteProgram(t.binaryCache[r].webGLProgram),delete t.binaryCache[r]})),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=At((function(){if(!Ye().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=Ye().getBool("DEBUG");Ye().set("DEBUG",!1);var i=t.abs(wt(1e-8)).dataSync()[0];if(Ye().set("DEBUG",r),i>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var r,i=this.texData.get(t),o=i.shape,s=i.dtype,a=i.values,u=i.texture,l=i.usage,h=i.isPacked;if(u==null){var d,p=this.activeTimers!=null;p&&(d=Gu());var m=i.texShape;if(m==null&&(m=QM(o,h),i.texShape=m),a!=null){var w=yy(o),b=void 0,x=m[1],E=m[0],A=a instanceof Uint8Array;h?(x=(r=Lm(m[0],m[1]))[0],E=r[1],b=new MO(w,[E,x],A)):b=new LO(w,[E,x],A);var N=this.makeTensorInfo([E,x],s);this.texData.get(N.dataId).usage=A?Ys.PIXELS:Ys.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(N.dataId),x,E,a);var F=this.runWebGLProgram(b,[N],s,null,!0),D=this.texData.get(F.dataId);i.texture=D.texture,i.texShape=D.texShape,i.isPacked=D.isPacked,i.usage=D.usage,this.disposeData(N.dataId),this.texData.delete(F.dataId),i.values=null,p&&(this.uploadWaitMs+=Gu()-d)}else{var W=this.acquireTexture(m,l,s,h);i.texture=W}}},e.prototype.convertAndCacheOnCPU=function(t,r){var i=this.texData.get(t),o=i.dtype;return this.releaseGPUData(t),r!=null&&(i.values=(function(s,a){if(a==="float32"||a==="complex64")return s;if(a==="int32"||a==="bool"){for(var u=a==="int32"?new Int32Array(s.length):new Uint8Array(s.length),l=0;l<u.length;++l)u[l]=Math.round(s[l]);return u}throw new Error("Unknown dtype "+a)})(r,o)),i.values},e.prototype.acquireTexture=function(t,r,i,o){if(this.numBytesInGPU+=this.computeBytes(t,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,r,o)},e.prototype.computeBytes=function(t,r){return t[0]*t[1]*s3(r)},e})(k3);d3()&&Te.registerBackend("webgl",(function(){return new G8}),2);var $8=xe({square_:function(n){var e=oe(n,"x","square"),t=[e];return Te.runKernelFunc((function(r,i){return i([e]),r.square(e)}),{x:e},null,"Square",{},t,[])}}),mm="SquaredDifference",K3=xe({squaredDifference_:function(n,e){var t,r=oe(n,"a","squaredDifference"),i=oe(e,"b","squaredDifference");t=Dr(r,i),r=t[0],i=t[1],_n(r.shape,i.shape);var o={a:r,b:i},s=[r,i];return Te.runKernelFunc((function(a,u){var l=a.squaredDifference(r,i);return u([r,i]),l}),o,(function(a,u){var l=u[0],h=u[1],d=wt(2);return{a:function(){return a.mul(l.sub(h).mul(d))},b:function(){return a.mul(h.sub(l).mul(d))}}}),mm,{},s,[])}}),K8=xe({abs_:function(n){var e=oe(n,"x","abs");return e.dtype==="complex64"?Te.runKernelFunc((function(t){return t.complexAbs(e)}),{$x:e}):Te.runKernelFunc((function(t,r){var i=t.abs(e);return r([e]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return t.mul(i.toFloat().step(-1))}}}),"Abs")}}),X8=xe({acos_:function(n){var e=oe(n,"x","acos");return Te.runKernelFunc((function(t,r){var i=t.acos(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(wt(1).sub(i.toFloat().square()).sqrt()).neg()}}}))}}),Y8=xe({acosh_:function(n){var e=oe(n,"x","acosh");return Te.runKernelFunc((function(t,r){var i=t.acosh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(i.toFloat().square().sub(1).sqrt())}}}))}}),J8=xe({asin_:function(n){var e=oe(n,"x","asin");return Te.runKernelFunc((function(t,r){var i=t.asin(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(wt(1).sub(i.toFloat().square()).sqrt())}}}))}}),Q8=xe({asinh_:function(n){var e=oe(n,"x","asinh");return Te.runKernelFunc((function(t,r){var i=t.asinh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(wt(1).add(i.toFloat().square()).sqrt())}}}))}}),Z8=xe({atan_:function(n){var e=oe(n,"x","atan");return Te.runKernelFunc((function(t,r){var i=t.atan(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat().square().add(1))}}}))}}),eB=xe({atanh_:function(n){var e=oe(n,"x","atanh");return Te.runKernelFunc((function(t,r){var i=t.atanh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(wt(1).sub(i.toFloat().square()))}}}))}}),tB=xe({ceil_:function(n){var e=oe(n,"x","ceil");return Te.runKernelFunc((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return Nn(t)}}}))}}),Sb=xe({clipByValue_:function(n,e,t){var r=oe(n,"x","clipByValue");pe(e<=t,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+t+")."}));var i=[r],o={min:e,max:t};return Te.runKernelFunc((function(s,a){var u=s.clip(r,e,t);return a([r]),u}),{x:r},(function(s,a){var u=a[0];return{x:function(){return s.where(u.greaterEqual(e).logicalAnd(u.lessEqual(t)),Nn(s))}}}),"ClipByValue",o,i)}}),nB=xe({cos_:function(n){var e=oe(n,"x","cos"),t=[e];return Te.runKernelFunc((function(r,i){var o=r.cos(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return o.toFloat().sin().neg().mul(r)}}}),"Cos",{},t)}}),rB=xe({cosh_:function(n){var e=oe(n,"x","cosh");return Te.runKernelFunc((function(t,r){var i=t.cosh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(t)}}}))}}),iB=xe({erf_:function(n){var e=oe(n,"x","erf");return pe(e.dtype==="int32"||e.dtype==="float32",(function(){return"Input dtype must be `int32` or `float32`."})),e.dtype==="int32"&&(e=e.toFloat()),Te.runKernelFunc((function(t,r){var i=t.erf(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),M2=xe({exp_:function(n){var e=oe(n,"x","exp");return Te.runKernelFunc((function(t,r){var i=t.exp(e);return r([i]),i}),{x:e},(function(t,r){return{x:function(){return t.mulStrict(r[0])}}}),"Exp",{},[],[!0])}}),oB=xe({expm1_:function(n){var e=oe(n,"x","expm1");return Te.runKernelFunc((function(t,r){var i=t.expm1(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.exp())}}}))}}),sB=xe({floor_:function(n){var e=oe(n,"x","floor");return Te.runKernelFunc((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return Nn(t)}}}))}}),aB=xe({log_:function(n){var e=oe(n,"x","log"),t=[e];return Te.runKernelFunc((function(r,i){var o=r.log(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return r.div(o.toFloat())}}}),"Log",{},t)}}),uB=xe({log1p_:function(n){var e=oe(n,"x","log1p");return Te.runKernelFunc((function(t,r){var i=t.log1p(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.add(1))}}}))}}),lB=xe({logSigmoid_:function(n){var e=oe(n,"x","logSigmoid");return Te.runKernelFunc((function(t,r){var i=t.softplus(e.neg()).neg();return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.neg().sigmoid())}}}))}}),Kv=xe({neg_:function(n){var e=oe(n,"x","neg"),t=[e];return Te.runKernelFunc((function(r){return r.neg(e)}),{x:e},(function(r){return{x:function(){return r.neg()}}}),"Neg",{},t)}}),cB=xe({reciprocal_:function(n){var e=oe(n,"x","reciprocal");return Te.runKernelFunc((function(t,r){var i=t.reciprocal(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.square().neg())}}}))}}),hB=xe({round_:function(n){var e=oe(n,"x","round");return Te.runKernelFunc((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return Nn(t)}}}))}}),X3=xe({rsqrt_:function(n){var e=oe(n,"x","rsqrt"),t=[e];return Te.runKernelFunc((function(r,i){var o=r.rsqrt(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return r.div(o.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},t)}}),Y3=xe({sigmoid_:function(n){var e=oe(n,"x","sigmoid");return Te.runKernelFunc((function(t,r){var i=t.sigmoid(e);return r([i]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return t.mul(i.mul(wt(1).sub(i)))}}}),"Sigmoid")}}),fB=xe({sign_:function(n){var e=oe(n,"x","sign");return Te.runKernelFunc((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return Nn(t)}}}))}}),dB=xe({isNaN_:function(n){var e=oe(n,"x","isNaN");return Te.runKernelFunc((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return Nn(t)}}}))}}),pB=xe({isInf_:function(n){var e=oe(n,"x","isInf");return Te.runKernelFunc((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return Nn(t)}}}))}}),mB=xe({isFinite_:function(n){var e=oe(n,"x","isFinite");return Te.runKernelFunc((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return Nn(t)}}}))}}),gB=xe({sin_:function(n){var e=oe(n,"x","sin"),t=[e];return Te.runKernelFunc((function(r,i){var o=r.sin(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return o.toFloat().cos().mul(r)}}}),"Sin",{},t)}}),vB=xe({sinh_:function(n){var e=oe(n,"x","sinh");return Te.runKernelFunc((function(t,r){var i=t.sinh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(t)}}}))}}),yB=xe({softplus_:function(n){var e=oe(n,"x","softplus");return Te.runKernelFunc((function(t,r){var i=t.softplus(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.sigmoid())}}}))}}),wB=xe({sqrt_:function(n){var e=oe(n,"x","sqrt");return Te.runKernelFunc((function(t,r){var i=t.sqrt(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat().sqrt().mul(2))}}}))}}),bB=xe({step_:function(n,e){e===void 0&&(e=0);var t=oe(n,"x","step");return Te.runKernelFunc((function(r){return r.step(t,e)}),{$x:t},(function(r){return{$x:function(){return Nn(r)}}}))}}),xB=xe({tan_:function(n){var e=oe(n,"x","tan");return Te.runKernelFunc((function(t,r){var i=t.tan(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.cos().square())}}}))}}),_B=xe({tanh_:function(n){var e=oe(n,"x","tanh");return Te.runKernelFunc((function(t,r){var i=t.tanh(e);return r([i]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return wt(1).sub(i.square()).mulStrict(t)}}}),"Tanh",{},null,[!0])}});function J3(n,e,t,r,i,o){var s,a,u=oe(n,"x","batchNorm"),l=oe(e,"mean","batchNorm"),h=oe(t,"variance","batchNorm");return i!=null&&(s=oe(i,"scale","batchNorm")),r!=null&&(a=oe(r,"offset","batchNorm")),pe(u.rank===2,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),pe(l.rank===2||l.rank===1,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."})),pe(h.rank===2||h.rank===1,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+h.rank+"."})),s!=null&&pe(s.rank===2||s.rank===1,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."})),a!=null&&pe(a.rank===2||a.rank===1,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+a.rank+"."})),Fm(u,l,h,a,s,o)}function Q3(n,e,t,r,i,o){var s,a,u=oe(n,"x","batchNorm"),l=oe(e,"mean","batchNorm"),h=oe(t,"variance","batchNorm");return i!=null&&(s=oe(i,"scale","batchNorm")),r!=null&&(a=oe(r,"offset","batchNorm")),pe(u.rank===3,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),pe(l.rank===3||l.rank===1,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."})),pe(h.rank===3||h.rank===1,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+h.rank+"."})),s!=null&&pe(s.rank===3||s.rank===1,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."})),a!=null&&pe(a.rank===3||a.rank===1,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+a.rank+"."})),Fm(u,l,h,a,s,o)}function Z3(n,e,t,r,i,o){var s,a,u=oe(n,"x","batchNorm"),l=oe(e,"mean","batchNorm"),h=oe(t,"variance","batchNorm");return i!=null&&(s=oe(i,"scale","batchNorm")),r!=null&&(a=oe(r,"offset","batchNorm")),pe(u.rank===4,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),pe(l.rank===4||l.rank===1,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."})),pe(h.rank===4||h.rank===1,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+h.rank+"."})),s!=null&&pe(s.rank===4||s.rank===1,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."})),a!=null&&pe(a.rank===4||a.rank===1,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+a.rank+"."})),Fm(u,l,h,a,s,o)}function Fm(n,e,t,r,i,o){o==null&&(o=.001);var s,a,u,l=oe(n,"x","batchNorm"),h=oe(e,"mean","batchNorm"),d=oe(t,"variance","batchNorm");i!=null&&(s=oe(i,"scale","batchNorm")),r!=null&&(a=oe(r,"offset","batchNorm")),pe(h.rank===d.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),pe(a==null||h.rank===a.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),pe(s==null||h.rank===s.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var p=[l,h,d,s];return Te.runKernelFunc((function(m,w){var b=m.batchNormalization(u,Gg(h),Gg(d),o,Gg(s),Gg(a));return w([l,h,d,s]),b}),{x:l,mean:h,variance:d,scale:s,offset:a},(function(m,w){var b=w,x=b[0],E=b[1],A=b[2],N=b[3],F=N??wt(1),D=Ai(E.shape,u.shape),W=[];if(E.rank===1){for(var k=0;k<u.shape.length-1;++k)W.push(u.shape[k]);W.push(1)}var C=x.sub(E),L=m.mul(F),B=X3(A.add(wt(o))),R=B.mul(B).mul(B).mul(wt(-.5));return{x:function(){return E.rank===1?m.mul(_d(B.as4D(1,1,1,E.shape[0]),W)).mul(F).reshape(x.shape):m.mul(B).mul(F).reshape(x.shape)},mean:function(){var M=B.mul(wt(-1)).mul(L);return E.rank===1&&(M=M.sum(D)),M.reshape(E.shape)},variance:function(){var M=R.mul(C).mul(L);return E.rank===1&&(M=M.sum(D)),M.reshape(E.shape)},scale:function(){var M=C.mul(B),U=m.mul(M);return E.rank===1&&(U=U.sum(D)),U.reshape(E.shape)},offset:function(){var M=m;return E.rank===1&&(M=M.sum(D)),M.reshape(E.shape)}}}),"BatchNormalization",{varianceEpsilon:o},p).reshape(l.shape)}function Gg(n){return n==null?null:n.rank===0?n.as1D():n.rank===1?n:n.rank===2?n.as4D(1,1,n.shape[0],n.shape[1]):n.rank===3?n.as4D(1,n.shape[0],n.shape[1],n.shape[2]):n}function I0(){p3("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var EB=xe({batchNormalization2d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),I0(),J3(n,e,t,o,i,r)}}),SB=xe({batchNormalization3d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),I0(),Q3(n,e,t,o,i,r)}}),AB=xe({batchNormalization4d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),I0(),Z3(n,e,t,o,i,r)}}),CB=xe({batchNormalization_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),I0(),Fm(n,e,t,o,i,r)}}),eI=xe({batchNorm_:Fm}),IB=xe({batchNorm2d_:J3}),TB=xe({batchNorm3d_:Q3}),kB=xe({batchNorm4d_:Z3}),T0=xe({logicalAnd_:function(n,e){var t=oe(n,"a","logicalAnd","bool"),r=oe(e,"b","logicalAnd","bool");return _n(t.shape,r.shape),Te.runKernelFunc((function(i){return i.logicalAnd(t,r)}),{a:t,b:r},null,"LogicalAnd")}}),NB=xe({logicalNot_:function(n){var e=oe(n,"x","logicalNot","bool");return Te.runKernelFunc((function(t){return t.logicalNot(e)}),{$x:e})}}),tI=xe({logicalOr_:function(n,e){var t=oe(n,"a","logicalOr","bool"),r=oe(e,"b","logicalOr","bool");return _n(t.shape,r.shape),Te.runKernelFunc((function(i){return i.logicalOr(t,r)}),{$a:t,$b:r})}}),PB=xe({logicalXor_:function(n,e){var t=oe(n,"a","logicalXor","bool"),r=oe(e,"b","logicalXor","bool");return _n(t.shape,r.shape),tI(n,e).logicalAnd(T0(n,e).logicalNot())}}),gf=xe({where_:function(n,e,t){var r=oe(e,"a","where"),i=oe(t,"b","where"),o=oe(n,"condition","where","bool");return Yn(r.shape,i.shape,"Error in where: "),o.rank===1?pe(o.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):Yn(o.shape,i.shape,"Error in where: "),Te.runKernelFunc((function(s,a){var u=s.select(o,r,i);return a([o]),u}),{$condition:o,$a:r,$b:i},(function(s,a){var u=a[0];return{$condition:function(){return Nn(u).toFloat()},$a:function(){return s.mul(u.cast(s.dtype))},$b:function(){return s.mul(u.logicalNot().cast(s.dtype))}}}))}}),nI=function(n){return kt(this,void 0,void 0,(function(){var e,t,r;return Nt(this,(function(i){switch(i.label){case 0:return[4,(e=oe(n,"condition","whereAsync","bool")).data()];case 1:return t=i.sent(),r=bb(e.shape,t),n!==e&&e.dispose(),[2,r]}}))}))},bn=xe({add_:function(n,e){var t,r=oe(n,"a","add"),i=oe(e,"b","add");t=Dr(r,i),r=t[0],i=t[1];var o=_n(r.shape,i.shape);return Te.runKernelFunc((function(s){return s.add(r,i)}),{a:r,b:i},(function(s){return{a:function(){var a=s,u=Ai(r.shape,o);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)},b:function(){var a=s,u=Ai(i.shape,o);return u.length>0&&(a=a.sum(u)),a.reshape(i.shape)}}}),"Add")}}),RB=xe({addN_:function(n){pe(Array.isArray(n),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),pe(n.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+n.length}));var e=n.map((function(i,o){return oe(i,"tensors"+o,"addN")})),t=e[0];e.forEach((function(i){if(i.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(i){if(!qi(i.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=e;return Te.runKernelFunc((function(i){return i.addN(e)}),r,(function(i){var o={};return e.forEach((function(s,a){o[a]=function(){return i.clone()}})),o}),"AddN")}}),DB=xe({addStrict_:function(n,e){var t=oe(n,"a","addStrict"),r=oe(e,"b","addStrict");return Yn(t.shape,r.shape,"Error in addStrict: "),t.add(r)}}),LB=xe({atan2_:function(n,e){var t,r=oe(n,"a","atan2"),i=oe(e,"b","atan2");t=Dr(r,i),r=t[0],i=t[1];var o=_n(r.shape,i.shape);return Te.runKernelFunc((function(s,a){var u=s.atan2(r,i);return a([r,i]),u}),{$a:r,$b:i},(function(s,a){var u=a[0],l=a[1];return{$a:function(){var h=bn(u.square(),l.square()),d=s.mul(l.div(h)),p=Ai(u.shape,o);return p.length>0&&(d=d.sum(p)),d.reshape(u.shape)},$b:function(){var h=bn(u.square(),l.square()),d=Kv(s.mul(u.div(h))),p=Ai(l.shape,o);return p.length>0&&(d=d.sum(p)),d.reshape(l.shape)}}}))}}),hu=xe({div_:function(n,e){var t,r=oe(n,"a","div"),i=oe(e,"b","div");if(t=Dr(r,i),r=t[0],i=t[1],r.dtype==="int32"&&i.dtype==="int32")return rI(r,i);var o=_n(r.shape,i.shape);return Te.runKernelFunc((function(s,a){var u=s.realDivide(r,i);return a([r,i]),u}),{a:r,b:i},(function(s,a){var u=a[0],l=a[1];return{a:function(){var h=s.div(l.toFloat()),d=Ai(u.shape,o);return d.length>0?h.sum(d).reshape(u.shape):h},b:function(){var h=s.mul(u.toFloat()),d=Ai(l.shape,o);d.length>0&&(h=h.sum(d).reshape(l.shape));var p=l.square();return h.div(p.toFloat()).neg()}}}),"Div")}}),MB=xe({divNoNan_:function(n,e){var t,r=oe(n,"a","div"),i=oe(e,"b","div");r=(t=Dr(r,i))[0],i=t[1];var o=hu(r,i),s=Nn(o),a=i.equal(s);return gf(a,s,o)}}),FB=xe({divStrict_:function(n,e){var t=oe(n,"a","div"),r=oe(e,"b","div");return Yn(t.shape,r.shape,"Error in divideStrict: "),t.div(r)}}),rI=xe({floorDiv_:function(n,e){var t,r=oe(n,"a","floorDiv"),i=oe(e,"b","floorDiv");t=Dr(r,i),r=t[0],i=t[1];var o=_n(r.shape,i.shape);return Te.runKernelFunc((function(s,a){var u=s.floorDiv(r,i);return a([r,i]),u}),{a:r,b:i},(function(s,a){var u=a[0],l=a[1];return{a:function(){var h=s.div(l.toFloat()),d=Ai(u.shape,o);return d.length>0?h.sum(d).reshape(u.shape):h},b:function(){var h=s.mul(u.toFloat()),d=Ai(l.shape,o);d.length>0&&(h=h.sum(d).reshape(l.shape));var p=l.square();return h.div(p.toFloat()).neg()}}}),"FloorDiv")}}),Ab=xe({maximum_:function(n,e){var t,r=oe(n,"a","maximum"),i=oe(e,"b","maximum");return t=Dr(r,i),r=t[0],i=t[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),_n(r.shape,i.shape),Te.runKernelFunc((function(o,s){var a=o.maximum(r,i);return s([r,i]),a}),{a:r,b:i},(function(o,s){var a=s[0],u=s[1];return{a:function(){return o.mul(a.greaterEqual(u).toFloat())},b:function(){return o.mul(a.less(u).toFloat())}}}),"Maximum")}}),OB=xe({maximumStrict_:function(n,e){var t=oe(n,"a","maximumStrict"),r=oe(e,"b","maximumStrict");return Yn(t.shape,r.shape,"Error in maximumStrict: "),t.maximum(r)}}),iI=xe({minimum_:function(n,e){var t,r=oe(n,"a","minimum"),i=oe(e,"b","minimum");return t=Dr(r,i),r=t[0],i=t[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),_n(r.shape,i.shape),Te.runKernelFunc((function(o,s){var a=o.minimum(r,i);return s([r,i]),a}),{a:r,b:i},(function(o,s){var a=s[0],u=s[1];return{a:function(){return o.mul(a.lessEqual(u).toFloat())},b:function(){return o.mul(a.greater(u).toFloat())}}}),"Minimum")}}),BB=xe({minimumStrict_:function(n,e){var t=oe(n,"a","minimumStrict"),r=oe(e,"b","minimumStrict");return Yn(t.shape,r.shape,"Error in minimumStrict: "),t.minimum(r)}}),VB=xe({mod_:function(n,e){var t,r=oe(n,"a","mod"),i=oe(e,"b","mod");t=Dr(r,i),r=t[0],i=t[1];var o=_n(r.shape,i.shape);return Te.runKernelFunc((function(s,a){var u=s.mod(r,i);return a([r,i]),u}),{$a:r,$b:i},(function(s,a){var u=a[0],l=a[1];return{$a:function(){var h=Ai(u.shape,o);return h.length>0?s.sum(h).reshape(u.shape):s},$b:function(){var h=s.mul(u.div(l).floor().neg()),d=Ai(l.shape,o);return d.length>0?h.sum(d).reshape(l.shape):h}}}))}}),jB=xe({modStrict_:function(n,e){var t=oe(n,"a","modStrict"),r=oe(e,"b","modStrict");return Yn(t.shape,r.shape,"Error in modStrict: "),t.mod(r)}}),jo=xe({mul_:function(n,e){var t,r=oe(n,"a","mul"),i=oe(e,"b","mul");t=Dr(r,i),r=t[0],i=t[1];var o=_n(r.shape,i.shape);return Te.runKernelFunc((function(s,a){var u=s.multiply(r,i);return a([r,i]),u}),{a:r,b:i},(function(s,a){var u=a[0],l=a[1];return{a:function(){var h=s.mul(l.toFloat()),d=Ai(u.shape,o);return d.length>0?h.sum(d).reshape(u.shape):h},b:function(){var h=s.mul(u.toFloat()),d=Ai(l.shape,o);return d.length>0?h.sum(d).reshape(l.shape):h}}}),"Mul")}}),UB=xe({mulStrict_:function(n,e){var t=oe(n,"a","mul"),r=oe(e,"b","mul");return Yn(t.shape,r.shape,"Error in multiplyStrict: "),t.mul(r)}}),Xv=xe({pow_:function(n,e){var t,r=oe(n,"base","pow"),i=oe(e,"exp","pow");t=Dr(r,i),r=t[0],i=t[1];var o=_n(r.shape,i.shape),s=[r,i];return Te.runKernelFunc((function(a,u){var l=a.pow(r,i);return u([r,i,l]),l}),{a:r,b:i},(function(a,u){var l=u[0],h=u[1],d=u[2];return{a:function(){var p=h.toFloat(),m=a.mul(p.mul(l.pow(p.sub(wt(1))))),w=Ai(l.shape,o);return w.length>0&&(m=m.sum(w)),m.reshape(l.shape)},b:function(){var p=l.greater(0),m=l.log().where(p,Nn(l)),w=a.mul(d.mul(m)),b=Ai(h.shape,o);return b.length>0&&(w=w.sum(b)),w.reshape(h.shape)}}}),"Pow",{},s,[!0])}}),zB=xe({powStrict_:function(n,e){return Yn(n.shape,e.shape,"Error in powStrict: "),n.pow(e)}}),WB=xe({squaredDifferenceStrict_:function(n,e){var t=oe(n,"a","squaredDifferenceStrict"),r=oe(e,"b","squaredDifferenceStrict");return Yn(t.shape,r.shape,"Error in squaredDifferenceStrict: "),t.squaredDifference(r)}}),Ci=xe({sub_:function(n,e){var t,r=oe(n,"a","sub"),i=oe(e,"b","sub");t=Dr(r,i),r=t[0],i=t[1];var o=_n(r.shape,i.shape);return Te.runKernelFunc((function(s){return s.subtract(r,i)}),{a:r,b:i},(function(s){return{a:function(){var a=s,u=Ai(r.shape,o);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)},b:function(){var a=s,u=Ai(i.shape,o);return u.length>0&&(a=a.sum(u)),a.neg().reshape(i.shape)}}}),"Sub")}}),qB=xe({subStrict_:function(n,e){var t=oe(n,"a","subStrict"),r=oe(e,"b","subStrict");return Yn(t.shape,r.shape,"Error in subStrict: "),t.sub(r)}}),oI=xe({equal_:function(n,e){var t,r=oe(n,"a","equal"),i=oe(e,"b","equal");return t=Dr(r,i),r=t[0],i=t[1],_n(r.shape,i.shape),Te.runKernelFunc((function(o){return o.equal(r,i)}),{$a:r,$b:i})}}),HB=xe({equalStrict_:function(n,e){var t=oe(n,"a","equalStrict"),r=oe(e,"b","equalStrict");return Yn(t.shape,r.shape,"Error in equalStrict: "),t.equal(r)}}),GB=xe({greater_:function(n,e){var t,r=oe(n,"a","greater"),i=oe(e,"b","greater");return t=Dr(r,i),r=t[0],i=t[1],_n(r.shape,i.shape),Te.runKernelFunc((function(o){return o.greater(r,i)}),{a:r,b:i},null,"Greater")}}),sI=xe({greaterEqual_:function(n,e){var t,r=oe(n,"a","greaterEqual"),i=oe(e,"b","greaterEqual");return t=Dr(r,i),r=t[0],i=t[1],_n(r.shape,i.shape),Te.runKernelFunc((function(o,s){var a=o.greaterEqual(r,i);return s([r,i]),a}),{a:r,b:i},(function(o,s){var a=s[0],u=s[1];return{a:function(){return Nn(a)},b:function(){return Nn(u)}}}),"GreaterEqual")}}),$B=xe({greaterEqualStrict_:function(n,e){var t=oe(n,"a","greaterEqualStrict"),r=oe(e,"b","greaterEqualStrict");return Yn(t.shape,r.shape,"Error in greaterEqualStrict: "),t.greaterEqual(r)}}),KB=xe({greaterStrict_:function(n,e){var t=oe(n,"a","greaterStrict"),r=oe(e,"b","greaterStrict");return Yn(t.shape,r.shape,"Error in greaterStrict: "),t.greater(r)}}),XB=xe({less_:function(n,e){var t,r=oe(n,"a","less"),i=oe(e,"b","less");return t=Dr(r,i),r=t[0],i=t[1],_n(r.shape,i.shape),Te.runKernelFunc((function(o){return o.less(r,i)}),{a:r,b:i},null,"Less")}}),YB=xe({lessEqual_:function(n,e){var t,r=oe(n,"a","lessEqual"),i=oe(e,"b","lessEqual");return t=Dr(r,i),r=t[0],i=t[1],_n(r.shape,i.shape),Te.runKernelFunc((function(o,s){var a=o.lessEqual(r,i);return s([r,i]),a}),{a:r,b:i},null,"LessEqual")}}),JB=xe({lessEqualStrict_:function(n,e){var t=oe(n,"a","lessEqualStrict"),r=oe(e,"b","lessEqualStrict");return Yn(t.shape,r.shape,"Error in lessEqualStrict: "),t.lessEqual(r)}}),QB=xe({lessStrict_:function(n,e){var t=oe(n,"a","lessStrict"),r=oe(e,"b","lessStrict");return Yn(t.shape,r.shape,"Error in lessStrict: "),t.less(r)}}),ZB=xe({notEqual_:function(n,e){var t,r=oe(n,"a","notEqual"),i=oe(e,"b","notEqual");return t=Dr(r,i),r=t[0],i=t[1],_n(r.shape,i.shape),Te.runKernelFunc((function(o){return o.notEqual(r,i)}),{a:r,b:i},null,"NotEqual")}}),e7=xe({notEqualStrict_:function(n,e){var t=oe(n,"a","notEqualStrict"),r=oe(e,"b","notEqualStrict");return Yn(t.shape,r.shape,"Error in notEqualStrict: "),t.notEqual(r)}});function ZE(n,e){for(var t=[],r=n;r<e;++r)t.push(r);return t}function eS(n){for(var e=[],t=0;t<n.length;++t)for(var r=0;r<n[t].length;++r)e.push(n[t][r]);return e}var Cb=xe({gather_:function(n,e,t){t===void 0&&(t=0);var r=oe(n,"x","gather"),i=oe(e,"indices","gather","int32");t=Ii(t,r.shape)[0];var o=(function(s,a,u){for(var l=s.shape[u],h=[],d=1,p=1,m=0;m<u;m++)h.push(s.shape[m]),d*=s.shape[m];for(m=0;m<a.rank;m++)h.push(a.shape[m]);for(m=u+1;m<s.rank;m++)h.push(s.shape[m]),p*=s.shape[m];return{batchSize:d,sliceSize:p,dimSize:l,outputShape:h}})(r,i,t);return Te.runKernelFunc((function(s,a){var u=s.gather(r,i.flatten(),t);return a([i]),u}),{x:r,indices:i},(function(s,a){var u=a[0];return{x:function(){var l=r.shape,h=u.size,d=l.slice(0,t),p=d.length,m=l.slice(t,l.length).slice(1),w=m.length,b=ZE(0,p),x=ZE(p+1,p+1+w),E=eS([d,[h],m]),A=s.reshape(E),N=u.reshape([h]),F=eS([[p],b,x]),D=A.transpose(F),W=aI(D,N,r.shape[t]),k=fb(F);return W=W.transpose(k)},indices:function(){return u}}}),"Gather",{axis:t}).reshape(o.outputShape)}}),aI=xe({unsortedSegmentSum_:function(n,e,t){var r=oe(n,"x","unsortedSegmentSum"),i=oe(e,"segmentIds","unsortedSegmentSum","int32");return pe(ei(t),(function(){return"numSegments must be of dtype int"})),Te.runKernelFunc((function(o,s){var a=o.unsortedSegmentSum(r,i,t);return s([i]),a}),{$x:r},(function(o,s){var a=s[0];return{$x:function(){return(function(u,l){for(var h=Ab(l,Nn(l)),d=Cb(u,h),p=sI(l,wt(0,"int32")),m=d.rank-p.rank,w=0;w<m;++w)p=Na(p,w+1);p=T0(p,ip(d.shape,"bool"));var b=Nn(d);return gf(p,d,b)})(o,a)}}}))}}),t7=function(n,e,t){return kt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d,p,m,w,b;return Nt(this,(function(x){switch(x.label){case 0:for(r=oe(n,"tensor","boolMask"),i=oe(e,"mask","boolMask","bool"),o=t??0,s=i.rank,a=r.shape,pe(s>0,(function(){return"mask cannot be scalar"})),Yn(a.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=o;l<o+s;l++)u*=a[l];return h=a.slice(0,o).concat([u],a.slice(o+s)),d=r.reshape(h),p=i.reshape([-1]),[4,nI(p)];case 1:return m=x.sent(),w=m.squeeze([1]),b=Cb(d,w,o),n!==r&&r.dispose(),e!==i&&i.dispose(),w.dispose(),d.dispose(),p.dispose(),m.dispose(),[2,b]}}))}))};function uI(n,e,t,r,i,o,s){o===void 0&&(o="NHWC"),pe(n.length===e.rank,(function(){return"Length of inShape ("+n.length+") and rank of dy ("+e.rank+") must match"}));var a=n,u=e,l=!1;e.rank===3&&(l=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),a=[1,n[0],n[1],n[2]]),pe(a.length===4,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+a.length+"."})),pe(u.rank===4,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),pe(t.rank===4,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+t.rank}));var h=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?u.shape[3]:u.shape[1];pe(h===t.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+h+") must match input depth for filter "+t.shape[2]+"."})),pe(d===t.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+t.shape[3]+"."})),s!=null&&pe(ei(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+i+"."}));var p=vb(o),m=Af(a,t.shape,r,1,i,s,!1,p),w=Te.runKernelFunc((function(b,x){var E=b.conv2dDerInput(u,t,m);return x([t,u]),E}),{dy4D:u,filter:t},(function(b,x){var E=x[0],A=x[1];return{dy4D:function(){return Da(b,E,r,i,o,1,s)},filter:function(){return Ib(b,A,E.shape,r,i,o,s)}}}));return l?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}function Cy(n){var e=(function(o){return typeof o=="number"?[o,o,o]:o.length===2?[o[0],o[1],1]:o})(n),t=e[0],r=e[1],i=e[2];return t===1&&r===1&&i===1}function lI(n,e,t,r,i){pe(n.length===e.rank,(function(){return"Length of inShape ("+n.length+") and rank of dy ("+e.rank+") must match"}));var o=n,s=e,a=!1;e.rank===4&&(a=!0,s=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,n[0],n[1],n[2],n[3]]);var u=o[4],l=s.shape[4];pe(o.length===5,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."})),pe(s.rank===5,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank})),pe(t.rank===5,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+t.rank})),pe(u===t.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+t.shape[3]+"."})),pe(l===t.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+t.shape[4]+"."}));var h=Gv(o,t.shape,r,1,i),d=Te.runKernelFunc((function(p){return p.conv3dDerInput(s,t,h)}),{dy5D:s});return a?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var n7=xe({conv1d_:function(n,e,t,r,i,o,s){i===void 0&&(i="NWC"),o===void 0&&(o=1);var a=oe(n,"x","conv1d"),u=oe(e,"filter","conv1d"),l=a,h=!1;a.rank===2&&(h=!0,l=a.as3D(1,a.shape[0],a.shape[1])),pe(l.rank===3,(function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."})),pe(u.rank===3,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),s!=null&&pe(ei(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."})),pe(l.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),pe(Ts(t,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+t+" and dilation '"+o+"'"})),pe(i==="NWC",(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),p=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),m=Da(p,d,[1,t],r,"NHWC",[1,o],s);return h?m.as2D(m.shape[2],m.shape[3]):m.as3D(m.shape[0],m.shape[2],m.shape[3])}}),Da=xe({conv2d_:function(n,e,t,r,i,o,s){i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]);var a=oe(n,"x","conv2d"),u=oe(e,"filter","conv2d"),l=a,h=!1;a.rank===3&&(h=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),pe(l.rank===4,(function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."})),pe(u.rank===4,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),s!=null&&pe(ei(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}));var d=i==="NHWC"?l.shape[3]:l.shape[1];pe(d===u.shape[2],(function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."})),pe(Ts(t,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"}));var p=vb(i),m=Af(l.shape,u.shape,t,o,r,s,!1,p),w=[u,l],b=Te.runKernelFunc((function(x,E){var A=x.conv2d(l,u,m);return E([u,l]),A}),{x:l,filter:u},(function(x,E){var A=E,N=A[0],F=A[1];return pe(Gd(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"})),{x:function(){return cI(F.shape,x,N,t,r,i)},filter:function(){return Ib(F,x,N.shape,t,r,i)}}}),"Conv2D",m,w);return h?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),r7=xe({conv3d_:function(n,e,t,r,i,o){i===void 0&&(i="NDHWC"),o===void 0&&(o=[1,1,1]);var s=oe(n,"x","conv3d"),a=oe(e,"filter","conv3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),pe(u.rank===5,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),pe(a.rank===5,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+a.rank+"."})),pe(u.shape[4]===a.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+a.shape[3]+"."})),pe((function(p,m){return Cy(p)||Cy(m)})(t,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"})),pe(i==="NDHWC",(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var h=Gv(u.shape,a.shape,t,o,r),d=Te.runKernelFunc((function(p,m){var w=p.conv3d(u,a,h);return m([u,a]),w}),{x:u,$filter:a},(function(p,m){pe(Cy(o),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}));var w=m[0],b=m[1];return{x:function(){return lI(w.shape,p,b,t,r)},$filter:function(){return(function(x,E,A,N,F){var D=x;x.rank===4&&(D=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]));var W=E;W.rank===4&&(W=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),pe(D.rank===5,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+D.shape+"."})),pe(W.rank===5,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+W.shape+"."})),pe(A.length===5,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+A+"."})),pe(D.shape[4]===A[3],(function(){return"Error in conv3dDerFilter: depth of input "+D.shape[4]+") must match input depth in filter ("+A[3]+"."})),pe(W.shape[4]===A[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+W.shape[4]+") must match output depth for filter ("+A[4]+")."}));var k=Gv(D.shape,A,N,1,F);return Te.runKernelFunc((function(C){return C.conv3dDerFilter(D,W,k)}),{x5D:D,dy5D:W})})(w,p,b.shape,t,r)}}}));return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Ib=xe({conv2dDerFilter_:function(n,e,t,r,i,o,s){o===void 0&&(o="NHWC");var a=n;n.rank===3&&(a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var u=e;u.rank===3&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),pe(a.rank===4,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+a.shape+"."})),pe(u.rank===4,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),pe(t.length===4,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+t+"."}));var l=o==="NHWC"?a.shape[3]:a.shape[1],h=o==="NHWC"?u.shape[3]:u.shape[1];pe(l===t[2],(function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+t[2]+"."})),pe(h===t[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+h+") must match output depth for filter ("+t[3]+")."})),s!=null&&pe(ei(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+i+"."}));var d=vb(o),p=Af(a.shape,t,r,1,i,s,!1,d);return Te.runKernelFunc((function(m){return m.conv2dDerFilter(a,u,p)}),{x4D:a,dy4D:u})}}),cI=xe({conv2dDerInput_:uI}),k0=xe({depthwiseConv2d_:function(n,e,t,r,i,o,s){o===void 0&&(o=[1,1]);var a=oe(n,"x","depthwiseConv2d"),u=oe(e,"filter","depthwiseConv2d"),l=a,h=!1;a.rank===3&&(h=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),pe(l.rank===4,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."})),pe(u.rank===4,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),pe(l.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),o==null&&(o=[1,1]),pe(Ts(t,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"})),s!=null&&pe(ei(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}));var d=Af(l.shape,u.shape,t,o,r,s,!0),p=[l,u],m=Te.runKernelFunc((function(w,b){var x=w.depthwiseConv2D(l,u,d);return b([l,u]),x}),{x:l,filter:u},(function(w,b){pe(Gd(o),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var x=b[0],E=b[1];return{x:function(){return hI(x.shape,w,E,d)},filter:function(){return fI(x,w,E.shape,d)}}}),"DepthwiseConv2dNative",d,p);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),hI=xe({depthwiseConv2dDerInput_:function(n,e,t,r){var i=e,o=!1;e.rank===3&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var s=Te.runKernelFunc((function(a){return a.depthwiseConv2DDerInput(i,t,r)}),{dy4D:i});return o?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),fI=xe({depthwiseConv2dDerFilter_:function(n,e,t,r){var i=n;n.rank===3&&(i=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var o=e;return o.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),Te.runKernelFunc((function(s){return s.depthwiseConv2DDerFilter(i,o,r)}),{x4D:i,dy4D:o})}}),Tb=xe({separableConv2d_:function(n,e,t,r,i,o,s){o===void 0&&(o=[1,1]),s===void 0&&(s="NHWC");var a=oe(n,"x","separableConv2d"),u=oe(e,"depthwiseFilter","separableConv2d"),l=oe(t,"pointwiseFilter","separableConv2d"),h=a,d=!1;if(a.rank===3&&(d=!0,h=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");pe(h.rank===4,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+h.rank+"."})),pe(u.rank===4,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),pe(l.rank===4,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),pe(l.shape[0]===1,(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."})),pe(l.shape[1]===1,(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."}));var p=u.shape[2],m=u.shape[3];pe(l.shape[2]===p*m,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+p*m+", but got "+l.shape[2]+"."}));var w=k0(h,u,r,i,s,o),b=Da(w,l,1,"valid",s);return d?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),i7=xe({conv2dTranspose_:function(n,e,t,r,i,o){return uI(t,oe(n,"x","conv2dTranspose"),oe(e,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),o7=xe({conv3dTranspose_:function(n,e,t,r,i){return lI(t,oe(n,"x","conv3dTranspose"),oe(e,"filter","conv3dTranspose"),r,i)}}),N0=xe({matMul_:function(n,e,t,r){var i;t===void 0&&(t=!1),r===void 0&&(r=!1);var o=oe(n,"a","matMul"),s=oe(e,"b","matMul");i=Dr(o,s),o=i[0],s=i[1];var a=t?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?s.shape[s.rank-1]:s.shape[s.rank-2],l=t?o.shape[o.rank-1]:o.shape[o.rank-2],h=r?s.shape[s.rank-2]:s.shape[s.rank-1],d=o.shape.slice(0,-2),p=s.shape.slice(0,-2),m=Dt(d),w=Dt(p);pe(o.rank>=2&&s.rank>=2&&o.rank===s.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+s.rank+"."})),pe(qi(d,p),(function(){return"Error in matMul: outer dimensions ("+d+") and ("+p+") of Tensors with shapes "+o.shape+" and "+s.shape+" must match."})),pe(a===u,(function(){return"Error in matMul: inner shapes ("+a+") and ("+u+") of Tensors with shapes "+o.shape+" and "+s.shape+" and transposeA="+t+" and transposeB="+r+" must match."}));var b=o.shape.slice(0,-2).concat([l,h]),x=t?o.as3D(m,a,l):o.as3D(m,l,a),E=r?s.as3D(w,h,u):s.as3D(w,u,h),A={transposeA:t,transposeB:r};return Te.runKernelFunc((function(N,F){var D=N.batchMatMul(x,E,t,r);return F([x,E]),D}),{a:x,b:E},(function(N,F){var D=F,W=D[0],k=D[1];return t||r?!t&&r?{a:function(){return N.matMul(k,!1,!1)},b:function(){return N.matMul(W,!0,!1)}}:t&&!r?{a:function(){return k.matMul(N,!1,!0)},b:function(){return W.matMul(N,!1,!1)}}:{a:function(){return k.matMul(N,!0,!0)},b:function(){return N.matMul(W,!0,!0)}}:{a:function(){return N.matMul(k,!1,!0)},b:function(){return W.matMul(N,!0,!1)}}}),"BatchMatMul",A).reshape(b)}}),s7=xe({dot_:function(n,e){var t=oe(n,"t1","dot"),r=oe(e,"t2","dot");pe(!(t.rank!==1&&t.rank!==2||r.rank!==1&&r.rank!==2),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+t.rank+" and "+r.rank+"."}));var i=t.rank===1?t.size:t.shape[1],o=r.rank===1?r.size:r.shape[0];return pe(i===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."})),t.rank===1&&r.rank===1?t.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():t.rank===1&&r.rank===2?t.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():t.rank===2&&r.rank===1?t.matMul(r.as2D(-1,1)).as1D():t.matMul(r.as2D(r.shape[0],r.shape[1]))}}),a7=xe({outerProduct_:function(n,e){var t=oe(n,"v1","outerProduct"),r=oe(e,"v2","outerProduct");return pe(t.rank===1&&r.rank===1,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+t.rank+" and "+r.rank+"."})),t.as2D(-1,1).matMul(r.as2D(1,-1))}}),Om=xe({reverse_:function(n,e){var t=oe(n,"x","reverse");if(t.rank===0)return t.clone();var r=Ii(e,t.shape);return Te.runKernelFunc((function(i){return i.reverse(t,r)}),{$x:t},(function(i){return{$x:function(){return i.reverse(r)}}})).reshapeAs(t)}}),u7=xe({reverse1d_:function(n){var e=oe(n,"x","reverse");return pe(e.rank===1,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),Om(e,0)}}),l7=xe({reverse2d_:function(n,e){var t=oe(n,"x","reverse");return pe(t.rank===2,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+t.rank+"."})),Om(t,e)}}),c7=xe({reverse3d_:function(n,e){var t=oe(n,"x","reverse");return pe(t.rank===3,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+t.rank+"."})),Om(t,e)}}),h7=xe({reverse4d_:function(n,e){var t=oe(n,"x","reverse");return pe(t.rank===4,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+t.rank+"."})),Om(t,e)}});function dI(n,e,t,r,i,o){var s=oe(n,"x","maxPool"),a=s,u=!1;s.rank===3&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),pe(a.rank===4,(function(){return"Error in maxPool: input must be rank 4 but got rank "+a.rank+"."})),pe(Ts(t,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"})),o!=null&&pe(ei(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var l=pm(a.shape,e,t,r,i,o);if(l.filterWidth===1&&l.filterHeight===1&&qi(l.inShape,l.outShape))return s.clone();var h=[a],d=Te.runKernelFunc((function(p,m){var w=p.maxPool(a,l);return m([a,w]),w}),{x:a},(function(p,m){var w=m[0],b=m[1];return{x:function(){return(function(x,E,A,N,F,D,W,k){var C=oe(x,"dy","maxPoolBackprop"),L=oe(E,"input","maxPoolBackprop"),B=oe(A,"output","maxPoolBackprop");pe(L.rank===C.rank,(function(){return"Rank of input ("+L.rank+") does not match rank of dy ("+C.rank+")"})),pe(Ts(F,D),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+F+" and dilations '"+D+"'"})),pe(C.rank===4,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+C.rank+"."})),pe(L.rank===4,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+L.rank+"."}));var R=pm(L.shape,N,F,D,W,k);return Te.runKernelFunc((function(M){return M.maxPoolBackprop(C,L,B,R)}),{$dy:C,$input:L})})(p,w,b,e,t,r,i)}}}),"MaxPool",l,h);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function pI(n,e,t,r,i,o){var s=oe(n,"x","avgPool","float32");pe(Ts(t,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"}));var a=s,u=!1;s.rank===3&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),pe(a.rank===4,(function(){return"Error in avgPool: x must be rank 4 but got rank "+a.rank+"."})),o!=null&&pe(ei(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var l=pm(a.shape,e,t,r,i,o);if(l.filterWidth===1&&l.filterHeight===1&&qi(l.inShape,l.outShape))return s.clone();var h=Te.runKernelFunc((function(d){return d.avgPool(a,l)}),{x:a},(function(d){return{x:function(){return(function(p,m,w,b,x,E){var A=oe(p,"dy","avgPoolBackprop"),N=oe(m,"input","avgPoolBackprop");pe(N.rank===A.rank,(function(){return"Rank of input ("+N.rank+") does not match rank of dy ("+A.rank+")"})),pe(Ts(b,x),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+x+"'"}));var F=N,D=A,W=!1;N.rank===3&&(W=!0,F=N.as4D(1,N.shape[0],N.shape[1],N.shape[2]),D=A.as4D(1,A.shape[0],A.shape[1],A.shape[2])),pe(D.rank===4,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+D.rank+"."})),pe(F.rank===4,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+F.rank+"."}));var k=pm(F.shape,w,b,x,E),C=Te.runKernelFunc((function(L){return L.avgPoolBackprop(D,F,k)}),{dy4D:D,input4D:F});return W?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C})(d,a,e,t,r,i)}}}),"AvgPool",l);return h=h.cast(s.dtype),u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}var Ui=xe({maxPool_:function(n,e,t,r,i){return dI(n,e,t,1,r,i)}}),Bm=xe({avgPool_:function(n,e,t,r,i){return pI(n,e,t,1,r,i)}}),f7=xe({pool_:function(n,e,t,r,i,o){i==null&&(i=[1,1]),o==null&&(o=1),r===0&&(r="valid");var s=oe(n,"x","maxPool"),a=s,u=!1;s.rank===3&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),pe(Ts(o,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"}));var l,h=pm(a.shape,e,o,i,r),d=[h.dilationHeight,h.dilationWidth];l=r==="same"?(function(F,D){var W=F.map((function(L,B){return L+(L-1)*(D[B]-1)})).map((function(L){return L-1})),k=W.map((function(L){return Math.floor(L/2)})),C=W.map((function(L,B){return L-k[B]}));return W.map((function(L,B){return[k[B],C[B]]}))})([h.filterHeight,h.filterWidth],d):[[0,0],[0,0]];var p=d[0]===1&&d[1]===1,m=(function(F,D,W){var k=W.map((function(J){return J[0]})),C=W.map((function(J){return J[1]})),L=F.concat(k,C),B=D.map((function(J,de){return(J-L[de]%J)%J})),R=C.map((function(J,de){return J+B[de]})),M=D.map((function(J,de){return[k[de],R[de]]})),U=D.map((function(J,de){return[0,B[de]]}));return[M,U]})([h.inHeight,h.inWidth],d,l),w=m[0],b=m[1],x=p?r:"valid",E=p?a:b3(a,d,w),A=(t==="avg"?function(){return pI(E,e,o,1,x)}:function(){return dI(E,e,o,1,x)})(),N=p?A:v3(A,d,b);return u?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),d7=xe({maxPool3d_:function(n,e,t,r,i,o,s){o===void 0&&(o="NDHWC");var a=oe(n,"x","maxPool3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),s==null&&(s=[1,1,1]),pe(u.rank===5,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),pe(o==="NDHWC",(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),pe(Ts(t,s),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"})),i!=null&&pe(ei(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var h=Hv(u.shape,e,t,s,r,i,o),d=Te.runKernelFunc((function(p,m){var w=p.maxPool3d(u,h);return m([u,w]),w}),{x:u},(function(p,m){var w=m[0],b=m[1];return{x:function(){return(function(x,E,A,N,F,D,W,k){var C=oe(x,"dy","maxPool3dBackprop"),L=oe(E,"input","maxPool3dBackprop"),B=oe(A,"output","maxPool3dBackprop"),R=C,M=L,U=B,J=!1;L.rank===4&&(J=!0,R=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),M=L.as5D(1,L.shape[0],L.shape[1],L.shape[2],L.shape[3]),U=B.as5D(1,B.shape[0],B.shape[1],B.shape[2],B.shape[3])),pe(R.rank===5,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+R.rank+"."})),pe(M.rank===5,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+M.rank+"."})),pe(U.rank===5,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+U.rank+"."})),D==null&&(D=[1,1,1]),pe(Ts(F,D),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+F+" and dilations '"+D+"'"})),k!=null&&pe(ei(W),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+k+" but got pad "+W+"."}));var de=Hv(M.shape,N,F,D,W,k),fe=Te.runKernelFunc((function(he){return he.maxPool3dBackprop(R,M,U,de)}),{dy5D:R,input5D:M});return J?fe.as4D(fe.shape[1],fe.shape[2],fe.shape[3],fe.shape[4]):fe})(p,w,b,e,t,s,r,i)}}}));return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),p7=xe({avgPool3d_:function(n,e,t,r,i,o,s){o===void 0&&(o="NDHWC");var a=oe(n,"x","avgPool3d","float32"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),s==null&&(s=[1,1,1]),pe(u.rank===5,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),pe(o==="NDHWC",(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),pe(Ts(t,s),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"})),i!=null&&pe(ei(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var h=Hv(u.shape,e,t,s,r,i,o),d=Te.runKernelFunc((function(p){return p.avgPool3d(u,h)}),{x:u},(function(p){return{x:function(){return(function(m,w,b,x,E,A,N){var F=oe(m,"dy","avgPool3dBackprop"),D=oe(w,"input","avgPool3dBackprop"),W=F,k=D,C=!1;D.rank===4&&(C=!0,W=F.as5D(1,F.shape[0],F.shape[1],F.shape[2],F.shape[3]),k=D.as5D(1,D.shape[0],D.shape[1],D.shape[2],D.shape[3])),pe(W.rank===5,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+W.rank+"."})),pe(k.rank===5,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+k.rank+"."})),E==null&&(E=[1,1,1]),pe(Ts(x,E),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+E+"'"})),N!=null&&pe(ei(A),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+N+" but got pad "+A+"."}));var L=Hv(k.shape,b,x,E,A,N),B=Te.runKernelFunc((function(R){return R.avgPool3dBackprop(W,k,L)}),{dy5D:W,input5D:k});return C?B.as4D(B.shape[1],B.shape[2],B.shape[3],B.shape[4]):B})(p,u,e,t,s,r,i)}}}));return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),ul=xe({slice_:function(n,e,t){var r,i,o=oe(n,"x","slice");if(o.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof e=="number"?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice()).forEach((function(u){pe(u!==-1,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=t==null?new Array(o.rank).fill(-1):typeof t=="number"?[t].concat(new Array(o.rank-1).fill(-1)):t.length<o.rank?t.concat(new Array(o.rank-t.length).fill(-1)):t).map((function(u,l){return u>=0?u:(pe(u===-1,(function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."})),o.shape[l]-r[l])})),zF(o,r,i);var s=o.shape,a={begin:r,size:i};return Te.runKernelFunc((function(u){return u.slice(o,r,i)}),{x:o},(function(u){for(var l=[],h=0;h<u.rank;h++)l.push([r[h],s[h]-r[h]-i[h]]);return{x:function(){return u.pad(l)}}}),"Slice",a)}}),m7=xe({slice1d_:function(n,e,t){var r=oe(n,"x","slice1d");return pe(r.rank===1,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),ul(r,[e],[t])}}),g7=xe({slice2d_:function(n,e,t){var r=oe(n,"x","slice2d");return pe(r.rank===2,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),ul(r,e,t)}}),mI=xe({slice3d_:function(n,e,t){var r=oe(n,"x","slice3d");return pe(r.rank===3,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),ul(r,e,t)}}),v7=xe({slice4d_:function(n,e,t){var r=oe(n,"x","slice4d");return pe(r.rank===4,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),ul(r,e,t)}});function gI(n,e,t,r,i){return e.rank<t.rank&&(e=e.reshape(Is(e.shape,r))),n.rank<t.rank&&(n=n.reshape(Is(n.shape,r))),{x:function(){var o=n.mul(t.equal(e).cast(n.dtype));return i==null?o:o.transpose(i)}}}var y7=xe({all_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","all","bool"),i=Ii(e,r.shape),o=i,s=fl(o,r.rank);s!=null&&(r=r.transpose(s),o=dl(o.length,r.rank));var a=Te.runKernelFunc((function(l){return l.all(r,o)}),{$x:r});if(t){var u=Is(a.shape,i);return a.reshape(u)}return a}}),w7=xe({any_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","any","bool"),i=Ii(e,r.shape),o=i,s=fl(o,r.rank);s!=null&&(r=r.transpose(s),o=dl(o.length,r.rank));var a=Te.runKernelFunc((function(l){return l.any(r,o)}),{$x:r});if(t){var u=Is(a.shape,i);return a.reshape(u)}return a}}),b7=xe({argMax_:function(n,e){e===void 0&&(e=0);var t=oe(n,"x","argMax");e==null&&(e=0);var r=Ii(e,t.shape),i=fl(r,t.rank);i!=null&&(t=t.transpose(i),r=dl(r.length,t.rank));var o={axis:r[0]},s=[t];return Te.runKernelFunc((function(a,u){var l=a.argMax(t,r[0]);return u([t]),l}),{x:t},(function(a,u){var l=u[0];return{x:function(){return Nn(l)}}}),"ArgMax",o,s)}}),x7=xe({argMin_:function(n,e){e===void 0&&(e=0);var t=oe(n,"x","argMin");e==null&&(e=0);var r=Ii(e,t.shape),i=fl(r,t.rank);return i!=null&&(t=t.transpose(i),r=dl(r.length,t.rank)),Te.runKernelFunc((function(o,s){var a=o.argMin(t,r[0]);return s([t]),a}),{$x:t},(function(o,s){var a=s[0];return{$x:function(){return Nn(a)}}}))}}),_7=xe({logSumExp_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","logSumExp"),i=Ii(e,r.shape),o=r.max(i,!0),s=r.sub(o).exp().sum(i).log(),a=o.reshape(s.shape).add(s);if(t){var u=Is(a.shape,i);return a.reshape(u)}return a}}),P0=xe({max_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","max"),i=r,o=Ii(e,r.shape),s=o,a=fl(s,r.rank);a!=null&&(r=r.transpose(a),s=dl(s.length,r.rank));var u=[r],l=Te.runKernelFunc((function(d,p){var m=d.max(r,s);return p([i,m]),m}),{x:r},(function(d,p){return gI(d,p[1],p[0],o,a)}),"Max",{axes:s},u,[!0]);if(t){var h=Is(l.shape,o);l=l.reshape(h)}return l}}),E7=xe({mean_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","mean"),i=Ii(e,r.shape),o=Dt(Ro(r.shape,i)[1]);return C0((function(s){var a=wt(o);return{value:(a.dtype===s.dtype?s:s.cast(a.dtype)).div(a).sum(e,t),gradFunc:function(u){var l=s.shape.slice();return i.forEach((function(h){l[h]=1})),u.reshape(l).mul(ip(s.shape,"float32")).div(o)}}}))(r)}}),S7=xe({min_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","min"),i=r,o=Ii(e,r.shape),s=o,a=fl(s,r.rank);a!=null&&(r=r.transpose(a),s=dl(s.length,r.rank));var u=[r],l=Te.runKernelFunc((function(d,p){var m=d.min(r,s);return p([i,m]),m}),{x:r},(function(d,p){return gI(d,p[1],p[0],o,a)}),"Min",{axes:s},u,[!0]);if(t){var h=Is(l.shape,o);l=l.reshape(h)}return l}}),A7=xe({moments_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Ii(e,(n=oe(n,"x","moments")).shape),i=n.mean(r,t),o=i.shape;t||(o=Is(i.shape,r));var s=n.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:s.mean(r,t)}}}),vI=xe({sum_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=Ii(e,r.shape);return C0((function(o){var s=fl(i,o.rank),a=i,u=o;s!=null&&(u=o.transpose(s),a=dl(a.length,o.rank));var l=function(m){var w=o.shape.slice();return i.forEach((function(b){w[b]=1})),m.reshape(w).mul(ip(o.shape,"float32"))},h={axes:a},d=Te.runKernelFunc((function(m){return m.sum(u,a)}),{x:u},(function(m){return{x:function(){return l(m)}}}),"Sum",h);if(t){var p=Is(d.shape,i);d=d.reshape(p)}return{value:d,gradFunc:l}}))(r)}}),C7=xe({prod_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=oe(n,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=Ii(e,r.shape),o=fl(i,r.rank),s=i,a=r;o!=null&&(a=r.transpose(o),s=dl(s.length,r.rank));var u=Te.runKernelFunc((function(h){return h.prod(a,s)}),{permutedX:a});if(t){var l=Is(u.shape,i);u=u.reshape(l)}return u}}),yI=xe({elu_:function(n){var e=oe(n,"x","elu");return Te.runKernelFunc((function(t,r){var i=t.elu(e);return r([i]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return Te.runKernelFunc((function(o){return o.eluDer(t,i)}),{dy:t,y:i})}}}))}}),I7=xe({leakyRelu_:function(n,e){e===void 0&&(e=.2);var t=oe(n,"x","leakyRelu");return Ab(wt(e).mul(t),t)}}),wI=xe({prelu_:function(n,e){var t=oe(n,"x","prelu"),r=oe(e,"alpha","prelu");return Te.runKernelFunc((function(i,o){var s=i.prelu(t,r);return o([t,r]),s}),{x:t,alpha:r},(function(i,o){var s=o[0],a=o[1],u=s.greater(0);return{x:function(){return gf(u,i,i.mul(a))},alpha:function(){var l=gf(u,Nn(i),i.mul(s)),h=Ai(a.shape,i.shape);return h.length>0&&(l=l.sum(h)),l.reshape(a.shape)}}}),"Prelu")}}),Pr=xe({relu_:function(n){var e=oe(n,"x","relu");return e.dtype==="bool"?e.toInt():Te.runKernelFunc((function(t,r){var i=t.relu(e);return r([e]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return t.mulStrict(i.step().toFloat())}}}),"Relu")}}),bI=xe({relu6_:function(n){var e=oe(n,"x","relu6");return e.dtype==="bool"?e.toInt():Te.runKernelFunc((function(t,r){var i=t.relu6(e);return r([e]),i}),{x:e},(function(t,r){var i=r[0],o=i.lessEqual(6).mul(i.step());return{x:function(){return t.mulStrict(o.toFloat())}}}),"Relu6")}}),T7=xe({selu_:function(n){var e=oe(n,"x","selu");return Te.runKernelFunc((function(t,r){var i=t.selu(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){var o=i.greater(wt(0)),s=wt(_b),a=wt(Eb),u=t.mul(a),l=t.mul(s).mul(i.toFloat().exp());return gf(o,u,l)}}}))}}),dh=xe({transpose_:function(n,e){var t=oe(n,"x","transpose");if(e==null&&(e=t.shape.map((function(i,o){return o})).reverse()),pe(t.rank===e.length,(function(){return"Error in transpose: rank of input "+t.rank+" must match length of perm "+e+"."})),e.forEach((function(i){pe(i>=0&&i<t.rank,(function(){return"All entries in 'perm' must be between 0 and "+(t.rank-1)+" but got "+e}))})),t.rank<=1)return t.clone();var r={perm:e};return Te.runKernelFunc((function(i){return i.transpose(t,e)}),{x:t},(function(i){var o=fb(e);return{x:function(){return i.transpose(o)}}}),"Transpose",r)}}),k7=xe({localResponseNormalization_:function(n,e,t,r,i){e===void 0&&(e=5),t===void 0&&(t=1),r===void 0&&(r=1),i===void 0&&(i=.5);var o=oe(n,"x","localResponseNormalization");pe(o.rank===4||o.rank===3,(function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+o.rank+"."})),pe(ei(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var s=o,a=!1;o.rank===3&&(a=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=Te.runKernelFunc((function(l,h){var d=l.localResponseNormalization4D(s,e,t,r,i);return h([s,d]),d}),{x4D:s},(function(l,h){var d=h[0],p=h[1];return{x4D:function(){return Te.runKernelFunc((function(m){return m.LRNGrad(l,d,p,e,t,r,i)}),{})}}}));return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),xI=xe({norm_:function(n,e,t,r){e===void 0&&(e="euclidean"),t===void 0&&(t=null),r===void 0&&(r=!1);var i=(function a(u,l,h){if(h===void 0&&(h=null),u.rank===0)return u.abs();if(u.rank!==1&&h===null)return a(u.reshape([-1]),l,h);if(u.rank===1||typeof h=="number"||Array.isArray(h)&&h.length===1){if(l===1)return u.abs().sum(h);if(l===1/0)return u.abs().max(h);if(l===-1/0)return u.abs().min(h);if(l==="euclidean"||l===2)return u.abs().pow(wt(2,"int32")).sum(h).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(h)&&h.length===2){if(l===1)return u.abs().sum(h[0]).max(h[1]-1);if(l===1/0)return u.abs().sum(h[1]).max(h[0]);if(l===-1/0)return u.abs().sum(h[1]).min(h[0]);if(l==="fro"||l==="euclidean")return u.square().sum(h).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+h)})(n=oe(n,"x","norm"),e,t),o=i.shape;if(r){var s=Ii(t,n.shape);o=Is(i.shape,s)}return i.reshape(o)}}),N7=xe({basicLSTMCell_:function(n,e,t,r,i,o){var s=oe(n,"forgetBias","basicLSTMCell"),a=oe(e,"lstmKernel","basicLSTMCell"),u=oe(t,"lstmBias","basicLSTMCell"),l=oe(r,"data","basicLSTMCell"),h=oe(i,"c","basicLSTMCell"),d=oe(o,"h","basicLSTMCell"),p=l.concat(d,1).matMul(a).add(u),m=p.shape[0],w=p.shape[1]/4,b=[m,w],x=p.slice([0,0],b),E=p.slice([0,w],b),A=p.slice([0,2*w],b),N=p.slice([0,3*w],b),F=x.sigmoid().mulStrict(E.tanh()).addStrict(h.mulStrict(s.add(A).sigmoid())),D=F.tanh().mulStrict(N.sigmoid());return[F,D]}}),P7=xe({multiRNNCell_:function(n,e,t,r){for(var i=oe(e,"data","multiRNNCell"),o=Vv(t,"c","multiRNNCell"),s=Vv(r,"h","multiRNNCell"),a=i,u=[],l=0;l<n.length;l++){var h=n[l](a,o[l],s[l]);u.push(h[0]),u.push(h[1]),a=h[1]}var d=[],p=[];for(l=0;l<u.length;l+=2)d.push(u[l]),p.push(u[l+1]);return[d,p]}}),R7=xe({movingAverage_:function(n,e,t,r,i){i===void 0&&(i=!0);var o=oe(n,"v","movingAverage"),s=oe(e,"x","movingAverage"),a=oe(t,"decay","movingAverage");kM(o,s),pe(qi(o.shape,s.shape),(function(){return"Shape mismatch in v and x"}));var u=wt(1),l=u.sub(a),h=s.sub(o).mul(l);if(i){pe(r!=null,(function(){return"When using zeroDebias: true, step is required."}));var d=oe(r,"step","movingAverage");h=h.div(u.sub(Xv(a,d)))}return o.add(h)}}),D7=xe({stridedSlice_:function(n,e,t,r,i,o,s,a,u){if(i===void 0&&(i=0),o===void 0&&(o=0),s===void 0&&(s=0),a===void 0&&(a=0),u===void 0&&(u=0),r==null&&(r=new Array(e.length)),s!==0)throw new Error("ellipsis mask is not yet supported");var l=oe(n,"x","stridedSlice"),h=DE(a),d=l.shape.slice();h.forEach((function(x){e[x]=0,t[x]=1,d.splice(x,0,1)})),l=l.reshape(d);for(var p=0;p<l.rank;p++)e[p]=WF(i,e,r,l.shape,p),t[p]=qF(o,t,r,l.shape,p),r[p]=r[p]||1;var m=DE(u);m.forEach((function(x){t[x]=e[x]+1,r[x]=1}));var w=gb(e,t,r),b=w.filter((function(x,E){return m.indexOf(E)===-1}));return r.every((function(x){return x===1}))?ul(l,e,w).reshape(b):Te.runKernelFunc((function(x){return x.stridedSlice(l,e,t,r)}),{$x:l}).reshape(b)}}),L7=xe({topk_:function(n,e,t){e===void 0&&(e=1),t===void 0&&(t=!0);var r=oe(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=Te.runKernelFunc((function(s){return s.topk(r,e,t)}),{$x:r});return{values:o[0],indices:o[1]}}}),M7=xe({scatterND_:function(n,e,t){var r=oe(n,"indices","scatterND","int32"),i=oe(e,"updates","scatterND");return UF(i,r,t),Te.runKernelFunc((function(o){return o.scatterND(r,i,t)}),{indices:r,updates:i},null,"ScatterNd",{shape:t})}}),kb=xe({fft_:function(n){pe(n.dtype==="complex64",(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+n.dtype+"."}));var e=n.shape[n.shape.length-1],t=n.size/e,r=n.as2D(t,e);return Te.runKernelFunc((function(i){return i.fft(r)}),{input:n}).reshape(n.shape)}}),Yv=xe({ifft_:function(n){pe(n.dtype==="complex64",(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+n.dtype+"."}));var e=n.shape[n.shape.length-1],t=n.size/e,r=n.as2D(t,e);return Te.runKernelFunc((function(i){return i.ifft(r)}),{input:n}).reshape(n.shape)}}),Nb=xe({rfft_:function(n,e){pe(n.dtype==="float32",(function(){return"The dtype for rfft() must be real value but got "+n.dtype}));var t,r=n.shape[n.shape.length-1],i=n.size/r;if(e!=null&&e<r){var o=n.shape.map((function(E){return 0})),s=n.shape.map((function(E){return E}));s[n.shape.length-1]=e,t=n.slice(o,s),r=e}else if(e!=null&&e>r){var a=n.shape.map((function(E){return E}));a[n.shape.length-1]=e-r,t=n.concat(mr(a),n.shape.length-1),r=e}else t=n;var u=t.zerosLike(),l=oo(t,u).as2D(i,r),h=kb(l),d=Math.floor(r/2)+1,p=Pa(h),m=Ku(h),w=p.split([d,r-d],p.shape.length-1),b=m.split([d,r-d],m.shape.length-1),x=t.shape.slice();return x[t.shape.length-1]=d,oo(w[0],b[0]).reshape(x)}}),_I=xe({irfft_:function(n){var e=n.shape[n.shape.length-1],t=n.size/e;if(e<=2){var r=n.as2D(t,e),i=Yv(r);return Pa(i)}var o=[t,2*(e-1)],s=Pa(n).as2D(t,e),a=Ku(n).as2D(t,e),u=s.slice([0,1],[t,e-2]).reverse(1),l=a.slice([0,1],[t,e-2]).reverse(1).mul(wt(-1)),h=s.concat(u,1),d=a.concat(l,1);return r=oo(h,d).as2D(o[0],o[1]),i=Yv(r),Pa(i)}}),F7=Object.freeze({fft:kb,ifft:Yv,rfft:Nb,irfft:_I}),O7=xe({sparseToDense_:function(n,e,t,r){r===void 0&&(r=0);var i=oe(n,"sparseIndices","sparseToDense","int32"),o=oe(e,"sparseValues","sparseToDense"),s=oe(r,"defaultValue","sparseToDense",o.dtype);return(function(a,u,l,h){if(a.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+a.dtype+".");if(a.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+a.shape+".");var d=a.rank>0?a.shape[0]:1,p=a.rank>1?a.shape[1]:1;if(l.length!==p)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+p+".");var m=u.size;if(u.rank!==0&&(u.rank!==1||m!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==h.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")})(i,o,t,s),Te.runKernelFunc((function(a){return a.sparseToDense(i,o,t,s)}),{$sparseIndices:i,$sparseValues:o,$defaultValue:s})}}),B7=xe({gatherND_:function(n,e){var t=oe(e,"indices","gatherND","int32"),r=oe(n,"x","gatherND");return Te.runKernelFunc((function(i){return i.gatherND(r,t)}),{x:r,indices:t},null,"GatherNd")}}),V7=xe({diag_:function(n){var e=oe(n,"x","diag").flatten(),t=n.shape.concat(n.shape);return Te.runKernelFunc((function(r){return r.diag(e)}),{$x:e}).reshape(t)}}),j7=xe({dropout_:function(n,e,t,r){var i=oe(n,"x","dropout");if(pe(i.dtype==="float32",(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."})),pe(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),e===0)return n instanceof Tr?i.clone():i;var o=(function(u,l){if(l==null)return u.shape.slice();if(qi(u.shape,l))return l;if(u.shape.length===l.length){for(var h=[],d=0;d<u.shape.length;d++)l[d]==null&&u.shape[d]!=null?h.push(u.shape[d]):h.push(l[d]);return h}return l})(i,t),s=1-e,a=w3(o,0,1,"float32",r).add(s).floor().div(s);return i.mul(a)}});function EI(n,e,t){for(var r=1-n%2,i=new Float32Array(n),o=0;o<n;++o){var s=2*Math.PI*o/(n+r-1);i[o]=e-t*Math.cos(s)}return ai(i,"float32")}var Pb=xe({hannWindow_:function(n){return EI(n,.5,.5)}}),SI=xe({hammingWindow_:function(n){return EI(n,.54,.46)}}),Rb=xe({frame_:function(n,e,t,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var o=0,s=[];o+e<=n.size;)s.push(ul(n,o,e)),o+=t;if(r)for(;o<n.size;){var a=o+e-n.size,u=_i([ul(n,o,e-a),rl([a],i)]);s.push(u),o+=t}return s.length===0?th([],[0,e]):_i(s).as2D(s.length,e)}}),AI=xe({stft_:function(n,e,t,r,i){var o;i===void 0&&(i=Pb),r==null&&(o=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var s=Rb(n,e,t),a=jo(s,i(e)),u=[],l=0;l<s.shape[0];l++)u.push(Nb(a.slice([l,0],[1,e]),r));return _i(u)}}),U7=Object.freeze({hannWindow:Pb,hammingWindow:SI,frame:Rb,stft:AI}),Oo,z7=function(n,e,t){return t===void 0&&(t=1),kt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d,p,m,w,b,x;return Nt(this,(function(E){switch(E.label){case 0:return r=oe(n,"predictions","inTopK"),i=oe(e,"targets","inTopK"),pe(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),pe(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank})),Yn(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],pe(t>0&&t<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+t})),[4,r.data()];case 1:return s=E.sent(),[4,i.data()];case 2:for(a=E.sent(),u=[s.length/o,o],h=u[1],d=hm("bool",l=u[0]),p=0;p<l;p++){for(m=p*h,w=s.subarray(m,m+h),b=[],x=0;x<w.length;x++)b.push({value:w[x],index:x});for(b.sort((function(A,N){return N.value-A.value})),d[p]=0,x=0;x<t;x++)if(b[x].index===a[p]){d[p]=1;break}}return n!==r&&r.dispose(),e!==i&&i.dispose(),[2,uo(d,i.shape,"bool")]}}))}))};(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Oo||(Oo={}));var W7=xe({absoluteDifference_:function(n,e,t,r){r===void 0&&(r=Oo.SUM_BY_NONZERO_WEIGHTS);var i=oe(n,"labels","absoluteDifference"),o=oe(e,"predictions","absoluteDifference"),s=null;t!=null&&(s=oe(t,"weights","absoluteDifference")),Yn(i.shape,o.shape,"Error in absoluteDifference: ");var a=i.sub(o).abs();return Zl(a,s,r)}}),Zl=xe({computeWeightedLoss_:function(n,e,t){t===void 0&&(t=Oo.SUM_BY_NONZERO_WEIGHTS);var r=oe(n,"losses","computeWeightedLoss"),i=null;e!=null&&(i=oe(e,"weights","computeWeightedLoss"));var o=i==null?r:r.mul(i);if(t===Oo.NONE)return o;if(t===Oo.SUM)return o.sum();if(t===Oo.MEAN){if(i==null)return o.mean();var s=r.size/i.size,a=o.sum().div(i.sum());return s>1?a.div(wt(s)):a}if(t===Oo.SUM_BY_NONZERO_WEIGHTS){if(i==null)return o.sum().div(wt(r.size));var u=i.mul(ip(r.shape)).notEqual(wt(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+t)}}),q7=xe({cosineDistance_:function(n,e,t,r,i){i===void 0&&(i=Oo.SUM_BY_NONZERO_WEIGHTS);var o=oe(n,"labels","cosineDistance"),s=oe(e,"predictions","cosineDistance"),a=null;r!=null&&(a=oe(r,"weights","cosineDistance")),Yn(o.shape,s.shape,"Error in cosineDistance: ");var u=wt(1).sub(o.mul(s).sum(t,!0));return Zl(u,a,i)}}),H7=xe({hingeLoss_:function(n,e,t,r){r===void 0&&(r=Oo.SUM_BY_NONZERO_WEIGHTS);var i=oe(n,"labels","hingeLoss"),o=oe(e,"predictions","hingeLoss"),s=null;t!=null&&(s=oe(t,"weights","hingeLoss")),Yn(i.shape,o.shape,"Error in hingeLoss: ");var a=wt(1);i=wt(2).mul(i).sub(a);var u=a.sub(i.mul(o)).relu();return Zl(u,s,r)}}),G7=xe({huberLoss_:function(n,e,t,r,i){r===void 0&&(r=1),i===void 0&&(i=Oo.SUM_BY_NONZERO_WEIGHTS);var o=oe(n,"labels","huberLoss"),s=oe(e,"predictions","huberLoss"),a=null;t!=null&&(a=oe(t,"weights","huberLoss")),Yn(o.shape,s.shape,"Error in huberLoss: ");var u=wt(r),l=s.sub(o).abs(),h=iI(l,u),d=l.sub(h),p=wt(.5).mul(h.square()).add(u.mul(d));return Zl(p,a,i)}}),$7=xe({logLoss_:function(n,e,t,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=Oo.SUM_BY_NONZERO_WEIGHTS);var o=oe(n,"labels","logLoss"),s=oe(e,"predictions","logLoss"),a=null;t!=null&&(a=oe(t,"weights","logLoss")),Yn(o.shape,s.shape,"Error in logLoss: ");var u=wt(1),l=wt(r),h=o.mul(s.add(l).log()).neg().sub(u.sub(o).mul(u.sub(s).add(l).log()));return Zl(h,a,i)}}),K7=xe({meanSquaredError_:function(n,e,t,r){r===void 0&&(r=Oo.SUM_BY_NONZERO_WEIGHTS);var i=oe(n,"labels","meanSquaredError"),o=oe(e,"predictions","meanSquaredError"),s=null;t!=null&&(s=oe(t,"weights","meanSquaredError")),Yn(i.shape,o.shape,"Error in meanSquaredError: ");var a=i.squaredDifference(o);return Zl(a,s,r)}}),X7=xe({sigmoidCrossEntropy_:function(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=Oo.SUM_BY_NONZERO_WEIGHTS);var o=oe(n,"multiClassLabels","sigmoidCrossEntropy"),s=oe(e,"logits","sigmoidCrossEntropy"),a=null;if(t!=null&&(a=oe(t,"weights","sigmoidCrossEntropy")),Yn(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=wt(r),l=wt(1),h=wt(.5);o=o.mul(l.sub(u)).add(h.mul(u))}var d=(function(p,m){var w=oe(p,"labels","sigmoidCrossEntropyWithLogits"),b=oe(m,"logits","sigmoidCrossEntropyWithLogits");Yn(w.shape,b.shape,"Error in sigmoidCrossEntropyWithLogits: ");var x=b.relu(),E=b.mul(w),A=b.abs().neg().exp().log1p();return x.sub(E).add(A)})(o,s);return Zl(d,a,i)}}),Y7=xe({softmaxCrossEntropy_:function(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=Oo.SUM_BY_NONZERO_WEIGHTS);var o=oe(n,"onehotLabels","softmaxCrossEntropy"),s=oe(e,"logits","softmaxCrossEntropy"),a=null;if(t!=null&&(a=oe(t,"weights","softmaxCrossEntropy")),Yn(o.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){var u=wt(r),l=wt(1),h=wt(o.shape[1]);o=o.mul(l.sub(u)).add(u.div(h))}var d=(function(p,m,w){if(w===void 0&&(w=-1),w===-1&&(w=m.rank-1),w!==m.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+m.rank+" and dim was "+w);return C0((function(b,x,E){var A=x.logSumExp([w],!0),N=x.toFloat().sub(A);return E([b,N]),{value:N.mul(b).neg().sum([w]),gradFunc:function(F,D){var W=D[0],k=D[1],C=Is(F.shape,[w]);return[F.reshape(C).mul(W.toFloat().sub(k.exp())),F.reshape(C).mul(k.exp().sub(W.toFloat()))]}}}))(p,m)})(o,s);return Zl(d,a,i)}}),J7=Object.freeze({get Reduction(){return Oo},absoluteDifference:W7,computeWeightedLoss:Zl,cosineDistance:q7,hingeLoss:H7,huberLoss:G7,logLoss:$7,meanSquaredError:K7,sigmoidCrossEntropy:X7,softmaxCrossEntropy:Y7});function tS(n,e){return e===void 0&&(e=!1),Te.tidy((function(){if(n.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+n.shape.length+"D Tensor.");for(var t=n.shape[0],r=n.shape[1],i=y3(t),o=n.clone(),s=th([[1]],[1,1]),a=s.clone(),u=t>=r?r:t,l=function(d){var p,m=o,w=a,b=i;p=Te.tidy((function(){var x=o.slice([d,d],[t-d,1]),E=x.norm(),A=o.slice([d,d],[1,1]),N=th([[-1]]).where(A.greater(0),th([[1]])),F=A.sub(N.mul(E)),D=x.div(F);a=D.shape[0]===1?s.clone():s.concat(D.slice([1,0],[D.shape[0]-1,D.shape[1]]),0);var W=N.matMul(F).div(E).neg(),k=o.slice([d,0],[t-d,r]),C=W.mul(a);if(d===0)o=k.sub(C.matMul(a.transpose().matMul(k)));else{var L=k.sub(C.matMul(a.transpose().matMul(k)));o=o.slice([0,0],[d,r]).concat(L,0)}var B=i.slice([0,d],[t,i.shape[1]-d]);if(d===0)i=B.sub(B.matMul(a).matMul(C.transpose()));else{var R=B.sub(B.matMul(a).matMul(C.transpose()));i=i.slice([0,0],[t,d]).concat(R,1)}return[a,o,i]})),a=p[0],o=p[1],i=p[2],Cs([m,w,b])},h=0;h<u;++h)l(h);return!e&&t>r&&(i=i.slice([0,0],[t,r]),o=o.slice([0,0],[r,r])),[i,o]}))}var Q7=xe({bandPart_:function(n,e,t){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(t%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+t+".");var r=oe(n,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,o=r.shape.slice(-2),s=o[0],a=o[1];if(!(e<=s))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+s+").");if(!(t<=a))throw new Error("bandPart(): numUpper ("+t+") must not be greater than the number of columns ("+a+").");e<0&&(e=s),t<0&&(t=a);var u=jv(0,s,1,"int32").reshape([-1,1]),l=jv(0,a,1,"int32"),h=Ci(u,l),d=T0(h.lessEqual(wt(+e,"int32")),h.greaterEqual(wt(-t,"int32"))),p=mr([s,a],r.dtype);return na(Ei(r.reshape([-1,s,a])).map((function(m){return gf(d,m,p)}))).reshape(i)}}),Z7=xe({gramSchmidt_:function(n){var e;if(Array.isArray(n)){e=!1,pe(n!=null&&n.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var t=n[0].shape[0],r=function(u){pe(n[u].shape[0]===t,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+n[u].shape[0]+" vs. "+t+")"}))},i=1;i<n.length;++i)r(i)}else e=!0,n=pb(n,n.shape[0],0).map((function(u){return x3(u,[0])}));pe(n.length<=n[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+n.length+") exceeds number of dimensions ("+n[0].shape[0]+")."}));var o=[],s=n,a=function(u){o.push(Te.tidy((function(){var l=s[u];if(u>0)for(var h=0;h<u;++h){var d=vI(o[h].mulStrict(l)).mul(o[h]);l=l.sub(d)}return l.div(xI(l,"euclidean"))})))};for(i=0;i<n.length;++i)a(i);return e?na(o,0):o}}),eV=xe({qr_:function(n,e){if(e===void 0&&(e=!1),n.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+n.rank);if(n.rank===2)return tS(n,e);var t=n.shape.slice(0,n.shape.length-2).reduce((function(s,a){return s*a})),r=Ei(n.reshape([t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),i=[],o=[];return r.forEach((function(s){var a=tS(s,e),u=a[0],l=a[1];i.push(u),o.push(l)})),[na(i,0).reshape(n.shape),na(o,0).reshape(n.shape)]}}),tV=Object.freeze({bandPart:Q7,gramSchmidt:Z7,qr:eV});function R0(n,e,t,r,i,o){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),o==null&&(o=0);var s=n.shape[0];return t=Math.min(t,s),pe(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),pe(n.rank===2,(function(){return"boxes must be a 2D tensor, but was of rank '"+n.rank+"'"})),pe(n.shape[1]===4,(function(){return"boxes must have 4 columns, but 2nd dimension was "+n.shape[1]})),pe(e.rank===1,(function(){return"scores must be a 1D tensor"})),pe(e.shape[0]===s,(function(){return"scores has incompatible shape with boxes. Expected "+s+", but was "+e.shape[0]})),pe(0<=o&&o<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+o+"'"})),{maxOutputSize:t,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}var nV=xe({resizeBilinear_:function(n,e,t){t===void 0&&(t=!1);var r=oe(n,"images","resizeBilinear");pe(r.rank===3||r.rank===4,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),pe(e.length===2,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=Te.runKernelFunc((function(l,h){return h([i]),l.resizeBilinear(i,s,a,t)}),{x:i},(function(l,h){return{x:function(){return Te.runKernelFunc((function(d){return d.resizeBilinearBackprop(l,h[0],t)}),{})}}}),"ResizeBilinear",{alignCorners:t,newHeight:s,newWidth:a});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),rV=xe({resizeNearestNeighbor_:function(n,e,t){t===void 0&&(t=!1);var r=oe(n,"images","resizeNearestNeighbor");pe(r.rank===3||r.rank===4,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),pe(e.length===2,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),pe(r.dtype==="float32"||r.dtype==="int32",(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=Te.runKernelFunc((function(l,h){return h([i]),l.resizeNearestNeighbor(i,s,a,t)}),{batchImages:i},(function(l,h){return{batchImages:function(){return Te.runKernelFunc((function(d){return d.resizeNearestNeighborBackprop(l,h[0],t)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),iV=xe({nonMaxSuppression_:function(n,e,t,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var o=oe(n,"boxes","nonMaxSuppression"),s=oe(e,"scores","nonMaxSuppression"),a=R0(o,s,t,r,i);t=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;var u={maxOutputSize:t,iouThreshold:r,scoreThreshold:i};return Te.runKernelFunc((function(l){return l.nonMaxSuppression(o,s,t,r,i)}),{boxes:o,scores:s},null,"NonMaxSuppressionV3",u)}}),oV=function(n,e,t,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),kt(this,void 0,void 0,(function(){var o,s,a,u,l,h,d;return Nt(this,(function(p){switch(p.label){case 0:return o=oe(n,"boxes","nonMaxSuppressionAsync"),s=oe(e,"scores","nonMaxSuppressionAsync"),a=R0(o,s,t,r,i),t=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold,[4,Promise.all([o.data(),s.data()])];case 1:return u=p.sent(),l=u[0],h=u[1],d=yb(l,h,t,r,i),o!==n&&o.dispose(),s!==e&&s.dispose(),[2,d]}}))}))},sV=xe({nonMaxSuppressionWithScore_:function(n,e,t,r,i,o){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),o===void 0&&(o=0);var s=oe(n,"boxes","nonMaxSuppression"),a=oe(e,"scores","nonMaxSuppression"),u=R0(s,a,t,r,i,o),l={maxOutputSize:t=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:o=u.softNmsSigma},h=Te.runKernel("NonMaxSuppressionV5",{boxes:s,scores:a},l);return{selectedIndices:h[0],selectedScores:h[1]}}}),aV=function(n,e,t,r,i,o){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),o===void 0&&(o=0),kt(this,void 0,void 0,(function(){var s,a,u,l,h,d,p;return Nt(this,(function(m){switch(m.label){case 0:return s=oe(n,"boxes","nonMaxSuppressionAsync"),a=oe(e,"scores","nonMaxSuppressionAsync"),u=R0(s,a,t,r,i,o),t=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,o=u.softNmsSigma,[4,Promise.all([s.data(),a.data()])];case 1:return l=m.sent(),h=l[0],d=l[1],p=wb(h,d,t,r,i,o),s!==n&&s.dispose(),a!==e&&a.dispose(),[2,p]}}))}))},uV=xe({cropAndResize_:function(n,e,t,r,i,o){var s=oe(n,"image","cropAndResize"),a=oe(e,"boxes","cropAndResize","float32"),u=oe(t,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var l=a.shape[0];return pe(s.rank===4,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."})),pe(a.rank===2&&a.shape[1]===4,(function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+a.shape+"."})),pe(u.rank===1&&u.shape[0]===l,(function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+a.shape+"."})),pe(r.length===2,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),pe(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),pe(i==="bilinear"||i==="nearest",(function(){return"method must be bilinear or nearest, but was "+i})),Te.runKernelFunc((function(h,d){return h.cropAndResize(s,a,u,r,i,o)}),{images:s,boxes:a,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:o,cropSize:r})}}),Db=Object.freeze({resizeBilinear:nV,resizeNearestNeighbor:rV,nonMaxSuppression:iV,nonMaxSuppressionAsync:oV,nonMaxSuppressionWithScore:sV,nonMaxSuppressionWithScoreAsync:aV,cropAndResize:uV}),Lb=function(n,e){return!(n>0)||e==="linear"},Mb=function(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return n.mul(e.step());throw new Error("Gradient for activation "+t+" has not been implemented yet.")},Fb=function(n,e){var t=e,r=Ai(n.shape,e.shape);return r.length>0&&(t=t.sum(r)),t.reshape(n.shape)},Ob=function(n,e,t){if(e==="linear")return n;if(e==="relu")return Pr(n);if(e==="elu")return yI(n);if(e==="relu6")return bI(n);if(e==="prelu")return wI(n,t);throw new Error("Unknown fused activation "+e+".")},lV=xe({fusedMatMul_:function(n){var e,t=n.a,r=n.b,i=n.transposeA,o=i!==void 0&&i,s=n.transposeB,a=s!==void 0&&s,u=n.bias,l=n.activation,h=l===void 0?"linear":l,d=n.preluActivationWeights;if(Lb(Te.state.gradientDepth,h)===!1){var p=N0(t,r,o,a);return u!=null&&(p=bn(p,u)),Ob(p,h,d)}var m=oe(t,"a","fused matMul"),w=oe(r,"b","fused matMul");e=Dr(m,w),m=e[0],w=e[1];var b=o?m.shape[m.rank-2]:m.shape[m.rank-1],x=a?w.shape[w.rank-1]:w.shape[w.rank-2],E=o?m.shape[m.rank-1]:m.shape[m.rank-2],A=a?w.shape[w.rank-2]:w.shape[w.rank-1],N=m.shape.slice(0,-2),F=w.shape.slice(0,-2),D=Dt(N),W=Dt(F);pe(m.rank>=2&&w.rank>=2&&m.rank===w.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+m.rank+" and "+w.rank+"."})),pe(qi(N,F),(function(){return"Error in fused matMul: outer dimensions ("+N+") and ("+F+") of Tensors with shapes "+m.shape+" and "+w.shape+" must match."})),pe(b===x,(function(){return"Error in fused matMul: inner shapes ("+b+") and ("+x+") of Tensors with shapes "+m.shape+" and "+w.shape+" and transposeA="+o+" and transposeB="+a+" must match."}));var k,C,L=m.shape.slice(0,-2).concat([E,A]),B=o?m.as3D(D,b,E):m.as3D(D,E,b),R=a?w.as3D(W,A,x):w.as3D(W,x,A);u!=null&&_n(L,(k=Dr(k=oe(u,"bias","fused matMul"),m)[0]).shape),d!=null&&(C=oe(d,"prelu weights","fused matMul"));var M={a:B,b:R};u!=null&&(M.bias=k),d!=null&&(M.preluActivationWeights=C);var U=[B,R];return Te.runKernelFunc((function(J,de){var fe=J.fusedBatchMatMul({a:B,b:R,transposeA:o,transposeB:a,bias:k,activation:h,preluActivationWeights:C});return de([B,R,fe]),fe}),M,(function(J,de){var fe=de[0],he=de[1],K=de[2],le=Mb(J,K,h),se={};return u!=null&&(se={bias:function(){return Fb(k,le)}}),Object.assign(o||a?!o&&a?{a:function(){return le.matMul(he,!1,!1)},b:function(){return le.matMul(fe,!0,!1)}}:o&&!a?{a:function(){return he.matMul(le,!1,!0)},b:function(){return fe.matMul(le,!1,!1)}}:{a:function(){return he.matMul(le,!0,!0)},b:function(){return le.matMul(fe,!0,!0)}}:{a:function(){return le.matMul(he,!1,!0)},b:function(){return fe.matMul(le,!0,!1)}},se)}),"_FusedMatMul",{transposeA:o,transposeB:a,activation:h},U,[!0]).reshape(L)}}),cV=xe({fusedConv2d_:function(n){var e=n.x,t=n.filter,r=n.strides,i=n.pad,o=n.dataFormat,s=o===void 0?"NHWC":o,a=n.dilations,u=a===void 0?[1,1]:a,l=n.dimRoundingMode,h=n.bias,d=n.activation,p=d===void 0?"linear":d,m=n.preluActivationWeights;if(p=p||"linear",Lb(Te.state.gradientDepth,p)===!1){var w=Da(e,t,r,i,s,u,l);return h!=null&&(w=bn(w,h)),Ob(w,p,m)}var b=oe(e,"x","conv2d"),x=oe(t,"filter","conv2d"),E=b,A=!1;b.rank===3&&(A=!0,E=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),pe(E.rank===4,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+E.rank+"."})),pe(x.rank===4,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+x.rank+"."})),l!=null&&pe(ei(i),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."})),pe(E.shape[3]===x.shape[2],(function(){return"Error in conv2d: depth of input ("+E.shape[3]+") must match input depth for filter "+x.shape[2]+"."})),pe(Ts(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),pe(s==="NHWC",(function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."}));var N,F,D=Af(E.shape,x.shape,r,u,i,l);h!=null&&(N=Dr(N=oe(h,"bias","fused conv2d"),b)[0],_n(D.outShape,N.shape)),m!=null&&(F=oe(m,"prelu weights","fused conv2d"));var W={x:E,filter:x};h!=null&&(W.bias=N),m!=null&&(W.preluActivationWeights=F);var k=[x,E],C=Te.runKernelFunc((function(L,B){var R=L.fusedConv2d({input:E,filter:x,convInfo:D,bias:N,activation:p,preluActivationWeights:F});return B([x,E,R]),R}),W,(function(L,B){var R=B,M=R[0],U=R[1],J=R[2],de=Mb(L,J,p);pe(Gd(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var fe={};return h!=null&&(fe={bias:function(){return Fb(N,de)}}),Object.assign({x:function(){return cI(U.shape,de,M,r,i)},filter:function(){return Ib(U,de,M.shape,r,i)}},fe)}),"FusedConv2D",{convInfo:D,activation:p},k,[!0]);return A?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),hV=xe({fusedDepthwiseConv2d_:function(n){var e=n.x,t=n.filter,r=n.strides,i=n.pad,o=n.dataFormat,s=o===void 0?"NHWC":o,a=n.dilations,u=a===void 0?[1,1]:a,l=n.dimRoundingMode,h=n.bias,d=n.activation,p=d===void 0?"linear":d,m=n.preluActivationWeights;if(Lb(Te.state.gradientDepth,p)===!1){var w=k0(e,t,r,i,s,u,l);return h!=null&&(w=bn(w,h)),Ob(w,p,m)}var b=oe(e,"x","depthwiseConv2d"),x=oe(t,"filter","depthwiseConv2d"),E=b,A=!1;b.rank===3&&(A=!0,E=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),pe(E.rank===4,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+E.rank+"."})),pe(x.rank===4,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+x.rank+"."})),pe(E.shape[3]===x.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+E.shape[3]+") must match the inChannels dimension in filter "+x.shape[2]+"."})),u==null&&(u=[1,1]),pe(Ts(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),l!=null&&pe(ei(i),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."}));var N,F,D=Af(E.shape,x.shape,r,u,i,l,!0);h!=null&&(N=Dr(N=oe(h,"bias","fused conv2d"),b)[0],_n(D.outShape,N.shape)),m!=null&&(F=oe(m,"prelu weights","fused depthwiseConv2d"));var W={x:E,filter:x};h!=null&&(W.bias=N),m!=null&&(W.preluActivationWeights=F);var k=[x,E],C=Te.runKernelFunc((function(L,B){var R=L.fusedDepthwiseConv2D({input:E,filter:x,convInfo:D,bias:N,activation:p,preluActivationWeights:F});return B([x,E,R]),R}),W,(function(L,B){pe(Gd(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var R=B[0],M=B[1],U=B[2],J=Mb(L,U,p),de={};return h!=null&&(de={bias:function(){return Fb(N,J)}}),Object.assign({x:function(){return hI(M.shape,J,R,D)},filter:function(){return fI(M,J,R.shape,D)}},de)}),"FusedDepthwiseConv2D",{convInfo:D,activation:p},k,[!0]);return A?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),fV=Object.freeze({matMul:lV,conv2d:cV,depthwiseConv2d:hV}),dV=Object.freeze({image:Db,linalg:tV,losses:J7,spectral:F7,fused:fV,signal:U7,square:$8,squaredDifference:K3,conv1d:n7,conv2d:Da,conv3d:r7,depthwiseConv2d:k0,separableConv2d:Tb,conv2dTranspose:i7,conv3dTranspose:o7,op:xe,batchNormalization2d:EB,batchNormalization3d:SB,batchNormalization4d:AB,batchNormalization:CB,batchNorm:eI,batchNorm2d:IB,batchNorm3d:TB,batchNorm4d:kB,booleanMaskAsync:t7,complex:oo,real:Pa,imag:Ku,concat:_i,concat1d:fF,concat2d:dF,concat3d:pF,concat4d:mF,split:pb,matMul:N0,dot:s7,outerProduct:a7,reverse:Om,reverse1d:u7,reverse2d:l7,reverse3d:c7,reverse4d:h7,maxPool:Ui,avgPool:Bm,pool:f7,maxPool3d:d7,avgPool3d:p7,slice:ul,slice1d:m7,slice2d:g7,slice3d:mI,slice4d:v7,abs:K8,acos:X8,acosh:Y8,asin:J8,asinh:Q8,atan:Z8,atanh:eB,ceil:tB,clipByValue:Sb,cos:nB,cosh:rB,erf:iB,exp:M2,expm1:oB,floor:sB,log:aB,log1p:uB,logSigmoid:lB,neg:Kv,reciprocal:cB,round:hB,rsqrt:X3,sigmoid:Y3,sign:fB,isNaN:dB,isInf:pB,isFinite:mB,sin:gB,sinh:vB,softplus:yB,sqrt:wB,step:bB,tan:xB,tanh:_B,all:y7,any:w7,argMax:b7,argMin:x7,logSumExp:_7,max:P0,mean:E7,min:S7,moments:A7,sum:vI,prod:C7,equal:oI,equalStrict:HB,greater:GB,greaterEqual:sI,greaterEqualStrict:$B,greaterStrict:KB,less:XB,lessEqual:YB,lessEqualStrict:JB,lessStrict:QB,notEqual:ZB,notEqualStrict:e7,add:bn,addN:RB,addStrict:DB,atan2:LB,div:hu,divNoNan:MB,divStrict:FB,floorDiv:rI,maximum:Ab,maximumStrict:OB,minimum:iI,minimumStrict:BB,mod:VB,modStrict:jB,mul:jo,mulStrict:UB,pow:Xv,powStrict:zB,squaredDifferenceStrict:WB,sub:Ci,subStrict:qB,elu:yI,leakyRelu:I7,prelu:wI,relu:Pr,relu6:bI,selu:T7,logicalAnd:T0,logicalNot:NB,logicalOr:tI,logicalXor:PB,where:gf,whereAsync:nI,buffer:un,print:SF,batchToSpaceND:v3,broadcastTo:AF,cast:CF,clone:IF,cumsum:TF,depthToSpace:kF,expandDims:Na,eye:y3,multinomial:NF,oneHot:P2,pad:Sf,pad1d:PF,pad2d:RF,pad3d:DF,pad4d:LF,rand:MF,randomNormal:FF,randomGamma:OF,randomUniform:w3,reshape:du,spaceToBatchND:b3,squeeze:x3,stack:na,tile:_d,truncatedNormal:BF,unstack:Ei,setdiff1dAsync:VF,fill:rl,linspace:hF,ones:ip,range:jv,scalar:wt,tensor:uo,tensor1d:ai,tensor2d:th,tensor3d:db,tensor4d:Ss,tensor5d:uF,tensor6d:lF,variable:cF,zeros:mr,onesLike:g3,zerosLike:Nn,transpose:dh,softmax:Ql,logSoftmax:GF,localResponseNormalization:k7,norm:xI,gather:Cb,unsortedSegmentSum:aI,basicLSTMCell:N7,multiRNNCell:P7,movingAverage:R7,stridedSlice:D7,topk:L7,scatterND:M7,fft:kb,ifft:Yv,rfft:Nb,irfft:_I,sparseToDense:O7,gatherND:B7,diag:V7,dropout:j7,hannWindow:Pb,hammingWindow:SI,frame:Rb,stft:AI,inTopKAsync:z7});function nt(n,e){Array.isArray(n)||(n=[n]),n.forEach((function(t){t!=null&&pe(t.dtype!=="complex64",(function(){return e+" does not support complex64 tensors."}))}))}function Iy(n,e,t,r){if(t==="linear")return n.linear(e);if(t==="relu")return n.relu(e);if(t==="elu")return n.elu(e);if(t==="relu6")return n.relu6(e);if(t==="prelu")return n.prelu(e,r);throw new Error("Activation "+t+" has not been implemented for the CPU backend.")}var pV=(function(n){function e(){var t=n.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new T3(t,Te),t}return yu(e,n),e.prototype.write=function(t,r,i){this.firstUse&&(this.firstUse=!1,Ye().get("IS_NODE")&&Bv(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var o={};return this.data.set(o,{values:t,dtype:i}),o},e.prototype.move=function(t,r,i,o){this.data.set(t,{values:r,dtype:o})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(t){return kt(this,void 0,void 0,(function(){return Nt(this,(function(r){return[2,this.readSync(t)]}))}))},e.prototype.readSync=function(t){var r=this.data.get(t),i=r.dtype,o=r.complexTensors;return i==="complex64"?L2(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var r=this.readSync(t.dataId),i=r;if(t.dtype==="string")try{i=r.map((function(o){return Mv(o)}))}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return un(t.shape,t.dtype,i)},e.prototype.makeOutput=function(t,r,i){var o=this.write(t,r,i);return Te.makeTensorFromDataId(o,r,i,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var r=this.data.get(t).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return kt(this,void 0,void 0,(function(){var r;return Nt(this,(function(i){return r=Gu(),t(),[2,{kernelMs:Gu()-r}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,r){var i=this.makeOutput(null,t.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:Te.keep(t.clone()),imag:Te.keep(r.clone())},i},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,r,i){if(nt(t,"slice"),C3(t.shape,r,i)){var o=I3(r,t.strides),s=Dt(i);return uo(this.readSync(t.dataId).subarray(o,o+s),i,t.dtype)}for(var a=un(i,t.dtype),u=this.bufferSync(t),l=0;l<a.size;++l){var h=a.indexToLoc(l).map((function(d,p){return d+r[p]}));a.values[l]=u.get.apply(u,h)}return a.toTensor()},e.prototype.stridedSlice=function(t,r,i,o){nt(t,"stridedSlice");var s=gb(r,i,o);if(s.some((function(m){return m===0})))return uo([],s);for(var a=un(s,t.dtype),u=this.bufferSync(t),l=0;l<a.size;l++){for(var h=a.indexToLoc(l),d=new Array(h.length),p=0;p<d.length;p++)d[p]=h[p]*o[p]+r[p];a.set.apply(a,[u.get.apply(u,d)].concat(h))}return a.toTensor()},e.prototype.diag=function(t){for(var r=this.readSync(t.dataId),i=un([t.size,t.size],t.dtype),o=i.values,s=0;s<r.length;s++)o[s*t.size+s]=r[s];return i.toTensor()},e.prototype.unstack=function(t,r){for(var i=t.shape[r],o=new Array(t.rank-1),s=0,a=0;a<t.rank;a++)a!==r&&(o[s++]=t.shape[a]);var u=new Array(t.rank).fill(0),l=t.shape.slice();l[r]=1;var h=new Array(i);for(a=0;a<h.length;a++)u[r]=a,h[a]=this.slice(t,u,l).reshape(o);return h},e.prototype.reverse=function(t,r){nt(t,"reverse");for(var i=un(t.shape,t.dtype),o=this.bufferSync(t),s=function(u){var l=i.indexToLoc(u),h=l.slice();r.forEach((function(d){return h[d]=t.shape[d]-1-h[d]})),i.set.apply(i,[o.get.apply(o,h)].concat(l))},a=0;a<i.size;a++)s(a);return i.toTensor()},e.prototype.concat=function(t,r){var i=this;if(t[0].dtype==="complex64"){var o=t.map((function(m){return Pa(m)})),s=t.map((function(m){return Ku(m)}));return oo(this.concat(o,r),this.concat(s,r))}var a=t.map((function(m){var w=Dt(m.shape.slice(r));return m.as2D(-1,w)})),u=Hd(a.map((function(m){return m.shape})),1),l=un(u,t[0].dtype).values;if(a[0].shape[0]===1){var h=0;a.forEach((function(m){l.set(i.readSync(m.dataId),h),h+=m.size}))}else{var d=0;a.forEach((function(m){for(var w=i.readSync(m.dataId),b=0,x=0;x<m.shape[0];++x)for(var E=x*u[1]+d,A=0;A<m.shape[1];++A)l[E+A]=w[b++];d+=m.shape[1]}))}var p=Hd(t.map((function(m){return m.shape})),r);return uo(l,p,t[0].dtype)},e.prototype.neg=function(t){return nt(t,"neg"),this.multiply(wt(-1),t)},e.prototype.add=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),(function(i,o,s,a){return{real:i+s,imag:o+a}})):this.broadcastedBinaryOp(t,r,so(t.dtype,r.dtype),(function(i,o){return i+o}))},e.prototype.addN=function(t){var r=this;nt(t,"addN");for(var i=t.map((function(h){return r.readSync(h.dataId)})),o=un(t[0].shape,t[0].dtype),s=o.values,a=0;a<t.length;a++)for(var u=i[a],l=0;l<s.length;l++)s[l]+=u[l];return o.toTensor()},e.prototype.softmax=function(t,r){var i=Ii([r],t.shape),o=this.max(t,i),s=Is(o.shape,i),a=this.subtract(t,o.reshape(s)),u=this.exp(a),l=this.sum(u,i).reshape(s);return this.realDivide(u,l)},e.prototype.subtract=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),(function(i,o,s,a){return{real:i-s,imag:o-a}})):this.broadcastedBinaryOp(t,r,so(t.dtype,r.dtype),(function(i,o){return i-o}))},e.prototype.pow=function(t,r){return nt([t,r],"pow"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.pow(i,o)}))},e.prototype.batchMatMul=function(t,r,i,o){nt([t,r],"matMul");for(var s=i?t.shape[1]:t.shape[2],a=i?t.shape[2]:t.shape[1],u=o?r.shape[1]:r.shape[2],l=t.shape[0],h=this.readSync(t.dataId),d=this.readSync(r.dataId),p=i?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],m=p[0],w=p[1],b=p[2],x=o?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],E=x[0],A=x[1],N=x[2],F=a*u,D=un([l,a,u],t.dtype),W=D.values,k=this.blockSize,C=0;C<l;C++)for(var L=0;L<a;L+=k)for(var B=0;B<u;B+=k)for(var R=0;R<s;R+=k)for(var M=Math.min(L+k,a),U=Math.min(B+k,u),J=Math.min(R+k,s),de=L;de<M;de++)for(var fe=B;fe<U;fe++){for(var he=0,K=R;K<J;K++)he+=h[C*m+de*w+K*b]*d[K*E+fe*A+C*N];W[C*F+(de*u+fe)]+=he}return D.toTensor()},e.prototype.fusedBatchMatMul=function(t){var r=t.a,i=t.b,o=t.transposeA,s=t.transposeB,a=t.bias,u=t.activation,l=t.preluActivationWeights,h=this.batchMatMul(r,i,o,s);return a&&(h=this.add(h,a)),u&&(h=Iy(this,h,u,l)),h},e.prototype.multiply=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),(function(i,o,s,a){return{real:i*s-o*a,imag:i*a+o*s}})):this.broadcastedBinaryOp(t,r,so(t.dtype,r.dtype),(function(i,o){return i*o}))},e.prototype.realDivide=function(t,r){return nt([t,r],"realDivide"),this.broadcastedBinaryOp(t,r,"float32",(function(i,o){return i/o}))},e.prototype.floorDiv=function(t,r){return nt([t,r],"floorDiv"),this.broadcastedBinaryOp(t,r,"int32",(function(i,o){return Math.floor(i/o)}))},e.prototype.sum=function(t,r){nt(t,"sum"),Ks("sum",r,t.rank);for(var i=Ro(t.shape,r),o=i[0],s=i[1],a=mr(o,so(t.dtype,"int32")),u=Dt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var p=d*u,m=0,w=0;w<u;++w)m+=h[p+w];l[d]=m}return a},e.prototype.prod=function(t,r){nt(t,"sum");for(var i=Ro(t.shape,r),o=i[0],s=i[1],a=mr(o,so(t.dtype,"int32")),u=Dt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var p=d*u,m=1,w=0;w<u;++w)m*=h[p+w];l[d]=m}return a},e.prototype.unsortedSegmentSum=function(t,r,i){nt(t,"unsortedSegmentSum");for(var o=[],s=t.rank-r.rank,a=0;a<s;++a)r=r.expandDims(a+1);for(a=0;a<i;++a){var u=wt(a,"int32"),l=oI(u,r).asType("float32").mul(t).sum(0);o.push(l)}return na(o)},e.prototype.argMin=function(t,r){nt(t,"argMin");var i=[r];Ks("argMin",i,t.rank);for(var o=Ro(t.shape,i),s=o[0],a=o[1],u=mr(s,"int32"),l=Dt(a),h=this.readSync(u.dataId),d=this.readSync(t.dataId),p=0;p<h.length;++p){for(var m=p*l,w=d[m],b=0,x=0;x<l;++x){var E=d[m+x];E<w&&(w=E,b=x)}h[p]=b}return u},e.prototype.argMax=function(t,r){nt(t,"argMax");var i=[r];Ks("argMax",i,t.rank);for(var o=Ro(t.shape,i),s=o[0],a=o[1],u=mr(s,"int32"),l=Dt(a),h=this.readSync(u.dataId),d=this.readSync(t.dataId),p=0;p<h.length;++p){for(var m=p*l,w=d[m],b=0,x=0;x<l;++x){var E=d[m+x];E>w&&(w=E,b=x)}h[p]=b}return u},e.prototype.cumsum=function(t,r,i,o){if(nt(t,"cumsum"),r!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+r);for(var s=so(t.dtype,"int32"),a=mr(t.shape,s),u=this.readSync(a.dataId),l=this.readSync(t.dataId),h=t.shape[t.rank-1],d=o?function(x,E){return x+h-E-1}:function(x,E){return x+E},p=0;p<l.length;p+=h)for(var m=0;m<h;m++){var w=d(p,m);if(m===0)u[w]=i?0:l[w];else{var b=d(p,m-1);u[w]=i?l[b]+u[b]:l[w]+u[b]}}return a},e.prototype.equal=function(t,r){return nt([t,r],"equal"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i===o?1:0}))},e.prototype.notEqual=function(t,r){return nt([t,r],"notEqual"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i!==o?1:0}))},e.prototype.less=function(t,r){return nt([t,r],"less"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i<o?1:0}))},e.prototype.lessEqual=function(t,r){return nt([t,r],"lessEqual"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i<=o?1:0}))},e.prototype.greater=function(t,r){return nt([t,r],"greater"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i>o?1:0}))},e.prototype.greaterEqual=function(t,r){return nt([t,r],"greaterEqual"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i>=o?1:0}))},e.prototype.logicalNot=function(t){nt(t,"logicalNot");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r[o]?0:1;return this.makeOutput(i,t.shape,"bool")},e.prototype.logicalAnd=function(t,r){return nt([t,r],"logicalAnd"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i&&o}))},e.prototype.logicalOr=function(t,r){return nt([t,r],"logicalOr"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i||o}))},e.prototype.select=function(t,r,i){nt([t,r,i],"select");for(var o=this.readSync(t.dataId),s=this.readSync(r.dataId),a=this.readSync(i.dataId),u=mr(r.shape,so(r.dtype,i.dtype)),l=this.readSync(u.dataId),h=0,d=t.rank===0||t.rank>1||r.rank===1?1:Dt(r.shape.slice(1)),p=0;p<o.length;p++)for(var m=0;m<d;m++)o[p]===1?l[h++]=s[p]:l[h++]=a[p];return u},e.prototype.where=function(t){nt([t],"where");var r=this.readSync(t.dataId);return bb(t.shape,r)},e.prototype.topk=function(t,r,i){return nt(t,"topk"),F3(this.readSync(t.dataId),t.shape,t.dtype,r)},e.prototype.min=function(t,r){nt(t,"min"),Ks("min",r,t.rank);for(var i=Ro(t.shape,r),o=i[0],s=i[1],a=mr(o,t.dtype),u=Dt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var p=d*u,m=h[p],w=0;w<u;++w){var b=h[p+w];b<m&&(m=b)}l[d]=m}return a},e.prototype.minimum=function(t,r){return nt([t,r],"minimum"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.min(i,o)}))},e.prototype.mod=function(t,r){return nt([t,r],"mod"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){var s=i%o;return i<0&&o<0||i>=0&&o>=0?s:(s+o)%o}))},e.prototype.max=function(t,r){nt(t,"max"),Ks("max",r,t.rank);for(var i=Ro(t.shape,r),o=i[0],s=i[1],a=mr(o,t.dtype),u=Dt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var p=d*u,m=h[p],w=0;w<u;++w){var b=h[p+w];b>m&&(m=b)}l[d]=m}return a},e.prototype.maximum=function(t,r){return nt([t,r],"maximum"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.max(i,o)}))},e.prototype.all=function(t,r){nt(t,"all"),Ks("all",r,t.rank);for(var i=Ro(t.shape,r),o=i[0],s=i[1],a=mr(o,t.dtype),u=Dt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var p=d*u,m=h[p],w=0;w<u;++w){var b=h[p+w];m=m&&b}l[d]=m}return a},e.prototype.any=function(t,r){nt(t,"any"),Ks("any",r,t.rank);for(var i=Ro(t.shape,r),o=i[0],s=i[1],a=mr(o,t.dtype),u=Dt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var p=d*u,m=h[p],w=0;w<u;++w){var b=h[p+w];m=m||b}l[d]=m}return a},e.prototype.squaredDifference=function(t,r){return nt([t,r],"squaredDifference"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){var s=i-o;return s*s}))},e.prototype.ceil=function(t){nt(t,"ceil");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.ceil(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.floor=function(t){nt(t,"floor");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.floor(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.sign=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)r[o]<0?i[o]=-1:r[o]>0?i[o]=1:i[o]=0;return this.makeOutput(i,t.shape,"float32")},e.prototype.isNaN=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isNaN(r[o])&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.isInf=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Math.abs(r[o])===1/0&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.isFinite=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isFinite(r[o])&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.round=function(t){nt(t,"round");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=Math.floor(r[o]);r[o]-s<.5?i[o]=Math.floor(r[o]):r[o]-s>.5?i[o]=Math.ceil(r[o]):i[o]=s%2==0?s:s+1}return this.makeOutput(i,t.shape,"float32")},e.prototype.exp=function(t){nt(t,"exp");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.exp(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.expm1=function(t){nt(t,"expm1");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.expm1(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.log=function(t){nt(t,"log");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=Math.log(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.log1p=function(t){nt(t,"log1p");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=Math.log1p(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.sqrt=function(t){nt(t,"sqrt");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=Math.sqrt(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.rsqrt=function(t){nt(t,"rsqrt");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=1/Math.sqrt(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.reciprocal=function(t){nt(t,"reciprocal");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=1/r[o];return this.makeOutput(i,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){nt(t,"relu");for(var r=mr(t.shape,t.dtype),i=this.readSync(r.dataId),o=this.readSync(t.dataId),s=0;s<o.length;++s)i[s]=Math.max(0,o[s]);return r},e.prototype.relu6=function(t){nt(t,"relu");for(var r=mr(t.shape,t.dtype),i=this.readSync(r.dataId),o=this.readSync(t.dataId),s=0;s<o.length;++s)i[s]=Math.min(Math.max(0,o[s]),6);return r},e.prototype.prelu=function(t,r){return nt([t,r],"prelu"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return i<0?o*i:i}))},e.prototype.elu=function(t){nt(t,"elu");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var s=i[o];r[o]=s>=0?s:Math.exp(s)-1}return this.makeOutput(r,t.shape,"float32")},e.prototype.eluDer=function(t,r){nt([t,r],"eluDer");for(var i=new Float32Array(r.size),o=this.readSync(r.dataId),s=this.readSync(t.dataId),a=0;a<o.length;++a){var u=o[a];i[a]=u>=1?s[a]:s[a]*(u+1)}return this.makeOutput(i,r.shape,"float32")},e.prototype.selu=function(t){nt(t,"selu");for(var r=_b,i=Eb,o=new Float32Array(t.size),s=this.readSync(t.dataId),a=0;a<s.length;++a){var u=s[a];o[a]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(o,t.shape,"float32")},e.prototype.clip=function(t,r,i){nt(t,"clip");for(var o=new Float32Array(t.size),s=this.readSync(t.dataId),a=0;a<s.length;++a){var u=s[a];o[a]=u>i?i:u<r?r:u}return this.makeOutput(o,t.shape,"float32")},e.prototype.abs=function(t){for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.abs(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<t.size;++o){var s=i[2*o],a=i[2*o+1];r[o]=Math.hypot(s,a)}return this.makeOutput(r,t.shape,"float32")},e.prototype.int=function(t){nt(t,"int");for(var r=new Int32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=i[o];return this.makeOutput(r,t.shape,"int32")},e.prototype.sigmoid=function(t){nt(t,"sigmoid");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=1/(1+Math.exp(-i[o]));return this.makeOutput(r,t.shape,"float32")},e.prototype.softplus=function(t){nt(t,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(t.size),o=this.readSync(t.dataId),s=0;s<o.length;++s){var a=o[s]>-r,u=o[s]<r,l=Math.exp(o[s]),h=void 0;h=u?l:a?o[s]:Math.log(1+l),i[s]=h}return this.makeOutput(i,t.shape,"float32")},e.prototype.sin=function(t){nt(t,"sin");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.sin(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.cos=function(t){nt(t,"cos");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.cos(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.tan=function(t){nt(t,"tan");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.tan(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.asin=function(t){nt(t,"asin");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.asin(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.acos=function(t){nt(t,"acos");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.acos(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atan=function(t){nt(t,"atan");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.atan(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atan2=function(t,r){return nt([t,r],"atan2"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.atan2(i,o)}))},e.prototype.sinh=function(t){nt(t,"sinh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.sinh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.cosh=function(t){nt(t,"cosh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.cosh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.tanh=function(t){nt(t,"tanh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=mM(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.asinh=function(t){nt(t,"asinh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.asinh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.acosh=function(t){nt(t,"acosh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.acosh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atanh=function(t){nt(t,"atanh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.atanh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.erf=function(t){nt(t,"erf");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var s=Math.sign(i[o]),a=Math.abs(i[o]),u=1/(1+.3275911*a);r[o]=s*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-a*a))}return this.makeOutput(r,t.shape,"float32")},e.prototype.step=function(t,r){r===void 0&&(r=0),nt(t,"step");for(var i=new Float32Array(t.size),o=this.readSync(t.dataId),s=0;s<o.length;++s){var a=o[s];isNaN(a)?i[s]=NaN:i[s]=a>0?1:r}return this.makeOutput(i,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var r=t.input,i=t.filter,o=t.convInfo,s=t.bias,a=t.activation,u=t.preluActivationWeights,l=this.conv2d(r,i,o);return s&&(l=this.add(l,s)),a&&(l=Iy(this,l,a,u)),l},e.prototype.conv2d=function(t,r,i){nt([t,r],"conv2d");for(var o=i.filterHeight,s=i.filterWidth,a=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,h=i.padInfo.top,d=i.dataFormat==="channelsLast",p=un(i.outShape,t.dtype),m=t.strides[0],w=d?t.strides[1]:t.strides[2],b=d?t.strides[2]:1,x=d?1:t.strides[1],E=p.strides[0],A=d?p.strides[1]:p.strides[2],N=d?p.strides[2]:1,F=d?1:p.strides[1],D=this.readSync(t.dataId),W=this.readSync(r.dataId),k=p.values,C=0;C<i.batchSize;++C)for(var L=C*m,B=C*E,R=0;R<i.outHeight;++R)for(var M=B+R*A,U=R*i.strideHeight-h,J=0;J<o;J++){var de=U+J*a;if(!(de<0||de>=i.inHeight))for(var fe=J*r.strides[0],he=L+de*w,K=0;K<i.outWidth;++K)for(var le=M+K*N,se=K*i.strideWidth-l,re=0;re<s;re++){var j=se+re*u;if(!(j<0||j>=i.inWidth))for(var $=he+j*b,ne=fe+re*r.strides[1],ce=0;ce<i.inChannels;++ce){for(var ge=D[$+ce*x],ye=0;ye<i.outChannels;++ye)k[le+ye*F]+=ge*W[ne+ye];ne+=i.outChannels}}}return p.toTensor()},e.prototype.conv3d=function(t,r,i){for(var o=i.filterDepth,s=i.filterHeight,a=i.filterWidth,u=i.dilationDepth,l=i.dilationHeight,h=i.dilationWidth,d=i.padInfo.front,p=i.padInfo.left,m=i.padInfo.top,w=un(i.outShape,t.dtype),b=this.readSync(t.dataId),x=this.readSync(r.dataId),E=w.values,A=0;A<i.batchSize;++A)for(var N=A*t.strides[0],F=A*w.strides[0],D=0;D<i.outDepth;++D)for(var W=F+D*w.strides[1],k=D*i.strideDepth-d,C=0;C<o;C++){var L=k+C*u;if(!(L<0||L>=i.inDepth))for(var B=C*r.strides[0],R=N+L*t.strides[1],M=0;M<i.outHeight;++M)for(var U=W+M*w.strides[2],J=M*i.strideHeight-m,de=0;de<s;de++){var fe=J+de*l;if(!(fe<0||fe>=i.inHeight))for(var he=B+de*r.strides[1],K=R+fe*t.strides[2],le=0;le<i.outWidth;++le)for(var se=U+le*i.outChannels,re=le*i.strideWidth-p,j=0;j<a;j++){var $=re+j*h;if(!($<0||$>=i.inWidth))for(var ne=he+j*r.strides[2],ce=K+$*i.inChannels,ge=ne,ye=0;ye<i.inChannels;++ye){for(var be=b[ce+ye],Ae=0;Ae<i.outChannels;++Ae)E[se+Ae]+=be*x[ge+Ae];ge+=i.outChannels}}}}return w.toTensor()},e.prototype.conv2dDerInput=function(t,r,i){nt([t,r],"conv2dDerInput");for(var o=un(i.inShape,"float32"),s=o.values,a=this.readSync(t.dataId),u=this.readSync(r.dataId),l=r.strides,h=l[0],d=l[1],p=l[2],m=i.batchSize,w=i.filterHeight,b=i.filterWidth,x=i.inChannels,E=i.inHeight,A=i.inWidth,N=i.outChannels,F=i.outHeight,D=i.outWidth,W=i.strideHeight,k=i.strideWidth,C=i.dataFormat,L=w-1-i.padInfo.top,B=b-1-i.padInfo.left,R=C==="channelsLast",M=o.strides[0],U=R?o.strides[1]:o.strides[2],J=R?o.strides[2]:1,de=R?1:o.strides[1],fe=t.strides[0],he=R?t.strides[1]:t.strides[2],K=R?t.strides[2]:1,le=R?1:t.strides[1],se=0;se<m;++se)for(var re=0;re<x;++re)for(var j=0;j<E;++j)for(var $=j-L,ne=Math.max(0,Math.ceil($/W)),ce=Math.min(F,(w+$)/W),ge=0;ge<A;++ge){for(var ye=ge-B,be=Math.max(0,Math.ceil(ye/k)),Ae=Math.min(D,(b+ye)/k),$e=0,Ue=ne;Ue<ce;++Ue)for(var et=Ue*W-$,Je=be;Je<Ae;++Je)for(var Be=fe*se+he*Ue+K*Je,_e=h*(w-1-et)+d*(b-1-(Je*k-ye))+p*re,ie=0;ie<N;++ie)$e+=a[Be+le*ie]*u[_e+ie];s[M*se+U*j+J*ge+de*re]=$e}return o.toTensor()},e.prototype.conv3dDerInput=function(t,r,i){for(var o=un(i.inShape,"float32"),s=o.values,a=o.strides,u=a[0],l=a[1],h=a[2],d=a[3],p=this.readSync(t.dataId),m=t.strides,w=m[0],b=m[1],x=m[2],E=m[3],A=this.readSync(r.dataId),N=r.strides,F=N[0],D=N[1],W=N[2],k=N[3],C=i.batchSize,L=i.filterDepth,B=i.filterHeight,R=i.filterWidth,M=i.inChannels,U=i.inDepth,J=i.inHeight,de=i.inWidth,fe=i.outChannels,he=i.outDepth,K=i.outHeight,le=i.outWidth,se=i.strideDepth,re=i.strideHeight,j=i.strideWidth,$=L-1-i.padInfo.front,ne=B-1-i.padInfo.top,ce=R-1-i.padInfo.left,ge=0;ge<C;++ge)for(var ye=0;ye<M;++ye)for(var be=0;be<U;++be)for(var Ae=be-$,$e=Math.max(0,Math.ceil(Ae/se)),Ue=Math.min(he,(L+Ae)/se),et=0;et<J;++et)for(var Je=et-ne,Be=Math.max(0,Math.ceil(Je/re)),_e=Math.min(K,(B+Je)/re),ie=0;ie<de;++ie){for(var ft=ie-ce,dt=Math.max(0,Math.ceil(ft/j)),Ze=Math.min(le,(R+ft)/j),at=0,lt=$e;lt<Ue;++lt)for(var ct=lt*se-Ae,xt=Be;xt<_e;++xt)for(var Vt=xt*re-Je,jt=dt;jt<Ze;++jt)for(var Pt=w*ge+b*lt+x*xt+E*jt,Lt=F*(L-1-ct)+D*(B-1-Vt)+W*(R-1-(jt*j-ft))+k*ye,Yt=0;Yt<fe;++Yt)at+=p[Pt+Yt]*A[Lt+Yt];s[u*ge+l*be+h*et+d*ie+ye]=at}return o.toTensor()},e.prototype.conv2dDerFilter=function(t,r,i){nt([t,r],"conv2dDerFilter");for(var o=i.strideHeight,s=i.strideWidth,a=i.filterHeight,u=i.filterWidth,l=i.dataFormat==="channelsLast",h=un(i.filterShape,"float32"),d=i.padInfo.left,p=i.padInfo.top,m=this.bufferSync(t),w=this.bufferSync(r),b=0;b<a;++b)for(var x=Math.max(0,Math.ceil((p-b)/o)),E=Math.min(i.outHeight,(i.inHeight+p-b)/o),A=0;A<u;++A)for(var N=Math.max(0,Math.ceil((d-A)/s)),F=Math.min(i.outWidth,(i.inWidth+d-A)/s),D=0;D<i.inChannels;++D)for(var W=0;W<i.outChannels;++W){for(var k=0,C=0;C<i.batchSize;++C)for(var L=x;L<E;++L)for(var B=b+L*o-p,R=N;R<F;++R){var M=A+R*s-d;k+=l?m.get(C,B,M,D)*w.get(C,L,R,W):m.get(C,D,B,M)*w.get(C,W,L,R)}h.set(k,b,A,D,W)}return h.toTensor()},e.prototype.conv3dDerFilter=function(t,r,i){for(var o=i.strideDepth,s=i.strideHeight,a=i.strideWidth,u=i.filterDepth,l=i.filterHeight,h=i.filterWidth,d=un(i.filterShape,"float32"),p=d.values,m=d.strides,w=m[0],b=m[1],x=m[2],E=m[3],A=this.readSync(r.dataId),N=r.strides,F=N[0],D=N[1],W=N[2],k=N[3],C=this.readSync(t.dataId),L=t.strides,B=L[0],R=L[1],M=L[2],U=L[3],J=i.padInfo.front,de=i.padInfo.left,fe=i.padInfo.top,he=0;he<u;++he)for(var K=Math.max(0,Math.ceil((J-he)/o)),le=Math.min(i.outDepth,(i.inDepth+J-he)/o),se=he*w,re=0;re<l;++re)for(var j=Math.max(0,Math.ceil((fe-re)/s)),$=Math.min(i.outHeight,(i.inHeight+fe-re)/s),ne=re*b+se,ce=0;ce<h;++ce)for(var ge=Math.max(0,Math.ceil((de-ce)/a)),ye=Math.min(i.outWidth,(i.inWidth+de-ce)/a),be=ce*x+ne,Ae=0;Ae<i.inChannels;++Ae)for(var $e=Ae*E+be,Ue=0;Ue<i.outChannels;++Ue){for(var et=0,Je=0;Je<i.batchSize;++Je)for(var Be=Je*B,_e=Je*F,ie=K;ie<le;++ie)for(var ft=(he+ie*o-J)*R+Be,dt=ie*D+_e,Ze=j;Ze<$;++Ze)for(var at=(re+Ze*s-fe)*M+ft,lt=Ze*W+dt,ct=ge;ct<ye;++ct){var xt=ct*k+lt;et+=C[(ce+ct*a-de)*U+at+Ae]*A[xt+Ue]}p[$e+Ue]=et}return d.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var r=t.input,i=t.filter,o=t.convInfo,s=t.bias,a=t.activation,u=t.preluActivationWeights,l=this.depthwiseConv2D(r,i,o);return s&&(l=this.add(l,s)),a&&(l=Iy(this,l,a,u)),l},e.prototype.depthwiseConv2D=function(t,r,i){nt([t,r],"depthwiseConv2D");for(var o=i.filterHeight,s=i.filterWidth,a=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,h=i.padInfo.top,d=i.outChannels/i.inChannels,p=un(i.outShape,t.dtype),m=this.readSync(t.dataId),w=this.readSync(r.dataId),b=p.values,x=0;x<i.batchSize;++x)for(var E=x*t.strides[0],A=x*p.strides[0],N=0;N<i.outHeight;++N)for(var F=A+N*p.strides[1],D=N*i.strideHeight-l,W=0;W<o;++W){var k=D+W*a;if(!(k<0||k>=i.inHeight))for(var C=W*r.strides[0],L=E+k*t.strides[1],B=0;B<i.outWidth;++B)for(var R=F+B*p.strides[2],M=B*i.strideWidth-h,U=0;U<s;++U){var J=M+U*u;if(!(J<0||J>=i.inWidth))for(var de=C+U*r.strides[1],fe=L+J*i.inChannels,he=R,K=de,le=0;le<i.inChannels;++le){for(var se=m[fe+le],re=0;re<d;++re)b[he+re]+=se*w[K+re];he+=d,K+=d}}}return p.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,r,i){nt([t,r],"depthwiseConv2DDerInput");for(var o=un(i.inShape,"float32"),s=o.values,a=o.strides,u=a[0],l=a[1],h=a[2],d=this.readSync(t.dataId),p=t.strides,m=p[0],w=p[1],b=p[2],x=this.readSync(r.dataId),E=r.strides,A=E[0],N=E[1],F=E[2],D=i.batchSize,W=i.filterHeight,k=i.filterWidth,C=i.inChannels,L=i.inHeight,B=i.inWidth,R=i.outChannels,M=i.outHeight,U=i.outWidth,J=i.strideHeight,de=i.strideWidth,fe=W-1-i.padInfo.top,he=k-1-i.padInfo.left,K=R/C,le=0;le<D;++le)for(var se=0;se<C;++se)for(var re=0;re<L;++re)for(var j=re-fe,$=Math.max(0,Math.ceil(j/J)),ne=Math.min(M,(W+j)/J),ce=0;ce<B;++ce){for(var ge=ce-he,ye=Math.max(0,Math.ceil(ge/de)),be=Math.min(U,(k+ge)/de),Ae=0,$e=$;$e<ne;++$e)for(var Ue=$e*J-j,et=ye;et<be;++et)for(var Je=m*le+w*$e+b*et,Be=A*(W-1-Ue)+N*(k-1-(et*de-ge))+F*se,_e=0;_e<K;++_e)Ae+=d[Je+(se*K+_e)]*x[Be+_e];s[u*le+l*re+h*ce+se]=Ae}return o.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,r,i){nt([t,r],"depthwiseConv2DDerFilter");for(var o=i.strideHeight,s=i.strideWidth,a=i.filterHeight,u=i.filterWidth,l=un(i.filterShape,"float32"),h=i.padInfo.left,d=i.padInfo.top,p=i.outChannels/i.inChannels,m=this.bufferSync(t),w=this.bufferSync(r),b=0;b<a;++b)for(var x=Math.max(0,Math.ceil((d-b)/o)),E=Math.min(i.outHeight,(i.inHeight+d-b)/o),A=0;A<u;++A)for(var N=Math.max(0,Math.ceil((h-A)/s)),F=Math.min(i.outWidth,(i.inWidth+h-A)/s),D=0;D<i.outChannels;++D){for(var W=Math.trunc(D/p),k=D%p,C=0,L=0;L<i.batchSize;++L)for(var B=x;B<E;++B)for(var R=b+B*o-d,M=N;M<F;++M){var U=A+M*s-h;C+=m.get(L,R,U,W)*w.get(L,B,M,D)}l.set(C,b,A,W,k)}return l.toTensor()},e.prototype.tile=function(t,r){return nt(t,"tile"),M3(this.bufferSync(t),r)},e.prototype.pad=function(t,r,i){nt(t,"pad");var o=r.map((function(p,m){return p[0]+t.shape[m]+p[1]})),s=r.map((function(p){return p[0]})),a=this.bufferSync(t),u=un(o,t.dtype);i!==0&&u.values.fill(i);for(var l=0;l<t.size;l++){var h=a.indexToLoc(l),d=h.map((function(p,m){return p+s[m]}));u.set.apply(u,[a.get.apply(a,h)].concat(d))}return u.toTensor()},e.prototype.transpose=function(t,r){nt(t,"transpose");for(var i=new Array(t.rank),o=0;o<i.length;o++)i[o]=t.shape[r[o]];var s=this.readSync(t.dataId),a=un(i,t.dtype),u=this.bufferSync(t);for(o=0;o<t.size;++o){for(var l=u.indexToLoc(o),h=new Array(l.length),d=0;d<h.length;d++)h[d]=l[r[d]];var p=a.locToIndex(h);a.values[p]=s[o]}return a.toTensor()},e.prototype.gather=function(t,r,i){nt([t,r],"gather");var o=t.shape.slice(),s=this.readSync(r.dataId);o[i]=s.length;for(var a=un(o,t.dtype),u=this.bufferSync(t),l=0;l<a.size;++l){var h=a.indexToLoc(l),d=h.slice();d[i]=s[h[i]];var p=u.locToIndex(d);a.values[l]=u.values[p]}return a.toTensor()},e.prototype.batchToSpaceND=function(t,r,i){nt([t],"batchToSpaceND");var o=r.reduce((function(d,p){return d*p})),s=Uv(t.shape,r,o),a=zv(s.length,r.length),u=Wv(t.shape,r,o),l=_3(i,r.length),h=E3(u,i,r.length);return t.reshape(s).transpose(a).reshape(u).slice(l,h)},e.prototype.spaceToBatchND=function(t,r,i){nt([t],"spaceToBatchND");var o=r.reduce((function(p,m){return p*m})),s=[[0,0]];s.push.apply(s,i);for(var a=1+r.length;a<t.shape.length;++a)s.push([0,0]);var u=t.pad(s),l=Uv(u.shape,r,o,!1),h=zv(l.length,r.length,!1),d=Wv(u.shape,r,o,!1);return u.reshape(l).transpose(h).reshape(d)},e.prototype.pool=function(t,r,i){nt(t,"pool");for(var o=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,m=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=this.readSync(t.dataId),b=un(r.outShape,t.dtype),x=b.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3],A=r.outShape[2]*r.outShape[3],N=r.outShape[3],F=0;F<r.batchSize;++F)for(var D=F*E,W=F*t.strides[0],k=0;k<r.inChannels;++k)for(var C=0;C<r.outHeight;++C)for(var L=C*o-d,B=Math.max(0,L),R=Math.min(r.inHeight,l+L),M=D+C*A,U=0;U<r.outWidth;++U){for(var J=U*s-p,de=Math.max(0,J),fe=Math.min(r.inWidth,h+J),he=m,K=0,le=0,se=B;se<R;se+=a){for(var re=W+se*t.strides[1],j=de;j<fe;j+=u){var $=w[re+j*t.strides[2]+k];i==="max"&&$>he?he=$:i==="avg"&&(K+=$,le++)}if(isNaN(he))break}x[M+U*N+k]=i==="avg"?K/le:he}return b.toTensor()},e.prototype.maxPool=function(t,r){return this.pool(t,r,"max")},e.prototype.maxPoolPositions=function(t,r){for(var i=un(r.outShape,"int32"),o=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,m=this.bufferSync(t),w=0;w<r.batchSize;++w)for(var b=0;b<r.inChannels;++b)for(var x=0;x<r.outHeight;++x){for(var E=x*o-d,A=E;A<0;)A+=a;for(var N=Math.min(r.inHeight,l+E),F=0;F<r.outWidth;++F){for(var D=F*s-p,W=D;W<0;)W+=u;for(var k=Math.min(r.inWidth,h+D),C=Number.NEGATIVE_INFINITY,L=-1,B=A;B<N;B+=a)for(var R=B-E,M=W;M<k;M+=u){var U=M-D,J=m.get(w,B,M,b);J>C&&(C=J,L=R*h+U)}i.set(L,w,x,F,b)}}return i.toTensor()},e.prototype.maxPoolBackprop=function(t,r,i,o){nt([r,i],"maxPoolBackprop");for(var s=this.maxPoolPositions(r,o),a=o.strideHeight,u=o.strideWidth,l=o.dilationHeight,h=o.dilationWidth,d=o.effectiveFilterHeight,p=o.effectiveFilterWidth,m=p-1-o.padInfo.left,w=d-1-o.padInfo.top,b=un(r.shape,"float32"),x=this.bufferSync(s),E=this.bufferSync(t),A=0;A<o.batchSize;++A)for(var N=0;N<o.inChannels;++N)for(var F=0;F<o.inHeight;++F)for(var D=0;D<o.inWidth;++D){for(var W=F-w,k=D-m,C=0,L=0;L<d;L+=l){var B=(W+L)/a;if(!(B<0||B>=o.outHeight||Math.floor(B)!==B))for(var R=0;R<p;R+=h){var M=(k+R)/u;if(!(M<0||M>=o.outWidth||Math.floor(M)!==M)){var U=d*p-1-x.get(A,B,M,N)===L*p+R?1:0;U!==0&&(C+=E.get(A,B,M,N)*U)}}}b.set(C,A,F,D,N)}return b.toTensor()},e.prototype.avgPoolBackprop=function(t,r,i){nt([t,r],"avgPoolBackprop");for(var o=i.strideHeight,s=i.strideWidth,a=i.filterHeight,u=i.filterWidth,l=i.dilationHeight,h=i.dilationWidth,d=i.effectiveFilterHeight,p=i.effectiveFilterWidth,m=p-1-i.padInfo.left,w=d-1-i.padInfo.top,b=un(r.shape,"float32"),x=1/(a*u),E=this.bufferSync(t),A=0;A<i.batchSize;++A)for(var N=0;N<i.inChannels;++N)for(var F=0;F<i.inHeight;++F)for(var D=0;D<i.inWidth;++D){for(var W=F-w,k=D-m,C=0,L=0;L<d;L+=l){var B=(W+L)/o;if(!(B<0||B>=i.outHeight||Math.floor(B)!==B))for(var R=0;R<p;R+=h){var M=(k+R)/s;M<0||M>=i.outWidth||Math.floor(M)!==M||(C+=E.get(A,B,M,N))}}b.set(C*x,A,F,D,N)}return b.toTensor()},e.prototype.pool3d=function(t,r,i){nt(t,"pool3d");for(var o=r.strideDepth,s=r.strideHeight,a=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,p=r.effectiveFilterHeight,m=r.effectiveFilterWidth,w=r.padInfo.front,b=r.padInfo.top,x=r.padInfo.left,E=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,A=this.readSync(t.dataId),N=un(r.outShape,t.dtype),F=N.values,D=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],W=r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[3]*r.outShape[4],C=r.outShape[4],L=0;L<r.batchSize;++L)for(var B=L*D,R=L*t.strides[0],M=0;M<r.inChannels;++M)for(var U=0;U<r.outDepth;++U){for(var J=U*o-w,de=J;de<0;)de+=u;for(var fe=Math.min(r.inDepth,d+J),he=B+U*W,K=0;K<r.outHeight;++K){for(var le=K*s-b,se=le;se<0;)se+=l;for(var re=Math.min(r.inHeight,p+le),j=he+K*k,$=0;$<r.outWidth;++$){for(var ne=$*a-x,ce=ne;ce<0;)ce+=h;for(var ge=Math.min(r.inWidth,m+ne),ye=j+$*C,be=E,Ae=0,$e=0,Ue=de;Ue<fe;Ue+=u){for(var et=R+Ue*t.strides[1],Je=se;Je<re;Je+=l){for(var Be=et+Je*t.strides[2],_e=ce;_e<ge;_e+=h){var ie=A[Be+_e*t.strides[3]+M];if(i==="max"&&ie>be?be=ie:i==="avg"&&(Ae+=ie,$e++),isNaN(be))break}if(isNaN(be))break}if(isNaN(be))break}F[ye+M]=i==="avg"?Ae/$e:be}}}return N.toTensor()},e.prototype.avgPool3d=function(t,r){return nt(t,"avgPool3d"),this.pool3d(t,r,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,r,i){nt([t,r],"avgPool3dBackprop");for(var o=i.strideDepth,s=i.strideHeight,a=i.strideWidth,u=i.filterDepth,l=i.filterHeight,h=i.filterWidth,d=i.dilationDepth,p=i.dilationHeight,m=i.dilationWidth,w=i.effectiveFilterDepth,b=i.effectiveFilterHeight,x=i.effectiveFilterWidth,E=w-1-i.padInfo.front,A=x-1-i.padInfo.left,N=b-1-i.padInfo.top,F=un(r.shape,"float32"),D=1/(u*l*h),W=this.bufferSync(t),k=0;k<i.batchSize;++k)for(var C=0;C<i.inChannels;++C)for(var L=0;L<i.inDepth;++L)for(var B=0;B<i.inHeight;++B)for(var R=0;R<i.inWidth;++R){for(var M=L-E,U=B-N,J=R-A,de=0,fe=0;fe<w;fe+=d){var he=(M+fe)/o;if(!(he<0||he>=i.outDepth||Math.floor(he)!==he))for(var K=0;K<b;K+=p){var le=(U+K)/s;if(!(le<0||le>=i.outHeight||Math.floor(le)!==le))for(var se=0;se<x;se+=m){var re=(J+se)/a;re<0||re>=i.outWidth||Math.floor(re)!==re||(de+=W.get(k,he,le,re,C))}}}F.set(de*D,k,L,B,R,C)}return F.toTensor()},e.prototype.maxPool3d=function(t,r){return nt(t,"maxPool3d"),this.pool3d(t,r,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,r){for(var i=un(r.outShape,"int32"),o=r.strideDepth,s=r.strideHeight,a=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,p=r.effectiveFilterHeight,m=r.effectiveFilterWidth,w=r.padInfo.front,b=r.padInfo.top,x=r.padInfo.left,E=this.bufferSync(t),A=0;A<r.batchSize;++A)for(var N=0;N<r.inChannels;++N)for(var F=0;F<r.outDepth;++F){for(var D=F*o-w,W=D;W<0;)W+=u;for(var k=Math.min(r.inDepth,d+D),C=0;C<r.outHeight;++C){for(var L=C*s-b,B=L;B<0;)B+=l;for(var R=Math.min(r.inHeight,p+L),M=0;M<r.outWidth;++M){for(var U=M*a-x,J=U;J<0;)J+=h;for(var de=Math.min(r.inWidth,m+U),fe=Number.NEGATIVE_INFINITY,he=-1,K=W;K<k;K+=u)for(var le=K-D,se=B;se<R;se+=l)for(var re=se-L,j=J;j<de;j+=h){var $=j-U,ne=E.get(A,K,se,j,N);ne>=fe&&(fe=ne,he=le*p*m+re*p+$)}i.set(he,A,F,C,M,N)}}}return i.toTensor()},e.prototype.maxPool3dBackprop=function(t,r,i,o){nt([r,i],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(r,o),a=o.strideDepth,u=o.strideHeight,l=o.strideWidth,h=o.dilationDepth,d=o.dilationHeight,p=o.dilationWidth,m=o.effectiveFilterDepth,w=o.effectiveFilterHeight,b=o.effectiveFilterWidth,x=m-1-o.padInfo.front,E=b-1-o.padInfo.left,A=w-1-o.padInfo.top,N=un(r.shape,"float32"),F=this.bufferSync(s),D=this.bufferSync(t),W=0;W<o.batchSize;++W)for(var k=0;k<o.inChannels;++k)for(var C=0;C<o.inDepth;++C)for(var L=0;L<o.inHeight;++L)for(var B=0;B<o.inWidth;++B){for(var R=C-x,M=L-A,U=B-E,J=0,de=0;de<m;de+=h){var fe=(R+de)/a;if(!(fe<0||fe>=o.outDepth||Math.floor(fe)!==fe))for(var he=0;he<w;he+=d){var K=(M+he)/u;if(!(K<0||K>=o.outHeight||Math.floor(K)!==K))for(var le=0;le<b;le+=p){var se=(U+le)/l;if(!(se<0||se>=o.outWidth||Math.floor(se)!==se)){var re=m*w*b-1-F.get(W,fe,K,se,k)===de*w*b+he*b+le?1:0;re!==0&&(J+=D.get(W,fe,K,se,k)*re)}}}}N.set(J,W,C,L,B,k)}return N.toTensor()},e.prototype.cast=function(t,r){return P3(t,r,this)},e.prototype.reshape=function(t,r){return D2(t,r)},e.prototype.avgPool=function(t,r){return nt(t,"avgPool"),this.pool(t,r,"avg").toFloat()},e.prototype.resizeBilinear=function(t,r,i,o){nt(t,"resizeBilinear");for(var s=t.shape,a=s[0],u=s[1],l=s[2],h=s[3],d=this.readSync(t.dataId),p=new Float32Array(Dt([a,r,i,h])),m=[o&&r>1?u-1:u,o&&i>1?l-1:l],w=[o&&r>1?r-1:r,o&&i>1?i-1:i],b=0,x=m[0]/w[0],E=m[1]/w[1],A=0;A<a;A++)for(var N=0;N<r;N++)for(var F=x*N,D=Math.floor(F),W=F-D,k=Math.min(u-1,Math.ceil(F)),C=A*t.strides[0]+D*t.strides[1],L=A*t.strides[0]+k*t.strides[1],B=0;B<i;B++)for(var R=E*B,M=Math.floor(R),U=R-M,J=Math.min(l-1,Math.ceil(R)),de=C+M*t.strides[2],fe=L+M*t.strides[2],he=C+J*t.strides[2],K=L+J*t.strides[2],le=0;le<h;le++){var se=d[de+le],re=d[fe+le],j=se+(d[he+le]-se)*U,$=j+(re+(d[K+le]-re)*U-j)*W;p[b++]=$}return uo(p,[a,r,i,h])},e.prototype.resizeBilinearBackprop=function(t,r,i){nt([t,r],"resizeBilinearBackprop");for(var o=r.shape,s=o[0],a=o[1],u=o[2],l=o[3],h=t.shape,d=h[1],p=h[2],m=new Float32Array(s*a*u*l),w=[i&&d>1?a-1:a,i&&p>1?u-1:u],b=[i&&d>1?d-1:d,i&&p>1?p-1:p],x=w[0]/b[0],E=w[1]/b[1],A=this.readSync(t.dataId),N=0,F=0;F<s;F++)for(var D=F*r.strides[0],W=0;W<d;W++)for(var k=W*x,C=Math.floor(k),L=Math.min(Math.ceil(k),a-1),B=D+C*r.strides[1],R=D+L*r.strides[1],M=k-C,U=1-M,J=0;J<p;J++)for(var de=J*E,fe=Math.floor(de),he=Math.min(Math.ceil(de),u-1),K=de-fe,le=1-K,se=B+fe*r.strides[2],re=B+he*r.strides[2],j=R+fe*r.strides[2],$=R+he*r.strides[2],ne=U*le,ce=U*K,ge=M*le,ye=M*K,be=0;be<l;be++){var Ae=A[N++];m[se+be]+=Ae*ne,m[re+be]+=Ae*ce,m[j+be]+=Ae*ge,m[$+be]+=Ae*ye}return Ss(m,[s,u,a,l],r.dtype)},e.prototype.resizeNearestNeighbor=function(t,r,i,o){nt(t,"resizeNearestNeighbor");for(var s=t.shape,a=s[0],u=s[1],l=s[2],h=s[3],d=this.readSync(t.dataId),p=new Float32Array(a*r*i*h),m=[o&&r>1?u-1:u,o&&i>1?l-1:l],w=[o&&r>1?r-1:r,o&&i>1?i-1:i],b=m[0]/w[0],x=m[1]/w[1],E=0,A=0;A<a;A++)for(var N=A*t.strides[0],F=0;F<r;F++)for(var D=b*F,W=N+Math.min(u-1,o?Math.round(D):Math.floor(D))*t.strides[1],k=0;k<i;k++)for(var C=x*k,L=W+Math.min(l-1,o?Math.round(C):Math.floor(C))*t.strides[2],B=0;B<h;B++){var R=d[L+B];p[E++]=R}return uo(p,[a,r,i,h],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,r,i){nt([t,r],"resizeNearestNeighborBackprop");for(var o=r.shape,s=o[0],a=o[1],u=o[2],l=o[3],h=t.shape,d=h[1],p=h[2],m=new Float32Array(s*a*u*l),w=this.readSync(t.dataId),b=[i&&d>1?a-1:a,i&&p>1?u-1:u],x=[i&&d>1?d-1:d,i&&p>1?p-1:p],E=b[0]/x[0],A=b[1]/x[1],N=1/E,F=1/A,D=2*Math.ceil(N)+2,W=2*Math.ceil(F)+2,k=0;k<s;k++)for(var C=k*r.strides[0],L=0;L<a;L++)for(var B=C+L*r.strides[1],R=Math.floor(L*N),M=Math.floor(R-D/2),U=0;U<u;U++)for(var J=B+U*r.strides[2],de=Math.floor(U*F),fe=Math.floor(de-W/2),he=0;he<l;he++){for(var K=0,le=0;le<D;le++){var se=le+M;if(!(se<0||se>=d)){var re=C+se*t.strides[1],j=se*E;if(L===Math.min(a-1,i?Math.round(j):Math.floor(j)))for(var $=0;$<W;$++){var ne=$+fe;if(!(ne<0||ne>=p)){var ce=re+ne*t.strides[2],ge=ne*A;U===Math.min(u-1,i?Math.round(ge):Math.floor(ge))&&(K+=w[ce+he])}}}}m[J+he]=K}return Ss(m,r.shape,r.dtype)},e.prototype.batchNormalization=function(t,r,i,o,s,a){nt([t,r,i,s,a],"batchNorm");for(var u=this.readSync(t.dataId),l=this.readSync(r.dataId),h=this.readSync(i.dataId),d=s?this.readSync(s.dataId):new Float32Array([1]),p=a?this.readSync(a.dataId):new Float32Array([0]),m=new Float32Array(u.length),w=p.length,b=d.length,x=h.length,E=l.length,A=0,N=0,F=0,D=0,W=0;W<u.length;++W)m[W]=p[A++]+(u[W]-l[N++])*d[F++]/Math.sqrt(h[D++]+o),A>=w&&(A=0),N>=E&&(N=0),F>=b&&(F=0),D>=x&&(D=0);return Ss(m,t.shape)},e.prototype.localResponseNormalization4D=function(t,r,i,o,s){nt(t,"localResponseNormalization4D");var a=t.shape[3],u=a-1,l=this.readSync(t.dataId),h=t.size,d=new Float32Array(h);function p(x){for(var E=x%a,A=x-E+Math.max(0,E-r),N=x-E+Math.min(E+r,u),F=0;A<=N;A++){var D=l[A];F+=D*D}return F}for(var m=0;m<h;m++){var w=p(m),b=l[m]*Math.pow(i+o*w,-s);d[m]=b}return Ss(d,t.shape)},e.prototype.LRNGrad=function(t,r,i,o,s,a,u){nt(t,"LRNGrad");for(var l=t.shape[3],h=this.readSync(t.dataId),d=this.readSync(r.dataId),p=this.readSync(i.dataId),m=new Float32Array(t.size),w=t.size,b=0;b<w;b++){for(var x=b%l,E=b-x+Math.max(0,x-o),A=b-x+Math.min(l,x+o+1),N=0,F=E;F<A;F++)N+=Math.pow(d[F],2);for(N=a*N+s,F=E;F<A;F++){var D=-2*a*u*d[F]*p[b]/N;b===F&&(D+=Math.pow(N,-u)),D*=h[b],m[F]+=D}}return Ss(m,t.shape)},e.prototype.multinomial=function(t,r,i,o){nt(t,"multinomial");for(var s=r?t:Ql(t),a=s.shape[0],u=s.shape[1],l=mr([a,i],"int32"),h=this.readSync(l.dataId),d=this.readSync(s.dataId),p=0;p<a;++p){var m=p*u,w=new Float32Array(u-1);w[0]=d[m];for(var b=1;b<w.length;++b)w[b]=w[b-1]+d[m+b];for(var x=A0(o.toString()),E=p*i,A=0;A<i;++A){var N=x();h[E+A]=w.length;for(var F=0;F<w.length;F++)if(N<w[F]){h[E+A]=F;break}}}return l},e.prototype.oneHot=function(t,r,i,o){nt(t,"oneHot");var s=new Float32Array(t.size*r);s.fill(o);for(var a=this.readSync(t.dataId),u=0;u<t.size;++u)a[u]>=0&&a[u]<r&&(s[u*r+a[u]]=i);return th(s,[t.size,r],"int32")},e.prototype.nonMaxSuppression=function(t,r,i,o,s){return nt(t,"nonMaxSuppression"),yb(this.readSync(t.dataId),this.readSync(r.dataId),i,o,s)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,r){for(var i=t.shape[0],o=t.shape[1],s=un(t.shape,"float32"),a=un(t.shape,"float32"),u=Pa(t).as2D(i,o),l=Ku(t).as2D(i,o),h=0;h<i;h++)for(var d=u.slice([h,0],[1,o]),p=l.slice([h,0],[1,o]),m=oo(d,p),w=this.readSync(this.fftImpl(m,r).dataId),b=0;b<o;b++){var x=LE(w,b);s.values[h*o+b]=x.real,a.values[h*o+b]=x.imag}return oo(s.toTensor(),a.toTensor()).as2D(i,o)},e.prototype.fftImpl=function(t,r){var i=t.as1D(),o=i.size;if(this.isExponentOf2(o)){var s=this.fftRadix2(i,o,r).as2D(t.shape[0],t.shape[1]);return r&&(s=oo(Pa(s).div(wt(o)),Ku(s).div(wt(o)))),s}var a=this.readSync(t.dataId),u=(function(l){for(var h=new Float32Array(l.length/2),d=new Float32Array(l.length/2),p=0;p<l.length;p+=2)h[p/2]=l[p],d[p/2]=l[p+1];return{real:h,imag:d}})(this.fourierTransformByMatmul(a,o,r));return oo(u.real,u.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return(t&t-1)==0},e.prototype.fftRadix2=function(t,r,i){if(r===1)return t;var o=this.readSync(t.dataId),s=r/2,a=(function(E){for(var A=Math.ceil(E.length/4),N=new Float32Array(A),F=new Float32Array(A),D=0;D<E.length;D+=4)N[Math.floor(D/4)]=E[D],F[Math.floor(D/4)]=E[D+1];return{real:N,imag:F}})(o),u=oo(a.real,a.imag).as1D(),l=(function(E){for(var A=Math.floor(E.length/4),N=new Float32Array(A),F=new Float32Array(A),D=2;D<E.length;D+=4)N[Math.floor(D/4)]=E[D],F[Math.floor(D/4)]=E[D+1];return{real:N,imag:F}})(o),h=oo(l.real,l.imag).as1D();u=this.fftRadix2(u,s,i),h=this.fftRadix2(h,s,i);var d=(function(E,A){for(var N=new Float32Array(E/2),F=new Float32Array(E/2),D=0;D<Math.ceil(E/2);D++){var W=(A?2:-2)*Math.PI*(D/E);N[D]=Math.cos(W),F[D]=Math.sin(W)}return{real:N,imag:F}})(r,i),p=oo(d.real,d.imag).mul(h),m=u.add(p),w=u.sub(p),b=Pa(m).concat(Pa(w)),x=Ku(m).concat(Ku(w));return oo(b,x).as1D()},e.prototype.fourierTransformByMatmul=function(t,r,i){for(var o=new Float32Array(2*r),s=0;s<r;s++){for(var a=0,u=0,l=0;l<r;l++){var h=KF(s*l,r,i),d=LE(t,l);a+=d.real*h.real-d.imag*h.imag,u+=d.real*h.imag+d.imag*h.real}i&&(a/=r,u/=r),$F(o,a,u,s)}return o},e.prototype.depthToSpace=function(t,r,i){pe(i==="NHWC",(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i})),pe(r>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+r}));for(var o=t.shape[0],s=t.shape[1],a=t.shape[2],u=t.shape[3],l=s*r,h=a*r,d=u/(r*r),p=this.readSync(t.dataId),m=new Float32Array(o*l*h*d),w=0,b=0;b<o;++b)for(var x=0;x<l;++x)for(var E=Math.floor(x/r),A=x%r,N=0;N<h;++N)for(var F=Math.floor(N/r),D=(A*r+N%r)*d,W=0;W<d;++W){var k=W+D+u*(F+a*(E+s*b));m[w++]=p[k]}return Ss(m,[o,l,h,d])},e.prototype.broadcastedBinaryOp=function(t,r,i,o){var s=_n(t.shape,r.shape),a=un(s,i),u=this.readSync(t.dataId),l=this.readSync(r.dataId),h=Yc(t.shape,s),d=Yc(r.shape,s),p=a.values;if(h.length+d.length===0)for(var m=0;m<p.length;++m)p[m]=o(u[m%u.length],l[m%l.length]);else{var w=this.bufferSync(t),b=this.bufferSync(r),x=function(E){var A=a.indexToLoc(E),N=A.slice(-t.rank);h.forEach((function(k){return N[k]=0}));var F=w.locToIndex(N),D=A.slice(-r.rank);d.forEach((function(k){return D[k]=0}));var W=b.locToIndex(D);p[E]=o(u[F],l[W])};for(m=0;m<p.length;++m)x(m)}return a.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,r,i){var o=_n(t.shape,r.shape),s=un(o,"float32"),a=un(o,"float32"),u=this.readSync(t.dataId),l=this.readSync(r.dataId),h=Yc(t.shape,o),d=Yc(r.shape,o),p=s.values,m=a.values;if(h.length+d.length===0)for(var w=0;w<p.length;w++){var b=w%u.length,x=w%l.length,E=i(u[2*b],u[2*b+1],l[2*x],l[2*x+1]);p[w]=E.real,m[w]=E.imag}else{var A=this.bufferSync(this.data.get(t.dataId).complexTensors.real),N=this.bufferSync(this.data.get(r.dataId).complexTensors.real),F=function(D){var W=s.indexToLoc(D),k=W.slice(-t.rank);h.forEach((function(M){return k[M]=0}));var C=A.locToIndex(k),L=W.slice(-r.rank);d.forEach((function(M){return L[M]=0}));var B=N.locToIndex(L),R=i(u[2*C],u[2*C+1],l[2*B],l[2*B+1]);p[D]=R.real,m[D]=R.imag};for(w=0;w<p.length;w++)F(w)}return this.complex(s.toTensor(),a.toTensor())},e.prototype.split=function(t,r,i){return L3(t,r,i)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,r,i,o,s,a){for(var u=t.shape,l=u[0],h=u[1],d=u[2],p=u[3],m=r.shape[0],w=o[0],b=o[1],x=un([m,w,b,p],"float32"),E=this.readSync(r.dataId),A=this.readSync(i.dataId),N=this.readSync(t.dataId),F=t.strides,D=x.strides,W=0;W<m;W++){var k=4*W,C=E[k],L=E[k+1],B=E[k+2],R=E[k+3],M=A[W];if(!(M>=l))for(var U=w>1?(B-C)*(h-1)/(w-1):0,J=b>1?(R-L)*(d-1)/(b-1):0,de=0;de<w;de++){var fe=w>1?C*(h-1)+de*U:.5*(C+B)*(h-1);if(fe<0||fe>h-1)for(var he=0;he<b;he++)for(var K=0;K<p;K++){var le=K+he*D[2]+de*D[1]+W*D[0];x.values[le]=a}else if(s==="bilinear"){var se=Math.floor(fe),re=Math.ceil(fe),j=fe-se;for(he=0;he<b;he++)if((Ue=b>1?L*(d-1)+he*J:.5*(L+R)*(d-1))<0||Ue>d-1)for(K=0;K<p;K++)le=K+he*D[2]+de*D[1]+W*D[0],x.values[le]=a;else{var $=Math.floor(Ue),ne=Math.ceil(Ue),ce=Ue-$;for(K=0;K<p;K++){var ge=N[le=K+$*F[2]+se*F[1]+M*F[0]],ye=N[le=K+ne*F[2]+se*F[1]+M*F[0]],be=N[le=K+$*F[2]+re*F[1]+M*F[0]],Ae=ge+(ye-ge)*ce,$e=be+(N[le=K+ne*F[2]+re*F[1]+M*F[0]]-be)*ce;le=K+he*D[2]+de*D[1]+W*D[0],x.values[le]=Ae+($e-Ae)*j}}}else for(he=0;he<b;++he){var Ue;if((Ue=b>1?L*(d-1)+he*J:.5*(L+R)*(d-1))<0||Ue>d-1)for(K=0;K<p;K++)le=K+he*D[2]+de*D[1]+W*D[0],x.values[le]=a;else{var et=Math.round(Ue),Je=Math.round(fe);for(K=0;K<p;K++){var Be=K+et*F[2]+Je*F[1]+M*F[0],_e=K+he*D[2]+de*D[1]+W*D[0];x.values[_e]=N[Be]}}}}}return x.toTensor()},e.prototype.sparseToDense=function(t,r,i,o){var s=qv(0,t,i),a=s.sliceRank,u=s.numUpdates,l=s.sliceSize,h=s.strides,d=s.outputSize;return this.scatter(t,r,i,d,l,u,a,h,o,!1)},e.prototype.gatherND=function(t,r){var i=r.shape,o=i[i.length-1],s=S3(t,r),a=s[0],u=s[1],l=s[2],h=s[3];if(u===0)return uo([],a,t.dtype);for(var d=new fm([u,l],t.dtype),p=this.readSync(r.dataId),m=this.readSync(t.dataId),w=0;w<u;w++){for(var b=[],x=0,E=0;E<o;E++){var A=p[w*o+E];x+=A*h[E],b.push(A)}if(x<0||x>=t.size/l)throw new Error("Invalid indices: "+b+" does not index into "+t.shape);for(var N=0;N<l;N++)d.values[w*l+N]=m[x*l+N]}return d.toTensor().reshape(a)},e.prototype.scatterND=function(t,r,i){var o=qv(0,t,i),s=o.sliceRank,a=o.numUpdates,u=o.sliceSize,l=o.strides,h=o.outputSize,d=wt(0);return this.scatter(t,r,i,h,u,a,s,l,d,!0)},e.prototype.fill=function(t,r,i){var o=Lv(i=i||Rm(r),Dt(t));return o.fill(r),Te.makeTensor(o,t,i,this)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var r=Lv(t.dtype,Dt(t.shape));return this.makeOutput(r,t.shape,t.dtype)},e.prototype.linspace=function(t,r,i){return R3(t,r,i)},e.prototype.scatter=function(t,r,i,o,s,a,u,l,h,d){var p=[o/s,s],m=this.readSync(t.dataId),w=this.readSync(r.dataId);if(o===0)return uo([],i,r.dtype);var b=new fm(p,r.dtype);b.values.fill(this.readSync(h.dataId)[0]);for(var x=0;x<a;x++){for(var E=[],A=0,N=0;N<u;N++){var F=m[x*u+N];E.push(F),A+=F*l[N]}if(A<0||A>=o/s)throw new Error("Invalid indices: "+E+" does not index into "+i);for(var D=0;D<s;D++)d?b.values[A*s+D]+=w[x*s+D]:b.values[A*s+D]=r.rank===0?w[0]:w[x*s+D]}return b.toTensor().reshape(i)},e})(k3);Te.registerBackend("cpu",(function(){return new pV}),1);for(var Ty=0,nS=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs,i=e,o=i.boxes,s=i.scores,a=r,u=a.maxOutputSize,l=a.iouThreshold,h=a.scoreThreshold,d=a.softNmsSigma,p=t;nt(o,"NonMaxSuppressionWithScore");var m=wb(p.data.get(o.dataId).values,p.data.get(s.dataId).values,u,l,h,d);return[m.selectedIndices,m.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e.x,i=t;nt(r,"square");for(var o=i.data.get(r.dataId).values,s=new Float32Array(o.length),a=0;a<o.length;++a){var u=o[a];s[a]=u*u}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:mm,backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e,i=r.a,o=r.b,s=t;nt([i,o],mm);var a=s.data.get(i.dataId).values,u=s.data.get(o.dataId).values,l=(function(p,m,w,b,x,E){var A=_n(p,m),N=A.length,F=nl(A),D=hm(x,Dt(A)),W=p.length,k=m.length,C=nl(p),L=nl(m),B=Yc(p,A),R=Yc(m,A);if(B.length+R.length===0)for(var M=0;M<D.length;++M)D[M]=E(w[M%w.length],b[M%b.length]);else{var U=function(J){var de=SM(J,N,F),fe=de.slice(-W);B.forEach((function(se){return fe[se]=0}));var he=AE(fe,W,C),K=de.slice(-k);R.forEach((function(se){return K[se]=0}));var le=AE(K,k,L);D[J]=E(w[he],b[le])};for(M=0;M<D.length;++M)U(M)}return[D,A]})(i.shape,o.shape,a,u,i.dtype,(function(p,m){var w=p-m;return w*w})),h=l[0],d=l[1];return{dataId:s.write(h,d,i.dtype),shape:d,dtype:i.dtype}}}];Ty<nS.length;Ty++)r3(nS[Ty]);var Zf,mV=function(n){this.variableNames=["A"];var e=Fo(),t=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+t+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},gV=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=Fo(),t=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+t+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `};for(var ky=0,rS=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs,i=e.pixels,o=r.numChannels,s=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,u=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=u[0],h=u[1],d=[h,l],p=[h,l,o];(a||s)&&(Zf==null&&(Zf=document.createElement("canvas").getContext("2d")),Zf.canvas.width=l,Zf.canvas.height=h,Zf.drawImage(i,0,0,l,h),i=Zf.canvas);var m=t.makeTensorInfo(d,"int32");t.texData.get(m.dataId).usage=Ys.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(m.dataId),i);var w=Ye().getBool("WEBGL_PACK")?new gV(p):new mV(p),b=t.runWebGLProgram(w,[m],"int32");return t.disposeData(m.dataId),b}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs;Bv("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=e,o=i.boxes,s=i.scores,a=r,u=a.maxOutputSize,l=a.iouThreshold,h=a.scoreThreshold,d=a.softNmsSigma,p=t,m=wb(p.readSync(o.dataId),p.readSync(s.dataId),u,l,h,d);return[m.selectedIndices,m.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e.x,i=t,o=new pn(r.shape,"return x * x;");return i.runWebGLProgram(o,[r],r.dtype)}},{kernelName:mm,backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e,i=r.a,o=r.b,s=t,a=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ul("return (a - b) * (a - b);",i.shape,o.shape):new Ur("return (a - b) * (a - b);",i.shape,o.shape);return s.compileAndRun(a,[i,o])}}];ky<rS.length;ky++)r3(rS[ky]);for(var Ny=0,iS=[{kernelName:"Square",gradFunc:function(n,e){var t=e[0];return{x:function(){return n.mul(t.toFloat().mul(2))}}}},{kernelName:mm,gradFunc:function(n,e){var t=e[0],r=e[1],i=wt(2);return{a:function(){return jo(n,jo(i,Ci(t,r)))},b:function(){return jo(n,jo(i,Ci(r,t)))}}}}];Ny<iS.length;Ny++)dM(iS[Ny]);var vV=(function(){function n(){}return n.prototype.fetch=function(e,t){return fetch(e,t)},n.prototype.now=function(){return performance.now()},n.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+t);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},n.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},n})();Ye().get("IS_BROWSER")&&Ye().setPlatform("browser",new vV);var Py,yV=function(){return require("node-fetch")},wV=(function(){function n(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return n.prototype.fetch=function(e,t){return Ye().global.fetch!=null?Ye().global.fetch(e,t):(Py==null&&(Py=yV()),Py(e,t))},n.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},n.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},n.prototype.decode=function(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)},n})();Ye().get("IS_NODE")&&Ye().setPlatform("node",new wV);var F2={float32:4,int32:4,uint16:2,uint8:1,bool:1},Jv=4;function CI(n,e){for(var t={},r=0,i=function(a){var u=a.name,l=a.dtype,h=a.shape,d=Dt(h),p=void 0;if("quantization"in a){var m=a.quantization;if(m.dtype!=="uint8"&&m.dtype!=="uint16")throw new Error("Weight "+a.name+" has unknown quantization dtype "+m.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var w=F2[m.dtype],b=n.slice(r,r+d*w),x=m.dtype==="uint8"?new Uint8Array(b):new Uint16Array(b);if(l==="float32")p=Float32Array.from(x,(function(W){return W*m.scale+m.min}));else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);p=Int32Array.from(x,(function(W){return Math.round(W*m.scale+m.min)}))}r+=d*w}else if(l==="string"){var E=Dt(a.shape);p=[];for(var A=0;A<E;A++){var N=new Uint32Array(n.slice(r,r+Jv))[0];r+=Jv;var F=new Uint8Array(n.slice(r,r+N));p.push(F),r+=N}}else{var D=F2[l];if(b=n.slice(r,r+d*D),l==="float32")p=new Float32Array(b);else if(l==="int32")p=new Int32Array(b);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);p=new Uint8Array(b)}r+=d*D}t[u]=uo(p,h,l)},o=0,s=e;o<s.length;o++)i(s[o]);return t}function bV(n){if(n===null)throw new Error("Invalid input value: "+JSON.stringify(n));var e=0,t=[];n.forEach((function(o){if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+o.constructor.name)}));var r=new Uint8Array(e),i=0;return t.forEach((function(o){r.set(new Uint8Array(o.buffer),i),i+=o.byteLength})),r.buffer}var O2=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function oS(n){return O2?Buffer.byteLength(n):new Blob([n]).size}function Bb(n){var e=0;n.forEach((function(i){e+=i.byteLength}));var t=new Uint8Array(e),r=0;return n.forEach((function(i){t.set(new Uint8Array(i),r),r+=i.byteLength})),t.buffer}function sS(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);var e=n.split("/");return e[e.length-1]}function Vm(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:oS(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:oS(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}var Js=(function(){function n(){this.saveRouters=[],this.loadRouters=[]}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerSaveRouter=function(e){n.getInstance().saveRouters.push(e)},n.registerLoadRouter=function(e){n.getInstance().loadRouters.push(e)},n.getSaveHandlers=function(e){return n.getHandlers(e,"save")},n.getLoadHandlers=function(e,t){return n.getHandlers(e,"load",t)},n.getHandlers=function(e,t,r){var i=[];return(t==="load"?n.getInstance().loadRouters:n.getInstance().saveRouters).forEach((function(o){var s=o(e,r);s!==null&&i.push(s)})),i},n})(),Sd="://",nh=(function(){function n(){this.managers={}}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerManager=function(e,t){pe(e!=null,(function(){return"scheme must not be undefined or null."})),e.endsWith(Sd)&&(e=e.slice(0,e.indexOf(Sd))),pe(e.length>0,(function(){return"scheme must not be an empty string."}));var r=n.getInstance();pe(r.managers[e]==null,(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=t},n.getManager=function(e){var t=this.getInstance().managers[e];if(t==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},n.getSchemes=function(){return Object.keys(this.getInstance().managers)},n})();function hv(n){if(n.indexOf(Sd)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+nh.getSchemes().join(","));return{scheme:n.split(Sd)[0],path:n.split(Sd)[1]}}function aS(n,e,t){return t===void 0&&(t=!1),kt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d;return Nt(this,(function(p){switch(p.label){case 0:return pe(n!==e,(function(){return"Old path and new path are the same: '"+n+"'"})),pe((r=Js.getLoadHandlers(n)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+n+"."})),pe(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+n+"."})),i=r[0],pe((o=Js.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),pe(o.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),s=o[0],a=hv(n).scheme,u=hv(n).path,l=a===hv(n).scheme,[4,i.load()];case 1:return h=p.sent(),t&&l?[4,nh.getManager(a).removeModel(u)]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,s.save(h)];case 4:return d=p.sent(),!t||l?[3,6]:[4,nh.getManager(a).removeModel(u)];case 5:p.sent(),p.label=6;case 6:return[2,d.modelArtifactsInfo]}}))}))}var uf="models_store",Jc="model_info_store";function II(){if(!Ye().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var n=window||self,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function B2(n){var e=n.result;e.createObjectStore(uf,{keyPath:"modelPath"}),e.createObjectStore(Jc,{keyPath:"modelPath"})}var Ad=(function(){function n(e){if(this.indexedDB=II(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return n.prototype.save=function(e){return kt(this,void 0,void 0,(function(){return Nt(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},n.prototype.load=function(){return kt(this,void 0,void 0,(function(){return Nt(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},n.prototype.databaseAction=function(e,t){var r=this;return new Promise((function(i,o){var s=r.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return B2(s)},s.onsuccess=function(){var a=s.result;if(t==null){var u=a.transaction(uf,"readonly"),l=u.objectStore(uf).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return a.close(),o(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(l.result.modelArtifacts)},l.onerror=function(b){return a.close(),o(l.error)},u.oncomplete=function(){return a.close()}}else{var h,d=Vm(t),p=a.transaction(Jc,"readwrite"),m=p.objectStore(Jc),w=m.put({modelPath:r.modelPath,modelArtifactsInfo:d});w.onsuccess=function(){var b=(h=a.transaction(uf,"readwrite")).objectStore(uf).put({modelPath:r.modelPath,modelArtifacts:t,modelArtifactsInfo:d});b.onsuccess=function(){return i({modelArtifactsInfo:d})},b.onerror=function(x){var E=(m=p.objectStore(Jc)).delete(r.modelPath);E.onsuccess=function(){return a.close(),o(b.error)},E.onerror=function(A){return a.close(),o(b.error)}}},w.onerror=function(b){return a.close(),o(w.error)},p.oncomplete=function(){h==null?a.close():h.oncomplete=function(){return a.close()}}}},s.onerror=function(a){return o(s.error)}}))},n.URL_SCHEME="indexeddb://",n})(),uS=function(n){return Ye().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ad.URL_SCHEME)?(e=n.slice(Ad.URL_SCHEME.length),new Ad(e)):null;var e};Js.registerSaveRouter(uS),Js.registerLoadRouter(uS);var xV=(function(){function n(){this.indexedDB=II()}return n.prototype.listModels=function(){return kt(this,void 0,void 0,(function(){var e=this;return Nt(this,(function(t){return[2,new Promise((function(r,i){var o=e.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return B2(o)},o.onsuccess=function(){var s=o.result,a=s.transaction(Jc,"readonly"),u=a.objectStore(Jc).getAll();u.onsuccess=function(){for(var l={},h=0,d=u.result;h<d.length;h++){var p=d[h];l[p.modelPath]=p.modelArtifactsInfo}r(l)},u.onerror=function(l){return s.close(),i(u.error)},a.oncomplete=function(){return s.close()}},o.onerror=function(s){return i(o.error)}}))]}))}))},n.prototype.removeModel=function(e){return kt(this,void 0,void 0,(function(){var t=this;return Nt(this,(function(r){var i;return e=(i=e).startsWith(Ad.URL_SCHEME)?i.slice(Ad.URL_SCHEME.length):i,[2,new Promise((function(o,s){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return B2(a)},a.onsuccess=function(){var u,l=a.result,h=l.transaction(Jc,"readwrite"),d=h.objectStore(Jc),p=d.get(e);p.onsuccess=function(){if(p.result==null)return l.close(),s(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var m=d.delete(e),w=function(){var b=(u=l.transaction(uf,"readwrite")).objectStore(uf).delete(e);b.onsuccess=function(){return o(p.result.modelArtifactsInfo)},b.onerror=function(x){return s(p.error)}};m.onsuccess=w,m.onerror=function(b){return w(),l.close(),s(p.error)}},p.onerror=function(m){return l.close(),s(p.error)},h.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},a.onerror=function(u){return s(a.error)}}))]}))}))},n})();if(Ye().getBool("IS_BROWSER"))try{nh.registerManager(Ad.URL_SCHEME,new xV)}catch{}var zl="/",ad="tensorflowjs_models",TI="info",_V="model_topology",EV="weight_specs",SV="weight_data",AV="model_metadata";function kI(n){return{info:[ad,n,TI].join(zl),topology:[ad,n,_V].join(zl),weightSpecs:[ad,n,EV].join(zl),weightData:[ad,n,SV].join(zl),modelMetadata:[ad,n,AV].join(zl)}}function CV(n){var e=n.split(zl);if(e.length<3)throw new Error("Invalid key format: "+n);return e.slice(1,e.length-1).join(zl)}var Cd=(function(){function n(e){if(!Ye().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=kI(this.modelPath)}return n.prototype.save=function(e){return kt(this,void 0,void 0,(function(){var t,r,i;return Nt(this,(function(o){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),i=Vm(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,(function(s){if(O2)return Buffer.from(s).toString("base64");for(var a=new Uint8Array(s),u="",l=0,h=a.length;l<h;l++)u+=String.fromCharCode(a[l]);return btoa(u)})(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:i}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}return[2]}))}))},n.prototype.load=function(){return kt(this,void 0,void 0,(function(){var e,t,r,i,o,s,a;return Nt(this,(function(u){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=i,(o=this.LS.getItem(this.keys.modelMetadata))!=null&&(s=JSON.parse(o),t.format=s.format,t.generatedBy=s.generatedBy,t.convertedBy=s.convertedBy,t.userDefinedMetadata=s.userDefinedMetadata),(a=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=(function(l){if(O2){var h=Buffer.from(l,"base64");return h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength)}for(var d=atob(l),p=new Uint8Array(d.length),m=0;m<d.length;++m)p.set([d.charCodeAt(m)],m);return p.buffer})(a),[2,t]}))}))},n.URL_SCHEME="localstorage://",n})(),lS=function(n){return Ye().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Cd.URL_SCHEME)?(e=n.slice(Cd.URL_SCHEME.length),new Cd(e)):null;var e};Js.registerSaveRouter(lS),Js.registerLoadRouter(lS);var IV=(function(){function n(){pe(Ye().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),pe(typeof window>"u"||window.localStorage!==void 0,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return n.prototype.listModels=function(){return kt(this,void 0,void 0,(function(){var e,t,r,i,o,s;return Nt(this,(function(a){for(e={},t=ad+zl,r=zl+TI,i=0;i<this.LS.length;++i)(o=this.LS.key(i)).startsWith(t)&&o.endsWith(r)&&(s=CV(o),e[s]=JSON.parse(this.LS.getItem(o)));return[2,e]}))}))},n.prototype.removeModel=function(e){return kt(this,void 0,void 0,(function(){var t,r;return Nt(this,(function(i){var o;if(e=(o=e).startsWith(Cd.URL_SCHEME)?o.slice(Cd.URL_SCHEME.length):o,t=kI(e),this.LS.getItem(t.info)==null)throw new Error("Cannot find model at path '"+e+"'");return r=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,r]}))}))},n})();if(Ye().getBool("IS_BROWSER"))try{nh.registerManager(Cd.URL_SCHEME,new IV)}catch{}var TV="model",kV=".json",NV=".weights.bin";function cS(n){return new Promise((function(e){return setTimeout(e)})).then(n)}var Ry=(function(){function n(e){if(!Ye().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(n.URL_SCHEME)&&(e=e.slice(n.URL_SCHEME.length)),e!=null&&e.length!==0||(e=TV),this.modelTopologyFileName=e+kV,this.weightDataFileName=e+NV}return n.prototype.save=function(e){return kt(this,void 0,void 0,(function(){var t,r,i,o,s,a;return Nt(this,(function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:r},o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,s.href=o,[4,cS((function(){return s.dispatchEvent(new MouseEvent("click"))}))];case 2:return u.sent(),e.weightData==null?[3,4]:((a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,a.href=t,[4,cS((function(){return a.dispatchEvent(new MouseEvent("click"))}))]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Vm(e)}]}}))}))},n.URL_SCHEME="downloads://",n})(),PV=(function(){function n(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return n.prototype.load=function(){return kt(this,void 0,void 0,(function(){var e,t,r=this;return Nt(this,(function(i){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(o,s){var a=new FileReader;a.onload=function(u){var l=JSON.parse(u.target.result),h=l.modelTopology;if(h!=null){t.length===0&&o({modelTopology:h});var d=l.weightsManifest;if(d!=null){var p;try{p=r.checkManifestAndWeightFiles(d,t)}catch(x){return void s(x)}var m=[],w=[],b=[];d.forEach((function(x){x.paths.forEach((function(E){w.push(E),b.push(null)})),m.push.apply(m,x.weights)})),d.forEach((function(x){x.paths.forEach((function(E){var A=new FileReader;A.onload=function(N){var F=N.target.result,D=w.indexOf(E);b[D]=F,b.indexOf(null)===-1&&o({modelTopology:h,weightSpecs:m,weightData:Bb(b),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},A.onerror=function(N){return s("Failed to weights data from file of path '"+E+"'.")},A.readAsArrayBuffer(p[E])}))}))}else s(new Error("weightManifest field is missing from file "+e.name))}else s(new Error("modelTopology field is missing from file "+e.name))},a.onerror=function(u){return s("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},a.readAsText(e)}))]}))}))},n.prototype.checkManifestAndWeightFiles=function(e,t){for(var r=[],i=t.map((function(u){return sS(u.name)})),o={},s=0,a=e;s<a.length;s++)a[s].paths.forEach((function(u){var l=sS(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),i.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");o[u]=t[i.indexOf(l)]}));if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+t.length+").");return o},n})();function hS(n,e,t,r){(function(o){pe(o!=null&&Array.isArray(o)&&o.length>0,(function(){return"promises must be a none empty array"}))})(n),(function(o,s){pe(o>=0&&o<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+o})),pe(s>=0&&s<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s})),pe(s>=o,(function(){return"startFraction must be no more than endFraction, but got startFraction "+o+" and endFraction "+s}))})(t=t??0,r=r??1);var i=0;return Promise.all(n.map((function(o){return o.then((function(s){var a=t+ ++i/n.length*(r-t);return e(a),s})),o})))}function NI(n,e){return kt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h;return Nt(this,(function(d){switch(d.label){case 0:return e==null&&(e={}),t=e.fetchFunc==null?Ye().platform.fetch:e.fetchFunc,r=n.map((function(p){return t(p,e.requestInit,{isBinary:!0})})),i=0,o=.5,e.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return s=d.sent(),[3,4];case 2:return[4,hS(r,e.onProgress,i,o)];case 3:s=d.sent(),d.label=4;case 4:return a=s.map((function(p){return p.arrayBuffer()})),u=.5,l=1,e.onProgress!=null?[3,6]:[4,Promise.all(a)];case 5:return h=d.sent(),[3,8];case 6:return[4,hS(a,e.onProgress,u,l)];case 7:h=d.sent(),d.label=8;case 8:return[2,h]}}))}))}function fS(n){var e=this;return function(t,r,i){return r===void 0&&(r=""),kt(e,void 0,void 0,(function(){var o,s,a,u,l,h,d,p,m,w;return Nt(this,(function(b){switch(b.label){case 0:if(o=t.map((function(){return!1})),s={},a=i!=null?i.map((function(){return!1})):[],u=[],t.forEach((function(x,E){var A=0;x.weights.forEach((function(N){var F="quantization"in N?N.quantization.dtype:N.dtype,D=F2[F]*Dt(N.shape),W=function(){o[E]=!0,s[E]==null&&(s[E]=[]),s[E].push({manifestEntry:N,groupOffset:A,sizeBytes:D})};i!=null?i.forEach((function(k,C){k===N.name&&(W(),a[C]=!0)})):W(),u.push(N.name),A+=D}))})),!a.every((function(x){return x})))throw l=i.filter((function(x,E){return!a[E]})),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return h=o.reduce((function(x,E,A){return E&&x.push(A),x}),[]),d=[],h.forEach((function(x){t[x].paths.forEach((function(E){var A=r+(r.endsWith("/")?"":"/")+E;d.push(A)}))})),[4,n(d)];case 1:return p=b.sent(),m={},w=0,h.forEach((function(x){for(var E=t[x].paths.length,A=0,N=0;N<E;N++)A+=p[w+N].byteLength;for(var F=new ArrayBuffer(A),D=new Uint8Array(F),W=0,k=0;k<E;k++){var C=new Uint8Array(p[w+k]);D.set(C,W),W+=C.byteLength}s[x].forEach((function(L){var B=CI(F.slice(L.groupOffset,L.groupOffset+L.sizeBytes),[L.manifestEntry]);for(var R in B)m[R]=B[R]})),w+=E})),[2,m]}}))}))}}Js.registerSaveRouter((function(n){return Ye().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ry.URL_SCHEME)?(function(e){return e===void 0&&(e="model"),new Ry(e)})(n.slice(Ry.URL_SCHEME.length)):null}));var PI=(function(){function n(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,t.fetchFunc!=null?(pe(typeof t.fetchFunc=="function",(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=t.fetchFunc):this.fetch=Ye().platform.fetch,pe(e!=null&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&pe(e.length===2,(function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."})),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return n.prototype.save=function(e){return kt(this,void 0,void 0,(function(){var t,r,i,o;return Nt(this,(function(s){switch(s.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:r},t.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((o=s.sent()).ok)return[2,{modelArtifactsInfo:Vm(e),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}}))}))},n.prototype.load=function(){return kt(this,void 0,void 0,(function(){var e,t,r,i,o,s,a,u,l,h,d,p;return Nt(this,(function(m){switch(m.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=m.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");m.label=2;case 2:return m.trys.push([2,4,,5]),[4,e.json()];case 3:return t=m.sent(),[3,5];case 4:throw m.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=t.modelTopology,o=t.weightsManifest,s=t.generatedBy,a=t.convertedBy,u=t.format,l=t.userDefinedMetadata,i==null&&o==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return o==null?[3,7]:[4,this.loadWeights(o)];case 6:p=m.sent(),h=p[0],d=p[1],m.label=7;case 7:return[2,{modelTopology:i,weightSpecs:h,weightData:d,userDefinedMetadata:l,generatedBy:s,convertedBy:a,format:u}]}}))}))},n.prototype.loadWeights=function(e){return kt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h,d,p;return Nt(this,(function(m){switch(m.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,r=(function(w){var b=w.lastIndexOf("/"),x=w.lastIndexOf("?"),E=w.substring(0,b),A=x>b?w.substring(x):"";return[E+"/",A]})(t),i=r[0],o=r[1],s=this.weightPathPrefix||i,a=[],u=0,l=e;u<l.length;u++)h=l[u],a.push.apply(a,h.weights);return d=[],e.forEach((function(w){w.paths.forEach((function(b){d.push(s+b+o)}))})),[4,NI(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return p=m.sent(),[2,[a,Bb(p)]]}}))}))},n.URL_SCHEME_REGEX=/^https?:\/\//,n})();function V2(n){return n.match(PI.URL_SCHEME_REGEX)!=null}var dS=function(n,e){return typeof fetch>"u"?null:(Array.isArray(n)?n.every((function(t){return V2(t)})):V2(n))?j2(n,{onProgress:e}):null};function j2(n,e){return new PI(n,e)}Js.registerSaveRouter(dS),Js.registerLoadRouter(dS);var Dy=(function(){function n(e){this.modelArtifacts=e}return n.prototype.load=function(){return kt(this,void 0,void 0,(function(){return Nt(this,(function(e){return[2,this.modelArtifacts]}))}))},n})(),RV=(function(){function n(e){this.saveHandler=e}return n.prototype.save=function(e){return kt(this,void 0,void 0,(function(){return Nt(this,(function(t){return[2,this.saveHandler(e)]}))}))},n})(),RI=Object.freeze({browserFiles:function(n){return new PV(n)},browserHTTPRequest:function(n,e){return j2(n,e)},concatenateArrayBuffers:Bb,decodeWeights:CI,encodeWeights:function(n,e){return kt(this,void 0,void 0,(function(){var t,r,i,o,s,a=this;return Nt(this,(function(u){switch(u.label){case 0:for(t=[],r=[],i=Array.isArray(n)?n.map((function(l){return l.name})):Object.keys(n),o=function(l){var h=i[l],d=Array.isArray(n)?n[l].tensor:n[h];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+h+"': "+d.dtype);var p={name:h,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var m=new Promise((function(w){return kt(a,void 0,void 0,(function(){var b,x,E,A,N,F,D;return Nt(this,(function(W){switch(W.label){case 0:return[4,d.bytes()];case 1:for(b=W.sent(),x=b.reduce((function(k,C){return k+C.length}),0)+Jv*b.length,E=new Uint8Array(x),A=0,N=0;N<b.length;N++)F=b[N],D=new Uint8Array(new Uint32Array([F.length]).buffer),E.set(D,A),A+=Jv,E.set(F,A),A+=F.length;return w(E),[2]}}))}))}));r.push(m)}else r.push(d.data());e!=null&&(p.group=e),t.push(p)},s=0;s<i.length;++s)o(s);return[4,Promise.all(r)];case 1:return[2,{data:bV(u.sent()),specs:t}]}}))}))},fromMemory:function(n,e,t,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new Dy(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Dy({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Dy({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:r}))},getLoadHandlers:function(n,e){return Js.getLoadHandlers(n,e)},getModelArtifactsInfoForJSON:Vm,getSaveHandlers:function(n){return Js.getSaveHandlers(n)},http:j2,isHTTPScheme:V2,loadWeights:function(n,e,t,r){return e===void 0&&(e=""),kt(this,void 0,void 0,(function(){return Nt(this,(function(i){return[2,fS((function(o){return NI(o,{requestInit:r})}))(n,e,t)]}))}))},registerLoadRouter:function(n){return Js.registerLoadRouter(n)},registerSaveRouter:function(n){return Js.registerSaveRouter(n)},weightsLoaderFactory:fS,withSaveHandler:function(n){return new RV(n)},copyModel:function(n,e){return kt(this,void 0,void 0,(function(){return Nt(this,(function(t){return[2,aS(n,e,!1)]}))}))},listModels:function(){return kt(this,void 0,void 0,(function(){var n,e,t,r,i,o,s;return Nt(this,(function(a){switch(a.label){case 0:n=nh.getSchemes(),e={},t=0,r=n,a.label=1;case 1:return t<r.length?(i=r[t],[4,nh.getManager(i).listModels()]):[3,4];case 2:for(s in o=a.sent())e[i+Sd+s]=o[s];a.label=3;case 3:return t++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(n,e){return kt(this,void 0,void 0,(function(){return Nt(this,(function(t){return[2,aS(n,e,!0)]}))}))},removeModel:function(n){return kt(this,void 0,void 0,(function(){var e;return Nt(this,(function(t){return e=hv(n),[2,nh.getManager(e.scheme).removeModel(e.path)]}))}))}}),ed;xe({confusionMatrix_:function(n,e,t){var r=oe(n,"labels","confusionMatrix"),i=oe(e,"predictions","confusionMatrix");pe(t==null||t>0&&Number.isInteger(t),(function(){return"If provided, numClasses must be a positive integer, but got "+t})),pe(r.rank===1,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),pe(i.rank===1,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),pe(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),pe(t>0&&Number.isInteger(t),(function(){return"numClasses is required to be a positive integer, but got "+t}));var o=P2(r.asType("int32"),t),s=P2(i.asType("int32"),t);return o.transpose().matMul(s).asType("int32")}});var DV=xe({fromPixels_:function(n,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var t=!1,r=!1,i=!1,o=!1,s=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)o=!0;else{if(n.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+n.constructor.name);s=!0}if(i&&i&&n.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(n3("FromPixels",Te.backendName)!=null)return Te.runKernel("FromPixels",{pixels:n},{numChannels:e});var a,u,l=i?[n.videoWidth,n.videoHeight]:[n.width,n.height],h=l[0],d=l[1];if(s?a=n.getContext("2d").getImageData(0,0,h,d).data:r||t?a=n.data:(o||i)&&(ed==null&&(ed=document.createElement("canvas").getContext("2d")),ed.canvas.width=h,ed.canvas.height=d,ed.drawImage(n,0,0,h,d),a=ed.getImageData(0,0,h,d).data),e===4)u=new Int32Array(a);else{var p=h*d;u=new Int32Array(p*e);for(var m=0;m<p;m++)for(var w=0;w<e;++w)u[m*e+w]=a[4*m+w]}return db(u,[d,h,e],"int32")}}),Vb=Object.freeze({toPixels:function(n,e){return kt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h,d,p,m,w,b,x,E,A,N,F,D,W,k,C;return Nt(this,(function(L){switch(L.label){case 0:if(t=oe(n,"img","toPixels"),n instanceof Tr||(t=t.toInt()),t.rank!==2&&t.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+t.rank+".");if(r=t.shape.slice(0,2),i=r[0],o=r[1],(s=t.rank===2?1:t.shape[2])>4||s===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,t.data()];case 1:return a=L.sent(),u=t.min(),l=t.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(h=L.sent(),d=h[0],p=h[1],m=d[0],w=p[0],u.dispose(),l.dispose(),t.dtype==="float32"){if(m<0||w>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+m+" - "+w+"].")}else{if(t.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+t.dtype+". Please use float32 or int32 tensors.");if(m<0||w>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+m+" - "+w+"].")}for(b=t.dtype==="float32"?255:1,x=new Uint8ClampedArray(o*i*4),E=0;E<i*o;++E)A=void 0,N=void 0,F=void 0,D=void 0,s===1?(A=a[E]*b,N=a[E]*b,F=a[E]*b,D=255):s===3?(A=a[3*E]*b,N=a[3*E+1]*b,F=a[3*E+2]*b,D=255):s===4&&(A=a[4*E]*b,N=a[4*E+1]*b,F=a[4*E+2]*b,D=a[4*E+3]*b),x[(W=4*E)+0]=Math.round(A),x[W+1]=Math.round(N),x[W+2]=Math.round(F),x[W+3]=Math.round(D);return e!=null&&(e.width=o,e.height=i,k=e.getContext("2d"),C=new ImageData(x,o,i),k.putImageData(C,0,0)),t!==n&&t.dispose(),[2,x]}}))}))},fromPixels:DV}),LV=(function(){function n(){}return n.prototype.getClassName=function(){return this.constructor.className},n.fromConfig=function(e,t){return new e(t)},n})(),MV=(function(){function n(){this.classNameMap={}}return n.getMap=function(){return n.instance==null&&(n.instance=new n),n.instance},n.register=function(e){n.getMap().classNameMap[e.className]=[e,e.fromConfig]},n})();function Cf(n){pe(n.className!=null,(function(){return"Class being registered does not have the static className property defined."})),pe(typeof n.className=="string",(function(){return"className is required to be a string, but got type "+typeof n.className})),pe(n.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),MV.register(n)}var If=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return yu(e,n),e.prototype.minimize=function(t,r,i){r===void 0&&(r=!1);var o=this.computeGradients(t,i),s=o.value,a=o.grads;if(i!=null){var u=i.map((function(l){return{name:l.name,tensor:a[l.name]}}));this.applyGradients(u)}else this.applyGradients(a);return Cs(a),r?s:(s.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,r){return HF(t,r)},e.prototype.dispose=function(){this.iterations_!=null&&Cs(this.iterations_)},e.prototype.saveIterations=function(){return kt(this,void 0,void 0,(function(){return Nt(this,(function(t){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:wt(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return kt(this,void 0,void 0,(function(){return Nt(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return kt(this,void 0,void 0,(function(){return Nt(this,(function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return kt(this,void 0,void 0,(function(){var r;return Nt(this,(function(i){switch(i.label){case 0:return r=this,[4,t[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,t.slice(1)]}}))}))},e})(LV);Object.defineProperty(If,Symbol.hasInstance,{value:function(n){return n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null}});var FV=(function(n){function e(t,r,i){i===void 0&&(i=null);var o=n.call(this)||this;return o.learningRate=t,o.rho=r,o.epsilon=i,o.accumulatedGrads=[],o.accumulatedUpdates=[],i==null&&(o.epsilon=Te.backend.epsilon()),o}return yu(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Te.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accum_grad",variable:At((function(){return Nn(s).variable(!1)}))}),r.accumulatedUpdates[o]==null&&(r.accumulatedUpdates[o]={originalName:i+"/accum_var",variable:At((function(){return Nn(s).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[i];if(a!=null){var u=r.accumulatedGrads[o].variable,l=r.accumulatedUpdates[o].variable;At((function(){var h=u.mul(r.rho).add(a.square().mul(1-r.rho)),d=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(a),p=l.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(h),l.assign(p);var m=d.mul(-r.learningRate).add(s);s.assign(m)}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Cs(this.accumulatedGrads.map((function(t){return t.variable}))),Cs(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return kt(this,void 0,void 0,(function(){var t;return Nt(this,(function(r){switch(r.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map((function(i){return{name:i.originalName,tensor:i.variable}})))]}}))}))},e.prototype.setWeights=function(t){return kt(this,void 0,void 0,(function(){var r;return Nt(this,(function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),r=t.length/2,this.accumulatedGrads=t.slice(0,r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(r,2*r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,r){return new t(r.learningRate,r.rho,r.epsilon)},e.className="Adadelta",e})(If);Cf(FV);var OV=(function(n){function e(t,r){r===void 0&&(r=.1);var i=n.call(this)||this;return i.learningRate=t,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return yu(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Te.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accumulator",variable:At((function(){return rl(s.shape,r.initialAccumulatorValue).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[i];if(a!=null){var u=r.accumulatedGrads[o].variable;At((function(){var l=u.add(a.square());u.assign(l);var h=a.div(l.add(Te.backend.epsilon()).sqrt()).mul(-r.learningRate).add(s);s.assign(h)}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&Cs(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return kt(this,void 0,void 0,(function(){return Nt(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(r){return{name:r.originalName,tensor:r.variable}})))]}}))}))},e.prototype.setWeights=function(t){return kt(this,void 0,void 0,(function(){return Nt(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulatedGrads=t.map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,r){return new t(r.learningRate,r.initialAccumulatorValue)},e.className="Adagrad",e})(If);Cf(OV);var BV=(function(n){function e(t,r,i,o){o===void 0&&(o=null);var s=n.call(this)||this;return s.learningRate=t,s.beta1=r,s.beta2=i,s.epsilon=o,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],At((function(){s.accBeta1=wt(r).variable(),s.accBeta2=wt(i).variable()})),o==null&&(s.epsilon=Te.backend.epsilon()),s}return yu(e,n),e.prototype.applyGradients=function(t){var r=this,i=Array.isArray(t)?t.map((function(o){return o.name})):Object.keys(t);At((function(){var o=Ci(1,r.accBeta1),s=Ci(1,r.accBeta2);i.forEach((function(a,u){var l=Te.registeredVariables[a];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:a+"/m",variable:At((function(){return Nn(l).variable(!1)}))}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:a+"/v",variable:At((function(){return Nn(l).variable(!1)}))});var h=Array.isArray(t)?t[u].tensor:t[a];if(h!=null){var d=r.accumulatedFirstMoment[u].variable,p=r.accumulatedSecondMoment[u].variable,m=d.mul(r.beta1).add(h.mul(1-r.beta1)),w=p.mul(r.beta2).add(h.square().mul(1-r.beta2)),b=m.div(o),x=w.div(s);d.assign(m),p.assign(w);var E=b.div(x.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(E)}})),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Cs(this.accumulatedFirstMoment.map((function(t){return t.variable}))),this.accumulatedSecondMoment!=null&&Cs(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return kt(this,void 0,void 0,(function(){var t;return Nt(this,(function(r){switch(r.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map((function(i){return{name:i.originalName,tensor:i.variable}})))]}}))}))},e.prototype.setWeights=function(t){return kt(this,void 0,void 0,(function(){var r,i=this;return Nt(this,(function(o){switch(o.label){case 0:return[4,this.extractIterations(t)];case 1:return t=o.sent(),At((function(){i.accBeta1.assign(Xv(i.beta1,i.iterations_+1)),i.accBeta2.assign(Xv(i.beta2,i.iterations_+1))})),r=t.length/2,this.accumulatedFirstMoment=t.slice(0,r).map((function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(r,2*r).map((function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon)},e.className="Adam",e})(If);Cf(BV);var VV=(function(n){function e(t,r,i,o,s){o===void 0&&(o=null),s===void 0&&(s=0);var a=n.call(this)||this;return a.learningRate=t,a.beta1=r,a.beta2=i,a.epsilon=o,a.decay=s,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],At((function(){a.iteration=wt(0).variable(),a.accBeta1=wt(r).variable()})),o==null&&(a.epsilon=Te.backend.epsilon()),a}return yu(e,n),e.prototype.applyGradients=function(t){var r=this,i=Array.isArray(t)?t.map((function(o){return o.name})):Object.keys(t);At((function(){var o=Ci(1,r.accBeta1),s=hu(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach((function(a,u){var l=Te.registeredVariables[a];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:a+"/m",variable:Nn(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:a+"/v",variable:Nn(l).variable(!1)});var h=Array.isArray(t)?t[u].tensor:t[a];if(h!=null){var d=r.accumulatedFirstMoment[u].variable,p=r.accumulatedWeightedInfNorm[u].variable,m=d.mul(r.beta1).add(h.mul(1-r.beta1)),w=p.mul(r.beta2),b=h.abs(),x=w.maximum(b);d.assign(m),p.assign(x);var E=s.div(o).mul(m.div(x.add(r.epsilon))).add(l);l.assign(E)}})),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Cs(this.accumulatedFirstMoment.map((function(t){return t.variable}))),this.accumulatedWeightedInfNorm!=null&&Cs(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return kt(this,void 0,void 0,(function(){return Nt(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return kt(this,void 0,void 0,(function(){return Nt(this,(function(r){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},e.className="Adamax",e})(If);Cf(VV);var DI=(function(n){function e(t){var r=n.call(this)||this;return r.learningRate=t,r.setLearningRate(t),r}return yu(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Array.isArray(t)?t[o].tensor:t[i];if(s!=null){var a=Te.registeredVariables[i];At((function(){var u=r.c.mul(s).add(a);a.assign(u)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=oF(wt(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return kt(this,void 0,void 0,(function(){return Nt(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return kt(this,void 0,void 0,(function(){return Nt(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:if((t=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,r){return new t(r.learningRate)},e.className="SGD",e})(If);Cf(DI);var jV=(function(n){function e(t,r,i){i===void 0&&(i=!1);var o=n.call(this,t)||this;return o.learningRate=t,o.momentum=r,o.useNesterov=i,o.accumulations=[],o.m=wt(o.momentum),o}return yu(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Te.registeredVariables[i];r.accumulations[o]==null&&(r.accumulations[o]={originalName:i+"/momentum",variable:At((function(){return Nn(s).variable(!1)}))});var a=r.accumulations[o].variable,u=Array.isArray(t)?t[o].tensor:t[i];u!=null&&At((function(){var l,h=r.m.mul(a).add(u);l=r.useNesterov?r.c.mul(u.add(h.mul(r.m))).add(s):r.c.mul(h).add(s),a.assign(h),s.assign(l)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Cs(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return kt(this,void 0,void 0,(function(){return Nt(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(r){return{name:r.originalName,tensor:r.variable}})))]}}))}))},e.prototype.setWeights=function(t){return kt(this,void 0,void 0,(function(){return Nt(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulations=t.map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,r){return new t(r.learningRate,r.momentum,r.useNesterov)},e.className="Momentum",e})(DI);Cf(jV);var UV=(function(n){function e(t,r,i,o,s){r===void 0&&(r=.9),i===void 0&&(i=0),o===void 0&&(o=null),s===void 0&&(s=!1);var a=n.call(this)||this;if(a.learningRate=t,a.decay=r,a.momentum=i,a.epsilon=o,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=s,o==null&&(a.epsilon=Te.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return a}return yu(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Te.registeredVariables[i];r.accumulatedMeanSquares[o]==null&&(r.accumulatedMeanSquares[o]={originalName:i+"/rms",variable:At((function(){return Nn(s).variable(!1)}))}),r.accumulatedMoments[o]==null&&(r.accumulatedMoments[o]={originalName:i+"/momentum",variable:At((function(){return Nn(s).variable(!1)}))}),r.accumulatedMeanGrads[o]==null&&r.centered&&(r.accumulatedMeanGrads[o]={originalName:i+"/mg",variable:At((function(){return Nn(s).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[i];if(a!=null){var u=r.accumulatedMeanSquares[o].variable,l=r.accumulatedMoments[o].variable;At((function(){var h=u.mul(r.decay).add(a.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[o].variable,p=d.mul(r.decay).add(a.mul(1-r.decay)),m=l.mul(r.momentum).add(a.mul(r.learningRate).div(h.sub(p.square().add(r.epsilon)).sqrt()));u.assign(h),d.assign(p),l.assign(m);var w=s.sub(m);s.assign(w)}else{var b=u.mul(r.decay).add(a.square().mul(1-r.decay));m=l.mul(r.momentum).add(a.mul(r.learningRate).div(b.add(r.epsilon).sqrt())),u.assign(b),l.assign(m),w=s.sub(m),s.assign(w)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Cs(this.accumulatedMeanSquares.map((function(t){return t.variable}))),this.accumulatedMeanGrads!=null&&this.centered&&Cs(this.accumulatedMeanGrads.map((function(t){return t.variable}))),this.accumulatedMoments!=null&&Cs(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return kt(this,void 0,void 0,(function(){var t;return Nt(this,(function(r){switch(r.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map((function(i){return{name:i.originalName,tensor:i.variable}})))]}}))}))},e.prototype.setWeights=function(t){return kt(this,void 0,void 0,(function(){var r;return Nt(this,(function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),r=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(r,2*r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*r,3*r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,r){return new t(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},e.className="RMSProp",e})(If);Cf(UV);Tr.prototype.squaredDifference=function(n){return K3(this,n)},We=dV;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var U2=function(n,e){return U2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},U2(n,e)};function an(n,e){U2(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Lo=function(){return Lo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Lo.apply(this,arguments)};function Ot(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(h){try{l(r.next(h))}catch(d){s(d)}}function u(h){try{l(r.throw(h))}catch(d){s(d)}}function l(h){h.done?o(h.value):i(h.value).then(a,u)}l((r=r.apply(n,[])).next())})}function Bt(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(h){return u([l,h])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){t.label=l[1];break}if(l[0]===6&&t.label<o[1]){t.label=o[1],o=l;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(l);break}o[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(h){l=[6,h],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Qp(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var hf=(function(){function n(e,t){if(!ff(e)||!ff(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}return Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),n.prototype.reverse=function(){return new n(1/this.width,1/this.height)},n})();function D0(n,e){return n instanceof Tr&&n.shape.length===e}function zV(n){return D0(n,2)}function L0(n){return D0(n,3)}function rh(n){return D0(n,4)}function WV(n){return n%1!==0}function pS(n){return n%2===0}function qV(n,e){e===void 0&&(e=2);var t=Math.pow(10,e);return Math.floor(n*t)/t}function mS(n){return n&&n.width&&n.height}function HV(n,e){var t=n.width,r=n.height,i=e/Math.max(r,t);return new hf(Math.round(t*i),Math.round(r*i))}function jb(n){return n.reduce(function(e,t){return e.add(t)},new Hn(0,0)).div(new Hn(n.length,n.length))}function gm(n,e,t){return Array(n).fill(0).map(function(r,i){return e+i*t})}function ff(n){return!!n&&n!==1/0&&n!==-1/0&&!isNaN(n)||n===0}function gS(n){return ff(n)&&0<=n&&n<=1}var Hn=(function(){function n(e,t){this._x=e,this._y=t}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.add=function(e){return new n(this.x+e.x,this.y+e.y)},n.prototype.sub=function(e){return new n(this.x-e.x,this.y-e.y)},n.prototype.mul=function(e){return new n(this.x*e.x,this.y*e.y)},n.prototype.div=function(e){return new n(this.x/e.x,this.y/e.y)},n.prototype.abs=function(){return new n(Math.abs(this.x),Math.abs(this.y))},n.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.floor=function(){return new n(Math.floor(this.x),Math.floor(this.y))},n})(),ph=(function(){function n(e,t){t===void 0&&(t=!0);var r=e||{},i=[r.left,r.top,r.right,r.bottom].every(ff),o=[r.x,r.y,r.width,r.height].every(ff);if(!o&&!i)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var s=o?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],a=s[0],u=s[1],l=s[2],h=s[3];n.assertIsValidBox({x:a,y:u,width:l,height:h},"Box.constructor",t),this._x=a,this._y=u,this._width=l,this._height=h}return n.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(ff)},n.assertIsValidBox=function(e,t,r){if(r===void 0&&(r=!1),!n.isRect(e))throw new Error(t+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(t+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topLeft",{get:function(){return new Hn(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topRight",{get:function(){return new Hn(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomLeft",{get:function(){return new Hn(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomRight",{get:function(){return new Hn(this.right,this.bottom)},enumerable:!0,configurable:!0}),n.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(s){return Math.round(s)}),t=e[0],r=e[1],i=e[2],o=e[3];return new n({x:t,y:r,width:i,height:o})},n.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(s){return Math.floor(s)}),t=e[0],r=e[1],i=e[2],o=e[3];return new n({x:t,y:r,width:i,height:o})},n.prototype.toSquare=function(){var e=this,t=e.x,r=e.y,i=e.width,o=e.height,s=Math.abs(i-o);return i<o&&(t-=s/2,i+=s),o<i&&(r-=s/2,o+=s),new n({x:t,y:r,width:i,height:o})},n.prototype.rescale=function(e){var t=mS(e)?e.width:e,r=mS(e)?e.height:e;return new n({x:this.x*t,y:this.y*r,width:this.width*t,height:this.height*r})},n.prototype.pad=function(e,t){var r=[this.x-e/2,this.y-t/2,this.width+e,this.height+t],i=r[0],o=r[1],s=r[2],a=r[3];return new n({x:i,y:o,width:s,height:a})},n.prototype.clipAtImageBorders=function(e,t){var r=this,i=r.x,o=r.y,s=r.right,a=r.bottom,u=Math.max(i,0),l=Math.max(o,0),h=s-u,d=a-l,p=Math.min(h,e-u),m=Math.min(d,t-l);return new n({x:u,y:l,width:p,height:m}).floor()},n.prototype.shift=function(e,t){var r=this,i=r.width,o=r.height,s=this.x+e,a=this.y+t;return new n({x:s,y:a,width:i,height:o})},n.prototype.padAtBorders=function(e,t){var r=this.width+1,i=this.height+1,o=1,s=1,a=r,u=i,l=this.left,h=this.top,d=this.right,p=this.bottom;return d>t&&(a=-d+t+r,d=t),p>e&&(u=-p+e+i,p=e),l<1&&(u=2-l,l=1),h<1&&(u=2-h,h=1),{dy:s,edy:u,dx:o,edx:a,y:h,ey:p,x:l,ex:d,w:r,h:i}},n.prototype.calibrate=function(e){return new n({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},n})(),M0=(function(n){an(e,n);function e(t,r,i,o,s){return s===void 0&&(s=!1),n.call(this,{left:t,top:r,right:i,bottom:o},s)||this}return e})(ph),LI=(function(){function n(e,t,r,i,o){this._imageDims=new hf(o.width,o.height),this._score=e,this._classScore=t,this._className=r,this._box=new ph(i).rescale(this._imageDims)}return Object.defineProperty(n.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativeBox",{get:function(){return new ph(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),n.prototype.forSize=function(e,t){return new n(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:t})},n})(),bu=(function(n){an(e,n);function e(t,r,i){return n.call(this,t,t,"",r,i)||this}return e.prototype.forSize=function(t,r){var i=n.prototype.forSize.call(this,t,r),o=i.score,s=i.relativeBox,a=i.imageDims;return new e(o,s,a)},e})(LI);function GV(n,e,t){t===void 0&&(t=!0);var r=Math.max(0,Math.min(n.right,e.right)-Math.max(n.left,e.left)),i=Math.max(0,Math.min(n.bottom,e.bottom)-Math.max(n.top,e.top)),o=r*i;return t?o/(n.area+e.area-o):o/Math.min(n.area,e.area)}function $V(n){var e=n.map(function(a){return a.x}),t=n.map(function(a){return a.y}),r=e.reduce(function(a,u){return u<a?u:a},1/0),i=t.reduce(function(a,u){return u<a?u:a},1/0),o=e.reduce(function(a,u){return a<u?u:a},0),s=t.reduce(function(a,u){return a<u?u:a},0);return new M0(r,i,o,s)}function vm(n,e,t,r){r===void 0&&(r=!0);for(var i=e.map(function(a,u){return{score:a,boxIndex:u}}).sort(function(a,u){return a.score-u.score}).map(function(a){return a.boxIndex}),o=[],s=function(){var a=i.pop();o.push(a);for(var u=i,l=[],h=0;h<u.length;h++){var d=u[h],p=n[a],m=n[d];l.push(GV(p,m,r))}i=i.filter(function(w,b){return l[b]<=t})};i.length>0;)s();return o}function jm(n,e){return At(function(){var t=e[0],r=e[1],i=e[2],o=rl(Qp(n.shape.slice(0,3),[1]),t),s=rl(Qp(n.shape.slice(0,3),[1]),r),a=rl(Qp(n.shape.slice(0,3),[1]),i),u=_i([o,s,a],3);return Ci(n,u)})}function KV(n,e){return e===void 0&&(e=!1),At(function(){var t=n.shape.slice(1),r=t[0],i=t[1];if(r===i)return n;var o=Math.abs(r-i),s=Math.round(o*(e?.5:1)),a=r>i?2:1,u=function(m){var w=n.shape.slice();return w[a]=m,rl(w,0)},l=u(s),h=o-l.shape[a],d=e&&h?u(h):null,p=[d,n,l].filter(function(m){return!!m}).map(function(m){return m.toFloat()});return _i(p,a)})}function Ly(n){return 1/(1+Math.exp(-n))}var Ub=(function(n){an(e,n);function e(t,r,i,o,s){return s===void 0&&(s=!1),n.call(this,{x:t,y:r,width:i,height:o},s)||this}return e})(ph),XV=.5,YV=.43,JV=.45,ym=(function(){function n(e,t,r){r===void 0&&(r=new Hn(0,0));var i=t.width,o=t.height;this._imgDims=new hf(i,o),this._shift=r,this._positions=e.map(function(s){return s.mul(new Hn(i,o)).add(r)})}return Object.defineProperty(n.prototype,"shift",{get:function(){return new Hn(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(t){return t.sub(e._shift).div(new Hn(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),n.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},n.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new Hn(e,t))},n.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},n.prototype.align=function(e,t){if(t===void 0&&(t={}),e){var r=e instanceof bu?e.box.floor():new ph(e);return this.shiftBy(r.x,r.y).align(null,t)}var i=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),o=i.useDlibAlignment,s=i.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(s)},n.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),t=e[0],r=e[1],i=e[2],o=function(d){return i.sub(d).magnitude()},s=(o(t)+o(r))/2,a=Math.floor(s/JV),u=jb(e),l=Math.floor(Math.max(0,u.x-XV*a)),h=Math.floor(Math.max(0,u.y-YV*a));return new Ub(l,h,Math.min(a,this.imageWidth+l),Math.min(a,this.imageHeight+h))},n.prototype.alignMinBbox=function(e){var t=$V(this.positions);return t.pad(t.width*e,t.height*e)},n.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},n})(),QV=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],jb([t[3],t[4]])]},e})(ym),ZV=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(jb)},e})(ym),vS=(function(){function n(e,t){this._label=e,this._distance=t}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),n.prototype.toString=function(e){return e===void 0&&(e=!0),""+this.label+(e?" ("+qV(this.distance)+")":"")},n})(),yS=(function(n){an(e,n);function e(t,r){var i=n.call(this,t)||this;return i._label=r,i}return e.assertIsValidLabeledBox=function(t,r){if(ph.assertIsValidBox(t,r),!ff(t.label))throw new Error(r+" - expected property label ("+t.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e})(ph),$g=(function(){function n(e,t){if(typeof e!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),n.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},n.fromJSON=function(e){var t=e.descriptors.map(function(r){return new Float32Array(r)});return new n(e.label,t)},n})();(function(n){an(e,n);function e(t,r,i,o){var s=n.call(this,t,r)||this;return s._score=i,s._classScore=o,s}return e.assertIsValidPredictedBox=function(t,r){if(yS.assertIsValidLabeledBox(t,r),!gS(t.score)||!gS(t.classScore))throw new Error(r+" - expected properties score ("+t.score+") and ("+t.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),e})(yS);function MI(n){return n.detection instanceof bu}function wm(n,e){var t={detection:e};return Object.assign({},n,t)}function FI(){var n=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},e=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:n,readFile:e}}function OI(n){var e="";if(!n)try{n=require("fs")}catch(r){e=r.toString()}var t=n?function(r){return new Promise(function(i,o){n.readFile(r,function(s,a){return s?o(s):i(a)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)};return{readFile:t}}function BI(){var n=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,t=function(){if(n)return new n;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},i=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},o=OI();return Lo({Canvas:n||(function(){function s(){}return s})(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||(function(){function s(){}return s})(),Image:e||(function(){function s(){}return s})(),ImageData:global.ImageData||(function(){function s(){}return s})(),Video:global.HTMLVideoElement||(function(){function s(){}return s})(),createCanvasElement:t,createImageElement:r,fetch:i},o)}function VI(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function jI(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var bi;function ej(){if(!bi)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return bi}function z2(n){bi=n}function zb(){VI()&&z2(FI()),jI()&&z2(BI())}function tj(n){if(bi||zb(),!bi)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=n.Canvas,t=e===void 0?bi.Canvas:e,r=n.Image,i=r===void 0?bi.Image:r;bi.Canvas=t,bi.Image=i,bi.createCanvasElement=n.createCanvasElement||(function(){return new t}),bi.createImageElement=n.createImageElement||(function(){return new i}),bi.ImageData=n.ImageData||bi.ImageData,bi.Video=n.Video||bi.Video,bi.fetch=n.fetch||bi.fetch,bi.readFile=n.readFile||bi.readFile}var lo={getEnv:ej,setEnv:z2,initialize:zb,createBrowserEnv:FI,createFileSystem:OI,createNodejsEnv:BI,monkeyPatch:tj,isBrowser:VI,isNodejs:jI};zb();function UI(n){return!lo.isNodejs()&&typeof n=="string"?document.getElementById(n):n}function vf(n){var e=lo.getEnv(),t=e.Canvas,r=e.CanvasRenderingContext2D;if(n instanceof r)return n;var i=UI(n);if(!(i instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=i.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}var wS;(function(n){n.TOP_LEFT="TOP_LEFT",n.TOP_RIGHT="TOP_RIGHT",n.BOTTOM_LEFT="BOTTOM_LEFT",n.BOTTOM_RIGHT="BOTTOM_RIGHT"})(wS||(wS={}));function zI(n){var e=lo.getEnv(),t=e.Image,r=e.Video;return n instanceof t&&n.complete||n instanceof r&&n.readyState>=3}function nj(n){return new Promise(function(e,t){if(n instanceof lo.getEnv().Canvas||zI(n))return e();function r(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",i),e(o))}function i(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",i),t(o))}n.addEventListener("load",r),n.addEventListener("error",i)})}function rj(n){return new Promise(function(e,t){if(!(n instanceof Blob))return t("bufferToImage - expected buf to be of type: Blob");var r=new FileReader;r.onload=function(){if(typeof r.result!="string")return t("bufferToImage - expected reader.result to be a string, in onload");var i=lo.getEnv().createImageElement();i.onload=function(){return e(i)},i.onerror=t,i.src=r.result},r.onerror=t,r.readAsDataURL(n)})}function WI(n){var e=lo.getEnv(),t=e.Image,r=e.Video;return n instanceof t?new hf(n.naturalWidth,n.naturalHeight):n instanceof r?new hf(n.videoWidth,n.videoHeight):new hf(n.width,n.height)}function F0(n){var e=n.width,t=n.height,r=lo.getEnv().createCanvasElement,i=r();return i.width=e,i.height=t,i}function Wb(n,e){var t=lo.getEnv().ImageData;if(!(n instanceof t)&&!zI(n))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=WI(n),i=r.width,o=r.height,s=F0({width:i,height:o});return n instanceof t?vf(s).putImageData(n,0,0):vf(s).drawImage(n,0,0,i,o),s}function ij(n,e){return Ot(this,void 0,void 0,function(){var t,r,i,o,s,a;return Bt(this,function(u){switch(u.label){case 0:return t=lo.getEnv().createCanvasElement(),r=n.shape.slice(rh(n)?1:0),i=r[0],o=r[1],s=r[2],a=At(function(){return n.as3D(i,o,s).toInt()}),[4,Vb.toPixels(a,t)];case 1:return u.sent(),a.dispose(),[2,t]}})})}function bS(n){var e=lo.getEnv(),t=e.Image,r=e.Canvas,i=e.Video;return n instanceof t||n instanceof r||n instanceof i}function oj(n,e,t){t===void 0&&(t=!1);var r=lo.getEnv(),i=r.Image,o=r.Canvas;if(!(n instanceof i||n instanceof o))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var s=WI(n),a=e/Math.max(s.height,s.width),u=a*s.width,l=a*s.height,h=F0({width:e,height:e}),d=n instanceof o?n:Wb(n),p=Math.abs(u-l)/2,m=t&&u<l?p:0,w=t&&l<u?p:0;return vf(h).drawImage(d,m,w,u,l),h}var Qv=(function(){function n(e,t){var r=this;if(t===void 0&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach(function(i,o){if(L0(i)){r._imageTensors[o]=i,r._inputDimensions[o]=i.shape;return}if(rh(i)){var s=i.shape[0];if(s!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+s+" passed, but not supported in input array");r._imageTensors[o]=i,r._inputDimensions[o]=i.shape.slice(1);return}var a=i instanceof lo.getEnv().Canvas?i:Wb(i);r._canvases[o]=a,r._inputDimensions[o]=[a.height,a.width,3]})}return Object.defineProperty(n.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reshapedInputDimensions",{get:function(){var e=this;return gm(this.batchSize,0,1).map(function(t,r){return e.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),n.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},n.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},n.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},n.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},n.prototype.getReshapedInputDimensions=function(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var t=this.getInputWidth(e),r=this.getInputHeight(e);return HV({width:t,height:r},this.inputSize)},n.prototype.toBatchTensor=function(e,t){var r=this;return t===void 0&&(t=!0),this._inputSize=e,At(function(){var i=gm(r.batchSize,0,1).map(function(s){var a=r.getInput(s);if(a instanceof Tr){var u=rh(a)?a:a.expandDims();return u=KV(u,t),(u.shape[1]!==e||u.shape[2]!==e)&&(u=Db.resizeBilinear(u,[e,e])),u.as3D(e,e,3)}if(a instanceof lo.getEnv().Canvas)return Vb.fromPixels(oj(a,e,t));throw new Error("toBatchTensor - at batchIdx "+s+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+a)}),o=na(i.map(function(s){return s.toFloat()})).as4D(r.batchSize,e,e,3);return o})},n})();function Hi(n){return Ot(this,void 0,void 0,function(){var e,t,r;return Bt(this,function(i){switch(i.label){case 0:if(n instanceof Qv)return[2,n];if(e=Array.isArray(n)?n:[n],!e.length)throw new Error("toNetInput - empty array passed as input");return t=function(o){return Array.isArray(n)?" at input index "+o+":":""},r=e.map(UI),r.forEach(function(o,s){if(!bS(o)&&!L0(o)&&!rh(o))throw typeof e[s]=="string"?new Error("toNetInput -"+t(s)+" string passed, but could not resolve HTMLElement for element id "+e[s]):new Error("toNetInput -"+t(s)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(rh(o)){var a=o.shape[0];if(a!==1)throw new Error("toNetInput -"+t(s)+" tf.Tensor4D with batchSize "+a+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(o){return bS(o)&&nj(o)}))];case 1:return i.sent(),[2,new Qv(r,Array.isArray(n))]}})})}function qb(n,e){return Ot(this,void 0,void 0,function(){var t,r,i,o,s,a,u;return Bt(this,function(l){switch(l.label){case 0:return t=lo.getEnv().Canvas,r=n,n instanceof t?[3,5]:[4,Hi(n)];case 1:if(i=l.sent(),i.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return o=i.getInput(0),o instanceof t?(s=o,[3,4]):[3,2];case 2:return[4,ij(o)];case 3:s=l.sent(),l.label=4;case 4:r=s,l.label=5;case 5:return a=vf(r),u=e.map(function(h){return h instanceof bu?h.forSize(r.width,r.height).box.floor():h}).map(function(h){return h.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(h){var d=h.x,p=h.y,m=h.width,w=h.height,b=F0({width:m,height:w});return vf(b).putImageData(a.getImageData(d,p,m,w),0,0),b})]}})})}function Hb(n,e){return Ot(this,void 0,void 0,function(){return Bt(this,function(t){if(!L0(n)&&!rh(n))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(rh(n)&&n.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,At(function(){var r=n.shape.slice(rh(n)?1:0),i=r[0],o=r[1],s=r[2],a=e.map(function(l){return l instanceof bu?l.forSize(o,i).box:l}).map(function(l){return l.clipAtImageBorders(o,i)}),u=a.map(function(l){var h=l.x,d=l.y,p=l.width,m=l.height;return mI(n.as3D(i,o,s),[d,h,0],[m,p,s])});return u})]})})}function sj(n,e){return Ot(this,void 0,void 0,function(){var t,r;return Bt(this,function(i){switch(i.label){case 0:return t=lo.getEnv().fetch,[4,t(n,e)];case 1:if(r=i.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function aj(n){return Ot(this,void 0,void 0,function(){return Bt(this,function(e){switch(e.label){case 0:return[4,sj(n)];case 1:return[2,e.sent().json()]}})})}function qI(n,e){var t=e+"-weights_manifest.json";if(!n)return{modelBaseUri:"",manifestUri:t};if(n==="/")return{modelBaseUri:"/",manifestUri:"/"+t};var r=n.startsWith("http://")?"http://":n.startsWith("https://")?"https://":"";n=n.replace(r,"");var i=n.split("/").filter(function(a){return a}),o=n.endsWith(".json")?i[i.length-1]:t,s=r+(n.endsWith(".json")?i.slice(0,i.length-1):i).join("/");return s=n.startsWith("/")?"/"+s:s,{modelBaseUri:s,manifestUri:s==="/"?"/"+o:s+"/"+o}}function uj(n,e){return Ot(this,void 0,void 0,function(){var t,r,i,o;return Bt(this,function(s){switch(s.label){case 0:return t=qI(n,e),r=t.manifestUri,i=t.modelBaseUri,[4,aj(r)];case 1:return o=s.sent(),[2,RI.loadWeights(o,i)]}})})}var ec=(function(){function n(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(n.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),n.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e),r=t.obj,i=t.objProp;return r[i]},n.prototype.reassignParamFromPath=function(e,t){var r=this.traversePropertyPath(e),i=r.obj,o=r.objProp;i[o].dispose(),i[o]=t},n.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(t){var r=t.paramPath;return{path:r,tensor:e.getParamFromPath(r)}})},n.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof qd})},n.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof qd)})},n.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(t){var r=t.path,i=t.tensor;e.reassignParamFromPath(r,i.variable())})},n.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(t){var r=t.path,i=t.tensor,o=uo(i.dataSync());i.dispose(),e.reassignParamFromPath(r,o)})},n.prototype.dispose=function(e){e===void 0&&(e=!0),this.getParamList().forEach(function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()}),this._params=void 0},n.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var t=e.tensor;return Array.from(t.dataSync())}).reduce(function(e,t){return e.concat(t)}))},n.prototype.load=function(e){return Ot(this,void 0,void 0,function(){return Bt(this,function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}})})},n.prototype.loadFromUri=function(e){return Ot(this,void 0,void 0,function(){var t;return Bt(this,function(r){switch(r.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,uj(e,this.getDefaultModelName())];case 1:return t=r.sent(),this.loadFromWeightMap(t),[2]}})})},n.prototype.loadFromDisk=function(e){return Ot(this,void 0,void 0,function(){var t,r,i,o,s,a,u,l,h,d;return Bt(this,function(p){switch(p.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return t=lo.getEnv().readFile,r=qI(e,this.getDefaultModelName()),i=r.manifestUri,o=r.modelBaseUri,s=function(m){return Promise.all(m.map(function(w){return t(w).then(function(b){return b.buffer})}))},a=RI.weightsLoaderFactory(s),h=(l=JSON).parse,[4,t(i)];case 1:return u=h.apply(l,[p.sent().toString()]),[4,a(u,o)];case 2:return d=p.sent(),this.loadFromWeightMap(d),[2]}})})},n.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),r=t.paramMappings,i=t.params;this._paramMappings=r,this._params=i},n.prototype.extractWeights=function(e){var t=this.extractParams(e),r=t.paramMappings,i=t.params;this._paramMappings=r,this._params=i},n.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce(function(o,s){if(!o.nextObj.hasOwnProperty(s))throw new Error("traversePropertyPath - object does not have property "+s+", for path "+e);return{obj:o.nextObj,objProp:s,nextObj:o.nextObj[s]}},{nextObj:this.params}),r=t.obj,i=t.objProp;if(!r||!i||!(r[i]instanceof Tr))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:r,objProp:i}},n})();function Qs(n,e,t){return At(function(){var r=Tb(n,e.depthwise_filter,e.pointwise_filter,t,"same");return r=bn(r,e.bias),r})}function My(n,e,t){return t===void 0&&(t=!1),At(function(){var r=Pr(t?bn(Da(n,e.conv0.filters,[2,2],"same"),e.conv0.bias):Qs(n,e.conv0,[2,2])),i=Qs(r,e.conv1,[1,1]),o=Pr(bn(r,i)),s=Qs(o,e.conv2,[1,1]);return Pr(bn(r,bn(i,s)))})}function Kg(n,e,t,r){return t===void 0&&(t=!1),r===void 0&&(r=!0),At(function(){var i=Pr(t?bn(Da(n,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):Qs(n,e.conv0,r?[2,2]:[1,1])),o=Qs(i,e.conv1,[1,1]),s=Pr(bn(i,o)),a=Qs(s,e.conv2,[1,1]),u=Pr(bn(i,bn(o,a))),l=Qs(u,e.conv3,[1,1]);return Pr(bn(i,bn(o,bn(a,l))))})}function mu(n,e,t,r){return t===void 0&&(t="same"),r===void 0&&(r=!1),At(function(){var i=bn(Da(n,e.filters,[1,1],t),e.bias);return r?Pr(i):i})}function tc(n,e){Object.keys(n).forEach(function(t){e.some(function(r){return r.originalPath===t})||n[t].dispose()})}function O0(n,e){return function(t,r,i,o){var s=Ss(n(t*r*i*i),[i,i,t,r]),a=ai(n(r));return e.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:s,bias:a}}}function Gb(n,e){return function(t,r,i){var o=th(n(t*r),[t,r]),s=ai(n(r));return e.push({paramPath:i+"/weights"},{paramPath:i+"/bias"}),{weights:o,bias:s}}}var HI=(function(){function n(e,t,r){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=r}return n})();function $b(n,e){return function(t,r,i){var o=Ss(n(9*t),[3,3,t,1]),s=Ss(n(t*r),[1,1,t,r]),a=ai(n(r));return e.push({paramPath:i+"/depthwise_filter"},{paramPath:i+"/pointwise_filter"},{paramPath:i+"/bias"}),new HI(o,s,a)}}function Kb(n){return function(e){var t=n(e+"/depthwise_filter",4),r=n(e+"/pointwise_filter",4),i=n(e+"/bias",1);return new HI(t,r,i)}}function Th(n,e){return function(t,r,i){var o=n[t];if(!D0(o,r))throw new Error("expected weightMap["+t+"] to be a Tensor"+r+"D, instead have "+o);return e.push({originalPath:t,paramPath:i||t}),o}}function nc(n){var e=n;function t(i){var o=e.slice(0,i);return e=e.slice(i),o}function r(){return e}return{extractWeights:t,getRemainingWeights:r}}function GI(n,e){var t=O0(n,e),r=$b(n,e);function i(s,a,u,l){l===void 0&&(l=!1);var h=l?t(s,a,3,u+"/conv0"):r(s,a,u+"/conv0"),d=r(a,a,u+"/conv1"),p=r(a,a,u+"/conv2");return{conv0:h,conv1:d,conv2:p}}function o(s,a,u,l){l===void 0&&(l=!1);var h=i(s,a,u,l),d=h.conv0,p=h.conv1,m=h.conv2,w=r(a,a,u+"/conv3");return{conv0:d,conv1:p,conv2:m,conv3:w}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:o}}function lj(n){var e=[],t=nc(n),r=t.extractWeights,i=t.getRemainingWeights,o=GI(r,e).extractDenseBlock4Params,s=o(3,32,"dense0",!0),a=o(32,64,"dense1"),u=o(64,128,"dense2"),l=o(128,256,"dense3");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{dense0:s,dense1:a,dense2:u,dense3:l}}}function $I(n){return function(e){var t=n(e+"/filters",4),r=n(e+"/bias",1);return{filters:t,bias:r}}}function KI(n,e){var t=Th(n,e),r=$I(t),i=Kb(t);function o(a,u){u===void 0&&(u=!1);var l=u?r(a+"/conv0"):i(a+"/conv0"),h=i(a+"/conv1"),d=i(a+"/conv2");return{conv0:l,conv1:h,conv2:d}}function s(a,u){u===void 0&&(u=!1);var l=u?r(a+"/conv0"):i(a+"/conv0"),h=i(a+"/conv1"),d=i(a+"/conv2"),p=i(a+"/conv3");return{conv0:l,conv1:h,conv2:d,conv3:p}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:s}}function cj(n){var e=[],t=KI(n,e).extractDenseBlock4Params,r={dense0:t("dense0",!0),dense1:t("dense1"),dense2:t("dense2"),dense3:t("dense3")};return tc(n,e),{params:r,paramMappings:e}}var XI=(function(n){an(e,n);function e(){return n.call(this,"FaceFeatureExtractor")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return At(function(){var i=t.toBatchTensor(112,!0),o=[122.782,117.001,104.298],s=jm(i,o).div(wt(255)),a=Kg(s,r.dense0,!0);return a=Kg(a,r.dense1),a=Kg(a,r.dense2),a=Kg(a,r.dense3),a=Bm(a,[7,7],[2,2],"valid"),a})},e.prototype.forward=function(t){return Ot(this,void 0,void 0,function(){var r;return Bt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Hi(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(t){return cj(t)},e.prototype.extractParams=function(t){return lj(t)},e})(ec);function Ju(n,e){return At(function(){return bn(N0(n,e.weights),e.bias)})}function hj(n,e,t){var r=[],i=nc(n),o=i.extractWeights,s=i.getRemainingWeights,a=Gb(o,r),u=a(e,t,"fc");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:r,params:{fc:u}}}function fj(n){var e=[],t=Th(n,e);function r(o){var s=t(o+"/weights",2),a=t(o+"/bias",1);return{weights:s,bias:a}}var i={fc:r("fc")};return tc(n,e),{params:i,paramMappings:e}}function YI(n){var e={},t={};return Object.keys(n).forEach(function(r){var i=r.startsWith("fc")?t:e;i[r]=n[r]}),{featureExtractorMap:e,classifierMap:t}}var JI=(function(n){an(e,n);function e(t,r){var i=n.call(this,t)||this;return i._faceFeatureExtractor=r,i}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var r=this,i=this.params;if(!i)throw new Error(this._name+" - load model before inference");return At(function(){var o=t instanceof Qv?r.faceFeatureExtractor.forwardInput(t):t;return Ju(o.as2D(o.shape[0],-1),i.fc)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.faceFeatureExtractor.dispose(t),n.prototype.dispose.call(this,t)},e.prototype.loadClassifierParams=function(t){var r=this.extractClassifierParams(t),i=r.params,o=r.paramMappings;this._params=i,this._paramMappings=o},e.prototype.extractClassifierParams=function(t){return hj(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(t){var r=YI(t),i=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),fj(o)},e.prototype.extractParams=function(t){var r=this.getClassifierChannelsIn(),i=this.getClassifierChannelsOut(),o=i*r+i,s=t.slice(0,t.length-o),a=t.slice(t.length-o);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(a)},e})(ec),xS=["neutral","happy","sad","angry","fearful","disgusted","surprised"],dj=(function(){function n(e){var t=this;if(e.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);xS.forEach(function(r,i){t[r]=e[i]})}return n.prototype.asSortedArray=function(){var e=this;return xS.map(function(t){return{expression:t,probability:e[t]}}).sort(function(t,r){return r.probability-t.probability})},n})(),pj=(function(n){an(e,n);function e(t){return t===void 0&&(t=new XI),n.call(this,"FaceExpressionNet",t)||this}return e.prototype.forwardInput=function(t){var r=this;return At(function(){return Ql(r.runNet(t))})},e.prototype.forward=function(t){return Ot(this,void 0,void 0,function(){var r;return Bt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Hi(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.predictExpressions=function(t){return Ot(this,void 0,void 0,function(){var r,i,o,s,a=this;return Bt(this,function(u){switch(u.label){case 0:return[4,Hi(t)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return i=u.sent(),[4,Promise.all(Ei(i).map(function(l){return Ot(a,void 0,void 0,function(){var h;return Bt(this,function(d){switch(d.label){case 0:return[4,l.data()];case 1:return h=d.sent(),l.dispose(),[2,h]}})})}))];case 3:return o=u.sent(),i.dispose(),s=o.map(function(l){return new dj(l)}),[2,r.isBatchInput?s:s[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e})(JI);function QI(n,e){var t={expressions:e};return Object.assign({},n,t)}function ZI(n){return MI(n)&&n.landmarks instanceof ym&&n.unshiftedLandmarks instanceof ym&&n.alignedRect instanceof bu}function B0(n,e){var t=n.detection.box,r=e.shiftBy(t.x,t.y),i=r.align(),o=n.detection.imageDims,s=new bu(n.detection.score,i.rescale(o.reverse()),o),a={landmarks:r,unshiftedLandmarks:e,alignedRect:s};return Object.assign({},n,a)}function mj(n,e){var t=O0(n,e),r=$b(n,e);function i(s,a,u){var l=r(s,a,u+"/separable_conv0"),h=r(a,a,u+"/separable_conv1"),d=t(s,a,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:h,expansion_conv:d}}function o(s,a){var u=r(s,s,a+"/separable_conv0"),l=r(s,s,a+"/separable_conv1"),h=r(s,s,a+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:h}}return{extractConvParams:t,extractSeparableConvParams:r,extractReductionBlockParams:i,extractMainBlockParams:o}}function gj(n,e){var t=[],r=nc(n),i=r.extractWeights,o=r.getRemainingWeights,s=mj(i,t),a=s.extractConvParams,u=s.extractSeparableConvParams,l=s.extractReductionBlockParams,h=s.extractMainBlockParams,d=a(3,32,3,"entry_flow/conv_in"),p=l(32,64,"entry_flow/reduction_block_0"),m=l(64,128,"entry_flow/reduction_block_1"),w={conv_in:d,reduction_block_0:p,reduction_block_1:m},b={};gm(e,0,1).forEach(function(N){b["main_block_"+N]=h(128,"middle_flow/main_block_"+N)});var x=l(128,256,"exit_flow/reduction_block"),E=u(256,512,"exit_flow/separable_conv"),A={reduction_block:x,separable_conv:E};if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{entry_flow:w,middle_flow:b,exit_flow:A}}}function vj(n,e){var t=Th(n,e),r=$I(t),i=Kb(t);function o(a){var u=i(a+"/separable_conv0"),l=i(a+"/separable_conv1"),h=r(a+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:h}}function s(a){var u=i(a+"/separable_conv0"),l=i(a+"/separable_conv1"),h=i(a+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:h}}return{extractConvParams:r,extractSeparableConvParams:i,extractReductionBlockParams:o,extractMainBlockParams:s}}function yj(n,e){var t=[],r=vj(n,t),i=r.extractConvParams,o=r.extractSeparableConvParams,s=r.extractReductionBlockParams,a=r.extractMainBlockParams,u=i("entry_flow/conv_in"),l=s("entry_flow/reduction_block_0"),h=s("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:l,reduction_block_1:h},p={};gm(e,0,1).forEach(function(x){p["main_block_"+x]=a("middle_flow/main_block_"+x)});var m=s("exit_flow/reduction_block"),w=o("exit_flow/separable_conv"),b={reduction_block:m,separable_conv:w};return tc(n,t),{params:{entry_flow:d,middle_flow:p,exit_flow:b},paramMappings:t}}function eT(n,e,t){return bn(Da(n,e.filters,t,"same"),e.bias)}function Fy(n,e,t){t===void 0&&(t=!0);var r=t?Pr(n):n;return r=Qs(r,e.separable_conv0,[1,1]),r=Qs(Pr(r),e.separable_conv1,[1,1]),r=Ui(r,[3,3],[2,2],"same"),r=bn(r,eT(n,e.expansion_conv,[2,2])),r}function wj(n,e){var t=Qs(Pr(n),e.separable_conv0,[1,1]);return t=Qs(Pr(t),e.separable_conv1,[1,1]),t=Qs(Pr(t),e.separable_conv2,[1,1]),t=bn(t,n),t}var bj=(function(n){an(e,n);function e(t){var r=n.call(this,"TinyXception")||this;return r._numMainBlocks=t,r}return e.prototype.forwardInput=function(t){var r=this,i=this.params;if(!i)throw new Error("TinyXception - load model before inference");return At(function(){var o=t.toBatchTensor(112,!0),s=[122.782,117.001,104.298],a=jm(o,s).div(wt(256)),u=Pr(eT(a,i.entry_flow.conv_in,[2,2]));return u=Fy(u,i.entry_flow.reduction_block_0,!1),u=Fy(u,i.entry_flow.reduction_block_1),gm(r._numMainBlocks,0,1).forEach(function(l){u=wj(u,i.middle_flow["main_block_"+l])}),u=Fy(u,i.exit_flow.reduction_block),u=Pr(Qs(u,i.exit_flow.separable_conv,[1,1])),u})},e.prototype.forward=function(t){return Ot(this,void 0,void 0,function(){var r;return Bt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Hi(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(t){return yj(t,this._numMainBlocks)},e.prototype.extractParams=function(t){return gj(t,this._numMainBlocks)},e})(ec);function xj(n){var e=[],t=nc(n),r=t.extractWeights,i=t.getRemainingWeights,o=Gb(r,e),s=o(512,1,"fc/age"),a=o(512,2,"fc/gender");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{fc:{age:s,gender:a}}}}function _j(n){var e=[],t=Th(n,e);function r(o){var s=t(o+"/weights",2),a=t(o+"/bias",1);return{weights:s,bias:a}}var i={fc:{age:r("fc/age"),gender:r("fc/gender")}};return tc(n,e),{params:i,paramMappings:e}}var Zv;(function(n){n.FEMALE="female",n.MALE="male"})(Zv||(Zv={}));var Ej=(function(n){an(e,n);function e(t){t===void 0&&(t=new bj(2));var r=n.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=t,r}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var r=this,i=this.params;if(!i)throw new Error(this._name+" - load model before inference");return At(function(){var o=t instanceof Qv?r.faceFeatureExtractor.forwardInput(t):t,s=Bm(o,[7,7],[2,2],"valid").as2D(o.shape[0],-1),a=Ju(s,i.fc.age).as1D(),u=Ju(s,i.fc.gender);return{age:a,gender:u}})},e.prototype.forwardInput=function(t){var r=this;return At(function(){var i=r.runNet(t),o=i.age,s=i.gender;return{age:o,gender:Ql(s)}})},e.prototype.forward=function(t){return Ot(this,void 0,void 0,function(){var r;return Bt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Hi(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.predictAgeAndGender=function(t){return Ot(this,void 0,void 0,function(){var r,i,o,s,a,u,l=this;return Bt(this,function(h){switch(h.label){case 0:return[4,Hi(t)];case 1:return r=h.sent(),[4,this.forwardInput(r)];case 2:return i=h.sent(),o=Ei(i.age),s=Ei(i.gender),a=o.map(function(d,p){return{ageTensor:d,genderTensor:s[p]}}),[4,Promise.all(a.map(function(d){var p=d.ageTensor,m=d.genderTensor;return Ot(l,void 0,void 0,function(){var w,b,x,E,A;return Bt(this,function(N){switch(N.label){case 0:return[4,p.data()];case 1:return w=N.sent()[0],[4,m.data()];case 2:return b=N.sent()[0],x=b>.5,E=x?Zv.MALE:Zv.FEMALE,A=x?b:1-b,p.dispose(),m.dispose(),[2,{age:w,gender:E,genderProbability:A}]}})})}))];case 3:return u=h.sent(),i.age.dispose(),i.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.faceFeatureExtractor.dispose(t),n.prototype.dispose.call(this,t)},e.prototype.loadClassifierParams=function(t){var r=this.extractClassifierParams(t),i=r.params,o=r.paramMappings;this._params=i,this._paramMappings=o},e.prototype.extractClassifierParams=function(t){return xj(t)},e.prototype.extractParamsFromWeigthMap=function(t){var r=YI(t),i=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),_j(o)},e.prototype.extractParams=function(t){var r=1539,i=t.slice(0,t.length-r),o=t.slice(t.length-r);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(o)},e})(ec),tT=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.postProcess=function(t,r,i){var o=i.map(function(a){var u=a.width,l=a.height,h=r/Math.max(l,u);return{width:u*h,height:l*h}}),s=o.length;return At(function(){var a=function(p,m){return na([rl([68],p),rl([68],m)],1).as2D(1,136).as1D()},u=function(p,m){var w=o[p],b=w.width,x=w.height;return m(b,x)?Math.abs(b-x)/2:0},l=function(p){return u(p,function(m,w){return m<w})},h=function(p){return u(p,function(m,w){return w<m})},d=t.mul(rl([s,136],r)).sub(na(Array.from(Array(s),function(p,m){return a(l(m),h(m))}))).div(na(Array.from(Array(s),function(p,m){return a(o[m].width,o[m].height)})));return d})},e.prototype.forwardInput=function(t){var r=this;return At(function(){var i=r.runNet(t);return r.postProcess(i,t.inputSize,t.inputDimensions.map(function(o){var s=o[0],a=o[1];return{height:s,width:a}}))})},e.prototype.forward=function(t){return Ot(this,void 0,void 0,function(){var r;return Bt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Hi(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.detectLandmarks=function(t){return Ot(this,void 0,void 0,function(){var r,i,o,s=this;return Bt(this,function(a){switch(a.label){case 0:return[4,Hi(t)];case 1:return r=a.sent(),i=At(function(){return Ei(s.forwardInput(r))}),[4,Promise.all(i.map(function(u,l){return Ot(s,void 0,void 0,function(){var h,d,p,m,w;return Bt(this,function(b){switch(b.label){case 0:return p=(d=Array).from,[4,u.data()];case 1:return h=p.apply(d,[b.sent()]),m=h.filter(function(x,E){return pS(E)}),w=h.filter(function(x,E){return!pS(E)}),[2,new ZV(Array(68).fill(0).map(function(x,E){return new Hn(m[E],w[E])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return o=a.sent(),i.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e})(JI),nT=(function(n){an(e,n);function e(t){return t===void 0&&(t=new XI),n.call(this,"FaceLandmark68Net",t)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e})(tT);function Sj(n){var e=[],t=KI(n,e).extractDenseBlock3Params,r={dense0:t("dense0",!0),dense1:t("dense1"),dense2:t("dense2")};return tc(n,e),{params:r,paramMappings:e}}function Aj(n){var e=[],t=nc(n),r=t.extractWeights,i=t.getRemainingWeights,o=GI(r,e).extractDenseBlock3Params,s=o(3,32,"dense0",!0),a=o(32,64,"dense1"),u=o(64,128,"dense2");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{dense0:s,dense1:a,dense2:u}}}var Cj=(function(n){an(e,n);function e(){return n.call(this,"TinyFaceFeatureExtractor")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return At(function(){var i=t.toBatchTensor(112,!0),o=[122.782,117.001,104.298],s=jm(i,o).div(wt(255)),a=My(s,r.dense0,!0);return a=My(a,r.dense1),a=My(a,r.dense2),a=Bm(a,[14,14],[2,2],"valid"),a})},e.prototype.forward=function(t){return Ot(this,void 0,void 0,function(){var r;return Bt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Hi(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(t){return Sj(t)},e.prototype.extractParams=function(t){return Aj(t)},e})(ec),Ij=(function(n){an(e,n);function e(t){return t===void 0&&(t=new Cj),n.call(this,"FaceLandmark68TinyNet",t)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e})(tT);(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(nT);function Tj(n,e){return bn(jo(n,e.weights),e.biases)}function Xb(n,e,t,r,i){i===void 0&&(i="same");var o=e.conv,s=o.filters,a=o.bias,u=Da(n,s,t,i);return u=bn(u,a),u=Tj(u,e.scale),r?Pr(u):u}function kj(n,e){return Xb(n,e,[1,1],!0)}function rT(n,e){return Xb(n,e,[1,1],!1)}function iT(n,e){return Xb(n,e,[2,2],!0,"valid")}function Nj(n,e){function t(a,u,l){var h=n(a),d=h.length/(u*l*l);if(WV(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+h.length+", numFilters: "+u+", filterSize: "+l);return At(function(){return dh(Ss(h,[u,d,l,l]),[2,3,1,0])})}function r(a,u,l,h){var d=t(a,u,l),p=ai(n(u));return e.push({paramPath:h+"/filters"},{paramPath:h+"/bias"}),{filters:d,bias:p}}function i(a,u){var l=ai(n(a)),h=ai(n(a));return e.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:h}}function o(a,u,l,h){var d=r(a,u,l,h+"/conv"),p=i(u,h+"/scale");return{conv:d,scale:p}}function s(a,u,l,h,d){d===void 0&&(d=!1);var p=o((d?.5:1)*a,u,l,h+"/conv1"),m=o(a,u,l,h+"/conv2");return{conv1:p,conv2:m}}return{extractConvLayerParams:o,extractResidualLayerParams:s}}function Pj(n){var e=nc(n),t=e.extractWeights,r=e.getRemainingWeights,i=[],o=Nj(t,i),s=o.extractConvLayerParams,a=o.extractResidualLayerParams,u=s(4704,32,7,"conv32_down"),l=a(9216,32,3,"conv32_1"),h=a(9216,32,3,"conv32_2"),d=a(9216,32,3,"conv32_3"),p=a(36864,64,3,"conv64_down",!0),m=a(36864,64,3,"conv64_1"),w=a(36864,64,3,"conv64_2"),b=a(36864,64,3,"conv64_3"),x=a(147456,128,3,"conv128_down",!0),E=a(147456,128,3,"conv128_1"),A=a(147456,128,3,"conv128_2"),N=a(589824,256,3,"conv256_down",!0),F=a(589824,256,3,"conv256_1"),D=a(589824,256,3,"conv256_2"),W=a(589824,256,3,"conv256_down_out"),k=At(function(){return dh(th(t(256*128),[128,256]),[1,0])});if(i.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var C={conv32_down:u,conv32_1:l,conv32_2:h,conv32_3:d,conv64_down:p,conv64_1:m,conv64_2:w,conv64_3:b,conv128_down:x,conv128_1:E,conv128_2:A,conv256_down:N,conv256_1:F,conv256_2:D,conv256_down_out:W,fc:k};return{params:C,paramMappings:i}}function Rj(n,e){var t=Th(n,e);function r(s){var a=t(s+"/scale/weights",1),u=t(s+"/scale/biases",1);return{weights:a,biases:u}}function i(s){var a=t(s+"/conv/filters",4),u=t(s+"/conv/bias",1),l=r(s);return{conv:{filters:a,bias:u},scale:l}}function o(s){return{conv1:i(s+"/conv1"),conv2:i(s+"/conv2")}}return{extractConvLayerParams:i,extractResidualLayerParams:o}}function Dj(n){var e=[],t=Rj(n,e),r=t.extractConvLayerParams,i=t.extractResidualLayerParams,o=r("conv32_down"),s=i("conv32_1"),a=i("conv32_2"),u=i("conv32_3"),l=i("conv64_down"),h=i("conv64_1"),d=i("conv64_2"),p=i("conv64_3"),m=i("conv128_down"),w=i("conv128_1"),b=i("conv128_2"),x=i("conv256_down"),E=i("conv256_1"),A=i("conv256_2"),N=i("conv256_down_out"),F=n.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!zV(F))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+F);var D={conv32_down:o,conv32_1:s,conv32_2:a,conv32_3:u,conv64_down:l,conv64_1:h,conv64_2:d,conv64_3:p,conv128_down:m,conv128_1:w,conv128_2:b,conv256_down:x,conv256_1:E,conv256_2:A,conv256_down_out:N,fc:F};return tc(n,e),{params:D,paramMappings:e}}function zu(n,e){var t=kj(n,e.conv1);return t=rT(t,e.conv2),t=bn(t,n),t=Pr(t),t}function Xg(n,e){var t=iT(n,e.conv1);t=rT(t,e.conv2);var r=Bm(n,2,2,"valid"),i=mr(r.shape),o=r.shape[3]!==t.shape[3],s=r.shape[1]!==t.shape[1]||r.shape[2]!==t.shape[2];if(s){var a=Qp(t.shape);a[1]=1;var u=mr(a);t=_i([t,u],1);var l=Qp(t.shape);l[2]=1;var h=mr(l);t=_i([t,h],2)}return r=o?_i([r,i],3):r,t=bn(r,t),t=Pr(t),t}var Lj=(function(n){an(e,n);function e(){return n.call(this,"FaceRecognitionNet")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return At(function(){var i=t.toBatchTensor(150,!0).toFloat(),o=[122.782,117.001,104.298],s=jm(i,o).div(wt(256)),a=iT(s,r.conv32_down);a=Ui(a,3,2,"valid"),a=zu(a,r.conv32_1),a=zu(a,r.conv32_2),a=zu(a,r.conv32_3),a=Xg(a,r.conv64_down),a=zu(a,r.conv64_1),a=zu(a,r.conv64_2),a=zu(a,r.conv64_3),a=Xg(a,r.conv128_down),a=zu(a,r.conv128_1),a=zu(a,r.conv128_2),a=Xg(a,r.conv256_down),a=zu(a,r.conv256_1),a=zu(a,r.conv256_2),a=Xg(a,r.conv256_down_out);var u=a.mean([1,2]),l=N0(u,r.fc);return l})},e.prototype.forward=function(t){return Ot(this,void 0,void 0,function(){var r;return Bt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Hi(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.computeFaceDescriptor=function(t){return Ot(this,void 0,void 0,function(){var r,i,o,s=this;return Bt(this,function(a){switch(a.label){case 0:return[4,Hi(t)];case 1:return r=a.sent(),i=At(function(){return Ei(s.forwardInput(r))}),[4,Promise.all(i.map(function(u){return u.data()}))];case 2:return o=a.sent(),i.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(t){return Dj(t)},e.prototype.extractParams=function(t){return Pj(t)},e})(ec);function oT(n,e){var t={descriptor:e};return Object.assign({},n,t)}function sT(n,e){var t={age:e};return Object.assign({},n,t)}function aT(n,e,t){var r={gender:e,genderProbability:t};return Object.assign({},n,r)}var uT=(function(){function n(e){var t=e===void 0?{}:e,r=t.minFaceSize,i=t.scaleFactor,o=t.maxNumScales,s=t.scoreThresholds,a=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=i||.709,this._maxNumScales=o||10,this._scoreThresholds=s||[.6,.7,.7],this._scaleSteps=a,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(n.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),n})();function Mj(n,e){function t(u,l){var h=Ss(n(9*u),[3,3,u,1]),d=ai(n(u)),p=ai(n(u)),m=ai(n(u)),w=ai(n(u));return e.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:h,batch_norm_scale:d,batch_norm_offset:p,batch_norm_mean:m,batch_norm_variance:w}}function r(u,l,h,d,p){var m=Ss(n(u*l*h*h),[h,h,u,l]),w=ai(n(l));return e.push({paramPath:d+"/filters"},{paramPath:d+"/"+(p?"batch_norm_offset":"bias")}),{filters:m,bias:w}}function i(u,l,h,d){var p=r(u,l,h,d,!0),m=p.filters,w=p.bias;return{filters:m,batch_norm_offset:w}}function o(u,l,h){var d=t(u,h+"/depthwise_conv"),p=i(u,l,1,h+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:p}}function s(){var u=i(3,32,3,"mobilenetv1/conv_0"),l=o(32,64,"mobilenetv1/conv_1"),h=o(64,128,"mobilenetv1/conv_2"),d=o(128,128,"mobilenetv1/conv_3"),p=o(128,256,"mobilenetv1/conv_4"),m=o(256,256,"mobilenetv1/conv_5"),w=o(256,512,"mobilenetv1/conv_6"),b=o(512,512,"mobilenetv1/conv_7"),x=o(512,512,"mobilenetv1/conv_8"),E=o(512,512,"mobilenetv1/conv_9"),A=o(512,512,"mobilenetv1/conv_10"),N=o(512,512,"mobilenetv1/conv_11"),F=o(512,1024,"mobilenetv1/conv_12"),D=o(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:h,conv_3:d,conv_4:p,conv_5:m,conv_6:w,conv_7:b,conv_8:x,conv_9:E,conv_10:A,conv_11:N,conv_12:F,conv_13:D}}function a(){var u=i(1024,256,1,"prediction_layer/conv_0"),l=i(256,512,3,"prediction_layer/conv_1"),h=i(512,128,1,"prediction_layer/conv_2"),d=i(128,256,3,"prediction_layer/conv_3"),p=i(256,128,1,"prediction_layer/conv_4"),m=i(128,256,3,"prediction_layer/conv_5"),w=i(256,64,1,"prediction_layer/conv_6"),b=i(64,128,3,"prediction_layer/conv_7"),x=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),E=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),A=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),N=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),F=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),D=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),W=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),k=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),C=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),L=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),B=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),R=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),M={box_encoding_predictor:x,class_predictor:E},U={box_encoding_predictor:A,class_predictor:N},J={box_encoding_predictor:F,class_predictor:D},de={box_encoding_predictor:W,class_predictor:k},fe={box_encoding_predictor:C,class_predictor:L},he={box_encoding_predictor:B,class_predictor:R};return{conv_0:u,conv_1:l,conv_2:h,conv_3:d,conv_4:p,conv_5:m,conv_6:w,conv_7:b,box_predictor_0:M,box_predictor_1:U,box_predictor_2:J,box_predictor_3:de,box_predictor_4:fe,box_predictor_5:he}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:a}}function Fj(n){var e=[],t=nc(n),r=t.extractWeights,i=t.getRemainingWeights,o=Mj(r,e),s=o.extractMobilenetV1Params,a=o.extractPredictionLayerParams,u=s(),l=a(),h=db(r(5118*4),[1,5118,4]),d={extra_dim:h};if(e.push({paramPath:"output_layer/extra_dim"}),i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:d},paramMappings:e}}function Oj(n,e){var t=Th(n,e);function r(l,h,d){var p=t(l+"/Conv2d_"+h+"_pointwise/weights",4,d+"/filters"),m=t(l+"/Conv2d_"+h+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:p,batch_norm_offset:m}}function i(l){var h="mobilenetv1/conv_"+l,d="MobilenetV1/Conv2d_"+l+"_depthwise",p=h+"/depthwise_conv",m=h+"/pointwise_conv",w=t(d+"/depthwise_weights",4,p+"/filters"),b=t(d+"/BatchNorm/gamma",1,p+"/batch_norm_scale"),x=t(d+"/BatchNorm/beta",1,p+"/batch_norm_offset"),E=t(d+"/BatchNorm/moving_mean",1,p+"/batch_norm_mean"),A=t(d+"/BatchNorm/moving_variance",1,p+"/batch_norm_variance");return{depthwise_conv:{filters:w,batch_norm_scale:b,batch_norm_offset:x,batch_norm_mean:E,batch_norm_variance:A},pointwise_conv:r("MobilenetV1",l,m)}}function o(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:i(1),conv_2:i(2),conv_3:i(3),conv_4:i(4),conv_5:i(5),conv_6:i(6),conv_7:i(7),conv_8:i(8),conv_9:i(9),conv_10:i(10),conv_11:i(11),conv_12:i(12),conv_13:i(13)}}function s(l,h){var d=t(l+"/weights",4,h+"/filters"),p=t(l+"/biases",1,h+"/bias");return{filters:d,bias:p}}function a(l){var h=s("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),d=s("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:h,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:u}}function Bj(n){var e=[],t=Oj(n,e),r=t.extractMobilenetV1Params,i=t.extractPredictionLayerParams,o=n["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!L0(o))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+o);var s={mobilenetv1:r(),prediction_layer:i(),output_layer:{extra_dim:o}};return tc(n,e),{params:s,paramMappings:e}}function qu(n,e,t){return At(function(){var r=Da(n,e.filters,t,"same");return r=bn(r,e.batch_norm_offset),Sb(r,0,6)})}var Vj=.0010000000474974513;function jj(n,e,t){return At(function(){var r=k0(n,e.filters,t,"same");return r=eI(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,Vj),Sb(r,0,6)})}function Uj(n){return[2,4,6,12].some(function(e){return e===n})?[2,2]:[1,1]}function zj(n,e){return At(function(){var t=null,r=qu(n,e.conv_0,[2,2]),i=[e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13];if(i.forEach(function(o,s){var a=s+1,u=Uj(a);r=jj(r,o.depthwise_conv,u),r=qu(r,o.pointwise_conv,[1,1]),a===11&&(t=r)}),t===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:t}})}function Wj(n,e,t,r,i){var o=n.shape[0],s=Math.min(t,o),a=e.map(function(h,d){return{score:h,boxIndex:d}}).filter(function(h){return h.score>i}).sort(function(h,d){return d.score-h.score}),u=function(h){return h<=r?1:0},l=[];return a.forEach(function(h){if(!(l.length>=s)){for(var d=h.score,p=l.length-1;p>=0;--p){var m=qj(n,h.boxIndex,l[p]);if(m!==0&&(h.score*=u(m),h.score<=i))break}d===h.score&&l.push(h.boxIndex)}}),l}function qj(n,e,t){var r=n.arraySync(),i=Math.min(r[e][0],r[e][2]),o=Math.min(r[e][1],r[e][3]),s=Math.max(r[e][0],r[e][2]),a=Math.max(r[e][1],r[e][3]),u=Math.min(r[t][0],r[t][2]),l=Math.min(r[t][1],r[t][3]),h=Math.max(r[t][0],r[t][2]),d=Math.max(r[t][1],r[t][3]),p=(s-i)*(a-o),m=(h-u)*(d-l);if(p<=0||m<=0)return 0;var w=Math.max(i,u),b=Math.max(o,l),x=Math.min(s,h),E=Math.min(a,d),A=Math.max(x-w,0)*Math.max(E-b,0);return A/(p+m-A)}function Hj(n){var e=Ei(dh(n,[1,0])),t=[Ci(e[2],e[0]),Ci(e[3],e[1])],r=[bn(e[0],hu(t[0],wt(2))),bn(e[1],hu(t[1],wt(2)))];return{sizes:t,centers:r}}function Gj(n,e){var t=Hj(n),r=t.sizes,i=t.centers,o=Ei(dh(e,[1,0])),s=hu(jo(M2(hu(o[2],wt(5))),r[0]),wt(2)),a=bn(jo(hu(o[0],wt(10)),r[0]),i[0]),u=hu(jo(M2(hu(o[3],wt(5))),r[1]),wt(2)),l=bn(jo(hu(o[1],wt(10)),r[1]),i[1]);return dh(na([Ci(a,s),Ci(l,u),bn(a,s),bn(l,u)]),[1,0])}function $j(n,e,t){return At(function(){var r=n.shape[0],i=Gj(du(_d(t.extra_dim,[r,1,1]),[-1,4]),du(n,[-1,4]));i=du(i,[r,i.shape[0]/r,4]);var o=Y3(ul(e,[0,0,1],[-1,-1,-1])),s=ul(o,[0,0,0],[-1,-1,1]);s=du(s,[r,s.shape[1]]);var a=Ei(i),u=Ei(s);return{boxes:a,scores:u}})}function td(n,e){return At(function(){var t=n.shape[0],r=du(mu(n,e.box_encoding_predictor),[t,-1,1,4]),i=du(mu(n,e.class_predictor),[t,-1,3]);return{boxPredictionEncoding:r,classPrediction:i}})}function Kj(n,e,t){return At(function(){var r=qu(n,t.conv_0,[1,1]),i=qu(r,t.conv_1,[2,2]),o=qu(i,t.conv_2,[1,1]),s=qu(o,t.conv_3,[2,2]),a=qu(s,t.conv_4,[1,1]),u=qu(a,t.conv_5,[2,2]),l=qu(u,t.conv_6,[1,1]),h=qu(l,t.conv_7,[2,2]),d=td(e,t.box_predictor_0),p=td(n,t.box_predictor_1),m=td(i,t.box_predictor_2),w=td(s,t.box_predictor_3),b=td(u,t.box_predictor_4),x=td(h,t.box_predictor_5),E=_i([d.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding,w.boxPredictionEncoding,b.boxPredictionEncoding,x.boxPredictionEncoding],1),A=_i([d.classPrediction,p.classPrediction,m.classPrediction,w.classPrediction,b.classPrediction,x.classPrediction],1);return{boxPredictions:E,classPredictions:A}})}var Um=(function(){function n(e){var t=e===void 0?{}:e,r=t.minConfidence,i=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=i||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(n.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),n})(),lT=(function(n){an(e,n);function e(){return n.call(this,"SsdMobilenetv1")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return At(function(){var i=t.toBatchTensor(512,!1).toFloat(),o=Ci(jo(i,wt(.007843137718737125)),wt(1)),s=zj(o,r.mobilenetv1),a=Kj(s.out,s.conv11,r.prediction_layer),u=a.boxPredictions,l=a.classPredictions;return $j(u,l,r.output_layer)})},e.prototype.forward=function(t){return Ot(this,void 0,void 0,function(){var r;return Bt(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Hi(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.locateFaces=function(t,r){return r===void 0&&(r={}),Ot(this,void 0,void 0,function(){var i,o,s,a,u,l,h,d,p,m,w,b,x,E,A,N,F,D,W,k,C;return Bt(this,function(L){switch(L.label){case 0:return i=new Um(r),o=i.maxResults,s=i.minConfidence,[4,Hi(t)];case 1:for(a=L.sent(),u=this.forwardInput(a),l=u.boxes,h=u.scores,d=l[0],p=h[0],m=1;m<l.length;m++)l[m].dispose(),h[m].dispose();return x=(b=Array).from,[4,p.data()];case 2:return w=x.apply(b,[L.sent()]),E=.5,A=Wj(d,w,o,E,s),N=a.getReshapedInputDimensions(0),F=a.inputSize,D=F/N.width,W=F/N.height,k=d.arraySync(),C=A.map(function(B){var R=[Math.max(0,k[B][0]),Math.min(1,k[B][2])].map(function(he){return he*W}),M=R[0],U=R[1],J=[Math.max(0,k[B][1]),Math.min(1,k[B][3])].map(function(he){return he*D}),de=J[0],fe=J[1];return new bu(w[B],new Ub(de,M,fe-de,U-M),{height:a.getInputHeight(0),width:a.getInputWidth(0)})}),d.dispose(),p.dispose(),[2,C]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(t){return Bj(t)},e.prototype.extractParams=function(t){return Fj(t)},e})(ec);(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(lT);var Xj=.4,Yj=[new Hn(.738768,.874946),new Hn(2.42204,2.65704),new Hn(4.30971,7.04493),new Hn(10.246,4.59428),new Hn(12.6868,11.8741)],Jj=[new Hn(1.603231,2.094468),new Hn(6.041143,7.080126),new Hn(2.882459,3.518061),new Hn(4.266906,5.178857),new Hn(9.041765,10.66308)],Qj=[117.001,114.697,97.404],Zj="tiny_yolov2_model",e9="tiny_yolov2_separable_conv_model",Yg=function(n){return typeof n=="number"};function t9(n){if(!n)throw new Error("invalid config: "+n);if(typeof n.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+n.withSeparableConvs);if(!Yg(n.iouThreshold)||n.iouThreshold<0||n.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+n.iouThreshold);if(!Array.isArray(n.classes)||!n.classes.length||!n.classes.every(function(e){return typeof e=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(n.classes));if(!Array.isArray(n.anchors)||!n.anchors.length||!n.anchors.map(function(e){return e||{}}).every(function(e){return Yg(e.x)&&Yg(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(n.anchors));if(n.meanRgb&&(!Array.isArray(n.meanRgb)||n.meanRgb.length!==3||!n.meanRgb.every(Yg)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(n.meanRgb))}function Yb(n){return At(function(){var e=jo(n,wt(.10000000149011612));return bn(Pr(Ci(n,e)),e)})}function jc(n,e){return At(function(){var t=Sf(n,[[0,0],[1,1],[1,1],[0,0]]);return t=Da(t,e.conv.filters,[1,1],"valid"),t=Ci(t,e.bn.sub),t=jo(t,e.bn.truediv),t=bn(t,e.conv.bias),Yb(t)})}function Uc(n,e){return At(function(){var t=Sf(n,[[0,0],[1,1],[1,1],[0,0]]);return t=Tb(t,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),t=bn(t,e.bias),Yb(t)})}function n9(n,e){var t=O0(n,e);function r(s,a){var u=ai(n(s)),l=ai(n(s));return e.push({paramPath:a+"/sub"},{paramPath:a+"/truediv"}),{sub:u,truediv:l}}function i(s,a,u){var l=t(s,a,3,u+"/conv"),h=r(a,u+"/bn");return{conv:l,bn:h}}var o=$b(n,e);return{extractConvParams:t,extractConvWithBatchNormParams:i,extractSeparableConvParams:o}}function r9(n,e,t,r){var i=nc(n),o=i.extractWeights,s=i.getRemainingWeights,a=[],u=n9(o,a),l=u.extractConvParams,h=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,p;if(e.withSeparableConvs){var m=r[0],w=r[1],b=r[2],x=r[3],E=r[4],A=r[5],N=r[6],F=r[7],D=r[8],W=e.isFirstLayerConv2d?l(m,w,3,"conv0"):d(m,w,"conv0"),k=d(w,b,"conv1"),C=d(b,x,"conv2"),L=d(x,E,"conv3"),B=d(E,A,"conv4"),R=d(A,N,"conv5"),M=F?d(N,F,"conv6"):void 0,U=D?d(F,D,"conv7"):void 0,J=l(D||F||N,5*t,1,"conv8");p={conv0:W,conv1:k,conv2:C,conv3:L,conv4:B,conv5:R,conv6:M,conv7:U,conv8:J}}else{var m=r[0],w=r[1],b=r[2],x=r[3],E=r[4],A=r[5],N=r[6],F=r[7],D=r[8],W=h(m,w,"conv0"),k=h(w,b,"conv1"),C=h(b,x,"conv2"),L=h(x,E,"conv3"),B=h(E,A,"conv4"),R=h(A,N,"conv5"),M=h(N,F,"conv6"),U=h(F,D,"conv7"),J=l(D,5*t,1,"conv8");p={conv0:W,conv1:k,conv2:C,conv3:L,conv4:B,conv5:R,conv6:M,conv7:U,conv8:J}}if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{params:p,paramMappings:a}}function i9(n,e){var t=Th(n,e);function r(a){var u=t(a+"/sub",1),l=t(a+"/truediv",1);return{sub:u,truediv:l}}function i(a){var u=t(a+"/filters",4),l=t(a+"/bias",1);return{filters:u,bias:l}}function o(a){var u=i(a+"/conv"),l=r(a+"/bn");return{conv:u,bn:l}}var s=Kb(t);return{extractConvParams:i,extractConvWithBatchNormParams:o,extractSeparableConvParams:s}}function o9(n,e){var t=[],r=i9(n,t),i=r.extractConvParams,o=r.extractConvWithBatchNormParams,s=r.extractSeparableConvParams,a;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;a={conv0:e.isFirstLayerConv2d?i("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:i("conv8")}}else a={conv0:o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:o("conv6"),conv7:o("conv7"),conv8:i("conv8")};return tc(n,t),{params:a,paramMappings:t}}var _S;(function(n){n[n.XS=224]="XS",n[n.SM=320]="SM",n[n.MD=416]="MD",n[n.LG=608]="LG"})(_S||(_S={}));var Jb=(function(){function n(e){var t=e===void 0?{}:e,r=t.inputSize,i=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=i||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),n})(),cT=(function(n){an(e,n);function e(t){var r=n.call(this,"TinyYolov2")||this;return t9(t),r._config=t,r}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(t,r){var i=jc(t,r.conv0);return i=Ui(i,[2,2],[2,2],"same"),i=jc(i,r.conv1),i=Ui(i,[2,2],[2,2],"same"),i=jc(i,r.conv2),i=Ui(i,[2,2],[2,2],"same"),i=jc(i,r.conv3),i=Ui(i,[2,2],[2,2],"same"),i=jc(i,r.conv4),i=Ui(i,[2,2],[2,2],"same"),i=jc(i,r.conv5),i=Ui(i,[2,2],[1,1],"same"),i=jc(i,r.conv6),i=jc(i,r.conv7),mu(i,r.conv8,"valid",!1)},e.prototype.runMobilenet=function(t,r){var i=this.config.isFirstLayerConv2d?Yb(mu(t,r.conv0,"valid",!1)):Uc(t,r.conv0);return i=Ui(i,[2,2],[2,2],"same"),i=Uc(i,r.conv1),i=Ui(i,[2,2],[2,2],"same"),i=Uc(i,r.conv2),i=Ui(i,[2,2],[2,2],"same"),i=Uc(i,r.conv3),i=Ui(i,[2,2],[2,2],"same"),i=Uc(i,r.conv4),i=Ui(i,[2,2],[2,2],"same"),i=Uc(i,r.conv5),i=Ui(i,[2,2],[1,1],"same"),i=r.conv6?Uc(i,r.conv6):i,i=r.conv7?Uc(i,r.conv7):i,mu(i,r.conv8,"valid",!1)},e.prototype.forwardInput=function(t,r){var i=this,o=this.params;if(!o)throw new Error("TinyYolov2 - load model before inference");return At(function(){var s=t.toBatchTensor(r,!1).toFloat();return s=i.config.meanRgb?jm(s,i.config.meanRgb):s,s=s.div(wt(256)),i.config.withSeparableConvs?i.runMobilenet(s,o):i.runTinyYolov2(s,o)})},e.prototype.forward=function(t,r){return Ot(this,void 0,void 0,function(){var i;return Bt(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,Hi(t)];case 1:return[4,i.apply(this,[o.sent(),r])];case 2:return[2,o.sent()]}})})},e.prototype.detect=function(t,r){return r===void 0&&(r={}),Ot(this,void 0,void 0,function(){var i,o,s,a,u,l,h,d,p,m,w,b,x,E,A=this;return Bt(this,function(N){switch(N.label){case 0:return i=new Jb(r),o=i.inputSize,s=i.scoreThreshold,[4,Hi(t)];case 1:return a=N.sent(),[4,this.forwardInput(a,o)];case 2:return u=N.sent(),l=At(function(){return Ei(u)[0].expandDims()}),h={width:a.getInputWidth(0),height:a.getInputHeight(0)},[4,this.extractBoxes(l,a.getReshapedInputDimensions(0),s)];case 3:return d=N.sent(),u.dispose(),l.dispose(),p=d.map(function(F){return F.box}),m=d.map(function(F){return F.score}),w=d.map(function(F){return F.classScore}),b=d.map(function(F){return A.config.classes[F.label]}),x=vm(p.map(function(F){return F.rescale(o)}),m,this.config.iouThreshold,!0),E=x.map(function(F){return new LI(m[F],w[F],b[F],p[F],h)}),[2,E]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(t){return o9(t,this.config)},e.prototype.extractParams=function(t){var r=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,i=r?r.length:void 0;if(i!==7&&i!==8&&i!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+i+" filterSizes in config");return r9(t,this.config,this.boxEncodingSize,r)},e.prototype.extractBoxes=function(t,r,i){return Ot(this,void 0,void 0,function(){var o,s,a,u,l,h,d,p,m,w,b,x,E,A,N,F,D,W,k,C,L,B,R,M,U,J,de,fe,he,K=this;return Bt(this,function(le){switch(le.label){case 0:return o=r.width,s=r.height,a=Math.max(o,s),u=a/o,l=a/s,h=t.shape[1],d=this.config.anchors.length,p=At(function(){var se=t.reshape([h,h,d,K.boxEncodingSize]),re=se.slice([0,0,0,0],[h,h,d,4]),j=se.slice([0,0,0,4],[h,h,d,1]),$=K.withClassScores?Ql(se.slice([0,0,0,5],[h,h,d,K.config.classes.length]),3):wt(0);return[re,j,$]}),m=p[0],w=p[1],b=p[2],x=[],[4,w.array()];case 1:return E=le.sent(),[4,m.array()];case 2:A=le.sent(),N=0,le.label=3;case 3:if(!(N<h))return[3,12];F=0,le.label=4;case 4:if(!(F<h))return[3,11];D=0,le.label=5;case 5:return D<d?(W=Ly(E[N][F][D][0]),!i||W>i?(k=(F+Ly(A[N][F][D][0]))/h*u,C=(N+Ly(A[N][F][D][1]))/h*l,L=Math.exp(A[N][F][D][2])*this.config.anchors[D].x/h*u,B=Math.exp(A[N][F][D][3])*this.config.anchors[D].y/h*l,R=k-L/2,M=C-B/2,U={row:N,col:F,anchor:D},this.withClassScores?[4,this.extractPredictedClass(b,U)]:[3,7]):[3,9]):[3,10];case 6:return he=le.sent(),[3,8];case 7:he={classScore:1,label:0},le.label=8;case 8:J=he,de=J.classScore,fe=J.label,x.push(Lo({box:new M0(R,M,R+L,M+B),score:W,classScore:W*de,label:fe},U)),le.label=9;case 9:return D++,[3,5];case 10:return F++,[3,4];case 11:return N++,[3,3];case 12:return m.dispose(),w.dispose(),b.dispose(),[2,x]}})})},e.prototype.extractPredictedClass=function(t,r){return Ot(this,void 0,void 0,function(){var i,o,s,a;return Bt(this,function(u){switch(u.label){case 0:return i=r.row,o=r.col,s=r.anchor,[4,t.array()];case 1:return a=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,h){return a[i][o][s][h]}).map(function(l,h){return{classScore:l,label:h}}).reduce(function(l,h){return l.classScore>h.classScore?l:h})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e})(ec),s9=(function(n){an(e,n);function e(t){t===void 0&&(t=!0);var r=this,i=Object.assign({},{withSeparableConvs:t,iouThreshold:Xj,classes:["face"]},t?{anchors:Jj,meanRgb:Qj}:{anchors:Yj,withClassScores:!0});return r=n.call(this,i)||this,r}return Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,r){return Ot(this,void 0,void 0,function(){var i;return Bt(this,function(o){switch(o.label){case 0:return[4,this.detect(t,r)];case 1:return i=o.sent(),[2,i.map(function(s){return new bu(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?e9:Zj},e.prototype.extractParamsFromWeigthMap=function(t){return n.prototype.extractParamsFromWeigthMap.call(this,t)},e})(cT),hT=(function(n){an(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return e})(Jb),zm=(function(){function n(){}return n.prototype.then=function(e){return Ot(this,void 0,void 0,function(){var t;return Bt(this,function(r){switch(r.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[r.sent()])]}})})},n.prototype.run=function(){return Ot(this,void 0,void 0,function(){return Bt(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},n})();function V0(n,e,t,r,i){return i===void 0&&(i=function(o){var s=o.alignedRect;return s}),Ot(this,void 0,void 0,function(){var o,s,a,u,l;return Bt(this,function(h){switch(h.label){case 0:return o=n.map(function(d){return ZI(d)?i(d):d.detection}),a=r,a?[3,5]:e instanceof Tr?[4,Hb(e,o)]:[3,2];case 1:return u=h.sent(),[3,4];case 2:return[4,qb(e,o)];case 3:u=h.sent(),h.label=4;case 4:a=u,h.label=5;case 5:return s=a,[4,t(s)];case 6:return l=h.sent(),s.forEach(function(d){return d instanceof Tr&&d.dispose()}),[2,l]}})})}function Qb(n,e,t,r,i){return Ot(this,void 0,void 0,function(){var o=this;return Bt(this,function(s){return[2,V0([n],e,function(a){return Ot(o,void 0,void 0,function(){return Bt(this,function(u){return[2,t(a[0])]})})},r,i)]})})}function a9(n){return At(function(){return na(Ei(n,3).reverse(),3)})}var Jg=2,e0=12;function u9(n,e){var t=O0(n,e),r=Gb(n,e);function i(l,h){var d=ai(n(l));return e.push({paramPath:h}),d}function o(l,h,d){d===void 0&&(d=!1);var p=t(l[0],l[1],3,h+"/conv1"),m=i(l[1],h+"/prelu1_alpha"),w=t(l[1],l[2],3,h+"/conv2"),b=i(l[2],h+"/prelu2_alpha"),x=t(l[2],l[3],d?2:3,h+"/conv3"),E=i(l[3],h+"/prelu3_alpha");return{conv1:p,prelu1_alpha:m,conv2:w,prelu2_alpha:b,conv3:x,prelu3_alpha:E}}function s(){var l=o([3,10,16,32],"pnet"),h=t(32,2,1,"pnet/conv4_1"),d=t(32,4,1,"pnet/conv4_2");return Lo(Lo({},l),{conv4_1:h,conv4_2:d})}function a(){var l=o([3,28,48,64],"rnet",!0),h=r(576,128,"rnet/fc1"),d=i(128,"rnet/prelu4_alpha"),p=r(128,2,"rnet/fc2_1"),m=r(128,4,"rnet/fc2_2");return Lo(Lo({},l),{fc1:h,prelu4_alpha:d,fc2_1:p,fc2_2:m})}function u(){var l=o([3,32,64,64],"onet"),h=t(64,128,2,"onet/conv4"),d=i(128,"onet/prelu4_alpha"),p=r(1152,256,"onet/fc1"),m=i(256,"onet/prelu5_alpha"),w=r(256,2,"onet/fc2_1"),b=r(256,4,"onet/fc2_2"),x=r(256,10,"onet/fc2_3");return Lo(Lo({},l),{conv4:h,prelu4_alpha:d,fc1:p,prelu5_alpha:m,fc2_1:w,fc2_2:b,fc2_3:x})}return{extractPNetParams:s,extractRNetParams:a,extractONetParams:u}}function l9(n){var e=nc(n),t=e.extractWeights,r=e.getRemainingWeights,i=[],o=u9(t,i),s=o.extractPNetParams,a=o.extractRNetParams,u=o.extractONetParams,l=s(),h=a(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:h,onet:d},paramMappings:i}}function c9(n,e){var t=Th(n,e);function r(h){var d=t(h+"/weights",4,h+"/filters"),p=t(h+"/bias",1);return{filters:d,bias:p}}function i(h){var d=t(h+"/weights",2),p=t(h+"/bias",1);return{weights:d,bias:p}}function o(h){return t(h,1)}function s(h){var d=r(h+"/conv1"),p=o(h+"/prelu1_alpha"),m=r(h+"/conv2"),w=o(h+"/prelu2_alpha"),b=r(h+"/conv3"),x=o(h+"/prelu3_alpha");return{conv1:d,prelu1_alpha:p,conv2:m,prelu2_alpha:w,conv3:b,prelu3_alpha:x}}function a(){var h=s("pnet"),d=r("pnet/conv4_1"),p=r("pnet/conv4_2");return Lo(Lo({},h),{conv4_1:d,conv4_2:p})}function u(){var h=s("rnet"),d=i("rnet/fc1"),p=o("rnet/prelu4_alpha"),m=i("rnet/fc2_1"),w=i("rnet/fc2_2");return Lo(Lo({},h),{fc1:d,prelu4_alpha:p,fc2_1:m,fc2_2:w})}function l(){var h=s("onet"),d=r("onet/conv4"),p=o("onet/prelu4_alpha"),m=i("onet/fc1"),w=o("onet/prelu5_alpha"),b=i("onet/fc2_1"),x=i("onet/fc2_2"),E=i("onet/fc2_3");return Lo(Lo({},h),{conv4:d,prelu4_alpha:p,fc1:m,prelu5_alpha:w,fc2_1:b,fc2_2:x,fc2_3:E})}return{extractPNetParams:a,extractRNetParams:u,extractONetParams:l}}function h9(n){var e=[],t=c9(n,e),r=t.extractPNetParams,i=t.extractRNetParams,o=t.extractONetParams,s=r(),a=i(),u=o();return tc(n,e),{params:{pnet:s,rnet:a,onet:u},paramMappings:e}}function W2(n,e){var t=e[0],r=e[1];return{height:Math.floor(t*n),width:Math.floor(r*n)}}function f9(n,e,t){for(var r=t[0],i=t[1],o=e0/n,s=[],a=Math.min(r,i)*o,u=0;a>=12;)s.push(o*Math.pow(e,u)),a=a*e,u+=1;return s}var Zb=(function(n){an(e,n);function e(t,r,i,o){return n.call(this,{left:t,top:r,right:i,bottom:o},!0)||this}return e})(ph);function fT(n){return At(function(){return jo(Ci(n,wt(127.5)),wt(.0078125))})}function Id(n,e){return At(function(){return bn(Pr(n),jo(e,Kv(Pr(Kv(n)))))})}function ex(n,e,t){return t===void 0&&(t=!1),At(function(){var r=mu(n,e.conv1,"valid");return r=Id(r,e.prelu1_alpha),r=Ui(r,t?[2,2]:[3,3],[2,2],"same"),r=mu(r,e.conv2,"valid"),r=Id(r,e.prelu2_alpha),r=t?r:Ui(r,[3,3],[2,2],"valid"),r=mu(r,e.conv3,"valid"),r=Id(r,e.prelu3_alpha),r})}function d9(n,e){return At(function(){var t=ex(n,e,!0),r=mu(t,e.conv4_1,"valid"),i=Na(P0(r,3),3),o=Ql(Ci(r,i),3),s=mu(t,e.conv4_2,"valid");return{prob:o,regions:s}})}function p9(n,e){return At(function(){var t=W2(e,n.shape.slice(1)),r=t.height,i=t.width,o=Db.resizeBilinear(n,[r,i]),s=fT(o);return dh(s,[0,2,1,3])})}function m9(n,e,t,r){for(var i=[],o=n.arraySync(),s=0;s<n.shape[0];s++)for(var a=0;a<n.shape[1];a++)o[s][a]>=r&&i.push(new Hn(a,s));var u=i.map(function(l){var h=new M0(Math.round((l.y*Jg+1)/t),Math.round((l.x*Jg+1)/t),Math.round((l.y*Jg+e0)/t),Math.round((l.x*Jg+e0)/t)),d=o[l.y][l.x],p=e.arraySync(),m=new Zb(p[l.y][l.x][0],p[l.y][l.x][1],p[l.y][l.x][2],p[l.y][l.x][3]);return{cell:h,score:d,region:m}});return u}function g9(n,e,t,r,i){i.stage1=[];var o=e.map(function(p){return At(function(){var m={scale:p},w=p9(n,p),b=Date.now(),x=d9(w,r),E=x.prob,A=x.regions;m.pnet=Date.now()-b;var N=Ei(Ei(E,3)[1])[0],F=Ei(A)[0];return{scoresTensor:N,regionsTensor:F,scale:p,statsForScale:m}})}),s=o.map(function(p){var m=p.scoresTensor,w=p.regionsTensor,b=p.scale,x=p.statsForScale,E=m9(m,w,b,t);if(m.dispose(),w.dispose(),!E.length)return i.stage1.push(x),[];var A=Date.now(),N=vm(E.map(function(F){return F.cell}),E.map(function(F){return F.score}),.5);return x.nms=Date.now()-A,x.numBoxes=N.length,i.stage1.push(x),N.map(function(F){return E[F]})}),a=s.reduce(function(p,m){return p.concat(m)},[]),u=[],l=[];if(a.length>0){var h=Date.now(),d=vm(a.map(function(p){return p.cell}),a.map(function(p){return p.score}),.7);i.stage1_nms=Date.now()-h,l=d.map(function(p){return a[p].score}),u=d.map(function(p){return a[p]}).map(function(p){var m=p.cell,w=p.region;return new M0(m.left+w.left*m.width,m.top+w.top*m.height,m.right+w.right*m.width,m.bottom+w.bottom*m.height).toSquare().round()})}return{boxes:u,scores:l}}function dT(n,e,t){var r=t.width,i=t.height;return Ot(this,void 0,void 0,function(){var o,s,a,u=this;return Bt(this,function(l){switch(l.label){case 0:return o=vf(n),[4,Promise.all(e.map(function(h){return Ot(u,void 0,void 0,function(){var d,p,m,w,b,x,E,A;return Bt(this,function(N){return d=h.padAtBorders(n.height,n.width),p=d.y,m=d.ey,w=d.x,b=d.ex,x=w-1,E=p-1,A=o.getImageData(x,E,b-x,m-E),[2,lo.isNodejs()?Wb(A):createImageBitmap(A)]})})}))];case 1:return s=l.sent(),a=[],s.forEach(function(h){var d=F0({width:r,height:i}),p=vf(d);p.drawImage(h,0,0,r,i);for(var m=p.getImageData(0,0,r,i).data,w=[],b=0;b<m.length;b+=4)w.push(m[b+2]),w.push(m[b+1]),w.push(m[b]);a.push(w)}),[2,a.map(function(h){var d=At(function(){var p=dh(Ss(h,[1,r,i,3]),[0,2,1,3]).toFloat();return fT(p)});return d})]}})})}function v9(n,e){return At(function(){var t=ex(n,e),r=du(t,[t.shape[0],e.fc1.weights.shape[0]]),i=Ju(r,e.fc1),o=Id(i,e.prelu4_alpha),s=Ju(o,e.fc2_1),a=Na(P0(s,1),1),u=Ql(Ci(s,a),1),l=Ju(o,e.fc2_2),h=Ei(u,1)[1];return{scores:h,regions:l}})}function y9(n,e,t,r,i){return Ot(this,void 0,void 0,function(){var o,s,a,u,l,h,d,p,m,w,b,x,E,A;return Bt(this,function(N){switch(N.label){case 0:return o=Date.now(),[4,dT(n,e,{width:24,height:24})];case 1:return s=N.sent(),i.stage2_extractImagePatches=Date.now()-o,o=Date.now(),a=s.map(function(F){var D=v9(F,r);return F.dispose(),D}),i.stage2_rnet=Date.now()-o,u=a.length>1?_i(a.map(function(F){return F.scores})):a[0].scores,d=(h=Array).from,[4,u.data()];case 2:return l=d.apply(h,[N.sent()]),u.dispose(),p=l.map(function(F,D){return{score:F,idx:D}}).filter(function(F){return F.score>t}).map(function(F){var D=F.idx;return D}),m=p.map(function(F){return e[F]}),w=p.map(function(F){return l[F]}),b=[],x=[],m.length>0&&(o=Date.now(),E=vm(m,w,.7),i.stage2_nms=Date.now()-o,A=E.map(function(F){var D=a[p[F]].regions.arraySync();return new Zb(D[0][0],D[0][1],D[0][2],D[0][3])}),x=E.map(function(F){return w[F]}),b=E.map(function(F,D){return m[F].calibrate(A[D])})),a.forEach(function(F){F.regions.dispose(),F.scores.dispose()}),[2,{boxes:b,scores:x}]}})})}function w9(n,e){return At(function(){var t=ex(n,e);t=Ui(t,[2,2],[2,2],"same"),t=mu(t,e.conv4,"valid"),t=Id(t,e.prelu4_alpha);var r=du(t,[t.shape[0],e.fc1.weights.shape[0]]),i=Ju(r,e.fc1),o=Id(i,e.prelu5_alpha),s=Ju(o,e.fc2_1),a=Na(P0(s,1),1),u=Ql(Ci(s,a),1),l=Ju(o,e.fc2_2),h=Ju(o,e.fc2_3),d=Ei(u,1)[1];return{scores:d,regions:l,points:h}})}function b9(n,e,t,r,i){return Ot(this,void 0,void 0,function(){var o,s,a,u,l,h,d,p,m,w,b,x,E,A,N;return Bt(this,function(F){switch(F.label){case 0:return o=Date.now(),[4,dT(n,e,{width:48,height:48})];case 1:return s=F.sent(),i.stage3_extractImagePatches=Date.now()-o,o=Date.now(),a=s.map(function(D){var W=w9(D,r);return D.dispose(),W}),i.stage3_onet=Date.now()-o,u=a.length>1?_i(a.map(function(D){return D.scores})):a[0].scores,d=(h=Array).from,[4,u.data()];case 2:return l=d.apply(h,[F.sent()]),u.dispose(),p=l.map(function(D,W){return{score:D,idx:W}}).filter(function(D){return D.score>t}).map(function(D){var W=D.idx;return W}),m=p.map(function(D){var W=a[D].regions.arraySync();return new Zb(W[0][0],W[0][1],W[0][2],W[0][3])}),w=p.map(function(D,W){return e[D].calibrate(m[W])}),b=p.map(function(D){return l[D]}),x=[],E=[],A=[],w.length>0&&(o=Date.now(),N=vm(w,b,.7,!1),i.stage3_nms=Date.now()-o,x=N.map(function(D){return w[D]}),E=N.map(function(D){return b[D]}),A=N.map(function(D,W){return Array(5).fill(0).map(function(k,C){var L=a[D].points.arraySync();return new Hn(L[0][C]*(x[W].width+1)+x[W].left,L[0][C+5]*(x[W].height+1)+x[W].top)})})),a.forEach(function(D){D.regions.dispose(),D.scores.dispose(),D.points.dispose()}),[2,{boxes:x,scores:E,points:A}]}})})}var x9=(function(n){an(e,n);function e(){return n.call(this,"Mtcnn")||this}return e.prototype.load=function(t){return Ot(this,void 0,void 0,function(){return Bt(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.load.call(this,t)]})})},e.prototype.loadFromDisk=function(t){return Ot(this,void 0,void 0,function(){return Bt(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.loadFromDisk.call(this,t)]})})},e.prototype.forwardInput=function(t,r){return r===void 0&&(r={}),Ot(this,void 0,void 0,function(){var i,o,s,a,u,l,h,d,p,m,w,b,x,E,A,N,F,D,W,k,C;return Bt(this,function(L){switch(L.label){case 0:if(i=this.params,!i)throw new Error("Mtcnn - load model before inference");if(o=t.canvases[0],!o)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return s={},a=Date.now(),u=At(function(){return a9(Na(Vb.fromPixels(o)).toFloat())}),l=function(B){return u.dispose(),s.total=Date.now()-a,B},h=u.shape.slice(1),d=h[0],p=h[1],m=new uT(r),w=m.minFaceSize,b=m.scaleFactor,x=m.maxNumScales,E=m.scoreThresholds,A=m.scaleSteps,N=(A||f9(w,b,[d,p])).filter(function(B){var R=W2(B,[d,p]);return Math.min(R.width,R.height)>e0}).slice(0,x),s.scales=N,s.pyramid=N.map(function(B){return W2(B,[d,p])}),F=Date.now(),[4,g9(u,N,E[0],i.pnet,s)];case 1:return D=L.sent(),s.total_stage1=Date.now()-F,D.boxes.length?(s.stage2_numInputBoxes=D.boxes.length,F=Date.now(),[4,y9(o,D.boxes,E[1],i.rnet,s)]):[2,l({results:[],stats:s})];case 2:return W=L.sent(),s.total_stage2=Date.now()-F,W.boxes.length?(s.stage3_numInputBoxes=W.boxes.length,F=Date.now(),[4,b9(o,W.boxes,E[2],i.onet,s)]):[2,l({results:[],stats:s})];case 3:return k=L.sent(),s.total_stage3=Date.now()-F,C=k.boxes.map(function(B,R){return B0(wm({},new bu(k.scores[R],new Ub(B.left/p,B.top/d,B.width/p,B.height/d),{height:d,width:p})),new QV(k.points[R].map(function(M){return M.sub(new Hn(B.left,B.top)).div(new Hn(B.width,B.height))}),{width:B.width,height:B.height}))}),[2,l({results:C,stats:s})]}})})},e.prototype.forward=function(t,r){return r===void 0&&(r={}),Ot(this,void 0,void 0,function(){var i;return Bt(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,Hi(t)];case 1:return[4,i.apply(this,[o.sent(),r])];case 2:return[2,o.sent().results]}})})},e.prototype.forwardWithStats=function(t,r){return r===void 0&&(r={}),Ot(this,void 0,void 0,function(){var i;return Bt(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,Hi(t)];case 1:return[2,i.apply(this,[o.sent(),r])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(t){return h9(t)},e.prototype.extractParams=function(t){return l9(t)},e})(ec),_9=.4,E9=[new Hn(1.603231,2.094468),new Hn(6.041143,7.080126),new Hn(2.882459,3.518061),new Hn(4.266906,5.178857),new Hn(9.041765,10.66308)],S9=[117.001,114.697,97.404],A9=(function(n){an(e,n);function e(){var t=this,r={withSeparableConvs:!0,iouThreshold:_9,classes:["face"],anchors:E9,meanRgb:S9,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return t=n.call(this,r)||this,t}return Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,r){return Ot(this,void 0,void 0,function(){var i;return Bt(this,function(o){switch(o.label){case 0:return[4,this.detect(t,r)];case 1:return i=o.sent(),[2,i.map(function(s){return new bu(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(t){return n.prototype.extractParamsFromWeigthMap.call(this,t)},e})(cT),ui={ssdMobilenetv1:new lT,tinyFaceDetector:new A9,tinyYolov2:new s9,mtcnn:new x9,faceLandmark68Net:new nT,faceLandmark68TinyNet:new Ij,faceRecognitionNet:new Lj,faceExpressionNet:new pj,ageGenderNet:new Ej},pT=(function(n){an(e,n);function e(t,r,i){var o=n.call(this)||this;return o.parentTask=t,o.input=r,o.extractedFaces=i,o}return e})(zm),tx=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Ot(this,void 0,void 0,function(){var t,r,i=this;return Bt(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return t=o.sent(),[4,V0(t,this.input,function(s){return Ot(i,void 0,void 0,function(){return Bt(this,function(a){switch(a.label){case 0:return[4,Promise.all(s.map(function(u){return ui.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,a.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,t.map(function(s,a){return QI(s,r[a])})]}})})},e.prototype.withAgeAndGender=function(){return new ox(this,this.input)},e})(pT),nx=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Ot(this,void 0,void 0,function(){var t,r;return Bt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),t?[4,Qb(t,this.input,function(o){return ui.faceExpressionNet.predictExpressions(o)},this.extractedFaces)]:[2];case 2:return r=i.sent(),[2,QI(t,r)]}})})},e.prototype.withAgeAndGender=function(){return new sx(this,this.input)},e})(pT),rx=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new ax(this,this.input)},e.prototype.withFaceDescriptors=function(){return new lx(this,this.input)},e})(tx),ix=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new ux(this,this.input)},e.prototype.withFaceDescriptor=function(){return new cx(this,this.input)},e})(nx),mT=(function(n){an(e,n);function e(t,r,i){var o=n.call(this)||this;return o.parentTask=t,o.input=r,o.extractedFaces=i,o}return e})(zm),ox=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Ot(this,void 0,void 0,function(){var t,r,i=this;return Bt(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return t=o.sent(),[4,V0(t,this.input,function(s){return Ot(i,void 0,void 0,function(){return Bt(this,function(a){switch(a.label){case 0:return[4,Promise.all(s.map(function(u){return ui.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,a.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,t.map(function(s,a){var u=r[a],l=u.age,h=u.gender,d=u.genderProbability;return sT(aT(s,h,d),l)})]}})})},e.prototype.withFaceExpressions=function(){return new tx(this,this.input)},e})(mT),sx=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Ot(this,void 0,void 0,function(){var t,r,i,o,s;return Bt(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),t?[4,Qb(t,this.input,function(u){return ui.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=a.sent(),i=r.age,o=r.gender,s=r.genderProbability,[2,sT(aT(t,o,s),i)]}})})},e.prototype.withFaceExpressions=function(){return new nx(this,this.input)},e})(mT),ax=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new rx(this,this.input)},e.prototype.withFaceDescriptors=function(){return new lx(this,this.input)},e})(ox),ux=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new ix(this,this.input)},e.prototype.withFaceDescriptor=function(){return new cx(this,this.input)},e})(sx),gT=(function(n){an(e,n);function e(t,r){var i=n.call(this)||this;return i.parentTask=t,i.input=r,i}return e})(zm),lx=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Ot(this,void 0,void 0,function(){var t,r;return Bt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),[4,V0(t,this.input,function(o){return Promise.all(o.map(function(s){return ui.faceRecognitionNet.computeFaceDescriptor(s)}))},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=i.sent(),[2,r.map(function(o,s){return oT(t[s],o)})]}})})},e.prototype.withFaceExpressions=function(){return new rx(this,this.input)},e.prototype.withAgeAndGender=function(){return new ax(this,this.input)},e})(gT),cx=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Ot(this,void 0,void 0,function(){var t,r;return Bt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),t?[4,Qb(t,this.input,function(o){return ui.faceRecognitionNet.computeFaceDescriptor(o)},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=i.sent(),[2,oT(t,r)]}})})},e.prototype.withFaceExpressions=function(){return new ix(this,this.input)},e.prototype.withAgeAndGender=function(){return new ux(this,this.input)},e})(gT),vT=(function(n){an(e,n);function e(t,r,i){var o=n.call(this)||this;return o.parentTask=t,o.input=r,o.useTinyLandmarkNet=i,o}return Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?ui.faceLandmark68TinyNet:ui.faceLandmark68Net},enumerable:!0,configurable:!0}),e})(zm),C9=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Ot(this,void 0,void 0,function(){var t,r,i,o,s,a=this;return Bt(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return t=u.sent(),r=t.map(function(l){return l.detection}),this.input instanceof Tr?[4,Hb(this.input,r)]:[3,3];case 2:return o=u.sent(),[3,5];case 3:return[4,qb(this.input,r)];case 4:o=u.sent(),u.label=5;case 5:return i=o,[4,Promise.all(i.map(function(l){return a.landmarkNet.detectLandmarks(l)}))];case 6:return s=u.sent(),i.forEach(function(l){return l instanceof Tr&&l.dispose()}),[2,t.map(function(l,h){return B0(l,s[h])})]}})})},e.prototype.withFaceExpressions=function(){return new rx(this,this.input)},e.prototype.withAgeAndGender=function(){return new ax(this,this.input)},e.prototype.withFaceDescriptors=function(){return new lx(this,this.input)},e})(vT),I9=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Ot(this,void 0,void 0,function(){var t,r,i,o,s;return Bt(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),t?(r=t.detection,this.input instanceof Tr?[4,Hb(this.input,[r])]:[3,3]):[2];case 2:return o=a.sent(),[3,5];case 3:return[4,qb(this.input,[r])];case 4:o=a.sent(),a.label=5;case 5:return i=o,[4,this.landmarkNet.detectLandmarks(i[0])];case 6:return s=a.sent(),i.forEach(function(u){return u instanceof Tr&&u.dispose()}),[2,B0(t,s)]}})})},e.prototype.withFaceExpressions=function(){return new ix(this,this.input)},e.prototype.withAgeAndGender=function(){return new ux(this,this.input)},e.prototype.withFaceDescriptor=function(){return new cx(this,this.input)},e})(vT),yT=(function(n){an(e,n);function e(t,r){r===void 0&&(r=new Um);var i=n.call(this)||this;return i.input=t,i.options=r,i}return e})(zm),wT=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Ot(this,void 0,void 0,function(){var t,r,i,o;return Bt(this,function(s){switch(s.label){case 0:return t=this,r=t.input,i=t.options,i instanceof uT?[4,ui.mtcnn.forward(r,i)]:[3,2];case 1:return[2,s.sent().map(function(a){return a.detection})];case 2:if(o=i instanceof hT?function(a){return ui.tinyFaceDetector.locateFaces(a,i)}:i instanceof Um?function(a){return ui.ssdMobilenetv1.locateFaces(a,i)}:i instanceof Jb?function(a){return ui.tinyYolov2.locateFaces(a,i)}:null,!o)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,o(r)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise(function(r){return Ot(t,void 0,void 0,function(){var i;return Bt(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return i=o.sent(),[2,r(i.map(function(s){return wm({},s)}))]}})})})},e.prototype.withFaceLandmarks=function(t){return t===void 0&&(t=!1),new C9(this.runAndExtendWithFaceDetections(),this.input,t)},e.prototype.withFaceExpressions=function(){return new tx(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new ox(this.runAndExtendWithFaceDetections(),this.input)},e})(yT),T9=(function(n){an(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Ot(this,void 0,void 0,function(){var t,r;return Bt(this,function(i){switch(i.label){case 0:return[4,new wT(this.input,this.options)];case 1:return t=i.sent(),r=t[0],t.forEach(function(o){o.score>r.score&&(r=o)}),[2,r]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var t=this;return new Promise(function(r){return Ot(t,void 0,void 0,function(){var i;return Bt(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return i=o.sent(),[2,r(i?wm({},i):void 0)]}})})})},e.prototype.withFaceLandmarks=function(t){return t===void 0&&(t=!1),new I9(this.runAndExtendWithFaceDetection(),this.input,t)},e.prototype.withFaceExpressions=function(){return new nx(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new sx(this.runAndExtendWithFaceDetection(),this.input)},e})(yT);function k9(n,e){return e===void 0&&(e=new Um),new T9(n,e)}function N9(n,e){return e===void 0&&(e=new Um),new wT(n,e)}function bT(n,e){if(n.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var t=Array.from(n),r=Array.from(e);return Math.sqrt(t.map(function(i,o){return i-r[o]}).reduce(function(i,o){return i+Math.pow(o,2)},0))}(function(){function n(e,t){t===void 0&&(t=.6),this._distanceThreshold=t;var r=Array.isArray(e)?e:[e];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var i=1,o=function(){return"person "+i++};this._labeledDescriptors=r.map(function(s){if(s instanceof $g)return s;if(s instanceof Float32Array)return new $g(o(),[s]);if(s.descriptor&&s.descriptor instanceof Float32Array)return new $g(o(),[s.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(n.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),n.prototype.computeMeanDistance=function(e,t){return t.map(function(r){return bT(r,e)}).reduce(function(r,i){return r+i},0)/(t.length||1)},n.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map(function(r){var i=r.descriptors,o=r.label;return new vS(o,t.computeMeanDistance(e,i))}).reduce(function(r,i){return r.distance<i.distance?r:i})},n.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new vS("unknown",t.distance)},n.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},n.fromJSON=function(e){var t=e.labeledDescriptors.map(function(r){return $g.fromJSON(r)});return new n(t,e.distanceThreshold)},n})();function xT(n,e){var t=new hf(e.width,e.height),r=t.width,i=t.height;if(r<=0||i<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:i}));if(Array.isArray(n))return n.map(function(a){return xT(a,{width:r,height:i})});if(ZI(n)){var o=n.detection.forSize(r,i),s=n.unshiftedLandmarks.forSize(o.box.width,o.box.height);return B0(wm(n,o),s)}return MI(n)?wm(n,n.detection.forSize(r,i)):n instanceof ym||n instanceof bu?n.forSize(r,i):n}const P9=()=>{const n=qe.useRef(null),e=qe.useRef(null),t=qe.useRef(!0),{setActiveMode:r,speak:i,playSound:o,conversationState:s,triggerInterview:a,faceDatabase:u,isListening:l,toggleListening:h}=vu(),[d,p]=qe.useState(!1),[m,w]=qe.useState(0),[b,x]=qe.useState("environment"),E=qe.useRef(0);qe.useEffect(()=>(t.current=!0,(async()=>{const W="https://justadudewhohacks.github.io/face-api.js/models";try{await Promise.all([ui.tinyFaceDetector.loadFromUri(W),ui.faceLandmark68TinyNet.loadFromUri(W),ui.faceRecognitionNet.loadFromUri(W),ui.ssdMobilenetv1.loadFromUri(W)]),t.current&&p(!0)}catch{t.current&&i("Neural network connection failed.")}})(),()=>{t.current=!1}),[]),qe.useEffect(()=>{let D=null;return(async()=>{n.current&&n.current.srcObject&&n.current.srcObject.getTracks().forEach(k=>k.stop());try{D=await navigator.mediaDevices.getUserMedia({video:{facingMode:b,width:{ideal:640},height:{ideal:480},frameRate:{ideal:30}},audio:!1}),n.current&&t.current&&(n.current.srcObject=D)}catch{t.current&&i("Camera malfunction.")}})(),()=>{D&&D.getTracks().forEach(k=>k.stop())}},[b]);const A=()=>{o("click"),x(D=>D==="environment"?"user":"environment")},N=(D,W,k,C,L,B,R)=>{const M=W+C/2,U=k+L/2,J=Math.max(C,L)*.6;D.save(),D.translate(M,U),b==="user"&&D.scale(-1,1),D.beginPath(),D.rotate(R*.05),D.arc(0,0,J*.8,0,Math.PI*2),D.strokeStyle=B,D.lineWidth=3,D.setLineDash([10,5]),D.shadowBlur=10,D.shadowColor=B,D.stroke(),D.rotate(-R*.1);const de=J*1.2;D.lineWidth=5,D.setLineDash([]);for(let fe=0;fe<3;fe++)D.rotate(Math.PI*2/3),D.beginPath(),D.arc(0,0,de,0,1),D.stroke();D.resetTransform(),D.strokeStyle=B,D.lineWidth=1,D.globalAlpha=.5,D.beginPath(),D.moveTo(M-20,U),D.lineTo(M+20,U),D.moveTo(M,U-20),D.lineTo(M,U+20),D.stroke(),D.restore()},F=(D,W,k,C,L,B,R=!1)=>{const M=C*.2;if(D.save(),R){const U=Math.sin(Date.now()/100);D.lineWidth=4,D.shadowBlur=20*Math.abs(U),D.shadowColor=B,D.strokeStyle=`rgba(0, 68, 255, ${Math.abs(U)+.5})`}else D.lineWidth=2,D.strokeStyle=B,D.shadowBlur=0;D.beginPath(),D.moveTo(W,k+M),D.lineTo(W,k),D.lineTo(W+M,k),D.moveTo(W+C-M,k),D.lineTo(W+C,k),D.lineTo(W+C,k+M),D.moveTo(W+C,k+L-M),D.lineTo(W+C,k+L),D.lineTo(W+C-M,k+L),D.moveTo(W+M,k+L),D.lineTo(W,k+L),D.lineTo(W,k+L-M),D.stroke(),D.restore()};return qe.useEffect(()=>{if(!d||!n.current)return;let D=!1,W;const k=new hT({inputSize:320,scoreThreshold:.5}),C=async()=>{if(t.current){if(D){W=requestAnimationFrame(C);return}if(D=!0,n.current&&n.current.readyState===4&&e.current)try{const L=await N9(n.current,k).withFaceLandmarks(!0).withFaceDescriptors();if(!t.current)return;const B=e.current.getContext("2d"),R={width:n.current.videoWidth,height:n.current.videoHeight};e.current.width=R.width,e.current.height=R.height,b==="user"&&(B.translate(R.width,0),B.scale(-1,1));const M=xT(L,R);B.clearRect(0,0,R.width,R.height);let U=-1,J=0,de=!1;if(M.forEach((fe,he)=>{const K=fe.detection.box.width*fe.detection.box.height;K>J&&(J=K,U=he)}),M.forEach((fe,he)=>{const K=fe.detection.box,le=he===U;let se={name:"Unknown",accessLevel:"No Access",distance:1};u.length>0&&u.forEach(j=>{if(j.descriptor){const $=new Float32Array(Object.values(j.descriptor)),ne=bT(fe.descriptor,$);ne<.6&&ne<se.distance&&(se={...j,distance:ne})}});let re="#888888";if(s==="SCANNING"&&le?re="#FFFFFF":se.accessLevel==="Admin"?re="#00FF00":se.accessLevel==="Medium"?re="#FFA500":se.accessLevel==="Missing"&&(re="#0044FF"),se.accessLevel==="Missing"&&(de=!0),le){const j=Date.now()/20;N(B,K.x,K.y,K.width,K.height,re,j),B.save(),b==="user"&&(B.scale(-1,1),B.translate(-(K.x*2+K.width+180),0));const $=K.x+K.width+20,ne=K.y;(se.name!=="Unknown"||s==="SCANNING")&&(B.fillStyle="rgba(0, 0, 0, 0.8)",B.fillRect($,ne,160,90),B.strokeStyle=re,B.strokeRect($,ne,160,90),B.font="bold 12px Orbitron",B.fillStyle=re,B.fillText(se.name.toUpperCase(),$+10,ne+25),B.font="10px Share Tech Mono",B.fillStyle="#FFFFFF",B.fillText(`ACCESS: ${se.accessLevel?se.accessLevel.toUpperCase():"SCANNING..."}`,$+10,ne+45),se.age&&B.fillText(`AGE: ${se.age}`,$+10,ne+60)),B.restore(),s==="SCANNING"?(w(ce=>ce+1),B.fillStyle="#00E5FF",B.fillRect(K.x,K.y-15,K.width*(m/20),8),m>20&&(w(0),a(fe.descriptor))):w(0)}else{F(B,K.x,K.y,K.width,K.height,re,se.accessLevel==="Missing"),B.save(),b==="user"&&(B.scale(-1,1),B.translate(-(K.x*2+K.width),0)),B.font="bold 10px Orbitron",B.fillStyle=re;const j=se.name!=="Unknown"?se.name.toUpperCase():"UNKNOWN";B.fillText(j,K.x,K.y-5),se.accessLevel==="Missing"&&(B.fillStyle="#0044FF",B.font="bold 12px Orbitron",B.fillText(" MATCH FOUND",K.x,K.y-20)),B.restore()}}),de){const fe=Date.now();fe-E.current>15e3&&(i("Alert, Sir. Missing person detected in sector.",!1),o("startup"),E.current=fe)}M.length===0&&w(0)}catch(L){console.log("Detection skip",L)}D=!1,W=requestAnimationFrame(C)}};return C(),()=>cancelAnimationFrame(W)},[d,u,s,m,a,b]),ae.jsxs("div",{className:"fixed inset-0 z-50 bg-black flex flex-col items-center justify-center",children:[ae.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,muted:!0,className:`absolute inset-0 w-full h-full object-cover ${b==="user"?"scale-x-[-1]":""}`}),ae.jsx("canvas",{ref:e,className:"absolute inset-0 w-full h-full object-cover pointer-events-none"}),ae.jsx("div",{className:"absolute top-8 left-1/2 transform -translate-x-1/2 bg-black/60 border border-cyan px-4 py-2 rounded text-cyan font-orbitron text-xs backdrop-blur-md",children:d?s==="IDLE"?"MULTI-TARGET TRACKING ACTIVE":"PRIORITY SCAN IN PROGRESS":"LOADING AI CORE..."}),ae.jsxs("div",{className:"absolute bottom-10 z-50 flex gap-4",children:[ae.jsx("button",{onClick:A,className:"w-14 h-14 rounded-full bg-black/60 border border-cyan text-cyan flex items-center justify-center backdrop-blur-md hover:bg-cyan/20 active:scale-90 transition-all",children:ae.jsx("i",{className:"fas fa-sync-alt text-xl"})}),ae.jsx("button",{onClick:h,className:`w-14 h-14 rounded-full border flex items-center justify-center backdrop-blur-md transition-all ${l?"bg-red-500/50 border-red-500 animate-pulse":"bg-black/60 border-cyan text-cyan"}`,children:ae.jsx("i",{className:"fas fa-microphone text-xl"})}),ae.jsx("button",{onClick:()=>{o("click"),r("HOME")},className:"w-14 h-14 rounded-full bg-black/60 border border-red-500 text-red-500 flex items-center justify-center backdrop-blur-md",children:ae.jsx("i",{className:"fas fa-times text-xl"})})]})]})},R9="JarvisMediaDB",mh="tracks",hx=()=>new Promise((n,e)=>{const t=indexedDB.open(R9,1);t.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(mh)||i.createObjectStore(mh,{keyPath:"id"})},t.onsuccess=()=>n(t.result),t.onerror=r=>e(r)}),D9=async n=>{const e=await hx();return new Promise(async(t,r)=>{const i=await n.file.arrayBuffer(),o={id:n.id,name:n.name,buffer:i,type:n.file.type},s=e.transaction(mh,"readwrite"),u=s.objectStore(mh).put(o);s.oncomplete=()=>t(u.result),s.onerror=()=>r(s.error)})},L9=async()=>{const n=await hx();return new Promise((e,t)=>{const o=n.transaction(mh,"readonly").objectStore(mh).getAll();o.onsuccess=()=>{const s=o.result.map(a=>{const u=new Blob([a.buffer],{type:a.type});return{id:a.id,name:a.name,file:u}});e(s)},o.onerror=()=>t(o.error)})},M9=async n=>{const e=await hx();return new Promise((t,r)=>{const i=e.transaction(mh,"readwrite");i.objectStore(mh).delete(n),i.oncomplete=()=>t(!0),i.onerror=()=>r(i.error)})},F9=()=>{const{setActiveMode:n,speak:e,playSound:t,lastCommand:r}=vu(),i=qe.useRef(null),[o,s]=qe.useState([]),[a,u]=qe.useState(-1),[l,h]=qe.useState(!1),[d,p]=qe.useState(0),[m,w]=qe.useState(0);qe.useEffect(()=>((async()=>{try{const k=await L9();if(k&&k.length>0){const C=k.map(L=>({...L,url:URL.createObjectURL(L.file)}));s(C),u(0)}}catch(k){console.error("DB Error:",k),e("Database access error.")}})(),()=>{o.forEach(k=>URL.revokeObjectURL(k.url))}),[]),qe.useEffect(()=>{if(!r)return;const W=r.text,k=r.time;Date.now()-k>2e3||(W.includes("play music")||W.includes("resume")?i.current&&a!==-1?(i.current.play(),h(!0),e("Playing audio.")):e("Playlist is empty."):W.includes("stop")||W.includes("pause")?i.current&&(i.current.pause(),h(!1),e("Audio paused.")):W.includes("next")?(A(),e("Skipping.")):W.includes("previous")&&N())},[r]);const b=async W=>{const k=Array.from(W.target.files);if(k.length>0){e("Processing audio files. Please wait.");const C=[];for(const L of k){const B={id:Date.now()+Math.random(),name:L.name.replace(/\.[^/.]+$/,""),file:L};try{await D9(B),C.push({...B,url:URL.createObjectURL(L)})}catch(R){console.error("Save failed",R),e("Error saving file.")}}s(L=>[...L,...C]),e(`${k.length} tracks saved to database.`),a===-1&&u(0)}},x=async W=>{const k=o[W];await M9(k.id);const C=[...o];C.splice(W,1),s(C),a>=W&&a>0&&u(a-1)};qe.useEffect(()=>{a>=0&&a<o.length&&i.current&&(i.current.src=o[a].url,l&&i.current.play())},[a]);const E=()=>{!i.current||a===-1||(l?i.current.pause():i.current.play(),h(!l))},A=()=>{a<o.length-1?u(W=>W+1):u(0)},N=()=>{a>0&&u(W=>W-1)},F=()=>{i.current&&(p(i.current.currentTime),w(i.current.duration||0))},D=W=>{const k=Math.floor(W/60),C=Math.floor(W%60);return`${k}:${C<10?"0"+C:C}`};return ae.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[ae.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[ae.jsxs("div",{className:"flex items-center gap-3",children:[ae.jsx("i",{className:"fas fa-music text-cyan text-xl animate-pulse"}),ae.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"MEDIA DECK"})]}),ae.jsx("button",{onClick:()=>{t("click"),n("MENU_OPEN")},className:"text-cyan hover:text-white",children:ae.jsx("i",{className:"fas fa-times text-2xl"})})]}),ae.jsxs("div",{className:"p-6 flex flex-col items-center justify-center border-b border-cyan/10 bg-cyan/5",children:[ae.jsxs("div",{className:"w-32 h-32 rounded-full border-4 border-cyan/30 flex items-center justify-center mb-4 relative",children:[ae.jsx("div",{className:`absolute inset-0 border-t-4 border-cyan rounded-full ${l?"animate-spin":""}`}),ae.jsx("i",{className:"fas fa-compact-disc text-5xl text-cyan/50"})]}),ae.jsx("h3",{className:"text-cyan font-bold text-lg text-center truncate w-full max-w-xs",children:a!==-1?o[a].name:"NO MEDIA LOADED"}),ae.jsxs("p",{className:"text-cyan-dim font-mono text-xs mt-1",children:[D(d)," / ",D(m)]}),ae.jsx("div",{className:"w-full max-w-xs h-1 bg-cyan/20 mt-4 rounded-full overflow-hidden",children:ae.jsx("div",{className:"h-full bg-cyan transition-all duration-300",style:{width:`${d/m*100}%`}})})]}),ae.jsx("div",{className:"flex-1 overflow-y-auto p-4 no-scrollbar",children:ae.jsx("div",{className:"flex flex-col gap-2",children:o.map((W,k)=>ae.jsxs("div",{className:`p-3 border rounded flex items-center gap-3 ${a===k?"border-cyan bg-cyan/20 text-cyan":"border-white/5 text-gray-500"}`,children:[ae.jsxs("button",{onClick:()=>{u(k),h(!0)},className:"flex-1 text-left truncate",children:[k+1,". ",W.name]}),ae.jsx("button",{onClick:()=>x(k),className:"text-red-500 hover:text-white",children:ae.jsx("i",{className:"fas fa-trash"})})]},W.id))})}),ae.jsxs("div",{className:"p-6 pb-10 border-t border-cyan/30 bg-black flex flex-col gap-4",children:[ae.jsx("input",{type:"file",id:"audio-upload",multiple:!0,accept:"audio/*",className:"hidden",onChange:b}),ae.jsx("button",{onClick:()=>document.getElementById("audio-upload").click(),className:"w-full py-3 border border-dashed border-cyan/50 text-cyan/50 font-mono text-xs",children:"+ IMPORT AUDIO FILES"}),ae.jsxs("div",{className:"flex justify-between items-center px-4",children:[ae.jsx("button",{onClick:N,className:"text-cyan hover:text-white",children:ae.jsx("i",{className:"fas fa-step-backward text-2xl"})}),ae.jsx("button",{onClick:E,className:"w-16 h-16 rounded-full bg-cyan text-black flex items-center justify-center shadow-[0_0_20px_#00E5FF]",children:ae.jsx("i",{className:`fas ${l?"fa-pause":"fa-play"} text-2xl`})}),ae.jsx("button",{onClick:A,className:"text-cyan hover:text-white",children:ae.jsx("i",{className:"fas fa-step-forward text-2xl"})})]})]}),ae.jsx("audio",{ref:i,onTimeUpdate:F,onEnded:A})]})},O9=()=>{const{faceDatabase:n,deletePerson:e,updatePerson:t,addPerson:r,clearDatabase:i,setActiveMode:o,playSound:s,speak:a}=vu(),[u,l]=qe.useState("LIST"),[h,d]=qe.useState(null),[p,m]=qe.useState({name:"",gender:"Male",age:"",accessLevel:"No Access"}),[w,b]=qe.useState(!1),[x,E]=qe.useState(!1),A=k=>{const C=n[k];m({name:C.name,gender:C.gender||"Male",age:C.age||"",accessLevel:C.accessLevel||"No Access",descriptor:C.descriptor}),b(!!C.descriptor),d(k),l("EDIT")},N=()=>{m({name:"",gender:"Male",age:"",accessLevel:"No Access"}),b(!1),l("ADD")},F=()=>{if(!p.name)return a("Name is required.");u==="ADD"?r(p):t(h,p),l("LIST")},D=async k=>{const C=k.target.files[0];if(C){E(!0),a("Analyzing photo for biometric data...");try{const L="https://justadudewhohacks.github.io/face-api.js/models";await Promise.all([ui.tinyFaceDetector.loadFromUri(L),ui.faceLandmark68Net.loadFromUri(L),ui.faceRecognitionNet.loadFromUri(L),ui.ssdMobilenetv1.loadFromUri(L)]);const B=await rj(C),R=await k9(B).withFaceLandmarks().withFaceDescriptor();R?(m(M=>({...M,descriptor:R.descriptor})),b(!0),a("Face detected and encoded.")):a("No valid face found in this image.")}catch(L){console.error(L),a("Analysis failed.")}E(!1)}},W=k=>k==="Admin"?"text-green-500 border-green-500/50 bg-green-500/10":k==="Medium"?"text-orange-500 border-orange-500/50 bg-orange-500/10":k==="Missing"?"text-blue-500 border-blue-500/50 bg-blue-500/10":"text-gray-400 border-gray-500/50 bg-gray-500/10";return ae.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[ae.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[ae.jsxs("div",{className:"flex items-center gap-3",children:[ae.jsx("i",{className:"fas fa-database text-cyan text-xl animate-pulse"}),ae.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:u==="LIST"?"IDENTITY RECORDS":u==="ADD"?"NEW ENTRY":"EDIT RECORD"})]}),ae.jsx("button",{onClick:()=>{s("click"),u==="LIST"?o("HOME"):l("LIST")},className:"text-cyan hover:text-white",children:ae.jsx("i",{className:`fas ${u==="LIST"?"fa-times":"fa-arrow-left"} text-2xl`})})]}),u==="LIST"&&ae.jsxs(ae.Fragment,{children:[ae.jsxs("div",{className:"p-4 border-b border-cyan/10 flex justify-between",children:[ae.jsxs("span",{className:"text-cyan-dim font-mono text-xs pt-2",children:["RECORDS: ",n.length]}),ae.jsx("button",{onClick:()=>{s("click"),N()},className:"px-4 py-2 bg-cyan/10 border border-cyan text-cyan font-orbitron text-xs hover:bg-cyan/30",children:"+ ADD MANUAL ENTRY"})]}),ae.jsx("div",{className:"flex-1 overflow-y-auto p-4 no-scrollbar flex flex-col gap-3",children:n.length===0?ae.jsx("div",{className:"text-center text-cyan-dim mt-20 opacity-50",children:"DATABASE EMPTY"}):n.map((k,C)=>ae.jsxs("div",{className:`p-4 border rounded-lg flex justify-between items-center ${W(k.accessLevel)}`,children:[ae.jsxs("div",{className:"flex items-center gap-4",children:[ae.jsx("div",{className:"w-10 h-10 rounded-full border flex items-center justify-center",children:ae.jsx("i",{className:`fas ${k.descriptor?"fa-fingerprint":"fa-user"} text-lg`})}),ae.jsxs("div",{children:[ae.jsx("div",{className:"font-bold",children:k.name.toUpperCase()}),ae.jsxs("div",{className:"text-xs opacity-70",children:[k.gender," | ",k.age," | ",k.accessLevel]})]})]}),ae.jsxs("div",{className:"flex gap-2",children:[ae.jsx("button",{onClick:()=>A(C),className:"w-8 h-8 border rounded hover:bg-white/10",children:ae.jsx("i",{className:"fas fa-pen text-xs"})}),ae.jsx("button",{onClick:()=>e(C),className:"w-8 h-8 border border-red-500/50 text-red-500 hover:bg-red-500/20",children:ae.jsx("i",{className:"fas fa-trash text-xs"})})]})]},C))})]}),u!=="LIST"&&ae.jsxs("div",{className:"flex-1 overflow-y-auto p-6 flex flex-col gap-6",children:[ae.jsxs("div",{className:"p-4 border border-cyan/30 rounded bg-cyan/5 text-center",children:[ae.jsx("div",{className:`w-20 h-20 mx-auto rounded-full border-2 flex items-center justify-center mb-2 ${w?"border-green-500 text-green-500":"border-cyan/30 text-cyan/30"}`,children:x?ae.jsx("i",{className:"fas fa-circle-notch fa-spin text-2xl"}):ae.jsx("i",{className:"fas fa-fingerprint text-3xl"})}),ae.jsx("div",{className:"font-mono text-xs mb-3",children:w?"BIOMETRIC DATA LINKED":"NO BIOMETRIC DATA"}),ae.jsx("input",{type:"file",id:"face-upload",accept:"image/*",className:"hidden",onChange:D}),ae.jsx("button",{onClick:()=>document.getElementById("face-upload").click(),disabled:x,className:"px-4 py-2 border border-cyan text-cyan font-mono text-xs hover:bg-cyan/10",children:w?"UPDATE PHOTO":"UPLOAD PHOTO FOR SCAN"}),ae.jsx("div",{className:"text-[10px] text-cyan-dim mt-2",children:"* Uploading a clear face photo allows JARVIS to recognize this person in the field."})]}),ae.jsxs("div",{className:"flex flex-col gap-4",children:[ae.jsxs("div",{children:[ae.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"FULL NAME"}),ae.jsx("input",{type:"text",value:p.name,onChange:k=>m({...p,name:k.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-orbitron focus:border-cyan outline-none",placeholder:"ENTER NAME"})]}),ae.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[ae.jsxs("div",{children:[ae.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"GENDER"}),ae.jsxs("select",{value:p.gender,onChange:k=>m({...p,gender:k.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-mono outline-none",children:[ae.jsx("option",{value:"Male",children:"MALE"}),ae.jsx("option",{value:"Female",children:"FEMALE"})]})]}),ae.jsxs("div",{children:[ae.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"AGE"}),ae.jsx("input",{type:"number",value:p.age,onChange:k=>m({...p,age:k.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-mono outline-none",placeholder:"00"})]})]}),ae.jsxs("div",{children:[ae.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"ACCESS LEVEL"}),ae.jsxs("select",{value:p.accessLevel,onChange:k=>m({...p,accessLevel:k.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-mono outline-none",children:[ae.jsx("option",{value:"No Access",children:"NO ACCESS (GREY)"}),ae.jsx("option",{value:"Medium",children:"MEDIUM (ORANGE)"}),ae.jsx("option",{value:"Admin",children:"ADMIN (GREEN)"}),ae.jsx("option",{value:"Missing",children:"MISSING PERSON (BLUE)"})]})]})]}),ae.jsx("button",{onClick:F,className:"mt-4 w-full py-4 bg-cyan/20 border border-cyan text-cyan font-bold font-orbitron tracking-widest hover:bg-cyan/40",children:"SAVE RECORD"})]})]})},B9=()=>{const{hudData:n,setActiveMode:e,playSound:t,speak:r,battery:i}=vu(),[o,s]=qe.useState(!1),[a,u]=qe.useState(new Date);qe.useEffect(()=>{const d=setInterval(()=>u(new Date),1e3);return()=>clearInterval(d)},[]);const l=()=>{s(!o),r(o?"Standard view.":"Heads up display mode active.")},h=d=>d<50?"text-cyan":d<100?"text-cyan-200":d<130?"text-orange-500":"text-red-600 animate-pulse";return ae.jsxs("div",{className:"fixed inset-0 z-30 flex flex-col items-center justify-between p-6 bg-black/10 backdrop-blur-[1px]",children:[ae.jsxs("div",{className:`w-full h-full flex flex-col justify-between relative z-10 transition-transform duration-500 ${o?"scale-x-[-1]":""}`,children:[ae.jsxs("div",{className:"flex justify-between items-start pointer-events-none",children:[ae.jsxs("div",{className:"text-cyan font-mono text-sm bg-black/40 p-2 rounded border border-cyan/20",children:[ae.jsx("div",{className:"border-b border-cyan/50 mb-1 pb-1 text-[10px]",children:"HEADING"}),ae.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(n.heading),""]}),ae.jsx("div",{className:"text-xs opacity-70",children:n.heading>=337||n.heading<23?"N":n.heading<67?"NE":n.heading<112?"E":n.heading<157?"SE":n.heading<202?"S":n.heading<247?"SW":n.heading<292?"W":"NW"})]}),ae.jsxs("div",{className:"text-right text-cyan font-mono bg-black/40 p-2 rounded border border-cyan/20",children:[ae.jsx("div",{className:"text-4xl font-bold",children:a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),ae.jsxs("div",{className:"text-xs",children:["ALT: ",n.altitude,"m"]})]})]}),ae.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center w-full pointer-events-none",children:[ae.jsx("div",{className:`font-orbitron font-black text-[100px] leading-none tracking-tighter drop-shadow-[0_0_10px_rgba(0,0,0,0.8)] ${h(n.speed)}`,children:n.speed}),ae.jsx("div",{className:"text-cyan/70 font-mono text-xl tracking-[8px] mt-2 bg-black/30 inline-block px-4 rounded",children:"KM/H"})]}),ae.jsxs("div",{className:"flex justify-between items-end w-full",children:[ae.jsxs("div",{className:"w-24 h-24 rounded-full border border-cyan/30 flex items-center justify-center relative bg-black/20 backdrop-blur-sm pointer-events-none",children:[ae.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-30 text-4xl text-cyan",children:"+"}),ae.jsx("div",{className:"w-3 h-3 bg-cyan rounded-full shadow-[0_0_10px_#00E5FF]",style:{transform:`translate(${Math.sin(a.getTime()/1e3)*10}px, ${Math.cos(a.getTime()/1e3)*10}px)`}}),ae.jsx("div",{className:"absolute -bottom-6 w-full text-center text-cyan/50 text-[10px]",children:"G-FORCE"})]}),ae.jsxs("button",{onClick:()=>{t("click"),window.open("https://maps.google.com","_blank")},className:"mb-2 bg-cyan/10 border border-cyan text-cyan px-6 py-3 rounded-full font-orbitron text-sm hover:bg-cyan/30 active:scale-95 transition-all shadow-[0_0_15px_rgba(0,229,255,0.2)]",children:[ae.jsx("i",{className:"fas fa-location-arrow mr-2"})," MAPS"]})]})]}),ae.jsxs("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 flex gap-6 z-50",children:[ae.jsx("button",{onClick:l,className:`w-14 h-14 rounded-full border flex items-center justify-center backdrop-blur-md transition-all shadow-[0_0_15px_rgba(0,229,255,0.2)] ${o?"bg-cyan text-black border-cyan":"bg-black/60 border-cyan text-cyan"}`,children:ae.jsx("i",{className:"fas fa-clone text-xl transform rotate-90"})}),ae.jsx("button",{onClick:()=>{t("click"),e("HOME")},className:"w-14 h-14 rounded-full bg-black/60 border border-red-500 text-red-500 flex items-center justify-center backdrop-blur-md shadow-[0_0_15px_rgba(255,0,0,0.3)]",children:ae.jsx("i",{className:"fas fa-times text-xl"})})]})]})},V9="modulepreload",j9=function(n){return"/jarvis-mobile/"+n},ES={},q2=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let s=function(l){return Promise.all(l.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=s(t.map(l=>{if(l=j9(l),l in ES)return;ES[l]=!0;const h=l.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":V9,h||(p.as="script"),p.crossOrigin="",p.href=l,u&&p.setAttribute("nonce",u),document.head.appendChild(p),h)return new Promise((m,w)=>{p.addEventListener("load",m),p.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})};function tr(n){"@babel/helpers - typeof";return tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr(n)}var Bo=Uint8Array,Zs=Uint16Array,fx=Int32Array,j0=new Bo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),U0=new Bo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),H2=new Bo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_T=function(n,e){for(var t=new Zs(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new fx(t[30]),r=1;r<30;++r)for(var o=t[r];o<t[r+1];++o)i[o]=o-t[r]<<5|r;return{b:t,r:i}},ET=_T(j0,2),ST=ET.b,G2=ET.r;ST[28]=258,G2[258]=28;var AT=_T(U0,0),U9=AT.b,SS=AT.r,$2=new Zs(32768);for(var gr=0;gr<32768;++gr){var zc=(gr&43690)>>1|(gr&21845)<<1;zc=(zc&52428)>>2|(zc&13107)<<2,zc=(zc&61680)>>4|(zc&3855)<<4,$2[gr]=((zc&65280)>>8|(zc&255)<<8)>>1}var il=(function(n,e,t){for(var r=n.length,i=0,o=new Zs(e);i<r;++i)n[i]&&++o[n[i]-1];var s=new Zs(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var a;if(t){a=new Zs(1<<e);var u=15-e;for(i=0;i<r;++i)if(n[i])for(var l=i<<4|n[i],h=e-n[i],d=s[n[i]-1]++<<h,p=d|(1<<h)-1;d<=p;++d)a[$2[d]>>u]=l}else for(a=new Zs(r),i=0;i<r;++i)n[i]&&(a[i]=$2[s[n[i]-1]++]>>15-n[i]);return a}),gh=new Bo(288);for(var gr=0;gr<144;++gr)gh[gr]=8;for(var gr=144;gr<256;++gr)gh[gr]=9;for(var gr=256;gr<280;++gr)gh[gr]=7;for(var gr=280;gr<288;++gr)gh[gr]=8;var bm=new Bo(32);for(var gr=0;gr<32;++gr)bm[gr]=5;var z9=il(gh,9,0),W9=il(gh,9,1),q9=il(bm,5,0),H9=il(bm,5,1),Oy=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},au=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&t},By=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},dx=function(n){return(n+7)/8|0},CT=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new Bo(n.subarray(e,t))},G9=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],cu=function(n,e,t){var r=new Error(e||G9[n]);if(r.code=n,Error.captureStackTrace&&Error.captureStackTrace(r,cu),!t)throw r;return r},$9=function(n,e,t,r){var i=n.length,o=0;if(!i||e.f&&!e.l)return t||new Bo(0);var s=!t,a=s||e.i!=2,u=e.i;s&&(t=new Bo(i*3));var l=function(Ue){var et=t.length;if(Ue>et){var Je=new Bo(Math.max(et*2,Ue));Je.set(t),t=Je}},h=e.f||0,d=e.p||0,p=e.b||0,m=e.l,w=e.d,b=e.m,x=e.n,E=i*8;do{if(!m){h=au(n,d,1);var A=au(n,d+1,3);if(d+=3,A)if(A==1)m=W9,w=H9,b=9,x=5;else if(A==2){var W=au(n,d,31)+257,k=au(n,d+10,15)+4,C=W+au(n,d+5,31)+1;d+=14;for(var L=new Bo(C),B=new Bo(19),R=0;R<k;++R)B[H2[R]]=au(n,d+R*3,7);d+=k*3;for(var M=Oy(B),U=(1<<M)-1,J=il(B,M,1),R=0;R<C;){var de=J[au(n,d,U)];d+=de&15;var N=de>>4;if(N<16)L[R++]=N;else{var fe=0,he=0;for(N==16?(he=3+au(n,d,3),d+=2,fe=L[R-1]):N==17?(he=3+au(n,d,7),d+=3):N==18&&(he=11+au(n,d,127),d+=7);he--;)L[R++]=fe}}var K=L.subarray(0,W),le=L.subarray(W);b=Oy(K),x=Oy(le),m=il(K,b,1),w=il(le,x,1)}else cu(1);else{var N=dx(d)+4,F=n[N-4]|n[N-3]<<8,D=N+F;if(D>i){u&&cu(0);break}a&&l(p+F),t.set(n.subarray(N,D),p),e.b=p+=F,e.p=d=D*8,e.f=h;continue}if(d>E){u&&cu(0);break}}a&&l(p+131072);for(var se=(1<<b)-1,re=(1<<x)-1,j=d;;j=d){var fe=m[By(n,d)&se],$=fe>>4;if(d+=fe&15,d>E){u&&cu(0);break}if(fe||cu(2),$<256)t[p++]=$;else if($==256){j=d,m=null;break}else{var ne=$-254;if($>264){var R=$-257,ce=j0[R];ne=au(n,d,(1<<ce)-1)+ST[R],d+=ce}var ge=w[By(n,d)&re],ye=ge>>4;ge||cu(3),d+=ge&15;var le=U9[ye];if(ye>3){var ce=U0[ye];le+=By(n,d)&(1<<ce)-1,d+=ce}if(d>E){u&&cu(0);break}a&&l(p+131072);var be=p+ne;if(p<le){var Ae=o-le,$e=Math.min(le,be);for(Ae+p<0&&cu(3);p<$e;++p)t[p]=r[Ae+p]}for(;p<be;++p)t[p]=t[p-le]}}e.l=m,e.p=j,e.b=p,e.f=h,m&&(h=1,e.m=b,e.d=w,e.n=x)}while(!h);return p!=t.length&&s?CT(t,0,p):t.subarray(0,p)},jl=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8},Mp=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8,n[r+2]|=t>>16},Vy=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var i=t.length,o=t.slice();if(!i)return{t:TT,l:0};if(i==1){var s=new Bo(t[0].s+1);return s[t[0].s]=1,{t:s,l:1}}t.sort(function(D,W){return D.f-W.f}),t.push({s:-1,f:25001});var a=t[0],u=t[1],l=0,h=1,d=2;for(t[0]={s:-1,f:a.f+u.f,l:a,r:u};h!=i-1;)a=t[t[l].f<t[d].f?l++:d++],u=t[l!=h&&t[l].f<t[d].f?l++:d++],t[h++]={s:-1,f:a.f+u.f,l:a,r:u};for(var p=o[0].s,r=1;r<i;++r)o[r].s>p&&(p=o[r].s);var m=new Zs(p+1),w=K2(t[h-1],m,0);if(w>e){var r=0,b=0,x=w-e,E=1<<x;for(o.sort(function(W,k){return m[k.s]-m[W.s]||W.f-k.f});r<i;++r){var A=o[r].s;if(m[A]>e)b+=E-(1<<w-m[A]),m[A]=e;else break}for(b>>=x;b>0;){var N=o[r].s;m[N]<e?b-=1<<e-m[N]++-1:++r}for(;r>=0&&b;--r){var F=o[r].s;m[F]==e&&(--m[F],++b)}w=e}return{t:new Bo(m),l:w}},K2=function(n,e,t){return n.s==-1?Math.max(K2(n.l,e,t+1),K2(n.r,e,t+1)):e[n.s]=t},AS=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new Zs(++e),r=0,i=n[0],o=1,s=function(u){t[r++]=u},a=1;a<=e;++a)if(n[a]==i&&a!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=n[a]}return{c:t.subarray(0,r),n:e}},Fp=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},IT=function(n,e,t){var r=t.length,i=dx(e+2);n[i]=r&255,n[i+1]=r>>8,n[i+2]=n[i]^255,n[i+3]=n[i+1]^255;for(var o=0;o<r;++o)n[i+o+4]=t[o];return(i+4+r)*8},CS=function(n,e,t,r,i,o,s,a,u,l,h){jl(e,h++,t),++i[256];for(var d=Vy(i,15),p=d.t,m=d.l,w=Vy(o,15),b=w.t,x=w.l,E=AS(p),A=E.c,N=E.n,F=AS(b),D=F.c,W=F.n,k=new Zs(19),C=0;C<A.length;++C)++k[A[C]&31];for(var C=0;C<D.length;++C)++k[D[C]&31];for(var L=Vy(k,7),B=L.t,R=L.l,M=19;M>4&&!B[H2[M-1]];--M);var U=l+5<<3,J=Fp(i,gh)+Fp(o,bm)+s,de=Fp(i,p)+Fp(o,b)+s+14+3*M+Fp(k,B)+2*k[16]+3*k[17]+7*k[18];if(u>=0&&U<=J&&U<=de)return IT(e,h,n.subarray(u,u+l));var fe,he,K,le;if(jl(e,h,1+(de<J)),h+=2,de<J){fe=il(p,m,0),he=p,K=il(b,x,0),le=b;var se=il(B,R,0);jl(e,h,N-257),jl(e,h+5,W-1),jl(e,h+10,M-4),h+=14;for(var C=0;C<M;++C)jl(e,h+3*C,B[H2[C]]);h+=3*M;for(var re=[A,D],j=0;j<2;++j)for(var $=re[j],C=0;C<$.length;++C){var ne=$[C]&31;jl(e,h,se[ne]),h+=B[ne],ne>15&&(jl(e,h,$[C]>>5&127),h+=$[C]>>12)}}else fe=z9,he=gh,K=q9,le=bm;for(var C=0;C<a;++C){var ce=r[C];if(ce>255){var ne=ce>>18&31;Mp(e,h,fe[ne+257]),h+=he[ne+257],ne>7&&(jl(e,h,ce>>23&31),h+=j0[ne]);var ge=ce&31;Mp(e,h,K[ge]),h+=le[ge],ge>3&&(Mp(e,h,ce>>5&8191),h+=U0[ge])}else Mp(e,h,fe[ce]),h+=he[ce]}return Mp(e,h,fe[256]),h+he[256]},K9=new fx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),TT=new Bo(0),X9=function(n,e,t,r,i,o){var s=o.z||n.length,a=new Bo(r+s+5*(1+Math.ceil(s/7e3))+i),u=a.subarray(r,a.length-i),l=o.l,h=(o.r||0)&7;if(e){h&&(u[0]=o.r>>3);for(var d=K9[e-1],p=d>>13,m=d&8191,w=(1<<t)-1,b=o.p||new Zs(32768),x=o.h||new Zs(w+1),E=Math.ceil(t/3),A=2*E,N=function(Be){return(n[Be]^n[Be+1]<<E^n[Be+2]<<A)&w},F=new fx(25e3),D=new Zs(288),W=new Zs(32),k=0,C=0,L=o.i||0,B=0,R=o.w||0,M=0;L+2<s;++L){var U=N(L),J=L&32767,de=x[U];if(b[J]=de,x[U]=J,R<=L){var fe=s-L;if((k>7e3||B>24576)&&(fe>423||!l)){h=CS(n,u,0,F,D,W,C,B,M,L-M,h),B=k=C=0,M=L;for(var he=0;he<286;++he)D[he]=0;for(var he=0;he<30;++he)W[he]=0}var K=2,le=0,se=m,re=J-de&32767;if(fe>2&&U==N(L-re))for(var j=Math.min(p,fe)-1,$=Math.min(32767,L),ne=Math.min(258,fe);re<=$&&--se&&J!=de;){if(n[L+K]==n[L+K-re]){for(var ce=0;ce<ne&&n[L+ce]==n[L+ce-re];++ce);if(ce>K){if(K=ce,le=re,ce>j)break;for(var ge=Math.min(re,ce-2),ye=0,he=0;he<ge;++he){var be=L-re+he&32767,Ae=b[be],$e=be-Ae&32767;$e>ye&&(ye=$e,de=be)}}}J=de,de=b[J],re+=J-de&32767}if(le){F[B++]=268435456|G2[K]<<18|SS[le];var Ue=G2[K]&31,et=SS[le]&31;C+=j0[Ue]+U0[et],++D[257+Ue],++W[et],R=L+K,++k}else F[B++]=n[L],++D[n[L]]}}for(L=Math.max(L,R);L<s;++L)F[B++]=n[L],++D[n[L]];h=CS(n,u,l,F,D,W,C,B,M,L-M,h),l||(o.r=h&7|u[h/8|0]<<3,h-=7,o.h=x,o.p=b,o.i=L,o.w=R)}else{for(var L=o.w||0;L<s+l;L+=65535){var Je=L+65535;Je>=s&&(u[h/8|0]=l,Je=s),h=IT(u,h+1,n.subarray(L,Je))}o.i=s}return CT(a,0,r+dx(h)+i)},kT=function(){var n=1,e=0;return{p:function(t){for(var r=n,i=e,o=t.length|0,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)i+=r+=t[s];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}n=r,e=i},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},Y9=function(n,e,t,r,i){if(!i&&(i={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new Bo(o.length+n.length);s.set(o),s.set(n,o.length),n=s,i.w=o.length}return X9(n,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,r,i)},NT=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},J9=function(n,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=r<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var i=kT();i.p(e.dictionary),NT(n,2,i.d())}},Q9=function(n,e){return((n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31)&&cu(6,"invalid zlib data"),(n[1]>>5&1)==1&&cu(6,"invalid zlib data: "+(n[1]&32?"need":"unexpected")+" dictionary"),(n[1]>>3&4)+2};function X2(n,e){e||(e={});var t=kT();t.p(n);var r=Y9(n,e,e.dictionary?6:2,4);return J9(r,e),NT(r,r.length-4,t.d()),r}function Z9(n,e){return $9(n.subarray(Q9(n),-4),{i:2},e,e)}var eU=typeof TextDecoder<"u"&&new TextDecoder,tU=0;try{eU.decode(TT,{stream:!0}),tU=1}catch{}var Jt=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function jy(){Jt.console&&typeof Jt.console.log=="function"&&Jt.console.log.apply(Jt.console,arguments)}var sr={log:jy,warn:function(n){Jt.console&&(typeof Jt.console.warn=="function"?Jt.console.warn.apply(Jt.console,arguments):jy.call(null,arguments))},error:function(n){Jt.console&&(typeof Jt.console.error=="function"?Jt.console.error.apply(Jt.console,arguments):jy(n))}};function Uy(n,e,t){var r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",r.onload=function(){tf(r.response,e,t)},r.onerror=function(){sr.error("could not download file")},r.send()}function IS(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Qg(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Zp,Y2,tf=Jt.saveAs||((typeof window>"u"?"undefined":tr(window))!=="object"||window!==Jt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var r=Jt.URL||Jt.webkitURL,i=document.createElement("a");e=e||n.name||"download",i.download=e,i.rel="noopener",typeof n=="string"?(i.href=n,i.origin!==location.origin?IS(i.href)?Uy(n,e,t):Qg(i,i.target="_blank"):Qg(i)):(i.href=r.createObjectURL(n),setTimeout((function(){r.revokeObjectURL(i.href)}),4e4),setTimeout((function(){Qg(i)}),0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(IS(n))Uy(n,e,t);else{var r=document.createElement("a");r.href=n,r.target="_blank",setTimeout((function(){Qg(r)}))}else navigator.msSaveOrOpenBlob((function(i,o){return o===void 0?o={autoBom:!1}:tr(o)!=="object"&&(sr.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(n,t),e)}:function(n,e,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof n=="string")return Uy(n,e,t);var i=n.type==="application/octet-stream",o=/constructor/i.test(Jt.HTMLElement)||Jt.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":tr(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var h=a.result;h=s?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=h:location=h,r=null},a.readAsDataURL(n)}else{var u=Jt.URL||Jt.webkitURL,l=u.createObjectURL(n);r?r.location=l:location.href=l,r=null,setTimeout((function(){u.revokeObjectURL(l)}),4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function PT(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],r=0;r<t.length;r++){var i=t[r].re,o=t[r].process,s=i.exec(n);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),u=this.g.toString(16),l=this.b.toString(16);return a.length==1&&(a="0"+a),u.length==1&&(u="0"+u),l.length==1&&(l="0"+l),"#"+a+u+l}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function zy(n,e){var t=n[0],r=n[1],i=n[2],o=n[3];t=Co(t,r,i,o,e[0],7,-680876936),o=Co(o,t,r,i,e[1],12,-389564586),i=Co(i,o,t,r,e[2],17,606105819),r=Co(r,i,o,t,e[3],22,-1044525330),t=Co(t,r,i,o,e[4],7,-176418897),o=Co(o,t,r,i,e[5],12,1200080426),i=Co(i,o,t,r,e[6],17,-1473231341),r=Co(r,i,o,t,e[7],22,-45705983),t=Co(t,r,i,o,e[8],7,1770035416),o=Co(o,t,r,i,e[9],12,-1958414417),i=Co(i,o,t,r,e[10],17,-42063),r=Co(r,i,o,t,e[11],22,-1990404162),t=Co(t,r,i,o,e[12],7,1804603682),o=Co(o,t,r,i,e[13],12,-40341101),i=Co(i,o,t,r,e[14],17,-1502002290),t=Io(t,r=Co(r,i,o,t,e[15],22,1236535329),i,o,e[1],5,-165796510),o=Io(o,t,r,i,e[6],9,-1069501632),i=Io(i,o,t,r,e[11],14,643717713),r=Io(r,i,o,t,e[0],20,-373897302),t=Io(t,r,i,o,e[5],5,-701558691),o=Io(o,t,r,i,e[10],9,38016083),i=Io(i,o,t,r,e[15],14,-660478335),r=Io(r,i,o,t,e[4],20,-405537848),t=Io(t,r,i,o,e[9],5,568446438),o=Io(o,t,r,i,e[14],9,-1019803690),i=Io(i,o,t,r,e[3],14,-187363961),r=Io(r,i,o,t,e[8],20,1163531501),t=Io(t,r,i,o,e[13],5,-1444681467),o=Io(o,t,r,i,e[2],9,-51403784),i=Io(i,o,t,r,e[7],14,1735328473),t=To(t,r=Io(r,i,o,t,e[12],20,-1926607734),i,o,e[5],4,-378558),o=To(o,t,r,i,e[8],11,-2022574463),i=To(i,o,t,r,e[11],16,1839030562),r=To(r,i,o,t,e[14],23,-35309556),t=To(t,r,i,o,e[1],4,-1530992060),o=To(o,t,r,i,e[4],11,1272893353),i=To(i,o,t,r,e[7],16,-155497632),r=To(r,i,o,t,e[10],23,-1094730640),t=To(t,r,i,o,e[13],4,681279174),o=To(o,t,r,i,e[0],11,-358537222),i=To(i,o,t,r,e[3],16,-722521979),r=To(r,i,o,t,e[6],23,76029189),t=To(t,r,i,o,e[9],4,-640364487),o=To(o,t,r,i,e[12],11,-421815835),i=To(i,o,t,r,e[15],16,530742520),t=ko(t,r=To(r,i,o,t,e[2],23,-995338651),i,o,e[0],6,-198630844),o=ko(o,t,r,i,e[7],10,1126891415),i=ko(i,o,t,r,e[14],15,-1416354905),r=ko(r,i,o,t,e[5],21,-57434055),t=ko(t,r,i,o,e[12],6,1700485571),o=ko(o,t,r,i,e[3],10,-1894986606),i=ko(i,o,t,r,e[10],15,-1051523),r=ko(r,i,o,t,e[1],21,-2054922799),t=ko(t,r,i,o,e[8],6,1873313359),o=ko(o,t,r,i,e[15],10,-30611744),i=ko(i,o,t,r,e[6],15,-1560198380),r=ko(r,i,o,t,e[13],21,1309151649),t=ko(t,r,i,o,e[4],6,-145523070),o=ko(o,t,r,i,e[11],10,-1120210379),i=ko(i,o,t,r,e[2],15,718787259),r=ko(r,i,o,t,e[9],21,-343485551),n[0]=Qc(t,n[0]),n[1]=Qc(r,n[1]),n[2]=Qc(i,n[2]),n[3]=Qc(o,n[3])}function z0(n,e,t,r,i,o){return e=Qc(Qc(e,n),Qc(r,o)),Qc(e<<i|e>>>32-i,t)}function Co(n,e,t,r,i,o,s){return z0(e&t|~e&r,n,e,i,o,s)}function Io(n,e,t,r,i,o,s){return z0(e&r|t&~r,n,e,i,o,s)}function To(n,e,t,r,i,o,s){return z0(e^t^r,n,e,i,o,s)}function ko(n,e,t,r,i,o,s){return z0(t^(e|~r),n,e,i,o,s)}function RT(n){var e,t=n.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)zy(r,nU(n.substring(e-64,e)));n=n.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)i[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(zy(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*t,zy(r,i),r}function nU(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}Zp=Jt.atob.bind(Jt),Y2=Jt.btoa.bind(Jt);var TS="0123456789abcdef".split("");function rU(n){for(var e="",t=0;t<4;t++)e+=TS[n>>8*t+4&15]+TS[n>>8*t&15];return e}function iU(n){return String.fromCharCode((255&n)>>0,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function J2(n){return RT(n).map(iU).join("")}var oU=(function(n){for(var e=0;e<n.length;e++)n[e]=rU(n[e]);return n.join("")})(RT("hello"))!="5d41402abc4b2a76b9719d911017c592";function Qc(n,e){if(oU){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Q2(n,e){var t,r,i,o;if(n!==t){for(var s=(i=n,o=1+(256/n.length>>0),new Array(o+1).join(i)),a=[],u=0;u<256;u++)a[u]=u;var l=0;for(u=0;u<256;u++){var h=a[u];l=(l+h+s.charCodeAt(u))%256,a[u]=a[l],a[l]=h}t=n,r=a}else a=r;var d=e.length,p=0,m=0,w="";for(u=0;u<d;u++)m=(m+(h=a[p=(p+1)%256]))%256,a[p]=a[m],a[m]=h,s=a[(a[p]+a[m])%256],w+=String.fromCharCode(e.charCodeAt(u)^s);return w}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var kS={print:4,modify:8,copy:16,"annot-forms":32};function ud(n,e,t,r){this.v=1,this.r=2;var i=192;n.forEach((function(a){if(kS.perm!==void 0)throw new Error("Invalid permission: "+a);i+=kS[a]})),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(e+this.padding).substr(0,32),s=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=J2(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Q2(this.encryptionKey,this.padding)}function ld(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,r=0;r<t;r++){var i=n.charCodeAt(r);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=n[r]}return e}function NS(n){if(tr(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,r,i){if(i=i||!1,typeof t!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var o=Math.random().toString(35);return e[t][o]=[r,!!i],o},this.unsubscribe=function(t){for(var r in e)if(e[r][t])return delete e[r][t],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[t]){var s=e[t][o];try{s[0].apply(n,r)}catch(a){Jt.console&&sr.error("jsPDF PubSub Error",a.message,a)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function t0(n){if(!(this instanceof t0))return new t0(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function DT(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function of(n,e,t,r,i){if(!(this instanceof of))return new of(n,e,t,r,i);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,DT.call(this,r,i)}function wd(n,e,t,r,i){if(!(this instanceof wd))return new wd(n,e,t,r,i);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,DT.call(this,r,i)}function Xt(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],o=arguments[3],s=[],a=1,u=16,l="S",h=null;tr(n=n||{})==="object"&&(t=n.orientation,r=n.unit||r,i=n.format||i,o=n.compress||n.compressPdf||o,(h=n.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),a=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(u=n.floatPrecision),l=n.defaultPathOperation||"S"),s=n.filters||(o===!0?["FlateEncode"]:s),r=r||"mm",t=(""+(t||"P")).toLowerCase();var d=n.putOnlyUsedFonts||!1,p={},m={internal:{},__private__:{}};m.__private__.PubSub=NS;var w="1.3",b=m.__private__.getPdfVersion=function(){return w};m.__private__.setPdfVersion=function(I){w=I};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return x};var E=m.__private__.getPageFormat=function(I){return x[I]};i=i||"a4";var A={COMPAT:"compat",ADVANCED:"advanced"},N=A.COMPAT;function F(){this.saveGraphicsState(),ie(new _t(pt,0,0,-pt,0,Di()*pt).toString()+" cm"),this.setFontSize(this.getFontSize()/pt),l="n",N=A.ADVANCED}function D(){this.restoreGraphicsState(),l="S",N=A.COMPAT}var W=m.__private__.combineFontStyleAndFontWeight=function(I,G){if(I=="bold"&&G=="normal"||I=="bold"&&G==400||I=="normal"&&G=="italic"||I=="bold"&&G=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return G&&(I=G==400||G==="normal"?I==="italic"?"italic":"normal":G!=700&&G!=="bold"||I!=="normal"?(G==700?"bold":G)+""+I:"bold"),I};m.advancedAPI=function(I){var G=N===A.COMPAT;return G&&F.call(this),typeof I!="function"||(I(this),G&&D.call(this)),this},m.compatAPI=function(I){var G=N===A.ADVANCED;return G&&D.call(this),typeof I!="function"||(I(this),G&&F.call(this)),this},m.isAdvancedAPI=function(){return N===A.ADVANCED};var k,C=function(I){if(N!==A.ADVANCED)throw new Error(I+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},L=m.roundToPrecision=m.__private__.roundToPrecision=function(I,G){var me=e||G;if(isNaN(I)||isNaN(me))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return I.toFixed(me).replace(/0+$/,"")};k=m.hpf=m.__private__.hpf=typeof u=="number"?function(I){if(isNaN(I))throw new Error("Invalid argument passed to jsPDF.hpf");return L(I,u)}:u==="smart"?function(I){if(isNaN(I))throw new Error("Invalid argument passed to jsPDF.hpf");return L(I,I>-1&&I<1?16:5)}:function(I){if(isNaN(I))throw new Error("Invalid argument passed to jsPDF.hpf");return L(I,16)};var B=m.f2=m.__private__.f2=function(I){if(isNaN(I))throw new Error("Invalid argument passed to jsPDF.f2");return L(I,2)},R=m.__private__.f3=function(I){if(isNaN(I))throw new Error("Invalid argument passed to jsPDF.f3");return L(I,3)},M=m.scale=m.__private__.scale=function(I){if(isNaN(I))throw new Error("Invalid argument passed to jsPDF.scale");return N===A.COMPAT?I*pt:N===A.ADVANCED?I:void 0},U=function(I){return N===A.COMPAT?Di()-I:N===A.ADVANCED?I:void 0},J=function(I){return M(U(I))};m.__private__.setPrecision=m.setPrecision=function(I){typeof parseInt(I,10)=="number"&&(e=parseInt(I,10))};var de,fe="00000000000000000000000000000000",he=m.__private__.getFileId=function(){return fe},K=m.__private__.setFileId=function(I){return fe=I!==void 0&&/^[a-fA-F0-9]{32}$/.test(I)?I.toUpperCase():fe.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),h!==null&&(Cn=new ud(h.userPermissions,h.userPassword,h.ownerPassword,fe)),fe};m.setFileId=function(I){return K(I),this},m.getFileId=function(){return he()};var le=m.__private__.convertDateToPDFDate=function(I){var G=I.getTimezoneOffset(),me=G<0?"+":"-",we=Math.floor(Math.abs(G/60)),Re=Math.abs(G%60),He=[me,ne(we),"'",ne(Re),"'"].join("");return["D:",I.getFullYear(),ne(I.getMonth()+1),ne(I.getDate()),ne(I.getHours()),ne(I.getMinutes()),ne(I.getSeconds()),He].join("")},se=m.__private__.convertPDFDateToDate=function(I){var G=parseInt(I.substr(2,4),10),me=parseInt(I.substr(6,2),10)-1,we=parseInt(I.substr(8,2),10),Re=parseInt(I.substr(10,2),10),He=parseInt(I.substr(12,2),10),rt=parseInt(I.substr(14,2),10);return new Date(G,me,we,Re,He,rt,0)},re=m.__private__.setCreationDate=function(I){var G;if(I===void 0&&(I=new Date),I instanceof Date)G=le(I);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(I))throw new Error("Invalid argument passed to jsPDF.setCreationDate");G=I}return de=G},j=m.__private__.getCreationDate=function(I){var G=de;return I==="jsDate"&&(G=se(de)),G};m.setCreationDate=function(I){return re(I),this},m.getCreationDate=function(I){return j(I)};var $,ne=m.__private__.padd2=function(I){return("0"+parseInt(I)).slice(-2)},ce=m.__private__.padd2Hex=function(I){return("00"+(I=I.toString())).substr(I.length)},ge=0,ye=[],be=[],Ae=0,$e=[],Ue=[],et=!1,Je=be,Be=function(){ge=0,Ae=0,be=[],ye=[],$e=[],Ns=rr(),ki=rr()};m.__private__.setCustomOutputDestination=function(I){et=!0,Je=I};var _e=function(I){et||(Je=I)};m.__private__.resetCustomOutputDestination=function(){et=!1,Je=be};var ie=m.__private__.out=function(I){return I=I.toString(),Ae+=I.length+1,Je.push(I),Je},ft=m.__private__.write=function(I){return ie(arguments.length===1?I.toString():Array.prototype.join.call(arguments," "))},dt=m.__private__.getArrayBuffer=function(I){for(var G=I.length,me=new ArrayBuffer(G),we=new Uint8Array(me);G--;)we[G]=I.charCodeAt(G);return me},Ze=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return Ze};var at=n.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(I){return at=N===A.ADVANCED?I/pt:I,this};var lt,ct=m.__private__.getFontSize=m.getFontSize=function(){return N===A.COMPAT?at:at*pt},xt=n.R2L||!1;m.__private__.setR2L=m.setR2L=function(I){return xt=I,this},m.__private__.getR2L=m.getR2L=function(){return xt};var Vt,jt=m.__private__.setZoomMode=function(I){var G=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(I))lt=I;else if(isNaN(I)){if(G.indexOf(I)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+I+'" is not recognized.');lt=I}else lt=parseInt(I,10)};m.__private__.getZoomMode=function(){return lt};var Pt,Lt=m.__private__.setPageMode=function(I){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(I)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+I+'" is not recognized.');Vt=I};m.__private__.getPageMode=function(){return Vt};var Yt=m.__private__.setLayoutMode=function(I){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(I)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+I+'" is not recognized.');Pt=I};m.__private__.getLayoutMode=function(){return Pt},m.__private__.setDisplayMode=m.setDisplayMode=function(I,G,me){return jt(I),Yt(G),Lt(me),this};var Ut={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(I){if(Object.keys(Ut).indexOf(I)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ut[I]},m.__private__.getDocumentProperties=function(){return Ut},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(I){for(var G in Ut)Ut.hasOwnProperty(G)&&I[G]&&(Ut[G]=I[G]);return this},m.__private__.setDocumentProperty=function(I,G){if(Object.keys(Ut).indexOf(I)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ut[I]=G};var en,pt,ar,dn,qr,xn={},Gn={},ho=[],gn={},is={},Jn={},yr={},ni=null,Qn=0,Wt=[],En=new NS(m),zo=n.hotfixes||[],Sr={},ri={},fo=[],_t=function I(G,me,we,Re,He,rt){if(!(this instanceof I))return new I(G,me,we,Re,He,rt);isNaN(G)&&(G=1),isNaN(me)&&(me=0),isNaN(we)&&(we=0),isNaN(Re)&&(Re=1),isNaN(He)&&(He=0),isNaN(rt)&&(rt=0),this._matrix=[G,me,we,Re,He,rt]};Object.defineProperty(_t.prototype,"sx",{get:function(){return this._matrix[0]},set:function(I){this._matrix[0]=I}}),Object.defineProperty(_t.prototype,"shy",{get:function(){return this._matrix[1]},set:function(I){this._matrix[1]=I}}),Object.defineProperty(_t.prototype,"shx",{get:function(){return this._matrix[2]},set:function(I){this._matrix[2]=I}}),Object.defineProperty(_t.prototype,"sy",{get:function(){return this._matrix[3]},set:function(I){this._matrix[3]=I}}),Object.defineProperty(_t.prototype,"tx",{get:function(){return this._matrix[4]},set:function(I){this._matrix[4]=I}}),Object.defineProperty(_t.prototype,"ty",{get:function(){return this._matrix[5]},set:function(I){this._matrix[5]=I}}),Object.defineProperty(_t.prototype,"a",{get:function(){return this._matrix[0]},set:function(I){this._matrix[0]=I}}),Object.defineProperty(_t.prototype,"b",{get:function(){return this._matrix[1]},set:function(I){this._matrix[1]=I}}),Object.defineProperty(_t.prototype,"c",{get:function(){return this._matrix[2]},set:function(I){this._matrix[2]=I}}),Object.defineProperty(_t.prototype,"d",{get:function(){return this._matrix[3]},set:function(I){this._matrix[3]=I}}),Object.defineProperty(_t.prototype,"e",{get:function(){return this._matrix[4]},set:function(I){this._matrix[4]=I}}),Object.defineProperty(_t.prototype,"f",{get:function(){return this._matrix[5]},set:function(I){this._matrix[5]=I}}),Object.defineProperty(_t.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(_t.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(_t.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(_t.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),_t.prototype.join=function(I){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(k).join(I)},_t.prototype.multiply=function(I){var G=I.sx*this.sx+I.shy*this.shx,me=I.sx*this.shy+I.shy*this.sy,we=I.shx*this.sx+I.sy*this.shx,Re=I.shx*this.shy+I.sy*this.sy,He=I.tx*this.sx+I.ty*this.shx+this.tx,rt=I.tx*this.shy+I.ty*this.sy+this.ty;return new _t(G,me,we,Re,He,rt)},_t.prototype.decompose=function(){var I=this.sx,G=this.shy,me=this.shx,we=this.sy,Re=this.tx,He=this.ty,rt=Math.sqrt(I*I+G*G),mt=(I/=rt)*me+(G/=rt)*we;me-=I*mt,we-=G*mt;var y=Math.sqrt(me*me+we*we);return mt/=y,I*(we/=y)<G*(me/=y)&&(I=-I,G=-G,mt=-mt,rt=-rt),{scale:new _t(rt,0,0,y,0,0),translate:new _t(1,0,0,1,Re,He),rotate:new _t(I,G,-G,I,0,0),skew:new _t(1,0,mt,1,0,0)}},_t.prototype.toString=function(I){return this.join(" ")},_t.prototype.inversed=function(){var I=this.sx,G=this.shy,me=this.shx,we=this.sy,Re=this.tx,He=this.ty,rt=1/(I*we-G*me),mt=we*rt,y=-G*rt,O=-me*rt,q=I*rt;return new _t(mt,y,O,q,-mt*Re-O*He,-y*Re-q*He)},_t.prototype.applyToPoint=function(I){var G=I.x*this.sx+I.y*this.shx+this.tx,me=I.x*this.shy+I.y*this.sy+this.ty;return new Ko(G,me)},_t.prototype.applyToRectangle=function(I){var G=this.applyToPoint(I),me=this.applyToPoint(new Ko(I.x+I.w,I.y+I.h));return new Vs(G.x,G.y,me.x-G.x,me.y-G.y)},_t.prototype.clone=function(){var I=this.sx,G=this.shy,me=this.shx,we=this.sy,Re=this.tx,He=this.ty;return new _t(I,G,me,we,Re,He)},m.Matrix=_t;var Ti=m.matrixMult=function(I,G){return G.multiply(I)},Lr=new _t(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=Lr;var Mr=function(I,G){if(!is[I]){var me=(G instanceof of?"Sh":"P")+(Object.keys(gn).length+1).toString(10);G.id=me,is[I]=me,gn[me]=G,En.publish("addPattern",G)}};m.ShadingPattern=of,m.TilingPattern=wd,m.addShadingPattern=function(I,G){return C("addShadingPattern()"),Mr(I,G),this},m.beginTilingPattern=function(I){C("beginTilingPattern()"),ku(I.boundingBox[0],I.boundingBox[1],I.boundingBox[2]-I.boundingBox[0],I.boundingBox[3]-I.boundingBox[1],I.matrix)},m.endTilingPattern=function(I,G){C("endTilingPattern()"),G.stream=Ue[$].join(`
`),Mr(I,G),En.publish("endTilingPattern",G),fo.pop().restore()};var nr=m.__private__.newObject=function(){var I=rr();return cr(I,!0),I},rr=m.__private__.newObjectDeferred=function(){return ge++,ye[ge]=function(){return Ae},ge},cr=function(I,G){return G=typeof G=="boolean"&&G,ye[I]=Ae,G&&ie(I+" 0 obj"),I},ia=m.__private__.newAdditionalObject=function(){var I={objId:rr(),content:""};return $e.push(I),I},Ns=rr(),ki=rr(),po=m.__private__.decodeColorString=function(I){var G=I.split(" ");if(G.length!==2||G[1]!=="g"&&G[1]!=="G")G.length===5&&(G[4]==="k"||G[4]==="K")&&(G=[(1-G[0])*(1-G[3]),(1-G[1])*(1-G[3]),(1-G[2])*(1-G[3]),"r"]);else{var me=parseFloat(G[0]);G=[me,me,me,"r"]}for(var we="#",Re=0;Re<3;Re++)we+=("0"+Math.floor(255*parseFloat(G[Re])).toString(16)).slice(-2);return we},Ar=m.__private__.encodeColorString=function(I){var G;typeof I=="string"&&(I={ch1:I});var me=I.ch1,we=I.ch2,Re=I.ch3,He=I.ch4,rt=I.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof me=="string"&&me.charAt(0)!=="#"){var mt=new PT(me);if(mt.ok)me=mt.toHex();else if(!/^\d*\.?\d*$/.test(me))throw new Error('Invalid color "'+me+'" passed to jsPDF.encodeColorString.')}if(typeof me=="string"&&/^#[0-9A-Fa-f]{3}$/.test(me)&&(me="#"+me[1]+me[1]+me[2]+me[2]+me[3]+me[3]),typeof me=="string"&&/^#[0-9A-Fa-f]{6}$/.test(me)){var y=parseInt(me.substr(1),16);me=y>>16&255,we=y>>8&255,Re=255&y}if(we===void 0||He===void 0&&me===we&&we===Re)if(typeof me=="string")G=me+" "+rt[0];else switch(I.precision){case 2:G=B(me/255)+" "+rt[0];break;case 3:default:G=R(me/255)+" "+rt[0]}else if(He===void 0||tr(He)==="object"){if(He&&!isNaN(He.a)&&He.a===0)return G=["1.","1.","1.",rt[1]].join(" ");if(typeof me=="string")G=[me,we,Re,rt[1]].join(" ");else switch(I.precision){case 2:G=[B(me/255),B(we/255),B(Re/255),rt[1]].join(" ");break;default:case 3:G=[R(me/255),R(we/255),R(Re/255),rt[1]].join(" ")}}else if(typeof me=="string")G=[me,we,Re,He,rt[2]].join(" ");else switch(I.precision){case 2:G=[B(me),B(we),B(Re),B(He),rt[2]].join(" ");break;case 3:default:G=[R(me),R(we),R(Re),R(He),rt[2]].join(" ")}return G},Ni=m.__private__.getFilters=function(){return s},wr=m.__private__.putStream=function(I){var G=(I=I||{}).data||"",me=I.filters||Ni(),we=I.alreadyAppliedFilters||[],Re=I.addLength1||!1,He=G.length,rt=I.objectId,mt=function(on){return on};if(h!==null&&rt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(mt=Cn.encryptor(rt,0));var y={};me===!0&&(me=["FlateEncode"]);var O=I.additionalKeyValues||[],q=(y=Xt.API.processDataByFilters!==void 0?Xt.API.processDataByFilters(G,me):{data:G,reverseChain:[]}).reverseChain+(Array.isArray(we)?we.join(" "):we.toString());if(y.data.length!==0&&(O.push({key:"Length",value:y.data.length}),Re===!0&&O.push({key:"Length1",value:He})),q.length!=0)if(q.split("/").length-1==1)O.push({key:"Filter",value:q});else{O.push({key:"Filter",value:"["+q+"]"});for(var ee=0;ee<O.length;ee+=1)if(O[ee].key==="DecodeParms"){for(var Ne=[],Fe=0;Fe<y.reverseChain.split("/").length-1;Fe+=1)Ne.push("null");Ne.push(O[ee].value),O[ee].value="["+Ne.join(" ")+"]"}}ie("<<");for(var it=0;it<O.length;it++)ie("/"+O[it].key+" "+O[it].value);ie(">>"),y.data.length!==0&&(ie("stream"),ie(mt(y.data)),ie("endstream"))},Wo=m.__private__.putPage=function(I){var G=I.number,me=I.data,we=I.objId,Re=I.contentsObjId;cr(we,!0),ie("<</Type /Page"),ie("/Parent "+I.rootDictionaryObjId+" 0 R"),ie("/Resources "+I.resourceDictionaryObjId+" 0 R"),ie("/MediaBox ["+parseFloat(k(I.mediaBox.bottomLeftX))+" "+parseFloat(k(I.mediaBox.bottomLeftY))+" "+k(I.mediaBox.topRightX)+" "+k(I.mediaBox.topRightY)+"]"),I.cropBox!==null&&ie("/CropBox ["+k(I.cropBox.bottomLeftX)+" "+k(I.cropBox.bottomLeftY)+" "+k(I.cropBox.topRightX)+" "+k(I.cropBox.topRightY)+"]"),I.bleedBox!==null&&ie("/BleedBox ["+k(I.bleedBox.bottomLeftX)+" "+k(I.bleedBox.bottomLeftY)+" "+k(I.bleedBox.topRightX)+" "+k(I.bleedBox.topRightY)+"]"),I.trimBox!==null&&ie("/TrimBox ["+k(I.trimBox.bottomLeftX)+" "+k(I.trimBox.bottomLeftY)+" "+k(I.trimBox.topRightX)+" "+k(I.trimBox.topRightY)+"]"),I.artBox!==null&&ie("/ArtBox ["+k(I.artBox.bottomLeftX)+" "+k(I.artBox.bottomLeftY)+" "+k(I.artBox.topRightX)+" "+k(I.artBox.topRightY)+"]"),typeof I.userUnit=="number"&&I.userUnit!==1&&ie("/UserUnit "+I.userUnit),En.publish("putPage",{objId:we,pageContext:Wt[G],pageNumber:G,page:me}),ie("/Contents "+Re+" 0 R"),ie(">>"),ie("endobj");var He=me.join(`
`);return N===A.ADVANCED&&(He+=`
Q`),cr(Re,!0),wr({data:He,filters:Ni(),objectId:Re}),ie("endobj"),we},Ps=m.__private__.putPages=function(){var I,G,me=[];for(I=1;I<=Qn;I++)Wt[I].objId=rr(),Wt[I].contentsObjId=rr();for(I=1;I<=Qn;I++)me.push(Wo({number:I,data:Ue[I],objId:Wt[I].objId,contentsObjId:Wt[I].contentsObjId,mediaBox:Wt[I].mediaBox,cropBox:Wt[I].cropBox,bleedBox:Wt[I].bleedBox,trimBox:Wt[I].trimBox,artBox:Wt[I].artBox,userUnit:Wt[I].userUnit,rootDictionaryObjId:Ns,resourceDictionaryObjId:ki}));cr(Ns,!0),ie("<</Type /Pages");var we="/Kids [";for(G=0;G<Qn;G++)we+=me[G]+" 0 R ";ie(we+"]"),ie("/Count "+Qn),ie(">>"),ie("endobj"),En.publish("postPutPages")},Rs=function(I){En.publish("putFont",{font:I,out:ie,newObject:nr,putStream:wr}),I.isAlreadyPutted!==!0&&(I.objectNumber=nr(),ie("<<"),ie("/Type /Font"),ie("/BaseFont /"+ld(I.postScriptName)),ie("/Subtype /Type1"),typeof I.encoding=="string"&&ie("/Encoding /"+I.encoding),ie("/FirstChar 32"),ie("/LastChar 255"),ie(">>"),ie("endobj"))},Ds=function(){for(var I in xn)xn.hasOwnProperty(I)&&(d===!1||d===!0&&p.hasOwnProperty(I))&&Rs(xn[I])},oa=function(I){I.objectNumber=nr();var G=[];G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Form"}),G.push({key:"BBox",value:"["+[k(I.x),k(I.y),k(I.x+I.width),k(I.y+I.height)].join(" ")+"]"}),G.push({key:"Matrix",value:"["+I.matrix.toString()+"]"});var me=I.pages[1].join(`
`);wr({data:me,additionalKeyValues:G,objectId:I.objectNumber}),ie("endobj")},La=function(){for(var I in Sr)Sr.hasOwnProperty(I)&&oa(Sr[I])},ic=function(I,G){var me,we=[],Re=1/(G-1);for(me=0;me<1;me+=Re)we.push(me);if(we.push(1),I[0].offset!=0){var He={offset:0,color:I[0].color};I.unshift(He)}if(I[I.length-1].offset!=1){var rt={offset:1,color:I[I.length-1].color};I.push(rt)}for(var mt="",y=0,O=0;O<we.length;O++){for(me=we[O];me>I[y+1].offset;)y++;var q=I[y].offset,ee=(me-q)/(I[y+1].offset-q),Ne=I[y].color,Fe=I[y+1].color;mt+=ce(Math.round((1-ee)*Ne[0]+ee*Fe[0]).toString(16))+ce(Math.round((1-ee)*Ne[1]+ee*Fe[1]).toString(16))+ce(Math.round((1-ee)*Ne[2]+ee*Fe[2]).toString(16))}return mt.trim()},$n=function(I,G){G||(G=21);var me=nr(),we=ic(I.colors,G),Re=[];Re.push({key:"FunctionType",value:"0"}),Re.push({key:"Domain",value:"[0.0 1.0]"}),Re.push({key:"Size",value:"["+G+"]"}),Re.push({key:"BitsPerSample",value:"8"}),Re.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Re.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),wr({data:we,additionalKeyValues:Re,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:me}),ie("endobj"),I.objectNumber=nr(),ie("<< /ShadingType "+I.type),ie("/ColorSpace /DeviceRGB");var He="/Coords ["+k(parseFloat(I.coords[0]))+" "+k(parseFloat(I.coords[1]))+" ";I.type===2?He+=k(parseFloat(I.coords[2]))+" "+k(parseFloat(I.coords[3])):He+=k(parseFloat(I.coords[2]))+" "+k(parseFloat(I.coords[3]))+" "+k(parseFloat(I.coords[4]))+" "+k(parseFloat(I.coords[5])),ie(He+="]"),I.matrix&&ie("/Matrix ["+I.matrix.toString()+"]"),ie("/Function "+me+" 0 R"),ie("/Extend [true true]"),ie(">>"),ie("endobj")},oc=function(I,G){var me=rr(),we=nr();G.push({resourcesOid:me,objectOid:we}),I.objectNumber=we;var Re=[];Re.push({key:"Type",value:"/Pattern"}),Re.push({key:"PatternType",value:"1"}),Re.push({key:"PaintType",value:"1"}),Re.push({key:"TilingType",value:"1"}),Re.push({key:"BBox",value:"["+I.boundingBox.map(k).join(" ")+"]"}),Re.push({key:"XStep",value:k(I.xStep)}),Re.push({key:"YStep",value:k(I.yStep)}),Re.push({key:"Resources",value:me+" 0 R"}),I.matrix&&Re.push({key:"Matrix",value:"["+I.matrix.toString()+"]"}),wr({data:I.stream,additionalKeyValues:Re,objectId:I.objectNumber}),ie("endobj")},os=function(I){var G;for(G in gn)gn.hasOwnProperty(G)&&(gn[G]instanceof of?$n(gn[G]):gn[G]instanceof wd&&oc(gn[G],I))},Ls=function(I){for(var G in I.objectNumber=nr(),ie("<<"),I)switch(G){case"opacity":ie("/ca "+B(I[G]));break;case"stroke-opacity":ie("/CA "+B(I[G]))}ie(">>"),ie("endobj")},mo=function(){var I;for(I in Jn)Jn.hasOwnProperty(I)&&Ls(Jn[I])},Ma=function(){for(var I in ie("/XObject <<"),Sr)Sr.hasOwnProperty(I)&&Sr[I].objectNumber>=0&&ie("/"+I+" "+Sr[I].objectNumber+" 0 R");En.publish("putXobjectDict"),ie(">>")},sc=function(){Cn.oid=nr(),ie("<<"),ie("/Filter /Standard"),ie("/V "+Cn.v),ie("/R "+Cn.r),ie("/U <"+Cn.toHexString(Cn.U)+">"),ie("/O <"+Cn.toHexString(Cn.O)+">"),ie("/P "+Cn.P),ie(">>"),ie("endobj")},sa=function(){for(var I in ie("/Font <<"),xn)xn.hasOwnProperty(I)&&(d===!1||d===!0&&p.hasOwnProperty(I))&&ie("/"+I+" "+xn[I].objectNumber+" 0 R");ie(">>")},Gi=function(){if(Object.keys(gn).length>0){for(var I in ie("/Shading <<"),gn)gn.hasOwnProperty(I)&&gn[I]instanceof of&&gn[I].objectNumber>=0&&ie("/"+I+" "+gn[I].objectNumber+" 0 R");En.publish("putShadingPatternDict"),ie(">>")}},Fa=function(I){if(Object.keys(gn).length>0){for(var G in ie("/Pattern <<"),gn)gn.hasOwnProperty(G)&&gn[G]instanceof m.TilingPattern&&gn[G].objectNumber>=0&&gn[G].objectNumber<I&&ie("/"+G+" "+gn[G].objectNumber+" 0 R");En.publish("putTilingPatternDict"),ie(">>")}},ci=function(){if(Object.keys(Jn).length>0){var I;for(I in ie("/ExtGState <<"),Jn)Jn.hasOwnProperty(I)&&Jn[I].objectNumber>=0&&ie("/"+I+" "+Jn[I].objectNumber+" 0 R");En.publish("putGStateDict"),ie(">>")}},ir=function(I){cr(I.resourcesOid,!0),ie("<<"),ie("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),sa(),Gi(),Fa(I.objectOid),ci(),Ma(),ie(">>"),ie("endobj")},ml=function(){var I=[];Ds(),mo(),La(),os(I),En.publish("putResources"),I.forEach(ir),ir({resourcesOid:ki,objectOid:Number.MAX_SAFE_INTEGER}),En.publish("postPutResources")},gl=function(){En.publish("putAdditionalObjects");for(var I=0;I<$e.length;I++){var G=$e[I];cr(G.objId,!0),ie(G.content),ie("endobj")}En.publish("postPutAdditionalObjects")},Oa=function(I){Gn[I.fontName]=Gn[I.fontName]||{},Gn[I.fontName][I.fontStyle]=I.id},aa=function(I,G,me,we,Re){var He={id:"F"+(Object.keys(xn).length+1).toString(10),postScriptName:I,fontName:G,fontStyle:me,encoding:we,isStandardFont:Re||!1,metadata:{}};return En.publish("addFont",{font:He,instance:this}),xn[He.id]=He,Oa(He),He.id},ua=function(I){for(var G=0,me=Ze.length;G<me;G++){var we=aa.call(this,I[G][0],I[G][1],I[G][2],Ze[G][3],!0);d===!1&&(p[we]=!0);var Re=I[G][0].split("-");Oa({id:we,fontName:Re[0],fontStyle:Re[1]||""})}En.publish("addFonts",{fonts:xn,dictionary:Gn})},hi=function(I){return I.foo=function(){try{return I.apply(this,arguments)}catch(we){var G=we.stack||"";~G.indexOf(" at ")&&(G=G.split(" at ")[1]);var me="Error in function "+G.split(`
`)[0].split("<")[0]+": "+we.message;if(!Jt.console)throw new Error(me);Jt.console.error(me,we),Jt.alert&&alert(me)}},I.foo.bar=I,I.foo},Su=function(I,G){var me,we,Re,He,rt,mt,y,O,q;if(Re=(G=G||{}).sourceEncoding||"Unicode",rt=G.outputEncoding,(G.autoencode||rt)&&xn[en].metadata&&xn[en].metadata[Re]&&xn[en].metadata[Re].encoding&&(He=xn[en].metadata[Re].encoding,!rt&&xn[en].encoding&&(rt=xn[en].encoding),!rt&&He.codePages&&(rt=He.codePages[0]),typeof rt=="string"&&(rt=He[rt]),rt)){for(y=!1,mt=[],me=0,we=I.length;me<we;me++)(O=rt[I.charCodeAt(me)])?mt.push(String.fromCharCode(O)):mt.push(I[me]),mt[me].charCodeAt(0)>>8&&(y=!0);I=mt.join("")}for(me=I.length;y===void 0&&me!==0;)I.charCodeAt(me-1)>>8&&(y=!0),me--;if(!y)return I;for(mt=G.noBOM?[]:[254,255],me=0,we=I.length;me<we;me++){if((q=(O=I.charCodeAt(me))>>8)>>8)throw new Error("Character at position "+me+" of string '"+I+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");mt.push(q),mt.push(O-(q<<8))}return String.fromCharCode.apply(void 0,mt)},br=m.__private__.pdfEscape=m.pdfEscape=function(I,G){return Su(I,G).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},fi=m.__private__.beginPage=function(I){Ue[++Qn]=[],Wt[Qn]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(I[0]),topRightY:Number(I[1])}},Ms(Qn),_e(Ue[$])},la=function(I,G){var me,we,Re;switch(t=G||t,typeof I=="string"&&(me=E(I.toLowerCase()),Array.isArray(me)&&(we=me[0],Re=me[1])),Array.isArray(I)&&(we=I[0]*pt,Re=I[1]*pt),isNaN(we)&&(we=i[0],Re=i[1]),(we>14400||Re>14400)&&(sr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),we=Math.min(14400,we),Re=Math.min(14400,Re)),i=[we,Re],t.substr(0,1)){case"l":Re>we&&(i=[Re,we]);break;case"p":we>Re&&(i=[Re,we])}fi(i),pa(yl),ie(Fr),bl!==0&&ie(bl+" J"),ma!==0&&ie(ma+" j"),En.publish("addPage",{pageNumber:Qn})},ca=function(I){I>0&&I<=Qn&&(Ue.splice(I,1),Wt.splice(I,1),Qn--,$>Qn&&($=Qn),this.setPage($))},Ms=function(I){I>0&&I<=Qn&&($=I)},jn=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Ue.length-1},Fs=function(I,G,me){var we,Re=void 0;return me=me||{},I=I!==void 0?I:xn[en].fontName,G=G!==void 0?G:xn[en].fontStyle,we=I.toLowerCase(),Gn[we]!==void 0&&Gn[we][G]!==void 0?Re=Gn[we][G]:Gn[I]!==void 0&&Gn[I][G]!==void 0?Re=Gn[I][G]:me.disableWarning===!1&&sr.warn("Unable to look up font label for font '"+I+"', '"+G+"'. Refer to getFontList() for available fonts."),Re||me.noFallback||(Re=Gn.times[G])==null&&(Re=Gn.times.normal),Re},mn=m.__private__.putInfo=function(){var I=nr(),G=function(we){return we};for(var me in h!==null&&(G=Cn.encryptor(I,0)),ie("<<"),ie("/Producer ("+br(G("jsPDF "+Xt.version))+")"),Ut)Ut.hasOwnProperty(me)&&Ut[me]&&ie("/"+me.substr(0,1).toUpperCase()+me.substr(1)+" ("+br(G(Ut[me]))+")");ie("/CreationDate ("+br(G(de))+")"),ie(">>"),ie("endobj")},ss=m.__private__.putCatalog=function(I){var G=(I=I||{}).rootDictionaryObjId||Ns;switch(nr(),ie("<<"),ie("/Type /Catalog"),ie("/Pages "+G+" 0 R"),lt||(lt="fullwidth"),lt){case"fullwidth":ie("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ie("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ie("/OpenAction [3 0 R /Fit]");break;case"original":ie("/OpenAction [3 0 R /XYZ null null 1]");break;default:var me=""+lt;me.substr(me.length-1)==="%"&&(lt=parseInt(lt)/100),typeof lt=="number"&&ie("/OpenAction [3 0 R /XYZ null null "+B(lt)+"]")}switch(Pt||(Pt="continuous"),Pt){case"continuous":ie("/PageLayout /OneColumn");break;case"single":ie("/PageLayout /SinglePage");break;case"two":case"twoleft":ie("/PageLayout /TwoColumnLeft");break;case"tworight":ie("/PageLayout /TwoColumnRight")}Vt&&ie("/PageMode /"+Vt),En.publish("putCatalog"),ie(">>"),ie("endobj")},ac=m.__private__.putTrailer=function(){ie("trailer"),ie("<<"),ie("/Size "+(ge+1)),ie("/Root "+ge+" 0 R"),ie("/Info "+(ge-1)+" 0 R"),h!==null&&ie("/Encrypt "+Cn.oid+" 0 R"),ie("/ID [ <"+fe+"> <"+fe+"> ]"),ie(">>")},Au=m.__private__.putHeader=function(){ie("%PDF-"+w),ie("%")},uc=m.__private__.putXRef=function(){var I="0000000000";ie("xref"),ie("0 "+(ge+1)),ie("0000000000 65535 f ");for(var G=1;G<=ge;G++)typeof ye[G]=="function"?ie((I+ye[G]()).slice(-10)+" 00000 n "):ye[G]!==void 0?ie((I+ye[G]).slice(-10)+" 00000 n "):ie("0000000000 00000 n ")},as=m.__private__.buildDocument=function(){Be(),_e(be),En.publish("buildDocument"),Au(),Ps(),gl(),ml(),h!==null&&sc(),mn(),ss();var I=Ae;return uc(),ac(),ie("startxref"),ie(""+I),ie("%%EOF"),_e(Ue[$]),be.join(`
`)},Ba=m.__private__.getBlob=function(I){return new Blob([dt(I)],{type:"application/pdf"})},ha=m.output=m.__private__.output=hi((function(I,G){switch(typeof(G=G||{})=="string"?G={filename:G}:G.filename=G.filename||"generated.pdf",I){case void 0:return as();case"save":m.save(G.filename);break;case"arraybuffer":return dt(as());case"blob":return Ba(as());case"bloburi":case"bloburl":if(Jt.URL!==void 0&&typeof Jt.URL.createObjectURL=="function")return Jt.URL&&Jt.URL.createObjectURL(Ba(as()))||void 0;sr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var me="",we=as();try{me=Y2(we)}catch{me=Y2(unescape(encodeURIComponent(we)))}return"data:application/pdf;filename="+G.filename+";base64,"+me;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Jt)==="[object Window]"){var Re="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",He=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';G.pdfObjectUrl&&(Re=G.pdfObjectUrl,He="");var rt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Re+'"'+He+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(G)+");<\/script></body></html>",mt=Jt.open();return mt!==null&&mt.document.write(rt),mt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Jt)==="[object Window]"){var y='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(G.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+G.filename+'" width="500px" height="400px" /></body></html>',O=Jt.open();if(O!==null){O.document.write(y);var q=this;O.document.documentElement.querySelector("#pdfViewer").onload=function(){O.document.title=G.filename,O.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(q.output("bloburl"))}}return O}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Jt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ee='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",G)+'"></iframe></body></html>',Ne=Jt.open();if(Ne!==null&&(Ne.document.write(ee),Ne.document.title=G.filename),Ne||typeof safari>"u")return Ne;break;case"datauri":case"dataurl":return Jt.document.location.href=this.output("datauristring",G);default:return null}})),qo=function(I){return Array.isArray(zo)===!0&&zo.indexOf(I)>-1};switch(r){case"pt":pt=1;break;case"mm":pt=72/25.4;break;case"cm":pt=72/2.54;break;case"in":pt=72;break;case"px":pt=qo("px_scaling")==1?.75:96/72;break;case"pc":case"em":pt=12;break;case"ex":pt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);pt=r}var Cn=null;re(),K();var Ho=function(I){return h!==null?Cn.encryptor(I,0):function(G){return G}},go=m.__private__.getPageInfo=m.getPageInfo=function(I){if(isNaN(I)||I%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Wt[I].objId,pageNumber:I,pageContext:Wt[I]}},Ht=m.__private__.getPageInfoByObjId=function(I){if(isNaN(I)||I%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var G in Wt)if(Wt[G].objId===I)break;return go(G)},vo=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:Wt[$].objId,pageNumber:$,pageContext:Wt[$]}};m.addPage=function(){return la.apply(this,arguments),this},m.setPage=function(){return Ms.apply(this,arguments),_e.call(this,Ue[$]),this},m.insertPage=function(I){return this.addPage(),this.movePage($,I),this},m.movePage=function(I,G){var me,we;if(I>G){me=Ue[I],we=Wt[I];for(var Re=I;Re>G;Re--)Ue[Re]=Ue[Re-1],Wt[Re]=Wt[Re-1];Ue[G]=me,Wt[G]=we,this.setPage(G)}else if(I<G){me=Ue[I],we=Wt[I];for(var He=I;He<G;He++)Ue[He]=Ue[He+1],Wt[He]=Wt[He+1];Ue[G]=me,Wt[G]=we,this.setPage(G)}return this},m.deletePage=function(){return ca.apply(this,arguments),this},m.__private__.text=m.text=function(I,G,me,we,Re){var He,rt,mt,y,O,q,ee,Ne,Fe,it=(we=we||{}).scope||this;if(typeof I=="number"&&typeof G=="number"&&(typeof me=="string"||Array.isArray(me))){var on=me;me=G,G=I,I=on}if(arguments[3]instanceof _t?(C("The transform parameter of text() with a Matrix value"),Fe=Re):(mt=arguments[4],y=arguments[5],tr(ee=arguments[3])==="object"&&ee!==null||(typeof mt=="string"&&(y=mt,mt=null),typeof ee=="string"&&(y=ee,ee=null),typeof ee=="number"&&(mt=ee,ee=null),we={flags:ee,angle:mt,align:y})),isNaN(G)||isNaN(me)||I==null)throw new Error("Invalid arguments passed to jsPDF.text");if(I.length===0)return it;var vn="",sn=!1,Fn=typeof we.lineHeightFactor=="number"?we.lineHeightFactor:Mn,Un=it.internal.scaleFactor;function Xi(Zn){return Zn=Zn.split("	").join(Array(we.TabLen||9).join(" ")),br(Zn,ee)}function mi(Zn){for(var zn,Er=Zn.concat(),Or=[],wa=Er.length;wa--;)typeof(zn=Er.shift())=="string"?Or.push(zn):Array.isArray(Zn)&&(zn.length===1||zn[1]===void 0&&zn[2]===void 0)?Or.push(zn[0]):Or.push([zn[0],zn[1],zn[2]]);return Or}function Us(Zn,zn){var Er;if(typeof Zn=="string")Er=zn(Zn)[0];else if(Array.isArray(Zn)){for(var Or,wa,bc=Zn.concat(),Il=[],Rh=bc.length;Rh--;)typeof(Or=bc.shift())=="string"?Il.push(zn(Or)[0]):Array.isArray(Or)&&typeof Or[0]=="string"&&(wa=zn(Or[0],Or[1],Or[2]),Il.push([wa[0],wa[1],wa[2]]));Er=Il}return Er}var zs=!1,hc=!0;if(typeof I=="string")zs=!0;else if(Array.isArray(I)){var fc=I.concat();rt=[];for(var xl,_r=fc.length;_r--;)(typeof(xl=fc.shift())!="string"||Array.isArray(xl)&&typeof xl[0]!="string")&&(hc=!1);zs=hc}if(zs===!1)throw new Error('Type of text must be string or Array. "'+I+'" is not recognized.');typeof I=="string"&&(I=I.match(/[\r?\n]/)?I.split(/\r\n|\r|\n/g):[I]);var dc=at/it.internal.scaleFactor,pc=dc*(Fn-1);switch(we.baseline){case"bottom":me-=pc;break;case"top":me+=dc-pc;break;case"hanging":me+=dc-2*pc;break;case"middle":me+=dc/2-pc}if((q=we.maxWidth||0)>0&&(typeof I=="string"?I=it.splitTextToSize(I,q):Object.prototype.toString.call(I)==="[object Array]"&&(I=I.reduce((function(Zn,zn){return Zn.concat(it.splitTextToSize(zn,q))}),[]))),He={text:I,x:G,y:me,options:we,mutex:{pdfEscape:br,activeFontKey:en,fonts:xn,activeFontSize:at}},En.publish("preProcessText",He),I=He.text,mt=(we=He.options).angle,!(Fe instanceof _t)&&mt&&typeof mt=="number"){mt*=Math.PI/180,we.rotationDirection===0&&(mt=-mt),N===A.ADVANCED&&(mt=-mt);var mc=Math.cos(mt),gc=Math.sin(mt);Fe=new _t(mc,gc,-gc,mc,0,0)}else mt&&mt instanceof _t&&(Fe=mt);N!==A.ADVANCED||Fe||(Fe=Lr),(O=we.charSpace||Bs)!==void 0&&(vn+=k(M(O))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ne=we.horizontalScale)!==void 0&&(vn+=k(100*Ne)+` Tz
`),we.lang;var Yi=-1,_l=we.renderingMode!==void 0?we.renderingMode:we.stroke,za=it.internal.getCurrentPageInfo().pageContext;switch(_l){case 0:case!1:case"fill":Yi=0;break;case 1:case!0:case"stroke":Yi=1;break;case 2:case"fillThenStroke":Yi=2;break;case 3:case"invisible":Yi=3;break;case 4:case"fillAndAddForClipping":Yi=4;break;case 5:case"strokeAndAddPathForClipping":Yi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Yi=6;break;case 7:case"addToPathForClipping":Yi=7}var Pf=za.usedRenderingMode!==void 0?za.usedRenderingMode:-1;Yi!==-1?vn+=Yi+` Tr
`:Pf!==-1&&(vn+=`0 Tr
`),Yi!==-1&&(za.usedRenderingMode=Yi),y=we.align||"left";var Ji,vc=at*Fn,Nh=it.internal.pageSize.getWidth(),yc=xn[en];O=we.charSpace||Bs,q=we.maxWidth||0,ee=Object.assign({autoencode:!0,noBOM:!0},we.flags);var va=[],Ru=function(Zn){return it.getStringUnitWidth(Zn,{font:yc,charSpace:O,fontSize:at,doKerning:!1})*at/Un};if(Object.prototype.toString.call(I)==="[object Array]"){var Qi;rt=mi(I),y!=="left"&&(Ji=rt.map(Ru));var Li,Du=0;if(y==="right"){G-=Ji[0],I=[],_r=rt.length;for(var Wa=0;Wa<_r;Wa++)Wa===0?(Li=Ki(G),Qi=xr(me)):(Li=M(Du-Ji[Wa]),Qi=-vc),I.push([rt[Wa],Li,Qi]),Du=Ji[Wa]}else if(y==="center"){G-=Ji[0]/2,I=[],_r=rt.length;for(var qa=0;qa<_r;qa++)qa===0?(Li=Ki(G),Qi=xr(me)):(Li=M((Du-Ji[qa])/2),Qi=-vc),I.push([rt[qa],Li,Qi]),Du=Ji[qa]}else if(y==="left"){I=[],_r=rt.length;for(var wc=0;wc<_r;wc++)I.push(rt[wc])}else if(y==="justify"&&yc.encoding==="Identity-H"){I=[],_r=rt.length,q=q!==0?q:Nh;for(var Ha=0,Rn=0;Rn<_r;Rn++)if(Qi=Rn===0?xr(me):-vc,Li=Rn===0?Ki(G):Ha,Rn<_r-1){var Ga=M((q-Ji[Rn])/(rt[Rn].split(" ").length-1)),Mi=rt[Rn].split(" ");I.push([Mi[0]+" ",Li,Qi]),Ha=0;for(var Xo=1;Xo<Mi.length;Xo++){var El=(Ru(Mi[Xo-1]+" "+Mi[Xo])-Ru(Mi[Xo]))*Un+Ga;Xo==Mi.length-1?I.push([Mi[Xo],El,0]):I.push([Mi[Xo]+" ",El,0]),Ha-=El}}else I.push([rt[Rn],Li,Qi]);I.push(["",Ha,0])}else{if(y!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(I=[],_r=rt.length,q=q!==0?q:Nh,Rn=0;Rn<_r;Rn++)Qi=Rn===0?xr(me):-vc,Li=Rn===0?Ki(G):0,Rn<_r-1?va.push(k(M((q-Ji[Rn])/(rt[Rn].split(" ").length-1)))):va.push(0),I.push([rt[Rn],Li,Qi])}}var Ph=typeof we.R2L=="boolean"?we.R2L:xt;Ph===!0&&(I=Us(I,(function(Zn,zn,Er){return[Zn.split("").reverse().join(""),zn,Er]}))),He={text:I,x:G,y:me,options:we,mutex:{pdfEscape:br,activeFontKey:en,fonts:xn,activeFontSize:at}},En.publish("postProcessText",He),I=He.text,sn=He.mutex.isHex||!1;var Sl=xn[en].encoding;Sl!=="WinAnsiEncoding"&&Sl!=="StandardEncoding"||(I=Us(I,(function(Zn,zn,Er){return[Xi(Zn),zn,Er]}))),rt=mi(I),I=[];for(var Al,Cl,Yo,$a=0,ya=1,Ka=Array.isArray(rt[0])?ya:$a,Xa="",Lu=function(Zn,zn,Er){var Or="";return Er instanceof _t?(Er=typeof we.angle=="number"?Ti(Er,new _t(1,0,0,1,Zn,zn)):Ti(new _t(1,0,0,1,Zn,zn),Er),N===A.ADVANCED&&(Er=Ti(new _t(1,0,0,-1,0,0),Er)),Or=Er.join(" ")+` Tm
`):Or=k(Zn)+" "+k(zn)+` Td
`,Or},gi=0;gi<rt.length;gi++){switch(Xa="",Ka){case ya:Yo=(sn?"<":"(")+rt[gi][0]+(sn?">":")"),Al=parseFloat(rt[gi][1]),Cl=parseFloat(rt[gi][2]);break;case $a:Yo=(sn?"<":"(")+rt[gi]+(sn?">":")"),Al=Ki(G),Cl=xr(me)}va!==void 0&&va[gi]!==void 0&&(Xa=va[gi]+` Tw
`),gi===0?I.push(Xa+Lu(Al,Cl,Fe)+Yo):Ka===$a?I.push(Xa+Yo):Ka===ya&&I.push(Xa+Lu(Al,Cl,Fe)+Yo)}I=Ka===$a?I.join(` Tj
T* `):I.join(` Tj
`),I+=` Tj
`;var yo=`BT
/`;return yo+=en+" "+at+` Tf
`,yo+=k(at*Fn)+` TL
`,yo+=hr+`
`,yo+=vn,yo+=I,ie(yo+="ET"),p[en]=!0,it};var us=m.__private__.clip=m.clip=function(I){return ie(I==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return us("evenodd")},m.__private__.discardPath=m.discardPath=function(){return ie("n"),this};var ls=m.__private__.isValidStyle=function(I){var G=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(I)!==-1&&(G=!0),G};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(I){return ls(I)&&(l=I),this};var vl=m.__private__.getStyle=m.getStyle=function(I){var G=l;switch(I){case"D":case"S":G="S";break;case"F":G="f";break;case"FD":case"DF":G="B";break;case"f":case"f*":case"B":case"B*":G=I}return G},di=m.close=function(){return ie("h"),this};m.stroke=function(){return ie("S"),this},m.fill=function(I){return Cu("f",I),this},m.fillEvenOdd=function(I){return Cu("f*",I),this},m.fillStroke=function(I){return Cu("B",I),this},m.fillStrokeEvenOdd=function(I){return Cu("B*",I),this};var Cu=function(I,G){tr(G)==="object"?Va(G,I):ie(I)},Iu=function(I){I===null||N===A.ADVANCED&&I===void 0||(I=vl(I),ie(I))};function Os(I,G,me,we,Re){var He=new wd(G||this.boundingBox,me||this.xStep,we||this.yStep,this.gState,Re||this.matrix);He.stream=this.stream;var rt=I+"$$"+this.cloneIndex+++"$$";return Mr(rt,He),He}var Va=function(I,G){var me=is[I.key],we=gn[me];if(we instanceof of)ie("q"),ie(lc(G)),we.gState&&m.setGState(we.gState),ie(I.matrix.toString()+" cm"),ie("/"+me+" sh"),ie("Q");else if(we instanceof wd){var Re=new _t(1,0,0,-1,0,Di());I.matrix&&(Re=Re.multiply(I.matrix||Lr),me=Os.call(we,I.key,I.boundingBox,I.xStep,I.yStep,Re).id),ie("q"),ie("/Pattern cs"),ie("/"+me+" scn"),we.gState&&m.setGState(we.gState),ie(G),ie("Q")}},lc=function(I){switch(I){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},$i=m.moveTo=function(I,G){return ie(k(M(I))+" "+k(J(G))+" m"),this},pi=m.lineTo=function(I,G){return ie(k(M(I))+" "+k(J(G))+" l"),this},Pi=m.curveTo=function(I,G,me,we,Re,He){return ie([k(M(I)),k(J(G)),k(M(me)),k(J(we)),k(M(Re)),k(J(He)),"c"].join(" ")),this};m.__private__.line=m.line=function(I,G,me,we,Re){if(isNaN(I)||isNaN(G)||isNaN(me)||isNaN(we)||!ls(Re))throw new Error("Invalid arguments passed to jsPDF.line");return N===A.COMPAT?this.lines([[me-I,we-G]],I,G,[1,1],Re||"S"):this.lines([[me-I,we-G]],I,G,[1,1]).stroke()},m.__private__.lines=m.lines=function(I,G,me,we,Re,He){var rt,mt,y,O,q,ee,Ne,Fe,it,on,vn,sn;if(typeof I=="number"&&(sn=me,me=G,G=I,I=sn),we=we||[1,1],He=He||!1,isNaN(G)||isNaN(me)||!Array.isArray(I)||!Array.isArray(we)||!ls(Re)||typeof He!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for($i(G,me),rt=we[0],mt=we[1],O=I.length,on=G,vn=me,y=0;y<O;y++)(q=I[y]).length===2?(on=q[0]*rt+on,vn=q[1]*mt+vn,pi(on,vn)):(ee=q[0]*rt+on,Ne=q[1]*mt+vn,Fe=q[2]*rt+on,it=q[3]*mt+vn,on=q[4]*rt+on,vn=q[5]*mt+vn,Pi(ee,Ne,Fe,it,on,vn));return He&&di(),Iu(Re),this},m.path=function(I){for(var G=0;G<I.length;G++){var me=I[G],we=me.c;switch(me.op){case"m":$i(we[0],we[1]);break;case"l":pi(we[0],we[1]);break;case"c":Pi.apply(this,we);break;case"h":di()}}return this},m.__private__.rect=m.rect=function(I,G,me,we,Re){if(isNaN(I)||isNaN(G)||isNaN(me)||isNaN(we)||!ls(Re))throw new Error("Invalid arguments passed to jsPDF.rect");return N===A.COMPAT&&(we=-we),ie([k(M(I)),k(J(G)),k(M(me)),k(M(we)),"re"].join(" ")),Iu(Re),this},m.__private__.triangle=m.triangle=function(I,G,me,we,Re,He,rt){if(isNaN(I)||isNaN(G)||isNaN(me)||isNaN(we)||isNaN(Re)||isNaN(He)||!ls(rt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[me-I,we-G],[Re-me,He-we],[I-Re,G-He]],I,G,[1,1],rt,!0),this},m.__private__.roundedRect=m.roundedRect=function(I,G,me,we,Re,He,rt){if(isNaN(I)||isNaN(G)||isNaN(me)||isNaN(we)||isNaN(Re)||isNaN(He)||!ls(rt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var mt=4/3*(Math.SQRT2-1);return Re=Math.min(Re,.5*me),He=Math.min(He,.5*we),this.lines([[me-2*Re,0],[Re*mt,0,Re,He-He*mt,Re,He],[0,we-2*He],[0,He*mt,-Re*mt,He,-Re,He],[2*Re-me,0],[-Re*mt,0,-Re,-He*mt,-Re,-He],[0,2*He-we],[0,-He*mt,Re*mt,-He,Re,-He]],I+Re,G,[1,1],rt,!0),this},m.__private__.ellipse=m.ellipse=function(I,G,me,we,Re){if(isNaN(I)||isNaN(G)||isNaN(me)||isNaN(we)||!ls(Re))throw new Error("Invalid arguments passed to jsPDF.ellipse");var He=4/3*(Math.SQRT2-1)*me,rt=4/3*(Math.SQRT2-1)*we;return $i(I+me,G),Pi(I+me,G-rt,I+He,G-we,I,G-we),Pi(I-He,G-we,I-me,G-rt,I-me,G),Pi(I-me,G+rt,I-He,G+we,I,G+we),Pi(I+He,G+we,I+me,G+rt,I+me,G),Iu(Re),this},m.__private__.circle=m.circle=function(I,G,me,we){if(isNaN(I)||isNaN(G)||isNaN(me)||!ls(we))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(I,G,me,me,we)},m.setFont=function(I,G,me){return me&&(G=W(G,me)),en=Fs(I,G,{disableWarning:!1}),this};var fa=m.__private__.getFont=m.getFont=function(){return xn[Fs.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var I,G,me={};for(I in Gn)if(Gn.hasOwnProperty(I))for(G in me[I]=[],Gn[I])Gn[I].hasOwnProperty(G)&&me[I].push(G);return me},m.addFont=function(I,G,me,we,Re){var He=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&He.indexOf(arguments[3])!==-1?Re=arguments[3]:arguments[3]&&He.indexOf(arguments[3])==-1&&(me=W(me,we)),Re=Re||"Identity-H",aa.call(this,I,G,me,Re)};var Mn,yl=n.lineWidth||.200025,da=m.__private__.getLineWidth=m.getLineWidth=function(){return yl},pa=m.__private__.setLineWidth=m.setLineWidth=function(I){return yl=I,ie(k(M(I))+" w"),this};m.__private__.setLineDash=Xt.API.setLineDash=Xt.API.setLineDashPattern=function(I,G){if(I=I||[],G=G||0,isNaN(G)||!Array.isArray(I))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return I=I.map((function(me){return k(M(me))})).join(" "),G=k(M(G)),ie("["+I+"] "+G+" d"),this};var ja=m.__private__.getLineHeight=m.getLineHeight=function(){return at*Mn};m.__private__.getLineHeight=m.getLineHeight=function(){return at*Mn};var Tu=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(I){return typeof(I=I||1.15)=="number"&&(Mn=I),this},Ri=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return Mn};Tu(n.lineHeight);var Ki=m.__private__.getHorizontalCoordinate=function(I){return M(I)},xr=m.__private__.getVerticalCoordinate=function(I){return N===A.ADVANCED?I:Wt[$].mediaBox.topRightY-Wt[$].mediaBox.bottomLeftY-M(I)},wl=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(I){return k(Ki(I))},Go=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(I){return k(xr(I))},Fr=n.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return po(Fr)},m.__private__.setStrokeColor=m.setDrawColor=function(I,G,me,we){return Fr=Ar({ch1:I,ch2:G,ch3:me,ch4:we,pdfColorType:"draw",precision:2}),ie(Fr),this};var Ua=n.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return po(Ua)},m.__private__.setFillColor=m.setFillColor=function(I,G,me,we){return Ua=Ar({ch1:I,ch2:G,ch3:me,ch4:we,pdfColorType:"fill",precision:2}),ie(Ua),this};var hr=n.textColor||"0 g",$o=m.__private__.getTextColor=m.getTextColor=function(){return po(hr)};m.__private__.setTextColor=m.setTextColor=function(I,G,me,we){return hr=Ar({ch1:I,ch2:G,ch3:me,ch4:we,pdfColorType:"text",precision:3}),this};var Bs=n.charSpace,cs=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Bs||0)};m.__private__.setCharSpace=m.setCharSpace=function(I){if(isNaN(I))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Bs=I,this};var bl=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(I){var G=m.CapJoinStyles[I];if(G===void 0)throw new Error("Line cap style of '"+I+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return bl=G,ie(G+" J"),this};var ma=0;m.__private__.setLineJoin=m.setLineJoin=function(I){var G=m.CapJoinStyles[I];if(G===void 0)throw new Error("Line join style of '"+I+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ma=G,ie(G+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(I){if(I=I||0,isNaN(I))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ie(k(M(I))+" M"),this},m.GState=t0,m.setGState=function(I){(I=typeof I=="string"?Jn[yr[I]]:hs(null,I)).equals(ni)||(ie("/"+I.id+" gs"),ni=I)};var hs=function(I,G){if(!I||!yr[I]){var me=!1;for(var we in Jn)if(Jn.hasOwnProperty(we)&&Jn[we].equals(G)){me=!0;break}if(me)G=Jn[we];else{var Re="GS"+(Object.keys(Jn).length+1).toString(10);Jn[Re]=G,G.id=Re}return I&&(yr[I]=G.id),En.publish("addGState",G),G}};m.addGState=function(I,G){return hs(I,G),this},m.saveGraphicsState=function(){return ie("q"),ho.push({key:en,size:at,color:hr}),this},m.restoreGraphicsState=function(){ie("Q");var I=ho.pop();return en=I.key,at=I.size,hr=I.color,ni=null,this},m.setCurrentTransformationMatrix=function(I){return ie(I.toString()+" cm"),this},m.comment=function(I){return ie("#"+I),this};var Ko=function(I,G){var me=I||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return me},set:function(He){isNaN(He)||(me=parseFloat(He))}});var we=G||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return we},set:function(He){isNaN(He)||(we=parseFloat(He))}});var Re="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Re},set:function(He){Re=He.toString()}}),this},Vs=function(I,G,me,we){Ko.call(this,I,G),this.type="rect";var Re=me||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Re},set:function(rt){isNaN(rt)||(Re=parseFloat(rt))}});var He=we||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return He},set:function(rt){isNaN(rt)||(He=parseFloat(rt))}}),this},ga=function(){this.page=Qn,this.currentPage=$,this.pages=Ue.slice(0),this.pagesContext=Wt.slice(0),this.x=ar,this.y=dn,this.matrix=qr,this.width=fs($),this.height=Di($),this.outputDestination=Je,this.id="",this.objectNumber=-1};ga.prototype.restore=function(){Qn=this.page,$=this.currentPage,Wt=this.pagesContext,Ue=this.pages,ar=this.x,dn=this.y,qr=this.matrix,Nu($,this.width),Pu($,this.height),Je=this.outputDestination};var ku=function(I,G,me,we,Re){fo.push(new ga),Qn=$=0,Ue=[],ar=I,dn=G,qr=Re,fi([me,we])},cc=function(I){if(ri[I])fo.pop().restore();else{var G=new ga,me="Xo"+(Object.keys(Sr).length+1).toString(10);G.id=me,ri[I]=me,Sr[me]=G,En.publish("addFormObject",G),fo.pop().restore()}};for(var js in m.beginFormObject=function(I,G,me,we,Re){return ku(I,G,me,we,Re),this},m.endFormObject=function(I){return cc(I),this},m.doFormObject=function(I,G){var me=Sr[ri[I]];return ie("q"),ie(G.toString()+" cm"),ie("/"+me.id+" Do"),ie("Q"),this},m.getFormObject=function(I){var G=Sr[ri[I]];return{x:G.x,y:G.y,width:G.width,height:G.height,matrix:G.matrix}},m.save=function(I,G){return I=I||"generated.pdf",(G=G||{}).returnPromise=G.returnPromise||!1,G.returnPromise===!1?(tf(Ba(as()),I),typeof tf.unload=="function"&&Jt.setTimeout&&setTimeout(tf.unload,911),this):new Promise((function(me,we){try{var Re=tf(Ba(as()),I);typeof tf.unload=="function"&&Jt.setTimeout&&setTimeout(tf.unload,911),me(Re)}catch(He){we(He.message)}}))},Xt.API)Xt.API.hasOwnProperty(js)&&(js==="events"&&Xt.API.events.length?(function(I,G){var me,we,Re;for(Re=G.length-1;Re!==-1;Re--)me=G[Re][0],we=G[Re][1],I.subscribe.apply(I,[me].concat(typeof we=="function"?[we]:we))})(En,Xt.API.events):m[js]=Xt.API[js]);var fs=m.getPageWidth=function(I){return(Wt[I=I||$].mediaBox.topRightX-Wt[I].mediaBox.bottomLeftX)/pt},Nu=m.setPageWidth=function(I,G){Wt[I].mediaBox.topRightX=G*pt+Wt[I].mediaBox.bottomLeftX},Di=m.getPageHeight=function(I){return(Wt[I=I||$].mediaBox.topRightY-Wt[I].mediaBox.bottomLeftY)/pt},Pu=m.setPageHeight=function(I,G){Wt[I].mediaBox.topRightY=G*pt+Wt[I].mediaBox.bottomLeftY};return m.internal={pdfEscape:br,getStyle:vl,getFont:fa,getFontSize:ct,getCharSpace:cs,getTextColor:$o,getLineHeight:ja,getLineHeightFactor:Ri,getLineWidth:da,write:ft,getHorizontalCoordinate:Ki,getVerticalCoordinate:xr,getCoordinateString:wl,getVerticalCoordinateString:Go,collections:{},newObject:nr,newAdditionalObject:ia,newObjectDeferred:rr,newObjectDeferredBegin:cr,getFilters:Ni,putStream:wr,events:En,scaleFactor:pt,pageSize:{getWidth:function(){return fs($)},setWidth:function(I){Nu($,I)},getHeight:function(){return Di($)},setHeight:function(I){Pu($,I)}},encryptionOptions:h,encryption:Cn,getEncryptor:Ho,output:ha,getNumberOfPages:jn,pages:Ue,out:ie,f2:B,f3:R,getPageInfo:go,getPageInfoByObjId:Ht,getCurrentPageInfo:vo,getPDFVersion:b,Point:Ko,Rectangle:Vs,Matrix:_t,hasHotfix:qo},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return fs($)},set:function(I){Nu($,I)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return Di($)},set:function(I){Pu($,I)},enumerable:!0,configurable:!0}),ua.call(m,Ze),en="F1",la(i,t),En.publish("initialized"),m}ud.prototype.lsbFirstWord=function(n){return String.fromCharCode(n>>0&255,n>>8&255,n>>16&255,n>>24&255)},ud.prototype.toHexString=function(n){return n.split("").map((function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)})).join("")},ud.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},ud.prototype.processOwnerPassword=function(n,e){return Q2(J2(e).substr(0,5),n)},ud.prototype.encryptor=function(n,e){var t=J2(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return Q2(t,r)}},t0.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||tr(n)!==tr(this))return!1;var r=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;r++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&r--;return r===0},Xt.API={events:[]},Xt.version="2.5.2";var zr=Xt.API,px=1,Tf=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},nd=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ln=function(n){return n.toFixed(2)},Wc=function(n){return n.toFixed(5)};zr.__acroform__={};var ks=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},PS=function(n){return n*px},Wu=function(n){var e=new MT,t=Tt.internal.getHeight(n)||0,r=Tt.internal.getWidth(n)||0;return e.BBox=[0,0,Number(ln(r)),Number(ln(t))],e},sU=zr.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|=1<<e},aU=zr.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&=~(1<<e)},uU=zr.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(n&1<<e)==0?0:1},Jr=zr.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return uU(n,e-1)},Qr=zr.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return sU(n,e-1)},Zr=zr.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return aU(n,e-1)},lU=zr.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=n[0],o=n[1],s=n[2],a=n[3],u={};return u.lowerLeft_X=t(i)||0,u.lowerLeft_Y=r(o+a)||0,u.upperRight_X=t(i+s)||0,u.upperRight_Y=r(o)||0,[Number(ln(u.lowerLeft_X)),Number(ln(u.lowerLeft_Y)),Number(ln(u.upperRight_X)),Number(ln(u.upperRight_Y))]},cU=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,r=Z2(n,t),i=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+i+" "+ln(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Wu(n);return o.scope=n.scope,o.stream=e.join(`
`),o}},Z2=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=n.multiline?i.map((function(R){return R.split(`
`)})):i.map((function(R){return[R]}));var o=t,s=Tt.internal.getHeight(n)||0;s=s<0?-s:s;var a=Tt.internal.getWidth(n)||0;a=a<0?-a:a;var u=function(R,M,U){if(R+1<i.length){var J=M+" "+i[R+1][0];return Zg(J,n,U).width<=a-4}return!1};o++;e:for(;o>0;){e="",o--;var l,h,d=Zg("3",n,o).height,p=n.multiline?s-o:(s-d)/2,m=p+=2,w=0,b=0,x=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+Zg(e,n,o=12).width+", FieldWidth:"+a+`
`;break}for(var E="",A=0,N=0;N<i.length;N++)if(i.hasOwnProperty(N)){var F=!1;if(i[N].length!==1&&x!==i[N].length-1){if((d+2)*(A+2)+2>s)continue e;E+=i[N][x],F=!0,b=N,N--}else{E=(E+=i[N][x]+" ").substr(E.length-1)==" "?E.substr(0,E.length-1):E;var D=parseInt(N),W=u(D,E,o),k=N>=i.length-1;if(W&&!k){E+=" ",x=0;continue}if(W||k){if(k)b=D;else if(n.multiline&&(d+2)*(A+2)+2>s)continue e}else{if(!n.multiline||(d+2)*(A+2)+2>s)continue e;b=D}}for(var C="",L=w;L<=b;L++){var B=i[L];if(n.multiline){if(L===b){C+=B[x]+" ",x=(x+1)%B.length;continue}if(L===w){C+=B[B.length-1]+" ";continue}}C+=B[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,h=Zg(C,n,o).width,n.textAlign){case"right":l=a-h-2;break;case"center":l=(a-h)/2;break;case"left":default:l=2}e+=ln(l)+" "+ln(m)+` Td
`,e+="("+Tf(C)+`) Tj
`,e+=-ln(l)+` 0 Td
`,m=-(o+2),h=0,w=F?b:b+1,A++,E=""}break}return r.text=e,r.fontSize=o,r},Zg=function(n,e,t){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(n,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:i}},hU={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},fU=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find((function(r){return r.type===t.type&&r.object===t.object}))===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},dU=function(n,e){for(var t in n)if(n.hasOwnProperty(t)){var r=t,i=n[t];e.internal.newObjectDeferredBegin(i.objId,!0),tr(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete n[r]}},pU=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(xu.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(hU)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");px=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new FT,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",(function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)})),n.internal.events.subscribe("buildDocument",(function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];o.objId=void 0,o.hasAnnotation&&fU(o,t)}})(n)})),n.internal.events.subscribe("putCatalog",(function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)})),n.internal.events.subscribe("postPutPages",(function(t){(function(r,i){var o=!r;for(var s in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(s)){var a=r[s],u=[],l=a.Rect;if(a.Rect&&(a.Rect=lU(a.Rect,i)),i.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Tt.createDefaultAppearanceStream(a),tr(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(u=a.getKeyValueListForStream()),a.Rect=l,a.hasAppearanceStream&&!a.appearanceStreamContent){var h=cU(a);u.push({key:"AP",value:"<</N "+h+">>"}),i.internal.acroformPlugin.xForms.push(h)}if(a.appearanceStreamContent){var d="";for(var p in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(p)){var m=a.appearanceStreamContent[p];if(d+="/"+p+" ",d+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var s in m)if(m.hasOwnProperty(s)){var w=m[s];typeof w=="function"&&(w=w.call(i,a)),d+="/"+s+" "+w+" ",i.internal.acroformPlugin.xForms.indexOf(w)>=0||i.internal.acroformPlugin.xForms.push(w)}}else typeof(w=m)=="function"&&(w=w.call(i,a)),d+="/"+s+" "+w,i.internal.acroformPlugin.xForms.indexOf(w)>=0||i.internal.acroformPlugin.xForms.push(w);d+=">>"}u.push({key:"AP",value:`<<
`+d+">>"})}i.internal.putStream({additionalKeyValues:u,objectId:a.objId}),i.internal.out("endobj")}o&&dU(i.internal.acroformPlugin.xForms,i)})(t,n)})),n.internal.acroformPlugin.isInitialized=!0}},LT=zr.__acroform__.arrayToPdfArray=function(n,e,t){var r=function(s){return s};if(Array.isArray(n)){for(var i="[",o=0;o<n.length;o++)switch(o!==0&&(i+=" "),tr(n[o])){case"boolean":case"number":case"object":i+=n[o].toString();break;case"string":n[o].substr(0,1)!=="/"?(e!==void 0&&t&&(r=t.internal.getEncryptor(e)),i+="("+Tf(r(n[o].toString()))+")"):i+=n[o].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Wy=function(n,e,t){var r=function(i){return i};return e!==void 0&&t&&(r=t.internal.getEncryptor(e)),(n=n||"").toString(),n="("+Tf(r(n))+")"},Qu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Qu.prototype.toString=function(){return this.objId+" 0 R"},Qu.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},Qu.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter((function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"}));for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var r=e[t],i=this[r];i&&(Array.isArray(i)?n.push({key:r,value:LT(i,this.objId,this.scope)}):i instanceof Qu?(i.scope=this.scope,n.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&n.push({key:r,value:i}))}return n};var MT=function(){Qu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};ks(MT,Qu);var FT=function(){Qu.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Tf(t(n))+")"}},set:function(t){n=t}})};ks(FT,Qu);var xu=function n(){Qu.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute F supplied.');e=E}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Jr(e,3)},set:function(E){E?this.F=Qr(e,3):this.F=Zr(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute Ff supplied.');t=E}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(E){r=E!==void 0?E:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(E){r[0]=E}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(E){r[1]=E}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(E){r[2]=E}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(E){r[3]=E}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(E){switch(E){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=E;break;default:throw new Error('Invalid value "'+E+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof n0)return;o="FieldObject"+n.FieldNum++}var E=function(A){return A};return this.scope&&(E=this.scope.internal.getEncryptor(this.objId)),"("+Tf(E(o))+")"},set:function(E){o=E.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(E){o=E}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(E){s=E}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(E){a=E}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(E){u=E}});var l=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return l===void 0?50/px:l},set:function(E){l=E}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(E){h=E}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof n0||this instanceof df))return Wy(d,this.objId,this.scope)},set:function(E){E=E.toString(),d=E}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Wi?p:Wy(p,this.objId,this.scope)},set:function(E){E=E.toString(),p=this instanceof Wi?E:E.substr(0,1)==="("?nd(E.substr(1,E.length-2)):nd(E)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Wi?nd(p.substr(1,p.length-1)):p},set:function(E){E=E.toString(),p=this instanceof Wi?"/"+E:E}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(E){this.V=E}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Wi?m:Wy(m,this.objId,this.scope)},set:function(E){E=E.toString(),m=this instanceof Wi?E:E.substr(0,1)==="("?nd(E.substr(1,E.length-2)):nd(E)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Wi?nd(m.substr(1,m.length-1)):m},set:function(E){E=E.toString(),m=this instanceof Wi?"/"+E:E}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(E){E=!!E,b=E}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(E){w=E}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,1)},set:function(E){E?this.Ff=Qr(this.Ff,1):this.Ff=Zr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,2)},set:function(E){E?this.Ff=Qr(this.Ff,2):this.Ff=Zr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,3)},set:function(E){E?this.Ff=Qr(this.Ff,3):this.Ff=Zr(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(E){if([0,1,2].indexOf(E)===-1)throw new Error('Invalid value "'+E+'" for attribute Q supplied.');x=E}}),Object.defineProperty(this,"textAlign",{get:function(){var E;switch(x){case 0:default:E="left";break;case 1:E="center";break;case 2:E="right"}return E},configurable:!0,enumerable:!0,set:function(E){switch(E){case"right":case 2:x=2;break;case"center":case 1:x=1;break;case"left":case 0:default:x=0}}})};ks(xu,Qu);var Td=function(){xu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return LT(e,this.objId,this.scope)},set:function(t){var r,i;i=[],typeof(r=t)=="string"&&(i=(function(o,s,a){a||(a=1);for(var u,l=[];u=s.exec(o);)l.push(u[a]);return l})(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,18)},set:function(t){t?this.Ff=Qr(this.Ff,18):this.Ff=Zr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Qr(this.Ff,19):this.Ff=Zr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,20)},set:function(t){t?(this.Ff=Qr(this.Ff,20),e.sort()):this.Ff=Zr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,22)},set:function(t){t?this.Ff=Qr(this.Ff,22):this.Ff=Zr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,23)},set:function(t){t?this.Ff=Qr(this.Ff,23):this.Ff=Zr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,27)},set:function(t){t?this.Ff=Qr(this.Ff,27):this.Ff=Zr(this.Ff,27)}}),this.hasAppearanceStream=!1};ks(Td,xu);var kd=function(){Td.call(this),this.fontName="helvetica",this.combo=!1};ks(kd,Td);var Nd=function(){kd.call(this),this.combo=!0};ks(Nd,kd);var fv=function(){Nd.call(this),this.edit=!0};ks(fv,Nd);var Wi=function(){xu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,15)},set:function(t){t?this.Ff=Qr(this.Ff,15):this.Ff=Zr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,16)},set:function(t){t?this.Ff=Qr(this.Ff,16):this.Ff=Zr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,17)},set:function(t){t?this.Ff=Qr(this.Ff,17):this.Ff=Zr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,26)},set:function(t){t?this.Ff=Qr(this.Ff,26):this.Ff=Zr(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+Tf(t(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(t){tr(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};ks(Wi,xu);var dv=function(){Wi.call(this),this.pushButton=!0};ks(dv,Wi);var Pd=function(){Wi.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};ks(Pd,Wi);var n0=function(){var n,e;xu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(a){return a};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),r)s.push("/"+o+" ("+Tf(i(r[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){tr(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(i){t="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Tt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ks(n0,xu),Pd.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},Pd.prototype.createOption=function(n){var e=new n0;return e.Parent=this,e.optionName=n,this.Kids.push(e),mU.call(this.scope,e),e};var pv=function(){Wi.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Tt.CheckBox.createAppearanceStream()};ks(pv,Wi);var df=function(){xu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,13)},set:function(e){e?this.Ff=Qr(this.Ff,13):this.Ff=Zr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,21)},set:function(e){e?this.Ff=Qr(this.Ff,21):this.Ff=Zr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,23)},set:function(e){e?this.Ff=Qr(this.Ff,23):this.Ff=Zr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,24)},set:function(e){e?this.Ff=Qr(this.Ff,24):this.Ff=Zr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,25)},set:function(e){e?this.Ff=Qr(this.Ff,25):this.Ff=Zr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,26)},set:function(e){e?this.Ff=Qr(this.Ff,26):this.Ff=Zr(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ks(df,xu);var mv=function(){df.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Jr(this.Ff,14)},set:function(n){n?this.Ff=Qr(this.Ff,14):this.Ff=Zr(this.Ff,14)}}),this.password=!0};ks(mv,df);var Tt={CheckBox:{createAppearanceStream:function(){return{N:{On:Tt.CheckBox.YesNormal},D:{On:Tt.CheckBox.YesPushDown,Off:Tt.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=Wu(n);e.scope=n.scope;var t=[],r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,i=n.scope.__private__.encodeColorString(n.color),o=Z2(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+ln(Tt.internal.getWidth(n))+" "+ln(Tt.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+ln(o.fontSize)+" Tf "+i),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=Wu(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),i=[],o=Tt.internal.getHeight(n),s=Tt.internal.getWidth(n),a=Z2(n,n.caption);return i.push("1 g"),i.push("0 0 "+ln(s)+" "+ln(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+ln(s-1)+" "+ln(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+t+" "+ln(a.fontSize)+" Tf "+r),i.push(a.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(n){var e=Wu(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+ln(Tt.internal.getWidth(n))+" "+ln(Tt.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:Tt.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=Tt.RadioButton.Circle.YesNormal,e.D[n]=Tt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=Wu(n);e.scope=n.scope;var t=[],r=Tt.internal.getWidth(n)<=Tt.internal.getHeight(n)?Tt.internal.getWidth(n)/4:Tt.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=Tt.internal.Bezier_C,o=Number((r*i).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Wc(Tt.internal.getWidth(n)/2)+" "+Wc(Tt.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Wu(n);e.scope=n.scope;var t=[],r=Tt.internal.getWidth(n)<=Tt.internal.getHeight(n)?Tt.internal.getWidth(n)/4:Tt.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),o=Number((i*Tt.internal.Bezier_C).toFixed(5)),s=Number((r*Tt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Wc(Tt.internal.getWidth(n)/2)+" "+Wc(Tt.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Wc(Tt.internal.getWidth(n)/2)+" "+Wc(Tt.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=Wu(n);e.scope=n.scope;var t=[],r=Tt.internal.getWidth(n)<=Tt.internal.getHeight(n)?Tt.internal.getWidth(n)/4:Tt.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),o=Number((i*Tt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Wc(Tt.internal.getWidth(n)/2)+" "+Wc(Tt.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:Tt.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=Tt.RadioButton.Cross.YesNormal,e.D[n]=Tt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=Wu(n);e.scope=n.scope;var t=[],r=Tt.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+ln(Tt.internal.getWidth(n)-2)+" "+ln(Tt.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(ln(r.x1.x)+" "+ln(r.x1.y)+" m"),t.push(ln(r.x2.x)+" "+ln(r.x2.y)+" l"),t.push(ln(r.x4.x)+" "+ln(r.x4.y)+" m"),t.push(ln(r.x3.x)+" "+ln(r.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Wu(n);e.scope=n.scope;var t=Tt.internal.calculateCross(n),r=[];return r.push("0.749023 g"),r.push("0 0 "+ln(Tt.internal.getWidth(n))+" "+ln(Tt.internal.getHeight(n))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+ln(Tt.internal.getWidth(n)-2)+" "+ln(Tt.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(ln(t.x1.x)+" "+ln(t.x1.y)+" m"),r.push(ln(t.x2.x)+" "+ln(t.x2.y)+" l"),r.push(ln(t.x4.x)+" "+ln(t.x4.y)+" m"),r.push(ln(t.x3.x)+" "+ln(t.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=Wu(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+ln(Tt.internal.getWidth(n))+" "+ln(Tt.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};Tt.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=Tt.internal.getWidth(n),t=Tt.internal.getHeight(n),r=Math.min(e,t);return{x1:{x:(e-r)/2,y:(t-r)/2+r},x2:{x:(e-r)/2+r,y:(t-r)/2},x3:{x:(e-r)/2,y:(t-r)/2},x4:{x:(e-r)/2+r,y:(t-r)/2+r}}}},Tt.internal.getWidth=function(n){var e=0;return tr(n)==="object"&&(e=PS(n.Rect[2])),e},Tt.internal.getHeight=function(n){var e=0;return tr(n)==="object"&&(e=PS(n.Rect[3])),e};var mU=zr.addField=function(n){if(pU(this,n),!(n instanceof xu))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};zr.AcroFormChoiceField=Td,zr.AcroFormListBox=kd,zr.AcroFormComboBox=Nd,zr.AcroFormEditBox=fv,zr.AcroFormButton=Wi,zr.AcroFormPushButton=dv,zr.AcroFormRadioButton=Pd,zr.AcroFormCheckBox=pv,zr.AcroFormTextField=df,zr.AcroFormPasswordField=mv,zr.AcroFormAppearance=Tt,zr.AcroForm={ChoiceField:Td,ListBox:kd,ComboBox:Nd,EditBox:fv,Button:Wi,PushButton:dv,RadioButton:Pd,CheckBox:pv,TextField:df,PasswordField:mv,Appearance:Tt},Xt.AcroForm={ChoiceField:Td,ListBox:kd,ComboBox:Nd,EditBox:fv,Button:Wi,PushButton:dv,RadioButton:Pd,CheckBox:pv,TextField:df,PasswordField:mv,Appearance:Tt};Xt.AcroForm;function OT(n){return n.reduce((function(e,t,r){return e[t]=r,e}),{})}(function(n){n.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=n.__addimage__.getImageFileTypeByImageData=function(R,M){var U,J,de,fe,he,K=e;if((M=M||e)==="RGBA"||R.data!==void 0&&R.data instanceof Uint8ClampedArray&&"height"in R&&"width"in R)return"RGBA";if(W(R))for(he in t)for(de=t[he],U=0;U<de.length;U+=1){for(fe=!0,J=0;J<de[U].length;J+=1)if(de[U][J]!==void 0&&de[U][J]!==R[J]){fe=!1;break}if(fe===!0){K=he;break}}else for(he in t)for(de=t[he],U=0;U<de.length;U+=1){for(fe=!0,J=0;J<de[U].length;J+=1)if(de[U][J]!==void 0&&de[U][J]!==R.charCodeAt(J)){fe=!1;break}if(fe===!0){K=he;break}}return K===e&&M!==e&&(K=M),K},i=function R(M){for(var U=this.internal.write,J=this.internal.putStream,de=(0,this.internal.getFilters)();de.indexOf("FlateEncode")!==-1;)de.splice(de.indexOf("FlateEncode"),1);M.objectId=this.internal.newObject();var fe=[];if(fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Image"}),fe.push({key:"Width",value:M.width}),fe.push({key:"Height",value:M.height}),M.colorSpace===x.INDEXED?fe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(M.palette.length/3-1)+" "+("sMask"in M&&M.sMask!==void 0?M.objectId+2:M.objectId+1)+" 0 R]"}):(fe.push({key:"ColorSpace",value:"/"+M.colorSpace}),M.colorSpace===x.DEVICE_CMYK&&fe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),fe.push({key:"BitsPerComponent",value:M.bitsPerComponent}),"decodeParameters"in M&&M.decodeParameters!==void 0&&fe.push({key:"DecodeParms",value:"<<"+M.decodeParameters+">>"}),"transparency"in M&&Array.isArray(M.transparency)){for(var he="",K=0,le=M.transparency.length;K<le;K++)he+=M.transparency[K]+" "+M.transparency[K]+" ";fe.push({key:"Mask",value:"["+he+"]"})}M.sMask!==void 0&&fe.push({key:"SMask",value:M.objectId+1+" 0 R"});var se=M.filter!==void 0?["/"+M.filter]:void 0;if(J({data:M.data,additionalKeyValues:fe,alreadyAppliedFilters:se,objectId:M.objectId}),U("endobj"),"sMask"in M&&M.sMask!==void 0){var re="/Predictor "+M.predictor+" /Colors 1 /BitsPerComponent "+M.bitsPerComponent+" /Columns "+M.width,j={width:M.width,height:M.height,colorSpace:"DeviceGray",bitsPerComponent:M.bitsPerComponent,decodeParameters:re,data:M.sMask};"filter"in M&&(j.filter=M.filter),R.call(this,j)}if(M.colorSpace===x.INDEXED){var $=this.internal.newObject();J({data:C(new Uint8Array(M.palette)),objectId:$}),U("endobj")}},o=function(){var R=this.internal.collections.addImage_images;for(var M in R)i.call(this,R[M])},s=function(){var R,M=this.internal.collections.addImage_images,U=this.internal.write;for(var J in M)U("/I"+(R=M[J]).index,R.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},u=function(){var R=this.internal.collections.addImage_images;return a.call(this),R},l=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(R){return typeof n["process"+R.toUpperCase()]=="function"},d=function(R){return tr(R)==="object"&&R.nodeType===1},p=function(R,M){if(R.nodeName==="IMG"&&R.hasAttribute("src")){var U=""+R.getAttribute("src");if(U.indexOf("data:image/")===0)return Zp(unescape(U).split("base64,").pop());var J=n.loadFile(U,!0);if(J!==void 0)return J}if(R.nodeName==="CANVAS"){if(R.width===0||R.height===0)throw new Error("Given canvas must have data. Canvas width: "+R.width+", height: "+R.height);var de;switch(M){case"PNG":de="image/png";break;case"WEBP":de="image/webp";break;case"JPEG":case"JPG":default:de="image/jpeg"}return Zp(R.toDataURL(de,1).split("base64,").pop())}},m=function(R){var M=this.internal.collections.addImage_images;if(M){for(var U in M)if(R===M[U].alias)return M[U]}},w=function(R,M,U){return R||M||(R=-96,M=-96),R<0&&(R=-1*U.width*72/R/this.internal.scaleFactor),M<0&&(M=-1*U.height*72/M/this.internal.scaleFactor),R===0&&(R=M*U.width/U.height),M===0&&(M=R*U.height/U.width),[R,M]},b=function(R,M,U,J,de,fe){var he=w.call(this,U,J,de),K=this.internal.getCoordinateString,le=this.internal.getVerticalCoordinateString,se=u.call(this);if(U=he[0],J=he[1],se[de.index]=de,fe){fe*=Math.PI/180;var re=Math.cos(fe),j=Math.sin(fe),$=function(ce){return ce.toFixed(4)},ne=[$(re),$(j),$(-1*j),$(re),0,0,"cm"]}this.internal.write("q"),fe?(this.internal.write([1,"0","0",1,K(R),le(M+J),"cm"].join(" ")),this.internal.write(ne.join(" ")),this.internal.write([K(U),"0","0",K(J),"0","0","cm"].join(" "))):this.internal.write([K(U),"0","0",K(J),K(R),le(M+J),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+de.index+" Do"),this.internal.write("Q")},x=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var E=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},A=n.__addimage__.sHashCode=function(R){var M,U,J=0;if(typeof R=="string")for(U=R.length,M=0;M<U;M++)J=(J<<5)-J+R.charCodeAt(M),J|=0;else if(W(R))for(U=R.byteLength/2,M=0;M<U;M++)J=(J<<5)-J+R[M],J|=0;return J},N=n.__addimage__.validateStringAsBase64=function(R){(R=R||"").toString().trim();var M=!0;return R.length===0&&(M=!1),R.length%4!=0&&(M=!1),/^[A-Za-z0-9+/]+$/.test(R.substr(0,R.length-2))===!1&&(M=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(R.substr(-2))===!1&&(M=!1),M},F=n.__addimage__.extractImageFromDataUrl=function(R){var M=(R=R||"").split("base64,"),U=null;if(M.length===2){var J=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(M[0]);Array.isArray(J)&&(U={mimeType:J[1],charset:J[2],data:M[1]})}return U},D=n.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};n.__addimage__.isArrayBuffer=function(R){return D()&&R instanceof ArrayBuffer};var W=n.__addimage__.isArrayBufferView=function(R){return D()&&typeof Uint32Array<"u"&&(R instanceof Int8Array||R instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&R instanceof Uint8ClampedArray||R instanceof Int16Array||R instanceof Uint16Array||R instanceof Int32Array||R instanceof Uint32Array||R instanceof Float32Array||R instanceof Float64Array)},k=n.__addimage__.binaryStringToUint8Array=function(R){for(var M=R.length,U=new Uint8Array(M),J=0;J<M;J++)U[J]=R.charCodeAt(J);return U},C=n.__addimage__.arrayBufferToBinaryString=function(R){for(var M="",U=W(R)?R:new Uint8Array(R),J=0;J<U.length;J+=8192)M+=String.fromCharCode.apply(null,U.subarray(J,J+8192));return M};n.addImage=function(){var R,M,U,J,de,fe,he,K,le;if(typeof arguments[1]=="number"?(M=e,U=arguments[1],J=arguments[2],de=arguments[3],fe=arguments[4],he=arguments[5],K=arguments[6],le=arguments[7]):(M=arguments[1],U=arguments[2],J=arguments[3],de=arguments[4],fe=arguments[5],he=arguments[6],K=arguments[7],le=arguments[8]),tr(R=arguments[0])==="object"&&!d(R)&&"imageData"in R){var se=R;R=se.imageData,M=se.format||M||e,U=se.x||U||0,J=se.y||J||0,de=se.w||se.width||de,fe=se.h||se.height||fe,he=se.alias||he,K=se.compression||K,le=se.rotation||se.angle||le}var re=this.internal.getFilters();if(K===void 0&&re.indexOf("FlateEncode")!==-1&&(K="SLOW"),isNaN(U)||isNaN(J))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var j=L.call(this,R,M,he,K);return b.call(this,U,J,de,fe,j,le),this};var L=function(R,M,U,J){var de,fe,he;if(typeof R=="string"&&r(R)===e){R=unescape(R);var K=B(R,!1);(K!==""||(K=n.loadFile(R,!0))!==void 0)&&(R=K)}if(d(R)&&(R=p(R,M)),M=r(R,M),!h(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(((he=U)==null||he.length===0)&&(U=(function(le){return typeof le=="string"||W(le)?A(le):W(le.data)?A(le.data):null})(R)),(de=m.call(this,U))||(D()&&(R instanceof Uint8Array||M==="RGBA"||(fe=R,R=k(R))),de=this["process"+M.toUpperCase()](R,l.call(this),U,(function(le){return le&&typeof le=="string"&&(le=le.toUpperCase()),le in n.image_compression?le:E.NONE})(J),fe)),!de)throw new Error("An unknown error occurred whilst processing the image.");return de},B=n.__addimage__.convertBase64ToBinaryString=function(R,M){var U;M=typeof M!="boolean"||M;var J,de="";if(typeof R=="string"){J=(U=F(R))!==null?U.data:R;try{de=Zp(J)}catch(fe){if(M)throw N(J)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+fe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return de};n.getImageProperties=function(R){var M,U,J="";if(d(R)&&(R=p(R)),typeof R=="string"&&r(R)===e&&((J=B(R,!1))===""&&(J=n.loadFile(R)||""),R=J),U=r(R),!h(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(!D()||R instanceof Uint8Array||(R=k(R)),!(M=this["process"+U.toUpperCase()](R)))throw new Error("An unknown error occurred whilst processing the image");return M.fileType=U,M}})(Xt.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};Xt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var r,i,o,s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(t.objId),l=t.pageContext.annotations,h=!1,d=0;d<l.length&&!h;d++)switch((r=l[d]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var p=0;p<l.length;p++){r=l[p];var m=this.internal.pdfEscape,w=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),E=this.internal.getEncryptor(b.objId),A=r.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(r.bounds.x)+" "+a(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y)+"] ")+"/Contents ("+m(E(r.contents))+")",o+=" /Popup "+x.objId+" 0 R",o+=" /P "+u.objId+" 0 R",o+=" /T ("+m(E(A))+") >>",b.content=o;var N=b.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(r.bounds.x+30)+" "+a(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w+30)+" "+a(r.bounds.y)+"] ")+" /Parent "+N,r.open&&(o+=" /Open true"),o+=" >>",x.content=o,this.internal.write(b.objId,"0 R",x.objId,"0 R");break;case"freetext":i="/Rect ["+s(r.bounds.x)+" "+a(r.bounds.y)+" "+s(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y+r.bounds.h)+"] ";var F=r.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+m(w(r.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+F+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(r.options.name){var D=this.annotations._nameMap[r.options.name];r.options.pageNumber=D.page,r.options.top=D.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",o="",r.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+m(w(r.options.url))+") >>";else if(r.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,o+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var W=a(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),o+=" /XYZ "+r.options.left+" "+W+" "+r.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},n.link=function(t,r,i,o,s){var a=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:u(t),y:l(r),w:u(t+i),h:l(r+o)},options:s,type:"link"})},n.textWithLink=function(t,r,i,o){var s,a,u=this.getTextWidth(t),l=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){a=o.maxWidth;var h=this.splitTextToSize(t,a).length;s=Math.ceil(l*h)}else a=u,s=l;return this.text(t,r,i,o),i+=.2*l,o.align==="center"&&(r-=u/2),o.align==="right"&&(r-=u),this.link(r,i-l,a,s,o),u},n.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}})(Xt.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];n.__arabicParser__={};var o=n.__arabicParser__.isInArabicSubstitutionA=function(b){return e[b.charCodeAt(0)]!==void 0},s=n.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},a=n.__arabicParser__.isArabicEndLetter=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length<=2},u=n.__arabicParser__.isArabicAlfLetter=function(b){return s(b)&&i.indexOf(b.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length>=1};var l=n.__arabicParser__.arabicLetterHasFinalForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length>=3};var h=n.__arabicParser__.arabicLetterHasMedialForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length==4},d=n.__arabicParser__.resolveLigatures=function(b){var x=0,E=t,A="",N=0;for(x=0;x<b.length;x+=1)E[b.charCodeAt(x)]!==void 0?(N++,typeof(E=E[b.charCodeAt(x)])=="number"&&(A+=String.fromCharCode(E),E=t,N=0),x===b.length-1&&(E=t,A+=b.charAt(x-(N-1)),x-=N-1,N=0)):(E=t,A+=b.charAt(x-N),x-=N,N=0);return A};n.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&r[b.charCodeAt(0)]!==void 0};var p=n.__arabicParser__.getCorrectForm=function(b,x,E){return s(b)?o(b)===!1?-1:!l(b)||!s(x)&&!s(E)||!s(E)&&a(x)||a(b)&&!s(x)||a(b)&&u(x)||a(b)&&a(x)?0:h(b)&&s(x)&&!a(x)&&s(E)&&l(E)?3:a(b)||!s(E)?1:2:-1},m=function(b){var x=0,E=0,A=0,N="",F="",D="",W=(b=b||"").split("\\s+"),k=[];for(x=0;x<W.length;x+=1){for(k.push(""),E=0;E<W[x].length;E+=1)N=W[x][E],F=W[x][E-1],D=W[x][E+1],s(N)?(A=p(N,F,D),k[x]+=A!==-1?String.fromCharCode(e[N.charCodeAt(0)][A]):N):k[x]+=N;k[x]=d(k[x])}return k.join(" ")},w=n.__arabicParser__.processArabic=n.processArabic=function(){var b,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,E=[];if(Array.isArray(x)){var A=0;for(E=[],A=0;A<x.length;A+=1)Array.isArray(x[A])?E.push([m(x[A][0]),x[A][1],x[A][2]]):E.push([m(x[A])]);b=E}else b=m(x);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};n.events.push(["preProcessText",w])})(Xt.API),Xt.API.autoPrint=function(n){var e;switch((n=n||{}).variant=n.variant||"non-conform",n.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",(function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+e+" 0 R")}))}return this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(a){t=a}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(a){o=a}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(a){s=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,r){var i;if((t=t||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Xt.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(b){u=b}});var l=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return l},set:function(b){l=b}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(b){h=b}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(b){d=b}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(b){p=b}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(b){m=b}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(b){w=b}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(u){return r.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},n.getTextDimensions=function(u,l){r.call(this);var h=(l=l||{}).fontSize||this.getFontSize(),d=l.font||this.getFont(),p=l.scaleFactor||this.internal.scaleFactor,m=0,w=0,b=0,x=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var E=l.maxWidth;E>0?typeof u=="string"?u=this.splitTextToSize(u,E):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce((function(N,F){return N.concat(x.splitTextToSize(F,E))}),[])):u=Array.isArray(u)?u:[u];for(var A=0;A<u.length;A++)m<(b=this.getStringUnitWidth(u[A],{font:d})*h)&&(m=b);return m!==0&&(w=u.length),{w:m/=p,h:Math.max((w*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/p,0)}},n.cellAddPage=function(){r.call(this),this.addPage();var u=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=n.cell=function(){var u;u=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var l=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,p=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return l.lineNumber!==void 0&&(l.lineNumber===u.lineNumber?(u.x=(l.x||0)+(l.width||0),u.y=l.y||0):l.y+l.height+u.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=d.top,m&&p&&(this.printHeaderRow(u.lineNumber,!0),u.y+=p[0].height)):u.y=l.y+l.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,t===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-h,u.y+h,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+h,{align:"center",baseline:"top",maxWidth:u.width-h-h}):this.text(u.text,u.x+h,u.y+h,{align:"left",baseline:"top",maxWidth:u.width-h-h})),this.internal.__cell__.lastCell=u,this};n.table=function(u,l,h,d,p){if(r.call(this),!h)throw new Error("No data for PDF table.");var m,w,b,x,E=[],A=[],N=[],F={},D={},W=[],k=[],C=(p=p||{}).autoSize||!1,L=p.printHeaders!==!1,B=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,R=p.margins||Object.assign({width:this.getPageWidth()},e),M=typeof p.padding=="number"?p.padding:3,U=p.headerBackgroundColor||"#c8c8c8",J=p.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=L,this.internal.__cell__.margins=R,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=M,this.internal.__cell__.headerBackgroundColor=U,this.internal.__cell__.headerTextColor=J,this.setFontSize(B),d==null)A=E=Object.keys(h[0]),N=E.map((function(){return"left"}));else if(Array.isArray(d)&&tr(d[0])==="object")for(E=d.map((function(se){return se.name})),A=d.map((function(se){return se.prompt||se.name||""})),N=d.map((function(se){return se.align||"left"})),m=0;m<d.length;m+=1)D[d[m].name]=d[m].width*(19.049976/25.4);else Array.isArray(d)&&typeof d[0]=="string"&&(A=E=d,N=E.map((function(){return"left"})));if(C||Array.isArray(d)&&typeof d[0]=="string")for(m=0;m<E.length;m+=1){for(F[x=E[m]]=h.map((function(se){return se[x]})),this.setFont(void 0,"bold"),W.push(this.getTextDimensions(A[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=F[x],this.setFont(void 0,"normal"),b=0;b<w.length;b+=1)W.push(this.getTextDimensions(w[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[x]=Math.max.apply(null,W)+M+M,W=[]}if(L){var de={};for(m=0;m<E.length;m+=1)de[E[m]]={},de[E[m]].text=A[m],de[E[m]].align=N[m];var fe=a.call(this,de,D);k=E.map((function(se){return new o(u,l,D[se],fe,de[se].text,void 0,de[se].align)})),this.setTableHeaderRow(k),this.printHeaderRow(1,!1)}var he=d.reduce((function(se,re){return se[re.name]=re.align,se}),{});for(m=0;m<h.length;m+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:m,data:h[m]},this);var K=a.call(this,h[m],D);for(b=0;b<E.length;b+=1){var le=h[m][E[b]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:m,col:b,data:le},this),s.call(this,new o(u,l,D[E[b]],K,le,m+2,he[E[b]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=l,this};var a=function(u,l){var h=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(u).map((function(m){var w=u[m];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,l[m]-h-h)}),this).map((function(m){return this.getLineHeightFactor()*m.length*d/p+h+h}),this).reduce((function(m,w){return Math.max(m,w)}),0)};n.setTableHeaderRow=function(u){r.call(this),this.internal.__cell__.tableHeaderRow=u},n.printHeaderRow=function(u,l){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){h=this.internal.__cell__.tableHeaderRow[m].clone(),l&&(h.y=this.internal.__cell__.margins.top||0,p.push(h)),h.lineNumber=u;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,h),this.setTextColor(w)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),t=!1}})(Xt.API);var BT={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},VT=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],ew=OT(VT),jT=[100,200,300,400,500,600,700,800,900],gU=OT(jT);function tw(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(o){return BT[o=o||"normal"]?o:"normal"})(n.style),r=(function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}})(n.weight),i=(function(o){return typeof ew[o=o||"normal"]=="number"?o:"normal"})(n.stretch);return{family:e,style:t,weight:r,stretch:i,src:n.src||[],ref:n.ref||{name:e,style:[i,t,r].join(" ")}}}function RS(n,e,t,r){var i;for(i=t;i>=0&&i<e.length;i+=r)if(n[e[i]])return n[e[i]];for(i=t;i>=0&&i<e.length;i-=r)if(n[e[i]])return n[e[i]]}var vU={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},DS={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function LS(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function yU(n,e,t){for(var r=(t=t||{}).defaultFontFamily||"times",i=Object.assign({},vU,t.genericFontFamilies||{}),o=null,s=null,a=0;a<e.length;++a)if(i[(o=tw(e[a])).family]&&(o.family=i[o.family]),n.hasOwnProperty(o.family)){s=n[o.family];break}if(!(s=s||n[r]))throw new Error("Could not find a font-family for the rule '"+LS(o)+"' and default family '"+r+"'.");if(s=(function(u,l){if(l[u])return l[u];var h=ew[u],d=h<=ew.normal?-1:1,p=RS(l,VT,h,d);if(!p)throw new Error("Could not find a matching font-stretch value for "+u);return p})(o.stretch,s),s=(function(u,l){if(l[u])return l[u];for(var h=BT[u],d=0;d<h.length;++d)if(l[h[d]])return l[h[d]];throw new Error("Could not find a matching font-style for "+u)})(o.style,s),!(s=(function(u,l){if(l[u])return l[u];if(u===400&&l[500])return l[500];if(u===500&&l[400])return l[400];var h=gU[u],d=RS(l,jT,h,u<400?-1:1);if(!d)throw new Error("Could not find a matching font-weight for value "+u);return d})(o.weight,s)))throw new Error("Failed to resolve a font for the rule '"+LS(o)+"'.");return s}function MS(n){return n.trimLeft()}function wU(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function bU(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var ev,FS,OS,qy=["times"];(function(n){var e,t,r,i,o,s,a,u,l,h=function(j){return j=j||{},this.isStrokeTransparent=j.isStrokeTransparent||!1,this.strokeOpacity=j.strokeOpacity||1,this.strokeStyle=j.strokeStyle||"#000000",this.fillStyle=j.fillStyle||"#000000",this.isFillTransparent=j.isFillTransparent||!1,this.fillOpacity=j.fillOpacity||1,this.font=j.font||"10px sans-serif",this.textBaseline=j.textBaseline||"alphabetic",this.textAlign=j.textAlign||"left",this.lineWidth=j.lineWidth||1,this.lineJoin=j.lineJoin||"miter",this.lineCap=j.lineCap||"butt",this.path=j.path||[],this.transform=j.transform!==void 0?j.transform.clone():new u,this.globalCompositeOperation=j.globalCompositeOperation||"normal",this.globalAlpha=j.globalAlpha||1,this.clip_path=j.clip_path||[],this.currentPoint=j.currentPoint||new s,this.miterLimit=j.miterLimit||10,this.lastPoint=j.lastPoint||new s,this.lineDashOffset=j.lineDashOffset||0,this.lineDash=j.lineDash||[],this.margin=j.margin||[0,0,0,0],this.prevPageLastElemOffset=j.prevPageLastElemOffset||0,this.ignoreClearRect=typeof j.ignoreClearRect!="boolean"||j.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,a=this.internal.Rectangle,u=this.internal.Matrix,l=new h}]);var d=function(j){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var $=j;Object.defineProperty(this,"pdf",{get:function(){return $}});var ne=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return ne},set:function(_e){ne=!!_e}});var ce=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ce},set:function(_e){ce=!!_e}});var ge=0;Object.defineProperty(this,"posX",{get:function(){return ge},set:function(_e){isNaN(_e)||(ge=_e)}});var ye=0;Object.defineProperty(this,"posY",{get:function(){return ye},set:function(_e){isNaN(_e)||(ye=_e)}}),Object.defineProperty(this,"margin",{get:function(){return l.margin},set:function(_e){var ie;typeof _e=="number"?ie=[_e,_e,_e,_e]:((ie=new Array(4))[0]=_e[0],ie[1]=_e.length>=2?_e[1]:ie[0],ie[2]=_e.length>=3?_e[2]:ie[0],ie[3]=_e.length>=4?_e[3]:ie[1]),l.margin=ie}});var be=!1;Object.defineProperty(this,"autoPaging",{get:function(){return be},set:function(_e){be=_e}});var Ae=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ae},set:function(_e){Ae=_e}});var $e=[];Object.defineProperty(this,"pageBreaks",{get:function(){return $e},set:function(_e){$e=_e}}),Object.defineProperty(this,"ctx",{get:function(){return l},set:function(_e){_e instanceof h&&(l=_e)}}),Object.defineProperty(this,"path",{get:function(){return l.path},set:function(_e){l.path=_e}});var Ue=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ue},set:function(_e){Ue=_e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(_e){var ie;ie=p(_e),this.ctx.fillStyle=ie.style,this.ctx.isFillTransparent=ie.a===0,this.ctx.fillOpacity=ie.a,this.pdf.setFillColor(ie.r,ie.g,ie.b,{a:ie.a}),this.pdf.setTextColor(ie.r,ie.g,ie.b,{a:ie.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(_e){var ie=p(_e);this.ctx.strokeStyle=ie.style,this.ctx.isStrokeTransparent=ie.a===0,this.ctx.strokeOpacity=ie.a,ie.a===0?this.pdf.setDrawColor(255,255,255):(ie.a,this.pdf.setDrawColor(ie.r,ie.g,ie.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(_e){["butt","round","square"].indexOf(_e)!==-1&&(this.ctx.lineCap=_e,this.pdf.setLineCap(_e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(_e){isNaN(_e)||(this.ctx.lineWidth=_e,this.pdf.setLineWidth(_e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(_e){["bevel","round","miter"].indexOf(_e)!==-1&&(this.ctx.lineJoin=_e,this.pdf.setLineJoin(_e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(_e){isNaN(_e)||(this.ctx.miterLimit=_e,this.pdf.setMiterLimit(_e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(_e){this.ctx.textBaseline=_e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(_e){["right","end","center","left","start"].indexOf(_e)!==-1&&(this.ctx.textAlign=_e)}});var et=null;function Je(_e,ie){if(et===null){var ft=(function(dt){var Ze=[];return Object.keys(dt).forEach((function(at){dt[at].forEach((function(lt){var ct=null;switch(lt){case"bold":ct={family:at,weight:"bold"};break;case"italic":ct={family:at,style:"italic"};break;case"bolditalic":ct={family:at,weight:"bold",style:"italic"};break;case"":case"normal":ct={family:at}}ct!==null&&(ct.ref={name:at,style:lt},Ze.push(ct))}))})),Ze})(_e.getFontList());et=(function(dt){for(var Ze={},at=0;at<dt.length;++at){var lt=tw(dt[at]),ct=lt.family,xt=lt.stretch,Vt=lt.style,jt=lt.weight;Ze[ct]=Ze[ct]||{},Ze[ct][xt]=Ze[ct][xt]||{},Ze[ct][xt][Vt]=Ze[ct][xt][Vt]||{},Ze[ct][xt][Vt][jt]=lt}return Ze})(ft.concat(ie))}return et}var Be=null;Object.defineProperty(this,"fontFaces",{get:function(){return Be},set:function(_e){et=null,Be=_e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(_e){var ie;if(this.ctx.font=_e,(ie=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(_e))!==null){var ft=ie[1],dt=(ie[2],ie[3]),Ze=ie[4],at=(ie[5],ie[6]),lt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ze)[2];Ze=Math.floor(lt==="px"?parseFloat(Ze)*this.pdf.internal.scaleFactor:lt==="em"?parseFloat(Ze)*this.pdf.getFontSize():parseFloat(Ze)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ze);var ct=(function(Ut){var en,pt,ar=[],dn=Ut.trim();if(dn==="")return qy;if(dn in DS)return[DS[dn]];for(;dn!=="";){switch(pt=null,en=(dn=MS(dn)).charAt(0)){case'"':case"'":pt=wU(dn.substring(1),en);break;default:pt=bU(dn)}if(pt===null||(ar.push(pt[0]),(dn=MS(pt[1]))!==""&&dn.charAt(0)!==","))return qy;dn=dn.replace(/^,/,"")}return ar})(at);if(this.fontFaces){var xt=yU(Je(this.pdf,this.fontFaces),ct.map((function(Ut){return{family:Ut,stretch:"normal",weight:dt,style:ft}})));this.pdf.setFont(xt.ref.name,xt.ref.style)}else{var Vt="";(dt==="bold"||parseInt(dt,10)>=700||ft==="bold")&&(Vt="bold"),ft==="italic"&&(Vt+="italic"),Vt.length===0&&(Vt="normal");for(var jt="",Pt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Lt=0;Lt<ct.length;Lt++){if(this.pdf.internal.getFont(ct[Lt],Vt,{noFallback:!0,disableWarning:!0})!==void 0){jt=ct[Lt];break}if(Vt==="bolditalic"&&this.pdf.internal.getFont(ct[Lt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)jt=ct[Lt],Vt="bold";else if(this.pdf.internal.getFont(ct[Lt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){jt=ct[Lt],Vt="normal";break}}if(jt===""){for(var Yt=0;Yt<ct.length;Yt++)if(Pt[ct[Yt]]){jt=Pt[ct[Yt]];break}}jt=jt===""?"Times":jt,this.pdf.setFont(jt,Vt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(_e){this.ctx.globalCompositeOperation=_e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(_e){this.ctx.globalAlpha=_e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(_e){this.ctx.lineDashOffset=_e,re.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(_e){this.ctx.lineDash=_e,re.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(_e){this.ctx.ignoreClearRect=!!_e}})};d.prototype.setLineDash=function(j){this.lineDash=j},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){F.call(this,"fill",!1)},d.prototype.stroke=function(){F.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(j,$){if(isNaN(j)||isNaN($))throw sr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var ne=this.ctx.transform.applyToPoint(new s(j,$));this.path.push({type:"mt",x:ne.x,y:ne.y}),this.ctx.lastPoint=new s(j,$)},d.prototype.closePath=function(){var j=new s(0,0),$=0;for($=this.path.length-1;$!==-1;$--)if(this.path[$].type==="begin"&&tr(this.path[$+1])==="object"&&typeof this.path[$+1].x=="number"){j=new s(this.path[$+1].x,this.path[$+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(j.x,j.y)},d.prototype.lineTo=function(j,$){if(isNaN(j)||isNaN($))throw sr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var ne=this.ctx.transform.applyToPoint(new s(j,$));this.path.push({type:"lt",x:ne.x,y:ne.y}),this.ctx.lastPoint=new s(ne.x,ne.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),F.call(this,null,!0)},d.prototype.quadraticCurveTo=function(j,$,ne,ce){if(isNaN(ne)||isNaN(ce)||isNaN(j)||isNaN($))throw sr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ge=this.ctx.transform.applyToPoint(new s(ne,ce)),ye=this.ctx.transform.applyToPoint(new s(j,$));this.path.push({type:"qct",x1:ye.x,y1:ye.y,x:ge.x,y:ge.y}),this.ctx.lastPoint=new s(ge.x,ge.y)},d.prototype.bezierCurveTo=function(j,$,ne,ce,ge,ye){if(isNaN(ge)||isNaN(ye)||isNaN(j)||isNaN($)||isNaN(ne)||isNaN(ce))throw sr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var be=this.ctx.transform.applyToPoint(new s(ge,ye)),Ae=this.ctx.transform.applyToPoint(new s(j,$)),$e=this.ctx.transform.applyToPoint(new s(ne,ce));this.path.push({type:"bct",x1:Ae.x,y1:Ae.y,x2:$e.x,y2:$e.y,x:be.x,y:be.y}),this.ctx.lastPoint=new s(be.x,be.y)},d.prototype.arc=function(j,$,ne,ce,ge,ye){if(isNaN(j)||isNaN($)||isNaN(ne)||isNaN(ce)||isNaN(ge))throw sr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ye=!!ye,!this.ctx.transform.isIdentity){var be=this.ctx.transform.applyToPoint(new s(j,$));j=be.x,$=be.y;var Ae=this.ctx.transform.applyToPoint(new s(0,ne)),$e=this.ctx.transform.applyToPoint(new s(0,0));ne=Math.sqrt(Math.pow(Ae.x-$e.x,2)+Math.pow(Ae.y-$e.y,2))}Math.abs(ge-ce)>=2*Math.PI&&(ce=0,ge=2*Math.PI),this.path.push({type:"arc",x:j,y:$,radius:ne,startAngle:ce,endAngle:ge,counterclockwise:ye})},d.prototype.arcTo=function(j,$,ne,ce,ge){throw new Error("arcTo not implemented.")},d.prototype.rect=function(j,$,ne,ce){if(isNaN(j)||isNaN($)||isNaN(ne)||isNaN(ce))throw sr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(j,$),this.lineTo(j+ne,$),this.lineTo(j+ne,$+ce),this.lineTo(j,$+ce),this.lineTo(j,$),this.lineTo(j+ne,$),this.lineTo(j,$)},d.prototype.fillRect=function(j,$,ne,ce){if(isNaN(j)||isNaN($)||isNaN(ne)||isNaN(ce))throw sr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var ge={};this.lineCap!=="butt"&&(ge.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ge.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(j,$,ne,ce),this.fill(),ge.hasOwnProperty("lineCap")&&(this.lineCap=ge.lineCap),ge.hasOwnProperty("lineJoin")&&(this.lineJoin=ge.lineJoin)}},d.prototype.strokeRect=function(j,$,ne,ce){if(isNaN(j)||isNaN($)||isNaN(ne)||isNaN(ce))throw sr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(j,$,ne,ce),this.stroke())},d.prototype.clearRect=function(j,$,ne,ce){if(isNaN(j)||isNaN($)||isNaN(ne)||isNaN(ce))throw sr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(j,$,ne,ce))},d.prototype.save=function(j){j=typeof j!="boolean"||j;for(var $=this.pdf.internal.getCurrentPageInfo().pageNumber,ne=0;ne<this.pdf.internal.getNumberOfPages();ne++)this.pdf.setPage(ne+1),this.pdf.internal.out("q");if(this.pdf.setPage($),j){this.ctx.fontSize=this.pdf.internal.getFontSize();var ce=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ce}},d.prototype.restore=function(j){j=typeof j!="boolean"||j;for(var $=this.pdf.internal.getCurrentPageInfo().pageNumber,ne=0;ne<this.pdf.internal.getNumberOfPages();ne++)this.pdf.setPage(ne+1),this.pdf.internal.out("Q");this.pdf.setPage($),j&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(j){var $,ne,ce,ge;if(j.isCanvasGradient===!0&&(j=j.getColor()),!j)return{r:0,g:0,b:0,a:0,style:j};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(j))$=0,ne=0,ce=0,ge=0;else{var ye=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(j);if(ye!==null)$=parseInt(ye[1]),ne=parseInt(ye[2]),ce=parseInt(ye[3]),ge=1;else if((ye=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(j))!==null)$=parseInt(ye[1]),ne=parseInt(ye[2]),ce=parseInt(ye[3]),ge=parseFloat(ye[4]);else{if(ge=1,typeof j=="string"&&j.charAt(0)!=="#"){var be=new PT(j);j=be.ok?be.toHex():"#000000"}j.length===4?($=j.substring(1,2),$+=$,ne=j.substring(2,3),ne+=ne,ce=j.substring(3,4),ce+=ce):($=j.substring(1,3),ne=j.substring(3,5),ce=j.substring(5,7)),$=parseInt($,16),ne=parseInt(ne,16),ce=parseInt(ce,16)}}return{r:$,g:ne,b:ce,a:ge,style:j}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(j,$,ne,ce){if(isNaN($)||isNaN(ne)||typeof j!="string")throw sr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ce=isNaN(ce)?void 0:ce,!m.call(this)){var ge=K(this.ctx.transform.rotation),ye=this.ctx.transform.scaleX;M.call(this,{text:j,x:$,y:ne,scale:ye,angle:ge,align:this.textAlign,maxWidth:ce})}},d.prototype.strokeText=function(j,$,ne,ce){if(isNaN($)||isNaN(ne)||typeof j!="string")throw sr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){ce=isNaN(ce)?void 0:ce;var ge=K(this.ctx.transform.rotation),ye=this.ctx.transform.scaleX;M.call(this,{text:j,x:$,y:ne,scale:ye,renderingMode:"stroke",angle:ge,align:this.textAlign,maxWidth:ce})}},d.prototype.measureText=function(j){if(typeof j!="string")throw sr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var $=this.pdf,ne=this.pdf.internal.scaleFactor,ce=$.internal.getFontSize(),ge=$.getStringUnitWidth(j)*ce/$.internal.scaleFactor,ye=function(be){var Ae=(be=be||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Ae}}),this};return new ye({width:ge*=Math.round(96*ne/72*1e4)/1e4})},d.prototype.scale=function(j,$){if(isNaN(j)||isNaN($))throw sr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var ne=new u(j,0,0,$,0,0);this.ctx.transform=this.ctx.transform.multiply(ne)},d.prototype.rotate=function(j){if(isNaN(j))throw sr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var $=new u(Math.cos(j),Math.sin(j),-Math.sin(j),Math.cos(j),0,0);this.ctx.transform=this.ctx.transform.multiply($)},d.prototype.translate=function(j,$){if(isNaN(j)||isNaN($))throw sr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var ne=new u(1,0,0,1,j,$);this.ctx.transform=this.ctx.transform.multiply(ne)},d.prototype.transform=function(j,$,ne,ce,ge,ye){if(isNaN(j)||isNaN($)||isNaN(ne)||isNaN(ce)||isNaN(ge)||isNaN(ye))throw sr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var be=new u(j,$,ne,ce,ge,ye);this.ctx.transform=this.ctx.transform.multiply(be)},d.prototype.setTransform=function(j,$,ne,ce,ge,ye){j=isNaN(j)?1:j,$=isNaN($)?0:$,ne=isNaN(ne)?0:ne,ce=isNaN(ce)?1:ce,ge=isNaN(ge)?0:ge,ye=isNaN(ye)?0:ye,this.ctx.transform=new u(j,$,ne,ce,ge,ye)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(j,$,ne,ce,ge,ye,be,Ae,$e){var Ue=this.pdf.getImageProperties(j),et=1,Je=1,Be=1,_e=1;ce!==void 0&&Ae!==void 0&&(Be=Ae/ce,_e=$e/ge,et=Ue.width/ce*Ae/ce,Je=Ue.height/ge*$e/ge),ye===void 0&&(ye=$,be=ne,$=0,ne=0),ce!==void 0&&Ae===void 0&&(Ae=ce,$e=ge),ce===void 0&&Ae===void 0&&(Ae=Ue.width,$e=Ue.height);for(var ie,ft=this.ctx.transform.decompose(),dt=K(ft.rotate.shx),Ze=new u,at=(Ze=(Ze=(Ze=Ze.multiply(ft.translate)).multiply(ft.skew)).multiply(ft.scale)).applyToRectangle(new a(ye-$*Be,be-ne*_e,ce*et,ge*Je)),lt=x.call(this,at),ct=[],xt=0;xt<lt.length;xt+=1)ct.indexOf(lt[xt])===-1&&ct.push(lt[xt]);if(N(ct),this.autoPaging)for(var Vt=ct[0],jt=ct[ct.length-1],Pt=Vt;Pt<jt+1;Pt++){this.pdf.setPage(Pt);var Lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Yt=Pt===1?this.posY+this.margin[0]:this.margin[0],Ut=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],en=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],pt=Pt===1?0:Ut+(Pt-2)*en;if(this.ctx.clip_path.length!==0){var ar=this.path;ie=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=A(ie,this.posX+this.margin[3],-pt+Yt+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=ar}var dn=JSON.parse(JSON.stringify(at));dn=A([dn],this.posX+this.margin[3],-pt+Yt+this.ctx.prevPageLastElemOffset)[0];var qr=(Pt>Vt||Pt<jt)&&b.call(this);qr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lt,en,null).clip().discardPath()),this.pdf.addImage(j,"JPEG",dn.x,dn.y,dn.w,dn.h,null,null,dt),qr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(j,"JPEG",at.x,at.y,at.w,at.h,null,null,dt)};var x=function(j,$,ne){var ce=[];$=$||this.pdf.internal.pageSize.width,ne=ne||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ge=this.posY+this.ctx.prevPageLastElemOffset;switch(j.type){default:case"mt":case"lt":ce.push(Math.floor((j.y+ge)/ne)+1);break;case"arc":ce.push(Math.floor((j.y+ge-j.radius)/ne)+1),ce.push(Math.floor((j.y+ge+j.radius)/ne)+1);break;case"qct":var ye=le(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x,j.y);ce.push(Math.floor((ye.y+ge)/ne)+1),ce.push(Math.floor((ye.y+ye.h+ge)/ne)+1);break;case"bct":var be=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x2,j.y2,j.x,j.y);ce.push(Math.floor((be.y+ge)/ne)+1),ce.push(Math.floor((be.y+be.h+ge)/ne)+1);break;case"rect":ce.push(Math.floor((j.y+ge)/ne)+1),ce.push(Math.floor((j.y+j.h+ge)/ne)+1)}for(var Ae=0;Ae<ce.length;Ae+=1)for(;this.pdf.internal.getNumberOfPages()<ce[Ae];)E.call(this);return ce},E=function(){var j=this.fillStyle,$=this.strokeStyle,ne=this.font,ce=this.lineCap,ge=this.lineWidth,ye=this.lineJoin;this.pdf.addPage(),this.fillStyle=j,this.strokeStyle=$,this.font=ne,this.lineCap=ce,this.lineWidth=ge,this.lineJoin=ye},A=function(j,$,ne){for(var ce=0;ce<j.length;ce++)switch(j[ce].type){case"bct":j[ce].x2+=$,j[ce].y2+=ne;case"qct":j[ce].x1+=$,j[ce].y1+=ne;case"mt":case"lt":case"arc":default:j[ce].x+=$,j[ce].y+=ne}return j},N=function(j){return j.sort((function($,ne){return $-ne}))},F=function(j,$){for(var ne,ce,ge=this.fillStyle,ye=this.strokeStyle,be=this.lineCap,Ae=this.lineWidth,$e=Math.abs(Ae*this.ctx.transform.scaleX),Ue=this.lineJoin,et=JSON.parse(JSON.stringify(this.path)),Je=JSON.parse(JSON.stringify(this.path)),Be=[],_e=0;_e<Je.length;_e++)if(Je[_e].x!==void 0)for(var ie=x.call(this,Je[_e]),ft=0;ft<ie.length;ft+=1)Be.indexOf(ie[ft])===-1&&Be.push(ie[ft]);for(var dt=0;dt<Be.length;dt++)for(;this.pdf.internal.getNumberOfPages()<Be[dt];)E.call(this);if(N(Be),this.autoPaging)for(var Ze=Be[0],at=Be[Be.length-1],lt=Ze;lt<at+1;lt++){this.pdf.setPage(lt),this.fillStyle=ge,this.strokeStyle=ye,this.lineCap=be,this.lineWidth=$e,this.lineJoin=Ue;var ct=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xt=lt===1?this.posY+this.margin[0]:this.margin[0],Vt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],jt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Pt=lt===1?0:Vt+(lt-2)*jt;if(this.ctx.clip_path.length!==0){var Lt=this.path;ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=A(ne,this.posX+this.margin[3],-Pt+xt+this.ctx.prevPageLastElemOffset),D.call(this,j,!0),this.path=Lt}if(ce=JSON.parse(JSON.stringify(et)),this.path=A(ce,this.posX+this.margin[3],-Pt+xt+this.ctx.prevPageLastElemOffset),$===!1||lt===0){var Yt=(lt>Ze||lt<at)&&b.call(this);Yt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ct,jt,null).clip().discardPath()),D.call(this,j,$),Yt&&this.pdf.restoreGraphicsState()}this.lineWidth=Ae}else this.lineWidth=$e,D.call(this,j,$),this.lineWidth=Ae;this.path=et},D=function(j,$){if((j!=="stroke"||$||!w.call(this))&&(j==="stroke"||$||!m.call(this))){for(var ne,ce,ge=[],ye=this.path,be=0;be<ye.length;be++){var Ae=ye[be];switch(Ae.type){case"begin":ge.push({begin:!0});break;case"close":ge.push({close:!0});break;case"mt":ge.push({start:Ae,deltas:[],abs:[]});break;case"lt":var $e=ge.length;if(ye[be-1]&&!isNaN(ye[be-1].x)&&(ne=[Ae.x-ye[be-1].x,Ae.y-ye[be-1].y],$e>0)){for(;$e>=0;$e--)if(ge[$e-1].close!==!0&&ge[$e-1].begin!==!0){ge[$e-1].deltas.push(ne),ge[$e-1].abs.push(Ae);break}}break;case"bct":ne=[Ae.x1-ye[be-1].x,Ae.y1-ye[be-1].y,Ae.x2-ye[be-1].x,Ae.y2-ye[be-1].y,Ae.x-ye[be-1].x,Ae.y-ye[be-1].y],ge[ge.length-1].deltas.push(ne);break;case"qct":var Ue=ye[be-1].x+2/3*(Ae.x1-ye[be-1].x),et=ye[be-1].y+2/3*(Ae.y1-ye[be-1].y),Je=Ae.x+2/3*(Ae.x1-Ae.x),Be=Ae.y+2/3*(Ae.y1-Ae.y),_e=Ae.x,ie=Ae.y;ne=[Ue-ye[be-1].x,et-ye[be-1].y,Je-ye[be-1].x,Be-ye[be-1].y,_e-ye[be-1].x,ie-ye[be-1].y],ge[ge.length-1].deltas.push(ne);break;case"arc":ge.push({deltas:[],abs:[],arc:!0}),Array.isArray(ge[ge.length-1].abs)&&ge[ge.length-1].abs.push(Ae)}}ce=$?null:j==="stroke"?"stroke":"fill";for(var ft=!1,dt=0;dt<ge.length;dt++)if(ge[dt].arc)for(var Ze=ge[dt].abs,at=0;at<Ze.length;at++){var lt=Ze[at];lt.type==="arc"?C.call(this,lt.x,lt.y,lt.radius,lt.startAngle,lt.endAngle,lt.counterclockwise,void 0,$,!ft):U.call(this,lt.x,lt.y),ft=!0}else if(ge[dt].close===!0)this.pdf.internal.out("h"),ft=!1;else if(ge[dt].begin!==!0){var ct=ge[dt].start.x,xt=ge[dt].start.y;J.call(this,ge[dt].deltas,ct,xt),ft=!0}ce&&L.call(this,ce),$&&B.call(this)}},W=function(j){var $=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,ne=$*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return j-ne;case"top":return j+$-ne;case"hanging":return j+$-2*ne;case"middle":return j+$/2-ne;case"ideographic":return j;case"alphabetic":default:return j}},k=function(j){return j+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var j=function(){};return j.colorStops=[],j.addColorStop=function($,ne){this.colorStops.push([$,ne])},j.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},j.isCanvasGradient=!0,j},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(j,$,ne,ce,ge,ye,be,Ae,$e){for(var Ue=fe.call(this,ne,ce,ge,ye),et=0;et<Ue.length;et++){var Je=Ue[et];et===0&&($e?R.call(this,Je.x1+j,Je.y1+$):U.call(this,Je.x1+j,Je.y1+$)),de.call(this,j,$,Je.x2,Je.y2,Je.x3,Je.y3,Je.x4,Je.y4)}Ae?B.call(this):L.call(this,be)},L=function(j){switch(j){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},R=function(j,$){this.pdf.internal.out(t(j)+" "+r($)+" m")},M=function(j){var $;switch(j.align){case"right":case"end":$="right";break;case"center":$="center";break;case"left":case"start":default:$="left"}var ne=this.pdf.getTextDimensions(j.text),ce=W.call(this,j.y),ge=k.call(this,ce)-ne.h,ye=this.ctx.transform.applyToPoint(new s(j.x,ce)),be=this.ctx.transform.decompose(),Ae=new u;Ae=(Ae=(Ae=Ae.multiply(be.translate)).multiply(be.skew)).multiply(be.scale);for(var $e,Ue,et,Je=this.ctx.transform.applyToRectangle(new a(j.x,ce,ne.w,ne.h)),Be=Ae.applyToRectangle(new a(j.x,ge,ne.w,ne.h)),_e=x.call(this,Be),ie=[],ft=0;ft<_e.length;ft+=1)ie.indexOf(_e[ft])===-1&&ie.push(_e[ft]);if(N(ie),this.autoPaging)for(var dt=ie[0],Ze=ie[ie.length-1],at=dt;at<Ze+1;at++){this.pdf.setPage(at);var lt=at===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],xt=this.pdf.internal.pageSize.height-this.margin[2],Vt=xt-this.margin[0],jt=this.pdf.internal.pageSize.width-this.margin[1],Pt=jt-this.margin[3],Lt=at===1?0:ct+(at-2)*Vt;if(this.ctx.clip_path.length!==0){var Yt=this.path;$e=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=A($e,this.posX+this.margin[3],-1*Lt+lt),D.call(this,"fill",!0),this.path=Yt}var Ut=A([JSON.parse(JSON.stringify(Be))],this.posX+this.margin[3],-Lt+lt+this.ctx.prevPageLastElemOffset)[0];j.scale>=.01&&(Ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ue*j.scale),et=this.lineWidth,this.lineWidth=et*j.scale);var en=this.autoPaging!=="text";if(en||Ut.y+Ut.h<=xt){if(en||Ut.y>=lt&&Ut.x<=jt){var pt=en?j.text:this.pdf.splitTextToSize(j.text,j.maxWidth||jt-Ut.x)[0],ar=A([JSON.parse(JSON.stringify(Je))],this.posX+this.margin[3],-Lt+lt+this.ctx.prevPageLastElemOffset)[0],dn=en&&(at>dt||at<Ze)&&b.call(this);dn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pt,Vt,null).clip().discardPath()),this.pdf.text(pt,ar.x,ar.y,{angle:j.angle,align:$,renderingMode:j.renderingMode}),dn&&this.pdf.restoreGraphicsState()}}else Ut.y<xt&&(this.ctx.prevPageLastElemOffset+=xt-Ut.y);j.scale>=.01&&(this.pdf.setFontSize(Ue),this.lineWidth=et)}else j.scale>=.01&&(Ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ue*j.scale),et=this.lineWidth,this.lineWidth=et*j.scale),this.pdf.text(j.text,ye.x+this.posX,ye.y+this.posY,{angle:j.angle,align:$,renderingMode:j.renderingMode,maxWidth:j.maxWidth}),j.scale>=.01&&(this.pdf.setFontSize(Ue),this.lineWidth=et)},U=function(j,$,ne,ce){ne=ne||0,ce=ce||0,this.pdf.internal.out(t(j+ne)+" "+r($+ce)+" l")},J=function(j,$,ne){return this.pdf.lines(j,$,ne,null,null)},de=function(j,$,ne,ce,ge,ye,be,Ae){this.pdf.internal.out([e(i(ne+j)),e(o(ce+$)),e(i(ge+j)),e(o(ye+$)),e(i(be+j)),e(o(Ae+$)),"c"].join(" "))},fe=function(j,$,ne,ce){for(var ge=2*Math.PI,ye=Math.PI/2;$>ne;)$-=ge;var be=Math.abs(ne-$);be<ge&&ce&&(be=ge-be);for(var Ae=[],$e=ce?-1:1,Ue=$;be>1e-5;){var et=Ue+$e*Math.min(be,ye);Ae.push(he.call(this,j,Ue,et)),be-=Math.abs(et-Ue),Ue=et}return Ae},he=function(j,$,ne){var ce=(ne-$)/2,ge=j*Math.cos(ce),ye=j*Math.sin(ce),be=ge,Ae=-ye,$e=be*be+Ae*Ae,Ue=$e+be*ge+Ae*ye,et=4/3*(Math.sqrt(2*$e*Ue)-Ue)/(be*ye-Ae*ge),Je=be-et*Ae,Be=Ae+et*be,_e=Je,ie=-Be,ft=ce+$,dt=Math.cos(ft),Ze=Math.sin(ft);return{x1:j*Math.cos($),y1:j*Math.sin($),x2:Je*dt-Be*Ze,y2:Je*Ze+Be*dt,x3:_e*dt-ie*Ze,y3:_e*Ze+ie*dt,x4:j*Math.cos(ne),y4:j*Math.sin(ne)}},K=function(j){return 180*j/Math.PI},le=function(j,$,ne,ce,ge,ye){var be=j+.5*(ne-j),Ae=$+.5*(ce-$),$e=ge+.5*(ne-ge),Ue=ye+.5*(ce-ye),et=Math.min(j,ge,be,$e),Je=Math.max(j,ge,be,$e),Be=Math.min($,ye,Ae,Ue),_e=Math.max($,ye,Ae,Ue);return new a(et,Be,Je-et,_e-Be)},se=function(j,$,ne,ce,ge,ye,be,Ae){var $e,Ue,et,Je,Be,_e,ie,ft,dt,Ze,at,lt,ct,xt,Vt=ne-j,jt=ce-$,Pt=ge-ne,Lt=ye-ce,Yt=be-ge,Ut=Ae-ye;for(Ue=0;Ue<41;Ue++)dt=(ie=(et=j+($e=Ue/40)*Vt)+$e*((Be=ne+$e*Pt)-et))+$e*(Be+$e*(ge+$e*Yt-Be)-ie),Ze=(ft=(Je=$+$e*jt)+$e*((_e=ce+$e*Lt)-Je))+$e*(_e+$e*(ye+$e*Ut-_e)-ft),Ue==0?(at=dt,lt=Ze,ct=dt,xt=Ze):(at=Math.min(at,dt),lt=Math.min(lt,Ze),ct=Math.max(ct,dt),xt=Math.max(xt,Ze));return new a(Math.round(at),Math.round(lt),Math.round(ct-at),Math.round(xt-lt))},re=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var j,$,ne=(j=this.ctx.lineDash,$=this.ctx.lineDashOffset,JSON.stringify({lineDash:j,lineDashOffset:$}));this.prevLineDash!==ne&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=ne)}}})(Xt.API),(function(n){var e=function(o){var s,a,u,l,h,d,p,m,w,b;for(a=[],u=0,l=(o+=s="\0\0\0\0".slice(o.length%4||4)).length;l>u;u+=4)(h=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(d=(h=((h=((h=((h=(h-(b=h%85))/85)-(w=h%85))/85)-(m=h%85))/85)-(p=h%85))/85)%85,a.push(d+33,p+33,m+33,w+33,b+33)):a.push(122);return(function(x,E){for(var A=E;A>0;A--)x.pop()})(a,s.length),String.fromCharCode.apply(String,a)+"~>"},t=function(o){var s,a,u,l,h,d=String,p="length",m=255,w="charCodeAt",b="slice",x="replace";for(o[b](-2),o=o[b](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),u=[],l=0,h=(o+=s="uuuuu"[b](o[p]%5||5))[p];h>l;l+=5)a=52200625*(o[w](l)-33)+614125*(o[w](l+1)-33)+7225*(o[w](l+2)-33)+85*(o[w](l+3)-33)+(o[w](l+4)-33),u.push(m&a>>24,m&a>>16,m&a>>8,m&a);return(function(E,A){for(var N=A;N>0;N--)E.pop()})(u,s[p]),d.fromCharCode.apply(d,u)},r=function(o){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),s.test(o)===!1)return"";for(var a="",u=0;u<o.length;u+=2)a+=String.fromCharCode("0x"+(o[u]+o[u+1]));return a},i=function(o){for(var s=new Uint8Array(o.length),a=o.length;a--;)s[a]=o.charCodeAt(a);return o=(s=X2(s)).reduce((function(u,l){return u+String.fromCharCode(l)}),"")};n.processDataByFilters=function(o,s){var a=0,u=o||"",l=[];for(typeof(s=s||[])=="string"&&(s=[s]),a=0;a<s.length;a+=1)switch(s[a]){case"ASCII85Decode":case"/ASCII85Decode":u=t(u),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=r(u),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=u.split("").map((function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)})).join("")+">",l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=i(u),l.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[a]+'" is not implemented')}return{data:u,reverseChain:l.reverse().join(" ")}}})(Xt.API),(function(n){n.loadFile=function(e,t,r){return(function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var a=void 0;try{a=(function(u,l,h){var d=new XMLHttpRequest,p=0,m=function(w){var b=w.length,x=[],E=String.fromCharCode;for(p=0;p<b;p+=1)x.push(E(255&w.charCodeAt(p)));return x.join("")};if(d.open("GET",u,!l),d.overrideMimeType("text/plain; charset=x-user-defined"),l===!1&&(d.onload=function(){d.status===200?h(m(this.responseText)):h(void 0)}),d.send(null),l&&d.status===200)return m(d.responseText)})(i,o,s)}catch{}return a})(e,t,r)},n.loadImageFile=n.loadFile})(Xt.API),(function(n){function e(){return(Jt.html2canvas?Promise.resolve(Jt.html2canvas):q2(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch((function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))})).then((function(s){return s.default?s.default:s}))}function t(){return(Jt.DOMPurify?Promise.resolve(Jt.DOMPurify):q2(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch((function(s){return Promise.reject(new Error("Could not load dompurify: "+s))})).then((function(s){return s.default?s.default:s}))}var r=function(s){var a=tr(s);return a==="undefined"?"undefined":a==="string"||s instanceof String?"string":a==="number"||s instanceof Number?"number":a==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":a==="object"?"object":"unknown"},i=function(s,a){var u=document.createElement(s);for(var l in a.className&&(u.className=a.className),a.innerHTML&&a.dompurify&&(u.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)u.style[l]=a.style[l];return u},o=function s(a){var u=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),l=s.convert(Promise.resolve(),u);return l=(l=l.setProgress(1,s,1,[s])).set(a)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(s,a){return s.__proto__=a||o.prototype,s},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(s,a){return this.then((function(){switch(a=a||(function(u){switch(r(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(s)){case"string":return this.then(t).then((function(u){return this.set({src:i("div",{innerHTML:s,dompurify:u})})}));case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}}))},o.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=(function u(l,h){for(var d=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),p=l.firstChild;p;p=p.nextSibling)h!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||d.appendChild(u(p,h));return l.nodeType===1&&(l.nodeName==="CANVAS"?(d.width=l.width,d.height=l.height,d.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(d.value=l.value),d.addEventListener("load",(function(){d.scrollTop=l.scrollTop,d.scrollLeft=l.scrollLeft}),!0)),d})(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},o.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then((function(a){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,a(this.prop.container,u)})).then((function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)}))},o.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then((function(a){var u=this.opt.jsPDF,l=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=l,l)for(var p=0;p<l.length;++p){var m=l[p],w=m.src.find((function(b){return b.format==="truetype"}));w&&u.addFont(w.url,m.ref.name,m.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,u.context2d.save(!0),a(this.prop.container,d)})).then((function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)}))},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s}))},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},o.prototype.output=function(s,a,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(s,a):this.outputPdf(s,a)},o.prototype.outputPdf=function(s,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(s,a)}))},o.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}}))},o.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},o.prototype.set=function(s){if(r(s)!=="object")return this;var a=Object.keys(s||{}).map((function(u){if(u in o.template.prop)return function(){this.prop[u]=s[u]};switch(u){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[u]=s[u]}}}),this);return this.then((function(){return this.thenList(a)}))},o.prototype.get=function(s,a){return this.then((function(){var u=s in o.template.prop?this.prop[s]:this.opt[s];return a?a(u):u}))},o.prototype.setMargin=function(s){return this.then((function(){switch(r(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s})).then(this.setPageSize)},o.prototype.setPageSize=function(s){function a(u,l){return Math.floor(u*l/72*96)}return this.then((function(){(s=s||Xt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:a(s.inner.width,s.k),height:a(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s}))},o.prototype.setProgress=function(s,a,u,l){return s!=null&&(this.progress.val=s),a!=null&&(this.progress.state=a),u!=null&&(this.progress.n=u),l!=null&&(this.progress.stack=l),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(s,a,u,l){return this.setProgress(s?this.progress.val+s:null,a||null,u?this.progress.n+u:null,l?this.progress.stack.concat(l):null)},o.prototype.then=function(s,a){var u=this;return this.thenCore(s,a,(function(l,h){return u.updateProgress(null,null,1,[l]),Promise.prototype.then.call(this,(function(d){return u.updateProgress(null,l),d})).then(l,h).then((function(d){return u.updateProgress(1),d}))}))},o.prototype.thenCore=function(s,a,u){u=u||Promise.prototype.then,s&&(s=s.bind(this)),a&&(a=a.bind(this));var l=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),h=u.call(l,s,a);return o.convert(h,this.__proto__)},o.prototype.thenExternal=function(s,a){return Promise.prototype.then.call(this,s,a)},o.prototype.thenList=function(s){var a=this;return s.forEach((function(u){a=a.thenCore(u)})),a},o.prototype.catch=function(s){s&&(s=s.bind(this));var a=Promise.prototype.catch.call(this,s);return o.convert(a,this)},o.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},o.prototype.error=function(s){return this.then((function(){throw new Error(s)}))},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Xt.getPageSize=function(s,a,u){if(tr(s)==="object"){var l=s;s=l.orientation,a=l.unit||a,u=l.format||u}a=a||"mm",u=u||"a4",s=(""+(s||"P")).toLowerCase();var h,d=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+a}var m,w=0,b=0;if(p.hasOwnProperty(d))w=p[d][1]/h,b=p[d][0]/h;else try{w=u[1],b=u[0]}catch{throw new Error("Invalid format: "+u)}if(s==="p"||s==="portrait")s="p",b>w&&(m=b,b=w,w=m);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",w>b&&(m=b,b=w,w=m)}return{width:b,height:w,unit:a,k:h,orientation:s}},n.html=function(s,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map(tw):null;var u=new o(a);return a.worker?u:u.from(s).doCallback()}})(Xt.API),Xt.API.addJS=function(n){return OS=n,this.internal.events.subscribe("postPutResources",(function(){ev=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ev+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),FS=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+OS+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){ev!==void 0&&FS!==void 0&&this.internal.out("/Names <</JavaScript "+ev+" 0 R>>")})),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=t.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],a=r.exec(s);if(a!=null){var u=a[1];t.internal.newObjectDeferredBegin(u,!1)}t.internal.write(s)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,h=[];for(o=0;o<l;o++){var d=t.internal.newObject();h.push(d);var p=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var m=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<h.length;o++)t.internal.write("(page_"+(o+1)+")"+h[o]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+m+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,i,o){var s={title:i,options:o,children:[]};return r==null&&(r=this.root),r.children.push(s),s},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<r.children.length;o++){var s=r.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(r)),o>0&&this.line("/Prev "+this.makeRef(r.children[o-1])),o<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var a=this.count=this.count_r({count:0},s);if(a>0&&this.line("/Count "+a),s.options&&s.options.pageNumber){var u=t.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var l=0;l<r.children.length;l++)this.renderItems(r.children[l])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,i){for(var o=0;o<i.children.length;o++)r.count++,this.count_r(r,i.children[o]);return r.count}}])})(Xt.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,r,i,o,s,a){var u,l=this.decode.DCT_DECODE,h=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=s||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(u=(function(d){for(var p,m=256*d.charCodeAt(4)+d.charCodeAt(5),w=d.length,b={width:0,height:0,numcomponents:1},x=4;x<w;x+=2){if(x+=m,e.indexOf(d.charCodeAt(x+1))!==-1){p=256*d.charCodeAt(x+5)+d.charCodeAt(x+6),b={width:256*d.charCodeAt(x+7)+d.charCodeAt(x+8),height:p,numcomponents:d.charCodeAt(x+9)};break}m=256*d.charCodeAt(x+2)+d.charCodeAt(x+3)}return b})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}h={data:t,width:u.width,height:u.height,colorSpace:a,bitsPerComponent:8,filter:l,index:r,alias:i}}return h}})(Xt.API);var rd,tv,BS,VS,jS,xU=(function(){var n,e,t;function r(o){var s,a,u,l,h,d,p,m,w,b,x,E,A,N;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},d=null;;){switch(s=this.readUInt32(),w=(function(){var F,D;for(D=[],F=0;F<4;++F)D.push(String.fromCharCode(this.data[this.pos++]));return D}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":d&&this.animation.frames.push(d),this.pos+=4,d={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),l=this.readUInt16()||100,d.delay=1e3*h/l,d.disposeOp=this.data[this.pos++],d.blendOp=this.data[this.pos++],d.data=[];break;case"IDAT":case"fdAT":for(w==="fdAT"&&(this.pos+=4,s-=4),o=(d!=null?d.data:void 0)||this.imgData,E=0;0<=s?E<s:E>s;0<=s?++E:--E)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(u=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>u)throw new Error("More transparent colors than palette size");if((b=u-this.transparency.indexed.length)>0)for(A=0;0<=b?A<b:A>b;0<=b?++A:--A)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":p=(x=this.read(s)).indexOf(0),m=String.fromCharCode.apply(String,x.slice(0,p)),this.text[m]=String.fromCharCode.apply(String,x.slice(p+1));break;case"IEND":return d&&this.animation.frames.push(d),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(N=this.colorType)===4||N===6,a=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*a,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(o){var s,a;for(a=[],s=0;0<=o?s<o:s>o;0<=o?++s:--s)a.push(this.data[this.pos++]);return a},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(o){var s=this.pixelBitlength/8,a=new Uint8Array(this.width*this.height*s),u=0,l=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function h(d,p,m,w){var b,x,E,A,N,F,D,W,k,C,L,B,R,M,U,J,de,fe,he,K,le,se=Math.ceil((l.width-d)/m),re=Math.ceil((l.height-p)/w),j=l.width==se&&l.height==re;for(M=s*se,B=j?a:new Uint8Array(M*re),F=o.length,R=0,x=0;R<re&&u<F;){switch(o[u++]){case 0:for(A=de=0;de<M;A=de+=1)B[x++]=o[u++];break;case 1:for(A=fe=0;fe<M;A=fe+=1)b=o[u++],N=A<s?0:B[x-s],B[x++]=(b+N)%256;break;case 2:for(A=he=0;he<M;A=he+=1)b=o[u++],E=(A-A%s)/s,U=R&&B[(R-1)*M+E*s+A%s],B[x++]=(U+b)%256;break;case 3:for(A=K=0;K<M;A=K+=1)b=o[u++],E=(A-A%s)/s,N=A<s?0:B[x-s],U=R&&B[(R-1)*M+E*s+A%s],B[x++]=(b+Math.floor((N+U)/2))%256;break;case 4:for(A=le=0;le<M;A=le+=1)b=o[u++],E=(A-A%s)/s,N=A<s?0:B[x-s],R===0?U=J=0:(U=B[(R-1)*M+E*s+A%s],J=E&&B[(R-1)*M+(E-1)*s+A%s]),D=N+U-J,W=Math.abs(D-N),C=Math.abs(D-U),L=Math.abs(D-J),k=W<=C&&W<=L?N:C<=L?U:J,B[x++]=(b+k)%256;break;default:throw new Error("Invalid filter algorithm: "+o[u-1])}if(!j){var $=((p+R*w)*l.width+d)*s,ne=R*M;for(A=0;A<se;A+=1){for(var ce=0;ce<s;ce+=1)a[$++]=B[ne++];$+=(m-1)*s}}R++}}return o=Z9(o),l.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),a},r.prototype.decodePalette=function(){var o,s,a,u,l,h,d,p,m;for(a=this.palette,h=this.transparency.indexed||[],l=new Uint8Array((h.length||0)+a.length),u=0,o=0,s=d=0,p=a.length;d<p;s=d+=3)l[u++]=a[s],l[u++]=a[s+1],l[u++]=a[s+2],l[u++]=(m=h[o++])!=null?m:255;return l},r.prototype.copyToImageData=function(o,s){var a,u,l,h,d,p,m,w,b,x,E;if(u=this.colors,b=null,a=this.hasAlphaChannel,this.palette.length&&(b=(E=this._decodedPalette)!=null?E:this._decodedPalette=this.decodePalette(),u=4,a=!0),w=(l=o.data||o).length,d=b||s,h=p=0,u===1)for(;h<w;)m=b?4*s[h/4]:p,x=d[m++],l[h++]=x,l[h++]=x,l[h++]=x,l[h++]=a?d[m++]:255,p=m;else for(;h<w;)m=b?4*s[h/4]:p,l[h++]=d[m++],l[h++]=d[m++],l[h++]=d[m++],l[h++]=a?d[m++]:255,p=m},r.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var i=function(){if(Object.prototype.toString.call(Jt)==="[object Window]"){try{e=Jt.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),n=function(o){var s;if(i()===!0)return t.width=o.width,t.height=o.height,t.clearRect(0,0,o.width,o.height),t.putImageData(o,0,0),(s=new Image).src=e.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(o){var s,a,u,l,h,d,p,m;if(this.animation){for(m=[],a=h=0,d=(p=this.animation.frames).length;h<d;a=++h)s=p[a],u=o.createImageData(s.width,s.height),l=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(u,l),s.imageData=u,m.push(s.image=n(u));return m}},r.prototype.renderFrame=function(o,s){var a,u,l;return a=(u=this.animation.frames)[s],l=u[s-1],s===0&&o.clearRect(0,0,this.width,this.height),(l!=null?l.disposeOp:void 0)===1?o.clearRect(l.xOffset,l.yOffset,l.width,l.height):(l!=null?l.disposeOp:void 0)===2&&o.putImageData(l.imageData,l.xOffset,l.yOffset),a.blendOp===0&&o.clearRect(a.xOffset,a.yOffset,a.width,a.height),o.drawImage(a.image,a.xOffset,a.yOffset)},r.prototype.animate=function(o){var s,a,u,l,h,d,p=this;return a=0,d=this.animation,l=d.numFrames,u=d.frames,h=d.numPlays,(s=function(){var m,w;if(m=a++%l,w=u[m],p.renderFrame(o,m),l>1&&a/l<h)return p.animation._timeout=setTimeout(s,w.delay)})()},r.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},r.prototype.render=function(o){var s,a;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,s=o.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(a=s.createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),s.putImageData(a,0,0))},r})();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function _U(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,r=n[e++]|n[e++]<<8,i=n[e++],o=i>>7,s=1<<(7&i)+1;n[e++],n[e++];var a=null,u=null;o&&(a=e,u=s,e+=3*s);var l=!0,h=[],d=0,p=null,m=0,w=null;for(this.width=t,this.height=r;l&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,w=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((R=n[e++])>=0))throw Error("Invalid block size");if(R===0)break;e+=R}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var b=n[e++];d=n[e++]|n[e++]<<8,p=n[e++],(1&b)==0&&(p=null),m=b>>2&7,e++;break;case 254:for(;;){if(!((R=n[e++])>=0))throw Error("Invalid block size");if(R===0)break;e+=R}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var x=n[e++]|n[e++]<<8,E=n[e++]|n[e++]<<8,A=n[e++]|n[e++]<<8,N=n[e++]|n[e++]<<8,F=n[e++],D=F>>6&1,W=1<<(7&F)+1,k=a,C=u,L=!1;F>>7&&(L=!0,k=e,C=W,e+=3*W);var B=e;for(e++;;){var R;if(!((R=n[e++])>=0))throw Error("Invalid block size");if(R===0)break;e+=R}h.push({x,y:E,width:A,height:N,has_local_palette:L,palette_offset:k,palette_size:C,data_offset:B,data_length:e-B,transparent_index:p,interlaced:!!D,delay:d,disposal:m});break;case 59:l=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return w},this.frameInfo=function(M){if(M<0||M>=h.length)throw new Error("Frame index out of range.");return h[M]},this.decodeAndBlitFrameBGRA=function(M,U){var J=this.frameInfo(M),de=J.width*J.height,fe=new Uint8Array(de);US(n,J.data_offset,fe,de);var he=J.palette_offset,K=J.transparent_index;K===null&&(K=256);var le=J.width,se=t-le,re=le,j=4*(J.y*t+J.x),$=4*((J.y+J.height)*t+J.x),ne=j,ce=4*se;J.interlaced===!0&&(ce+=4*t*7);for(var ge=8,ye=0,be=fe.length;ye<be;++ye){var Ae=fe[ye];if(re===0&&(re=le,(ne+=ce)>=$&&(ce=4*se+4*t*(ge-1),ne=j+(le+se)*(ge<<1),ge>>=1)),Ae===K)ne+=4;else{var $e=n[he+3*Ae],Ue=n[he+3*Ae+1],et=n[he+3*Ae+2];U[ne++]=et,U[ne++]=Ue,U[ne++]=$e,U[ne++]=255}--re}},this.decodeAndBlitFrameRGBA=function(M,U){var J=this.frameInfo(M),de=J.width*J.height,fe=new Uint8Array(de);US(n,J.data_offset,fe,de);var he=J.palette_offset,K=J.transparent_index;K===null&&(K=256);var le=J.width,se=t-le,re=le,j=4*(J.y*t+J.x),$=4*((J.y+J.height)*t+J.x),ne=j,ce=4*se;J.interlaced===!0&&(ce+=4*t*7);for(var ge=8,ye=0,be=fe.length;ye<be;++ye){var Ae=fe[ye];if(re===0&&(re=le,(ne+=ce)>=$&&(ce=4*se+4*t*(ge-1),ne=j+(le+se)*(ge<<1),ge>>=1)),Ae===K)ne+=4;else{var $e=n[he+3*Ae],Ue=n[he+3*Ae+1],et=n[he+3*Ae+2];U[ne++]=$e,U[ne++]=Ue,U[ne++]=et,U[ne++]=255}--re}}}function US(n,e,t,r){for(var i=n[e++],o=1<<i,s=o+1,a=s+1,u=i+1,l=(1<<u)-1,h=0,d=0,p=0,m=n[e++],w=new Int32Array(4096),b=null;;){for(;h<16&&m!==0;)d|=n[e++]<<h,h+=8,m===1?m=n[e++]:--m;if(h<u)break;var x=d&l;if(d>>=u,h-=u,x!==o){if(x===s)break;for(var E=x<a?x:b,A=0,N=E;N>o;)N=w[N]>>8,++A;var F=N;if(p+A+(E!==x?1:0)>r)return void sr.log("Warning, gif stream longer than expected.");t[p++]=F;var D=p+=A;for(E!==x&&(t[p++]=F),N=E;A--;)N=w[N],t[--D]=255&N,N>>=8;b!==null&&a<4096&&(w[a++]=b<<8|F,a>=l+1&&u<12&&(++u,l=l<<1|1)),b=x}else a=s+1,l=(1<<(u=i+1))-1,b=null}return p!==r&&sr.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Hy(n){var e,t,r,i,o,s=Math.floor,a=new Array(64),u=new Array(64),l=new Array(64),h=new Array(64),d=new Array(65535),p=new Array(65535),m=new Array(64),w=new Array(64),b=[],x=0,E=7,A=new Array(64),N=new Array(64),F=new Array(64),D=new Array(256),W=new Array(2048),k=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],R=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],M=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],de=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function fe(j,$){for(var ne=0,ce=0,ge=new Array,ye=1;ye<=16;ye++){for(var be=1;be<=j[ye];be++)ge[$[ce]]=[],ge[$[ce]][0]=ne,ge[$[ce]][1]=ye,ce++,ne++;ne*=2}return ge}function he(j){for(var $=j[0],ne=j[1]-1;ne>=0;)$&1<<ne&&(x|=1<<E),ne--,--E<0&&(x==255?(K(255),K(0)):K(x),E=7,x=0)}function K(j){b.push(j)}function le(j){K(j>>8&255),K(255&j)}function se(j,$,ne,ce,ge){for(var ye,be=ge[0],Ae=ge[240],$e=(function(Ze,at){var lt,ct,xt,Vt,jt,Pt,Lt,Yt,Ut,en,pt=0;for(Ut=0;Ut<8;++Ut){lt=Ze[pt],ct=Ze[pt+1],xt=Ze[pt+2],Vt=Ze[pt+3],jt=Ze[pt+4],Pt=Ze[pt+5],Lt=Ze[pt+6];var ar=lt+(Yt=Ze[pt+7]),dn=lt-Yt,qr=ct+Lt,xn=ct-Lt,Gn=xt+Pt,ho=xt-Pt,gn=Vt+jt,is=Vt-jt,Jn=ar+gn,yr=ar-gn,ni=qr+Gn,Qn=qr-Gn;Ze[pt]=Jn+ni,Ze[pt+4]=Jn-ni;var Wt=.707106781*(Qn+yr);Ze[pt+2]=yr+Wt,Ze[pt+6]=yr-Wt;var En=.382683433*((Jn=is+ho)-(Qn=xn+dn)),zo=.5411961*Jn+En,Sr=1.306562965*Qn+En,ri=.707106781*(ni=ho+xn),fo=dn+ri,_t=dn-ri;Ze[pt+5]=_t+zo,Ze[pt+3]=_t-zo,Ze[pt+1]=fo+Sr,Ze[pt+7]=fo-Sr,pt+=8}for(pt=0,Ut=0;Ut<8;++Ut){lt=Ze[pt],ct=Ze[pt+8],xt=Ze[pt+16],Vt=Ze[pt+24],jt=Ze[pt+32],Pt=Ze[pt+40],Lt=Ze[pt+48];var Ti=lt+(Yt=Ze[pt+56]),Lr=lt-Yt,Mr=ct+Lt,nr=ct-Lt,rr=xt+Pt,cr=xt-Pt,ia=Vt+jt,Ns=Vt-jt,ki=Ti+ia,po=Ti-ia,Ar=Mr+rr,Ni=Mr-rr;Ze[pt]=ki+Ar,Ze[pt+32]=ki-Ar;var wr=.707106781*(Ni+po);Ze[pt+16]=po+wr,Ze[pt+48]=po-wr;var Wo=.382683433*((ki=Ns+cr)-(Ni=nr+Lr)),Ps=.5411961*ki+Wo,Rs=1.306562965*Ni+Wo,Ds=.707106781*(Ar=cr+nr),oa=Lr+Ds,La=Lr-Ds;Ze[pt+40]=La+Ps,Ze[pt+24]=La-Ps,Ze[pt+8]=oa+Rs,Ze[pt+56]=oa-Rs,pt++}for(Ut=0;Ut<64;++Ut)en=Ze[Ut]*at[Ut],m[Ut]=en>0?en+.5|0:en-.5|0;return m})(j,$),Ue=0;Ue<64;++Ue)w[k[Ue]]=$e[Ue];var et=w[0]-ne;ne=w[0],et==0?he(ce[0]):(he(ce[p[ye=32767+et]]),he(d[ye]));for(var Je=63;Je>0&&w[Je]==0;)Je--;if(Je==0)return he(be),ne;for(var Be,_e=1;_e<=Je;){for(var ie=_e;w[_e]==0&&_e<=Je;)++_e;var ft=_e-ie;if(ft>=16){Be=ft>>4;for(var dt=1;dt<=Be;++dt)he(Ae);ft&=15}ye=32767+w[_e],he(ge[(ft<<4)+p[ye]]),he(d[ye]),_e++}return Je!=63&&he(be),ne}function re(j){j=Math.min(Math.max(j,1),100),o!=j&&((function($){for(var ne=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ce=0;ce<64;ce++){var ge=s((ne[ce]*$+50)/100);ge=Math.min(Math.max(ge,1),255),a[k[ce]]=ge}for(var ye=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],be=0;be<64;be++){var Ae=s((ye[be]*$+50)/100);Ae=Math.min(Math.max(Ae,1),255),u[k[be]]=Ae}for(var $e=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ue=0,et=0;et<8;et++)for(var Je=0;Je<8;Je++)l[Ue]=1/(a[k[Ue]]*$e[et]*$e[Je]*8),h[Ue]=1/(u[k[Ue]]*$e[et]*$e[Je]*8),Ue++})(j<50?Math.floor(5e3/j):Math.floor(200-2*j)),o=j)}this.encode=function(j,$){$&&re($),b=new Array,x=0,E=7,le(65496),le(65504),le(16),K(74),K(70),K(73),K(70),K(0),K(1),K(1),K(0),le(1),le(1),K(0),K(0),(function(){le(65499),le(132),K(0);for(var ct=0;ct<64;ct++)K(a[ct]);K(1);for(var xt=0;xt<64;xt++)K(u[xt])})(),(function(ct,xt){le(65472),le(17),K(8),le(xt),le(ct),K(3),K(1),K(17),K(0),K(2),K(17),K(1),K(3),K(17),K(1)})(j.width,j.height),(function(){le(65476),le(418),K(0);for(var ct=0;ct<16;ct++)K(C[ct+1]);for(var xt=0;xt<=11;xt++)K(L[xt]);K(16);for(var Vt=0;Vt<16;Vt++)K(B[Vt+1]);for(var jt=0;jt<=161;jt++)K(R[jt]);K(1);for(var Pt=0;Pt<16;Pt++)K(M[Pt+1]);for(var Lt=0;Lt<=11;Lt++)K(U[Lt]);K(17);for(var Yt=0;Yt<16;Yt++)K(J[Yt+1]);for(var Ut=0;Ut<=161;Ut++)K(de[Ut])})(),le(65498),le(12),K(3),K(1),K(0),K(2),K(17),K(3),K(17),K(0),K(63),K(0);var ne=0,ce=0,ge=0;x=0,E=7,this.encode.displayName="_encode_";for(var ye,be,Ae,$e,Ue,et,Je,Be,_e,ie=j.data,ft=j.width,dt=j.height,Ze=4*ft,at=0;at<dt;){for(ye=0;ye<Ze;){for(Ue=Ze*at+ye,Je=-1,Be=0,_e=0;_e<64;_e++)et=Ue+(Be=_e>>3)*Ze+(Je=4*(7&_e)),at+Be>=dt&&(et-=Ze*(at+1+Be-dt)),ye+Je>=Ze&&(et-=ye+Je-Ze+4),be=ie[et++],Ae=ie[et++],$e=ie[et++],A[_e]=(W[be]+W[Ae+256>>0]+W[$e+512>>0]>>16)-128,N[_e]=(W[be+768>>0]+W[Ae+1024>>0]+W[$e+1280>>0]>>16)-128,F[_e]=(W[be+1280>>0]+W[Ae+1536>>0]+W[$e+1792>>0]>>16)-128;ne=se(A,l,ne,e,r),ce=se(N,h,ce,t,i),ge=se(F,h,ge,t,i),ye+=32}at+=8}if(E>=0){var lt=[];lt[1]=E+1,lt[0]=(1<<E+1)-1,he(lt)}return le(65497),new Uint8Array(b)},n=n||50,(function(){for(var j=String.fromCharCode,$=0;$<256;$++)D[$]=j($)})(),e=fe(C,L),t=fe(M,U),r=fe(B,R),i=fe(J,de),(function(){for(var j=1,$=2,ne=1;ne<=15;ne++){for(var ce=j;ce<$;ce++)p[32767+ce]=ne,d[32767+ce]=[],d[32767+ce][1]=ne,d[32767+ce][0]=ce;for(var ge=-($-1);ge<=-j;ge++)p[32767+ge]=ne,d[32767+ge]=[],d[32767+ge][1]=ne,d[32767+ge][0]=$-1+ge;j<<=1,$<<=1}})(),(function(){for(var j=0;j<256;j++)W[j]=19595*j,W[j+256>>0]=38470*j,W[j+512>>0]=7471*j+32768,W[j+768>>0]=-11059*j,W[j+1024>>0]=-21709*j,W[j+1280>>0]=32768*j+8421375,W[j+1536>>0]=-27439*j,W[j+1792>>0]=-5329*j})(),re(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function uu(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function zS(n){function e(C){if(!C)throw Error("assert :P")}function t(C,L,B){for(var R=0;4>R;R++)if(C[L+R]!=B.charCodeAt(R))return!0;return!1}function r(C,L,B,R,M){for(var U=0;U<M;U++)C[L+U]=B[R+U]}function i(C,L,B,R){for(var M=0;M<R;M++)C[L+M]=B}function o(C){return new Int32Array(C)}function s(C,L){for(var B=[],R=0;R<C;R++)B.push(new L);return B}function a(C,L){var B=[];return(function R(M,U,J){for(var de=J[U],fe=0;fe<de&&(M.push(J.length>U+1?[]:new L),!(J.length<U+1));fe++)R(M[fe],U+1,J)})(B,0,C),B}var u=function(){var C=this;function L(v,S){for(var P=1<<S-1>>>0;v&P;)P>>>=1;return P?(v&P-1)+P:v}function B(v,S,P,z,H){e(!(z%P));do v[S+(z-=P)]=H;while(0<z)}function R(v,S,P,z,H){if(e(2328>=H),512>=H)var X=o(512);else if((X=o(H))==null)return 0;return(function(Q,Z,te,ue,Ee,De){var Le,Pe,Qe=Z,ze=1<<te,Ce=o(16),Ie=o(16);for(e(Ee!=0),e(ue!=null),e(Q!=null),e(0<te),Pe=0;Pe<Ee;++Pe){if(15<ue[Pe])return 0;++Ce[ue[Pe]]}if(Ce[0]==Ee)return 0;for(Ie[1]=0,Le=1;15>Le;++Le){if(Ce[Le]>1<<Le)return 0;Ie[Le+1]=Ie[Le]+Ce[Le]}for(Pe=0;Pe<Ee;++Pe)Le=ue[Pe],0<ue[Pe]&&(De[Ie[Le]++]=Pe);if(Ie[15]==1)return(ue=new M).g=0,ue.value=De[0],B(Q,Qe,1,ze,ue),ze;var Ke,Ge=-1,Xe=ze-1,bt=0,gt=1,zt=1,yt=1<<te;for(Pe=0,Le=1,Ee=2;Le<=te;++Le,Ee<<=1){if(gt+=zt<<=1,0>(zt-=Ce[Le]))return 0;for(;0<Ce[Le];--Ce[Le])(ue=new M).g=Le,ue.value=De[Pe++],B(Q,Qe+bt,Ee,yt,ue),bt=L(bt,Le)}for(Le=te+1,Ee=2;15>=Le;++Le,Ee<<=1){if(gt+=zt<<=1,0>(zt-=Ce[Le]))return 0;for(;0<Ce[Le];--Ce[Le]){if(ue=new M,(bt&Xe)!=Ge){for(Qe+=yt,Ke=1<<(Ge=Le)-te;15>Ge&&!(0>=(Ke-=Ce[Ge]));)++Ge,Ke<<=1;ze+=yt=1<<(Ke=Ge-te),Q[Z+(Ge=bt&Xe)].g=Ke+te,Q[Z+Ge].value=Qe-Z-Ge}ue.g=Le-te,ue.value=De[Pe++],B(Q,Qe+(bt>>te),Ee,yt,ue),bt=L(bt,Le)}}return gt!=2*Ie[15]-1?0:ze})(v,S,P,z,H,X)}function M(){this.value=this.g=0}function U(){this.value=this.g=0}function J(){this.G=s(5,M),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(_r,U)}function de(v,S,P,z){e(v!=null),e(S!=null),e(2147483648>z),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=S,v.pa=P,v.Jd=S,v.Yc=P+z,v.Zc=4<=z?P+z-4+1:P,ye(v)}function fe(v,S){for(var P=0;0<S--;)P|=Ae(v,128)<<S;return P}function he(v,S){var P=fe(v,S);return be(v)?-P:P}function K(v,S,P,z){var H,X=0;for(e(v!=null),e(S!=null),e(4294967288>z),v.Sb=z,v.Ra=0,v.u=0,v.h=0,4<z&&(z=4),H=0;H<z;++H)X+=S[P+H]<<8*H;v.Ra=X,v.bb=z,v.oa=S,v.pa=P}function le(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<mc-8>>>0,++v.bb,v.u-=8;ne(v)&&(v.h=1,v.u=0)}function se(v,S){if(e(0<=S),!v.h&&S<=pc){var P=$(v)&dc[S];return v.u+=S,le(v),P}return v.h=1,v.u=0}function re(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function j(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function $(v){return v.Ra>>>(v.u&mc-1)>>>0}function ne(v){return e(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>mc}function ce(v,S){v.u=S,v.h=ne(v)}function ge(v){v.u>=gc&&(e(v.u>=gc),le(v))}function ye(v){e(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(e(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function be(v){return fe(v,1)}function Ae(v,S){var P=v.Ca;0>v.b&&ye(v);var z=v.b,H=P*S>>>8,X=(v.I>>>z>H)+0;for(X?(P-=H,v.I-=H+1<<z>>>0):P=H+1,z=P,H=0;256<=z;)H+=8,z>>=8;return z=7^H+Yi[z],v.b-=z,v.Ca=(P<<z)-1,X}function $e(v,S,P){v[S+0]=P>>24&255,v[S+1]=P>>16&255,v[S+2]=P>>8&255,v[S+3]=P>>0&255}function Ue(v,S){return v[S+0]<<0|v[S+1]<<8}function et(v,S){return Ue(v,S)|v[S+2]<<16}function Je(v,S){return Ue(v,S)|Ue(v,S+2)<<16}function Be(v,S){var P=1<<S;return e(v!=null),e(0<S),v.X=o(P),v.X==null?0:(v.Mb=32-S,v.Xa=S,1)}function _e(v,S){e(v!=null),e(S!=null),e(v.Xa==S.Xa),r(S.X,0,v.X,0,1<<S.Xa)}function ie(){this.X=[],this.Xa=this.Mb=0}function ft(v,S,P,z){e(P!=null),e(z!=null);var H=P[0],X=z[0];return H==0&&(H=(v*X+S/2)/S),X==0&&(X=(S*H+v/2)/v),0>=H||0>=X?0:(P[0]=H,z[0]=X,1)}function dt(v,S){return v+(1<<S)-1>>>S}function Ze(v,S){return((4278255360&v)+(4278255360&S)>>>0&4278255360)+((16711935&v)+(16711935&S)>>>0&16711935)>>>0}function at(v,S){C[S]=function(P,z,H,X,Q,Z,te){var ue;for(ue=0;ue<Q;++ue){var Ee=C[v](Z[te+ue-1],H,X+ue);Z[te+ue]=Ze(P[z+ue],Ee)}}}function lt(){this.ud=this.hd=this.jd=0}function ct(v,S){return((4278124286&(v^S))>>>1)+(v&S)>>>0}function xt(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function Vt(v,S){return xt(v+(v-S+.5>>1))}function jt(v,S,P){return Math.abs(S-P)-Math.abs(v-P)}function Pt(v,S,P,z,H,X,Q){for(z=X[Q-1],P=0;P<H;++P)X[Q+P]=z=Ze(v[S+P],z)}function Lt(v,S,P,z,H){var X;for(X=0;X<P;++X){var Q=v[S+X],Z=Q>>8&255,te=16711935&(te=(te=16711935&Q)+((Z<<16)+Z));z[H+X]=(4278255360&Q)+te>>>0}}function Yt(v,S){S.jd=v>>0&255,S.hd=v>>8&255,S.ud=v>>16&255}function Ut(v,S,P,z,H,X){var Q;for(Q=0;Q<z;++Q){var Z=S[P+Q],te=Z>>>8,ue=Z,Ee=255&(Ee=(Ee=Z>>>16)+((v.jd<<24>>24)*(te<<24>>24)>>>5));ue=255&(ue=(ue=ue+((v.hd<<24>>24)*(te<<24>>24)>>>5))+((v.ud<<24>>24)*(Ee<<24>>24)>>>5)),H[X+Q]=(4278255360&Z)+(Ee<<16)+ue}}function en(v,S,P,z,H){C[S]=function(X,Q,Z,te,ue,Ee,De,Le,Pe){for(te=De;te<Le;++te)for(De=0;De<Pe;++De)ue[Ee++]=H(Z[z(X[Q++])])},C[v]=function(X,Q,Z,te,ue,Ee,De){var Le=8>>X.b,Pe=X.Ea,Qe=X.K[0],ze=X.w;if(8>Le)for(X=(1<<X.b)-1,ze=(1<<Le)-1;Q<Z;++Q){var Ce,Ie=0;for(Ce=0;Ce<Pe;++Ce)Ce&X||(Ie=z(te[ue++])),Ee[De++]=H(Qe[Ie&ze]),Ie>>=Le}else C["VP8LMapColor"+P](te,ue,Qe,ze,Ee,De,Q,Z,Pe)}}function pt(v,S,P,z,H){for(P=S+P;S<P;){var X=v[S++];z[H++]=X>>16&255,z[H++]=X>>8&255,z[H++]=X>>0&255}}function ar(v,S,P,z,H){for(P=S+P;S<P;){var X=v[S++];z[H++]=X>>16&255,z[H++]=X>>8&255,z[H++]=X>>0&255,z[H++]=X>>24&255}}function dn(v,S,P,z,H){for(P=S+P;S<P;){var X=(Q=v[S++])>>16&240|Q>>12&15,Q=Q>>0&240|Q>>28&15;z[H++]=X,z[H++]=Q}}function qr(v,S,P,z,H){for(P=S+P;S<P;){var X=(Q=v[S++])>>16&248|Q>>13&7,Q=Q>>5&224|Q>>3&31;z[H++]=X,z[H++]=Q}}function xn(v,S,P,z,H){for(P=S+P;S<P;){var X=v[S++];z[H++]=X>>0&255,z[H++]=X>>8&255,z[H++]=X>>16&255}}function Gn(v,S,P,z,H,X){if(X==0)for(P=S+P;S<P;)$e(z,((X=v[S++])[0]>>24|X[1]>>8&65280|X[2]<<8&16711680|X[3]<<24)>>>0),H+=32;else r(z,H,v,S,P)}function ho(v,S){C[S][0]=C[v+"0"],C[S][1]=C[v+"1"],C[S][2]=C[v+"2"],C[S][3]=C[v+"3"],C[S][4]=C[v+"4"],C[S][5]=C[v+"5"],C[S][6]=C[v+"6"],C[S][7]=C[v+"7"],C[S][8]=C[v+"8"],C[S][9]=C[v+"9"],C[S][10]=C[v+"10"],C[S][11]=C[v+"11"],C[S][12]=C[v+"12"],C[S][13]=C[v+"13"],C[S][14]=C[v+"0"],C[S][15]=C[v+"0"]}function gn(v){return v==_c||v==Tl||v==Mh||v==Fh}function is(){this.eb=[],this.size=this.A=this.fb=0}function Jn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function yr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new is,this.f.kb=new Jn,this.sd=null}function ni(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Qn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Wt(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function En(v,S){var P=v.T,z=S.ba.f.RGBA,H=z.eb,X=z.fb+v.ka*z.A,Q=bo[S.ba.S],Z=v.y,te=v.O,ue=v.f,Ee=v.N,De=v.ea,Le=v.W,Pe=S.cc,Qe=S.dc,ze=S.Mc,Ce=S.Nc,Ie=v.ka,Ke=v.ka+v.T,Ge=v.U,Xe=Ge+1>>1;for(Ie==0?Q(Z,te,null,null,ue,Ee,De,Le,ue,Ee,De,Le,H,X,null,null,Ge):(Q(S.ec,S.fc,Z,te,Pe,Qe,ze,Ce,ue,Ee,De,Le,H,X-z.A,H,X,Ge),++P);Ie+2<Ke;Ie+=2)Pe=ue,Qe=Ee,ze=De,Ce=Le,Ee+=v.Rc,Le+=v.Rc,X+=2*z.A,Q(Z,(te+=2*v.fa)-v.fa,Z,te,Pe,Qe,ze,Ce,ue,Ee,De,Le,H,X-z.A,H,X,Ge);return te+=v.fa,v.j+Ke<v.o?(r(S.ec,S.fc,Z,te,Ge),r(S.cc,S.dc,ue,Ee,Xe),r(S.Mc,S.Nc,De,Le,Xe),P--):1&Ke||Q(Z,te,null,null,ue,Ee,De,Le,ue,Ee,De,Le,H,X+z.A,null,null,Ge),P}function zo(v,S,P){var z=v.F,H=[v.J];if(z!=null){var X=v.U,Q=S.ba.S,Z=Q==Lh||Q==Mh;S=S.ba.f.RGBA;var te=[0],ue=v.ka;te[0]=v.T,v.Kb&&(ue==0?--te[0]:(--ue,H[0]-=v.width),v.j+v.ka+v.T==v.o&&(te[0]=v.o-v.j-ue));var Ee=S.eb;ue=S.fb+ue*S.A,v=zn(z,H[0],v.width,X,te,Ee,ue+(Z?0:3),S.A),e(P==te),v&&gn(Q)&&yo(Ee,ue,Z,X,te,S.A)}return 0}function Sr(v){var S=v.ma,P=S.ba.S,z=11>P,H=P==Mu||P==Dh||P==Lh||P==er||P==12||gn(P);if(S.memory=null,S.Ib=null,S.Jb=null,S.Nd=null,!hc(S.Oa,v,H?11:12))return 0;if(H&&gn(P)&&rt(),v.da)alert("todo:use_scaling");else{if(z){if(S.Ib=Wt,v.Kb){if(P=v.U+1>>1,S.memory=o(v.U+2*P),S.memory==null)return 0;S.ec=S.memory,S.fc=0,S.cc=S.ec,S.dc=S.fc+v.U,S.Mc=S.cc,S.Nc=S.dc+P,S.Ib=En,rt()}}else alert("todo:EmitYUV");H&&(S.Jb=zo,z&&Re())}if(z&&!vi){for(v=0;256>v;++v)xo[v]=89858*(v-128)+Ws>>Ya,_o[v]=-22014*(v-128)+Ws,Cc[v]=-45773*(v-128),Rl[v]=113618*(v-128)+Ws>>Ya;for(v=Wn;v<Kn;++v)S=76283*(v-16)+Ws>>Ya,Ff[v-Wn]=Fn(S,255),ig[v-Wn]=Fn(S+8>>4,15);vi=1}return 1}function ri(v){var S=v.ma,P=v.U,z=v.T;return e(!(1&v.ka)),0>=P||0>=z?0:(P=S.Ib(v,S),S.Jb!=null&&S.Jb(v,S,P),S.Dc+=P,1)}function fo(v){v.ma.memory=null}function _t(v,S,P,z){return se(v,8)!=47?0:(S[0]=se(v,14)+1,P[0]=se(v,14)+1,z[0]=se(v,1),se(v,3)!=0?0:!v.h)}function Ti(v,S){if(4>v)return v+1;var P=v-2>>1;return(2+(1&v)<<P)+se(S,P)+1}function Lr(v,S){return 120<S?S-120:1<=(P=((P=a1[S-1])>>4)*v+(8-(15&P)))?P:1;var P}function Mr(v,S,P){var z=$(P),H=v[S+=255&z].g-8;return 0<H&&(ce(P,P.u+8),z=$(P),S+=v[S].value,S+=z&(1<<H)-1),ce(P,P.u+v[S].g),v[S].value}function nr(v,S,P){return P.g+=v.g,P.value+=v.value<<S>>>0,e(8>=P.g),v.g}function rr(v,S,P){var z=v.xc;return e((S=z==0?0:v.vc[v.md*(P>>z)+(S>>z)])<v.Wb),v.Ya[S]}function cr(v,S,P,z){var H=v.ab,X=v.c*S,Q=v.C;S=Q+S;var Z=P,te=z;for(z=v.Ta,P=v.Ua;0<H--;){var ue=v.gc[H],Ee=Q,De=S,Le=Z,Pe=te,Qe=(te=z,Z=P,ue.Ea);switch(e(Ee<De),e(De<=ue.nc),ue.hc){case 2:Pf(Le,Pe,(De-Ee)*Qe,te,Z);break;case 0:var ze=Ee,Ce=De,Ie=te,Ke=Z,Ge=(yt=ue).Ea;ze==0&&(_l(Le,Pe,null,null,1,Ie,Ke),Pt(Le,Pe+1,0,0,Ge-1,Ie,Ke+1),Pe+=Ge,Ke+=Ge,++ze);for(var Xe=1<<yt.b,bt=Xe-1,gt=dt(Ge,yt.b),zt=yt.K,yt=yt.w+(ze>>yt.b)*gt;ze<Ce;){var In=zt,Tn=yt,Sn=1;for(za(Le,Pe,Ie,Ke-Ge,1,Ie,Ke);Sn<Ge;){var hn=(Sn&~bt)+Xe;hn>Ge&&(hn=Ge),(0,va[In[Tn++]>>8&15])(Le,Pe+ +Sn,Ie,Ke+Sn-Ge,hn-Sn,Ie,Ke+Sn),Sn=hn}Pe+=Ge,Ke+=Ge,++ze&bt||(yt+=gt)}De!=ue.nc&&r(te,Z-Qe,te,Z+(De-Ee-1)*Qe,Qe);break;case 1:for(Qe=Le,Ce=Pe,Ge=(Le=ue.Ea)-(Ke=Le&~(Ie=(Pe=1<<ue.b)-1)),ze=dt(Le,ue.b),Xe=ue.K,ue=ue.w+(Ee>>ue.b)*ze;Ee<De;){for(bt=Xe,gt=ue,zt=new lt,yt=Ce+Ke,In=Ce+Le;Ce<yt;)Yt(bt[gt++],zt),Ru(zt,Qe,Ce,Pe,te,Z),Ce+=Pe,Z+=Pe;Ce<In&&(Yt(bt[gt++],zt),Ru(zt,Qe,Ce,Ge,te,Z),Ce+=Ge,Z+=Ge),++Ee&Ie||(ue+=ze)}break;case 3:if(Le==te&&Pe==Z&&0<ue.b){for(Ce=te,Le=Qe=Z+(De-Ee)*Qe-(Ke=(De-Ee)*dt(ue.Ea,ue.b)),Pe=te,Ie=Z,ze=[],Ke=(Ge=Ke)-1;0<=Ke;--Ke)ze[Ke]=Pe[Ie+Ke];for(Ke=Ge-1;0<=Ke;--Ke)Ce[Le+Ke]=ze[Ke];Ji(ue,Ee,De,te,Qe,te,Z)}else Ji(ue,Ee,De,Le,Pe,te,Z)}Z=z,te=P}te!=P&&r(z,P,Z,te,X)}function ia(v,S){var P=v.V,z=v.Ba+v.c*v.C,H=S-v.C;if(e(S<=v.l.o),e(16>=H),0<H){var X=v.l,Q=v.Ta,Z=v.Ua,te=X.width;if(cr(v,H,P,z),H=Z=[Z],e((P=v.C)<(z=S)),e(X.v<X.va),z>X.o&&(z=X.o),P<X.j){var ue=X.j-P;P=X.j,H[0]+=ue*te}if(P>=z?P=0:(H[0]+=4*X.v,X.ka=P-X.j,X.U=X.va-X.v,X.T=z-P,P=1),P){if(Z=Z[0],11>(P=v.ca).S){var Ee=P.f.RGBA,De=(z=P.S,H=X.U,X=X.T,ue=Ee.eb,Ee.A),Le=X;for(Ee=Ee.fb+v.Ma*Ee.A;0<Le--;){var Pe=Q,Qe=Z,ze=H,Ce=ue,Ie=Ee;switch(z){case Rf:Qi(Pe,Qe,ze,Ce,Ie);break;case Mu:Li(Pe,Qe,ze,Ce,Ie);break;case _c:Li(Pe,Qe,ze,Ce,Ie),yo(Ce,Ie,0,ze,1,0);break;case Zm:qa(Pe,Qe,ze,Ce,Ie);break;case Dh:Gn(Pe,Qe,ze,Ce,Ie,1);break;case Tl:Gn(Pe,Qe,ze,Ce,Ie,1),yo(Ce,Ie,0,ze,1,0);break;case Lh:Gn(Pe,Qe,ze,Ce,Ie,0);break;case Mh:Gn(Pe,Qe,ze,Ce,Ie,0),yo(Ce,Ie,1,ze,1,0);break;case er:Du(Pe,Qe,ze,Ce,Ie);break;case Fh:Du(Pe,Qe,ze,Ce,Ie),Zn(Ce,Ie,ze,1,0);break;case Df:Wa(Pe,Qe,ze,Ce,Ie);break;default:e(0)}Z+=te,Ee+=De}v.Ma+=X}else alert("todo:EmitRescaledRowsYUVA");e(v.Ma<=P.height)}}v.C=S,e(v.C<=v.i)}function Ns(v){var S;if(0<v.ua)return 0;for(S=0;S<v.Wb;++S){var P=v.Ya[S].G,z=v.Ya[S].H;if(0<P[1][z[1]+0].g||0<P[2][z[2]+0].g||0<P[3][z[3]+0].g)return 0}return 1}function ki(v,S,P,z,H,X){if(v.Z!=0){var Q=v.qd,Z=v.rd;for(e(Fi[v.Z]!=null);S<P;++S)Fi[v.Z](Q,Z,z,H,z,H,X),Q=z,Z=H,H+=X;v.qd=Q,v.rd=Z}}function po(v,S){var P=v.l.ma,z=P.Z==0||P.Z==1?v.l.j:v.C;if(z=v.C<z?z:v.C,e(S<=v.l.o),S>z){var H=v.l.width,X=P.ca,Q=P.tb+H*z,Z=v.V,te=v.Ba+v.c*z,ue=v.gc;e(v.ab==1),e(ue[0].hc==3),Nh(ue[0],z,S,Z,te,X,Q),ki(P,z,S,X,Q,H)}v.C=v.Ma=S}function Ar(v,S,P,z,H,X,Q){var Z=v.$/z,te=v.$%z,ue=v.m,Ee=v.s,De=P+v.$,Le=De;H=P+z*H;var Pe=P+z*X,Qe=280+Ee.ua,ze=v.Pb?Z:16777216,Ce=0<Ee.ua?Ee.Wa:null,Ie=Ee.wc,Ke=De<Pe?rr(Ee,te,Z):null;e(v.C<X),e(Pe<=H);var Ge=!1;e:for(;;){for(;Ge||De<Pe;){var Xe=0;if(Z>=ze){var bt=De-P;e((ze=v).Pb),ze.wd=ze.m,ze.xd=bt,0<ze.s.ua&&_e(ze.s.Wa,ze.s.vb),ze=Z+Mf}if(te&Ie||(Ke=rr(Ee,te,Z)),e(Ke!=null),Ke.Qb&&(S[De]=Ke.qb,Ge=!0),!Ge)if(ge(ue),Ke.jc){Xe=ue,bt=S;var gt=De,zt=Ke.pd[$(Xe)&_r-1];e(Ke.jc),256>zt.g?(ce(Xe,Xe.u+zt.g),bt[gt]=zt.value,Xe=0):(ce(Xe,Xe.u+zt.g-256),e(256<=zt.value),Xe=zt.value),Xe==0&&(Ge=!0)}else Xe=Mr(Ke.G[0],Ke.H[0],ue);if(ue.h)break;if(Ge||256>Xe){if(!Ge)if(Ke.nd)S[De]=(Ke.qb|Xe<<8)>>>0;else{if(ge(ue),Ge=Mr(Ke.G[1],Ke.H[1],ue),ge(ue),bt=Mr(Ke.G[2],Ke.H[2],ue),gt=Mr(Ke.G[3],Ke.H[3],ue),ue.h)break;S[De]=(gt<<24|Ge<<16|Xe<<8|bt)>>>0}if(Ge=!1,++De,++te>=z&&(te=0,++Z,Q!=null&&Z<=X&&!(Z%16)&&Q(v,Z),Ce!=null))for(;Le<De;)Xe=S[Le++],Ce.X[(506832829*Xe&4294967295)>>>Ce.Mb]=Xe}else if(280>Xe){if(Xe=Ti(Xe-256,ue),bt=Mr(Ke.G[4],Ke.H[4],ue),ge(ue),bt=Lr(z,bt=Ti(bt,ue)),ue.h)break;if(De-P<bt||H-De<Xe)break e;for(gt=0;gt<Xe;++gt)S[De+gt]=S[De+gt-bt];for(De+=Xe,te+=Xe;te>=z;)te-=z,++Z,Q!=null&&Z<=X&&!(Z%16)&&Q(v,Z);if(e(De<=H),te&Ie&&(Ke=rr(Ee,te,Z)),Ce!=null)for(;Le<De;)Xe=S[Le++],Ce.X[(506832829*Xe&4294967295)>>>Ce.Mb]=Xe}else{if(!(Xe<Qe))break e;for(Ge=Xe-280,e(Ce!=null);Le<De;)Xe=S[Le++],Ce.X[(506832829*Xe&4294967295)>>>Ce.Mb]=Xe;Xe=De,e(!(Ge>>>(bt=Ce).Xa)),S[Xe]=bt.X[Ge],Ge=!0}Ge||e(ue.h==ne(ue))}if(v.Pb&&ue.h&&De<H)e(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&_e(v.s.vb,v.s.Wa);else{if(ue.h)break e;Q!=null&&Q(v,Z>X?X:Z),v.a=0,v.$=De-P}return 1}return v.a=3,0}function Ni(v){e(v!=null),v.vc=null,v.yc=null,v.Ya=null;var S=v.Wa;S!=null&&(S.X=null),v.vb=null,e(v!=null)}function wr(){var v=new cc;return v==null?null:(v.a=0,v.xb=Sc,ho("Predictor","VP8LPredictors"),ho("Predictor","VP8LPredictors_C"),ho("PredictorAdd","VP8LPredictorsAdd"),ho("PredictorAdd","VP8LPredictorsAdd_C"),Pf=Lt,Ru=Ut,Qi=pt,Li=ar,Du=dn,Wa=qr,qa=xn,C.VP8LMapColor32b=vc,C.VP8LMapColor8b=yc,v)}function Wo(v,S,P,z,H){var X=1,Q=[v],Z=[S],te=z.m,ue=z.s,Ee=null,De=0;e:for(;;){if(P)for(;X&&se(te,1);){var Le=Q,Pe=Z,Qe=z,ze=1,Ce=Qe.m,Ie=Qe.gc[Qe.ab],Ke=se(Ce,2);if(Qe.Oc&1<<Ke)X=0;else{switch(Qe.Oc|=1<<Ke,Ie.hc=Ke,Ie.Ea=Le[0],Ie.nc=Pe[0],Ie.K=[null],++Qe.ab,e(4>=Qe.ab),Ke){case 0:case 1:Ie.b=se(Ce,3)+2,ze=Wo(dt(Ie.Ea,Ie.b),dt(Ie.nc,Ie.b),0,Qe,Ie.K),Ie.K=Ie.K[0];break;case 3:var Ge,Xe=se(Ce,8)+1,bt=16<Xe?0:4<Xe?1:2<Xe?2:3;if(Le[0]=dt(Ie.Ea,bt),Ie.b=bt,Ge=ze=Wo(Xe,1,0,Qe,Ie.K)){var gt,zt=Xe,yt=Ie,In=1<<(8>>yt.b),Tn=o(In);if(Tn==null)Ge=0;else{var Sn=yt.K[0],hn=yt.w;for(Tn[0]=yt.K[0][0],gt=1;gt<1*zt;++gt)Tn[gt]=Ze(Sn[hn+gt],Tn[gt-1]);for(;gt<4*In;++gt)Tn[gt]=0;yt.K[0]=null,yt.K[0]=Tn,Ge=1}}ze=Ge;break;case 2:break;default:e(0)}X=ze}}if(Q=Q[0],Z=Z[0],X&&se(te,1)&&!(X=1<=(De=se(te,4))&&11>=De)){z.a=3;break e}var qn;if(qn=X)t:{var Xn,tn,fr,to=z,Cr=Q,Hr=Z,On=De,Oi=P,Bi=to.m,dr=to.s,Gr=[null],yi=1,Eo=0,ms=tg[On];n:for(;;){if(Oi&&se(Bi,1)){var pr=se(Bi,3)+2,Br=dt(Cr,pr),Jo=dt(Hr,pr),Bu=Br*Jo;if(!Wo(Br,Jo,0,to,Gr))break n;for(Gr=Gr[0],dr.xc=pr,Xn=0;Xn<Bu;++Xn){var Qa=Gr[Xn]>>8&65535;Gr[Xn]=Qa,Qa>=yi&&(yi=Qa+1)}}if(Bi.h)break n;for(tn=0;5>tn;++tn){var Bn=kl[tn];!tn&&0<On&&(Bn+=1<<On),Eo<Bn&&(Eo=Bn)}var _a=s(yi*ms,M),Of=yi,vp=s(Of,J);if(vp==null)var gs=null;else e(65536>=Of),gs=vp;var vs=o(Eo);if(gs==null||vs==null||_a==null){to.a=1;break n}var Ll=_a;for(Xn=fr=0;Xn<yi;++Xn){var ys=gs[Xn],Za=ys.G,Ml=ys.H,Ic=0,Qo=1,Tc=0;for(tn=0;5>tn;++tn){Bn=kl[tn],Za[tn]=Ll,Ml[tn]=fr,!tn&&0<On&&(Bn+=1<<On);i:{var Vu,eu=Bn,kc=to,Ea=vs,sg=Ll,yp=fr,or=0,qs=kc.m,wp=se(qs,1);if(i(Ea,0,0,eu),wp){var bp=se(qs,1)+1,Bf=se(qs,1),Vf=se(qs,Bf==0?1:8);Ea[Vf]=1,bp==2&&(Ea[Vf=se(qs,8)]=1);var Sa=1}else{var ur=o(19),Vr=se(qs,4)+4;if(19<Vr){kc.a=3;var Ir=0;break i}for(Vu=0;Vu<Vr;++Vu)ur[s1[Vu]]=se(qs,3);var Nc=void 0,tu=void 0,Pc=kc,f1=ur,$r=eu,jf=Ea,Uh=0,Aa=Pc.m,Hs=8,Zo=s(128,M);r:for(;R(Zo,0,7,f1,19);){if(se(Aa,1)){var zh=2+2*se(Aa,3);if((Nc=2+se(Aa,zh))>$r)break r}else Nc=$r;for(tu=0;tu<$r&&Nc--;){ge(Aa);var Uf=Zo[0+(127&$(Aa))];ce(Aa,Aa.u+Uf.g);var ju=Uf.value;if(16>ju)jf[tu++]=ju,ju!=0&&(Hs=ju);else{var ag=ju==16,xp=ju-16,ug=Lf[xp],_p=se(Aa,Oh[xp])+ug;if(tu+_p>$r)break r;for(var lg=ag?Hs:0;0<_p--;)jf[tu++]=lg}}Uh=1;break r}Uh||(Pc.a=3),Sa=Uh}(Sa=Sa&&!qs.h)&&(or=R(sg,yp,8,Ea,eu)),Sa&&or!=0?Ir=or:(kc.a=3,Ir=0)}if(Ir==0)break n;if(Qo&&eg[tn]==1&&(Qo=Ll[fr].g==0),Ic+=Ll[fr].g,fr+=Ir,3>=tn){var Rc,zf=vs[0];for(Rc=1;Rc<Bn;++Rc)vs[Rc]>zf&&(zf=vs[Rc]);Tc+=zf}}if(ys.nd=Qo,ys.Qb=0,Qo&&(ys.qb=(Za[3][Ml[3]+0].value<<24|Za[1][Ml[1]+0].value<<16|Za[2][Ml[2]+0].value)>>>0,Ic==0&&256>Za[0][Ml[0]+0].value&&(ys.Qb=1,ys.qb+=Za[0][Ml[0]+0].value<<8)),ys.jc=!ys.Qb&&6>Tc,ys.jc){var Wh,es=ys;for(Wh=0;Wh<_r;++Wh){var nu=Wh,Gs=es.pd[nu],Fl=es.G[0][es.H[0]+nu];256<=Fl.value?(Gs.g=Fl.g+256,Gs.value=Fl.value):(Gs.g=0,Gs.value=0,nu>>=nr(Fl,8,Gs),nu>>=nr(es.G[1][es.H[1]+nu],16,Gs),nu>>=nr(es.G[2][es.H[2]+nu],0,Gs),nr(es.G[3][es.H[3]+nu],24,Gs))}}}dr.vc=Gr,dr.Wb=yi,dr.Ya=gs,dr.yc=_a,qn=1;break t}qn=0}if(!(X=qn)){z.a=3;break e}if(0<De){if(ue.ua=1<<De,!Be(ue.Wa,De)){z.a=1,X=0;break e}}else ue.ua=0;var Wf=z,qf=Q,cg=Z,Hf=Wf.s,Gf=Hf.xc;if(Wf.c=qf,Wf.i=cg,Hf.md=dt(qf,Gf),Hf.wc=Gf==0?-1:(1<<Gf)-1,P){z.xb=xa;break e}if((Ee=o(Q*Z))==null){z.a=1,X=0;break e}X=(X=Ar(z,Ee,0,Q,Z,Z,null))&&!te.h;break e}return X?(H!=null?H[0]=Ee:(e(Ee==null),e(P)),z.$=0,P||Ni(ue)):Ni(ue),X}function Ps(v,S){var P=v.c*v.i,z=P+S+16*S;return e(v.c<=S),v.V=o(z),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+P+S,1)}function Rs(v,S){var P=v.C,z=S-P,H=v.V,X=v.Ba+v.c*P;for(e(S<=v.l.o);0<z;){var Q=16<z?16:z,Z=v.l.ma,te=v.l.width,ue=te*Q,Ee=Z.ca,De=Z.tb+te*P,Le=v.Ta,Pe=v.Ua;cr(v,Q,H,X),Er(Le,Pe,Ee,De,ue),ki(Z,P,P+Q,Ee,De,te),z-=Q,H+=Q*v.c,P+=Q}e(P==S),v.C=v.Ma=S}function Ds(){this.ub=this.yd=this.td=this.Rb=0}function oa(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function La(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function ic(){this.Yb=(function(){var v=[];return(function S(P,z,H){for(var X=H[z],Q=0;Q<X&&(P.push(H.length>z+1?[]:0),!(H.length<z+1));Q++)S(P[Q],z+1,H)})(v,0,[3,11]),v})()}function $n(){this.jb=o(3),this.Wc=a([4,8],ic),this.Xc=a([4,17],ic)}function oc(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function os(){this.ld=this.La=this.dd=this.tc=0}function Ls(){this.Na=this.la=0}function mo(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ma(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function sc(){this.uc=this.M=this.Nb=0,this.wa=Array(new os),this.Y=0,this.ya=Array(new Ma),this.aa=0,this.l=new Fa}function sa(){this.y=o(16),this.f=o(8),this.ea=o(8)}function Gi(){this.cb=this.a=0,this.sc="",this.m=new re,this.Od=new Ds,this.Kc=new oa,this.ed=new oc,this.Qa=new La,this.Ic=this.$c=this.Aa=0,this.D=new sc,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,re),this.ia=0,this.pb=s(4,mo),this.Pa=new $n,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new sa),this.Hd=0,this.rb=Array(new Ls),this.sb=0,this.wa=Array(new os),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ma),this.L=this.aa=0,this.gd=a([4,2],os),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Fa(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ci(){var v=new Gi;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,Nl||(Nl=Oa)),v}function ir(v,S,P){return v.a==0&&(v.a=S,v.sc=P,v.cb=0),0}function ml(v,S,P){return 3<=P&&v[S+0]==157&&v[S+1]==1&&v[S+2]==42}function gl(v,S){if(v==null)return 0;if(v.a=0,v.sc="OK",S==null)return ir(v,2,"null VP8Io passed to VP8GetHeaders()");var P=S.data,z=S.w,H=S.ha;if(4>H)return ir(v,7,"Truncated header.");var X=P[z+0]|P[z+1]<<8|P[z+2]<<16,Q=v.Od;if(Q.Rb=!(1&X),Q.td=X>>1&7,Q.yd=X>>4&1,Q.ub=X>>5,3<Q.td)return ir(v,3,"Incorrect keyframe parameters.");if(!Q.yd)return ir(v,4,"Frame not displayable.");z+=3,H-=3;var Z=v.Kc;if(Q.Rb){if(7>H)return ir(v,7,"cannot parse picture header");if(!ml(P,z,H))return ir(v,3,"Bad code word");Z.c=16383&(P[z+4]<<8|P[z+3]),Z.Td=P[z+4]>>6,Z.i=16383&(P[z+6]<<8|P[z+5]),Z.Ud=P[z+6]>>6,z+=7,H-=7,v.za=Z.c+15>>4,v.Ub=Z.i+15>>4,S.width=Z.c,S.height=Z.i,S.Da=0,S.j=0,S.v=0,S.va=S.width,S.o=S.height,S.da=0,S.ib=S.width,S.hb=S.height,S.U=S.width,S.T=S.height,i((X=v.Pa).jb,0,255,X.jb.length),e((X=v.Qa)!=null),X.Cb=0,X.Bb=0,X.Fb=1,i(X.Zb,0,0,X.Zb.length),i(X.Lb,0,0,X.Lb)}if(Q.ub>H)return ir(v,7,"bad partition length");de(X=v.m,P,z,Q.ub),z+=Q.ub,H-=Q.ub,Q.Rb&&(Z.Ld=be(X),Z.Kd=be(X)),Z=v.Qa;var te,ue=v.Pa;if(e(X!=null),e(Z!=null),Z.Cb=be(X),Z.Cb){if(Z.Bb=be(X),be(X)){for(Z.Fb=be(X),te=0;4>te;++te)Z.Zb[te]=be(X)?he(X,7):0;for(te=0;4>te;++te)Z.Lb[te]=be(X)?he(X,6):0}if(Z.Bb)for(te=0;3>te;++te)ue.jb[te]=be(X)?fe(X,8):255}else Z.Bb=0;if(X.Ka)return ir(v,3,"cannot parse segment header");if((Z=v.ed).zd=be(X),Z.Tb=fe(X,6),Z.wb=fe(X,3),Z.Pc=be(X),Z.Pc&&be(X)){for(ue=0;4>ue;++ue)be(X)&&(Z.vd[ue]=he(X,6));for(ue=0;4>ue;++ue)be(X)&&(Z.od[ue]=he(X,6))}if(v.L=Z.Tb==0?0:Z.zd?1:2,X.Ka)return ir(v,3,"cannot parse filter header");var Ee=H;if(H=te=z,z=te+Ee,Z=Ee,v.Xb=(1<<fe(v.m,2))-1,Ee<3*(ue=v.Xb))P=7;else{for(te+=3*ue,Z-=3*ue,Ee=0;Ee<ue;++Ee){var De=P[H+0]|P[H+1]<<8|P[H+2]<<16;De>Z&&(De=Z),de(v.Jc[+Ee],P,te,De),te+=De,Z-=De,H+=3}de(v.Jc[+ue],P,te,Z),P=te<z?0:5}if(P!=0)return ir(v,P,"cannot parse partitions");for(P=fe(te=v.m,7),H=be(te)?he(te,4):0,z=be(te)?he(te,4):0,Z=be(te)?he(te,4):0,ue=be(te)?he(te,4):0,te=be(te)?he(te,4):0,Ee=v.Qa,De=0;4>De;++De){if(Ee.Cb){var Le=Ee.Zb[De];Ee.Fb||(Le+=P)}else{if(0<De){v.pb[De]=v.pb[0];continue}Le=P}var Pe=v.pb[De];Pe.Sc[0]=Ec[Fn(Le+H,127)],Pe.Sc[1]=Bh[Fn(Le+0,127)],Pe.Eb[0]=2*Ec[Fn(Le+z,127)],Pe.Eb[1]=101581*Bh[Fn(Le+Z,127)]>>16,8>Pe.Eb[1]&&(Pe.Eb[1]=8),Pe.Qc[0]=Ec[Fn(Le+ue,117)],Pe.Qc[1]=Bh[Fn(Le+te,127)],Pe.lc=Le+te}if(!Q.Rb)return ir(v,4,"Not a key frame.");for(be(X),Q=v.Pa,P=0;4>P;++P){for(H=0;8>H;++H)for(z=0;3>z;++z)for(Z=0;11>Z;++Z)ue=Ae(X,l1[P][H][z][Z])?fe(X,8):rg[P][H][z][Z],Q.Wc[P][H].Yb[z][Z]=ue;for(H=0;17>H;++H)Q.Xc[P][H]=Q.Wc[P][pp[H]]}return v.kc=be(X),v.kc&&(v.Bd=fe(X,8)),v.cb=1}function Oa(v,S,P,z,H,X,Q){var Z=S[H].Yb[P];for(P=0;16>H;++H){if(!Ae(v,Z[P+0]))return H;for(;!Ae(v,Z[P+1]);)if(Z=S[++H].Yb[0],P=0,H==16)return 16;var te=S[H+1].Yb;if(Ae(v,Z[P+2])){var ue=v,Ee=0;if(Ae(ue,(Le=Z)[(De=P)+3]))if(Ae(ue,Le[De+6])){for(Z=0,De=2*(Ee=Ae(ue,Le[De+8]))+(Le=Ae(ue,Le[De+9+Ee])),Ee=0,Le=fp[De];Le[Z];++Z)Ee+=Ee+Ae(ue,Le[Z]);Ee+=3+(8<<De)}else Ae(ue,Le[De+7])?(Ee=7+2*Ae(ue,165),Ee+=Ae(ue,145)):Ee=5+Ae(ue,159);else Ee=Ae(ue,Le[De+4])?3+Ae(ue,Le[De+5]):2;Z=te[2]}else Ee=1,Z=te[1];te=Q+dp[H],0>(ue=v).b&&ye(ue);var De,Le=ue.b,Pe=(De=ue.Ca>>1)-(ue.I>>Le)>>31;--ue.b,ue.Ca+=Pe,ue.Ca|=1,ue.I-=(De+1&Pe)<<Le,X[te]=((Ee^Pe)-Pe)*z[(0<H)+0]}return 16}function aa(v){var S=v.rb[v.sb-1];S.la=0,S.Na=0,i(v.zc,0,0,v.zc.length),v.ja=0}function ua(v,S){if(v==null)return 0;if(S==null)return ir(v,2,"NULL VP8Io parameter in VP8Decode().");if(!v.cb&&!gl(v,S))return 0;if(e(v.cb),S.ac==null||S.ac(S)){S.ob&&(v.L=0);var P=Dl[v.L];if(v.L==2?(v.yb=0,v.zb=0):(v.yb=S.v-P>>4,v.zb=S.j-P>>4,0>v.yb&&(v.yb=0),0>v.zb&&(v.zb=0)),v.Va=S.o+15+P>>4,v.Hb=S.va+15+P>>4,v.Hb>v.za&&(v.Hb=v.za),v.Va>v.Ub&&(v.Va=v.Ub),0<v.L){var z=v.ed;for(P=0;4>P;++P){var H;if(v.Qa.Cb){var X=v.Qa.Lb[P];v.Qa.Fb||(X+=z.Tb)}else X=z.Tb;for(H=0;1>=H;++H){var Q=v.gd[P][H],Z=X;if(z.Pc&&(Z+=z.vd[0],H&&(Z+=z.od[0])),0<(Z=0>Z?0:63<Z?63:Z)){var te=Z;0<z.wb&&(te=4<z.wb?te>>2:te>>1)>9-z.wb&&(te=9-z.wb),1>te&&(te=1),Q.dd=te,Q.tc=2*Z+te,Q.ld=40<=Z?2:15<=Z?1:0}else Q.tc=0;Q.La=H}}}P=0}else ir(v,6,"Frame setup failed"),P=v.a;if(P=P==0){if(P){v.$c=0,0<v.Aa||(v.Ic=Ja);e:{P=v.Ic,z=4*(te=v.za);var ue=32*te,Ee=te+1,De=0<v.L?te*(0<v.Aa?2:1):0,Le=(v.Aa==2?2:1)*te;if((Q=z+832+(H=3*(16*P+Dl[v.L])/2*ue)+(X=v.Fa!=null&&0<v.Fa.length?v.Kc.c*v.Kc.i:0))!=Q)P=0;else{if(Q>v.Vb){if(v.Vb=0,v.Ec=o(Q),v.Fc=0,v.Ec==null){P=ir(v,1,"no memory during frame initialization.");break e}v.Vb=Q}Q=v.Ec,Z=v.Fc,v.Ac=Q,v.Bc=Z,Z+=z,v.Gd=s(ue,sa),v.Hd=0,v.rb=s(Ee+1,Ls),v.sb=1,v.wa=De?s(De,os):null,v.Y=0,v.D.Nb=0,v.D.wa=v.wa,v.D.Y=v.Y,0<v.Aa&&(v.D.Y+=te),e(!0),v.oc=Q,v.pc=Z,Z+=832,v.ya=s(Le,Ma),v.aa=0,v.D.ya=v.ya,v.D.aa=v.aa,v.Aa==2&&(v.D.aa+=te),v.R=16*te,v.B=8*te,te=(ue=Dl[v.L])*v.R,ue=ue/2*v.B,v.sa=Q,v.ta=Z+te,v.qa=v.sa,v.ra=v.ta+16*P*v.R+ue,v.Ha=v.qa,v.Ia=v.ra+8*P*v.B+ue,v.$c=0,Z+=H,v.mb=X?Q:null,v.nb=X?Z:null,e(Z+X<=v.Fc+v.Vb),aa(v),i(v.Ac,v.Bc,0,z),P=1}}if(P){if(S.ka=0,S.y=v.sa,S.O=v.ta,S.f=v.qa,S.N=v.ra,S.ea=v.Ha,S.Vd=v.Ia,S.fa=v.R,S.Rc=v.B,S.F=null,S.J=0,!Rh){for(P=-255;255>=P;++P)Or[255+P]=0>P?-P:P;for(P=-1020;1020>=P;++P)wa[1020+P]=-128>P?-128:127<P?127:P;for(P=-112;112>=P;++P)bc[112+P]=-16>P?-16:15<P?15:P;for(P=-255;510>=P;++P)Il[255+P]=0>P?0:255<P?255:P;Rh=1}wc=mn,Ha=ca,Ga=Ms,Mi=jn,Xo=Fs,Rn=la,El=Ua,Ph=hr,Sl=cs,Al=bl,Cl=$o,Yo=Bs,$a=ma,ya=hs,Ka=Ri,Xa=Ki,Lu=xr,gi=wl,ps[0]=ls,ps[1]=ac,ps[2]=vo,ps[3]=us,ps[4]=vl,ps[5]=Cu,ps[6]=di,ps[7]=Iu,ps[8]=Va,ps[9]=Os,eo[0]=qo,eo[1]=uc,eo[2]=as,eo[3]=Ba,eo[4]=Cn,eo[5]=Ho,eo[6]=go,wo[0]=Pi,wo[1]=Au,wo[2]=lc,wo[3]=$i,wo[4]=Mn,wo[5]=fa,wo[6]=yl,P=1}else P=0}P&&(P=(function(Pe,Qe){for(Pe.M=0;Pe.M<Pe.Va;++Pe.M){var ze,Ce=Pe.Jc[Pe.M&Pe.Xb],Ie=Pe.m,Ke=Pe;for(ze=0;ze<Ke.za;++ze){var Ge=Ie,Xe=Ke,bt=Xe.Ac,gt=Xe.Bc+4*ze,zt=Xe.zc,yt=Xe.ya[Xe.aa+ze];if(Xe.Qa.Bb?yt.$b=Ae(Ge,Xe.Pa.jb[0])?2+Ae(Ge,Xe.Pa.jb[2]):Ae(Ge,Xe.Pa.jb[1]):yt.$b=0,Xe.kc&&(yt.Ad=Ae(Ge,Xe.Bd)),yt.Za=!Ae(Ge,145)+0,yt.Za){var In=yt.Ob,Tn=0;for(Xe=0;4>Xe;++Xe){var Sn,hn=zt[0+Xe];for(Sn=0;4>Sn;++Sn){hn=u1[bt[gt+Sn]][hn];for(var qn=ng[Ae(Ge,hn[0])];0<qn;)qn=ng[2*qn+Ae(Ge,hn[qn])];hn=-qn,bt[gt+Sn]=hn}r(In,Tn,bt,gt,4),Tn+=4,zt[0+Xe]=hn}}else hn=Ae(Ge,156)?Ae(Ge,128)?1:3:Ae(Ge,163)?2:0,yt.Ob[0]=hn,i(bt,gt,hn,4),i(zt,0,hn,4);yt.Dd=Ae(Ge,142)?Ae(Ge,114)?Ae(Ge,183)?1:3:2:0}if(Ke.m.Ka)return ir(Pe,7,"Premature end-of-partition0 encountered.");for(;Pe.ja<Pe.za;++Pe.ja){if(Ke=Ce,Ge=(Ie=Pe).rb[Ie.sb-1],bt=Ie.rb[Ie.sb+Ie.ja],ze=Ie.ya[Ie.aa+Ie.ja],gt=Ie.kc?ze.Ad:0)Ge.la=bt.la=0,ze.Za||(Ge.Na=bt.Na=0),ze.Hc=0,ze.Gc=0,ze.ia=0;else{var Xn,tn;if(Ge=bt,bt=Ke,gt=Ie.Pa.Xc,zt=Ie.ya[Ie.aa+Ie.ja],yt=Ie.pb[zt.$b],Xe=zt.ad,In=0,Tn=Ie.rb[Ie.sb-1],hn=Sn=0,i(Xe,In,0,384),zt.Za)var fr=0,to=gt[3];else{qn=o(16);var Cr=Ge.Na+Tn.Na;if(Cr=Nl(bt,gt[1],Cr,yt.Eb,0,qn,0),Ge.Na=Tn.Na=(0<Cr)+0,1<Cr)wc(qn,0,Xe,In);else{var Hr=qn[0]+3>>3;for(qn=0;256>qn;qn+=16)Xe[In+qn]=Hr}fr=1,to=gt[0]}var On=15&Ge.la,Oi=15&Tn.la;for(qn=0;4>qn;++qn){var Bi=1&Oi;for(Hr=tn=0;4>Hr;++Hr)On=On>>1|(Bi=(Cr=Nl(bt,to,Cr=Bi+(1&On),yt.Sc,fr,Xe,In))>fr)<<7,tn=tn<<2|(3<Cr?3:1<Cr?2:Xe[In+0]!=0),In+=16;On>>=4,Oi=Oi>>1|Bi<<7,Sn=(Sn<<8|tn)>>>0}for(to=On,fr=Oi>>4,Xn=0;4>Xn;Xn+=2){for(tn=0,On=Ge.la>>4+Xn,Oi=Tn.la>>4+Xn,qn=0;2>qn;++qn){for(Bi=1&Oi,Hr=0;2>Hr;++Hr)Cr=Bi+(1&On),On=On>>1|(Bi=0<(Cr=Nl(bt,gt[2],Cr,yt.Qc,0,Xe,In)))<<3,tn=tn<<2|(3<Cr?3:1<Cr?2:Xe[In+0]!=0),In+=16;On>>=2,Oi=Oi>>1|Bi<<5}hn|=tn<<4*Xn,to|=On<<4<<Xn,fr|=(240&Oi)<<Xn}Ge.la=to,Tn.la=fr,zt.Hc=Sn,zt.Gc=hn,zt.ia=43690&hn?0:yt.ia,gt=!(Sn|hn)}if(0<Ie.L&&(Ie.wa[Ie.Y+Ie.ja]=Ie.gd[ze.$b][ze.Za],Ie.wa[Ie.Y+Ie.ja].La|=!gt),Ke.Ka)return ir(Pe,7,"Premature end-of-file encountered.")}if(aa(Pe),Ie=Qe,Ke=1,ze=(Ce=Pe).D,Ge=0<Ce.L&&Ce.M>=Ce.zb&&Ce.M<=Ce.Va,Ce.Aa==0)e:{if(ze.M=Ce.M,ze.uc=Ge,Us(Ce,ze),Ke=1,ze=(tn=Ce.D).Nb,Ge=(hn=Dl[Ce.L])*Ce.R,bt=hn/2*Ce.B,qn=16*ze*Ce.R,Hr=8*ze*Ce.B,gt=Ce.sa,zt=Ce.ta-Ge+qn,yt=Ce.qa,Xe=Ce.ra-bt+Hr,In=Ce.Ha,Tn=Ce.Ia-bt+Hr,Oi=(On=tn.M)==0,Sn=On>=Ce.Va-1,Ce.Aa==2&&Us(Ce,tn),tn.uc)for(Bi=(Cr=Ce).D.M,e(Cr.D.uc),tn=Cr.yb;tn<Cr.Hb;++tn){fr=tn,to=Bi;var dr=(Gr=(Bn=Cr).D).Nb;Xn=Bn.R;var Gr=Gr.wa[Gr.Y+fr],yi=Bn.sa,Eo=Bn.ta+16*dr*Xn+16*fr,ms=Gr.dd,pr=Gr.tc;if(pr!=0)if(e(3<=pr),Bn.L==1)0<fr&&Xa(yi,Eo,Xn,pr+4),Gr.La&&gi(yi,Eo,Xn,pr),0<to&&Ka(yi,Eo,Xn,pr+4),Gr.La&&Lu(yi,Eo,Xn,pr);else{var Br=Bn.B,Jo=Bn.qa,Bu=Bn.ra+8*dr*Br+8*fr,Qa=Bn.Ha,Bn=Bn.Ia+8*dr*Br+8*fr;dr=Gr.ld,0<fr&&(Ph(yi,Eo,Xn,pr+4,ms,dr),Al(Jo,Bu,Qa,Bn,Br,pr+4,ms,dr)),Gr.La&&(Yo(yi,Eo,Xn,pr,ms,dr),ya(Jo,Bu,Qa,Bn,Br,pr,ms,dr)),0<to&&(El(yi,Eo,Xn,pr+4,ms,dr),Sl(Jo,Bu,Qa,Bn,Br,pr+4,ms,dr)),Gr.La&&(Cl(yi,Eo,Xn,pr,ms,dr),$a(Jo,Bu,Qa,Bn,Br,pr,ms,dr))}}if(Ce.ia&&alert("todo:DitherRow"),Ie.put!=null){if(tn=16*On,On=16*(On+1),Oi?(Ie.y=Ce.sa,Ie.O=Ce.ta+qn,Ie.f=Ce.qa,Ie.N=Ce.ra+Hr,Ie.ea=Ce.Ha,Ie.W=Ce.Ia+Hr):(tn-=hn,Ie.y=gt,Ie.O=zt,Ie.f=yt,Ie.N=Xe,Ie.ea=In,Ie.W=Tn),Sn||(On-=hn),On>Ie.o&&(On=Ie.o),Ie.F=null,Ie.J=null,Ce.Fa!=null&&0<Ce.Fa.length&&tn<On&&(Ie.J=Pu(Ce,Ie,tn,On-tn),Ie.F=Ce.mb,Ie.F==null&&Ie.F.length==0)){Ke=ir(Ce,3,"Could not decode alpha data.");break e}tn<Ie.j&&(hn=Ie.j-tn,tn=Ie.j,e(!(1&hn)),Ie.O+=Ce.R*hn,Ie.N+=Ce.B*(hn>>1),Ie.W+=Ce.B*(hn>>1),Ie.F!=null&&(Ie.J+=Ie.width*hn)),tn<On&&(Ie.O+=Ie.v,Ie.N+=Ie.v>>1,Ie.W+=Ie.v>>1,Ie.F!=null&&(Ie.J+=Ie.v),Ie.ka=tn-Ie.j,Ie.U=Ie.va-Ie.v,Ie.T=On-tn,Ke=Ie.put(Ie))}ze+1!=Ce.Ic||Sn||(r(Ce.sa,Ce.ta-Ge,gt,zt+16*Ce.R,Ge),r(Ce.qa,Ce.ra-bt,yt,Xe+8*Ce.B,bt),r(Ce.Ha,Ce.Ia-bt,In,Tn+8*Ce.B,bt))}if(!Ke)return ir(Pe,6,"Output aborted.")}return 1})(v,S)),S.bc!=null&&S.bc(S),P&=1}return P?(v.cb=0,P):0}function hi(v,S,P,z,H){H=v[S+P+32*z]+(H>>3),v[S+P+32*z]=-256&H?0>H?0:255:H}function Su(v,S,P,z,H,X){hi(v,S,0,P,z+H),hi(v,S,1,P,z+X),hi(v,S,2,P,z-X),hi(v,S,3,P,z-H)}function br(v){return(20091*v>>16)+v}function fi(v,S,P,z){var H,X=0,Q=o(16);for(H=0;4>H;++H){var Z=v[S+0]+v[S+8],te=v[S+0]-v[S+8],ue=(35468*v[S+4]>>16)-br(v[S+12]),Ee=br(v[S+4])+(35468*v[S+12]>>16);Q[X+0]=Z+Ee,Q[X+1]=te+ue,Q[X+2]=te-ue,Q[X+3]=Z-Ee,X+=4,S++}for(H=X=0;4>H;++H)Z=(v=Q[X+0]+4)+Q[X+8],te=v-Q[X+8],ue=(35468*Q[X+4]>>16)-br(Q[X+12]),hi(P,z,0,0,Z+(Ee=br(Q[X+4])+(35468*Q[X+12]>>16))),hi(P,z,1,0,te+ue),hi(P,z,2,0,te-ue),hi(P,z,3,0,Z-Ee),X++,z+=32}function la(v,S,P,z){var H=v[S+0]+4,X=35468*v[S+4]>>16,Q=br(v[S+4]),Z=35468*v[S+1]>>16;Su(P,z,0,H+Q,v=br(v[S+1]),Z),Su(P,z,1,H+X,v,Z),Su(P,z,2,H-X,v,Z),Su(P,z,3,H-Q,v,Z)}function ca(v,S,P,z,H){fi(v,S,P,z),H&&fi(v,S+16,P,z+4)}function Ms(v,S,P,z){Ha(v,S+0,P,z,1),Ha(v,S+32,P,z+128,1)}function jn(v,S,P,z){var H;for(v=v[S+0]+4,H=0;4>H;++H)for(S=0;4>S;++S)hi(P,z,S,H,v)}function Fs(v,S,P,z){v[S+0]&&Mi(v,S+0,P,z),v[S+16]&&Mi(v,S+16,P,z+4),v[S+32]&&Mi(v,S+32,P,z+128),v[S+48]&&Mi(v,S+48,P,z+128+4)}function mn(v,S,P,z){var H,X=o(16);for(H=0;4>H;++H){var Q=v[S+0+H]+v[S+12+H],Z=v[S+4+H]+v[S+8+H],te=v[S+4+H]-v[S+8+H],ue=v[S+0+H]-v[S+12+H];X[0+H]=Q+Z,X[8+H]=Q-Z,X[4+H]=ue+te,X[12+H]=ue-te}for(H=0;4>H;++H)Q=(v=X[0+4*H]+3)+X[3+4*H],Z=X[1+4*H]+X[2+4*H],te=X[1+4*H]-X[2+4*H],ue=v-X[3+4*H],P[z+0]=Q+Z>>3,P[z+16]=ue+te>>3,P[z+32]=Q-Z>>3,P[z+48]=ue-te>>3,z+=64}function ss(v,S,P){var z,H=S-32,X=Zi,Q=255-v[H-1];for(z=0;z<P;++z){var Z,te=X,ue=Q+v[S-1];for(Z=0;Z<P;++Z)v[S+Z]=te[ue+v[H+Z]];S+=32}}function ac(v,S){ss(v,S,4)}function Au(v,S){ss(v,S,8)}function uc(v,S){ss(v,S,16)}function as(v,S){var P;for(P=0;16>P;++P)r(v,S+32*P,v,S-32,16)}function Ba(v,S){var P;for(P=16;0<P;--P)i(v,S,v[S-1],16),S+=32}function ha(v,S,P){var z;for(z=0;16>z;++z)i(S,P+32*z,v,16)}function qo(v,S){var P,z=16;for(P=0;16>P;++P)z+=v[S-1+32*P]+v[S+P-32];ha(z>>5,v,S)}function Cn(v,S){var P,z=8;for(P=0;16>P;++P)z+=v[S-1+32*P];ha(z>>4,v,S)}function Ho(v,S){var P,z=8;for(P=0;16>P;++P)z+=v[S+P-32];ha(z>>4,v,S)}function go(v,S){ha(128,v,S)}function Ht(v,S,P){return v+2*S+P+2>>2}function vo(v,S){var P,z=S-32;for(z=new Uint8Array([Ht(v[z-1],v[z+0],v[z+1]),Ht(v[z+0],v[z+1],v[z+2]),Ht(v[z+1],v[z+2],v[z+3]),Ht(v[z+2],v[z+3],v[z+4])]),P=0;4>P;++P)r(v,S+32*P,z,0,z.length)}function us(v,S){var P=v[S-1],z=v[S-1+32],H=v[S-1+64],X=v[S-1+96];$e(v,S+0,16843009*Ht(v[S-1-32],P,z)),$e(v,S+32,16843009*Ht(P,z,H)),$e(v,S+64,16843009*Ht(z,H,X)),$e(v,S+96,16843009*Ht(H,X,X))}function ls(v,S){var P,z=4;for(P=0;4>P;++P)z+=v[S+P-32]+v[S-1+32*P];for(z>>=3,P=0;4>P;++P)i(v,S+32*P,z,4)}function vl(v,S){var P=v[S-1+0],z=v[S-1+32],H=v[S-1+64],X=v[S-1-32],Q=v[S+0-32],Z=v[S+1-32],te=v[S+2-32],ue=v[S+3-32];v[S+0+96]=Ht(z,H,v[S-1+96]),v[S+1+96]=v[S+0+64]=Ht(P,z,H),v[S+2+96]=v[S+1+64]=v[S+0+32]=Ht(X,P,z),v[S+3+96]=v[S+2+64]=v[S+1+32]=v[S+0+0]=Ht(Q,X,P),v[S+3+64]=v[S+2+32]=v[S+1+0]=Ht(Z,Q,X),v[S+3+32]=v[S+2+0]=Ht(te,Z,Q),v[S+3+0]=Ht(ue,te,Z)}function di(v,S){var P=v[S+1-32],z=v[S+2-32],H=v[S+3-32],X=v[S+4-32],Q=v[S+5-32],Z=v[S+6-32],te=v[S+7-32];v[S+0+0]=Ht(v[S+0-32],P,z),v[S+1+0]=v[S+0+32]=Ht(P,z,H),v[S+2+0]=v[S+1+32]=v[S+0+64]=Ht(z,H,X),v[S+3+0]=v[S+2+32]=v[S+1+64]=v[S+0+96]=Ht(H,X,Q),v[S+3+32]=v[S+2+64]=v[S+1+96]=Ht(X,Q,Z),v[S+3+64]=v[S+2+96]=Ht(Q,Z,te),v[S+3+96]=Ht(Z,te,te)}function Cu(v,S){var P=v[S-1+0],z=v[S-1+32],H=v[S-1+64],X=v[S-1-32],Q=v[S+0-32],Z=v[S+1-32],te=v[S+2-32],ue=v[S+3-32];v[S+0+0]=v[S+1+64]=X+Q+1>>1,v[S+1+0]=v[S+2+64]=Q+Z+1>>1,v[S+2+0]=v[S+3+64]=Z+te+1>>1,v[S+3+0]=te+ue+1>>1,v[S+0+96]=Ht(H,z,P),v[S+0+64]=Ht(z,P,X),v[S+0+32]=v[S+1+96]=Ht(P,X,Q),v[S+1+32]=v[S+2+96]=Ht(X,Q,Z),v[S+2+32]=v[S+3+96]=Ht(Q,Z,te),v[S+3+32]=Ht(Z,te,ue)}function Iu(v,S){var P=v[S+0-32],z=v[S+1-32],H=v[S+2-32],X=v[S+3-32],Q=v[S+4-32],Z=v[S+5-32],te=v[S+6-32],ue=v[S+7-32];v[S+0+0]=P+z+1>>1,v[S+1+0]=v[S+0+64]=z+H+1>>1,v[S+2+0]=v[S+1+64]=H+X+1>>1,v[S+3+0]=v[S+2+64]=X+Q+1>>1,v[S+0+32]=Ht(P,z,H),v[S+1+32]=v[S+0+96]=Ht(z,H,X),v[S+2+32]=v[S+1+96]=Ht(H,X,Q),v[S+3+32]=v[S+2+96]=Ht(X,Q,Z),v[S+3+64]=Ht(Q,Z,te),v[S+3+96]=Ht(Z,te,ue)}function Os(v,S){var P=v[S-1+0],z=v[S-1+32],H=v[S-1+64],X=v[S-1+96];v[S+0+0]=P+z+1>>1,v[S+2+0]=v[S+0+32]=z+H+1>>1,v[S+2+32]=v[S+0+64]=H+X+1>>1,v[S+1+0]=Ht(P,z,H),v[S+3+0]=v[S+1+32]=Ht(z,H,X),v[S+3+32]=v[S+1+64]=Ht(H,X,X),v[S+3+64]=v[S+2+64]=v[S+0+96]=v[S+1+96]=v[S+2+96]=v[S+3+96]=X}function Va(v,S){var P=v[S-1+0],z=v[S-1+32],H=v[S-1+64],X=v[S-1+96],Q=v[S-1-32],Z=v[S+0-32],te=v[S+1-32],ue=v[S+2-32];v[S+0+0]=v[S+2+32]=P+Q+1>>1,v[S+0+32]=v[S+2+64]=z+P+1>>1,v[S+0+64]=v[S+2+96]=H+z+1>>1,v[S+0+96]=X+H+1>>1,v[S+3+0]=Ht(Z,te,ue),v[S+2+0]=Ht(Q,Z,te),v[S+1+0]=v[S+3+32]=Ht(P,Q,Z),v[S+1+32]=v[S+3+64]=Ht(z,P,Q),v[S+1+64]=v[S+3+96]=Ht(H,z,P),v[S+1+96]=Ht(X,H,z)}function lc(v,S){var P;for(P=0;8>P;++P)r(v,S+32*P,v,S-32,8)}function $i(v,S){var P;for(P=0;8>P;++P)i(v,S,v[S-1],8),S+=32}function pi(v,S,P){var z;for(z=0;8>z;++z)i(S,P+32*z,v,8)}function Pi(v,S){var P,z=8;for(P=0;8>P;++P)z+=v[S+P-32]+v[S-1+32*P];pi(z>>4,v,S)}function fa(v,S){var P,z=4;for(P=0;8>P;++P)z+=v[S+P-32];pi(z>>3,v,S)}function Mn(v,S){var P,z=4;for(P=0;8>P;++P)z+=v[S-1+32*P];pi(z>>3,v,S)}function yl(v,S){pi(128,v,S)}function da(v,S,P){var z=v[S-P],H=v[S+0],X=3*(H-z)+ba[1020+v[S-2*P]-v[S+P]],Q=xc[112+(X+4>>3)];v[S-P]=Zi[255+z+xc[112+(X+3>>3)]],v[S+0]=Zi[255+H-Q]}function pa(v,S,P,z){var H=v[S+0],X=v[S+P];return ds[255+v[S-2*P]-v[S-P]]>z||ds[255+X-H]>z}function ja(v,S,P,z){return 4*ds[255+v[S-P]-v[S+0]]+ds[255+v[S-2*P]-v[S+P]]<=z}function Tu(v,S,P,z,H){var X=v[S-3*P],Q=v[S-2*P],Z=v[S-P],te=v[S+0],ue=v[S+P],Ee=v[S+2*P],De=v[S+3*P];return 4*ds[255+Z-te]+ds[255+Q-ue]>z?0:ds[255+v[S-4*P]-X]<=H&&ds[255+X-Q]<=H&&ds[255+Q-Z]<=H&&ds[255+De-Ee]<=H&&ds[255+Ee-ue]<=H&&ds[255+ue-te]<=H}function Ri(v,S,P,z){var H=2*z+1;for(z=0;16>z;++z)ja(v,S+z,P,H)&&da(v,S+z,P)}function Ki(v,S,P,z){var H=2*z+1;for(z=0;16>z;++z)ja(v,S+z*P,1,H)&&da(v,S+z*P,1)}function xr(v,S,P,z){var H;for(H=3;0<H;--H)Ri(v,S+=4*P,P,z)}function wl(v,S,P,z){var H;for(H=3;0<H;--H)Ki(v,S+=4,P,z)}function Go(v,S,P,z,H,X,Q,Z){for(X=2*X+1;0<H--;){if(Tu(v,S,P,X,Q))if(pa(v,S,P,Z))da(v,S,P);else{var te=v,ue=S,Ee=P,De=te[ue-2*Ee],Le=te[ue-Ee],Pe=te[ue+0],Qe=te[ue+Ee],ze=te[ue+2*Ee],Ce=27*(Ke=ba[1020+3*(Pe-Le)+ba[1020+De-Qe]])+63>>7,Ie=18*Ke+63>>7,Ke=9*Ke+63>>7;te[ue-3*Ee]=Zi[255+te[ue-3*Ee]+Ke],te[ue-2*Ee]=Zi[255+De+Ie],te[ue-Ee]=Zi[255+Le+Ce],te[ue+0]=Zi[255+Pe-Ce],te[ue+Ee]=Zi[255+Qe-Ie],te[ue+2*Ee]=Zi[255+ze-Ke]}S+=z}}function Fr(v,S,P,z,H,X,Q,Z){for(X=2*X+1;0<H--;){if(Tu(v,S,P,X,Q))if(pa(v,S,P,Z))da(v,S,P);else{var te=v,ue=S,Ee=P,De=te[ue-Ee],Le=te[ue+0],Pe=te[ue+Ee],Qe=xc[112+((ze=3*(Le-De))+4>>3)],ze=xc[112+(ze+3>>3)],Ce=Qe+1>>1;te[ue-2*Ee]=Zi[255+te[ue-2*Ee]+Ce],te[ue-Ee]=Zi[255+De+ze],te[ue+0]=Zi[255+Le-Qe],te[ue+Ee]=Zi[255+Pe-Ce]}S+=z}}function Ua(v,S,P,z,H,X){Go(v,S,P,1,16,z,H,X)}function hr(v,S,P,z,H,X){Go(v,S,1,P,16,z,H,X)}function $o(v,S,P,z,H,X){var Q;for(Q=3;0<Q;--Q)Fr(v,S+=4*P,P,1,16,z,H,X)}function Bs(v,S,P,z,H,X){var Q;for(Q=3;0<Q;--Q)Fr(v,S+=4,1,P,16,z,H,X)}function cs(v,S,P,z,H,X,Q,Z){Go(v,S,H,1,8,X,Q,Z),Go(P,z,H,1,8,X,Q,Z)}function bl(v,S,P,z,H,X,Q,Z){Go(v,S,1,H,8,X,Q,Z),Go(P,z,1,H,8,X,Q,Z)}function ma(v,S,P,z,H,X,Q,Z){Fr(v,S+4*H,H,1,8,X,Q,Z),Fr(P,z+4*H,H,1,8,X,Q,Z)}function hs(v,S,P,z,H,X,Q,Z){Fr(v,S+4,1,H,8,X,Q,Z),Fr(P,z+4,1,H,8,X,Q,Z)}function Ko(){this.ba=new yr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Qn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Vs(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ga(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ku(){this.ua=0,this.Wa=new ie,this.vb=new ie,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new J,this.yc=new M}function cc(){this.xb=this.a=0,this.l=new Fa,this.ca=new yr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new j,this.Pb=0,this.wd=new j,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ku,this.ab=0,this.gc=s(4,ga),this.Oc=0}function js(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Fa,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function fs(v,S,P,z,H,X,Q){for(v=v==null?0:v[S+0],S=0;S<Q;++S)H[X+S]=v+P[z+S]&255,v=H[X+S]}function Nu(v,S,P,z,H,X,Q){var Z;if(v==null)fs(null,null,P,z,H,X,Q);else for(Z=0;Z<Q;++Z)H[X+Z]=v[S+Z]+P[z+Z]&255}function Di(v,S,P,z,H,X,Q){if(v==null)fs(null,null,P,z,H,X,Q);else{var Z,te=v[S+0],ue=te,Ee=te;for(Z=0;Z<Q;++Z)ue=Ee+(te=v[S+Z])-ue,Ee=P[z+Z]+(-256&ue?0>ue?0:255:ue)&255,ue=te,H[X+Z]=Ee}}function Pu(v,S,P,z){var H=S.width,X=S.o;if(e(v!=null&&S!=null),0>P||0>=z||P+z>X)return null;if(!v.Cc){if(v.ga==null){var Q;if(v.ga=new js,(Q=v.ga==null)||(Q=S.width*S.o,e(v.Gb.length==0),v.Gb=o(Q),v.Uc=0,v.Gb==null?Q=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,Q=1),Q=!Q),!Q){Q=v.ga;var Z=v.Fa,te=v.P,ue=v.qc,Ee=v.mb,De=v.nb,Le=te+1,Pe=ue-1,Qe=Q.l;if(e(Z!=null&&Ee!=null&&S!=null),Fi[0]=null,Fi[1]=fs,Fi[2]=Nu,Fi[3]=Di,Q.ca=Ee,Q.tb=De,Q.c=S.width,Q.i=S.height,e(0<Q.c&&0<Q.i),1>=ue)S=0;else if(Q.$a=Z[te+0]>>0&3,Q.Z=Z[te+0]>>2&3,Q.Lc=Z[te+0]>>4&3,te=Z[te+0]>>6&3,0>Q.$a||1<Q.$a||4<=Q.Z||1<Q.Lc||te)S=0;else if(Qe.put=ri,Qe.ac=Sr,Qe.bc=fo,Qe.ma=Q,Qe.width=S.width,Qe.height=S.height,Qe.Da=S.Da,Qe.v=S.v,Qe.va=S.va,Qe.j=S.j,Qe.o=S.o,Q.$a)e:{e(Q.$a==1),S=wr();t:for(;;){if(S==null){S=0;break e}if(e(Q!=null),Q.mc=S,S.c=Q.c,S.i=Q.i,S.l=Q.l,S.l.ma=Q,S.l.width=Q.c,S.l.height=Q.i,S.a=0,K(S.m,Z,Le,Pe),!Wo(Q.c,Q.i,1,S,null)||(S.ab==1&&S.gc[0].hc==3&&Ns(S.s)?(Q.ic=1,Z=S.c*S.i,S.Ta=null,S.Ua=0,S.V=o(Z),S.Ba=0,S.V==null?(S.a=1,S=0):S=1):(Q.ic=0,S=Ps(S,Q.c)),!S))break t;S=1;break e}Q.mc=null,S=0}else S=Pe>=Q.c*Q.i;Q=!S}if(Q)return null;v.ga.Lc!=1?v.Ga=0:z=X-P}e(v.ga!=null),e(P+z<=X);e:{if(S=(Z=v.ga).c,X=Z.l.o,Z.$a==0){if(Le=v.rc,Pe=v.Vc,Qe=v.Fa,te=v.P+1+P*S,ue=v.mb,Ee=v.nb+P*S,e(te<=v.P+v.qc),Z.Z!=0)for(e(Fi[Z.Z]!=null),Q=0;Q<z;++Q)Fi[Z.Z](Le,Pe,Qe,te,ue,Ee,S),Le=ue,Pe=Ee,Ee+=S,te+=S;else for(Q=0;Q<z;++Q)r(ue,Ee,Qe,te,S),Le=ue,Pe=Ee,Ee+=S,te+=S;v.rc=Le,v.Vc=Pe}else{if(e(Z.mc!=null),S=P+z,e((Q=Z.mc)!=null),e(S<=Q.i),Q.C>=S)S=1;else if(Z.ic||Re(),Z.ic){Z=Q.V,Le=Q.Ba,Pe=Q.c;var ze=Q.i,Ce=(Qe=1,te=Q.$/Pe,ue=Q.$%Pe,Ee=Q.m,De=Q.s,Q.$),Ie=Pe*ze,Ke=Pe*S,Ge=De.wc,Xe=Ce<Ke?rr(De,ue,te):null;e(Ce<=Ie),e(S<=ze),e(Ns(De));t:for(;;){for(;!Ee.h&&Ce<Ke;){if(ue&Ge||(Xe=rr(De,ue,te)),e(Xe!=null),ge(Ee),256>(ze=Mr(Xe.G[0],Xe.H[0],Ee)))Z[Le+Ce]=ze,++Ce,++ue>=Pe&&(ue=0,++te<=S&&!(te%16)&&po(Q,te));else{if(!(280>ze)){Qe=0;break t}ze=Ti(ze-256,Ee);var bt,gt=Mr(Xe.G[4],Xe.H[4],Ee);if(ge(Ee),!(Ce>=(gt=Lr(Pe,gt=Ti(gt,Ee)))&&Ie-Ce>=ze)){Qe=0;break t}for(bt=0;bt<ze;++bt)Z[Le+Ce+bt]=Z[Le+Ce+bt-gt];for(Ce+=ze,ue+=ze;ue>=Pe;)ue-=Pe,++te<=S&&!(te%16)&&po(Q,te);Ce<Ke&&ue&Ge&&(Xe=rr(De,ue,te))}e(Ee.h==ne(Ee))}po(Q,te>S?S:te);break t}!Qe||Ee.h&&Ce<Ie?(Qe=0,Q.a=Ee.h?5:3):Q.$=Ce,S=Qe}else S=Ar(Q,Q.V,Q.Ba,Q.c,Q.i,S,Rs);if(!S){z=0;break e}}P+z>=X&&(v.Cc=1),z=1}if(!z)return null;if(v.Cc&&((z=v.ga)!=null&&(z.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+P*H}function I(v,S,P,z,H,X){for(;0<H--;){var Q,Z=v,te=S+(P?1:0),ue=v,Ee=S+(P?0:3);for(Q=0;Q<z;++Q){var De=ue[Ee+4*Q];De!=255&&(De*=32897,Z[te+4*Q+0]=Z[te+4*Q+0]*De>>23,Z[te+4*Q+1]=Z[te+4*Q+1]*De>>23,Z[te+4*Q+2]=Z[te+4*Q+2]*De>>23)}S+=X}}function G(v,S,P,z,H){for(;0<z--;){var X;for(X=0;X<P;++X){var Q=v[S+2*X+0],Z=15&(ue=v[S+2*X+1]),te=4369*Z,ue=(240&ue|ue>>4)*te>>16;v[S+2*X+0]=(240&Q|Q>>4)*te>>16&240|(15&Q|Q<<4)*te>>16>>4&15,v[S+2*X+1]=240&ue|Z}S+=H}}function me(v,S,P,z,H,X,Q,Z){var te,ue,Ee=255;for(ue=0;ue<H;++ue){for(te=0;te<z;++te){var De=v[S+te];X[Q+4*te]=De,Ee&=De}S+=P,Q+=Z}return Ee!=255}function we(v,S,P,z,H){var X;for(X=0;X<H;++X)P[z+X]=v[S+X]>>8}function Re(){yo=I,Zn=G,zn=me,Er=we}function He(v,S,P){C[v]=function(z,H,X,Q,Z,te,ue,Ee,De,Le,Pe,Qe,ze,Ce,Ie,Ke,Ge){var Xe,bt=Ge-1>>1,gt=Z[te+0]|ue[Ee+0]<<16,zt=De[Le+0]|Pe[Qe+0]<<16;e(z!=null);var yt=3*gt+zt+131074>>2;for(S(z[H+0],255&yt,yt>>16,ze,Ce),X!=null&&(yt=3*zt+gt+131074>>2,S(X[Q+0],255&yt,yt>>16,Ie,Ke)),Xe=1;Xe<=bt;++Xe){var In=Z[te+Xe]|ue[Ee+Xe]<<16,Tn=De[Le+Xe]|Pe[Qe+Xe]<<16,Sn=gt+In+zt+Tn+524296,hn=Sn+2*(In+zt)>>3;yt=hn+gt>>1,gt=(Sn=Sn+2*(gt+Tn)>>3)+In>>1,S(z[H+2*Xe-1],255&yt,yt>>16,ze,Ce+(2*Xe-1)*P),S(z[H+2*Xe-0],255&gt,gt>>16,ze,Ce+(2*Xe-0)*P),X!=null&&(yt=Sn+zt>>1,gt=hn+Tn>>1,S(X[Q+2*Xe-1],255&yt,yt>>16,Ie,Ke+(2*Xe-1)*P),S(X[Q+2*Xe+0],255&gt,gt>>16,Ie,Ke+(2*Xe+0)*P)),gt=In,zt=Tn}1&Ge||(yt=3*gt+zt+131074>>2,S(z[H+Ge-1],255&yt,yt>>16,ze,Ce+(Ge-1)*P),X!=null&&(yt=3*zt+gt+131074>>2,S(X[Q+Ge-1],255&yt,yt>>16,Ie,Ke+(Ge-1)*P)))}}function rt(){bo[Rf]=c1,bo[Mu]=Fu,bo[Zm]=h1,bo[Dh]=Ac,bo[Lh]=Pl,bo[er]=Vh,bo[Df]=mp,bo[_c]=Fu,bo[Tl]=Ac,bo[Mh]=Pl,bo[Fh]=Vh}function mt(v){return v&-16384?0>v?0:255:v>>Ou}function y(v,S){return mt((19077*v>>8)+(26149*S>>8)-14234)}function O(v,S,P){return mt((19077*v>>8)-(6419*S>>8)-(13320*P>>8)+8708)}function q(v,S){return mt((19077*v>>8)+(33050*S>>8)-17685)}function ee(v,S,P,z,H){z[H+0]=y(v,P),z[H+1]=O(v,S,P),z[H+2]=q(v,S)}function Ne(v,S,P,z,H){z[H+0]=q(v,S),z[H+1]=O(v,S,P),z[H+2]=y(v,P)}function Fe(v,S,P,z,H){var X=O(v,S,P);S=X<<3&224|q(v,S)>>3,z[H+0]=248&y(v,P)|X>>5,z[H+1]=S}function it(v,S,P,z,H){var X=240&q(v,S)|15;z[H+0]=240&y(v,P)|O(v,S,P)>>4,z[H+1]=X}function on(v,S,P,z,H){z[H+0]=255,ee(v,S,P,z,H+1)}function vn(v,S,P,z,H){Ne(v,S,P,z,H),z[H+3]=255}function sn(v,S,P,z,H){ee(v,S,P,z,H),z[H+3]=255}function Fn(v,S){return 0>v?0:v>S?S:v}function Un(v,S,P){C[v]=function(z,H,X,Q,Z,te,ue,Ee,De){for(var Le=Ee+(-2&De)*P;Ee!=Le;)S(z[H+0],X[Q+0],Z[te+0],ue,Ee),S(z[H+1],X[Q+0],Z[te+0],ue,Ee+P),H+=2,++Q,++te,Ee+=2*P;1&De&&S(z[H+0],X[Q+0],Z[te+0],ue,Ee)}}function Xi(v,S,P){return P==0?v==0?S==0?6:5:S==0?4:0:P}function mi(v,S,P,z,H){switch(v>>>30){case 3:Ha(S,P,z,H,0);break;case 2:Rn(S,P,z,H);break;case 1:Mi(S,P,z,H)}}function Us(v,S){var P,z,H=S.M,X=S.Nb,Q=v.oc,Z=v.pc+40,te=v.oc,ue=v.pc+584,Ee=v.oc,De=v.pc+600;for(P=0;16>P;++P)Q[Z+32*P-1]=129;for(P=0;8>P;++P)te[ue+32*P-1]=129,Ee[De+32*P-1]=129;for(0<H?Q[Z-1-32]=te[ue-1-32]=Ee[De-1-32]=129:(i(Q,Z-32-1,127,21),i(te,ue-32-1,127,9),i(Ee,De-32-1,127,9)),z=0;z<v.za;++z){var Le=S.ya[S.aa+z];if(0<z){for(P=-1;16>P;++P)r(Q,Z+32*P-4,Q,Z+32*P+12,4);for(P=-1;8>P;++P)r(te,ue+32*P-4,te,ue+32*P+4,4),r(Ee,De+32*P-4,Ee,De+32*P+4,4)}var Pe=v.Gd,Qe=v.Hd+z,ze=Le.ad,Ce=Le.Hc;if(0<H&&(r(Q,Z-32,Pe[Qe].y,0,16),r(te,ue-32,Pe[Qe].f,0,8),r(Ee,De-32,Pe[Qe].ea,0,8)),Le.Za){var Ie=Q,Ke=Z-32+16;for(0<H&&(z>=v.za-1?i(Ie,Ke,Pe[Qe].y[15],4):r(Ie,Ke,Pe[Qe+1].y,0,4)),P=0;4>P;P++)Ie[Ke+128+P]=Ie[Ke+256+P]=Ie[Ke+384+P]=Ie[Ke+0+P];for(P=0;16>P;++P,Ce<<=2)Ie=Q,Ke=Z+gp[P],ps[Le.Ob[P]](Ie,Ke),mi(Ce,ze,16*+P,Ie,Ke)}else if(Ie=Xi(z,H,Le.Ob[0]),eo[Ie](Q,Z),Ce!=0)for(P=0;16>P;++P,Ce<<=2)mi(Ce,ze,16*+P,Q,Z+gp[P]);for(P=Le.Gc,Ie=Xi(z,H,Le.Dd),wo[Ie](te,ue),wo[Ie](Ee,De),Ce=ze,Ie=te,Ke=ue,255&(Le=P>>0)&&(170&Le?Ga(Ce,256,Ie,Ke):Xo(Ce,256,Ie,Ke)),Le=Ee,Ce=De,255&(P>>=8)&&(170&P?Ga(ze,320,Le,Ce):Xo(ze,320,Le,Ce)),H<v.Ub-1&&(r(Pe[Qe].y,0,Q,Z+480,16),r(Pe[Qe].f,0,te,ue+224,8),r(Pe[Qe].ea,0,Ee,De+224,8)),P=8*X*v.B,Pe=v.sa,Qe=v.ta+16*z+16*X*v.R,ze=v.qa,Le=v.ra+8*z+P,Ce=v.Ha,Ie=v.Ia+8*z+P,P=0;16>P;++P)r(Pe,Qe+P*v.R,Q,Z+32*P,16);for(P=0;8>P;++P)r(ze,Le+P*v.B,te,ue+32*P,8),r(Ce,Ie+P*v.B,Ee,De+32*P,8)}}function zs(v,S,P,z,H,X,Q,Z,te){var ue=[0],Ee=[0],De=0,Le=te!=null?te.kd:0,Pe=te??new Vs;if(v==null||12>P)return 7;Pe.data=v,Pe.w=S,Pe.ha=P,S=[S],P=[P],Pe.gb=[Pe.gb];e:{var Qe=S,ze=P,Ce=Pe.gb;if(e(v!=null),e(ze!=null),e(Ce!=null),Ce[0]=0,12<=ze[0]&&!t(v,Qe[0],"RIFF")){if(t(v,Qe[0]+8,"WEBP")){Ce=3;break e}var Ie=Je(v,Qe[0]+4);if(12>Ie||4294967286<Ie){Ce=3;break e}if(Le&&Ie>ze[0]-8){Ce=7;break e}Ce[0]=Ie,Qe[0]+=12,ze[0]-=12}Ce=0}if(Ce!=0)return Ce;for(Ie=0<Pe.gb[0],P=P[0];;){e:{var Ke=v;ze=S,Ce=P;var Ge=ue,Xe=Ee,bt=Qe=[0];if((yt=De=[De])[0]=0,8>Ce[0])Ce=7;else{if(!t(Ke,ze[0],"VP8X")){if(Je(Ke,ze[0]+4)!=10){Ce=3;break e}if(18>Ce[0]){Ce=7;break e}var gt=Je(Ke,ze[0]+8),zt=1+et(Ke,ze[0]+12);if(2147483648<=zt*(Ke=1+et(Ke,ze[0]+15))){Ce=3;break e}bt!=null&&(bt[0]=gt),Ge!=null&&(Ge[0]=zt),Xe!=null&&(Xe[0]=Ke),ze[0]+=18,Ce[0]-=18,yt[0]=1}Ce=0}}if(De=De[0],Qe=Qe[0],Ce!=0)return Ce;if(ze=!!(2&Qe),!Ie&&De)return 3;if(X!=null&&(X[0]=!!(16&Qe)),Q!=null&&(Q[0]=ze),Z!=null&&(Z[0]=0),Q=ue[0],Qe=Ee[0],De&&ze&&te==null){Ce=0;break}if(4>P){Ce=7;break}if(Ie&&De||!Ie&&!De&&!t(v,S[0],"ALPH")){P=[P],Pe.na=[Pe.na],Pe.P=[Pe.P],Pe.Sa=[Pe.Sa];e:{gt=v,Ce=S,Ie=P;var yt=Pe.gb;Ge=Pe.na,Xe=Pe.P,bt=Pe.Sa,zt=22,e(gt!=null),e(Ie!=null),Ke=Ce[0];var In=Ie[0];for(e(Ge!=null),e(bt!=null),Ge[0]=null,Xe[0]=null,bt[0]=0;;){if(Ce[0]=Ke,Ie[0]=In,8>In){Ce=7;break e}var Tn=Je(gt,Ke+4);if(4294967286<Tn){Ce=3;break e}var Sn=8+Tn+1&-2;if(zt+=Sn,0<yt&&zt>yt){Ce=3;break e}if(!t(gt,Ke,"VP8 ")||!t(gt,Ke,"VP8L")){Ce=0;break e}if(In[0]<Sn){Ce=7;break e}t(gt,Ke,"ALPH")||(Ge[0]=gt,Xe[0]=Ke+8,bt[0]=Tn),Ke+=Sn,In-=Sn}}if(P=P[0],Pe.na=Pe.na[0],Pe.P=Pe.P[0],Pe.Sa=Pe.Sa[0],Ce!=0)break}P=[P],Pe.Ja=[Pe.Ja],Pe.xa=[Pe.xa];e:if(yt=v,Ce=S,Ie=P,Ge=Pe.gb[0],Xe=Pe.Ja,bt=Pe.xa,gt=Ce[0],Ke=!t(yt,gt,"VP8 "),zt=!t(yt,gt,"VP8L"),e(yt!=null),e(Ie!=null),e(Xe!=null),e(bt!=null),8>Ie[0])Ce=7;else{if(Ke||zt){if(yt=Je(yt,gt+4),12<=Ge&&yt>Ge-12){Ce=3;break e}if(Le&&yt>Ie[0]-8){Ce=7;break e}Xe[0]=yt,Ce[0]+=8,Ie[0]-=8,bt[0]=zt}else bt[0]=5<=Ie[0]&&yt[gt+0]==47&&!(yt[gt+4]>>5),Xe[0]=Ie[0];Ce=0}if(P=P[0],Pe.Ja=Pe.Ja[0],Pe.xa=Pe.xa[0],S=S[0],Ce!=0)break;if(4294967286<Pe.Ja)return 3;if(Z==null||ze||(Z[0]=Pe.xa?2:1),Q=[Q],Qe=[Qe],Pe.xa){if(5>P){Ce=7;break}Z=Q,Le=Qe,ze=X,v==null||5>P?v=0:5<=P&&v[S+0]==47&&!(v[S+4]>>5)?(Ie=[0],yt=[0],Ge=[0],K(Xe=new j,v,S,P),_t(Xe,Ie,yt,Ge)?(Z!=null&&(Z[0]=Ie[0]),Le!=null&&(Le[0]=yt[0]),ze!=null&&(ze[0]=Ge[0]),v=1):v=0):v=0}else{if(10>P){Ce=7;break}Z=Qe,v==null||10>P||!ml(v,S+3,P-3)?v=0:(Le=v[S+0]|v[S+1]<<8|v[S+2]<<16,ze=16383&(v[S+7]<<8|v[S+6]),v=16383&(v[S+9]<<8|v[S+8]),1&Le||3<(Le>>1&7)||!(Le>>4&1)||Le>>5>=Pe.Ja||!ze||!v?v=0:(Q&&(Q[0]=ze),Z&&(Z[0]=v),v=1))}if(!v||(Q=Q[0],Qe=Qe[0],De&&(ue[0]!=Q||Ee[0]!=Qe)))return 3;te!=null&&(te[0]=Pe,te.offset=S-te.w,e(4294967286>S-te.w),e(te.offset==te.ha-P));break}return Ce==0||Ce==7&&De&&te==null?(X!=null&&(X[0]|=Pe.na!=null&&0<Pe.na.length),z!=null&&(z[0]=Q),H!=null&&(H[0]=Qe),0):Ce}function hc(v,S,P){var z=S.width,H=S.height,X=0,Q=0,Z=z,te=H;if(S.Da=v!=null&&0<v.Da,S.Da&&(Z=v.cd,te=v.bd,X=v.v,Q=v.j,11>P||(X&=-2,Q&=-2),0>X||0>Q||0>=Z||0>=te||X+Z>z||Q+te>H))return 0;if(S.v=X,S.j=Q,S.va=X+Z,S.o=Q+te,S.U=Z,S.T=te,S.da=v!=null&&0<v.da,S.da){if(!ft(Z,te,P=[v.ib],X=[v.hb]))return 0;S.ib=P[0],S.hb=X[0]}return S.ob=v!=null&&v.ob,S.Kb=v==null||!v.Sd,S.da&&(S.ob=S.ib<3*z/4&&S.hb<3*H/4,S.Kb=0),1}function fc(v){if(v==null)return 2;if(11>v.S){var S=v.f.RGBA;S.fb+=(v.height-1)*S.A,S.A=-S.A}else S=v.f.kb,v=v.height,S.O+=(v-1)*S.fa,S.fa=-S.fa,S.N+=(v-1>>1)*S.Ab,S.Ab=-S.Ab,S.W+=(v-1>>1)*S.Db,S.Db=-S.Db,S.F!=null&&(S.J+=(v-1)*S.lb,S.lb=-S.lb);return 0}function xl(v,S,P,z){if(z==null||0>=v||0>=S)return 2;if(P!=null){if(P.Da){var H=P.cd,X=P.bd,Q=-2&P.v,Z=-2&P.j;if(0>Q||0>Z||0>=H||0>=X||Q+H>v||Z+X>S)return 2;v=H,S=X}if(P.da){if(!ft(v,S,H=[P.ib],X=[P.hb]))return 2;v=H[0],S=X[0]}}z.width=v,z.height=S;e:{var te=z.width,ue=z.height;if(v=z.S,0>=te||0>=ue||!(v>=Rf&&13>v))v=2;else{if(0>=z.Rd&&z.sd==null){Q=X=H=S=0;var Ee=(Z=te*jh[v])*ue;if(11>v||(X=(ue+1)/2*(S=(te+1)/2),v==12&&(Q=(H=te)*ue)),(ue=o(Ee+2*X+Q))==null){v=1;break e}z.sd=ue,11>v?((te=z.f.RGBA).eb=ue,te.fb=0,te.A=Z,te.size=Ee):((te=z.f.kb).y=ue,te.O=0,te.fa=Z,te.Fd=Ee,te.f=ue,te.N=0+Ee,te.Ab=S,te.Cd=X,te.ea=ue,te.W=0+Ee+X,te.Db=S,te.Ed=X,v==12&&(te.F=ue,te.J=0+Ee+2*X),te.Tc=Q,te.lb=H)}if(S=1,H=z.S,X=z.width,Q=z.height,H>=Rf&&13>H)if(11>H)v=z.f.RGBA,S&=(Z=Math.abs(v.A))*(Q-1)+X<=v.size,S&=Z>=X*jh[H],S&=v.eb!=null;else{v=z.f.kb,Z=(X+1)/2,Ee=(Q+1)/2,te=Math.abs(v.fa),ue=Math.abs(v.Ab);var De=Math.abs(v.Db),Le=Math.abs(v.lb),Pe=Le*(Q-1)+X;S&=te*(Q-1)+X<=v.Fd,S&=ue*(Ee-1)+Z<=v.Cd,S=(S&=De*(Ee-1)+Z<=v.Ed)&te>=X&ue>=Z&De>=Z,S&=v.y!=null,S&=v.f!=null,S&=v.ea!=null,H==12&&(S&=Le>=X,S&=Pe<=v.Tc,S&=v.F!=null)}else S=0;v=S?0:2}}return v!=0||P!=null&&P.fd&&(v=fc(z)),v}var _r=64,dc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],pc=24,mc=32,gc=8,Yi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];at("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(v){return v},C.Predictor2=function(v,S,P){return S[P+0]},C.Predictor3=function(v,S,P){return S[P+1]},C.Predictor4=function(v,S,P){return S[P-1]},C.Predictor5=function(v,S,P){return ct(ct(v,S[P+1]),S[P+0])},C.Predictor6=function(v,S,P){return ct(v,S[P-1])},C.Predictor7=function(v,S,P){return ct(v,S[P+0])},C.Predictor8=function(v,S,P){return ct(S[P-1],S[P+0])},C.Predictor9=function(v,S,P){return ct(S[P+0],S[P+1])},C.Predictor10=function(v,S,P){return ct(ct(v,S[P-1]),ct(S[P+0],S[P+1]))},C.Predictor11=function(v,S,P){var z=S[P+0];return 0>=jt(z>>24&255,v>>24&255,(S=S[P-1])>>24&255)+jt(z>>16&255,v>>16&255,S>>16&255)+jt(z>>8&255,v>>8&255,S>>8&255)+jt(255&z,255&v,255&S)?z:v},C.Predictor12=function(v,S,P){var z=S[P+0];return(xt((v>>24&255)+(z>>24&255)-((S=S[P-1])>>24&255))<<24|xt((v>>16&255)+(z>>16&255)-(S>>16&255))<<16|xt((v>>8&255)+(z>>8&255)-(S>>8&255))<<8|xt((255&v)+(255&z)-(255&S)))>>>0},C.Predictor13=function(v,S,P){var z=S[P-1];return(Vt((v=ct(v,S[P+0]))>>24&255,z>>24&255)<<24|Vt(v>>16&255,z>>16&255)<<16|Vt(v>>8&255,z>>8&255)<<8|Vt(v>>0&255,z>>0&255))>>>0};var _l=C.PredictorAdd0;C.PredictorAdd1=Pt,at("Predictor2","PredictorAdd2"),at("Predictor3","PredictorAdd3"),at("Predictor4","PredictorAdd4"),at("Predictor5","PredictorAdd5"),at("Predictor6","PredictorAdd6"),at("Predictor7","PredictorAdd7"),at("Predictor8","PredictorAdd8"),at("Predictor9","PredictorAdd9"),at("Predictor10","PredictorAdd10"),at("Predictor11","PredictorAdd11"),at("Predictor12","PredictorAdd12"),at("Predictor13","PredictorAdd13");var za=C.PredictorAdd2;en("ColorIndexInverseTransform","MapARGB","32b",(function(v){return v>>8&255}),(function(v){return v})),en("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(v){return v}),(function(v){return v>>8&255}));var Pf,Ji=C.ColorIndexInverseTransform,vc=C.MapARGB,Nh=C.VP8LColorIndexInverseTransformAlpha,yc=C.MapAlpha,va=C.VP8LPredictorsAdd=[];va.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var Ru,Qi,Li,Du,Wa,qa,wc,Ha,Rn,Ga,Mi,Xo,El,Ph,Sl,Al,Cl,Yo,$a,ya,Ka,Xa,Lu,gi,yo,Zn,zn,Er,Or=o(511),wa=o(2041),bc=o(225),Il=o(767),Rh=0,ba=wa,xc=bc,Zi=Il,ds=Or,Rf=0,Mu=1,Zm=2,Dh=3,Lh=4,er=5,Df=6,_c=7,Tl=8,Mh=9,Fh=10,Oh=[2,3,7],Lf=[3,3,11],kl=[280,256,256,256,40],eg=[0,1,1,1,0],s1=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],a1=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],tg=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Mf=8,Ec=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Bh=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Nl=null,fp=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],dp=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ng=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],rg=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],u1=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],l1=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],pp=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],eo=[],ps=[],wo=[],xa=1,Sc=2,Fi=[],bo=[];He("UpsampleRgbLinePair",ee,3),He("UpsampleBgrLinePair",Ne,3),He("UpsampleRgbaLinePair",sn,4),He("UpsampleBgraLinePair",vn,4),He("UpsampleArgbLinePair",on,4),He("UpsampleRgba4444LinePair",it,2),He("UpsampleRgb565LinePair",Fe,2);var c1=C.UpsampleRgbLinePair,h1=C.UpsampleBgrLinePair,Fu=C.UpsampleRgbaLinePair,Ac=C.UpsampleBgraLinePair,Pl=C.UpsampleArgbLinePair,Vh=C.UpsampleRgba4444LinePair,mp=C.UpsampleRgb565LinePair,Ya=16,Ws=1<<Ya-1,Wn=-227,Kn=482,Ou=6,vi=0,xo=o(256),Rl=o(256),Cc=o(256),_o=o(256),Ff=o(Kn-Wn),ig=o(Kn-Wn);Un("YuvToRgbRow",ee,3),Un("YuvToBgrRow",Ne,3),Un("YuvToRgbaRow",sn,4),Un("YuvToBgraRow",vn,4),Un("YuvToArgbRow",on,4),Un("YuvToRgba4444Row",it,2),Un("YuvToRgb565Row",Fe,2);var gp=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Dl=[0,2,8],og=[8,7,6,4,4,2,2,2,1,1,1,1],Ja=1;this.WebPDecodeRGBA=function(v,S,P,z,H){var X=Mu,Q=new Ko,Z=new yr;Q.ba=Z,Z.S=X,Z.width=[Z.width],Z.height=[Z.height];var te=Z.width,ue=Z.height,Ee=new ni;if(Ee==null||v==null)var De=2;else e(Ee!=null),De=zs(v,S,P,Ee.width,Ee.height,Ee.Pd,Ee.Qd,Ee.format,null);if(De!=0?te=0:(te!=null&&(te[0]=Ee.width[0]),ue!=null&&(ue[0]=Ee.height[0]),te=1),te){Z.width=Z.width[0],Z.height=Z.height[0],z!=null&&(z[0]=Z.width),H!=null&&(H[0]=Z.height);e:{if(z=new Fa,(H=new Vs).data=v,H.w=S,H.ha=P,H.kd=1,S=[0],e(H!=null),((v=zs(H.data,H.w,H.ha,null,null,null,S,null,H))==0||v==7)&&S[0]&&(v=4),(S=v)==0){if(e(Q!=null),z.data=H.data,z.w=H.w+H.offset,z.ha=H.ha-H.offset,z.put=ri,z.ac=Sr,z.bc=fo,z.ma=Q,H.xa){if((v=wr())==null){Q=1;break e}if((function(Le,Pe){var Qe=[0],ze=[0],Ce=[0];t:for(;;){if(Le==null)return 0;if(Pe==null)return Le.a=2,0;if(Le.l=Pe,Le.a=0,K(Le.m,Pe.data,Pe.w,Pe.ha),!_t(Le.m,Qe,ze,Ce)){Le.a=3;break t}if(Le.xb=Sc,Pe.width=Qe[0],Pe.height=ze[0],!Wo(Qe[0],ze[0],1,Le,null))break t;return 1}return e(Le.a!=0),0})(v,z)){if(z=(S=xl(z.width,z.height,Q.Oa,Q.ba))==0){t:{z=v;n:for(;;){if(z==null){z=0;break t}if(e(z.s.yc!=null),e(z.s.Ya!=null),e(0<z.s.Wb),e((P=z.l)!=null),e((H=P.ma)!=null),z.xb!=0){if(z.ca=H.ba,z.tb=H.tb,e(z.ca!=null),!hc(H.Oa,P,Dh)){z.a=2;break n}if(!Ps(z,P.width)||P.da)break n;if((P.da||gn(z.ca.S))&&Re(),11>z.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),z.ca.f.kb.F!=null&&Re()),z.Pb&&0<z.s.ua&&z.s.vb.X==null&&!Be(z.s.vb,z.s.Wa.Xa)){z.a=1;break n}z.xb=0}if(!Ar(z,z.V,z.Ba,z.c,z.i,P.o,ia))break n;H.Dc=z.Ma,z=1;break t}e(z.a!=0),z=0}z=!z}z&&(S=v.a)}else S=v.a}else{if((v=new ci)==null){Q=1;break e}if(v.Fa=H.na,v.P=H.P,v.qc=H.Sa,gl(v,z)){if((S=xl(z.width,z.height,Q.Oa,Q.ba))==0){if(v.Aa=0,P=Q.Oa,e((H=v)!=null),P!=null){if(0<(te=0>(te=P.Md)?0:100<te?255:255*te/100)){for(ue=Ee=0;4>ue;++ue)12>(De=H.pb[ue]).lc&&(De.ia=te*og[0>De.lc?0:De.lc]>>3),Ee|=De.ia;Ee&&(alert("todo:VP8InitRandom"),H.ia=1)}H.Ga=P.Id,100<H.Ga?H.Ga=100:0>H.Ga&&(H.Ga=0)}ua(v,z)||(S=v.a)}}else S=v.a}S==0&&Q.Oa!=null&&Q.Oa.fd&&(S=fc(Q.ba))}Q=S}X=Q!=0?null:11>X?Z.f.RGBA.eb:Z.f.kb.y}else X=null;return X};var jh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function l(C,L){for(var B="",R=0;R<4;R++)B+=String.fromCharCode(C[L++]);return B}function h(C,L){return(C[L+0]<<0|C[L+1]<<8|C[L+2]<<16)>>>0}function d(C,L){return(C[L+0]<<0|C[L+1]<<8|C[L+2]<<16|C[L+3]<<24)>>>0}new u;var p=[0],m=[0],w=[],b=new u,x=n,E=(function(C,L){var B={},R=0,M=!1,U=0,J=0;if(B.frames=[],!(function($,ne,ce,ge){for(var ye=0;ye<ge;ye++)if($[ne+ye]!=ce.charCodeAt(ye))return!0;return!1})(C,L,"RIFF",4)){var de,fe;for(d(C,L+=4),L+=8;L<C.length;){var he=l(C,L),K=d(C,L+=4);L+=4;var le=K+(1&K);switch(he){case"VP8 ":case"VP8L":B.frames[R]===void 0&&(B.frames[R]={}),(j=B.frames[R]).src_off=M?J:L-8,j.src_size=U+K+8,R++,M&&(M=!1,U=0,J=0);break;case"VP8X":(j=B.header={}).feature_flags=C[L];var se=L+4;j.canvas_width=1+h(C,se),se+=3,j.canvas_height=1+h(C,se),se+=3;break;case"ALPH":M=!0,U=le+8,J=L-8;break;case"ANIM":(j=B.header).bgcolor=d(C,L),se=L+4,j.loop_count=(de=C)[(fe=se)+0]<<0|de[fe+1]<<8,se+=2;break;case"ANMF":var re,j;(j=B.frames[R]={}).offset_x=2*h(C,L),L+=3,j.offset_y=2*h(C,L),L+=3,j.width=1+h(C,L),L+=3,j.height=1+h(C,L),L+=3,j.duration=h(C,L),L+=3,re=C[L++],j.dispose=1&re,j.blend=re>>1&1}he!="ANMF"&&(L+=le)}return B}})(x,0);E.response=x,E.rgbaoutput=!0,E.dataurl=!1;var A=E.header?E.header:null,N=E.frames?E.frames:null;if(A){A.loop_counter=A.loop_count,p=[A.canvas_height],m=[A.canvas_width];for(var F=0;F<N.length&&N[F].blend!=0;F++);}var D=N[0],W=b.WebPDecodeRGBA(x,D.src_off,D.src_size,m,p);D.rgba=W,D.imgwidth=m[0],D.imgheight=p[0];for(var k=0;k<m[0]*p[0]*4;k++)w[k]=W[k];return this.width=m,this.height=p,this.data=w,this}(function(n){var e=function(){return typeof X2=="function"},t=function(p,m,w,b){var x=4,E=s;switch(b){case n.image_compression.FAST:x=1,E=o;break;case n.image_compression.MEDIUM:x=6,E=a;break;case n.image_compression.SLOW:x=9,E=u}p=r(p,m,w,E);var A=X2(p,{level:x});return n.__addimage__.arrayBufferToBinaryString(A)},r=function(p,m,w,b){for(var x,E,A,N=p.length/m,F=new Uint8Array(p.length+N),D=h(),W=0;W<N;W+=1){if(A=W*m,x=p.subarray(A,A+m),b)F.set(b(x,w,E),A+W);else{for(var k,C=D.length,L=[];k<C;k+=1)L[k]=D[k](x,w,E);var B=d(L.concat());F.set(L[B],A+W)}E=x}return F},i=function(p){var m=Array.apply([],p);return m.unshift(0),m},o=function(p,m){var w,b=[],x=p.length;b[0]=1;for(var E=0;E<x;E+=1)w=p[E-m]||0,b[E+1]=p[E]-w+256&255;return b},s=function(p,m,w){var b,x=[],E=p.length;x[0]=2;for(var A=0;A<E;A+=1)b=w&&w[A]||0,x[A+1]=p[A]-b+256&255;return x},a=function(p,m,w){var b,x,E=[],A=p.length;E[0]=3;for(var N=0;N<A;N+=1)b=p[N-m]||0,x=w&&w[N]||0,E[N+1]=p[N]+256-(b+x>>>1)&255;return E},u=function(p,m,w){var b,x,E,A,N=[],F=p.length;N[0]=4;for(var D=0;D<F;D+=1)b=p[D-m]||0,x=w&&w[D]||0,E=w&&w[D-m]||0,A=l(b,x,E),N[D+1]=p[D]-A+256&255;return N},l=function(p,m,w){if(p===m&&m===w)return p;var b=Math.abs(m-w),x=Math.abs(p-w),E=Math.abs(p+m-w-w);return b<=x&&b<=E?p:x<=E?m:w},h=function(){return[i,o,s,a,u]},d=function(p){var m=p.map((function(w){return w.reduce((function(b,x){return b+Math.abs(x)}),0)}));return m.indexOf(Math.min.apply(null,m))};n.processPNG=function(p,m,w,b){var x,E,A,N,F,D,W,k,C,L,B,R,M,U,J,de=this.decode.FLATE_DECODE,fe="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(A=new xU(p)).imgData,E=A.bits,x=A.colorSpace,F=A.colors,[4,6].indexOf(A.colorType)!==-1){if(A.bits===8){C=(k=A.pixelBitlength==32?new Uint32Array(A.decodePixels().buffer):A.pixelBitlength==16?new Uint16Array(A.decodePixels().buffer):new Uint8Array(A.decodePixels().buffer)).length,B=new Uint8Array(C*A.colors),L=new Uint8Array(C);var he,K=A.pixelBitlength-A.bits;for(U=0,J=0;U<C;U++){for(M=k[U],he=0;he<K;)B[J++]=M>>>he&255,he+=A.bits;L[U]=M>>>he&255}}if(A.bits===16){C=(k=new Uint32Array(A.decodePixels().buffer)).length,B=new Uint8Array(C*(32/A.pixelBitlength)*A.colors),L=new Uint8Array(C*(32/A.pixelBitlength)),R=A.colors>1,U=0,J=0;for(var le=0;U<C;)M=k[U++],B[J++]=M>>>0&255,R&&(B[J++]=M>>>16&255,M=k[U++],B[J++]=M>>>0&255),L[le++]=M>>>16&255;E=8}b!==n.image_compression.NONE&&e()?(p=t(B,A.width*A.colors,A.colors,b),W=t(L,A.width,1,b)):(p=B,W=L,de=void 0)}if(A.colorType===3&&(x=this.color_spaces.INDEXED,D=A.palette,A.transparency.indexed)){var se=A.transparency.indexed,re=0;for(U=0,C=se.length;U<C;++U)re+=se[U];if((re/=255)===C-1&&se.indexOf(0)!==-1)N=[se.indexOf(0)];else if(re!==C){for(k=A.decodePixels(),L=new Uint8Array(k.length),U=0,C=k.length;U<C;U++)L[U]=se[k[U]];W=t(L,A.width,1)}}var j=(function($){var ne;switch($){case n.image_compression.FAST:ne=11;break;case n.image_compression.MEDIUM:ne=13;break;case n.image_compression.SLOW:ne=14;break;default:ne=12}return ne})(b);return de===this.decode.FLATE_DECODE&&(fe="/Predictor "+j+" "),fe+="/Colors "+F+" /BitsPerComponent "+E+" /Columns "+A.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(W&&this.__addimage__.isArrayBuffer(W)||this.__addimage__.isArrayBufferView(W))&&(W=this.__addimage__.arrayBufferToBinaryString(W)),{alias:w,data:p,index:m,filter:de,decodeParameters:fe,transparency:N,palette:D,sMask:W,predictor:j,width:A.width,height:A.height,bitsPerComponent:E,colorSpace:x}}}})(Xt.API),(function(n){n.processGIF89A=function(e,t,r,i){var o=new _U(e),s=o.width,a=o.height,u=[];o.decodeAndBlitFrameRGBA(0,u);var l={data:u,width:s,height:a},h=new Hy(100).encode(l,100);return n.processJPEG.call(this,h,t,r,i)},n.processGIF87A=n.processGIF89A})(Xt.API),uu.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},uu.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){sr.log("bit decode error:"+t)}},uu.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+8*i*4,a=0;a<8&&8*i+a<this.width;a++){var u=this.palette[o>>7-a&1];this.data[s+4*a]=u.blue,this.data[s+4*a+1]=u.green,this.data[s+4*a+2]=u.red,this.data[s+4*a+3]=255}t!==0&&(this.pos+=4-t)}},uu.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<n;i++){var o=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+2*i*4,a=o>>4,u=15&o,l=this.palette[a];if(this.data[s]=l.blue,this.data[s+1]=l.green,this.data[s+2]=l.red,this.data[s+3]=255,2*i+1>=this.width)break;l=this.palette[u],this.data[s+4]=l.blue,this.data[s+4+1]=l.green,this.data[s+4+2]=l.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},uu.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}n!==0&&(this.pos+=4-n)}},uu.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,a=(o>>5&e)/e*255|0,u=(o>>10&e)/e*255|0,l=o>>15?255:0,h=r*this.width*4+4*i;this.data[h]=u,this.data[h+1]=a,this.data[h+2]=s,this.data[h+3]=l}this.pos+=n}},uu.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,u=(s>>5&t)/t*255|0,l=(s>>11)/e*255|0,h=i*this.width*4+4*o;this.data[h]=l,this.data[h+1]=u,this.data[h+2]=a,this.data[h+3]=255}this.pos+=n}},uu.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*t;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=r,this.data[s+3]=255}this.pos+=this.width%4}},uu.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=o,this.data[a+1]=i,this.data[a+2]=r,this.data[a+3]=s}},uu.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,r,i){var o=new uu(e,!1),s=o.width,a=o.height,u={data:o.getData(),width:s,height:a},l=new Hy(100).encode(u,100);return n.processJPEG.call(this,l,t,r,i)}})(Xt.API),zS.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,r,i){var o=new zS(e),s=o.width,a=o.height,u={data:o.getData(),width:s,height:a},l=new Hy(100).encode(u,100);return n.processJPEG.call(this,l,t,r,i)}})(Xt.API),Xt.API.processRGBA=function(n,e,t){for(var r=n.data,i=r.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),a=0,u=0,l=0;l<i;l+=4){var h=r[l],d=r[l+1],p=r[l+2],m=r[l+3];o[a++]=h,o[a++]=d,o[a++]=p,s[u++]=m}var w=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:w,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},Xt.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},rd=Xt.API,tv=rd.getCharWidthsArray=function(n,e){var t,r,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:i.metadata.Unicode.widths,u=a.fof?a.fof:1,l=e.kerning?e.kerning:i.metadata.Unicode.kerning,h=l.fof?l.fof:1,d=e.doKerning!==!1,p=0,m=n.length,w=0,b=a[0]||u,x=[];for(t=0;t<m;t++)r=n.charCodeAt(t),typeof i.metadata.widthOfString=="function"?x.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+s*(1e3/o)||0)/1e3):(p=d&&tr(l[r])==="object"&&!isNaN(parseInt(l[r][w],10))?l[r][w]/h:0,x.push((a[r]||b)/u+p)),w=r;return x},BS=rd.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return rd.processArabic&&(n=rd.processArabic(n)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(n,t,i)/t:tv.apply(this,arguments).reduce((function(o,s){return o+s}),0)},VS=function(n,e,t,r){for(var i=[],o=0,s=n.length,a=0;o!==s&&a+e[o]<t;)a+=e[o],o++;i.push(n.slice(0,o));var u=o;for(a=0;o!==s;)a+e[o]>r&&(i.push(n.slice(u,o)),a=0,u=o),a+=e[o],o++;return u!==o&&i.push(n.slice(u,o)),i},jS=function(n,e,t){t||(t={});var r,i,o,s,a,u,l,h=[],d=[h],p=t.textIndent||0,m=0,w=0,b=n.split(" "),x=tv.apply(this,[" ",t])[0];if(u=t.lineIndent===-1?b[0].length+2:t.lineIndent||0){var E=Array(u).join(" "),A=[];b.map((function(F){(F=F.split(/\s*\n/)).length>1?A=A.concat(F.map((function(D,W){return(W&&D.length?`
`:"")+D}))):A.push(F[0])})),b=A,u=BS.apply(this,[E,t])}for(o=0,s=b.length;o<s;o++){var N=0;if(r=b[o],u&&r[0]==`
`&&(r=r.substr(1),N=1),p+m+(w=(i=tv.apply(this,[r,t])).reduce((function(F,D){return F+D}),0))>e||N){if(w>e){for(a=VS.apply(this,[r,i,e-(p+m),e]),h.push(a.shift()),h=[a.pop()];a.length;)d.push([a.shift()]);w=i.slice(r.length-(h[0]?h[0].length:0)).reduce((function(F,D){return F+D}),0)}else h=[r];d.push(h),p=w+u,m=x}else h.push(r),p+=m+w,m=x}return l=u?function(F,D){return(D?E:"")+F.join(" ")}:function(F){return F.join(" ")},d.map(l)},rd.splitTextToSize=function(n,e,t){var r,i=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var d=this.internal.getFont(h.fontName,h.fontStyle);return d.metadata.Unicode?{widths:d.metadata.Unicode.widths||{0:1},kerning:d.metadata.Unicode.kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(n)?n:String(n).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=t.lineIndent;var a,u,l=[];for(a=0,u=r.length;a<u;a++)l=l.concat(jS.apply(this,[r[a],s,o]));return l},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},r={},i=0;i<e.length;i++)t[e[i]]="0123456789abcdef"[i],r["0123456789abcdef"[i]]=e[i];var o=function(d){return"0x"+parseInt(d,10).toString(16)},s=n.__fontmetrics__.compress=function(d){var p,m,w,b,x=["{"];for(var E in d){if(p=d[E],isNaN(parseInt(E,10))?m="'"+E+"'":(E=parseInt(E,10),m=(m=o(E).slice(2)).slice(0,-1)+r[m.slice(-1)]),typeof p=="number")p<0?(w=o(p).slice(3),b="-"):(w=o(p).slice(2),b=""),w=b+w.slice(0,-1)+r[w.slice(-1)];else{if(tr(p)!=="object")throw new Error("Don't know what to do with value type "+tr(p)+".");w=s(p)}x.push(m+w)}return x.push("}"),x.join("")},a=n.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,m,w,b,x={},E=1,A=x,N=[],F="",D="",W=d.length-1,k=1;k<W;k+=1)(b=d[k])=="'"?p?(w=p.join(""),p=void 0):p=[]:p?p.push(b):b=="{"?(N.push([A,w]),A={},w=void 0):b=="}"?((m=N.pop())[0][m[1]]=A,w=void 0,A=m[0]):b=="-"?E=-1:w===void 0?t.hasOwnProperty(b)?(F+=t[b],w=parseInt(F,16)*E,E=1,F=""):F+=b:t.hasOwnProperty(b)?(D+=t[b],A[w]=parseInt(D,16)*E,E=1,w=void 0,D=""):D+=b;return x},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},l={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},h={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(d){var p=d.font,m=h.Unicode[p.postScriptName];m&&(p.metadata.Unicode={},p.metadata.Unicode.widths=m.widths,p.metadata.Unicode.kerning=m.kerning);var w=l.Unicode[p.postScriptName];w&&(p.metadata.Unicode.encoding=w,p.encoding=w.codePages[0])}])})(Xt.API),(function(n){var e=function(t){for(var r=t.length,i=new Uint8Array(r),o=0;o<r;o++)i[o]=t.charCodeAt(o);return i};n.API.events.push(["addFont",function(t){var r=void 0,i=t.font,o=t.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(Zp(a)),s.metadata=n.API.TTFFont.open(a),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,r)}}])})(Xt),(function(n){function e(){return(Jt.canvg?Promise.resolve(Jt.canvg):q2(()=>import("./index.es-Ds8Oew00.js"),[])).catch((function(t){return Promise.reject(new Error("Could not load canvg: "+t))})).then((function(t){return t.default?t.default:t}))}Xt.API.addSvgAsImage=function(t,r,i,o,s,a,u,l){if(isNaN(r)||isNaN(i))throw sr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(s))throw sr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=o,h.height=s;var d=h.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,h.width,h.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return e().then((function(w){return w.fromString(d,t,p)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(w){return w.render(p)})).then((function(){m.addImage(h.toDataURL("image/jpeg",1),r,i,o,s,u,l)}))}})(),Xt.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,t);return this},Xt.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var r,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(s),u=[],l=0,h=0,d=0;function p(w,b){var x,E=!1;for(x=0;x<w.length;x+=1)w[x]===b&&(E=!0);return E}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var m=a.length;for(d=0;d<m;d+=1)t[a[d]].value=t[a[d]].defaultValue,t[a[d]].explicitSet=!1}if(tr(n)==="object"){for(i in n)if(o=n[i],p(a,i)&&o!==void 0){if(t[i].type==="boolean"&&typeof o=="boolean")t[i].value=o;else if(t[i].type==="name"&&p(t[i].valueSet,o))t[i].value=o;else if(t[i].type==="integer"&&Number.isInteger(o))t[i].value=o;else if(t[i].type==="array"){for(l=0;l<o.length;l+=1)if(r=!0,o[l].length===1&&typeof o[l][0]=="number")u.push(String(o[l]-1));else if(o[l].length>1){for(h=0;h<o[l].length;h+=1)typeof o[l][h]!="number"&&(r=!1);r===!0&&u.push([o[l][0]-1,o[l][1]-1].join(" "))}t[i].value="["+u.join(" ")+"]"}else t[i].value=t[i].defaultValue;t[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){var w,b=[];for(w in t)t[w].explicitSet===!0&&(t[w].type==="name"?b.push("/"+w+" /"+t[w].value):b.push("/"+w+" "+t[w].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(r)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),l=o.length+s.length+a.length+i.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+a+u),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(Xt.API),(function(n){var e=n.API,t=e.pdfEscape16=function(o,s){for(var a,u=s.metadata.Unicode.widths,l=["","0","00","000","0000"],h=[""],d=0,p=o.length;d<p;++d){if(a=s.metadata.characterToGlyph(o.charCodeAt(d)),s.metadata.glyIdsUsed.push(a),s.metadata.toUnicode[a]=o.charCodeAt(d),u.indexOf(a)==-1&&(u.push(a),u.push([parseInt(s.metadata.widthOfGlyph(a),10)])),a=="0")return h.join("");a=a.toString(16),h.push(l[4-a.length],a)}return h.join("")},r=function(o){var s,a,u,l,h,d,p;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],d=0,p=(a=Object.keys(o).sort((function(m,w){return m-w}))).length;d<p;d++)s=a[d],u.length>=100&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(l=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),u.push("<"+s+"><"+l+">"));return u.length&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var a=s.font,u=s.out,l=s.newObject,h=s.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="Identity-H"){for(var d=a.metadata.Unicode.widths,p=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),m="",w=0;w<p.length;w++)m+=String.fromCharCode(p[w]);var b=l();h({data:m,addLength1:!0,objectId:b}),u("endobj");var x=l();h({data:r(a.metadata.toUnicode),addLength1:!0,objectId:x}),u("endobj");var E=l();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+ld(a.fontName)),u("/FontFile2 "+b+" 0 R"),u("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),u("/Flags "+a.metadata.flags),u("/StemV "+a.metadata.stemV),u("/ItalicAngle "+a.metadata.italicAngle),u("/Ascent "+a.metadata.ascender),u("/Descent "+a.metadata.decender),u("/CapHeight "+a.metadata.capHeight),u(">>"),u("endobj");var A=l();u("<<"),u("/Type /Font"),u("/BaseFont /"+ld(a.fontName)),u("/FontDescriptor "+E+" 0 R"),u("/W "+n.API.PDFObject.convert(d)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+a.encoding+")"),u(">>"),u(">>"),u("endobj"),a.objectNumber=l(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+x+" 0 R"),u("/BaseFont /"+ld(a.fontName)),u("/Encoding /"+a.encoding),u("/DescendantFonts ["+A+" 0 R]"),u(">>"),u("endobj"),a.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var a=s.font,u=s.out,l=s.newObject,h=s.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var d=a.metadata.rawData,p="",m=0;m<d.length;m++)p+=String.fromCharCode(d[m]);var w=l();h({data:p,addLength1:!0,objectId:w}),u("endobj");var b=l();h({data:r(a.metadata.toUnicode),addLength1:!0,objectId:b}),u("endobj");var x=l();u("<<"),u("/Descent "+a.metadata.decender),u("/CapHeight "+a.metadata.capHeight),u("/StemV "+a.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+w+" 0 R"),u("/Flags 96"),u("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),u("/FontName /"+ld(a.fontName)),u("/ItalicAngle "+a.metadata.italicAngle),u("/Ascent "+a.metadata.ascender),u(">>"),u("endobj"),a.objectNumber=l();for(var E=0;E<a.metadata.hmtx.widths.length;E++)a.metadata.hmtx.widths[E]=parseInt(a.metadata.hmtx.widths[E]*(1e3/a.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+ld(a.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),u("endobj"),a.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,a=o.text||"",u=o.x,l=o.y,h=o.options||{},d=o.mutex||{},p=d.pdfEscape,m=d.activeFontKey,w=d.fonts,b=m,x="",E=0,A="",N=w[b].encoding;if(w[b].encoding!=="Identity-H")return{text:a,x:u,y:l,options:h,mutex:d};for(A=a,b=m,Array.isArray(a)&&(A=a[0]),E=0;E<A.length;E+=1)w[b].metadata.hasOwnProperty("cmap")&&(s=w[b].metadata.cmap.unicode.codeMap[A[E].charCodeAt(0)]),s||A[E].charCodeAt(0)<256&&w[b].metadata.hasOwnProperty("Unicode")?x+=A[E]:x+="";var F="";return parseInt(b.slice(1))<14||N==="WinAnsiEncoding"?F=p(x,b).split("").map((function(D){return D.charCodeAt(0).toString(16)})).join(""):N==="Identity-H"&&(F=t(x,w[b])),d.isHex=!0,{text:F,x:u,y:l,options:h,mutex:d}};e.events.push(["postProcessText",function(o){var s=o.text||"",a=[],u={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var l=0;for(l=0;l<s.length;l+=1)Array.isArray(s[l])&&s[l].length===3?a.push([i(Object.assign({},u,{text:s[l][0]})).text,s[l][1],s[l][2]]):a.push(i(Object.assign({},u,{text:s[l]})).text);o.text=a}else o.text=i(Object.assign({},u,{text:s})).text}])})(Xt),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,r){return e.call(this),this.internal.vFS[t]=r,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(Xt.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(r){var i,o,s,a,u,l,h,d=e,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],E=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),A=!1,N=0;this.__bidiEngine__={};var F=function(R){var M=R.charCodeAt(),U=M>>8,J=b[U];return J!==void 0?d[256*J+(255&M)]:U===252||U===253?"AL":E.test(U)?"L":U===8?"R":"N"},D=function(R){for(var M,U=0;U<R.length;U++){if((M=F(R.charAt(U)))==="L")return!1;if(M==="R")return!0}return!1},W=function(R,M,U,J){var de,fe,he,K,le=M[J];switch(le){case"L":case"R":A=!1;break;case"N":case"AN":break;case"EN":A&&(le="AN");break;case"AL":A=!0,le="R";break;case"WS":le="N";break;case"CS":J<1||J+1>=M.length||(de=U[J-1])!=="EN"&&de!=="AN"||(fe=M[J+1])!=="EN"&&fe!=="AN"?le="N":A&&(fe="AN"),le=fe===de?fe:"N";break;case"ES":le=(de=J>0?U[J-1]:"B")==="EN"&&J+1<M.length&&M[J+1]==="EN"?"EN":"N";break;case"ET":if(J>0&&U[J-1]==="EN"){le="EN";break}if(A){le="N";break}for(he=J+1,K=M.length;he<K&&M[he]==="ET";)he++;le=he<K&&M[he]==="EN"?"EN":"N";break;case"NSM":if(s&&!a){for(K=M.length,he=J+1;he<K&&M[he]==="NSM";)he++;if(he<K){var se=R[J],re=se>=1425&&se<=2303||se===64286;if(de=M[he],re&&(de==="R"||de==="AL")){le="R";break}}}le=J<1||(de=M[J-1])==="B"?"N":U[J-1];break;case"B":A=!1,i=!0,le=N;break;case"S":o=!0,le="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":A=!1;break;case"BN":le="N"}return le},k=function(R,M,U){var J=R.split("");return U&&C(J,U,{hiLevel:N}),J.reverse(),M&&M.reverse(),J.join("")},C=function(R,M,U){var J,de,fe,he,K,le=-1,se=R.length,re=0,j=[],$=N?m:p,ne=[];for(A=!1,i=!1,o=!1,de=0;de<se;de++)ne[de]=F(R[de]);for(fe=0;fe<se;fe++){if(K=re,j[fe]=W(R,ne,j,fe),J=240&(re=$[K][w[j[fe]]]),re&=15,M[fe]=he=$[re][5],J>0)if(J===16){for(de=le;de<fe;de++)M[de]=1;le=-1}else le=-1;if($[re][6])le===-1&&(le=fe);else if(le>-1){for(de=le;de<fe;de++)M[de]=he;le=-1}ne[fe]==="B"&&(M[fe]=0),U.hiLevel|=he}o&&(function(ce,ge,ye){for(var be=0;be<ye;be++)if(ce[be]==="S"){ge[be]=N;for(var Ae=be-1;Ae>=0&&ce[Ae]==="WS";Ae--)ge[Ae]=N}})(ne,M,se)},L=function(R,M,U,J,de){if(!(de.hiLevel<R)){if(R===1&&N===1&&!i)return M.reverse(),void(U&&U.reverse());for(var fe,he,K,le,se=M.length,re=0;re<se;){if(J[re]>=R){for(K=re+1;K<se&&J[K]>=R;)K++;for(le=re,he=K-1;le<he;le++,he--)fe=M[le],M[le]=M[he],M[he]=fe,U&&(fe=U[le],U[le]=U[he],U[he]=fe);re=K}re++}}},B=function(R,M,U){var J=R.split(""),de={hiLevel:N};return U||(U=[]),C(J,U,de),(function(fe,he,K){if(K.hiLevel!==0&&h)for(var le,se=0;se<fe.length;se++)he[se]===1&&(le=x.indexOf(fe[se]))>=0&&(fe[se]=x[le+1])})(J,U,de),L(2,J,M,U,de),L(1,J,M,U,de),J.join("")};return this.__bidiEngine__.doBidiReorder=function(R,M,U){if((function(de,fe){if(fe)for(var he=0;he<de.length;he++)fe[he]=he;a===void 0&&(a=D(de)),l===void 0&&(l=D(de))})(R,M),s||!u||l)if(s&&u&&a^l)N=a?1:0,R=k(R,M,U);else if(!s&&u&&l)N=a?1:0,R=B(R,M,U),R=k(R,M);else if(!s||a||u||l){if(s&&!u&&a^l)R=k(R,M),a?(N=0,R=B(R,M,U)):(N=1,R=B(R,M,U),R=k(R,M));else if(s&&a&&!u&&l)N=1,R=B(R,M,U),R=k(R,M);else if(!s&&!u&&a^l){var J=h;a?(N=1,R=B(R,M,U),N=0,h=!1,R=B(R,M,U),h=J):(N=0,R=B(R,M,U),R=k(R,M),N=1,h=!1,R=B(R,M,U),h=J,R=k(R,M))}}else N=0,R=B(R,M,U);else N=a?1:0,R=B(R,M,U);return R},this.__bidiEngine__.setOptions=function(R){R&&(s=R.isInputVisual,u=R.isOutputVisual,a=R.isInputRtl,l=R.isOutputRtl,h=R.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(r){var i=r.text,o=(r.x,r.y,r.options||{}),s=(r.mutex,o.lang,[]);if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var a=0;for(s=[],a=0;a<i.length;a+=1)Object.prototype.toString.call(i[a])==="[object Array]"?s.push([t.doBidiReorder(i[a][0]),i[a][1],i[a][2]]):s.push([t.doBidiReorder(i[a])]);r.text=s}else r.text=t.doBidiReorder(i);t.setOptions({isInputVisual:!0})}])})(Xt),Xt.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new vh(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new OU(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new EU(this.contents),this.head=new AU(this),this.name=new NU(this),this.cmap=new UT(this),this.toUnicode={},this.hhea=new CU(this),this.maxp=new PU(this),this.hmtx=new RU(this),this.post=new TU(this),this.os2=new IU(this),this.loca=new FU(this),this.glyf=new DU(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,r,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,a,u,l;for(l=[],s=0,a=(u=this.bbox).length;s<a;s++)e=u[s],l.push(Math.round(e*this.scaleFactor));return l}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),(32768&(t=i>>16))!=0&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,r){var i,o,s,a;for(s=0,o=0,a=(e=""+e).length;0<=a?o<a:o>a;o=0<=a?++o:--o)i=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/t)||0;return s*(t/1e3)},n.prototype.lineHeight=function(e,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},n})();var _u,vh=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},n.prototype.writeString=function(e){var t,r,i;for(i=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)i.push(this.writeByte(e.charCodeAt(t)));return i},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,r,i,o,s,a,u;return e=this.readByte(),t=this.readByte(),r=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),a=this.readByte(),u=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^a)+(255^u)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*i+16777216*o+65536*s+256*a+u},n.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},n.prototype.write=function(e){var t,r,i,o;for(o=[],r=0,i=e.length;r<i;r++)t=e[r],o.push(this.writeByte(t));return o},n})(),EU=(function(){var n;function e(t){var r,i,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(t){var r,i,o,s,a,u,l,h,d,p,m,w,b;for(b in m=Object.keys(t).length,u=Math.log(2),d=16*Math.floor(Math.log(m)/u),s=Math.floor(d/u),h=16*m-d,(i=new vh).writeInt(this.scalarType),i.writeShort(m),i.writeShort(d),i.writeShort(s),i.writeShort(h),o=16*m,l=i.pos+o,a=null,w=[],t)for(p=t[b],i.writeString(b),i.writeInt(n(p)),i.writeInt(l),i.writeInt(p.length),w=w.concat(p),b==="head"&&(a=l),l+=p.length;l%4;)w.push(0),l++;return i.write(w),r=2981146554-n(i.data),i.pos=a+8,i.writeUInt32(r),i.data},n=function(t){var r,i,o,s;for(t=zT.call(t);t.length%4;)t.push(0);for(o=new vh(t),i=0,r=0,s=t.length;r<s;r=r+=4)i+=o.readUInt32();return 4294967295&i},e})(),SU={}.hasOwnProperty,pl=function(n,e){for(var t in e)SU.call(e,t)&&(n[t]=e[t]);function r(){this.constructor=n}return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};_u=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var AU=(function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,_u),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new vh).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e})(),WS=(function(){function n(e,t){var r,i,o,s,a,u,l,h,d,p,m,w,b,x,E,A,N;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=e.readByte();break;case 4:for(m=e.readUInt16(),p=m/2,e.pos+=6,o=(function(){var F,D;for(D=[],u=F=0;0<=p?F<p:F>p;u=0<=p?++F:--F)D.push(e.readUInt16());return D})(),e.pos+=2,b=(function(){var F,D;for(D=[],u=F=0;0<=p?F<p:F>p;u=0<=p?++F:--F)D.push(e.readUInt16());return D})(),l=(function(){var F,D;for(D=[],u=F=0;0<=p?F<p:F>p;u=0<=p?++F:--F)D.push(e.readUInt16());return D})(),h=(function(){var F,D;for(D=[],u=F=0;0<=p?F<p:F>p;u=0<=p?++F:--F)D.push(e.readUInt16());return D})(),i=(this.length-e.pos+this.offset)/2,a=(function(){var F,D;for(D=[],u=F=0;0<=i?F<i:F>i;u=0<=i?++F:--F)D.push(e.readUInt16());return D})(),u=E=0,N=o.length;E<N;u=++E)for(x=o[u],r=A=w=b[u];w<=x?A<=x:A>=x;r=w<=x?++A:--A)h[u]===0?s=r+l[u]:(s=a[h[u]/2+(r-w)-(p-u)]||0)!==0&&(s+=l[u]),this.codeMap[r]=65535&s}e.pos=d}return n.encode=function(e,t){var r,i,o,s,a,u,l,h,d,p,m,w,b,x,E,A,N,F,D,W,k,C,L,B,R,M,U,J,de,fe,he,K,le,se,re,j,$,ne,ce,ge,ye,be,Ae,$e,Ue,et;switch(J=new vh,s=Object.keys(e).sort((function(Je,Be){return Je-Be})),t){case"macroman":for(b=0,x=(function(){var Je=[];for(w=0;w<256;++w)Je.push(0);return Je})(),A={0:0},o={},de=0,le=s.length;de<le;de++)A[Ae=e[i=s[de]]]==null&&(A[Ae]=++b),o[i]={old:e[i],new:A[e[i]]},x[i]=A[e[i]];return J.writeUInt16(1),J.writeUInt16(0),J.writeUInt32(12),J.writeUInt16(0),J.writeUInt16(262),J.writeUInt16(0),J.write(x),{charMap:o,subtable:J.data,maxGlyphID:b+1};case"unicode":for(M=[],d=[],N=0,A={},r={},E=l=null,fe=0,se=s.length;fe<se;fe++)A[D=e[i=s[fe]]]==null&&(A[D]=++N),r[i]={old:D,new:A[D]},a=A[D]-i,E!=null&&a===l||(E&&d.push(E),M.push(i),l=a),E=i;for(E&&d.push(E),d.push(65535),M.push(65535),B=2*(L=M.length),C=2*Math.pow(Math.log(L)/Math.LN2,2),p=Math.log(C/2)/Math.LN2,k=2*L-C,u=[],W=[],m=[],w=he=0,re=M.length;he<re;w=++he){if(R=M[w],h=d[w],R===65535){u.push(0),W.push(0);break}if(R-(U=r[R].new)>=32768)for(u.push(0),W.push(2*(m.length+L-w)),i=K=R;R<=h?K<=h:K>=h;i=R<=h?++K:--K)m.push(r[i].new);else u.push(U-R),W.push(0)}for(J.writeUInt16(3),J.writeUInt16(1),J.writeUInt32(12),J.writeUInt16(4),J.writeUInt16(16+8*L+2*m.length),J.writeUInt16(0),J.writeUInt16(B),J.writeUInt16(C),J.writeUInt16(p),J.writeUInt16(k),ye=0,j=d.length;ye<j;ye++)i=d[ye],J.writeUInt16(i);for(J.writeUInt16(0),be=0,$=M.length;be<$;be++)i=M[be],J.writeUInt16(i);for($e=0,ne=u.length;$e<ne;$e++)a=u[$e],J.writeUInt16(a);for(Ue=0,ce=W.length;Ue<ce;Ue++)F=W[Ue],J.writeUInt16(F);for(et=0,ge=m.length;et<ge;et++)b=m[et],J.writeUInt16(b);return{charMap:r,subtable:J.data,maxGlyphID:N+1}}},n})(),UT=(function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,_u),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,i,o;for(t.pos=this.offset,this.version=t.readUInt16(),o=t.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)r=new WS(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var i,o;return r==null&&(r="macroman"),i=WS.encode(t,r),(o=new vh).writeUInt16(0),o.writeUInt16(1),i.table=o.data.concat(i.subtable),i},e})(),CU=(function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,_u),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e})(),IU=(function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,_u),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var r,i;for(i=[],r=0;r<10;++r)i.push(t.readByte());return i})(),this.charRange=(function(){var r,i;for(i=[],r=0;r<4;++r)i.push(t.readInt());return i})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var r,i;for(i=[],r=0;r<2;r=++r)i.push(t.readInt());return i})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e})(),TU=(function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,_u),e.prototype.tag="post",e.prototype.parse=function(t){var r,i,o;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var s;for(i=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],o=[];t.pos<this.offset+this.length;)r=t.readByte(),o.push(this.names.push(t.readString(r)));return o;case 151552:return i=t.readUInt16(),this.offsets=t.read(i);case 196608:break;case 262144:return this.map=(function(){var a,u,l;for(l=[],s=a=0,u=this.file.maxp.numGlyphs;0<=u?a<u:a>u;s=0<=u?++a:--a)l.push(t.readUInt32());return l}).call(this)}},e})(),kU=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},NU=(function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,_u),e.prototype.tag="name",e.prototype.parse=function(t){var r,i,o,s,a,u,l,h,d,p,m;for(t.pos=this.offset,t.readShort(),r=t.readShort(),u=t.readShort(),i=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)i.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+u+t.readShort()});for(l={},s=d=0,p=i.length;d<p;s=++d)o=i[s],t.pos=o.offset,h=t.readString(o.length),a=new kU(h,o),l[m=o.nameID]==null&&(l[m]=[]),l[o.nameID].push(a);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},e})(),PU=(function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,_u),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e})(),RU=(function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,_u),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,i,o,s,a,u,l;for(t.pos=this.offset,this.metrics=[],r=0,u=this.file.hhea.numberOfMetrics;0<=u?r<u:r>u;r=0<=u?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,d;for(d=[],r=h=0;0<=o?h<o:h>o;r=0<=o?++h:--h)d.push(t.readInt16());return d})(),this.widths=(function(){var h,d,p,m;for(m=[],h=0,d=(p=this.metrics).length;h<d;h++)s=p[h],m.push(s.advance);return m}).call(this),i=this.widths[this.widths.length-1],l=[],r=a=0;0<=o?a<o:a>o;r=0<=o?++a:--a)l.push(this.widths.push(i));return l},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e})(),zT=[].slice,DU=(function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,_u),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,i,o,s,a,u,l,h,d,p;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,i=s.indexOf(t),(o=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+i,a=(u=new vh(r.read(o))).readShort(),h=u.readShort(),p=u.readShort(),l=u.readShort(),d=u.readShort(),this.cache[t]=a===-1?new MU(u,h,p,l,d):new LU(u,a,h,p,l,d),this.cache[t]))},e.prototype.encode=function(t,r,i){var o,s,a,u,l;for(a=[],s=[],u=0,l=r.length;u<l;u++)o=t[r[u]],s.push(a.length),o&&(a=a.concat(o.encode(i)));return s.push(a.length),{table:a,offsets:s}},e})(),LU=(function(){function n(e,t,r,i,o,s){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),MU=(function(){function n(e,t,r,i,o){var s,a;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;a=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&a;)s.pos+=1&a?4:2,128&a?s.pos+=8:64&a?s.pos+=4:8&a&&(s.pos+=2)}return n.prototype.encode=function(){var e,t,r;for(t=new vh(zT.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),FU=(function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,_u),e.prototype.tag="loca",e.prototype.parse=function(t){var r,i;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var i=new Uint32Array(this.offsets.length),o=0,s=0,a=0;a<i.length;++a)if(i[a]=o,s<r.length&&r[s]==a){++s,i[a]=o;var u=this.offsets[a],l=this.offsets[a+1]-u;l>0&&(o+=l)}for(var h=new Array(4*i.length),d=0;d<i.length;++d)h[4*d+3]=255&i[d],h[4*d+2]=(65280&i[d])>>8,h[4*d+1]=(16711680&i[d])>>16,h[4*d]=(4278190080&i[d])>>24;return h},e})(),OU=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,r,i,o;for(t in i=this.font.cmap.tables[0].codeMap,e={},o=this.subset)r=o[t],e[t]=i[r];return e},n.prototype.glyphsFor=function(e){var t,r,i,o,s,a,u;for(i={},s=0,a=e.length;s<a;s++)i[o=e[s]]=this.font.glyf.glyphFor(o);for(o in t=[],i)(r=i[o])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(o in u=this.glyphsFor(t))r=u[o],i[o]=r;return i},n.prototype.encode=function(e,t){var r,i,o,s,a,u,l,h,d,p,m,w,b,x,E;for(i in r=UT.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),m={0:0},E=r.charMap)m[(u=E[i]).old]=u.new;for(w in p=r.maxGlyphID,s)w in m||(m[w]=p++);return h=(function(A){var N,F;for(N in F={},A)F[A[N]]=N;return F})(m),d=Object.keys(h).sort((function(A,N){return A-N})),b=(function(){var A,N,F;for(F=[],A=0,N=d.length;A<N;A++)a=d[A],F.push(h[a]);return F})(),o=this.font.glyf.encode(s,b,m),l=this.font.loca.encode(o.offsets,b),x={cmap:this.font.cmap.raw(),glyf:o.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},n})();Xt.API.PDFObject=(function(){var n;function e(){}return n=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},e.convert=function(t){var r,i,o,s;if(Array.isArray(t))return"["+(function(){var a,u,l;for(l=[],a=0,u=t.length;a<u;a++)r=t[a],l.push(e.convert(r));return l})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(i in o=["<<"],t)s=t[i],o.push("/"+i+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+t},e})();const BU=()=>{const{incidentLog:n,addIncident:e,deleteIncident:t,setActiveMode:r,playSound:i,speak:o}=vu(),[s,a]=qe.useState({title:"",location:"",details:"",severity:"Low"}),[u,l]=qe.useState(null),h=w=>{const b=w.toLowerCase();let x=[];(b.includes("fight")||b.includes("brawl"))&&x.push(" Increase security presence in sector."),(b.includes("weapon")||b.includes("gun")||b.includes("knife"))&&x.push(" CRITICAL: Contact Police immediately. Lockdown perimeter."),(b.includes("iron")||b.includes("knuckle"))&&x.push(" MANDATORY: Metal detector wands at entry."),(b.includes("drug")||b.includes("pill"))&&x.push(" Search bathrooms and VIP areas."),(b.includes("overcrowd")||b.includes("full"))&&x.push(" Halt entry. Check fire exits."),x.length>0?(l(x),b.includes("weapon")&&o("High alert. Weapon protocol suggested.")):l(null)},d=w=>{a({...s,details:w.target.value}),h(w.target.value)},p=()=>{s.title&&(e(s),a({title:"",location:"",details:"",severity:"Low"}),l(null))},m=w=>{const b=new Xt;b.setFillColor(0,0,0),b.rect(0,0,210,40,"F"),b.setTextColor(0,229,255),b.setFont("helvetica","bold"),b.setFontSize(22),b.text("T-FORCE SECURITY SITREP",15,20),b.setFontSize(10),b.text("INTERNAL CLASSIFIED REPORT",15,30),b.setTextColor(0,0,0),b.setFontSize(14),b.text(`INCIDENT: ${w.title}`,15,60),b.setFontSize(12),b.text(`DATE: ${w.date}`,15,70),b.text(`LOCATION: ${w.location}`,15,80),b.text(`SEVERITY: ${w.severity.toUpperCase()}`,15,90),b.line(15,95,195,95),b.setFont("helvetica","normal"),b.text("DETAILS:",15,110);const x=b.splitTextToSize(w.details,180);b.text(x,15,120),b.setTextColor(150),b.setFontSize(10),b.text("Generated by JARVIS Operational Unit",15,280),b.save(`T-Force_Report_${w.id}.pdf`),o("Report compiled and downloaded.")};return ae.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[ae.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[ae.jsxs("div",{className:"flex items-center gap-3",children:[ae.jsx("i",{className:"fas fa-file-alt text-cyan text-xl animate-pulse"}),ae.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"INCIDENT LOG"})]}),ae.jsx("button",{onClick:()=>{i("click"),r("HOME")},className:"text-cyan hover:text-white",children:ae.jsx("i",{className:"fas fa-times text-2xl"})})]}),ae.jsxs("div",{className:"flex-1 overflow-y-auto p-6 no-scrollbar",children:[ae.jsxs("div",{className:"bg-cyan/5 border border-cyan/30 p-4 rounded mb-6",children:[ae.jsxs("div",{className:"mb-4",children:[ae.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"INCIDENT TYPE"}),ae.jsx("input",{type:"text",value:s.title,onChange:w=>a({...s,title:w.target.value}),className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none focus:border-cyan",placeholder:"E.g., Fight at Bar"})]}),ae.jsxs("div",{className:"flex gap-4 mb-4",children:[ae.jsxs("div",{className:"flex-1",children:[ae.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"LOCATION"}),ae.jsx("input",{type:"text",value:s.location,onChange:w=>a({...s,location:w.target.value}),className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Mykonos Club"})]}),ae.jsxs("div",{children:[ae.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"SEVERITY"}),ae.jsxs("select",{value:s.severity,onChange:w=>a({...s,severity:w.target.value}),className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none",children:[ae.jsx("option",{children:"Low"}),ae.jsx("option",{children:"Medium"}),ae.jsx("option",{children:"High"}),ae.jsx("option",{children:"Critical"})]})]})]}),ae.jsxs("div",{className:"mb-4",children:[ae.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"DETAILS"}),ae.jsx("textarea",{value:s.details,onChange:d,rows:"4",className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Describe the situation..."})]}),u&&ae.jsxs("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-500/50 rounded",children:[ae.jsx("div",{className:"text-red-500 font-orbitron text-xs mb-2",children:" TACTICAL ANALYSIS:"}),u.map((w,b)=>ae.jsx("div",{className:"text-red-300 text-xs font-mono",children:w},b))]}),ae.jsx("button",{onClick:p,className:"w-full py-3 bg-cyan/20 border border-cyan text-cyan font-orbitron tracking-widest hover:bg-cyan/40",children:"LOG INCIDENT"})]}),ae.jsx("div",{className:"space-y-4",children:n.map(w=>ae.jsxs("div",{className:"border border-white/10 p-4 rounded bg-white/5 flex justify-between items-start",children:[ae.jsxs("div",{children:[ae.jsx("div",{className:"text-cyan font-bold font-orbitron",children:w.title}),ae.jsxs("div",{className:"text-xs text-gray-400 font-mono mb-2",children:[w.date," | ",w.location]}),ae.jsx("div",{className:"text-sm text-gray-300",children:w.details}),ae.jsxs("div",{className:`mt-2 text-xs font-bold ${w.severity==="Critical"?"text-red-500":"text-cyan-dim"}`,children:["LEVEL: ",w.severity.toUpperCase()]})]}),ae.jsxs("div",{className:"flex flex-col gap-2",children:[ae.jsx("button",{onClick:()=>m(w),className:"p-2 border border-cyan/30 text-cyan rounded hover:bg-cyan/10",title:"Download PDF",children:ae.jsx("i",{className:"fas fa-file-pdf"})}),ae.jsx("button",{onClick:()=>t(w.id),className:"p-2 border border-red-500/30 text-red-500 rounded hover:bg-red-500/10",title:"Delete",children:ae.jsx("i",{className:"fas fa-trash"})})]})]},w.id))})]})]})},VU=()=>{const{leadsLog:n,addLead:e,updateLeadStatus:t,deleteLead:r,setActiveMode:i,playSound:o,speak:s}=vu(),[a,u]=qe.useState({name:"",location:"",type:"Factory"}),l=p=>{o("click"),s(`Initiating reconnaissance for ${p}.`),window.open(`https://www.google.com/maps/search/${p}+near+me`,"_blank")},h=()=>{a.name&&(e(a),u({name:"",location:"",type:"Factory"}))},d=p=>p==="Potential"?"text-gray-400 border-gray-500":p==="Contacted"?"text-orange-400 border-orange-500":p==="Contracted"?"text-green-400 border-green-500":"text-red-400 border-red-500";return ae.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[ae.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[ae.jsxs("div",{className:"flex items-center gap-3",children:[ae.jsx("i",{className:"fas fa-satellite-dish text-cyan text-xl animate-pulse"}),ae.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"RECON / SALES"})]}),ae.jsx("button",{onClick:()=>{o("click"),i("HOME")},className:"text-cyan hover:text-white",children:ae.jsx("i",{className:"fas fa-times text-2xl"})})]}),ae.jsxs("div",{className:"flex-1 overflow-y-auto p-6 no-scrollbar",children:[ae.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[ae.jsxs("button",{onClick:()=>l("Factories"),className:"p-4 border border-cyan/30 rounded bg-cyan/5 text-cyan hover:bg-cyan/20",children:[ae.jsx("i",{className:"fas fa-industry text-2xl mb-2"}),ae.jsx("div",{className:"font-orbitron text-xs",children:"FIND FACTORIES"})]}),ae.jsxs("button",{onClick:()=>l("Hotels"),className:"p-4 border border-cyan/30 rounded bg-cyan/5 text-cyan hover:bg-cyan/20",children:[ae.jsx("i",{className:"fas fa-hotel text-2xl mb-2"}),ae.jsx("div",{className:"font-orbitron text-xs",children:"FIND HOTELS"})]})]}),ae.jsxs("div",{className:"mb-6 border-t border-cyan/10 pt-4",children:[ae.jsx("div",{className:"text-cyan-dim font-mono text-xs mb-2",children:"MANUAL LEAD ENTRY"}),ae.jsxs("div",{className:"flex flex-col gap-3",children:[ae.jsx("input",{type:"text",value:a.name,onChange:p=>u({...a,name:p.target.value}),className:"bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Business Name"}),ae.jsx("input",{type:"text",value:a.location,onChange:p=>u({...a,location:p.target.value}),className:"bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Location"}),ae.jsx("button",{onClick:h,className:"bg-cyan text-black font-bold py-2 rounded hover:bg-cyan/80",children:"ADD TARGET"})]})]}),ae.jsx("div",{className:"space-y-3",children:n.map(p=>ae.jsxs("div",{className:`border p-4 rounded flex justify-between items-center ${d(p.status)} bg-black`,children:[ae.jsxs("div",{children:[ae.jsx("div",{className:"font-bold font-orbitron",children:p.name}),ae.jsxs("div",{className:"text-xs opacity-70",children:[p.location," | ",p.dateAdded]})]}),ae.jsxs("div",{className:"flex flex-col items-end gap-2",children:[ae.jsxs("select",{value:p.status,onChange:m=>t(p.id,m.target.value),className:"bg-black border border-white/20 text-xs p-1 outline-none rounded text-white",children:[ae.jsx("option",{children:"Potential"}),ae.jsx("option",{children:"Contacted"}),ae.jsx("option",{children:"Meeting Set"}),ae.jsx("option",{children:"Contracted"}),ae.jsx("option",{children:"Dead Lead"})]}),ae.jsx("button",{onClick:()=>r(p.id),className:"text-xs text-red-500 hover:text-red-300",children:"REMOVE"})]})]},p.id))})]})]})},jU=()=>{};var qS={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},UU=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[t++],s=n[t++],a=n[t++],u=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const o=n[t++],s=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},qT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const o=n[i],s=i+1<n.length,a=s?n[i+1]:0,u=i+2<n.length,l=u?n[i+2]:0,h=o>>2,d=(o&3)<<4|a>>4;let p=(a&15)<<2|l>>6,m=l&63;u||(m=64,s||(p=64)),r.push(t[h],t[d],t[p],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(WT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):UU(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const o=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const l=i<n.length?t[n.charAt(i)]:64;++i;const d=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||a==null||l==null||d==null)throw new zU;const p=o<<2|a>>4;if(r.push(p),l!==64){const m=a<<4&240|l>>2;if(r.push(m),d!==64){const w=l<<6&192|d;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class zU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const WU=function(n){const e=WT(n);return qT.encodeByteArray(e,!0)},r0=function(n){return WU(n).replace(/\./g,"")},HT=function(n){try{return qT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qU(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HU=()=>qU().__FIREBASE_DEFAULTS__,GU=()=>{if(typeof process>"u"||typeof qS>"u")return;const n=qS.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},$U=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&HT(n[1]);return e&&JSON.parse(e)},W0=()=>{try{return jU()||HU()||GU()||$U()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},GT=n=>{var e,t;return(t=(e=W0())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},KU=n=>{const e=GT(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},$T=()=>{var n;return(n=W0())===null||n===void 0?void 0:n.config},KT=n=>{var e;return(e=W0())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function XT(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YU(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[r0(JSON.stringify(t)),r0(JSON.stringify(s)),""].join(".")}const em={};function JU(){const n={prod:[],emulator:[]};for(const e of Object.keys(em))em[e]?n.emulator.push(e):n.prod.push(e);return n}function QU(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let HS=!1;function YT(n,e){if(typeof window>"u"||typeof document>"u"||!op(window.location.host)||em[n]===e||em[n]||HS)return;em[n]=e;function t(p){return`__firebase__banner__${p}`}const r="__firebase__banner",o=JU().prod.length>0;function s(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function u(p,m){p.setAttribute("width","24"),p.setAttribute("id",m),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function l(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{HS=!0,s()},p}function h(p,m){p.setAttribute("id",m),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=QU(r),m=t("text"),w=document.getElementById(m)||document.createElement("span"),b=t("learnmore"),x=document.getElementById(b)||document.createElement("a"),E=t("preprendIcon"),A=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const N=p.element;a(N),h(x,b);const F=l();u(A,E),N.append(A,w,x,F),document.body.appendChild(N)}o?(w.innerText="Preview backend disconnected.",A.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(A.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Uo())}function ez(){var n;const e=(n=W0())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nz(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function rz(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function iz(){const n=Uo();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function oz(){return!ez()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sz(){try{return typeof indexedDB=="object"}catch{return!1}}function az(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uz="FirebaseError";class rc extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=uz,Object.setPrototypeOf(this,rc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wm.prototype.create)}}class Wm{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?lz(o,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new rc(i,a,r)}}function lz(n,e){return n.replace(cz,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const cz=/\{\$([^}]+)}/g;function hz(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function yf(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const o=n[i],s=e[i];if(GS(o)&&GS(s)){if(!yf(o,s))return!1}else if(o!==s)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function GS(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function jp(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Up(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function fz(n,e){const t=new dz(n,e);return t.subscribe.bind(t)}class dz{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");pz(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Gy),i.error===void 0&&(i.error=Gy),i.complete===void 0&&(i.complete=Gy);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function pz(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Gy(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(n){return n&&n._delegate?n._delegate:n}class wf{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mz{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new XU;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vz(e))try{this.getOrInitializeService({instanceIdentifier:nf})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=nf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=nf){return this.instances.has(e)}getOptions(e=nf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&s.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);const s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:gz(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=nf){return this.component?this.component.multipleInstances?e:nf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function gz(n){return n===nf?void 0:n}function vz(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new mz(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var An;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(An||(An={}));const wz={debug:An.DEBUG,verbose:An.VERBOSE,info:An.INFO,warn:An.WARN,error:An.ERROR,silent:An.SILENT},bz=An.INFO,xz={[An.DEBUG]:"log",[An.VERBOSE]:"log",[An.INFO]:"info",[An.WARN]:"warn",[An.ERROR]:"error"},_z=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=xz[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mx{constructor(e){this.name=e,this._logLevel=bz,this._logHandler=_z,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in An))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,An.DEBUG,...e),this._logHandler(this,An.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,An.VERBOSE,...e),this._logHandler(this,An.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,An.INFO,...e),this._logHandler(this,An.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,An.WARN,...e),this._logHandler(this,An.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,An.ERROR,...e),this._logHandler(this,An.ERROR,...e)}}const Ez=(n,e)=>e.some(t=>n instanceof t);let $S,KS;function Sz(){return $S||($S=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Az(){return KS||(KS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const JT=new WeakMap,nw=new WeakMap,QT=new WeakMap,$y=new WeakMap,gx=new WeakMap;function Cz(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(ih(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&JT.set(t,n)}).catch(()=>{}),gx.set(e,n),e}function Iz(n){if(nw.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});nw.set(n,e)}let rw={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return nw.get(n);if(e==="objectStoreNames")return n.objectStoreNames||QT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ih(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Tz(n){rw=n(rw)}function kz(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Ky(this),e,...t);return QT.set(r,e.sort?e.sort():[e]),ih(r)}:Az().includes(n)?function(...e){return n.apply(Ky(this),e),ih(JT.get(this))}:function(...e){return ih(n.apply(Ky(this),e))}}function Nz(n){return typeof n=="function"?kz(n):(n instanceof IDBTransaction&&Iz(n),Ez(n,Sz())?new Proxy(n,rw):n)}function ih(n){if(n instanceof IDBRequest)return Cz(n);if($y.has(n))return $y.get(n);const e=Nz(n);return e!==n&&($y.set(n,e),gx.set(e,n)),e}const Ky=n=>gx.get(n);function Pz(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(n,e),a=ih(s);return r&&s.addEventListener("upgradeneeded",u=>{r(ih(s.result),u.oldVersion,u.newVersion,ih(s.transaction),u)}),t&&s.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const Rz=["get","getKey","getAll","getAllKeys","count"],Dz=["put","add","delete","clear"],Xy=new Map;function XS(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Xy.get(e))return Xy.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Dz.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Rz.includes(t)))return;const o=async function(s,...a){const u=this.transaction(s,i?"readwrite":"readonly");let l=u.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[t](...a),i&&u.done]))[0]};return Xy.set(e,o),o}Tz(n=>({...n,get:(e,t,r)=>XS(e,t)||n.get(e,t,r),has:(e,t)=>!!XS(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Mz(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Mz(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const iw="@firebase/app",YS="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kl=new mx("@firebase/app"),Fz="@firebase/app-compat",Oz="@firebase/analytics-compat",Bz="@firebase/analytics",Vz="@firebase/app-check-compat",jz="@firebase/app-check",Uz="@firebase/auth",zz="@firebase/auth-compat",Wz="@firebase/database",qz="@firebase/data-connect",Hz="@firebase/database-compat",Gz="@firebase/functions",$z="@firebase/functions-compat",Kz="@firebase/installations",Xz="@firebase/installations-compat",Yz="@firebase/messaging",Jz="@firebase/messaging-compat",Qz="@firebase/performance",Zz="@firebase/performance-compat",eW="@firebase/remote-config",tW="@firebase/remote-config-compat",nW="@firebase/storage",rW="@firebase/storage-compat",iW="@firebase/firestore",oW="@firebase/ai",sW="@firebase/firestore-compat",aW="firebase",uW="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow="[DEFAULT]",lW={[iw]:"fire-core",[Fz]:"fire-core-compat",[Bz]:"fire-analytics",[Oz]:"fire-analytics-compat",[jz]:"fire-app-check",[Vz]:"fire-app-check-compat",[Uz]:"fire-auth",[zz]:"fire-auth-compat",[Wz]:"fire-rtdb",[qz]:"fire-data-connect",[Hz]:"fire-rtdb-compat",[Gz]:"fire-fn",[$z]:"fire-fn-compat",[Kz]:"fire-iid",[Xz]:"fire-iid-compat",[Yz]:"fire-fcm",[Jz]:"fire-fcm-compat",[Qz]:"fire-perf",[Zz]:"fire-perf-compat",[eW]:"fire-rc",[tW]:"fire-rc-compat",[nW]:"fire-gcs",[rW]:"fire-gcs-compat",[iW]:"fire-fst",[sW]:"fire-fst-compat",[oW]:"fire-vertex","fire-js":"fire-js",[aW]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0=new Map,cW=new Map,sw=new Map;function JS(n,e){try{n.container.addComponent(e)}catch(t){Kl.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function $d(n){const e=n.name;if(sw.has(e))return Kl.debug(`There were multiple attempts to register component ${e}.`),!1;sw.set(e,n);for(const t of i0.values())JS(t,n);for(const t of cW.values())JS(t,n);return!0}function vx(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function fu(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hW={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},oh=new Wm("app","Firebase",hW);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fW{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new wf("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oh.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp=uW;function ZT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ow,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw oh.create("bad-app-name",{appName:String(i)});if(t||(t=$T()),!t)throw oh.create("no-options");const o=i0.get(i);if(o){if(yf(t,o.options)&&yf(r,o.config))return o;throw oh.create("duplicate-app",{appName:i})}const s=new yz(i);for(const u of sw.values())s.addComponent(u);const a=new fW(t,r,s);return i0.set(i,a),a}function ek(n=ow){const e=i0.get(n);if(!e&&n===ow&&$T())return ZT();if(!e)throw oh.create("no-app",{appName:n});return e}function sh(n,e,t){var r;let i=(r=lW[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const a=[`Unable to register library "${i}" with version "${e}":`];o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Kl.warn(a.join(" "));return}$d(new wf(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dW="firebase-heartbeat-database",pW=1,xm="firebase-heartbeat-store";let Yy=null;function tk(){return Yy||(Yy=Pz(dW,pW,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(xm)}catch(t){console.warn(t)}}}}).catch(n=>{throw oh.create("idb-open",{originalErrorMessage:n.message})})),Yy}async function mW(n){try{const t=(await tk()).transaction(xm),r=await t.objectStore(xm).get(nk(n));return await t.done,r}catch(e){if(e instanceof rc)Kl.warn(e.message);else{const t=oh.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Kl.warn(t.message)}}}async function QS(n,e){try{const r=(await tk()).transaction(xm,"readwrite");await r.objectStore(xm).put(e,nk(n)),await r.done}catch(t){if(t instanceof rc)Kl.warn(t.message);else{const r=oh.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Kl.warn(r.message)}}}function nk(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gW=1024,vW=30;class yW{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new bW(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=ZS();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>vW){const s=xW(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Kl.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ZS(),{heartbeatsToSend:r,unsentEntries:i}=wW(this._heartbeatsCache.heartbeats),o=r0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Kl.warn(t),""}}}function ZS(){return new Date().toISOString().substring(0,10)}function wW(n,e=gW){const t=[];let r=n.slice();for(const i of n){const o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),eA(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),eA(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class bW{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sz()?az().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await mW(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return QS(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return QS(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function eA(n){return r0(JSON.stringify({version:2,heartbeats:n})).length}function xW(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _W(n){$d(new wf("platform-logger",e=>new Lz(e),"PRIVATE")),$d(new wf("heartbeat",e=>new yW(e),"PRIVATE")),sh(iw,YS,n),sh(iw,YS,"esm2017"),sh("fire-js","")}_W("");var EW="firebase",SW="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sh(EW,SW,"app");function yx(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function rk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const AW=rk,ik=new Wm("auth","Firebase",rk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0=new mx("@firebase/auth");function CW(n,...e){o0.logLevel<=An.WARN&&o0.warn(`Auth (${sp}): ${n}`,...e)}function gv(n,...e){o0.logLevel<=An.ERROR&&o0.error(`Auth (${sp}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(n,...e){throw wx(n,...e)}function ol(n,...e){return wx(n,...e)}function ok(n,e,t){const r=Object.assign(Object.assign({},AW()),{[e]:t});return new Wm("auth","Firebase",r).create(e,{appName:n.name})}function ah(n){return ok(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wx(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return ik.create(n,...e)}function Qt(n,e,...t){if(!n)throw wx(e,...t)}function Wl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw gv(e),new Error(e)}function Xl(n,e){n||Wl(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function IW(){return tA()==="http:"||tA()==="https:"}function tA(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TW(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(IW()||nz()||"connection"in navigator)?navigator.onLine:!0}function kW(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xl(t>e,"Short delay should be less than long delay!"),this.isMobile=ZU()||rz()}get(){return TW()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bx(n,e){Xl(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NW={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PW=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],RW=new Hm(3e4,6e4);function kf(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function kh(n,e,t,r,i={}){return ak(n,i,async()=>{let o={},s={};r&&(e==="GET"?s=r:o={body:JSON.stringify(r)});const a=qm(Object.assign({key:n.config.apiKey},s)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const l=Object.assign({method:e,headers:u},o);return tz()||(l.referrerPolicy="no-referrer"),n.emulatorConfig&&op(n.emulatorConfig.host)&&(l.credentials="include"),sk.fetch()(await uk(n,n.config.apiHost,t,a),l)})}async function ak(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},NW),e);try{const i=new LW(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw nv(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[u,l]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw nv(n,"credential-already-in-use",s);if(u==="EMAIL_EXISTS")throw nv(n,"email-already-in-use",s);if(u==="USER_DISABLED")throw nv(n,"user-disabled",s);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw ok(n,h,l);gu(n,h)}}catch(i){if(i instanceof rc)throw i;gu(n,"network-request-failed",{message:String(i)})}}async function q0(n,e,t,r,i={}){const o=await kh(n,e,t,r,i);return"mfaPendingCredential"in o&&gu(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function uk(n,e,t,r){const i=`${e}${t}?${r}`,o=n,s=o.config.emulator?bx(n.config,i):`${n.config.apiScheme}://${i}`;return PW.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}function DW(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class LW{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ol(this.auth,"network-request-failed")),RW.get())})}}function nv(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=ol(n,e,r);return i.customData._tokenResponse=t,i}function nA(n){return n!==void 0&&n.enterprise!==void 0}class MW{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return DW(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function FW(n,e){return kh(n,"GET","/v2/recaptchaConfig",kf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OW(n,e){return kh(n,"POST","/v1/accounts:delete",e)}async function s0(n,e){return kh(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function BW(n,e=!1){const t=Eu(n),r=await t.getIdToken(e),i=xx(r);Qt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:tm(Jy(i.auth_time)),issuedAtTime:tm(Jy(i.iat)),expirationTime:tm(Jy(i.exp)),signInProvider:s||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Jy(n){return Number(n)*1e3}function xx(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return gv("JWT malformed, contained fewer than 3 sections"),null;try{const i=HT(t);return i?JSON.parse(i):(gv("Failed to decode base64 JWT payload"),null)}catch(i){return gv("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function rA(n){const e=xx(n);return Qt(e,"internal-error"),Qt(typeof e.exp<"u","internal-error"),Qt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _m(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof rc&&VW(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function VW({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jW{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=tm(this.lastLoginAt),this.creationTime=tm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a0(n){var e;const t=n.auth,r=await n.getIdToken(),i=await _m(n,s0(t,{idToken:r}));Qt(i==null?void 0:i.users.length,t,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const s=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?lk(o.providerUserInfo):[],a=zW(n.providerData,s),u=n.isAnonymous,l=!(n.email&&o.passwordHash)&&!(a!=null&&a.length),h=u?l:!1,d={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new uw(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function UW(n){const e=Eu(n);await a0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function zW(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function lk(n){return n.map(e=>{var{providerId:t}=e,r=yx(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WW(n,e){const t=await ak(n,{},async()=>{const r=qm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=await uk(n,i,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:a,body:r};return n.emulatorConfig&&op(n.emulatorConfig.host)&&(u.credentials="include"),sk.fetch()(s,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function qW(n,e){return kh(n,"POST","/v2/accounts:revokeToken",kf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Qt(e.idToken,"internal-error"),Qt(typeof e.idToken<"u","internal-error"),Qt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Qt(e.length!==0,"internal-error");const t=rA(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Qt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:o}=await WW(e,t);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:o}=t,s=new Rd;return r&&(Qt(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(Qt(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(Qt(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rd,this.toJSON())}_performRefresh(){return Wl("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(n,e){Qt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class pu{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=yx(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new jW(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new uw(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await _m(this,this.stsTokenManager.getToken(this.auth,e));return Qt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return BW(this,e)}reload(){return UW(this)}_assign(e){this!==e&&(Qt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new pu(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Qt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await a0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fu(this.auth.app))return Promise.reject(ah(this.auth));const e=await this.getIdToken();return await _m(this,OW(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,s,a,u,l,h;const d=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,m=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,w=(s=t.photoURL)!==null&&s!==void 0?s:void 0,b=(a=t.tenantId)!==null&&a!==void 0?a:void 0,x=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,E=(l=t.createdAt)!==null&&l!==void 0?l:void 0,A=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:N,emailVerified:F,isAnonymous:D,providerData:W,stsTokenManager:k}=t;Qt(N&&k,e,"internal-error");const C=Rd.fromJSON(this.name,k);Qt(typeof N=="string",e,"internal-error"),qc(d,e.name),qc(p,e.name),Qt(typeof F=="boolean",e,"internal-error"),Qt(typeof D=="boolean",e,"internal-error"),qc(m,e.name),qc(w,e.name),qc(b,e.name),qc(x,e.name),qc(E,e.name),qc(A,e.name);const L=new pu({uid:N,auth:e,email:p,emailVerified:F,displayName:d,isAnonymous:D,photoURL:w,phoneNumber:m,tenantId:b,stsTokenManager:C,createdAt:E,lastLoginAt:A});return W&&Array.isArray(W)&&(L.providerData=W.map(B=>Object.assign({},B))),x&&(L._redirectEventId=x),L}static async _fromIdTokenResponse(e,t,r=!1){const i=new Rd;i.updateFromServerResponse(t);const o=new pu({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await a0(o),o}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Qt(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?lk(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),a=new Rd;a.updateFromIdToken(r);const u=new pu({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new uw(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(u,l),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA=new Map;function ql(n){Xl(n instanceof Function,"Expected a class definition");let e=iA.get(n);return e?(Xl(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,iA.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ck.type="NONE";const oA=ck;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vv(n,e,t){return`firebase:${n}:${e}:${t}`}class Dd{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=vv(this.userKey,i.apiKey,o),this.fullPersistenceKey=vv("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await s0(this.auth,{idToken:e}).catch(()=>{});return t?pu._fromGetAccountInfoResponse(this.auth,t,e):null}return pu._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Dd(ql(oA),e,r);const i=(await Promise.all(t.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let o=i[0]||ql(oA);const s=vv(r,e.config.apiKey,e.name);let a=null;for(const l of t)try{const h=await l._get(s);if(h){let d;if(typeof h=="string"){const p=await s0(e,{idToken:h}).catch(()=>{});if(!p)break;d=await pu._fromGetAccountInfoResponse(e,p,h)}else d=pu._fromJSON(e,h);l!==o&&(a=d),o=l;break}}catch{}const u=i.filter(l=>l._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new Dd(o,e,r):(o=u[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async l=>{if(l!==o)try{await l._remove(s)}catch{}})),new Dd(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(pk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gk(e))return"Blackberry";if(vk(e))return"Webos";if(fk(e))return"Safari";if((e.includes("chrome/")||dk(e))&&!e.includes("edge/"))return"Chrome";if(mk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function hk(n=Uo()){return/firefox\//i.test(n)}function fk(n=Uo()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dk(n=Uo()){return/crios\//i.test(n)}function pk(n=Uo()){return/iemobile/i.test(n)}function mk(n=Uo()){return/android/i.test(n)}function gk(n=Uo()){return/blackberry/i.test(n)}function vk(n=Uo()){return/webos/i.test(n)}function _x(n=Uo()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function HW(n=Uo()){var e;return _x(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function GW(){return iz()&&document.documentMode===10}function yk(n=Uo()){return _x(n)||mk(n)||vk(n)||gk(n)||/windows phone/i.test(n)||pk(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(n,e=[]){let t;switch(n){case"Browser":t=sA(Uo());break;case"Worker":t=`${sA(Uo())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${sp}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $W{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=o=>new Promise((s,a)=>{try{const u=e(o);s(u)}catch(u){a(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KW(n,e={}){return kh(n,"GET","/v2/passwordPolicy",kf(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XW=6;class YW{constructor(e){var t,r,i,o;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=s.minPasswordLength)!==null&&t!==void 0?t:XW,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,s,a;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsUppercaseLetter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(s=u.containsNumericCharacter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(a=u.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),u}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JW{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aA(this),this.idTokenSubscription=new aA(this),this.beforeStateQueue=new $W(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ik,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ql(t)),this._initializationPromise=this.queue(async()=>{var r,i,o;if(!this._deleted&&(this.persistenceManager=await Dd.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await s0(this,{idToken:e}),r=await pu._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(fu(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!s||s===a)&&(u!=null&&u.user)&&(i=u.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Qt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await a0(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kW()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fu(this.app))return Promise.reject(ah(this));const t=e?Eu(e):null;return t&&Qt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Qt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fu(this.app)?Promise.reject(ah(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fu(this.app)?Promise.reject(ah(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ql(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await KW(this),t=new YW(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Wm("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await qW(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ql(e)||this._popupRedirectResolver;Qt(t,this,"argument-error"),this.redirectPersistenceManager=await Dd.create(this,[ql(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Qt(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{s=!0,u()}}else{const u=e.addObserver(t);return()=>{s=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Qt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(fu(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&CW(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function ap(n){return Eu(n)}class aA{constructor(e){this.auth=e,this.observer=null,this.addObserver=fz(t=>this.observer=t)}get next(){return Qt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let H0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function QW(n){H0=n}function bk(n){return H0.loadJS(n)}function ZW(){return H0.recaptchaEnterpriseScript}function eq(){return H0.gapiScript}function tq(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class nq{constructor(){this.enterprise=new rq}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class rq{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const iq="recaptcha-enterprise",xk="NO_RECAPTCHA";class oq{constructor(e){this.type=iq,this.auth=ap(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(s,a)=>{FW(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const l=new MW(u);return o.tenantId==null?o._agentRecaptchaConfig=l:o._tenantRecaptchaConfigs[o.tenantId]=l,s(l.siteKey)}}).catch(u=>{a(u)})})}function i(o,s,a){const u=window.grecaptcha;nA(u)?u.enterprise.ready(()=>{u.enterprise.execute(o,{action:e}).then(l=>{s(l)}).catch(()=>{s(xk)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new nq().execute("siteKey",{action:"verify"}):new Promise((o,s)=>{r(this.auth).then(a=>{if(!t&&nA(window.grecaptcha))i(a,o,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let u=ZW();u.length!==0&&(u+=a),bk(u).then(()=>{i(a,o,s)}).catch(l=>{s(l)})}}).catch(a=>{s(a)})})}}async function uA(n,e,t,r=!1,i=!1){const o=new oq(n);let s;if(i)s=xk;else try{s=await o.verify(t)}catch{s=await o.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const u=a.phoneEnrollmentInfo.phoneNumber,l=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:l,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const u=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function lA(n,e,t,r,i){var o;if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await uA(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await uA(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sq(n,e){const t=vx(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),o=t.getOptions();if(yf(o,e??{}))return i;gu(i,"already-initialized")}return t.initialize({options:e})}function aq(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ql);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function uq(n,e,t){const r=ap(n);Qt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,o=_k(e),{host:s,port:a}=lq(e),u=a===null?"":`:${a}`,l={url:`${o}//${s}${u}/`},h=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Qt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Qt(yf(l,r.config.emulator)&&yf(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=l,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,op(s)?(XT(`${o}//${s}${u}`),YT("Auth",!0)):cq()}function _k(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function lq(n){const e=_k(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:cA(r.substr(o.length+1))}}else{const[o,s]=r.split(":");return{host:o,port:cA(s)}}}function cA(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function cq(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wl("not implemented")}_getIdTokenResponse(e){return Wl("not implemented")}_linkToIdToken(e,t){return Wl("not implemented")}_getReauthenticationResolver(e){return Wl("not implemented")}}async function hq(n,e){return kh(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fq(n,e){return q0(n,"POST","/v1/accounts:signInWithPassword",kf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dq(n,e){return q0(n,"POST","/v1/accounts:signInWithEmailLink",kf(n,e))}async function pq(n,e){return q0(n,"POST","/v1/accounts:signInWithEmailLink",kf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em extends Ex{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Em(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Em(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return lA(e,t,"signInWithPassword",fq);case"emailLink":return dq(e,{email:this._email,oobCode:this._password});default:gu(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return lA(e,r,"signUpPassword",hq);case"emailLink":return pq(e,{idToken:t,email:this._email,oobCode:this._password});default:gu(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ld(n,e){return q0(n,"POST","/v1/accounts:signInWithIdp",kf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mq="http://localhost";class bf extends Ex{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new bf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):gu("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,o=yx(t,["providerId","signInMethod"]);if(!r||!i)return null;const s=new bf(r,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const t=this.buildRequest();return Ld(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ld(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ld(e,t)}buildRequest(){const e={requestUri:mq,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=qm(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gq(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function vq(n){const e=jp(Up(n)).link,t=e?jp(Up(e)).deep_link_id:null,r=jp(Up(n)).deep_link_id;return(r?jp(Up(r)).link:null)||r||t||e||n}class Sx{constructor(e){var t,r,i,o,s,a;const u=jp(Up(e)),l=(t=u.apiKey)!==null&&t!==void 0?t:null,h=(r=u.oobCode)!==null&&r!==void 0?r:null,d=gq((i=u.mode)!==null&&i!==void 0?i:null);Qt(l&&h&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=h,this.continueUrl=(o=u.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(s=u.lang)!==null&&s!==void 0?s:null,this.tenantId=(a=u.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=vq(e);try{return new Sx(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(){this.providerId=up.PROVIDER_ID}static credential(e,t){return Em._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Sx.parseLink(t);return Qt(r,"argument-error"),Em._fromEmailAndCode(e,r.code,r.tenantId)}}up.PROVIDER_ID="password";up.EMAIL_PASSWORD_SIGN_IN_METHOD="password";up.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm extends Ek{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc extends Gm{constructor(){super("facebook.com")}static credential(e){return bf._fromParams({providerId:Gc.PROVIDER_ID,signInMethod:Gc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gc.credentialFromTaggedObject(e)}static credentialFromError(e){return Gc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gc.credential(e.oauthAccessToken)}catch{return null}}}Gc.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gc.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c extends Gm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return bf._fromParams({providerId:$c.PROVIDER_ID,signInMethod:$c.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return $c.credentialFromTaggedObject(e)}static credentialFromError(e){return $c.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return $c.credential(t,r)}catch{return null}}}$c.GOOGLE_SIGN_IN_METHOD="google.com";$c.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc extends Gm{constructor(){super("github.com")}static credential(e){return bf._fromParams({providerId:Kc.PROVIDER_ID,signInMethod:Kc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kc.credentialFromTaggedObject(e)}static credentialFromError(e){return Kc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Kc.credential(e.oauthAccessToken)}catch{return null}}}Kc.GITHUB_SIGN_IN_METHOD="github.com";Kc.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc extends Gm{constructor(){super("twitter.com")}static credential(e,t){return bf._fromParams({providerId:Xc.PROVIDER_ID,signInMethod:Xc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xc.credentialFromTaggedObject(e)}static credentialFromError(e){return Xc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Xc.credential(t,r)}catch{return null}}}Xc.TWITTER_SIGN_IN_METHOD="twitter.com";Xc.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const o=await pu._fromIdTokenResponse(e,r,i),s=hA(r);return new Kd({user:o,providerId:s,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=hA(r);return new Kd({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function hA(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0 extends rc{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,u0.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new u0(e,t,r,i)}}function Sk(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?u0._fromErrorAndOperation(n,o,e,r):o})}async function yq(n,e,t=!1){const r=await _m(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Kd._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wq(n,e,t=!1){const{auth:r}=n;if(fu(r.app))return Promise.reject(ah(r));const i="reauthenticate";try{const o=await _m(n,Sk(r,i,e,n),t);Qt(o.idToken,r,"internal-error");const s=xx(o.idToken);Qt(s,r,"internal-error");const{sub:a}=s;return Qt(n.uid===a,r,"user-mismatch"),Kd._forOperation(n,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&gu(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ak(n,e,t=!1){if(fu(n.app))return Promise.reject(ah(n));const r="signIn",i=await Sk(n,r,e),o=await Kd._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(o.user),o}async function bq(n,e){return Ak(ap(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xq(n){const e=ap(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function _q(n,e,t){return fu(n.app)?Promise.reject(ah(n)):bq(Eu(n),up.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&xq(n),r})}function Eq(n,e,t,r){return Eu(n).onIdTokenChanged(e,t,r)}function Sq(n,e,t){return Eu(n).beforeAuthStateChanged(e,t)}function Aq(n,e,t,r){return Eu(n).onAuthStateChanged(e,t,r)}function Cq(n){return Eu(n).signOut()}const l0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(l0,"1"),this.storage.removeItem(l0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iq=1e3,Tq=10;class Ik extends Ck{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((s,a,u)=>{this.notifyListeners(s,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(r);!t&&this.localCache[r]===s||this.notifyListeners(r,s)},o=this.storage.getItem(r);GW()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Tq):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Iq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ik.type="LOCAL";const kq=Ik;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk extends Ck{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Tk.type="SESSION";const kk=Tk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nq(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new G0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:o}=t.data,s=this.handlersMap[i];if(!(s!=null&&s.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(s).map(async l=>l(t.origin,o)),u=await Nq(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}G0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ax(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pq{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,u)=>{const l=Ax("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(d){const p=d;if(p.data.eventId===l)switch(p.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(p.data.response);break;default:clearTimeout(h),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(){return window}function Rq(n){sl().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(){return typeof sl().WorkerGlobalScope<"u"&&typeof sl().importScripts=="function"}async function Dq(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Lq(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Mq(){return Nk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk="firebaseLocalStorageDb",Fq=1,c0="firebaseLocalStorage",Rk="fbase_key";class $m{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function $0(n,e){return n.transaction([c0],e?"readwrite":"readonly").objectStore(c0)}function Oq(){const n=indexedDB.deleteDatabase(Pk);return new $m(n).toPromise()}function lw(){const n=indexedDB.open(Pk,Fq);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(c0,{keyPath:Rk})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(c0)?e(r):(r.close(),await Oq(),e(await lw()))})})}async function fA(n,e,t){const r=$0(n,!0).put({[Rk]:e,value:t});return new $m(r).toPromise()}async function Bq(n,e){const t=$0(n,!1).get(e),r=await new $m(t).toPromise();return r===void 0?null:r.value}function dA(n,e){const t=$0(n,!0).delete(e);return new $m(t).toPromise()}const Vq=800,jq=3;class Dk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await lw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>jq)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Nk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=G0._getInstance(Mq()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Dq(),!this.activeServiceWorker)return;this.sender=new Pq(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Lq()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await lw();return await fA(e,l0,"1"),await dA(e,l0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>fA(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Bq(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>dA(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=$0(i,!1).getAll();return new $m(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Vq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Dk.type="LOCAL";const Uq=Dk;new Hm(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zq(n,e){return e?ql(e):(Qt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx extends Ex{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ld(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ld(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ld(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Wq(n){return Ak(n.auth,new Cx(n),n.bypassAuthState)}function qq(n){const{auth:e,user:t}=n;return Qt(t,e,"internal-error"),wq(t,new Cx(n),n.bypassAuthState)}async function Hq(n){const{auth:e,user:t}=n;return Qt(t,e,"internal-error"),yq(t,new Cx(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Wq;case"linkViaPopup":case"linkViaRedirect":return Hq;case"reauthViaPopup":case"reauthViaRedirect":return qq;default:gu(this.auth,"internal-error")}}resolve(e){Xl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gq=new Hm(2e3,1e4);class bd extends Lk{constructor(e,t,r,i,o){super(e,t,i,o),this.provider=r,this.authWindow=null,this.pollId=null,bd.currentPopupAction&&bd.currentPopupAction.cancel(),bd.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Qt(e,this.auth,"internal-error"),e}async onExecution(){Xl(this.filter.length===1,"Popup operations only handle one event");const e=Ax();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ol(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ol(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,bd.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ol(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Gq.get())};e()}}bd.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $q="pendingRedirect",yv=new Map;class Kq extends Lk{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=yv.get(this.auth._key());if(!e){try{const r=await Xq(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}yv.set(this.auth._key(),e)}return this.bypassAuthState||yv.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Xq(n,e){const t=Qq(e),r=Jq(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function Yq(n,e){yv.set(n._key(),e)}function Jq(n){return ql(n._redirectPersistence)}function Qq(n){return vv($q,n.config.apiKey,n.name)}async function Zq(n,e,t=!1){if(fu(n.app))return Promise.reject(ah(n));const r=ap(n),i=zq(r,e),s=await new Kq(r,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eH=600*1e3;class tH{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nH(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Mk(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(ol(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=eH&&this.cachedEventUids.clear(),this.cachedEventUids.has(pA(e))}saveEventToCache(e){this.cachedEventUids.add(pA(e)),this.lastProcessedEventTime=Date.now()}}function pA(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Mk({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function nH(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Mk(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rH(n,e={}){return kh(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iH=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oH=/^https?/;async function sH(n){if(n.config.emulator)return;const{authorizedDomains:e}=await rH(n);for(const t of e)try{if(aH(t))return}catch{}gu(n,"unauthorized-domain")}function aH(n){const e=aw(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!oH.test(t))return!1;if(iH.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uH=new Hm(3e4,6e4);function mA(){const n=sl().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function lH(n){return new Promise((e,t)=>{var r,i,o;function s(){mA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mA(),t(ol(n,"network-request-failed"))},timeout:uH.get()})}if(!((i=(r=sl().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=sl().gapi)===null||o===void 0)&&o.load)s();else{const a=tq("iframefcb");return sl()[a]=()=>{gapi.load?s():t(ol(n,"network-request-failed"))},bk(`${eq()}?onload=${a}`).catch(u=>t(u))}}).catch(e=>{throw wv=null,e})}let wv=null;function cH(n){return wv=wv||lH(n),wv}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hH=new Hm(5e3,15e3),fH="__/auth/iframe",dH="emulator/auth/iframe",pH={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mH=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gH(n){const e=n.config;Qt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?bx(e,dH):`https://${n.config.authDomain}/${fH}`,r={apiKey:e.apiKey,appName:n.name,v:sp},i=mH.get(n.config.apiHost);i&&(r.eid=i);const o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${qm(r).slice(1)}`}async function vH(n){const e=await cH(n),t=sl().gapi;return Qt(t,n,"internal-error"),e.open({where:document.body,url:gH(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pH,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const s=ol(n,"network-request-failed"),a=sl().setTimeout(()=>{o(s)},hH.get());function u(){sl().clearTimeout(a),i(r)}r.ping(u).then(u,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yH={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wH=500,bH=600,xH="_blank",_H="http://localhost";class gA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function EH(n,e,t,r=wH,i=bH){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u=Object.assign(Object.assign({},yH),{width:r.toString(),height:i.toString(),top:o,left:s}),l=Uo().toLowerCase();t&&(a=dk(l)?xH:t),hk(l)&&(e=e||_H,u.scrollbars="yes");const h=Object.entries(u).reduce((p,[m,w])=>`${p}${m}=${w},`,"");if(HW(l)&&a!=="_self")return SH(e||"",a),new gA(null);const d=window.open(e||"",a,h);Qt(d,n,"popup-blocked");try{d.focus()}catch{}return new gA(d)}function SH(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AH="__/auth/handler",CH="emulator/auth/handler",IH=encodeURIComponent("fac");async function vA(n,e,t,r,i,o){Qt(n.config.authDomain,n,"auth-domain-config-required"),Qt(n.config.apiKey,n,"invalid-api-key");const s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:sp,eventId:i};if(e instanceof Ek){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",hz(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries({}))s[h]=d}if(e instanceof Gm){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(s.scopes=h.join(","))}n.tenantId&&(s.tid=n.tenantId);const a=s;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const u=await n._getAppCheckToken(),l=u?`#${IH}=${encodeURIComponent(u)}`:"";return`${TH(n)}?${qm(a).slice(1)}${l}`}function TH({config:n}){return n.emulator?bx(n,CH):`https://${n.authDomain}/${AH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qy="webStorageSupport";class kH{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kk,this._completeRedirectFn=Zq,this._overrideRedirectResult=Yq}async _openPopup(e,t,r,i){var o;Xl((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await vA(e,t,r,aw(),i);return EH(e,s,Ax())}async _openRedirect(e,t,r,i){await this._originValidation(e);const o=await vA(e,t,r,aw(),i);return Rq(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Xl(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await vH(e),r=new tH(e);return t.register("authEvent",i=>(Qt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qy,{type:Qy},i=>{var o;const s=(o=i==null?void 0:i[0])===null||o===void 0?void 0:o[Qy];s!==void 0&&t(!!s),gu(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=sH(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return yk()||fk()||_x()}}const NH=kH;var yA="@firebase/auth",wA="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PH{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Qt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RH(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function DH(n){$d(new wf("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;Qt(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wk(n)},l=new JW(r,i,o,u);return aq(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),$d(new wf("auth-internal",e=>{const t=ap(e.getProvider("auth").getImmediate());return(r=>new PH(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),sh(yA,wA,RH(n)),sh(yA,wA,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LH=300,MH=KT("authIdTokenMaxAge")||LH;let bA=null;const FH=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>MH)return;const i=t==null?void 0:t.token;bA!==i&&(bA=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function OH(n=ek()){const e=vx(n,"auth");if(e.isInitialized())return e.getImmediate();const t=sq(n,{popupRedirectResolver:NH,persistence:[Uq,kq,kk]}),r=KT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const s=FH(o.toString());Sq(t,s,()=>s(t.currentUser)),Eq(t,a=>s(a))}}const i=GT("auth");return i&&uq(t,`http://${i}`),t}function BH(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}QW({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const o=ol("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",BH().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});DH("Browser");var xA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uh,Fk;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,C){function L(){}L.prototype=C.prototype,k.D=C.prototype,k.prototype=new L,k.prototype.constructor=k,k.C=function(B,R,M){for(var U=Array(arguments.length-2),J=2;J<arguments.length;J++)U[J-2]=arguments[J];return C.prototype[R].apply(B,U)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,C,L){L||(L=0);var B=Array(16);if(typeof C=="string")for(var R=0;16>R;++R)B[R]=C.charCodeAt(L++)|C.charCodeAt(L++)<<8|C.charCodeAt(L++)<<16|C.charCodeAt(L++)<<24;else for(R=0;16>R;++R)B[R]=C[L++]|C[L++]<<8|C[L++]<<16|C[L++]<<24;C=k.g[0],L=k.g[1],R=k.g[2];var M=k.g[3],U=C+(M^L&(R^M))+B[0]+3614090360&4294967295;C=L+(U<<7&4294967295|U>>>25),U=M+(R^C&(L^R))+B[1]+3905402710&4294967295,M=C+(U<<12&4294967295|U>>>20),U=R+(L^M&(C^L))+B[2]+606105819&4294967295,R=M+(U<<17&4294967295|U>>>15),U=L+(C^R&(M^C))+B[3]+3250441966&4294967295,L=R+(U<<22&4294967295|U>>>10),U=C+(M^L&(R^M))+B[4]+4118548399&4294967295,C=L+(U<<7&4294967295|U>>>25),U=M+(R^C&(L^R))+B[5]+1200080426&4294967295,M=C+(U<<12&4294967295|U>>>20),U=R+(L^M&(C^L))+B[6]+2821735955&4294967295,R=M+(U<<17&4294967295|U>>>15),U=L+(C^R&(M^C))+B[7]+4249261313&4294967295,L=R+(U<<22&4294967295|U>>>10),U=C+(M^L&(R^M))+B[8]+1770035416&4294967295,C=L+(U<<7&4294967295|U>>>25),U=M+(R^C&(L^R))+B[9]+2336552879&4294967295,M=C+(U<<12&4294967295|U>>>20),U=R+(L^M&(C^L))+B[10]+4294925233&4294967295,R=M+(U<<17&4294967295|U>>>15),U=L+(C^R&(M^C))+B[11]+2304563134&4294967295,L=R+(U<<22&4294967295|U>>>10),U=C+(M^L&(R^M))+B[12]+1804603682&4294967295,C=L+(U<<7&4294967295|U>>>25),U=M+(R^C&(L^R))+B[13]+4254626195&4294967295,M=C+(U<<12&4294967295|U>>>20),U=R+(L^M&(C^L))+B[14]+2792965006&4294967295,R=M+(U<<17&4294967295|U>>>15),U=L+(C^R&(M^C))+B[15]+1236535329&4294967295,L=R+(U<<22&4294967295|U>>>10),U=C+(R^M&(L^R))+B[1]+4129170786&4294967295,C=L+(U<<5&4294967295|U>>>27),U=M+(L^R&(C^L))+B[6]+3225465664&4294967295,M=C+(U<<9&4294967295|U>>>23),U=R+(C^L&(M^C))+B[11]+643717713&4294967295,R=M+(U<<14&4294967295|U>>>18),U=L+(M^C&(R^M))+B[0]+3921069994&4294967295,L=R+(U<<20&4294967295|U>>>12),U=C+(R^M&(L^R))+B[5]+3593408605&4294967295,C=L+(U<<5&4294967295|U>>>27),U=M+(L^R&(C^L))+B[10]+38016083&4294967295,M=C+(U<<9&4294967295|U>>>23),U=R+(C^L&(M^C))+B[15]+3634488961&4294967295,R=M+(U<<14&4294967295|U>>>18),U=L+(M^C&(R^M))+B[4]+3889429448&4294967295,L=R+(U<<20&4294967295|U>>>12),U=C+(R^M&(L^R))+B[9]+568446438&4294967295,C=L+(U<<5&4294967295|U>>>27),U=M+(L^R&(C^L))+B[14]+3275163606&4294967295,M=C+(U<<9&4294967295|U>>>23),U=R+(C^L&(M^C))+B[3]+4107603335&4294967295,R=M+(U<<14&4294967295|U>>>18),U=L+(M^C&(R^M))+B[8]+1163531501&4294967295,L=R+(U<<20&4294967295|U>>>12),U=C+(R^M&(L^R))+B[13]+2850285829&4294967295,C=L+(U<<5&4294967295|U>>>27),U=M+(L^R&(C^L))+B[2]+4243563512&4294967295,M=C+(U<<9&4294967295|U>>>23),U=R+(C^L&(M^C))+B[7]+1735328473&4294967295,R=M+(U<<14&4294967295|U>>>18),U=L+(M^C&(R^M))+B[12]+2368359562&4294967295,L=R+(U<<20&4294967295|U>>>12),U=C+(L^R^M)+B[5]+4294588738&4294967295,C=L+(U<<4&4294967295|U>>>28),U=M+(C^L^R)+B[8]+2272392833&4294967295,M=C+(U<<11&4294967295|U>>>21),U=R+(M^C^L)+B[11]+1839030562&4294967295,R=M+(U<<16&4294967295|U>>>16),U=L+(R^M^C)+B[14]+4259657740&4294967295,L=R+(U<<23&4294967295|U>>>9),U=C+(L^R^M)+B[1]+2763975236&4294967295,C=L+(U<<4&4294967295|U>>>28),U=M+(C^L^R)+B[4]+1272893353&4294967295,M=C+(U<<11&4294967295|U>>>21),U=R+(M^C^L)+B[7]+4139469664&4294967295,R=M+(U<<16&4294967295|U>>>16),U=L+(R^M^C)+B[10]+3200236656&4294967295,L=R+(U<<23&4294967295|U>>>9),U=C+(L^R^M)+B[13]+681279174&4294967295,C=L+(U<<4&4294967295|U>>>28),U=M+(C^L^R)+B[0]+3936430074&4294967295,M=C+(U<<11&4294967295|U>>>21),U=R+(M^C^L)+B[3]+3572445317&4294967295,R=M+(U<<16&4294967295|U>>>16),U=L+(R^M^C)+B[6]+76029189&4294967295,L=R+(U<<23&4294967295|U>>>9),U=C+(L^R^M)+B[9]+3654602809&4294967295,C=L+(U<<4&4294967295|U>>>28),U=M+(C^L^R)+B[12]+3873151461&4294967295,M=C+(U<<11&4294967295|U>>>21),U=R+(M^C^L)+B[15]+530742520&4294967295,R=M+(U<<16&4294967295|U>>>16),U=L+(R^M^C)+B[2]+3299628645&4294967295,L=R+(U<<23&4294967295|U>>>9),U=C+(R^(L|~M))+B[0]+4096336452&4294967295,C=L+(U<<6&4294967295|U>>>26),U=M+(L^(C|~R))+B[7]+1126891415&4294967295,M=C+(U<<10&4294967295|U>>>22),U=R+(C^(M|~L))+B[14]+2878612391&4294967295,R=M+(U<<15&4294967295|U>>>17),U=L+(M^(R|~C))+B[5]+4237533241&4294967295,L=R+(U<<21&4294967295|U>>>11),U=C+(R^(L|~M))+B[12]+1700485571&4294967295,C=L+(U<<6&4294967295|U>>>26),U=M+(L^(C|~R))+B[3]+2399980690&4294967295,M=C+(U<<10&4294967295|U>>>22),U=R+(C^(M|~L))+B[10]+4293915773&4294967295,R=M+(U<<15&4294967295|U>>>17),U=L+(M^(R|~C))+B[1]+2240044497&4294967295,L=R+(U<<21&4294967295|U>>>11),U=C+(R^(L|~M))+B[8]+1873313359&4294967295,C=L+(U<<6&4294967295|U>>>26),U=M+(L^(C|~R))+B[15]+4264355552&4294967295,M=C+(U<<10&4294967295|U>>>22),U=R+(C^(M|~L))+B[6]+2734768916&4294967295,R=M+(U<<15&4294967295|U>>>17),U=L+(M^(R|~C))+B[13]+1309151649&4294967295,L=R+(U<<21&4294967295|U>>>11),U=C+(R^(L|~M))+B[4]+4149444226&4294967295,C=L+(U<<6&4294967295|U>>>26),U=M+(L^(C|~R))+B[11]+3174756917&4294967295,M=C+(U<<10&4294967295|U>>>22),U=R+(C^(M|~L))+B[2]+718787259&4294967295,R=M+(U<<15&4294967295|U>>>17),U=L+(M^(R|~C))+B[9]+3951481745&4294967295,k.g[0]=k.g[0]+C&4294967295,k.g[1]=k.g[1]+(R+(U<<21&4294967295|U>>>11))&4294967295,k.g[2]=k.g[2]+R&4294967295,k.g[3]=k.g[3]+M&4294967295}r.prototype.u=function(k,C){C===void 0&&(C=k.length);for(var L=C-this.blockSize,B=this.B,R=this.h,M=0;M<C;){if(R==0)for(;M<=L;)i(this,k,M),M+=this.blockSize;if(typeof k=="string"){for(;M<C;)if(B[R++]=k.charCodeAt(M++),R==this.blockSize){i(this,B),R=0;break}}else for(;M<C;)if(B[R++]=k[M++],R==this.blockSize){i(this,B),R=0;break}}this.h=R,this.o+=C},r.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var C=1;C<k.length-8;++C)k[C]=0;var L=8*this.o;for(C=k.length-8;C<k.length;++C)k[C]=L&255,L/=256;for(this.u(k),k=Array(16),C=L=0;4>C;++C)for(var B=0;32>B;B+=8)k[L++]=this.g[C]>>>B&255;return k};function o(k,C){var L=a;return Object.prototype.hasOwnProperty.call(L,k)?L[k]:L[k]=C(k)}function s(k,C){this.h=C;for(var L=[],B=!0,R=k.length-1;0<=R;R--){var M=k[R]|0;B&&M==C||(L[R]=M,B=!1)}this.g=L}var a={};function u(k){return-128<=k&&128>k?o(k,function(C){return new s([C|0],0>C?-1:0)}):new s([k|0],0>k?-1:0)}function l(k){if(isNaN(k)||!isFinite(k))return d;if(0>k)return x(l(-k));for(var C=[],L=1,B=0;k>=L;B++)C[B]=k/L|0,L*=4294967296;return new s(C,0)}function h(k,C){if(k.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(k.charAt(0)=="-")return x(h(k.substring(1),C));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var L=l(Math.pow(C,8)),B=d,R=0;R<k.length;R+=8){var M=Math.min(8,k.length-R),U=parseInt(k.substring(R,R+M),C);8>M?(M=l(Math.pow(C,M)),B=B.j(M).add(l(U))):(B=B.j(L),B=B.add(l(U)))}return B}var d=u(0),p=u(1),m=u(16777216);n=s.prototype,n.m=function(){if(b(this))return-x(this).m();for(var k=0,C=1,L=0;L<this.g.length;L++){var B=this.i(L);k+=(0<=B?B:4294967296+B)*C,C*=4294967296}return k},n.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(w(this))return"0";if(b(this))return"-"+x(this).toString(k);for(var C=l(Math.pow(k,6)),L=this,B="";;){var R=F(L,C).g;L=E(L,R.j(C));var M=((0<L.g.length?L.g[0]:L.h)>>>0).toString(k);if(L=R,w(L))return M+B;for(;6>M.length;)M="0"+M;B=M+B}},n.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function w(k){if(k.h!=0)return!1;for(var C=0;C<k.g.length;C++)if(k.g[C]!=0)return!1;return!0}function b(k){return k.h==-1}n.l=function(k){return k=E(this,k),b(k)?-1:w(k)?0:1};function x(k){for(var C=k.g.length,L=[],B=0;B<C;B++)L[B]=~k.g[B];return new s(L,~k.h).add(p)}n.abs=function(){return b(this)?x(this):this},n.add=function(k){for(var C=Math.max(this.g.length,k.g.length),L=[],B=0,R=0;R<=C;R++){var M=B+(this.i(R)&65535)+(k.i(R)&65535),U=(M>>>16)+(this.i(R)>>>16)+(k.i(R)>>>16);B=U>>>16,M&=65535,U&=65535,L[R]=U<<16|M}return new s(L,L[L.length-1]&-2147483648?-1:0)};function E(k,C){return k.add(x(C))}n.j=function(k){if(w(this)||w(k))return d;if(b(this))return b(k)?x(this).j(x(k)):x(x(this).j(k));if(b(k))return x(this.j(x(k)));if(0>this.l(m)&&0>k.l(m))return l(this.m()*k.m());for(var C=this.g.length+k.g.length,L=[],B=0;B<2*C;B++)L[B]=0;for(B=0;B<this.g.length;B++)for(var R=0;R<k.g.length;R++){var M=this.i(B)>>>16,U=this.i(B)&65535,J=k.i(R)>>>16,de=k.i(R)&65535;L[2*B+2*R]+=U*de,A(L,2*B+2*R),L[2*B+2*R+1]+=M*de,A(L,2*B+2*R+1),L[2*B+2*R+1]+=U*J,A(L,2*B+2*R+1),L[2*B+2*R+2]+=M*J,A(L,2*B+2*R+2)}for(B=0;B<C;B++)L[B]=L[2*B+1]<<16|L[2*B];for(B=C;B<2*C;B++)L[B]=0;return new s(L,0)};function A(k,C){for(;(k[C]&65535)!=k[C];)k[C+1]+=k[C]>>>16,k[C]&=65535,C++}function N(k,C){this.g=k,this.h=C}function F(k,C){if(w(C))throw Error("division by zero");if(w(k))return new N(d,d);if(b(k))return C=F(x(k),C),new N(x(C.g),x(C.h));if(b(C))return C=F(k,x(C)),new N(x(C.g),C.h);if(30<k.g.length){if(b(k)||b(C))throw Error("slowDivide_ only works with positive integers.");for(var L=p,B=C;0>=B.l(k);)L=D(L),B=D(B);var R=W(L,1),M=W(B,1);for(B=W(B,2),L=W(L,2);!w(B);){var U=M.add(B);0>=U.l(k)&&(R=R.add(L),M=U),B=W(B,1),L=W(L,1)}return C=E(k,R.j(C)),new N(R,C)}for(R=d;0<=k.l(C);){for(L=Math.max(1,Math.floor(k.m()/C.m())),B=Math.ceil(Math.log(L)/Math.LN2),B=48>=B?1:Math.pow(2,B-48),M=l(L),U=M.j(C);b(U)||0<U.l(k);)L-=B,M=l(L),U=M.j(C);w(M)&&(M=p),R=R.add(M),k=E(k,U)}return new N(R,k)}n.A=function(k){return F(this,k).h},n.and=function(k){for(var C=Math.max(this.g.length,k.g.length),L=[],B=0;B<C;B++)L[B]=this.i(B)&k.i(B);return new s(L,this.h&k.h)},n.or=function(k){for(var C=Math.max(this.g.length,k.g.length),L=[],B=0;B<C;B++)L[B]=this.i(B)|k.i(B);return new s(L,this.h|k.h)},n.xor=function(k){for(var C=Math.max(this.g.length,k.g.length),L=[],B=0;B<C;B++)L[B]=this.i(B)^k.i(B);return new s(L,this.h^k.h)};function D(k){for(var C=k.g.length+1,L=[],B=0;B<C;B++)L[B]=k.i(B)<<1|k.i(B-1)>>>31;return new s(L,k.h)}function W(k,C){var L=C>>5;C%=32;for(var B=k.g.length-L,R=[],M=0;M<B;M++)R[M]=0<C?k.i(M+L)>>>C|k.i(M+L+1)<<32-C:k.i(M+L);return new s(R,k.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Fk=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,uh=s}).apply(typeof xA<"u"?xA:typeof self<"u"?self:typeof window<"u"?window:{});var rv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ok,zp,Bk,bv,cw,Vk,jk,Uk;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,O,q){return y==Array.prototype||y==Object.prototype||(y[O]=q.value),y};function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof rv=="object"&&rv];for(var O=0;O<y.length;++O){var q=y[O];if(q&&q.Math==Math)return q}throw Error("Cannot find global object")}var r=t(this);function i(y,O){if(O)e:{var q=r;y=y.split(".");for(var ee=0;ee<y.length-1;ee++){var Ne=y[ee];if(!(Ne in q))break e;q=q[Ne]}y=y[y.length-1],ee=q[y],O=O(ee),O!=ee&&O!=null&&e(q,y,{configurable:!0,writable:!0,value:O})}}function o(y,O){y instanceof String&&(y+="");var q=0,ee=!1,Ne={next:function(){if(!ee&&q<y.length){var Fe=q++;return{value:O(Fe,y[Fe]),done:!1}}return ee=!0,{done:!0,value:void 0}}};return Ne[Symbol.iterator]=function(){return Ne},Ne}i("Array.prototype.values",function(y){return y||function(){return o(this,function(O,q){return q})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function u(y){var O=typeof y;return O=O!="object"?O:y?Array.isArray(y)?"array":O:"null",O=="array"||O=="object"&&typeof y.length=="number"}function l(y){var O=typeof y;return O=="object"&&y!=null||O=="function"}function h(y,O,q){return y.call.apply(y.bind,arguments)}function d(y,O,q){if(!y)throw Error();if(2<arguments.length){var ee=Array.prototype.slice.call(arguments,2);return function(){var Ne=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ne,ee),y.apply(O,Ne)}}return function(){return y.apply(O,arguments)}}function p(y,O,q){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function m(y,O){var q=Array.prototype.slice.call(arguments,1);return function(){var ee=q.slice();return ee.push.apply(ee,arguments),y.apply(this,ee)}}function w(y,O){function q(){}q.prototype=O.prototype,y.aa=O.prototype,y.prototype=new q,y.prototype.constructor=y,y.Qb=function(ee,Ne,Fe){for(var it=Array(arguments.length-2),on=2;on<arguments.length;on++)it[on-2]=arguments[on];return O.prototype[Ne].apply(ee,it)}}function b(y){const O=y.length;if(0<O){const q=Array(O);for(let ee=0;ee<O;ee++)q[ee]=y[ee];return q}return[]}function x(y,O){for(let q=1;q<arguments.length;q++){const ee=arguments[q];if(u(ee)){const Ne=y.length||0,Fe=ee.length||0;y.length=Ne+Fe;for(let it=0;it<Fe;it++)y[Ne+it]=ee[it]}else y.push(ee)}}class E{constructor(O,q){this.i=O,this.j=q,this.h=0,this.g=null}get(){let O;return 0<this.h?(this.h--,O=this.g,this.g=O.next,O.next=null):O=this.i(),O}}function A(y){return/^[\s\xa0]*$/.test(y)}function N(){var y=a.navigator;return y&&(y=y.userAgent)?y:""}function F(y){return F[" "](y),y}F[" "]=function(){};var D=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function W(y,O,q){for(const ee in y)O.call(q,y[ee],ee,y)}function k(y,O){for(const q in y)O.call(void 0,y[q],q,y)}function C(y){const O={};for(const q in y)O[q]=y[q];return O}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(y,O){let q,ee;for(let Ne=1;Ne<arguments.length;Ne++){ee=arguments[Ne];for(q in ee)y[q]=ee[q];for(let Fe=0;Fe<L.length;Fe++)q=L[Fe],Object.prototype.hasOwnProperty.call(ee,q)&&(y[q]=ee[q])}}function R(y){var O=1;y=y.split(":");const q=[];for(;0<O&&y.length;)q.push(y.shift()),O--;return y.length&&q.push(y.join(":")),q}function M(y){a.setTimeout(()=>{throw y},0)}function U(){var y=le;let O=null;return y.g&&(O=y.g,y.g=y.g.next,y.g||(y.h=null),O.next=null),O}class J{constructor(){this.h=this.g=null}add(O,q){const ee=de.get();ee.set(O,q),this.h?this.h.next=ee:this.g=ee,this.h=ee}}var de=new E(()=>new fe,y=>y.reset());class fe{constructor(){this.next=this.g=this.h=null}set(O,q){this.h=O,this.g=q,this.next=null}reset(){this.next=this.g=this.h=null}}let he,K=!1,le=new J,se=()=>{const y=a.Promise.resolve(void 0);he=()=>{y.then(re)}};var re=()=>{for(var y;y=U();){try{y.h.call(y.g)}catch(q){M(q)}var O=de;O.j(y),100>O.h&&(O.h++,y.next=O.g,O.g=y)}K=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $(y,O){this.type=y,this.g=this.target=O,this.defaultPrevented=!1}$.prototype.h=function(){this.defaultPrevented=!0};var ne=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var y=!1,O=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const q=()=>{};a.addEventListener("test",q,O),a.removeEventListener("test",q,O)}catch{}return y})();function ce(y,O){if($.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var q=this.type=y.type,ee=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=O,O=y.relatedTarget){if(D){e:{try{F(O.nodeName);var Ne=!0;break e}catch{}Ne=!1}Ne||(O=null)}}else q=="mouseover"?O=y.fromElement:q=="mouseout"&&(O=y.toElement);this.relatedTarget=O,ee?(this.clientX=ee.clientX!==void 0?ee.clientX:ee.pageX,this.clientY=ee.clientY!==void 0?ee.clientY:ee.pageY,this.screenX=ee.screenX||0,this.screenY=ee.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:ge[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&ce.aa.h.call(this)}}w(ce,$);var ge={2:"touch",3:"pen",4:"mouse"};ce.prototype.h=function(){ce.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var ye="closure_listenable_"+(1e6*Math.random()|0),be=0;function Ae(y,O,q,ee,Ne){this.listener=y,this.proxy=null,this.src=O,this.type=q,this.capture=!!ee,this.ha=Ne,this.key=++be,this.da=this.fa=!1}function $e(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function Ue(y){this.src=y,this.g={},this.h=0}Ue.prototype.add=function(y,O,q,ee,Ne){var Fe=y.toString();y=this.g[Fe],y||(y=this.g[Fe]=[],this.h++);var it=Je(y,O,ee,Ne);return-1<it?(O=y[it],q||(O.fa=!1)):(O=new Ae(O,this.src,Fe,!!ee,Ne),O.fa=q,y.push(O)),O};function et(y,O){var q=O.type;if(q in y.g){var ee=y.g[q],Ne=Array.prototype.indexOf.call(ee,O,void 0),Fe;(Fe=0<=Ne)&&Array.prototype.splice.call(ee,Ne,1),Fe&&($e(O),y.g[q].length==0&&(delete y.g[q],y.h--))}}function Je(y,O,q,ee){for(var Ne=0;Ne<y.length;++Ne){var Fe=y[Ne];if(!Fe.da&&Fe.listener==O&&Fe.capture==!!q&&Fe.ha==ee)return Ne}return-1}var Be="closure_lm_"+(1e6*Math.random()|0),_e={};function ie(y,O,q,ee,Ne){if(Array.isArray(O)){for(var Fe=0;Fe<O.length;Fe++)ie(y,O[Fe],q,ee,Ne);return null}return q=jt(q),y&&y[ye]?y.K(O,q,l(ee)?!!ee.capture:!1,Ne):ft(y,O,q,!1,ee,Ne)}function ft(y,O,q,ee,Ne,Fe){if(!O)throw Error("Invalid event type");var it=l(Ne)?!!Ne.capture:!!Ne,on=xt(y);if(on||(y[Be]=on=new Ue(y)),q=on.add(O,q,ee,it,Fe),q.proxy)return q;if(ee=dt(),q.proxy=ee,ee.src=y,ee.listener=q,y.addEventListener)ne||(Ne=it),Ne===void 0&&(Ne=!1),y.addEventListener(O.toString(),ee,Ne);else if(y.attachEvent)y.attachEvent(lt(O.toString()),ee);else if(y.addListener&&y.removeListener)y.addListener(ee);else throw Error("addEventListener and attachEvent are unavailable.");return q}function dt(){function y(q){return O.call(y.src,y.listener,q)}const O=ct;return y}function Ze(y,O,q,ee,Ne){if(Array.isArray(O))for(var Fe=0;Fe<O.length;Fe++)Ze(y,O[Fe],q,ee,Ne);else ee=l(ee)?!!ee.capture:!!ee,q=jt(q),y&&y[ye]?(y=y.i,O=String(O).toString(),O in y.g&&(Fe=y.g[O],q=Je(Fe,q,ee,Ne),-1<q&&($e(Fe[q]),Array.prototype.splice.call(Fe,q,1),Fe.length==0&&(delete y.g[O],y.h--)))):y&&(y=xt(y))&&(O=y.g[O.toString()],y=-1,O&&(y=Je(O,q,ee,Ne)),(q=-1<y?O[y]:null)&&at(q))}function at(y){if(typeof y!="number"&&y&&!y.da){var O=y.src;if(O&&O[ye])et(O.i,y);else{var q=y.type,ee=y.proxy;O.removeEventListener?O.removeEventListener(q,ee,y.capture):O.detachEvent?O.detachEvent(lt(q),ee):O.addListener&&O.removeListener&&O.removeListener(ee),(q=xt(O))?(et(q,y),q.h==0&&(q.src=null,O[Be]=null)):$e(y)}}}function lt(y){return y in _e?_e[y]:_e[y]="on"+y}function ct(y,O){if(y.da)y=!0;else{O=new ce(O,this);var q=y.listener,ee=y.ha||y.src;y.fa&&at(y),y=q.call(ee,O)}return y}function xt(y){return y=y[Be],y instanceof Ue?y:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(y){return typeof y=="function"?y:(y[Vt]||(y[Vt]=function(O){return y.handleEvent(O)}),y[Vt])}function Pt(){j.call(this),this.i=new Ue(this),this.M=this,this.F=null}w(Pt,j),Pt.prototype[ye]=!0,Pt.prototype.removeEventListener=function(y,O,q,ee){Ze(this,y,O,q,ee)};function Lt(y,O){var q,ee=y.F;if(ee)for(q=[];ee;ee=ee.F)q.push(ee);if(y=y.M,ee=O.type||O,typeof O=="string")O=new $(O,y);else if(O instanceof $)O.target=O.target||y;else{var Ne=O;O=new $(ee,y),B(O,Ne)}if(Ne=!0,q)for(var Fe=q.length-1;0<=Fe;Fe--){var it=O.g=q[Fe];Ne=Yt(it,ee,!0,O)&&Ne}if(it=O.g=y,Ne=Yt(it,ee,!0,O)&&Ne,Ne=Yt(it,ee,!1,O)&&Ne,q)for(Fe=0;Fe<q.length;Fe++)it=O.g=q[Fe],Ne=Yt(it,ee,!1,O)&&Ne}Pt.prototype.N=function(){if(Pt.aa.N.call(this),this.i){var y=this.i,O;for(O in y.g){for(var q=y.g[O],ee=0;ee<q.length;ee++)$e(q[ee]);delete y.g[O],y.h--}}this.F=null},Pt.prototype.K=function(y,O,q,ee){return this.i.add(String(y),O,!1,q,ee)},Pt.prototype.L=function(y,O,q,ee){return this.i.add(String(y),O,!0,q,ee)};function Yt(y,O,q,ee){if(O=y.i.g[String(O)],!O)return!0;O=O.concat();for(var Ne=!0,Fe=0;Fe<O.length;++Fe){var it=O[Fe];if(it&&!it.da&&it.capture==q){var on=it.listener,vn=it.ha||it.src;it.fa&&et(y.i,it),Ne=on.call(vn,ee)!==!1&&Ne}}return Ne&&!ee.defaultPrevented}function Ut(y,O,q){if(typeof y=="function")q&&(y=p(y,q));else if(y&&typeof y.handleEvent=="function")y=p(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(O)?-1:a.setTimeout(y,O||0)}function en(y){y.g=Ut(()=>{y.g=null,y.i&&(y.i=!1,en(y))},y.l);const O=y.h;y.h=null,y.m.apply(null,O)}class pt extends j{constructor(O,q){super(),this.m=O,this.l=q,this.h=null,this.i=!1,this.g=null}j(O){this.h=arguments,this.g?this.i=!0:en(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ar(y){j.call(this),this.h=y,this.g={}}w(ar,j);var dn=[];function qr(y){W(y.g,function(O,q){this.g.hasOwnProperty(q)&&at(O)},y),y.g={}}ar.prototype.N=function(){ar.aa.N.call(this),qr(this)},ar.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xn=a.JSON.stringify,Gn=a.JSON.parse,ho=class{stringify(y){return a.JSON.stringify(y,void 0)}parse(y){return a.JSON.parse(y,void 0)}};function gn(){}gn.prototype.h=null;function is(y){return y.h||(y.h=y.i())}function Jn(){}var yr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ni(){$.call(this,"d")}w(ni,$);function Qn(){$.call(this,"c")}w(Qn,$);var Wt={},En=null;function zo(){return En=En||new Pt}Wt.La="serverreachability";function Sr(y){$.call(this,Wt.La,y)}w(Sr,$);function ri(y){const O=zo();Lt(O,new Sr(O))}Wt.STAT_EVENT="statevent";function fo(y,O){$.call(this,Wt.STAT_EVENT,y),this.stat=O}w(fo,$);function _t(y){const O=zo();Lt(O,new fo(O,y))}Wt.Ma="timingevent";function Ti(y,O){$.call(this,Wt.Ma,y),this.size=O}w(Ti,$);function Lr(y,O){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){y()},O)}function Mr(){this.g=!0}Mr.prototype.xa=function(){this.g=!1};function nr(y,O,q,ee,Ne,Fe){y.info(function(){if(y.g)if(Fe)for(var it="",on=Fe.split("&"),vn=0;vn<on.length;vn++){var sn=on[vn].split("=");if(1<sn.length){var Fn=sn[0];sn=sn[1];var Un=Fn.split("_");it=2<=Un.length&&Un[1]=="type"?it+(Fn+"="+sn+"&"):it+(Fn+"=redacted&")}}else it=null;else it=Fe;return"XMLHTTP REQ ("+ee+") [attempt "+Ne+"]: "+O+`
`+q+`
`+it})}function rr(y,O,q,ee,Ne,Fe,it){y.info(function(){return"XMLHTTP RESP ("+ee+") [ attempt "+Ne+"]: "+O+`
`+q+`
`+Fe+" "+it})}function cr(y,O,q,ee){y.info(function(){return"XMLHTTP TEXT ("+O+"): "+Ns(y,q)+(ee?" "+ee:"")})}function ia(y,O){y.info(function(){return"TIMEOUT: "+O})}Mr.prototype.info=function(){};function Ns(y,O){if(!y.g)return O;if(!O)return null;try{var q=JSON.parse(O);if(q){for(y=0;y<q.length;y++)if(Array.isArray(q[y])){var ee=q[y];if(!(2>ee.length)){var Ne=ee[1];if(Array.isArray(Ne)&&!(1>Ne.length)){var Fe=Ne[0];if(Fe!="noop"&&Fe!="stop"&&Fe!="close")for(var it=1;it<Ne.length;it++)Ne[it]=""}}}}return xn(q)}catch{return O}}var ki={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},po={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ar;function Ni(){}w(Ni,gn),Ni.prototype.g=function(){return new XMLHttpRequest},Ni.prototype.i=function(){return{}},Ar=new Ni;function wr(y,O,q,ee){this.j=y,this.i=O,this.l=q,this.R=ee||1,this.U=new ar(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Wo}function Wo(){this.i=null,this.g="",this.h=!1}var Ps={},Rs={};function Ds(y,O,q){y.L=1,y.v=Fs(fi(O)),y.m=q,y.P=!0,oa(y,null)}function oa(y,O){y.F=Date.now(),$n(y),y.A=fi(y.v);var q=y.A,ee=y.R;Array.isArray(ee)||(ee=[String(ee)]),Ht(q.i,"t",ee),y.C=0,q=y.j.J,y.h=new Wo,y.g=G(y.j,q?O:null,!y.m),0<y.O&&(y.M=new pt(p(y.Y,y,y.g),y.O)),O=y.U,q=y.g,ee=y.ca;var Ne="readystatechange";Array.isArray(Ne)||(Ne&&(dn[0]=Ne.toString()),Ne=dn);for(var Fe=0;Fe<Ne.length;Fe++){var it=ie(q,Ne[Fe],ee||O.handleEvent,!1,O.h||O);if(!it)break;O.g[it.key]=it}O=y.H?C(y.H):{},y.m?(y.u||(y.u="POST"),O["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,O)):(y.u="GET",y.g.ea(y.A,y.u,null,O)),ri(),nr(y.i,y.u,y.A,y.l,y.R,y.m)}wr.prototype.ca=function(y){y=y.target;const O=this.M;O&&xr(y)==3?O.j():this.Y(y)},wr.prototype.Y=function(y){try{if(y==this.g)e:{const Un=xr(this.g);var O=this.g.Ba();const Xi=this.g.Z();if(!(3>Un)&&(Un!=3||this.g&&(this.h.h||this.g.oa()||wl(this.g)))){this.J||Un!=4||O==7||(O==8||0>=Xi?ri(3):ri(2)),os(this);var q=this.g.Z();this.X=q;t:if(La(this)){var ee=wl(this.g);y="";var Ne=ee.length,Fe=xr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mo(this),Ls(this);var it="";break t}this.h.i=new a.TextDecoder}for(O=0;O<Ne;O++)this.h.h=!0,y+=this.h.i.decode(ee[O],{stream:!(Fe&&O==Ne-1)});ee.length=0,this.h.g+=y,this.C=0,it=this.h.g}else it=this.g.oa();if(this.o=q==200,rr(this.i,this.u,this.A,this.l,this.R,Un,q),this.o){if(this.T&&!this.K){t:{if(this.g){var on,vn=this.g;if((on=vn.g?vn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(on)){var sn=on;break t}}sn=null}if(q=sn)cr(this.i,this.l,q,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ma(this,q);else{this.o=!1,this.s=3,_t(12),mo(this),Ls(this);break e}}if(this.P){q=!0;let mi;for(;!this.J&&this.C<it.length;)if(mi=ic(this,it),mi==Rs){Un==4&&(this.s=4,_t(14),q=!1),cr(this.i,this.l,null,"[Incomplete Response]");break}else if(mi==Ps){this.s=4,_t(15),cr(this.i,this.l,it,"[Invalid Chunk]"),q=!1;break}else cr(this.i,this.l,mi,null),Ma(this,mi);if(La(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Un!=4||it.length!=0||this.h.h||(this.s=1,_t(16),q=!1),this.o=this.o&&q,!q)cr(this.i,this.l,it,"[Invalid Chunked Response]"),mo(this),Ls(this);else if(0<it.length&&!this.W){this.W=!0;var Fn=this.j;Fn.g==this&&Fn.ba&&!Fn.M&&(Fn.j.info("Great, no buffering proxy detected. Bytes received: "+it.length),ku(Fn),Fn.M=!0,_t(11))}}else cr(this.i,this.l,it,null),Ma(this,it);Un==4&&mo(this),this.o&&!this.J&&(Un==4?fs(this.j,this):(this.o=!1,$n(this)))}else Go(this.g),q==400&&0<it.indexOf("Unknown SID")?(this.s=3,_t(12)):(this.s=0,_t(13)),mo(this),Ls(this)}}}catch{}finally{}};function La(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function ic(y,O){var q=y.C,ee=O.indexOf(`
`,q);return ee==-1?Rs:(q=Number(O.substring(q,ee)),isNaN(q)?Ps:(ee+=1,ee+q>O.length?Rs:(O=O.slice(ee,ee+q),y.C=ee+q,O)))}wr.prototype.cancel=function(){this.J=!0,mo(this)};function $n(y){y.S=Date.now()+y.I,oc(y,y.I)}function oc(y,O){if(y.B!=null)throw Error("WatchDog timer not null");y.B=Lr(p(y.ba,y),O)}function os(y){y.B&&(a.clearTimeout(y.B),y.B=null)}wr.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(ia(this.i,this.A),this.L!=2&&(ri(),_t(17)),mo(this),this.s=2,Ls(this)):oc(this,this.S-y)};function Ls(y){y.j.G==0||y.J||fs(y.j,y)}function mo(y){os(y);var O=y.M;O&&typeof O.ma=="function"&&O.ma(),y.M=null,qr(y.U),y.g&&(O=y.g,y.g=null,O.abort(),O.ma())}function Ma(y,O){try{var q=y.j;if(q.G!=0&&(q.g==y||ci(q.h,y))){if(!y.K&&ci(q.h,y)&&q.G==3){try{var ee=q.Da.g.parse(O)}catch{ee=null}if(Array.isArray(ee)&&ee.length==3){var Ne=ee;if(Ne[0]==0){e:if(!q.u){if(q.g)if(q.g.F+3e3<y.F)js(q),$o(q);else break e;ga(q),_t(18)}}else q.za=Ne[1],0<q.za-q.T&&37500>Ne[2]&&q.F&&q.v==0&&!q.C&&(q.C=Lr(p(q.Za,q),6e3));if(1>=Fa(q.h)&&q.ca){try{q.ca()}catch{}q.ca=void 0}}else Di(q,11)}else if((y.K||q.g==y)&&js(q),!A(O))for(Ne=q.Da.g.parse(O),O=0;O<Ne.length;O++){let sn=Ne[O];if(q.T=sn[0],sn=sn[1],q.G==2)if(sn[0]=="c"){q.K=sn[1],q.ia=sn[2];const Fn=sn[3];Fn!=null&&(q.la=Fn,q.j.info("VER="+q.la));const Un=sn[4];Un!=null&&(q.Aa=Un,q.j.info("SVER="+q.Aa));const Xi=sn[5];Xi!=null&&typeof Xi=="number"&&0<Xi&&(ee=1.5*Xi,q.L=ee,q.j.info("backChannelRequestTimeoutMs_="+ee)),ee=q;const mi=y.g;if(mi){const Us=mi.g?mi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Us){var Fe=ee.h;Fe.g||Us.indexOf("spdy")==-1&&Us.indexOf("quic")==-1&&Us.indexOf("h2")==-1||(Fe.j=Fe.l,Fe.g=new Set,Fe.h&&(ir(Fe,Fe.h),Fe.h=null))}if(ee.D){const zs=mi.g?mi.g.getResponseHeader("X-HTTP-Session-Id"):null;zs&&(ee.ya=zs,jn(ee.I,ee.D,zs))}}q.G=3,q.l&&q.l.ua(),q.ba&&(q.R=Date.now()-y.F,q.j.info("Handshake RTT: "+q.R+"ms")),ee=q;var it=y;if(ee.qa=I(ee,ee.J?ee.ia:null,ee.W),it.K){ml(ee.h,it);var on=it,vn=ee.L;vn&&(on.I=vn),on.B&&(os(on),$n(on)),ee.g=it}else Vs(ee);0<q.i.length&&cs(q)}else sn[0]!="stop"&&sn[0]!="close"||Di(q,7);else q.G==3&&(sn[0]=="stop"||sn[0]=="close"?sn[0]=="stop"?Di(q,7):hr(q):sn[0]!="noop"&&q.l&&q.l.ta(sn),q.v=0)}}ri(4)}catch{}}var sc=class{constructor(y,O){this.g=y,this.map=O}};function sa(y){this.l=y||10,a.PerformanceNavigationTiming?(y=a.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Gi(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Fa(y){return y.h?1:y.g?y.g.size:0}function ci(y,O){return y.h?y.h==O:y.g?y.g.has(O):!1}function ir(y,O){y.g?y.g.add(O):y.h=O}function ml(y,O){y.h&&y.h==O?y.h=null:y.g&&y.g.has(O)&&y.g.delete(O)}sa.prototype.cancel=function(){if(this.i=gl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function gl(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let O=y.i;for(const q of y.g.values())O=O.concat(q.D);return O}return b(y.i)}function Oa(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(u(y)){for(var O=[],q=y.length,ee=0;ee<q;ee++)O.push(y[ee]);return O}O=[],q=0;for(ee in y)O[q++]=y[ee];return O}function aa(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(u(y)||typeof y=="string"){var O=[];y=y.length;for(var q=0;q<y;q++)O.push(q);return O}O=[],q=0;for(const ee in y)O[q++]=ee;return O}}}function ua(y,O){if(y.forEach&&typeof y.forEach=="function")y.forEach(O,void 0);else if(u(y)||typeof y=="string")Array.prototype.forEach.call(y,O,void 0);else for(var q=aa(y),ee=Oa(y),Ne=ee.length,Fe=0;Fe<Ne;Fe++)O.call(void 0,ee[Fe],q&&q[Fe],y)}var hi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Su(y,O){if(y){y=y.split("&");for(var q=0;q<y.length;q++){var ee=y[q].indexOf("="),Ne=null;if(0<=ee){var Fe=y[q].substring(0,ee);Ne=y[q].substring(ee+1)}else Fe=y[q];O(Fe,Ne?decodeURIComponent(Ne.replace(/\+/g," ")):"")}}}function br(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof br){this.h=y.h,la(this,y.j),this.o=y.o,this.g=y.g,ca(this,y.s),this.l=y.l;var O=y.i,q=new qo;q.i=O.i,O.g&&(q.g=new Map(O.g),q.h=O.h),Ms(this,q),this.m=y.m}else y&&(O=String(y).match(hi))?(this.h=!1,la(this,O[1]||"",!0),this.o=mn(O[2]||""),this.g=mn(O[3]||"",!0),ca(this,O[4]),this.l=mn(O[5]||"",!0),Ms(this,O[6]||"",!0),this.m=mn(O[7]||"")):(this.h=!1,this.i=new qo(null,this.h))}br.prototype.toString=function(){var y=[],O=this.j;O&&y.push(ss(O,Au,!0),":");var q=this.g;return(q||O=="file")&&(y.push("//"),(O=this.o)&&y.push(ss(O,Au,!0),"@"),y.push(encodeURIComponent(String(q)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),q=this.s,q!=null&&y.push(":",String(q))),(q=this.l)&&(this.g&&q.charAt(0)!="/"&&y.push("/"),y.push(ss(q,q.charAt(0)=="/"?as:uc,!0))),(q=this.i.toString())&&y.push("?",q),(q=this.m)&&y.push("#",ss(q,ha)),y.join("")};function fi(y){return new br(y)}function la(y,O,q){y.j=q?mn(O,!0):O,y.j&&(y.j=y.j.replace(/:$/,""))}function ca(y,O){if(O){if(O=Number(O),isNaN(O)||0>O)throw Error("Bad port number "+O);y.s=O}else y.s=null}function Ms(y,O,q){O instanceof qo?(y.i=O,us(y.i,y.h)):(q||(O=ss(O,Ba)),y.i=new qo(O,y.h))}function jn(y,O,q){y.i.set(O,q)}function Fs(y){return jn(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function mn(y,O){return y?O?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function ss(y,O,q){return typeof y=="string"?(y=encodeURI(y).replace(O,ac),q&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function ac(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var Au=/[#\/\?@]/g,uc=/[#\?:]/g,as=/[#\?]/g,Ba=/[#\?@]/g,ha=/#/g;function qo(y,O){this.h=this.g=null,this.i=y||null,this.j=!!O}function Cn(y){y.g||(y.g=new Map,y.h=0,y.i&&Su(y.i,function(O,q){y.add(decodeURIComponent(O.replace(/\+/g," ")),q)}))}n=qo.prototype,n.add=function(y,O){Cn(this),this.i=null,y=vo(this,y);var q=this.g.get(y);return q||this.g.set(y,q=[]),q.push(O),this.h+=1,this};function Ho(y,O){Cn(y),O=vo(y,O),y.g.has(O)&&(y.i=null,y.h-=y.g.get(O).length,y.g.delete(O))}function go(y,O){return Cn(y),O=vo(y,O),y.g.has(O)}n.forEach=function(y,O){Cn(this),this.g.forEach(function(q,ee){q.forEach(function(Ne){y.call(O,Ne,ee,this)},this)},this)},n.na=function(){Cn(this);const y=Array.from(this.g.values()),O=Array.from(this.g.keys()),q=[];for(let ee=0;ee<O.length;ee++){const Ne=y[ee];for(let Fe=0;Fe<Ne.length;Fe++)q.push(O[ee])}return q},n.V=function(y){Cn(this);let O=[];if(typeof y=="string")go(this,y)&&(O=O.concat(this.g.get(vo(this,y))));else{y=Array.from(this.g.values());for(let q=0;q<y.length;q++)O=O.concat(y[q])}return O},n.set=function(y,O){return Cn(this),this.i=null,y=vo(this,y),go(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[O]),this.h+=1,this},n.get=function(y,O){return y?(y=this.V(y),0<y.length?String(y[0]):O):O};function Ht(y,O,q){Ho(y,O),0<q.length&&(y.i=null,y.g.set(vo(y,O),b(q)),y.h+=q.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],O=Array.from(this.g.keys());for(var q=0;q<O.length;q++){var ee=O[q];const Fe=encodeURIComponent(String(ee)),it=this.V(ee);for(ee=0;ee<it.length;ee++){var Ne=Fe;it[ee]!==""&&(Ne+="="+encodeURIComponent(String(it[ee]))),y.push(Ne)}}return this.i=y.join("&")};function vo(y,O){return O=String(O),y.j&&(O=O.toLowerCase()),O}function us(y,O){O&&!y.j&&(Cn(y),y.i=null,y.g.forEach(function(q,ee){var Ne=ee.toLowerCase();ee!=Ne&&(Ho(this,ee),Ht(this,Ne,q))},y)),y.j=O}function ls(y,O){const q=new Mr;if(a.Image){const ee=new Image;ee.onload=m(di,q,"TestLoadImage: loaded",!0,O,ee),ee.onerror=m(di,q,"TestLoadImage: error",!1,O,ee),ee.onabort=m(di,q,"TestLoadImage: abort",!1,O,ee),ee.ontimeout=m(di,q,"TestLoadImage: timeout",!1,O,ee),a.setTimeout(function(){ee.ontimeout&&ee.ontimeout()},1e4),ee.src=y}else O(!1)}function vl(y,O){const q=new Mr,ee=new AbortController,Ne=setTimeout(()=>{ee.abort(),di(q,"TestPingServer: timeout",!1,O)},1e4);fetch(y,{signal:ee.signal}).then(Fe=>{clearTimeout(Ne),Fe.ok?di(q,"TestPingServer: ok",!0,O):di(q,"TestPingServer: server error",!1,O)}).catch(()=>{clearTimeout(Ne),di(q,"TestPingServer: error",!1,O)})}function di(y,O,q,ee,Ne){try{Ne&&(Ne.onload=null,Ne.onerror=null,Ne.onabort=null,Ne.ontimeout=null),ee(q)}catch{}}function Cu(){this.g=new ho}function Iu(y,O,q){const ee=q||"";try{ua(y,function(Ne,Fe){let it=Ne;l(Ne)&&(it=xn(Ne)),O.push(ee+Fe+"="+encodeURIComponent(it))})}catch(Ne){throw O.push(ee+"type="+encodeURIComponent("_badmap")),Ne}}function Os(y){this.l=y.Ub||null,this.j=y.eb||!1}w(Os,gn),Os.prototype.g=function(){return new Va(this.l,this.j)},Os.prototype.i=(function(y){return function(){return y}})({});function Va(y,O){Pt.call(this),this.D=y,this.o=O,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Va,Pt),n=Va.prototype,n.open=function(y,O){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=O,this.readyState=1,pi(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const O={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(O.body=y),(this.D||a).fetch(new Request(this.A,O)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,$i(this)),this.readyState=0},n.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,pi(this)),this.g&&(this.readyState=3,pi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;lc(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function lc(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}n.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var O=y.value?y.value:new Uint8Array(0);(O=this.v.decode(O,{stream:!y.done}))&&(this.response=this.responseText+=O)}y.done?$i(this):pi(this),this.readyState==3&&lc(this)}},n.Ra=function(y){this.g&&(this.response=this.responseText=y,$i(this))},n.Qa=function(y){this.g&&(this.response=y,$i(this))},n.ga=function(){this.g&&$i(this)};function $i(y){y.readyState=4,y.l=null,y.j=null,y.v=null,pi(y)}n.setRequestHeader=function(y,O){this.u.append(y,O)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],O=this.h.entries();for(var q=O.next();!q.done;)q=q.value,y.push(q[0]+": "+q[1]),q=O.next();return y.join(`\r
`)};function pi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Va.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Pi(y){let O="";return W(y,function(q,ee){O+=ee,O+=":",O+=q,O+=`\r
`}),O}function fa(y,O,q){e:{for(ee in q){var ee=!1;break e}ee=!0}ee||(q=Pi(q),typeof y=="string"?q!=null&&encodeURIComponent(String(q)):jn(y,O,q))}function Mn(y){Pt.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(Mn,Pt);var yl=/^https?$/i,da=["POST","PUT"];n=Mn.prototype,n.Ha=function(y){this.J=y},n.ea=function(y,O,q,ee){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);O=O?O.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ar.g(),this.v=this.o?is(this.o):is(Ar),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(O,String(y),!0),this.B=!1}catch(Fe){pa(this,Fe);return}if(y=q||"",q=new Map(this.headers),ee)if(Object.getPrototypeOf(ee)===Object.prototype)for(var Ne in ee)q.set(Ne,ee[Ne]);else if(typeof ee.keys=="function"&&typeof ee.get=="function")for(const Fe of ee.keys())q.set(Fe,ee.get(Fe));else throw Error("Unknown input type for opt_headers: "+String(ee));ee=Array.from(q.keys()).find(Fe=>Fe.toLowerCase()=="content-type"),Ne=a.FormData&&y instanceof a.FormData,!(0<=Array.prototype.indexOf.call(da,O,void 0))||ee||Ne||q.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Fe,it]of q)this.g.setRequestHeader(Fe,it);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ki(this),this.u=!0,this.g.send(y),this.u=!1}catch(Fe){pa(this,Fe)}};function pa(y,O){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=O,y.m=5,ja(y),Ri(y)}function ja(y){y.A||(y.A=!0,Lt(y,"complete"),Lt(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,Lt(this,"complete"),Lt(this,"abort"),Ri(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ri(this,!0)),Mn.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Tu(this):this.bb())},n.bb=function(){Tu(this)};function Tu(y){if(y.h&&typeof s<"u"&&(!y.v[1]||xr(y)!=4||y.Z()!=2)){if(y.u&&xr(y)==4)Ut(y.Ea,0,y);else if(Lt(y,"readystatechange"),xr(y)==4){y.h=!1;try{const it=y.Z();e:switch(it){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var O=!0;break e;default:O=!1}var q;if(!(q=O)){var ee;if(ee=it===0){var Ne=String(y.D).match(hi)[1]||null;!Ne&&a.self&&a.self.location&&(Ne=a.self.location.protocol.slice(0,-1)),ee=!yl.test(Ne?Ne.toLowerCase():"")}q=ee}if(q)Lt(y,"complete"),Lt(y,"success");else{y.m=6;try{var Fe=2<xr(y)?y.g.statusText:""}catch{Fe=""}y.l=Fe+" ["+y.Z()+"]",ja(y)}}finally{Ri(y)}}}}function Ri(y,O){if(y.g){Ki(y);const q=y.g,ee=y.v[0]?()=>{}:null;y.g=null,y.v=null,O||Lt(y,"ready");try{q.onreadystatechange=ee}catch{}}}function Ki(y){y.I&&(a.clearTimeout(y.I),y.I=null)}n.isActive=function(){return!!this.g};function xr(y){return y.g?y.g.readyState:0}n.Z=function(){try{return 2<xr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(y){if(this.g){var O=this.g.responseText;return y&&O.indexOf(y)==0&&(O=O.substring(y.length)),Gn(O)}};function wl(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function Go(y){const O={};y=(y.g&&2<=xr(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let ee=0;ee<y.length;ee++){if(A(y[ee]))continue;var q=R(y[ee]);const Ne=q[0];if(q=q[1],typeof q!="string")continue;q=q.trim();const Fe=O[Ne]||[];O[Ne]=Fe,Fe.push(q)}k(O,function(ee){return ee.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fr(y,O,q){return q&&q.internalChannelParams&&q.internalChannelParams[y]||O}function Ua(y){this.Aa=0,this.i=[],this.j=new Mr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fr("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fr("baseRetryDelayMs",5e3,y),this.cb=Fr("retryDelaySeedMs",1e4,y),this.Wa=Fr("forwardChannelMaxRetries",2,y),this.wa=Fr("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new sa(y&&y.concurrentRequestLimit),this.Da=new Cu,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ua.prototype,n.la=8,n.G=1,n.connect=function(y,O,q,ee){_t(0),this.W=y,this.H=O||{},q&&ee!==void 0&&(this.H.OSID=q,this.H.OAID=ee),this.F=this.X,this.I=I(this,null,this.W),cs(this)};function hr(y){if(Bs(y),y.G==3){var O=y.U++,q=fi(y.I);if(jn(q,"SID",y.K),jn(q,"RID",O),jn(q,"TYPE","terminate"),hs(y,q),O=new wr(y,y.j,O),O.L=2,O.v=Fs(fi(q)),q=!1,a.navigator&&a.navigator.sendBeacon)try{q=a.navigator.sendBeacon(O.v.toString(),"")}catch{}!q&&a.Image&&(new Image().src=O.v,q=!0),q||(O.g=G(O.j,null),O.g.ea(O.v)),O.F=Date.now(),$n(O)}Pu(y)}function $o(y){y.g&&(ku(y),y.g.cancel(),y.g=null)}function Bs(y){$o(y),y.u&&(a.clearTimeout(y.u),y.u=null),js(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&a.clearTimeout(y.s),y.s=null)}function cs(y){if(!Gi(y.h)&&!y.s){y.s=!0;var O=y.Ga;he||se(),K||(he(),K=!0),le.add(O,y),y.B=0}}function bl(y,O){return Fa(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=O.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=Lr(p(y.Ga,y,O),Nu(y,y.B)),y.B++,!0)}n.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const Ne=new wr(this,this.j,y);let Fe=this.o;if(this.S&&(Fe?(Fe=C(Fe),B(Fe,this.S)):Fe=this.S),this.m!==null||this.O||(Ne.H=Fe,Fe=null),this.P)e:{for(var O=0,q=0;q<this.i.length;q++){t:{var ee=this.i[q];if("__data__"in ee.map&&(ee=ee.map.__data__,typeof ee=="string")){ee=ee.length;break t}ee=void 0}if(ee===void 0)break;if(O+=ee,4096<O){O=q;break e}if(O===4096||q===this.i.length-1){O=q+1;break e}}O=1e3}else O=1e3;O=Ko(this,Ne,O),q=fi(this.I),jn(q,"RID",y),jn(q,"CVER",22),this.D&&jn(q,"X-HTTP-Session-Id",this.D),hs(this,q),Fe&&(this.O?O="headers="+encodeURIComponent(String(Pi(Fe)))+"&"+O:this.m&&fa(q,this.m,Fe)),ir(this.h,Ne),this.Ua&&jn(q,"TYPE","init"),this.P?(jn(q,"$req",O),jn(q,"SID","null"),Ne.T=!0,Ds(Ne,q,null)):Ds(Ne,q,O),this.G=2}}else this.G==3&&(y?ma(this,y):this.i.length==0||Gi(this.h)||ma(this))};function ma(y,O){var q;O?q=O.l:q=y.U++;const ee=fi(y.I);jn(ee,"SID",y.K),jn(ee,"RID",q),jn(ee,"AID",y.T),hs(y,ee),y.m&&y.o&&fa(ee,y.m,y.o),q=new wr(y,y.j,q,y.B+1),y.m===null&&(q.H=y.o),O&&(y.i=O.D.concat(y.i)),O=Ko(y,q,1e3),q.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),ir(y.h,q),Ds(q,ee,O)}function hs(y,O){y.H&&W(y.H,function(q,ee){jn(O,ee,q)}),y.l&&ua({},function(q,ee){jn(O,ee,q)})}function Ko(y,O,q){q=Math.min(y.i.length,q);var ee=y.l?p(y.l.Na,y.l,y):null;e:{var Ne=y.i;let Fe=-1;for(;;){const it=["count="+q];Fe==-1?0<q?(Fe=Ne[0].g,it.push("ofs="+Fe)):Fe=0:it.push("ofs="+Fe);let on=!0;for(let vn=0;vn<q;vn++){let sn=Ne[vn].g;const Fn=Ne[vn].map;if(sn-=Fe,0>sn)Fe=Math.max(0,Ne[vn].g-100),on=!1;else try{Iu(Fn,it,"req"+sn+"_")}catch{ee&&ee(Fn)}}if(on){ee=it.join("&");break e}}}return y=y.i.splice(0,q),O.D=y,ee}function Vs(y){if(!y.g&&!y.u){y.Y=1;var O=y.Fa;he||se(),K||(he(),K=!0),le.add(O,y),y.v=0}}function ga(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=Lr(p(y.Fa,y),Nu(y,y.v)),y.v++,!0)}n.Fa=function(){if(this.u=null,cc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=Lr(p(this.ab,this),y)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_t(10),$o(this),cc(this))};function ku(y){y.A!=null&&(a.clearTimeout(y.A),y.A=null)}function cc(y){y.g=new wr(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var O=fi(y.qa);jn(O,"RID","rpc"),jn(O,"SID",y.K),jn(O,"AID",y.T),jn(O,"CI",y.F?"0":"1"),!y.F&&y.ja&&jn(O,"TO",y.ja),jn(O,"TYPE","xmlhttp"),hs(y,O),y.m&&y.o&&fa(O,y.m,y.o),y.L&&(y.g.I=y.L);var q=y.g;y=y.ia,q.L=1,q.v=Fs(fi(O)),q.m=null,q.P=!0,oa(q,y)}n.Za=function(){this.C!=null&&(this.C=null,$o(this),ga(this),_t(19))};function js(y){y.C!=null&&(a.clearTimeout(y.C),y.C=null)}function fs(y,O){var q=null;if(y.g==O){js(y),ku(y),y.g=null;var ee=2}else if(ci(y.h,O))q=O.D,ml(y.h,O),ee=1;else return;if(y.G!=0){if(O.o)if(ee==1){q=O.m?O.m.length:0,O=Date.now()-O.F;var Ne=y.B;ee=zo(),Lt(ee,new Ti(ee,q)),cs(y)}else Vs(y);else if(Ne=O.s,Ne==3||Ne==0&&0<O.X||!(ee==1&&bl(y,O)||ee==2&&ga(y)))switch(q&&0<q.length&&(O=y.h,O.i=O.i.concat(q)),Ne){case 1:Di(y,5);break;case 4:Di(y,10);break;case 3:Di(y,6);break;default:Di(y,2)}}}function Nu(y,O){let q=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(q*=2),q*O}function Di(y,O){if(y.j.info("Error code "+O),O==2){var q=p(y.fb,y),ee=y.Xa;const Ne=!ee;ee=new br(ee||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||la(ee,"https"),Fs(ee),Ne?ls(ee.toString(),q):vl(ee.toString(),q)}else _t(2);y.G=0,y.l&&y.l.sa(O),Pu(y),Bs(y)}n.fb=function(y){y?(this.j.info("Successfully pinged google.com"),_t(2)):(this.j.info("Failed to ping google.com"),_t(1))};function Pu(y){if(y.G=0,y.ka=[],y.l){const O=gl(y.h);(O.length!=0||y.i.length!=0)&&(x(y.ka,O),x(y.ka,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.ra()}}function I(y,O,q){var ee=q instanceof br?fi(q):new br(q);if(ee.g!="")O&&(ee.g=O+"."+ee.g),ca(ee,ee.s);else{var Ne=a.location;ee=Ne.protocol,O=O?O+"."+Ne.hostname:Ne.hostname,Ne=+Ne.port;var Fe=new br(null);ee&&la(Fe,ee),O&&(Fe.g=O),Ne&&ca(Fe,Ne),q&&(Fe.l=q),ee=Fe}return q=y.D,O=y.ya,q&&O&&jn(ee,q,O),jn(ee,"VER",y.la),hs(y,ee),ee}function G(y,O,q){if(O&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return O=y.Ca&&!y.pa?new Mn(new Os({eb:q})):new Mn(y.pa),O.Ha(y.J),O}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function me(){}n=me.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function we(){}we.prototype.g=function(y,O){return new Re(y,O)};function Re(y,O){Pt.call(this),this.g=new Ua(O),this.l=y,this.h=O&&O.messageUrlParams||null,y=O&&O.messageHeaders||null,O&&O.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=O&&O.initMessageHeaders||null,O&&O.messageContentType&&(y?y["X-WebChannel-Content-Type"]=O.messageContentType:y={"X-WebChannel-Content-Type":O.messageContentType}),O&&O.va&&(y?y["X-WebChannel-Client-Profile"]=O.va:y={"X-WebChannel-Client-Profile":O.va}),this.g.S=y,(y=O&&O.Sb)&&!A(y)&&(this.g.m=y),this.v=O&&O.supportsCrossDomainXhr||!1,this.u=O&&O.sendRawJson||!1,(O=O&&O.httpSessionIdParam)&&!A(O)&&(this.g.D=O,y=this.h,y!==null&&O in y&&(y=this.h,O in y&&delete y[O])),this.j=new mt(this)}w(Re,Pt),Re.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Re.prototype.close=function(){hr(this.g)},Re.prototype.o=function(y){var O=this.g;if(typeof y=="string"){var q={};q.__data__=y,y=q}else this.u&&(q={},q.__data__=xn(y),y=q);O.i.push(new sc(O.Ya++,y)),O.G==3&&cs(O)},Re.prototype.N=function(){this.g.l=null,delete this.j,hr(this.g),delete this.g,Re.aa.N.call(this)};function He(y){ni.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var O=y.__sm__;if(O){e:{for(const q in O){y=q;break e}y=void 0}(this.i=y)&&(y=this.i,O=O!==null&&y in O?O[y]:void 0),this.data=O}else this.data=y}w(He,ni);function rt(){Qn.call(this),this.status=1}w(rt,Qn);function mt(y){this.g=y}w(mt,me),mt.prototype.ua=function(){Lt(this.g,"a")},mt.prototype.ta=function(y){Lt(this.g,new He(y))},mt.prototype.sa=function(y){Lt(this.g,new rt)},mt.prototype.ra=function(){Lt(this.g,"b")},we.prototype.createWebChannel=we.prototype.g,Re.prototype.send=Re.prototype.o,Re.prototype.open=Re.prototype.m,Re.prototype.close=Re.prototype.close,Uk=function(){return new we},jk=function(){return zo()},Vk=Wt,cw={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ki.NO_ERROR=0,ki.TIMEOUT=8,ki.HTTP_ERROR=6,bv=ki,po.COMPLETE="complete",Bk=po,Jn.EventType=yr,yr.OPEN="a",yr.CLOSE="b",yr.ERROR="c",yr.MESSAGE="d",Pt.prototype.listen=Pt.prototype.K,zp=Jn,Mn.prototype.listenOnce=Mn.prototype.L,Mn.prototype.getLastError=Mn.prototype.Ka,Mn.prototype.getLastErrorCode=Mn.prototype.Ba,Mn.prototype.getStatus=Mn.prototype.Z,Mn.prototype.getResponseJson=Mn.prototype.Oa,Mn.prototype.getResponseText=Mn.prototype.oa,Mn.prototype.send=Mn.prototype.ea,Mn.prototype.setWithCredentials=Mn.prototype.Ha,Ok=Mn}).apply(typeof rv<"u"?rv:typeof self<"u"?self:typeof window<"u"?window:{});const _A="@firebase/firestore",EA="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Do.UNAUTHENTICATED=new Do(null),Do.GOOGLE_CREDENTIALS=new Do("google-credentials-uid"),Do.FIRST_PARTY=new Do("first-party-uid"),Do.MOCK_USER=new Do("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lp="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xf=new mx("@firebase/firestore");function cd(){return xf.logLevel}function St(n,...e){if(xf.logLevel<=An.DEBUG){const t=e.map(Ix);xf.debug(`Firestore (${lp}): ${n}`,...t)}}function Yl(n,...e){if(xf.logLevel<=An.ERROR){const t=e.map(Ix);xf.error(`Firestore (${lp}): ${n}`,...t)}}function yh(n,...e){if(xf.logLevel<=An.WARN){const t=e.map(Ix);xf.warn(`Firestore (${lp}): ${n}`,...t)}}function Ix(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,zk(n,r,t)}function zk(n,e,t){let r=`FIRESTORE (${lp}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Yl(r),new Error(r)}function Rr(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||zk(e,i,r)}function Pn(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qt extends rc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class VH{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Do.UNAUTHENTICATED)))}shutdown(){}}class jH{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class UH{constructor(e){this.t=e,this.currentUser=Do.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Rr(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let o=new Md;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Md,e.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const u=o;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},a=u=>{St("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((u=>a(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(St("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Md)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(St("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Rr(typeof r.accessToken=="string",31837,{l:r}),new Wk(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Rr(e===null||typeof e=="string",2055,{h:e}),new Do(e)}}class zH{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Do.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class WH{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new zH(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Do.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class SA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qH{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,fu(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Rr(this.o===void 0,3512);const r=o=>{o.error!=null&&St("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.m;return this.m=o.token,St("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>r(o)))};const i=o=>{St("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):St("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new SA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Rr(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new SA(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HH(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=HH(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}}function wn(n,e){return n<e?-1:n>e?1:0}function hw(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return wn(r,i);{const o=qk(),s=GH(o.encode(AA(n,t)),o.encode(AA(e,t)));return s!==0?s:wn(r,i)}}t+=r>65535?2:1}return wn(n.length,e.length)}function AA(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function GH(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return wn(n[t],e[t]);return wn(n.length,e.length)}function Xd(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA="__name__";class Hu{constructor(e,t,r){t===void 0?t=0:t>e.length&&fn(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&fn(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Hu.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hu?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const o=Hu.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return wn(e.length,t.length)}static compareSegments(e,t){const r=Hu.isNumericId(e),i=Hu.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Hu.extractNumericId(e).compare(Hu.extractNumericId(t)):hw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return uh.fromString(e.substring(4,e.length-2))}}class kr extends Hu{construct(e,t,r){return new kr(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new qt(vt.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new kr(t)}static emptyPath(){return new kr([])}}const $H=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rs extends Hu{construct(e,t,r){return new rs(e,t,r)}static isValidIdentifier(e){return $H.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===CA}static keyField(){return new rs([CA])}static fromServerFormat(e){const t=[];let r="",i=0;const o=()=>{if(r.length===0)throw new qt(vt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let s=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new qt(vt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new qt(vt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new qt(vt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rs(t)}static emptyPath(){return new rs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.path=e}static fromPath(e){return new Zt(kr.fromString(e))}static fromName(e){return new Zt(kr.fromString(e).popFirst(5))}static empty(){return new Zt(kr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&kr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return kr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Zt(new kr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KH(n,e,t){if(!t)throw new qt(vt.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function XH(n,e,t,r){if(e===!0&&r===!0)throw new qt(vt.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function IA(n){if(Zt.isDocumentKey(n))throw new qt(vt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function YH(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function JH(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":fn(12329,{type:typeof n})}function xv(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new qt(vt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=JH(n);throw new qt(vt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(n,e){const t={typeString:n};return e&&(t.value=e),t}function Km(n,e){if(!YH(n))throw new qt(vt.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const s=n[r];if(i&&typeof s!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new qt(vt.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA=-62135596800,kA=1e6;class si{static now(){return si.fromMillis(Date.now())}static fromDate(e){return si.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*kA);return new si(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new qt(vt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new qt(vt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<TA)throw new qt(vt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new qt(vt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/kA}_compareTo(e){return this.seconds===e.seconds?wn(this.nanoseconds,e.nanoseconds):wn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:si._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Km(e,si._jsonSchema))return new si(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-TA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}si._jsonSchemaVersion="firestore/timestamp/1.0",si._jsonSchema={type:li("string",si._jsonSchemaVersion),seconds:li("number"),nanoseconds:li("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{static fromTimestamp(e){return new cn(e)}static min(){return new cn(new si(0,0))}static max(){return new cn(new si(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm=-1;function QH(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=cn.fromTimestamp(r===1e9?new si(t+1,0):new si(t,r));return new wh(i,Zt.empty(),e)}function ZH(n){return new wh(n.readTime,n.key,Sm)}class wh{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new wh(cn.min(),Zt.empty(),Sm)}static max(){return new wh(cn.max(),Zt.empty(),Sm)}}function eG(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Zt.comparator(n.documentKey,e.documentKey),t!==0?t:wn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tG="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nG{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K0(n){if(n.code!==vt.FAILED_PRECONDITION||n.message!==tG)throw n;St("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&fn(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new tt(((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof tt?t:tt.resolve(t)}catch(t){return tt.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):tt.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):tt.reject(t)}static resolve(e){return new tt(((t,r)=>{t(e)}))}static reject(e){return new tt(((t,r)=>{r(e)}))}static waitFor(e){return new tt(((t,r)=>{let i=0,o=0,s=!1;e.forEach((a=>{++i,a.next((()=>{++o,s&&o===i&&t()}),(u=>r(u)))})),s=!0,o===i&&t()}))}static or(e){let t=tt.resolve(!1);for(const r of e)t=t.next((i=>i?tt.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,o)=>{r.push(t.call(this,i,o))})),this.waitFor(r)}static mapArray(e,t){return new tt(((r,i)=>{const o=e.length,s=new Array(o);let a=0;for(let u=0;u<o;u++){const l=u;t(e[l]).next((h=>{s[l]=h,++a,a===o&&r(s)}),(h=>i(h)))}}))}static doWhile(e,t){return new tt(((r,i)=>{const o=()=>{e()===!0?t().next((()=>{o()}),i):r()};o()}))}}function rG(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function cp(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this._e(r),this.ae=r=>t.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}X0.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iG=-1;function Y0(n){return n==null}function fw(n){return n===0&&1/n==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gk="";function oG(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=NA(e)),e=sG(n.get(t),e);return NA(e)}function sG(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const o=n.charAt(i);switch(o){case"\0":t+="";break;case Gk:t+="";break;default:t+=o}}return t}function NA(n){return n+Gk+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PA(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Xm(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function aG(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,t){this.comparator=e,this.root=t||ao.EMPTY}insert(e,t){return new ti(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ao.BLACK,null,null))}remove(e){return new ti(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ao.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new iv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new iv(this.root,e,this.comparator,!1)}getReverseIterator(){return new iv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new iv(this.root,e,this.comparator,!0)}}class iv{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ao{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??ao.RED,this.left=i??ao.EMPTY,this.right=o??ao.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new ao(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ao.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ao.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ao.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ao.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fn(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fn(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw fn(27949);return e+(this.isRed()?0:1)}}ao.EMPTY=null,ao.RED=!0,ao.BLACK=!1;ao.EMPTY=new class{constructor(){this.size=0}get key(){throw fn(57766)}get value(){throw fn(16141)}get color(){throw fn(16727)}get left(){throw fn(29726)}get right(){throw fn(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new ao(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this.comparator=e,this.data=new ti(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new RA(this.data.getIterator())}getIteratorFrom(e){return new RA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Si)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Si(this.comparator);return t.data=e,t}}class RA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e){this.fields=e,e.sort(rs.comparator)}static empty(){return new Zc([])}unionWith(e){let t=new Si(rs.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Zc(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xd(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new $k("Invalid base64 string: "+o):o}})(e);return new co(t)}static fromUint8Array(e){const t=(function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o})(e);return new co(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return wn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}co.EMPTY_BYTE_STRING=new co("");const uG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bh(n){if(Rr(!!n,39018),typeof n=="string"){let e=0;const t=uG.exec(n);if(Rr(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Yr(n.seconds),nanos:Yr(n.nanos)}}function Yr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xh(n){return typeof n=="string"?co.fromBase64String(n):co.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk="server_timestamp",Xk="__type__",Yk="__previous_value__",Jk="__local_write_time__";function Tx(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[Xk])===null||t===void 0?void 0:t.stringValue)===Kk}function J0(n){const e=n.mapValue.fields[Yk];return Tx(e)?J0(e):e}function Am(n){const e=bh(n.mapValue.fields[Jk].timestampValue);return new si(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lG{constructor(e,t,r,i,o,s,a,u,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l,this.isUsingEmulator=h}}const h0="(default)";class Cm{constructor(e,t){this.projectId=e,this.database=t||h0}static empty(){return new Cm("","")}get isDefaultDatabase(){return this.database===h0}isEqual(e){return e instanceof Cm&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cG="__type__",hG="__max__",ov={mapValue:{}},fG="__vector__",dw="value";function _h(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Tx(n)?4:pG(n)?9007199254740991:dG(n)?10:11:fn(28295,{value:n})}function ll(n,e){if(n===e)return!0;const t=_h(n);if(t!==_h(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Am(n).isEqual(Am(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=bh(i.timestampValue),a=bh(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return xh(i.bytesValue).isEqual(xh(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return Yr(i.geoPointValue.latitude)===Yr(o.geoPointValue.latitude)&&Yr(i.geoPointValue.longitude)===Yr(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return Yr(i.integerValue)===Yr(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=Yr(i.doubleValue),a=Yr(o.doubleValue);return s===a?fw(s)===fw(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return Xd(n.arrayValue.values||[],e.arrayValue.values||[],ll);case 10:case 11:return(function(i,o){const s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(PA(s)!==PA(a))return!1;for(const u in s)if(s.hasOwnProperty(u)&&(a[u]===void 0||!ll(s[u],a[u])))return!1;return!0})(n,e);default:return fn(52216,{left:n})}}function Im(n,e){return(n.values||[]).find((t=>ll(t,e)))!==void 0}function Yd(n,e){if(n===e)return 0;const t=_h(n),r=_h(e);if(t!==r)return wn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return wn(n.booleanValue,e.booleanValue);case 2:return(function(o,s){const a=Yr(o.integerValue||o.doubleValue),u=Yr(s.integerValue||s.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1})(n,e);case 3:return DA(n.timestampValue,e.timestampValue);case 4:return DA(Am(n),Am(e));case 5:return hw(n.stringValue,e.stringValue);case 6:return(function(o,s){const a=xh(o),u=xh(s);return a.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){const a=o.split("/"),u=s.split("/");for(let l=0;l<a.length&&l<u.length;l++){const h=wn(a[l],u[l]);if(h!==0)return h}return wn(a.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){const a=wn(Yr(o.latitude),Yr(s.latitude));return a!==0?a:wn(Yr(o.longitude),Yr(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return LA(n.arrayValue,e.arrayValue);case 10:return(function(o,s){var a,u,l,h;const d=o.fields||{},p=s.fields||{},m=(a=d[dw])===null||a===void 0?void 0:a.arrayValue,w=(u=p[dw])===null||u===void 0?void 0:u.arrayValue,b=wn(((l=m==null?void 0:m.values)===null||l===void 0?void 0:l.length)||0,((h=w==null?void 0:w.values)===null||h===void 0?void 0:h.length)||0);return b!==0?b:LA(m,w)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===ov.mapValue&&s===ov.mapValue)return 0;if(o===ov.mapValue)return 1;if(s===ov.mapValue)return-1;const a=o.fields||{},u=Object.keys(a),l=s.fields||{},h=Object.keys(l);u.sort(),h.sort();for(let d=0;d<u.length&&d<h.length;++d){const p=hw(u[d],h[d]);if(p!==0)return p;const m=Yd(a[u[d]],l[h[d]]);if(m!==0)return m}return wn(u.length,h.length)})(n.mapValue,e.mapValue);default:throw fn(23264,{le:t})}}function DA(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return wn(n,e);const t=bh(n),r=bh(e),i=wn(t.seconds,r.seconds);return i!==0?i:wn(t.nanos,r.nanos)}function LA(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const o=Yd(t[i],r[i]);if(o)return o}return wn(t.length,r.length)}function Jd(n){return pw(n)}function pw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=bh(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return xh(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Zt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const o of t.values||[])i?i=!1:r+=",",r+=pw(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const s of r)o?o=!1:i+=",",i+=`${s}:${pw(t.fields[s])}`;return i+"}"})(n.mapValue):fn(61005,{value:n})}function _v(n){switch(_h(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=J0(n);return e?16+_v(e):16;case 5:return 2*n.stringValue.length;case 6:return xh(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,o)=>i+_v(o)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Xm(r.fields,((o,s)=>{i+=o.length+_v(s)})),i})(n.mapValue);default:throw fn(13486,{value:n})}}function mw(n){return!!n&&"integerValue"in n}function kx(n){return!!n&&"arrayValue"in n}function MA(n){return!!n&&"nullValue"in n}function FA(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Zy(n){return!!n&&"mapValue"in n}function dG(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[cG])===null||t===void 0?void 0:t.stringValue)===fG}function nm(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Xm(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=nm(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=nm(n.arrayValue.values[t]);return e}return Object.assign({},n)}function pG(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===hG}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e){this.value=e}static empty(){return new Xu({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Zy(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=nm(t)}setAll(e){let t=rs.emptyPath(),r={},i=[];e.forEach(((s,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=nm(s):i.push(a.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){const t=this.field(e.popLast());Zy(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ll(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Zy(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Xm(t,((i,o)=>e[i]=o));for(const i of r)delete e[i]}clone(){return new Xu(nm(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new Mo(e,0,cn.min(),cn.min(),cn.min(),Xu.empty(),0)}static newFoundDocument(e,t,r,i){return new Mo(e,1,t,cn.min(),r,i,0)}static newNoDocument(e,t){return new Mo(e,2,t,cn.min(),cn.min(),Xu.empty(),0)}static newUnknownDocument(e,t){return new Mo(e,3,t,cn.min(),cn.min(),Xu.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(cn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xu.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xu.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=cn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Mo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Mo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e,t){this.position=e,this.inclusive=t}}function OA(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const o=e[i],s=n.position[i];if(o.field.isKeyField()?r=Zt.comparator(Zt.fromName(s.referenceValue),t.key):r=Yd(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function BA(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ll(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e,t="asc"){this.field=e,this.dir=t}}function mG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{}class xi extends Qk{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new vG(e,t,r):t==="array-contains"?new bG(e,r):t==="in"?new xG(e,r):t==="not-in"?new _G(e,r):t==="array-contains-any"?new EG(e,r):new xi(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new yG(e,r):new wG(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yd(t,this.value)):t!==null&&_h(this.value)===_h(t)&&this.matchesComparison(Yd(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fn(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class cl extends Qk{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new cl(e,t)}matches(e){return Zk(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function Zk(n){return n.op==="and"}function eN(n){return gG(n)&&Zk(n)}function gG(n){for(const e of n.filters)if(e instanceof cl)return!1;return!0}function gw(n){if(n instanceof xi)return n.field.canonicalString()+n.op.toString()+Jd(n.value);if(eN(n))return n.filters.map((e=>gw(e))).join(",");{const e=n.filters.map((t=>gw(t))).join(",");return`${n.op}(${e})`}}function tN(n,e){return n instanceof xi?(function(r,i){return i instanceof xi&&r.op===i.op&&r.field.isEqual(i.field)&&ll(r.value,i.value)})(n,e):n instanceof cl?(function(r,i){return i instanceof cl&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((o,s,a)=>o&&tN(s,i.filters[a])),!0):!1})(n,e):void fn(19439)}function nN(n){return n instanceof xi?(function(t){return`${t.field.canonicalString()} ${t.op} ${Jd(t.value)}`})(n):n instanceof cl?(function(t){return t.op.toString()+" {"+t.getFilters().map(nN).join(" ,")+"}"})(n):"Filter"}class vG extends xi{constructor(e,t,r){super(e,t,r),this.key=Zt.fromName(r.referenceValue)}matches(e){const t=Zt.comparator(e.key,this.key);return this.matchesComparison(t)}}class yG extends xi{constructor(e,t){super(e,"in",t),this.keys=rN("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class wG extends xi{constructor(e,t){super(e,"not-in",t),this.keys=rN("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function rN(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((r=>Zt.fromName(r.referenceValue)))}class bG extends xi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return kx(t)&&Im(t.arrayValue,this.value)}}class xG extends xi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Im(this.value.arrayValue,t)}}class _G extends xi{constructor(e,t){super(e,"not-in",t)}matches(e){if(Im(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Im(this.value.arrayValue,t)}}class EG extends xi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!kx(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Im(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SG{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.Pe=null}}function VA(n,e=null,t=[],r=[],i=null,o=null,s=null){return new SG(n,e,t,r,i,o,s)}function Nx(n){const e=Pn(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>gw(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),Y0(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Jd(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Jd(r))).join(",")),e.Pe=t}return e.Pe}function Px(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!mG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!tN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!BA(n.startAt,e.startAt)&&BA(n.endAt,e.endAt)}function vw(n){return Zt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function AG(n,e,t,r,i,o,s,a){return new Q0(n,e,t,r,i,o,s,a)}function Rx(n){return new Q0(n)}function jA(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function CG(n){return n.collectionGroup!==null}function rm(n){const e=Pn(n);if(e.Te===null){e.Te=[];const t=new Set;for(const o of e.explicitOrderBy)e.Te.push(o),t.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Si(rs.comparator);return s.filters.forEach((u=>{u.getFlattenedFilters().forEach((l=>{l.isInequality()&&(a=a.add(l.field))}))})),a})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Te.push(new d0(o,r))})),t.has(rs.keyField().canonicalString())||e.Te.push(new d0(rs.keyField(),r))}return e.Te}function al(n){const e=Pn(n);return e.Ie||(e.Ie=IG(e,rm(n))),e.Ie}function IG(n,e){if(n.limitType==="F")return VA(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new d0(i.field,o)}));const t=n.endAt?new f0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new f0(n.startAt.position,n.startAt.inclusive):null;return VA(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function yw(n,e,t){return new Q0(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Z0(n,e){return Px(al(n),al(e))&&n.limitType===e.limitType}function iN(n){return`${Nx(al(n))}|lt:${n.limitType}`}function hd(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>nN(i))).join(", ")}]`),Y0(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Jd(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Jd(i))).join(",")),`Target(${r})`})(al(n))}; limitType=${n.limitType})`}function e1(n,e){return e.isFoundDocument()&&(function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):Zt.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(const o of rm(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(s,a,u){const l=OA(s,a,u);return s.inclusive?l<=0:l<0})(r.startAt,rm(r),i)||r.endAt&&!(function(s,a,u){const l=OA(s,a,u);return s.inclusive?l>=0:l>0})(r.endAt,rm(r),i))})(n,e)}function TG(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function oN(n){return(e,t)=>{let r=!1;for(const i of rm(n)){const o=kG(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function kG(n,e,t){const r=n.field.isKeyField()?Zt.comparator(e.key,t.key):(function(o,s,a){const u=s.data.field(o),l=a.data.field(o);return u!==null&&l!==null?Yd(u,l):fn(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return fn(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Xm(this.inner,((t,r)=>{for(const[i,o]of r)e(i,o)}))}isEmpty(){return aG(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NG=new ti(Zt.comparator);function Eh(){return NG}const sN=new ti(Zt.comparator);function Wp(...n){let e=sN;for(const t of n)e=e.insert(t.key,t);return e}function PG(n){let e=sN;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function lf(){return im()}function aN(){return im()}function im(){return new Nf((n=>n.toString()),((n,e)=>n.isEqual(e)))}const RG=new Si(Zt.comparator);function Ln(...n){let e=RG;for(const t of n)e=e.add(t);return e}const DG=new Si(wn);function LG(){return DG}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MG(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fw(e)?"-0":e}}function FG(n){return{integerValue:""+n}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(){this._=void 0}}function OG(n,e,t){return n instanceof ww?(function(i,o){const s={fields:{[Xk]:{stringValue:Kk},[Jk]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Tx(o)&&(o=J0(o)),o&&(s.fields[Yk]=o),{mapValue:s}})(t,e):n instanceof p0?uN(n,e):n instanceof m0?lN(n,e):(function(i,o){const s=VG(i,o),a=UA(s)+UA(i.Ee);return mw(s)&&mw(i.Ee)?FG(a):MG(i.serializer,a)})(n,e)}function BG(n,e,t){return n instanceof p0?uN(n,e):n instanceof m0?lN(n,e):t}function VG(n,e){return n instanceof bw?(function(r){return mw(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}class ww extends t1{}class p0 extends t1{constructor(e){super(),this.elements=e}}function uN(n,e){const t=cN(e);for(const r of n.elements)t.some((i=>ll(i,r)))||t.push(r);return{arrayValue:{values:t}}}class m0 extends t1{constructor(e){super(),this.elements=e}}function lN(n,e){let t=cN(e);for(const r of n.elements)t=t.filter((i=>!ll(i,r)));return{arrayValue:{values:t}}}class bw extends t1{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function UA(n){return Yr(n.integerValue||n.doubleValue)}function cN(n){return kx(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function jG(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof p0&&i instanceof p0||r instanceof m0&&i instanceof m0?Xd(r.elements,i.elements,ll):r instanceof bw&&i instanceof bw?ll(r.Ee,i.Ee):r instanceof ww&&i instanceof ww})(n.transform,e.transform)}class pf{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new pf}static exists(e){return new pf(void 0,e)}static updateTime(e){return new pf(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ev(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Dx{}function hN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new zG(n.key,pf.none()):new Lx(n.key,n.data,pf.none());{const t=n.data,r=Xu.empty();let i=new Si(rs.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new n1(n.key,r,new Zc(i.toArray()),pf.none())}}function UG(n,e,t){n instanceof Lx?(function(i,o,s){const a=i.value.clone(),u=WA(i.fieldTransforms,o,s.transformResults);a.setAll(u),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof n1?(function(i,o,s){if(!Ev(i.precondition,o))return void o.convertToUnknownDocument(s.version);const a=WA(i.fieldTransforms,o,s.transformResults),u=o.data;u.setAll(fN(i)),u.setAll(a),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()})(n,e,t):(function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function om(n,e,t,r){return n instanceof Lx?(function(o,s,a,u){if(!Ev(o.precondition,s))return a;const l=o.value.clone(),h=qA(o.fieldTransforms,u,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null})(n,e,t,r):n instanceof n1?(function(o,s,a,u){if(!Ev(o.precondition,s))return a;const l=qA(o.fieldTransforms,u,s),h=s.data;return h.setAll(fN(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((d=>d.field)))})(n,e,t,r):(function(o,s,a){return Ev(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function zA(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Xd(r,i,((o,s)=>jG(o,s)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Lx extends Dx{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class n1 extends Dx{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function fN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function WA(n,e,t){const r=new Map;Rr(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){const o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,BG(s,a,t[i]))}return r}function qA(n,e,t){const r=new Map;for(const i of n){const o=i.transform,s=t.data.field(i.field);r.set(i.field,OG(o,s,e))}return r}class zG extends Dx{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WG{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&UG(o,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=om(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=om(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=aN();return this.mutations.forEach((i=>{const o=e.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;const u=hN(s,a);u!==null&&r.set(i.key,u),s.isValidDocument()||s.convertToNoDocument(cn.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ln())}isEqual(e){return this.batchId===e.batchId&&Xd(this.mutations,e.mutations,((t,r)=>zA(t,r)))&&Xd(this.baseMutations,e.baseMutations,((t,r)=>zA(t,r)))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qG{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HG{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oi,kn;function dN(n){if(n===void 0)return Yl("GRPC error has no .code"),vt.UNKNOWN;switch(n){case oi.OK:return vt.OK;case oi.CANCELLED:return vt.CANCELLED;case oi.UNKNOWN:return vt.UNKNOWN;case oi.DEADLINE_EXCEEDED:return vt.DEADLINE_EXCEEDED;case oi.RESOURCE_EXHAUSTED:return vt.RESOURCE_EXHAUSTED;case oi.INTERNAL:return vt.INTERNAL;case oi.UNAVAILABLE:return vt.UNAVAILABLE;case oi.UNAUTHENTICATED:return vt.UNAUTHENTICATED;case oi.INVALID_ARGUMENT:return vt.INVALID_ARGUMENT;case oi.NOT_FOUND:return vt.NOT_FOUND;case oi.ALREADY_EXISTS:return vt.ALREADY_EXISTS;case oi.PERMISSION_DENIED:return vt.PERMISSION_DENIED;case oi.FAILED_PRECONDITION:return vt.FAILED_PRECONDITION;case oi.ABORTED:return vt.ABORTED;case oi.OUT_OF_RANGE:return vt.OUT_OF_RANGE;case oi.UNIMPLEMENTED:return vt.UNIMPLEMENTED;case oi.DATA_LOSS:return vt.DATA_LOSS;default:return fn(39323,{code:n})}}(kn=oi||(oi={}))[kn.OK=0]="OK",kn[kn.CANCELLED=1]="CANCELLED",kn[kn.UNKNOWN=2]="UNKNOWN",kn[kn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kn[kn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kn[kn.NOT_FOUND=5]="NOT_FOUND",kn[kn.ALREADY_EXISTS=6]="ALREADY_EXISTS",kn[kn.PERMISSION_DENIED=7]="PERMISSION_DENIED",kn[kn.UNAUTHENTICATED=16]="UNAUTHENTICATED",kn[kn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kn[kn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kn[kn.ABORTED=10]="ABORTED",kn[kn.OUT_OF_RANGE=11]="OUT_OF_RANGE",kn[kn.UNIMPLEMENTED=12]="UNIMPLEMENTED",kn[kn.INTERNAL=13]="INTERNAL",kn[kn.UNAVAILABLE=14]="UNAVAILABLE",kn[kn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GG=new uh([4294967295,4294967295],0);function HA(n){const e=qk().encode(n),t=new Fk;return t.update(e),new Uint8Array(t.digest())}function GA(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new uh([t,r],0),new uh([i,o],0)]}class Mx{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new qp(`Invalid padding: ${t}`);if(r<0)throw new qp(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new qp(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new qp(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=uh.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(uh.fromNumber(r)));return i.compare(GG)===1&&(i=new uh([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=HA(e),[r,i]=GA(t);for(let o=0;o<this.hashCount;o++){const s=this.pe(r,i,o);if(!this.ye(s))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new Mx(o,i,t);return r.forEach((a=>s.insert(a))),s}insert(e){if(this.fe===0)return;const t=HA(e),[r,i]=GA(t);for(let o=0;o<this.hashCount;o++){const s=this.pe(r,i,o);this.we(s)}}we(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class qp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Ym.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new r1(cn.min(),i,new ti(wn),Eh(),Ln())}}class Ym{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ym(r,t,Ln(),Ln(),Ln())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}}class pN{constructor(e,t){this.targetId=e,this.De=t}}class mN{constructor(e,t,r=co.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class $A{constructor(){this.ve=0,this.Ce=KA(),this.Fe=co.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ln(),t=Ln(),r=Ln();return this.Ce.forEach(((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:fn(38017,{changeType:o})}})),new Ym(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=KA()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Rr(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class $G{constructor(e){this.We=e,this.Ge=new Map,this.ze=Eh(),this.je=sv(),this.Je=sv(),this.He=new ti(wn)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:fn(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((r,i)=>{this.nt(i)&&t(i)}))}it(e){const t=e.targetId,r=e.De.count,i=this.st(t);if(i){const o=i.target;if(vw(o))if(r===0){const s=new Zt(o.path);this.Xe(t,s,Mo.newNoDocument(s,cn.min()))}else Rr(r===1,20013,{expectedCount:r});else{const s=this.ot(t);if(s!==r){const a=this._t(e),u=a?this.ut(a,e,s):1;if(u!==0){this.rt(t);const l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,l)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t;let s,a;try{s=xh(r).toUint8Array()}catch(u){if(u instanceof $k)return yh("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Mx(s,i,o)}catch(u){return yh(u instanceof qp?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.fe===0?null:a}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){const r=this.We.getRemoteKeysForTarget(t);let i=0;return r.forEach((o=>{const s=this.We.lt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,o,null),i++)})),i}Pt(e){const t=new Map;this.Ge.forEach(((o,s)=>{const a=this.st(s);if(a){if(o.current&&vw(a.target)){const u=new Zt(a.target.path);this.Tt(u).has(s)||this.It(s,u)||this.Xe(s,u,Mo.newNoDocument(u,e))}o.Ne&&(t.set(s,o.Le()),o.ke())}}));let r=Ln();this.Je.forEach(((o,s)=>{let a=!0;s.forEachWhile((u=>{const l=this.st(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(r=r.add(o))})),this.ze.forEach(((o,s)=>s.setReadTime(e)));const i=new r1(e,t,this.He,this.ze,r);return this.ze=Eh(),this.je=sv(),this.Je=sv(),this.He=new ti(wn),i}Ze(e,t){if(!this.nt(e))return;const r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;const i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new $A,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Si(wn),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Si(wn),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||St("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new $A),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function sv(){return new ti(Zt.comparator)}function KA(){return new ti(Zt.comparator)}const KG={asc:"ASCENDING",desc:"DESCENDING"},XG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},YG={and:"AND",or:"OR"};class JG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function xw(n,e){return n.useProto3Json||Y0(e)?e:{value:e}}function QG(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ZG(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Fd(n){return Rr(!!n,49232),cn.fromTimestamp((function(t){const r=bh(t);return new si(r.seconds,r.nanos)})(n))}function e$(n,e){return _w(n,e).canonicalString()}function _w(n,e){const t=(function(i){return new kr(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function gN(n){const e=kr.fromString(n);return Rr(xN(e),10190,{key:e.toString()}),e}function e2(n,e){const t=gN(e);if(t.get(1)!==n.databaseId.projectId)throw new qt(vt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new qt(vt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Zt(yN(t))}function vN(n,e){return e$(n.databaseId,e)}function t$(n){const e=gN(n);return e.length===4?kr.emptyPath():yN(e)}function XA(n){return new kr(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yN(n){return Rr(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function n$(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:fn(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(l,h){return l.useProto3Json?(Rr(h===void 0||typeof h=="string",58123),co.fromBase64String(h||"")):(Rr(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),co.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(l){const h=l.code===void 0?vt.UNKNOWN:dN(l.code);return new qt(h,l.message||"")})(s);t=new mN(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=e2(n,r.document.name),o=Fd(r.document.updateTime),s=r.document.createTime?Fd(r.document.createTime):cn.min(),a=new Xu({mapValue:{fields:r.document.fields}}),u=Mo.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new Sv(l,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=e2(n,r.document),o=r.readTime?Fd(r.readTime):cn.min(),s=Mo.newNoDocument(i,o),a=r.removedTargetIds||[];t=new Sv([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=e2(n,r.document),o=r.removedTargetIds||[];t=new Sv([],o,i,null)}else{if(!("filter"in e))return fn(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,s=new HG(i,o),a=r.targetId;t=new pN(a,s)}}return t}function r$(n,e){return{documents:[vN(n,e.path)]}}function i$(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=vN(n,i);const o=(function(l){if(l.length!==0)return bN(cl.create(l,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const s=(function(l){if(l.length!==0)return l.map((h=>(function(p){return{field:fd(p.field),direction:a$(p.dir)}})(h)))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=xw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{Vt:t,parent:i}}function o$(n){let e=t$(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Rr(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=(function(d){const p=wN(d);return p instanceof cl&&eN(p)?p.getFilters():[p]})(t.where));let s=[];t.orderBy&&(s=(function(d){return d.map((p=>(function(w){return new d0(dd(w.field),(function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(p)))})(t.orderBy));let a=null;t.limit&&(a=(function(d){let p;return p=typeof d=="object"?d.value:d,Y0(p)?null:p})(t.limit));let u=null;t.startAt&&(u=(function(d){const p=!!d.before,m=d.values||[];return new f0(m,p)})(t.startAt));let l=null;return t.endAt&&(l=(function(d){const p=!d.before,m=d.values||[];return new f0(m,p)})(t.endAt)),AG(e,i,s,o,a,"F",u,l)}function s$(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fn(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function wN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=dd(t.unaryFilter.field);return xi.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=dd(t.unaryFilter.field);return xi.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=dd(t.unaryFilter.field);return xi.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=dd(t.unaryFilter.field);return xi.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fn(61313);default:return fn(60726)}})(n):n.fieldFilter!==void 0?(function(t){return xi.create(dd(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fn(58110);default:return fn(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return cl.create(t.compositeFilter.filters.map((r=>wN(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return fn(1026)}})(t.compositeFilter.op))})(n):fn(30097,{filter:n})}function a$(n){return KG[n]}function u$(n){return XG[n]}function l$(n){return YG[n]}function fd(n){return{fieldPath:n.canonicalString()}}function dd(n){return rs.fromServerFormat(n.fieldPath)}function bN(n){return n instanceof xi?(function(t){if(t.op==="=="){if(FA(t.value))return{unaryFilter:{field:fd(t.field),op:"IS_NAN"}};if(MA(t.value))return{unaryFilter:{field:fd(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(FA(t.value))return{unaryFilter:{field:fd(t.field),op:"IS_NOT_NAN"}};if(MA(t.value))return{unaryFilter:{field:fd(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fd(t.field),op:u$(t.op),value:t.value}}})(n):n instanceof cl?(function(t){const r=t.getFilters().map((i=>bN(i)));return r.length===1?r[0]:{compositeFilter:{op:l$(t.op),filters:r}}})(n):fn(54877,{filter:n})}function xN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e,t,r,i,o=cn.min(),s=cn.min(),a=co.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new eh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new eh(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new eh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new eh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c${constructor(e){this.gt=e}}function h$(n){const e=o$({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?yw(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f${constructor(){this.Dn=new d$}addToCollectionParentIndex(e,t){return this.Dn.add(t),tt.resolve()}getCollectionParents(e,t){return tt.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return tt.resolve()}deleteFieldIndex(e,t){return tt.resolve()}deleteAllFieldIndexes(e){return tt.resolve()}createTargetIndexes(e,t){return tt.resolve()}getDocumentsMatchingTarget(e,t){return tt.resolve(null)}getIndexType(e,t){return tt.resolve(0)}getFieldIndexes(e,t){return tt.resolve([])}getNextCollectionGroupToUpdate(e){return tt.resolve(null)}getMinOffset(e,t){return tt.resolve(wh.min())}getMinOffsetFromCollectionGroup(e,t){return tt.resolve(wh.min())}updateCollectionGroup(e,t,r){return tt.resolve()}updateIndexEntries(e,t){return tt.resolve()}}class d${constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Si(kr.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Si(kr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_N=41943040;class Es{static withCacheSize(e){return new Es(e,Es.DEFAULT_COLLECTION_PERCENTILE,Es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Es.DEFAULT_COLLECTION_PERCENTILE=10,Es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Es.DEFAULT=new Es(_N,Es.DEFAULT_COLLECTION_PERCENTILE,Es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Es.DISABLED=new Es(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Qd(0)}static ur(){return new Qd(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JA="LruGarbageCollector",p$=1048576;function QA([n,e],[t,r]){const i=wn(n,t);return i===0?wn(e,r):i}class m${constructor(e){this.Tr=e,this.buffer=new Si(QA),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();QA(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class g${constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){St(JA,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){cp(t)?St(JA,"Ignoring IndexedDB error during garbage collection: ",t):await K0(t)}await this.Rr(3e5)}))}}class v${constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return tt.resolve(X0.ue);const r=new m$(t);return this.Vr.forEachTarget(e,(i=>r.Er(i.sequenceNumber))).next((()=>this.Vr.gr(e,(i=>r.Er(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(St("LruGarbageCollector","Garbage collection skipped; disabled"),tt.resolve(YA)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(St("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),YA):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,o,s,a,u,l;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(St("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,s=Date.now(),this.nthSequenceNumber(e,i)))).next((d=>(r=d,a=Date.now(),this.removeTargets(e,r,t)))).next((d=>(o=d,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((d=>(l=Date.now(),cd()<=An.DEBUG&&St("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(l-u)+`ms
Total Duration: ${l-h}ms`),tt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:d}))))}}function y$(n,e){return new v$(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w${constructor(){this.changes=new Nf((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Mo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?tt.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b${constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x${constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&om(r.mutation,i,Zc.empty(),si.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Ln()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Ln()){const i=lf();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((o=>{let s=Wp();return o.forEach(((a,u)=>{s=s.insert(a,u.overlayedDocument)})),s}))))}getOverlayedDocuments(e,t){const r=lf();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Ln())))}populateOverlays(e,t,r){const i=[];return r.forEach((o=>{t.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(e,i).next((o=>{o.forEach(((s,a)=>{t.set(s,a)}))}))}computeViews(e,t,r,i){let o=Eh();const s=im(),a=(function(){return im()})();return t.forEach(((u,l)=>{const h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof n1)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),om(h.mutation,l,h.mutation.getFieldMask(),si.now())):s.set(l.key,Zc.empty())})),this.recalculateAndSaveOverlays(e,o).next((u=>(u.forEach(((l,h)=>s.set(l,h))),t.forEach(((l,h)=>{var d;return a.set(l,new b$(h,(d=s.get(l))!==null&&d!==void 0?d:null))})),a)))}recalculateAndSaveOverlays(e,t){const r=im();let i=new ti(((s,a)=>s-a)),o=Ln();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((s=>{for(const a of s)a.keys().forEach((u=>{const l=t.get(u);if(l===null)return;let h=r.get(u)||Zc.empty();h=a.applyToLocalView(l,h),r.set(u,h);const d=(i.get(a.batchId)||Ln()).add(u);i=i.insert(a.batchId,d)}))})).next((()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),l=u.key,h=u.value,d=aN();h.forEach((p=>{if(!o.has(p)){const m=hN(t.get(p),r.get(p));m!==null&&d.set(p,m),o=o.add(p)}})),s.push(this.documentOverlayCache.saveOverlays(e,l,d))}return tt.waitFor(s)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(s){return Zt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):CG(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):tt.resolve(lf());let a=Sm,u=o;return s.next((l=>tt.forEach(l,((h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),o.get(h)?tt.resolve():this.remoteDocumentCache.getEntry(e,h).next((p=>{u=u.insert(h,p)}))))).next((()=>this.populateOverlays(e,l,o))).next((()=>this.computeViews(e,u,l,Ln()))).next((h=>({batchId:a,changes:PG(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Zt(t)).next((r=>{let i=Wp();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const o=t.collectionGroup;let s=Wp();return this.indexManager.getCollectionParents(e,o).next((a=>tt.forEach(a,(u=>{const l=(function(d,p){return new Q0(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(t,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next((h=>{h.forEach(((d,p)=>{s=s.insert(d,p)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i)))).next((s=>{o.forEach(((u,l)=>{const h=l.getKey();s.get(h)===null&&(s=s.insert(h,Mo.newInvalidDocument(h)))}));let a=Wp();return s.forEach(((u,l)=>{const h=o.get(u);h!==void 0&&om(h.mutation,l,Zc.empty(),si.now()),e1(t,l)&&(a=a.insert(u,l))})),a}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _${constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return tt.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Fd(i.createTime)}})(t)),tt.resolve()}getNamedQuery(e,t){return tt.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:h$(i.bundledQuery),readTime:Fd(i.readTime)}})(t)),tt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E${constructor(){this.overlays=new ti(Zt.comparator),this.kr=new Map}getOverlay(e,t){return tt.resolve(this.overlays.get(t))}getOverlays(e,t){const r=lf();return tt.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&r.set(i,o)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,o)=>{this.wt(e,t,o)})),tt.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.kr.delete(r)),tt.resolve()}getOverlaysForCollection(e,t,r){const i=lf(),o=t.length+1,s=new Zt(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&u.largestBatchId>r&&i.set(u.getKey(),u)}return tt.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ti(((l,h)=>l-h));const s=this.overlays.getIterator();for(;s.hasNext();){const l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=lf(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const a=lf(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((l,h)=>a.set(l,h))),!(a.size()>=i)););return tt.resolve(a)}wt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const s=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new qG(t,r));let o=this.kr.get(t);o===void 0&&(o=Ln(),this.kr.set(t,o)),this.kr.set(t,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S${constructor(){this.sessionToken=co.EMPTY_BYTE_STRING}getSessionToken(e){return tt.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,tt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(){this.qr=new Si(zi.Qr),this.$r=new Si(zi.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const r=new zi(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new zi(e,t))}Gr(e,t){e.forEach((r=>this.removeReference(r,t)))}zr(e){const t=new Zt(new kr([])),r=new zi(t,e),i=new zi(t,e+1),o=[];return this.$r.forEachInRange([r,i],(s=>{this.Wr(s),o.push(s.key)})),o}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Zt(new kr([])),r=new zi(t,e),i=new zi(t,e+1);let o=Ln();return this.$r.forEachInRange([r,i],(s=>{o=o.add(s.key)})),o}containsKey(e){const t=new zi(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class zi{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Zt.comparator(e.key,t.key)||wn(e.Hr,t.Hr)}static Ur(e,t){return wn(e.Hr,t.Hr)||Zt.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A${constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Si(zi.Qr)}checkEmpty(e){return tt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new WG(o,t,r,i);this.mutationQueue.push(s);for(const a of i)this.Yr=this.Yr.add(new zi(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return tt.resolve(s)}lookupMutationBatch(e,t){return tt.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Xr(r),o=i<0?0:i;return tt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return tt.resolve(this.mutationQueue.length===0?iG:this.er-1)}getAllMutationBatches(e){return tt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new zi(t,0),i=new zi(t,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([r,i],(s=>{const a=this.Zr(s.Hr);o.push(a)})),tt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Si(wn);return t.forEach((i=>{const o=new zi(i,0),s=new zi(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,s],(a=>{r=r.add(a.Hr)}))})),tt.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let o=r;Zt.isDocumentKey(o)||(o=o.child(""));const s=new zi(new Zt(o),0);let a=new Si(wn);return this.Yr.forEachWhile((u=>{const l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.Hr)),!0)}),s),tt.resolve(this.ei(a))}ei(e){const t=[];return e.forEach((r=>{const i=this.Zr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Rr(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return tt.forEach(t.mutations,(i=>{const o=new zi(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Yr=r}))}rr(e){}containsKey(e,t){const r=new zi(t,0),i=this.Yr.firstAfterOrEqual(r);return tt.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,tt.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C${constructor(e){this.ni=e,this.docs=(function(){return new ti(Zt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return tt.resolve(r?r.document.mutableCopy():Mo.newInvalidDocument(t))}getEntries(e,t){let r=Eh();return t.forEach((i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Mo.newInvalidDocument(i))})),tt.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Eh();const s=t.path,a=new Zt(s.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:l,value:{document:h}}=u.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||eG(ZH(h),r)<=0||(i.has(h.key)||e1(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return tt.resolve(o)}getAllFromCollectionGroup(e,t,r,i){fn(9500)}ri(e,t){return tt.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new I$(this)}getSize(e){return tt.resolve(this.size)}}class I$ extends w${constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)})),tt.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T${constructor(e){this.persistence=e,this.ii=new Nf((t=>Nx(t)),Px),this.lastRemoteSnapshotVersion=cn.min(),this.highestTargetId=0,this.si=0,this.oi=new Fx,this.targetCount=0,this._i=Qd.ar()}forEachTarget(e,t){return this.ii.forEach(((r,i)=>t(i))),tt.resolve()}getLastRemoteSnapshotVersion(e){return tt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return tt.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),tt.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),tt.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new Qd(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,tt.resolve()}updateTargetData(e,t){return this.hr(t),tt.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,tt.resolve()}removeTargets(e,t,r){let i=0;const o=[];return this.ii.forEach(((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ii.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)})),tt.waitFor(o).next((()=>i))}getTargetCount(e){return tt.resolve(this.targetCount)}getTargetData(e,t){const r=this.ii.get(t)||null;return tt.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),tt.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach((s=>{o.push(i.markPotentiallyOrphaned(e,s))})),tt.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),tt.resolve()}getMatchingKeysForTargetId(e,t){const r=this.oi.Jr(t);return tt.resolve(r)}containsKey(e,t){return tt.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EN{constructor(e,t){this.ai={},this.overlays={},this.ui=new X0(0),this.ci=!1,this.ci=!0,this.li=new S$,this.referenceDelegate=e(this),this.hi=new T$(this),this.indexManager=new f$,this.remoteDocumentCache=(function(i){return new C$(i)})((r=>this.referenceDelegate.Pi(r))),this.serializer=new c$(t),this.Ti=new _$(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new E$,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new A$(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){St("MemoryPersistence","Starting transaction:",e);const i=new k$(this.ui.next());return this.referenceDelegate.Ii(),r(i).next((o=>this.referenceDelegate.di(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ei(e,t){return tt.or(Object.values(this.ai).map((r=>()=>r.containsKey(e,t))))}}class k$ extends nG{constructor(e){super(),this.currentSequenceNumber=e}}class Ox{constructor(e){this.persistence=e,this.Ai=new Fx,this.Ri=null}static Vi(e){return new Ox(e)}get mi(){if(this.Ri)return this.Ri;throw fn(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),tt.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),tt.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),tt.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((i=>this.mi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((o=>this.mi.add(o.toString())))})).next((()=>r.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return tt.forEach(this.mi,(r=>{const i=Zt.fromPath(r);return this.fi(e,i).next((o=>{o||t.removeEntry(i,cn.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return tt.or([()=>tt.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class g0{constructor(e,t){this.persistence=e,this.gi=new Nf((r=>oG(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=y$(this,t)}static Vi(e,t){return new g0(e,t)}Ii(){}di(e){return tt.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}yr(e){let t=0;return this.gr(e,(r=>{t++})).next((()=>t))}gr(e,t){return tt.forEach(this.gi,((r,i)=>this.Sr(e,r,i).next((o=>o?tt.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,(s=>this.Sr(e,s,t).next((a=>{a||(r++,o.removeEntry(s,cn.min()))})))).next((()=>o.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),tt.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),tt.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),tt.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),tt.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_v(e.data.value)),t}Sr(e,t,r){return tt.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.gi.get(t);return tt.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=Ln(),i=Ln();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new Bx(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N${constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P${constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return oz()?8:rG(Uo())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){const o={result:null};return this.ps(e,t).next((s=>{o.result=s})).next((()=>{if(!o.result)return this.ys(e,t,i,r).next((s=>{o.result=s}))})).next((()=>{if(o.result)return;const s=new N$;return this.ws(e,t,s).next((a=>{if(o.result=a,this.Rs)return this.Ss(e,t,s,a.size)}))})).next((()=>o.result))}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(cd()<=An.DEBUG&&St("QueryEngine","SDK will not create cache indexes for query:",hd(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),tt.resolve()):(cd()<=An.DEBUG&&St("QueryEngine","Query:",hd(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(cd()<=An.DEBUG&&St("QueryEngine","The SDK decides to create cache indexes for query:",hd(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,al(t))):tt.resolve())}ps(e,t){if(jA(t))return tt.resolve(null);let r=al(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=yw(t,null,"F"),r=al(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((o=>{const s=Ln(...o);return this.gs.getDocuments(e,s).next((a=>this.indexManager.getMinOffset(e,r).next((u=>{const l=this.bs(t,a);return this.Ds(t,l,s,u.readTime)?this.ps(e,yw(t,null,"F")):this.vs(e,l,t,u)}))))})))))}ys(e,t,r,i){return jA(t)||i.isEqual(cn.min())?tt.resolve(null):this.gs.getDocuments(e,r).next((o=>{const s=this.bs(t,o);return this.Ds(t,s,r,i)?tt.resolve(null):(cd()<=An.DEBUG&&St("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),hd(t)),this.vs(e,s,t,QH(i,Sm)).next((a=>a)))}))}bs(e,t){let r=new Si(oN(e));return t.forEach(((i,o)=>{e1(e,o)&&(r=r.add(o))})),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,t,r){return cd()<=An.DEBUG&&St("QueryEngine","Using full collection scan to execute query:",hd(t)),this.gs.getDocumentsMatchingQuery(e,t,wh.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next((o=>(t.forEach((s=>{o=o.insert(s.key,s)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx="LocalStore",R$=3e8;class D${constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new ti(wn),this.Ms=new Nf((o=>Nx(o)),Px),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new x$(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function L$(n,e,t,r){return new D$(n,e,t,r)}async function SN(n,e){const t=Pn(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((o=>(i=o,t.Ns(e),t.mutationQueue.getAllMutationBatches(r)))).next((o=>{const s=[],a=[];let u=Ln();for(const l of i){s.push(l.batchId);for(const h of l.mutations)u=u.add(h.key)}for(const l of o){a.push(l.batchId);for(const h of l.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((l=>({Bs:l,removedBatchIds:s,addedBatchIds:a})))}))}))}function AN(n){const e=Pn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function M$(n,e){const t=Pn(n),r=e.snapshotVersion;let i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const s=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;const a=[];e.targetChanges.forEach(((h,d)=>{const p=i.get(d);if(!p)return;a.push(t.hi.removeMatchingKeys(o,h.removedDocuments,d).next((()=>t.hi.addMatchingKeys(o,h.addedDocuments,d))));let m=p.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(d)!==null?m=m.withResumeToken(co.EMPTY_BYTE_STRING,cn.min()).withLastLimboFreeSnapshotVersion(cn.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,r)),i=i.insert(d,m),(function(b,x,E){return b.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=R$?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0})(p,m,h)&&a.push(t.hi.updateTargetData(o,m))}));let u=Eh(),l=Ln();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))})),a.push(F$(o,s,e.documentUpdates).next((h=>{u=h.Ls,l=h.ks}))),!r.isEqual(cn.min())){const h=t.hi.getLastRemoteSnapshotVersion(o).next((d=>t.hi.setTargetsMetadata(o,o.currentSequenceNumber,r)));a.push(h)}return tt.waitFor(a).next((()=>s.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,u,l))).next((()=>u))})).then((o=>(t.Fs=i,o)))}function F$(n,e,t){let r=Ln(),i=Ln();return t.forEach((o=>r=r.add(o))),e.getEntries(n,r).next((o=>{let s=Eh();return t.forEach(((a,u)=>{const l=o.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(cn.min())?(e.removeEntry(a,u.readTime),s=s.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),s=s.insert(a,u)):St(Vx,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)})),{Ls:s,ks:i}}))}function O$(n,e){const t=Pn(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.hi.getTargetData(r,e).next((o=>o?(i=o,tt.resolve(i)):t.hi.allocateTargetId(r).next((s=>(i=new eh(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r}))}async function Ew(n,e,t){const r=Pn(n),i=r.Fs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,(s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!cp(s))throw s;St(Vx,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function ZA(n,e,t){const r=Pn(n);let i=cn.min(),o=Ln();return r.persistence.runTransaction("Execute query","readwrite",(s=>(function(u,l,h){const d=Pn(u),p=d.Ms.get(h);return p!==void 0?tt.resolve(d.Fs.get(p)):d.hi.getTargetData(l,h)})(r,s,al(e)).next((a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(s,a.targetId).next((u=>{o=u}))})).next((()=>r.Cs.getDocumentsMatchingQuery(s,e,t?i:cn.min(),t?o:Ln()))).next((a=>(B$(r,TG(e),a),{documents:a,qs:o})))))}function B$(n,e,t){let r=n.xs.get(e)||cn.min();t.forEach(((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),n.xs.set(e,r)}class eC{constructor(){this.activeTargetIds=LG()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class V${constructor(){this.Fo=new eC,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new eC,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j${xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC="ConnectivityMonitor";class nC{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){St(tC,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){St(tC,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let av=null;function Sw(){return av===null?av=(function(){return 268435456+Math.round(2147483648*Math.random())})():av++,"0x"+av.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2="RestConnection",U$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class z${get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===h0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,o){const s=Sw(),a=this.Go(e,t.toUriEncodedString());St(t2,`Sending RPC '${e}' ${s}:`,a,r);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,i,o);const{host:l}=new URL(a),h=op(l);return this.jo(e,a,u,r,h).then((d=>(St(t2,`Received RPC '${e}' ${s}: `,d),d)),(d=>{throw yh(t2,`RPC '${e}' ${s} failed with error: `,d,"url: ",a,"request:",r),d}))}Jo(e,t,r,i,o,s){return this.Wo(e,t,r,i,o)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+lp})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,o)=>e[o]=i)),r&&r.headers.forEach(((i,o)=>e[o]=i))}Go(e,t){const r=U$[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W${constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No="WebChannelConnection";class q$ extends z${constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,o){const s=Sw();return new Promise(((a,u)=>{const l=new Ok;l.setWithCredentials(!0),l.listenOnce(Bk.COMPLETE,(()=>{try{switch(l.getLastErrorCode()){case bv.NO_ERROR:const d=l.getResponseJson();St(No,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),a(d);break;case bv.TIMEOUT:St(No,`RPC '${e}' ${s} timed out`),u(new qt(vt.DEADLINE_EXCEEDED,"Request time out"));break;case bv.HTTP_ERROR:const p=l.getStatus();if(St(No,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const w=m==null?void 0:m.error;if(w&&w.status&&w.message){const b=(function(E){const A=E.toLowerCase().replace(/_/g,"-");return Object.values(vt).indexOf(A)>=0?A:vt.UNKNOWN})(w.status);u(new qt(b,w.message))}else u(new qt(vt.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new qt(vt.UNAVAILABLE,"Connection failed."));break;default:fn(9055,{c_:e,streamId:s,l_:l.getLastErrorCode(),h_:l.getLastError()})}}finally{St(No,`RPC '${e}' ${s} completed.`)}}));const h=JSON.stringify(i);St(No,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",h,r,15)}))}P_(e,t,r){const i=Sw(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Uk(),a=jk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=o.join("");St(No,`Creating RPC '${e}' stream ${i}: ${h}`,u);const d=s.createWebChannel(h,u);this.T_(d);let p=!1,m=!1;const w=new W$({Ho:x=>{m?St(No,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(p||(St(No,`Opening RPC '${e}' stream ${i} transport.`),d.open(),p=!0),St(No,`RPC '${e}' stream ${i} sending:`,x),d.send(x))},Yo:()=>d.close()}),b=(x,E,A)=>{x.listen(E,(N=>{try{A(N)}catch(F){setTimeout((()=>{throw F}),0)}}))};return b(d,zp.EventType.OPEN,(()=>{m||(St(No,`RPC '${e}' stream ${i} transport opened.`),w.s_())})),b(d,zp.EventType.CLOSE,(()=>{m||(m=!0,St(No,`RPC '${e}' stream ${i} transport closed`),w.__(),this.I_(d))})),b(d,zp.EventType.ERROR,(x=>{m||(m=!0,yh(No,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),w.__(new qt(vt.UNAVAILABLE,"The operation could not be completed")))})),b(d,zp.EventType.MESSAGE,(x=>{var E;if(!m){const A=x.data[0];Rr(!!A,16349);const N=A,F=(N==null?void 0:N.error)||((E=N[0])===null||E===void 0?void 0:E.error);if(F){St(No,`RPC '${e}' stream ${i} received error:`,F);const D=F.status;let W=(function(L){const B=oi[L];if(B!==void 0)return dN(B)})(D),k=F.message;W===void 0&&(W=vt.INTERNAL,k="Unknown error status: "+D+" with message "+F.message),m=!0,w.__(new qt(W,k)),d.close()}else St(No,`RPC '${e}' stream ${i} received:`,A),w.a_(A)}})),b(a,Vk.STAT_EVENT,(x=>{x.stat===cw.PROXY?St(No,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===cw.NOPROXY&&St(No,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{w.o_()}),0),w}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function n2(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CN(n){return new JG(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&St("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC="PersistentStream";class H${constructor(e,t,r,i,o,s,a,u){this.Fi=e,this.w_=r,this.S_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new IN(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===vt.RESOURCE_EXHAUSTED?(Yl(t.toString()),Yl("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===vt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.b_===t&&this.W_(r,i)}),(r=>{e((()=>{const i=new qt(vt.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)}))}))}W_(e,t){const r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.e_((()=>{r((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((i=>{r((()=>this.G_(i)))})),this.stream.onMessage((i=>{r((()=>++this.C_==1?this.j_(i):this.onNext(i)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return St(rC,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(St(rC,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class G$ extends H${constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=n$(this.serializer,e),r=(function(o){if(!("targetChange"in o))return cn.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?cn.min():s.readTime?Fd(s.readTime):cn.min()})(e);return this.listener.J_(t,r)}H_(e){const t={};t.database=XA(this.serializer),t.addTarget=(function(o,s){let a;const u=s.target;if(a=vw(u)?{documents:r$(o,u)}:{query:i$(o,u).Vt},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=ZG(o,s.resumeToken);const l=xw(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(cn.min())>0){a.readTime=QG(o,s.snapshotVersion.toTimestamp());const l=xw(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a})(this.serializer,e);const r=s$(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){const t={};t.database=XA(this.serializer),t.removeTarget=e,this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $${}class K$ extends $${constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new qt(vt.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,s])=>this.connection.Wo(e,_w(t,r),i,o,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===vt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new qt(vt.UNKNOWN,o.toString())}))}Jo(e,t,r,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Jo(e,_w(t,r),i,s,a,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===vt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new qt(vt.UNKNOWN,s.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class X${constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Yl(t),this._a=!1):St("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd="RemoteStore";class Y${constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo((s=>{r.enqueueAndForget((async()=>{Qm(this)&&(St(Zd,"Restarting streams for network reachability change."),await(async function(u){const l=Pn(u);l.Ia.add(4),await Jm(l),l.Aa.set("Unknown"),l.Ia.delete(4),await i1(l)})(this))}))})),this.Aa=new X$(r,i)}}async function i1(n){if(Qm(n))for(const e of n.da)await e(!0)}async function Jm(n){for(const e of n.da)await e(!1)}function TN(n,e){const t=Pn(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Wx(t)?zx(t):hp(t).x_()&&Ux(t,e))}function jx(n,e){const t=Pn(n),r=hp(t);t.Ta.delete(e),r.x_()&&kN(t,e),t.Ta.size===0&&(r.x_()?r.B_():Qm(t)&&t.Aa.set("Unknown"))}function Ux(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(cn.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}hp(n).H_(e)}function kN(n,e){n.Ra.$e(e),hp(n).Y_(e)}function zx(n){n.Ra=new $G({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),hp(n).start(),n.Aa.aa()}function Wx(n){return Qm(n)&&!hp(n).M_()&&n.Ta.size>0}function Qm(n){return Pn(n).Ia.size===0}function NN(n){n.Ra=void 0}async function J$(n){n.Aa.set("Online")}async function Q$(n){n.Ta.forEach(((e,t)=>{Ux(n,e)}))}async function Z$(n,e){NN(n),Wx(n)?(n.Aa.la(e),zx(n)):n.Aa.set("Unknown")}async function eK(n,e,t){if(n.Aa.set("Online"),e instanceof mN&&e.state===2&&e.cause)try{await(async function(i,o){const s=o.cause;for(const a of o.targetIds)i.Ta.has(a)&&(await i.remoteSyncer.rejectListen(a,s),i.Ta.delete(a),i.Ra.removeTarget(a))})(n,e)}catch(r){St(Zd,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await iC(n,r)}else if(e instanceof Sv?n.Ra.Ye(e):e instanceof pN?n.Ra.it(e):n.Ra.et(e),!t.isEqual(cn.min()))try{const r=await AN(n.localStore);t.compareTo(r)>=0&&await(function(o,s){const a=o.Ra.Pt(s);return a.targetChanges.forEach(((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const h=o.Ta.get(l);h&&o.Ta.set(l,h.withResumeToken(u.resumeToken,s))}})),a.targetMismatches.forEach(((u,l)=>{const h=o.Ta.get(u);if(!h)return;o.Ta.set(u,h.withResumeToken(co.EMPTY_BYTE_STRING,h.snapshotVersion)),kN(o,u);const d=new eh(h.target,u,l,h.sequenceNumber);Ux(o,d)})),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){St(Zd,"Failed to raise snapshot:",r),await iC(n,r)}}async function iC(n,e,t){if(!cp(e))throw e;n.Ia.add(1),await Jm(n),n.Aa.set("Offline"),t||(t=()=>AN(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{St(Zd,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await i1(n)}))}async function oC(n,e){const t=Pn(n);t.asyncQueue.verifyOperationInProgress(),St(Zd,"RemoteStore received new credentials");const r=Qm(t);t.Ia.add(3),await Jm(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await i1(t)}async function tK(n,e){const t=Pn(n);e?(t.Ia.delete(2),await i1(t)):e||(t.Ia.add(2),await Jm(t),t.Aa.set("Unknown"))}function hp(n){return n.Va||(n.Va=(function(t,r,i){const o=Pn(t);return o.ia(),new G$(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:J$.bind(null,n),e_:Q$.bind(null,n),n_:Z$.bind(null,n),J_:eK.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Wx(n)?zx(n):n.Aa.set("Unknown")):(await n.Va.stop(),NN(n))}))),n.Va}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Md,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((s=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){const s=Date.now()+r,a=new qx(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qt(vt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function PN(n,e){if(Yl("AsyncQueue",`${e}: ${n}`),cp(n))return new qt(vt.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{static emptySet(e){return new Od(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Zt.comparator(t.key,r.key):(t,r)=>Zt.comparator(t.key,r.key),this.keyedMap=Wp(),this.sortedSet=new ti(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Od)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Od;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(){this.fa=new ti(Zt.comparator)}track(e){const t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):fn(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,r)=>{e.push(r)})),e}}class ep{constructor(e,t,r,i,o,s,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){const s=[];return t.forEach((a=>{s.push({type:0,doc:a})})),new ep(e,t,Od.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Z0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nK{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class rK{constructor(){this.queries=aC(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){const i=Pn(t),o=i.queries;i.queries=aC(),o.forEach(((s,a)=>{for(const u of a.wa)u.onError(r)}))})(this,new qt(vt.ABORTED,"Firestore shutting down"))}}function aC(){return new Nf((n=>iN(n)),Z0)}async function iK(n,e){const t=Pn(n);let r=3;const i=e.query;let o=t.queries.get(i);o?!o.Sa()&&e.ba()&&(r=2):(o=new nK,r=e.ba()?0:1);try{switch(r){case 0:o.ya=await t.onListen(i,!0);break;case 1:o.ya=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(s){const a=PN(s,`Initialization of query '${hd(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.wa.push(e),e.va(t.onlineState),o.ya&&e.Ca(o.ya)&&Hx(t)}async function oK(n,e){const t=Pn(n),r=e.query;let i=3;const o=t.queries.get(r);if(o){const s=o.wa.indexOf(e);s>=0&&(o.wa.splice(s,1),o.wa.length===0?i=e.ba()?0:1:!o.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function sK(n,e){const t=Pn(n);let r=!1;for(const i of e){const o=i.query,s=t.queries.get(o);if(s){for(const a of s.wa)a.Ca(i)&&(r=!0);s.ya=i}}r&&Hx(t)}function aK(n,e,t){const r=Pn(n),i=r.queries.get(e);if(i)for(const o of i.wa)o.onError(t);r.queries.delete(e)}function Hx(n){n.Da.forEach((e=>{e.next()}))}var Aw,uC;(uC=Aw||(Aw={})).Fa="default",uC.Cache="cache";class uK{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new ep(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=ep.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Aw.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(e){this.key=e}}class DN{constructor(e){this.key=e}}class lK{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ln(),this.mutatedKeys=Ln(),this.Xa=oN(e),this.eu=new Od(this.Xa)}get tu(){return this.Ha}nu(e,t){const r=t?t.ru:new sC,i=t?t.eu:this.eu;let o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,d)=>{const p=i.get(h),m=e1(this.query,d)?d:null,w=!!p&&this.mutatedKeys.has(p.key),b=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let x=!1;p&&m?p.data.isEqual(m.data)?w!==b&&(r.track({type:3,doc:m}),x=!0):this.iu(p,m)||(r.track({type:2,doc:m}),x=!0,(u&&this.Xa(m,u)>0||l&&this.Xa(m,l)<0)&&(a=!0)):!p&&m?(r.track({type:0,doc:m}),x=!0):p&&!m&&(r.track({type:1,doc:p}),x=!0,(u||l)&&(a=!0)),x&&(m?(s=s.add(m),o=b?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))})),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{eu:s,ru:r,Ds:a,mutatedKeys:o}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const s=e.ru.pa();s.sort(((h,d)=>(function(m,w){const b=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fn(20277,{At:x})}};return b(m)-b(w)})(h.type,d.type)||this.Xa(h.doc,d.doc))),this.su(r),i=i!=null&&i;const a=t&&!i?this.ou():[],u=this.Za.size===0&&this.current&&!i?1:0,l=u!==this.Ya;return this.Ya=u,s.length!==0||l?{snapshot:new ep(this.query,e.eu,o,s,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new sC,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Ln(),this.eu.forEach((r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))}));const t=[];return e.forEach((r=>{this.Za.has(r)||t.push(new DN(r))})),this.Za.forEach((r=>{e.has(r)||t.push(new RN(r))})),t}uu(e){this.Ha=e.qs,this.Za=Ln();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return ep.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Gx="SyncEngine";class cK{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class hK{constructor(e){this.key=e,this.lu=!1}}class fK{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.hu={},this.Pu=new Nf((a=>iN(a)),Z0),this.Tu=new Map,this.Iu=new Set,this.du=new ti(Zt.comparator),this.Eu=new Map,this.Au=new Fx,this.Ru={},this.Vu=new Map,this.mu=Qd.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function dK(n,e,t=!0){const r=BN(n);let i;const o=r.Pu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.cu()):i=await LN(r,e,t,!0),i}async function pK(n,e){const t=BN(n);await LN(t,e,!0,!1)}async function LN(n,e,t,r){const i=await O$(n.localStore,al(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t);let a;return r&&(a=await mK(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&TN(n.remoteStore,i),a}async function mK(n,e,t,r,i){n.gu=(d,p,m)=>(async function(b,x,E,A){let N=x.view.nu(E);N.Ds&&(N=await ZA(b.localStore,x.query,!1).then((({documents:k})=>x.view.nu(k,N))));const F=A&&A.targetChanges.get(x.targetId),D=A&&A.targetMismatches.get(x.targetId)!=null,W=x.view.applyChanges(N,b.isPrimaryClient,F,D);return cC(b,x.targetId,W._u),W.snapshot})(n,d,p,m);const o=await ZA(n.localStore,e,!0),s=new lK(e,o.qs),a=s.nu(o.documents),u=Ym.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,u);cC(n,t,l._u);const h=new cK(e,t,s);return n.Pu.set(e,h),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),l.snapshot}async function gK(n,e,t){const r=Pn(n),i=r.Pu.get(e),o=r.Tu.get(i.targetId);if(o.length>1)return r.Tu.set(i.targetId,o.filter((s=>!Z0(s,e)))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ew(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&jx(r.remoteStore,i.targetId),Cw(r,i.targetId)})).catch(K0)):(Cw(r,i.targetId),await Ew(r.localStore,i.targetId,!0))}async function vK(n,e){const t=Pn(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),jx(t.remoteStore,r.targetId))}async function MN(n,e){const t=Pn(n);try{const r=await M$(t.localStore,e);e.targetChanges.forEach(((i,o)=>{const s=t.Eu.get(o);s&&(Rr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.lu=!0:i.modifiedDocuments.size>0?Rr(s.lu,14607):i.removedDocuments.size>0&&(Rr(s.lu,42227),s.lu=!1))})),await ON(t,r,e)}catch(r){await K0(r)}}function lC(n,e,t){const r=Pn(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Pu.forEach(((o,s)=>{const a=s.view.va(e);a.snapshot&&i.push(a.snapshot)})),(function(s,a){const u=Pn(s);u.onlineState=a;let l=!1;u.queries.forEach(((h,d)=>{for(const p of d.wa)p.va(a)&&(l=!0)})),l&&Hx(u)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function yK(n,e,t){const r=Pn(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Eu.get(e),o=i&&i.key;if(o){let s=new ti(Zt.comparator);s=s.insert(o,Mo.newNoDocument(o,cn.min()));const a=Ln().add(o),u=new r1(cn.min(),new Map,new ti(wn),s,a);await MN(r,u),r.du=r.du.remove(o),r.Eu.delete(e),$x(r)}else await Ew(r.localStore,e,!1).then((()=>Cw(r,e,t))).catch(K0)}function Cw(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((r=>{n.Au.containsKey(r)||FN(n,r)}))}function FN(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(jx(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),$x(n))}function cC(n,e,t){for(const r of t)r instanceof RN?(n.Au.addReference(r.key,e),wK(n,r)):r instanceof DN?(St(Gx,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||FN(n,r.key)):fn(19791,{yu:r})}function wK(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(St(Gx,"New document in limbo: "+t),n.Iu.add(r),$x(n))}function $x(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Zt(kr.fromString(e)),r=n.mu.next();n.Eu.set(r,new hK(t)),n.du=n.du.insert(t,r),TN(n.remoteStore,new eh(al(Rx(t.path)),r,"TargetPurposeLimboResolution",X0.ue))}}async function ON(n,e,t){const r=Pn(n),i=[],o=[],s=[];r.Pu.isEmpty()||(r.Pu.forEach(((a,u)=>{s.push(r.gu(u,e,t).then((l=>{var h;if((l||t)&&r.isPrimaryClient){const d=l?!l.fromCache:(h=t==null?void 0:t.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(l){i.push(l);const d=Bx.Es(u.targetId,l);o.push(d)}})))})),await Promise.all(s),r.hu.J_(i),await(async function(u,l){const h=Pn(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>tt.forEach(l,(p=>tt.forEach(p.Is,(m=>h.persistence.referenceDelegate.addReference(d,p.targetId,m))).next((()=>tt.forEach(p.ds,(m=>h.persistence.referenceDelegate.removeReference(d,p.targetId,m)))))))))}catch(d){if(!cp(d))throw d;St(Vx,"Failed to update sequence numbers: "+d)}for(const d of l){const p=d.targetId;if(!d.fromCache){const m=h.Fs.get(p),w=m.snapshotVersion,b=m.withLastLimboFreeSnapshotVersion(w);h.Fs=h.Fs.insert(p,b)}}})(r.localStore,o))}async function bK(n,e){const t=Pn(n);if(!t.currentUser.isEqual(e)){St(Gx,"User change. New user:",e.toKey());const r=await SN(t.localStore,e);t.currentUser=e,(function(o,s){o.Vu.forEach((a=>{a.forEach((u=>{u.reject(new qt(vt.CANCELLED,s))}))})),o.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ON(t,r.Bs)}}function xK(n,e){const t=Pn(n),r=t.Eu.get(e);if(r&&r.lu)return Ln().add(r.key);{let i=Ln();const o=t.Tu.get(e);if(!o)return i;for(const s of o){const a=t.Pu.get(s);i=i.unionWith(a.view.tu)}return i}}function BN(n){const e=Pn(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=MN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xK.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=yK.bind(null,e),e.hu.J_=sK.bind(null,e.eventManager),e.hu.pu=aK.bind(null,e.eventManager),e}class v0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=CN(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return L$(this.persistence,new P$,e.initialUser,this.serializer)}Du(e){return new EN(Ox.Vi,this.serializer)}bu(e){return new V$}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}v0.provider={build:()=>new v0};class _K extends v0{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Rr(this.persistence.referenceDelegate instanceof g0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new g$(r,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Es.withCacheSize(this.cacheSizeBytes):Es.DEFAULT;return new EN((r=>g0.Vi(r,t)),this.serializer)}}class Iw{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>lC(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=bK.bind(null,this.syncEngine),await tK(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new rK})()}createDatastore(e){const t=CN(e.databaseInfo.databaseId),r=(function(o){return new q$(o)})(e.databaseInfo);return(function(o,s,a,u){return new K$(o,s,a,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,o,s,a){return new Y$(r,i,o,s,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>lC(this.syncEngine,t,0)),(function(){return nC.C()?new nC:new j$})())}createSyncEngine(e,t){return(function(i,o,s,a,u,l,h){const d=new fK(i,o,s,a,u,l);return h&&(d.fu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const o=Pn(i);St(Zd,"RemoteStore shutting down."),o.Ia.add(5),await Jm(o),o.Ea.shutdown(),o.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Iw.provider={build:()=>new Iw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EK{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Yl("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh="FirestoreClient";class SK{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Do.UNAUTHENTICATED,this.clientId=Hk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async s=>{St(Sh,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,(s=>(St(Sh,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Md;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=PN(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function r2(n,e){n.asyncQueue.verifyOperationInProgress(),St(Sh,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await SN(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>{yh("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{St("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((i=>{yh("Terminating Firestore due to IndexedDb database deletion failed",i)}))})),n._offlineComponents=e}async function hC(n,e){n.asyncQueue.verifyOperationInProgress();const t=await AK(n);St(Sh,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>oC(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>oC(e.remoteStore,i))),n._onlineComponents=e}async function AK(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){St(Sh,"Using user provided OfflineComponentProvider");try{await r2(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===vt.FAILED_PRECONDITION||i.code===vt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;yh("Error using user provided cache. Falling back to memory cache: "+t),await r2(n,new v0)}}else St(Sh,"Using default OfflineComponentProvider"),await r2(n,new _K(void 0));return n._offlineComponents}async function CK(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(St(Sh,"Using user provided OnlineComponentProvider"),await hC(n,n._uninitializedComponentsProvider._online)):(St(Sh,"Using default OnlineComponentProvider"),await hC(n,new Iw))),n._onlineComponents}async function fC(n){const e=await CK(n),t=e.eventManager;return t.onListen=dK.bind(null,e.syncEngine),t.onUnlisten=gK.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=pK.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=vK.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VN(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN="firestore.googleapis.com",pC=!0;class mC{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new qt(vt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=jN,this.ssl=pC}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:pC;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=_N;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<p$)throw new qt(vt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}XH("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=VN((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new qt(vt.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new qt(vt.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new qt(vt.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kx{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mC({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new qt(vt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new qt(vt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mC(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new VH;switch(r.type){case"firstParty":return new WH(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new qt(vt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=dC.get(t);r&&(St("ComponentProvider","Removing Datastore"),dC.delete(t),r.terminate())})(this),Promise.resolve()}}function IK(n,e,t,r={}){var i;n=xv(n,Kx);const o=op(e),s=n._getSettings(),a=Object.assign(Object.assign({},s),{emulatorOptions:n._getEmulatorOptions()}),u=`${e}:${t}`;o&&(XT(`https://${u}`),YT("Firestore",!0)),s.host!==jN&&s.host!==u&&yh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},s),{host:u,ssl:o,emulatorOptions:r});if(!yf(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Do.MOCK_USER;else{h=YU(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new qt(vt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Do(p)}n._authCredentials=new jH(new Wk(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new o1(this.firestore,e,this._query)}}class ea{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ea(this.firestore,e,this._key)}toJSON(){return{type:ea._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Km(t,ea._jsonSchema))return new ea(e,r||null,new Zt(kr.fromString(t.referencePath)))}}ea._jsonSchemaVersion="firestore/documentReference/1.0",ea._jsonSchema={type:li("string",ea._jsonSchemaVersion),referencePath:li("string")};class Bd extends o1{constructor(e,t,r){super(e,t,Rx(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ea(this.firestore,null,new Zt(e))}withConverter(e){return new Bd(this.firestore,e,this._path)}}function gC(n,e,...t){if(n=Eu(n),KH("collection","path",e),n instanceof Kx){const r=kr.fromString(e,...t);return IA(r),new Bd(n,null,r)}{if(!(n instanceof ea||n instanceof Bd))throw new qt(vt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(kr.fromString(e,...t));return IA(r),new Bd(n.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC="AsyncQueue";class yC{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new IN(this,"async_queue_retry"),this.oc=()=>{const r=n2();r&&St(vC,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const t=n2();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=n2();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new Md;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!cp(e))throw e;St(vC,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((r=>{throw this.tc=r,this.nc=!1,Yl("INTERNAL UNHANDLED ERROR: ",wC(r)),r})).then((r=>(this.nc=!1,r))))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const i=qx.createAndSchedule(this,e,t,r,(o=>this.lc(o)));return this.ec.push(i),i}ac(){this.tc&&fn(47125,{hc:wC(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function wC(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const o of r)if(o in i&&typeof i[o]=="function")return!0;return!1})(n,["next","error","complete"])}class Tw extends Kx{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new yC,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new yC(e),this._firestoreClient=void 0,await e}}}function TK(n,e){const t=typeof n=="object"?n:ek(),r=typeof n=="string"?n:h0,i=vx(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const o=KU("firestore");o&&IK(i,...o)}return i}function kK(n){if(n._terminated)throw new qt(vt.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||NK(n),n._firestoreClient}function NK(n){var e,t,r;const i=n._freezeSettings(),o=(function(a,u,l,h){return new lG(a,u,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,VN(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new SK(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yu(co.fromBase64String(e))}catch(t){throw new qt(vt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Yu(co.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Yu._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Km(e,Yu._jsonSchema))return Yu.fromBase64String(e.bytes)}}Yu._jsonSchemaVersion="firestore/bytes/1.0",Yu._jsonSchema={type:li("string",Yu._jsonSchemaVersion),bytes:li("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new qt(vt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new qt(vt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new qt(vt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return wn(this._lat,e._lat)||wn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:lh._jsonSchemaVersion}}static fromJSON(e){if(Km(e,lh._jsonSchema))return new lh(e.latitude,e.longitude)}}lh._jsonSchemaVersion="firestore/geoPoint/1.0",lh._jsonSchema={type:li("string",lh._jsonSchemaVersion),latitude:li("number"),longitude:li("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ch._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Km(e,ch._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ch(e.vectorValues);throw new qt(vt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ch._jsonSchemaVersion="firestore/vectorValue/1.0",ch._jsonSchema={type:li("string",ch._jsonSchemaVersion),vectorValues:li("object")};const PK=new RegExp("[~\\*/\\[\\]]");function RK(n,e,t){if(e.search(PK)>=0)throw xC(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new UN(...e.split("."))._internalPath}catch{throw xC(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function xC(n,e,t,r,i){let o=`Function ${e}() called with invalid data`;o+=". ";let s="";return new qt(vt.INVALID_ARGUMENT,o+n+s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new ea(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new DK(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(WN("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class DK extends zN{data(){return super.data()}}function WN(n,e){return typeof e=="string"?RK(n,e):e instanceof UN?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LK(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new qt(vt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class MK{convertValue(e,t="none"){switch(_h(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Yr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xh(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw fn(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Xm(e,((i,o)=>{r[i]=this.convertValue(o,t)})),r}convertVectorValue(e){var t,r,i;const o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[dw].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map((s=>Yr(s.doubleValue)));return new ch(o)}convertGeoPoint(e){return new lh(Yr(e.latitude),Yr(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=J0(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Am(e));default:return null}}convertTimestamp(e){const t=bh(e);return new si(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=kr.fromString(e);Rr(xN(r),9688,{name:e});const i=new Cm(r.get(1),r.get(3)),o=new Zt(r.popFirst(5));return i.isEqual(t)||Yl(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}class Hp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class mf extends zN{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Av(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(WN("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new qt(vt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=mf._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}mf._jsonSchemaVersion="firestore/documentSnapshot/1.0",mf._jsonSchema={type:li("string",mf._jsonSchemaVersion),bundleSource:li("string","DocumentSnapshot"),bundleName:li("string"),bundle:li("string")};class Av extends mf{data(e={}){return super.data(e)}}class Vd{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Hp(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Av(this._firestore,this._userDataWriter,r.key,r,new Hp(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new qt(vt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map((a=>{const u=new Av(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Hp(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((a=>o||a.type!==3)).map((a=>{const u=new Av(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Hp(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:FK(a.type),doc:u,oldIndex:l,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new qt(vt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Vd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Hk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function FK(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fn(61501,{type:n})}}Vd._jsonSchemaVersion="firestore/querySnapshot/1.0",Vd._jsonSchema={type:li("string",Vd._jsonSchemaVersion),bundleSource:li("string","QuerySnapshot"),bundleName:li("string"),bundle:li("string")};class qN extends MK{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ea(this.firestore,null,t)}}function _C(n,...e){var t,r,i;n=Eu(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||bC(e[s])||(o=e[s++]);const a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(bC(e[s])){const d=e[s];e[s]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[s+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[s+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let u,l,h;if(n instanceof ea)l=xv(n.firestore,Tw),h=Rx(n._key.path),u={next:d=>{e[s]&&e[s](OK(l,n,d))},error:e[s+1],complete:e[s+2]};else{const d=xv(n,o1);l=xv(d.firestore,Tw),h=d._query;const p=new qN(l);u={next:m=>{e[s]&&e[s](new Vd(l,p,d,m))},error:e[s+1],complete:e[s+2]},LK(n._query)}return(function(p,m,w,b){const x=new EK(b),E=new uK(m,x,w);return p.asyncQueue.enqueueAndForget((async()=>iK(await fC(p),E))),()=>{x.Ou(),p.asyncQueue.enqueueAndForget((async()=>oK(await fC(p),E)))}})(kK(l),h,a,u)}function OK(n,e,t){const r=t.docs.get(e._key),i=new qN(n);return new mf(n,i,e._key,r,new Hp(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){lp=i})(sp),$d(new wf("firestore",((r,{instanceIdentifier:i,options:o})=>{const s=r.getProvider("app").getImmediate(),a=new Tw(new UH(r.getProvider("auth-internal")),new qH(s,r.getProvider("app-check-internal")),(function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new qt(vt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cm(l.options.projectId,h)})(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a}),"PUBLIC").setMultipleInstances(!0)),sh(_A,EA,e),sh(_A,EA,"esm2017")})();const BK={apiKey:"AIzaSyBwhzGsK-ah7ObMOgpRDlzGghycLNinm6g",authDomain:"tforce-guardian-system.firebaseapp.com",projectId:"tforce-guardian-system",storageBucket:"tforce-guardian-system.firebasestorage.app",messagingSenderId:"194168927826",appId:"1:194168927826:web:18073e1a188b8e4408118b"},HN=ZT(BK),i2=OH(HN),EC=TK(HN),VK=()=>{const{setActiveMode:n,playSound:e,speak:t}=vu(),[r,i]=qe.useState(null),[o,s]=qe.useState(!0),[a,u]=qe.useState("live"),[l,h]=qe.useState([]),[d,p]=qe.useState([]),[m,w]=qe.useState(""),[b,x]=qe.useState(""),[E,A]=qe.useState(""),N=qe.useRef(!1);qe.useEffect(()=>{const k=Aq(i2,C=>{i(C),s(!1),C&&!N.current&&(N.current=!0,setTimeout(()=>{t("Guardian uplink established.")},500))});return()=>k()},[]),qe.useEffect(()=>{if(!r||a!=="live")return;const k=_C(gC(EC,"locations"),C=>{const L=C.docs.map(M=>({id:M.id,...M.data()})),B=new Date,R=L.filter(M=>{if(!M.timestamp||!M.timestamp.toDate)return!1;const U=(B-M.timestamp.toDate())/1e3/60;return M.onDuty&&U<60});h(R)});return()=>k()},[r,a]),qe.useEffect(()=>{if(!r||a!=="logs")return;const k=_C(gC(EC,"scan_logs"),C=>{let L=C.docs.map(B=>({id:B.id,...B.data()}));L.sort((B,R)=>{var M,U;return(((M=R.timestamp)==null?void 0:M.seconds)||0)-(((U=B.timestamp)==null?void 0:U.seconds)||0)}),p(L.slice(0,50))});return()=>k()},[r,a]);const F=async k=>{k.preventDefault();try{await _q(i2,m,b)}catch(C){A("Access Denied: "+C.message),e("error")}},D=()=>{Cq(i2),e("click"),N.current=!1},W=k=>{if(!k||!k.toDate)return"PENDING...";try{return k.toDate().toLocaleTimeString()}catch{return"ERR"}};return ae.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up font-mono",children:[ae.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-red-600/30",children:[ae.jsxs("div",{className:"flex items-center gap-3",children:[ae.jsx("i",{className:"fas fa-shield-alt text-red-600 text-xl animate-pulse"}),ae.jsx("h2",{className:"text-red-600 font-bold text-xl tracking-widest",children:"GUARDIAN COMMAND"})]}),ae.jsx("button",{onClick:()=>{e("click"),n("HOME")},className:"text-red-600 hover:text-white",children:ae.jsx("i",{className:"fas fa-times text-2xl"})})]}),ae.jsx("div",{className:"flex-1 overflow-y-auto p-6 no-scrollbar",children:o?ae.jsx("div",{className:"text-center text-red-600 mt-20 animate-pulse",children:"ESTABLISHING SECURE CONNECTION..."}):r?ae.jsxs(ae.Fragment,{children:[ae.jsxs("div",{className:"flex gap-4 mb-6 border-b border-white/10 pb-4",children:[ae.jsx("button",{onClick:()=>u("live"),className:`px-4 py-2 border ${a==="live"?"border-red-600 bg-red-600/20 text-red-500":"border-gray-700 text-gray-500"}`,children:"ACTIVE UNITS"}),ae.jsx("button",{onClick:()=>u("logs"),className:`px-4 py-2 border ${a==="logs"?"border-red-600 bg-red-600/20 text-red-500":"border-gray-700 text-gray-500"}`,children:"SCAN LOGS"}),ae.jsx("button",{onClick:D,className:"ml-auto text-xs text-gray-500 hover:text-white",children:"SIGN OUT"})]}),a==="live"&&ae.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.length===0&&ae.jsx("div",{className:"col-span-full text-center text-gray-500",children:"NO ACTIVE UNITS DETECTED"}),l.map(k=>{var C,L;return ae.jsxs("div",{className:"border border-white/20 border-l-4 border-l-green-500 p-4 bg-white/5",children:[ae.jsxs("div",{className:"flex justify-between items-start",children:[ae.jsx("h3",{className:"font-bold text-lg text-white",children:k.username}),ae.jsx("span",{className:"text-green-500 text-xs font-bold animate-pulse",children:" ON DUTY"})]}),ae.jsxs("div",{className:"text-gray-400 text-xs mt-1",children:["LAST SIGNAL: ",W(k.timestamp)]}),ae.jsxs("div",{className:"bg-black p-2 mt-3 font-mono text-xs text-red-400 border border-white/10 flex justify-between items-center",children:[ae.jsxs("span",{children:[(C=k.latitude)==null?void 0:C.toFixed(4),", ",(L=k.longitude)==null?void 0:L.toFixed(4)]}),ae.jsxs("a",{href:`http://googleusercontent.com/maps.google.com/6{u.latitude},${k.longitude}`,target:"_blank",rel:"noreferrer",className:"text-white hover:text-red-500",children:[ae.jsx("i",{className:"fas fa-map-marker-alt"})," MAP"]})]})]},k.id)})]}),a==="logs"&&ae.jsxs("div",{className:"space-y-2",children:[ae.jsx("div",{className:"flex justify-between items-center mb-2",children:ae.jsx("span",{className:"text-xs text-gray-500",children:"RECENT ACTIVITY"})}),d.map(k=>ae.jsxs("div",{className:"border-b border-white/10 p-3 flex justify-between items-center hover:bg-white/5",children:[ae.jsxs("div",{children:[ae.jsx("div",{className:"font-bold text-white text-sm",children:k.username}),ae.jsx("div",{className:"text-gray-500 text-xs",children:W(k.timestamp)})]}),ae.jsx("div",{className:"text-right",children:ae.jsx("div",{className:"text-red-400 text-sm",children:k.checkpointData||"SCAN"})})]},k.id))]})]}):ae.jsxs("div",{className:"max-w-sm mx-auto mt-10 p-6 border border-red-600/50 rounded bg-red-900/10",children:[ae.jsx("h3",{className:"text-red-600 text-center text-lg font-bold mb-6",children:"RESTRICTED ACCESS"}),ae.jsxs("form",{onSubmit:F,className:"flex flex-col gap-4",children:[ae.jsx("input",{type:"email",placeholder:"OFFICER EMAIL",value:m,onChange:k=>w(k.target.value),className:"bg-black border border-red-600/30 p-3 text-white outline-none focus:border-red-600"}),ae.jsx("input",{type:"password",placeholder:"ACCESS CODE",value:b,onChange:k=>x(k.target.value),className:"bg-black border border-red-600/30 p-3 text-white outline-none focus:border-red-600"}),E&&ae.jsx("div",{className:"text-xs text-red-500 text-center",children:E}),ae.jsx("button",{type:"submit",className:"bg-red-600 text-white font-bold py-3 hover:bg-red-700 transition-all",children:"AUTHENTICATE"})]})]})})]})},jK=()=>{const{systemStatus:n,setSystemStatus:e,playSound:t,speak:r,user:i,battery:o,isListening:s,toggleListening:a,activeMode:u,setActiveMode:l}=vu(),[h,d]=qe.useState(!1),[p,m]=qe.useState(!1),w=u==="MENU_OPEN"||u==="COMMS_MENU",b=()=>{t("startup"),d(!0),e("ONLINE"),setTimeout(()=>{r(`Welcome back, ${i.name}. System secure. Battery at ${o} percent.`)},1e3)};return h?ae.jsxs("div",{className:"relative w-screen h-screen bg-black overflow-hidden",children:[ae.jsx(LP,{}),u==="HOME"&&ae.jsx("div",{onClick:()=>{t("click"),l("MENU_OPEN")},className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-48 h-48 rounded-full z-10 cursor-pointer"}),ae.jsxs("div",{className:"absolute top-0 left-0 w-full p-4 flex justify-between items-start z-20 pointer-events-none",children:[ae.jsxs("div",{className:"text-cyan-dim font-mono text-xs",children:[ae.jsx("div",{className:"border-b border-cyan w-20 mb-1",children:"T-FORCE"}),ae.jsxs("div",{children:["OP: ",i.name.toUpperCase()]}),ae.jsxs("div",{children:["ACC: ",i.access.toUpperCase()]})]}),ae.jsxs("div",{className:"text-right",children:[ae.jsxs("div",{className:`text-xl font-orbitron font-bold ${o<20?"text-red-500":"text-cyan"}`,children:[o,"%"]}),ae.jsx("div",{className:"text-cyan-dim font-mono text-[10px]",children:"PWR LEVEL"})]})]}),(u==="HOME"||u==="MENU_OPEN"||u==="COMMS_MENU")&&ae.jsx("div",{className:"absolute bottom-24 left-1/2 transform -translate-x-1/2 z-20",children:ae.jsx("button",{onClick:a,className:`
              w-16 h-16 rounded-full border border-cyan flex items-center justify-center
              transition-all duration-300 backdrop-blur-sm
              ${s?"bg-red-500/20 shadow-[0_0_30px_rgba(255,0,0,0.5)] border-red-500 scale-110":"bg-black/50 hover:bg-cyan/20 shadow-[0_0_15px_rgba(0,229,255,0.3)]"}
            `,children:ae.jsx("i",{className:`fas fa-microphone text-2xl ${s?"text-red-500 animate-pulse":"text-cyan"}`})})}),ae.jsxs("div",{className:"absolute bottom-8 w-full text-center z-20 pointer-events-none",children:[ae.jsx("div",{className:"text-cyan font-orbitron tracking-[4px] text-sm animate-pulse",children:n}),ae.jsx("div",{className:"text-cyan-dim text-[10px] mt-1 font-mono",children:s?"LISTENING...":u.includes("MENU")?"AWAITING SELECTION":u})]}),ae.jsx(lM,{isOpen:w,onClose:()=>l("HOME"),onOpenSettings:()=>{l("HOME"),m(!0)}}),p&&ae.jsx(MP,{onClose:()=>m(!1)}),u==="VISION"&&ae.jsx(P9,{}),u==="MEDIA"&&ae.jsx(F9,{}),u==="DATABASE"&&ae.jsx(O9,{}),u==="HUD"&&ae.jsx(B9,{}),u==="OPS"&&ae.jsx(BU,{}),u==="RECON"&&ae.jsx(VU,{}),u==="GUARDIAN"&&ae.jsx(VK,{})]}):ae.jsxs("div",{onClick:b,className:"w-screen h-screen bg-black flex flex-col items-center justify-center cursor-pointer select-none",children:[ae.jsx("div",{className:"text-cyan text-6xl animate-pulse mb-4",children:ae.jsx("i",{className:"fas fa-fingerprint"})}),ae.jsx("div",{className:"text-cyan font-orbitron font-bold text-xl tracking-widest",children:"INITIALIZE JARVIS"}),ae.jsx("div",{className:"text-cyan-dim font-mono text-xs mt-2",children:"TOUCH TO AUTHENTICATE"})]})};function UK(){return ae.jsx(DP,{children:ae.jsx(jK,{})})}RP.createRoot(document.getElementById("root")).render(ae.jsx(qe.StrictMode,{children:ae.jsx(UK,{})}));export{tr as _};
