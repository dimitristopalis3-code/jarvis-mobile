var vD=Object.defineProperty;var yD=(n,e,t)=>e in n?vD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var hr=(n,e,t)=>yD(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var cy={exports:{}},Op={},hy={exports:{}},Pn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T5;function wD(){if(T5)return Pn;T5=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;function m(Q){return Q===null||typeof Q!="object"?null:(Q=d&&Q[d]||Q["@@iterator"],typeof Q=="function"?Q:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function x(Q,W,J){this.props=Q,this.context=W,this.refs=b,this.updater=J||p}x.prototype.isReactComponent={},x.prototype.setState=function(Q,W){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,W,"setState")},x.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function E(){}E.prototype=x.prototype;function T(Q,W,J){this.props=Q,this.context=W,this.refs=b,this.updater=J||p}var P=T.prototype=new E;P.constructor=T,y(P,x.prototype),P.isPureReactComponent=!0;var C=Array.isArray,D=Object.prototype.hasOwnProperty,z={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function I(Q,W,J){var te,de={},ve=null,we=null;if(W!=null)for(te in W.ref!==void 0&&(we=W.ref),W.key!==void 0&&(ve=""+W.key),W)D.call(W,te)&&!L.hasOwnProperty(te)&&(de[te]=W[te]);var Se=arguments.length-2;if(Se===1)de.children=J;else if(1<Se){for(var Ie=Array(Se),Fe=0;Fe<Se;Fe++)Ie[Fe]=arguments[Fe+2];de.children=Ie}if(Q&&Q.defaultProps)for(te in Se=Q.defaultProps,Se)de[te]===void 0&&(de[te]=Se[te]);return{$$typeof:n,type:Q,key:ve,ref:we,props:de,_owner:z.current}}function A(Q,W){return{$$typeof:n,type:Q.type,key:W,ref:Q.ref,props:Q.props,_owner:Q._owner}}function O(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===n}function k(Q){var W={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(J){return W[J]})}var M=/\/+/g;function j(Q,W){return typeof Q=="object"&&Q!==null&&Q.key!=null?k(""+Q.key):W.toString(36)}function X(Q,W,J,te,de){var ve=typeof Q;(ve==="undefined"||ve==="boolean")&&(Q=null);var we=!1;if(Q===null)we=!0;else switch(ve){case"string":case"number":we=!0;break;case"object":switch(Q.$$typeof){case n:case e:we=!0}}if(we)return we=Q,de=de(we),Q=te===""?"."+j(we,0):te,C(de)?(J="",Q!=null&&(J=Q.replace(M,"$&/")+"/"),X(de,W,J,"",function(Fe){return Fe})):de!=null&&(O(de)&&(de=A(de,J+(!de.key||we&&we.key===de.key?"":(""+de.key).replace(M,"$&/")+"/")+Q)),W.push(de)),1;if(we=0,te=te===""?".":te+":",C(Q))for(var Se=0;Se<Q.length;Se++){ve=Q[Se];var Ie=te+j(ve,Se);we+=X(ve,W,J,Ie,de)}else if(Ie=m(Q),typeof Ie=="function")for(Q=Ie.call(Q),Se=0;!(ve=Q.next()).done;)ve=ve.value,Ie=te+j(ve,Se++),we+=X(ve,W,J,Ie,de);else if(ve==="object")throw W=String(Q),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.");return we}function ue(Q,W,J){if(Q==null)return Q;var te=[],de=0;return X(Q,te,"","",function(ve){return W.call(J,ve,de++)}),te}function ge(Q){if(Q._status===-1){var W=Q._result;W=W(),W.then(function(J){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=J)},function(J){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=J)}),Q._status===-1&&(Q._status=0,Q._result=W)}if(Q._status===1)return Q._result.default;throw Q._result}var ce={current:null},$={transition:null},ae={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:$,ReactCurrentOwner:z};function fe(){throw Error("act(...) is not supported in production builds of React.")}return Pn.Children={map:ue,forEach:function(Q,W,J){ue(Q,function(){W.apply(this,arguments)},J)},count:function(Q){var W=0;return ue(Q,function(){W++}),W},toArray:function(Q){return ue(Q,function(W){return W})||[]},only:function(Q){if(!O(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},Pn.Component=x,Pn.Fragment=t,Pn.Profiler=i,Pn.PureComponent=T,Pn.StrictMode=r,Pn.Suspense=u,Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ae,Pn.act=fe,Pn.cloneElement=function(Q,W,J){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var te=y({},Q.props),de=Q.key,ve=Q.ref,we=Q._owner;if(W!=null){if(W.ref!==void 0&&(ve=W.ref,we=z.current),W.key!==void 0&&(de=""+W.key),Q.type&&Q.type.defaultProps)var Se=Q.type.defaultProps;for(Ie in W)D.call(W,Ie)&&!L.hasOwnProperty(Ie)&&(te[Ie]=W[Ie]===void 0&&Se!==void 0?Se[Ie]:W[Ie])}var Ie=arguments.length-2;if(Ie===1)te.children=J;else if(1<Ie){Se=Array(Ie);for(var Fe=0;Fe<Ie;Fe++)Se[Fe]=arguments[Fe+2];te.children=Se}return{$$typeof:n,type:Q.type,key:de,ref:ve,props:te,_owner:we}},Pn.createContext=function(Q){return Q={$$typeof:s,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:o,_context:Q},Q.Consumer=Q},Pn.createElement=I,Pn.createFactory=function(Q){var W=I.bind(null,Q);return W.type=Q,W},Pn.createRef=function(){return{current:null}},Pn.forwardRef=function(Q){return{$$typeof:a,render:Q}},Pn.isValidElement=O,Pn.lazy=function(Q){return{$$typeof:h,_payload:{_status:-1,_result:Q},_init:ge}},Pn.memo=function(Q,W){return{$$typeof:l,type:Q,compare:W===void 0?null:W}},Pn.startTransition=function(Q){var W=$.transition;$.transition={};try{Q()}finally{$.transition=W}},Pn.unstable_act=fe,Pn.useCallback=function(Q,W){return ce.current.useCallback(Q,W)},Pn.useContext=function(Q){return ce.current.useContext(Q)},Pn.useDebugValue=function(){},Pn.useDeferredValue=function(Q){return ce.current.useDeferredValue(Q)},Pn.useEffect=function(Q,W){return ce.current.useEffect(Q,W)},Pn.useId=function(){return ce.current.useId()},Pn.useImperativeHandle=function(Q,W,J){return ce.current.useImperativeHandle(Q,W,J)},Pn.useInsertionEffect=function(Q,W){return ce.current.useInsertionEffect(Q,W)},Pn.useLayoutEffect=function(Q,W){return ce.current.useLayoutEffect(Q,W)},Pn.useMemo=function(Q,W){return ce.current.useMemo(Q,W)},Pn.useReducer=function(Q,W,J){return ce.current.useReducer(Q,W,J)},Pn.useRef=function(Q){return ce.current.useRef(Q)},Pn.useState=function(Q){return ce.current.useState(Q)},Pn.useSyncExternalStore=function(Q,W,J){return ce.current.useSyncExternalStore(Q,W,J)},Pn.useTransition=function(){return ce.current.useTransition()},Pn.version="18.3.1",Pn}var k5;function sb(){return k5||(k5=1,hy.exports=wD()),hy.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N5;function bD(){if(N5)return Op;N5=1;var n=sb(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function s(a,u,l){var h,d={},m=null,p=null;l!==void 0&&(m=""+l),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(p=u.ref);for(h in u)r.call(u,h)&&!o.hasOwnProperty(h)&&(d[h]=u[h]);if(a&&a.defaultProps)for(h in u=a.defaultProps,u)d[h]===void 0&&(d[h]=u[h]);return{$$typeof:e,type:a,key:m,ref:p,props:d,_owner:i.current}}return Op.Fragment=t,Op.jsx=s,Op.jsxs=s,Op}var R5;function xD(){return R5||(R5=1,cy.exports=bD()),cy.exports}var oe=xD(),Ke=sb(),Wg={},fy={exports:{}},js={},dy={exports:{}},py={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P5;function _D(){return P5||(P5=1,(function(n){function e($,ae){var fe=$.length;$.push(ae);e:for(;0<fe;){var Q=fe-1>>>1,W=$[Q];if(0<i(W,ae))$[Q]=ae,$[fe]=W,fe=Q;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var ae=$[0],fe=$.pop();if(fe!==ae){$[0]=fe;e:for(var Q=0,W=$.length,J=W>>>1;Q<J;){var te=2*(Q+1)-1,de=$[te],ve=te+1,we=$[ve];if(0>i(de,fe))ve<W&&0>i(we,de)?($[Q]=we,$[ve]=fe,Q=ve):($[Q]=de,$[te]=fe,Q=te);else if(ve<W&&0>i(we,fe))$[Q]=we,$[ve]=fe,Q=ve;else break e}}return ae}function i($,ae){var fe=$.sortIndex-ae.sortIndex;return fe!==0?fe:$.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();n.unstable_now=function(){return s.now()-a}}var u=[],l=[],h=1,d=null,m=3,p=!1,y=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P($){for(var ae=t(l);ae!==null;){if(ae.callback===null)r(l);else if(ae.startTime<=$)r(l),ae.sortIndex=ae.expirationTime,e(u,ae);else break;ae=t(l)}}function C($){if(b=!1,P($),!y)if(t(u)!==null)y=!0,ge(D);else{var ae=t(l);ae!==null&&ce(C,ae.startTime-$)}}function D($,ae){y=!1,b&&(b=!1,E(I),I=-1),p=!0;var fe=m;try{for(P(ae),d=t(u);d!==null&&(!(d.expirationTime>ae)||$&&!k());){var Q=d.callback;if(typeof Q=="function"){d.callback=null,m=d.priorityLevel;var W=Q(d.expirationTime<=ae);ae=n.unstable_now(),typeof W=="function"?d.callback=W:d===t(u)&&r(u),P(ae)}else r(u);d=t(u)}if(d!==null)var J=!0;else{var te=t(l);te!==null&&ce(C,te.startTime-ae),J=!1}return J}finally{d=null,m=fe,p=!1}}var z=!1,L=null,I=-1,A=5,O=-1;function k(){return!(n.unstable_now()-O<A)}function M(){if(L!==null){var $=n.unstable_now();O=$;var ae=!0;try{ae=L(!0,$)}finally{ae?j():(z=!1,L=null)}}else z=!1}var j;if(typeof T=="function")j=function(){T(M)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,ue=X.port2;X.port1.onmessage=M,j=function(){ue.postMessage(null)}}else j=function(){x(M,0)};function ge($){L=$,z||(z=!0,j())}function ce($,ae){I=x(function(){$(n.unstable_now())},ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){y||p||(y=!0,ge(D))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function($){switch(m){case 1:case 2:case 3:var ae=3;break;default:ae=m}var fe=m;m=ae;try{return $()}finally{m=fe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,ae){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var fe=m;m=$;try{return ae()}finally{m=fe}},n.unstable_scheduleCallback=function($,ae,fe){var Q=n.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Q+fe:Q):fe=Q,$){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=fe+W,$={id:h++,callback:ae,priorityLevel:$,startTime:fe,expirationTime:W,sortIndex:-1},fe>Q?($.sortIndex=fe,e(l,$),t(u)===null&&$===t(l)&&(b?(E(I),I=-1):b=!0,ce(C,fe-Q))):($.sortIndex=W,e(u,$),y||p||(y=!0,ge(D))),$},n.unstable_shouldYield=k,n.unstable_wrapCallback=function($){var ae=m;return function(){var fe=m;m=ae;try{return $.apply(this,arguments)}finally{m=fe}}}})(py)),py}var D5;function ED(){return D5||(D5=1,dy.exports=_D()),dy.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L5;function SD(){if(L5)return js;L5=1;var n=sb(),e=ED();function t(c){for(var f="https://reactjs.org/docs/error-decoder.html?invariant="+c,g=1;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function o(c,f){s(c,f),s(c+"Capture",f)}function s(c,f){for(i[c]=f,c=0;c<f.length;c++)r.add(f[c])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,l=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},d={};function m(c){return u.call(d,c)?!0:u.call(h,c)?!1:l.test(c)?d[c]=!0:(h[c]=!0,!1)}function p(c,f,g,_){if(g!==null&&g.type===0)return!1;switch(typeof f){case"function":case"symbol":return!0;case"boolean":return _?!1:g!==null?!g.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function y(c,f,g,_){if(f===null||typeof f>"u"||p(c,f,g,_))return!0;if(_)return!1;if(g!==null)switch(g.type){case 3:return!f;case 4:return f===!1;case 5:return isNaN(f);case 6:return isNaN(f)||1>f}return!1}function b(c,f,g,_,R,V,K){this.acceptsBooleans=f===2||f===3||f===4,this.attributeName=_,this.attributeNamespace=R,this.mustUseProperty=g,this.propertyName=c,this.type=f,this.sanitizeURL=V,this.removeEmptyString=K}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){x[c]=new b(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var f=c[0];x[f]=new b(f,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){x[c]=new b(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){x[c]=new b(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){x[c]=new b(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){x[c]=new b(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){x[c]=new b(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){x[c]=new b(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){x[c]=new b(c,5,!1,c.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function T(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var f=c.replace(E,T);x[f]=new b(f,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var f=c.replace(E,T);x[f]=new b(f,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var f=c.replace(E,T);x[f]=new b(f,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){x[c]=new b(c,1,!1,c.toLowerCase(),null,!1,!1)}),x.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){x[c]=new b(c,1,!1,c.toLowerCase(),null,!0,!0)});function P(c,f,g,_){var R=x.hasOwnProperty(f)?x[f]:null;(R!==null?R.type!==0:_||!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(y(f,g,R,_)&&(g=null),_||R===null?m(f)&&(g===null?c.removeAttribute(f):c.setAttribute(f,""+g)):R.mustUseProperty?c[R.propertyName]=g===null?R.type===3?!1:"":g:(f=R.attributeName,_=R.attributeNamespace,g===null?c.removeAttribute(f):(R=R.type,g=R===3||R===4&&g===!0?"":""+g,_?c.setAttributeNS(_,f,g):c.setAttribute(f,g))))}var C=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),z=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),k=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),ue=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),$=Symbol.iterator;function ae(c){return c===null||typeof c!="object"?null:(c=$&&c[$]||c["@@iterator"],typeof c=="function"?c:null)}var fe=Object.assign,Q;function W(c){if(Q===void 0)try{throw Error()}catch(g){var f=g.stack.trim().match(/\n( *(at )?)/);Q=f&&f[1]||""}return`
`+Q+c}var J=!1;function te(c,f){if(!c||J)return"";J=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(f)if(f=function(){throw Error()},Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(ze){var _=ze}Reflect.construct(c,[],f)}else{try{f.call()}catch(ze){_=ze}c.call(f.prototype)}else{try{throw Error()}catch(ze){_=ze}c()}}catch(ze){if(ze&&_&&typeof ze.stack=="string"){for(var R=ze.stack.split(`
`),V=_.stack.split(`
`),K=R.length-1,ye=V.length-1;1<=K&&0<=ye&&R[K]!==V[ye];)ye--;for(;1<=K&&0<=ye;K--,ye--)if(R[K]!==V[ye]){if(K!==1||ye!==1)do if(K--,ye--,0>ye||R[K]!==V[ye]){var Ee=`
`+R[K].replace(" at new "," at ");return c.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",c.displayName)),Ee}while(1<=K&&0<=ye);break}}}finally{J=!1,Error.prepareStackTrace=g}return(c=c?c.displayName||c.name:"")?W(c):""}function de(c){switch(c.tag){case 5:return W(c.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return c=te(c.type,!1),c;case 11:return c=te(c.type.render,!1),c;case 1:return c=te(c.type,!0),c;default:return""}}function ve(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case L:return"Fragment";case z:return"Portal";case A:return"Profiler";case I:return"StrictMode";case j:return"Suspense";case X:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case k:return(c.displayName||"Context")+".Consumer";case O:return(c._context.displayName||"Context")+".Provider";case M:var f=c.render;return c=c.displayName,c||(c=f.displayName||f.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case ue:return f=c.displayName||null,f!==null?f:ve(c.type)||"Memo";case ge:f=c._payload,c=c._init;try{return ve(c(f))}catch{}}return null}function we(c){var f=c.type;switch(c.tag){case 24:return"Cache";case 9:return(f.displayName||"Context")+".Consumer";case 10:return(f._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=f.render,c=c.displayName||c.name||"",f.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return f;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ve(f);case 8:return f===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f}return null}function Se(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function Ie(c){var f=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function Fe(c){var f=Ie(c)?"checked":"value",g=Object.getOwnPropertyDescriptor(c.constructor.prototype,f),_=""+c[f];if(!c.hasOwnProperty(f)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var R=g.get,V=g.set;return Object.defineProperty(c,f,{configurable:!0,get:function(){return R.call(this)},set:function(K){_=""+K,V.call(this,K)}}),Object.defineProperty(c,f,{enumerable:g.enumerable}),{getValue:function(){return _},setValue:function(K){_=""+K},stopTracking:function(){c._valueTracker=null,delete c[f]}}}}function Ae(c){c._valueTracker||(c._valueTracker=Fe(c))}function Be(c){if(!c)return!1;var f=c._valueTracker;if(!f)return!0;var g=f.getValue(),_="";return c&&(_=Ie(c)?c.checked?"true":"false":c.value),c=_,c!==g?(f.setValue(c),!0):!1}function Le(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function tt(c,f){var g=f.checked;return fe({},f,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??c._wrapperState.initialChecked})}function re(c,f){var g=f.defaultValue==null?"":f.defaultValue,_=f.checked!=null?f.checked:f.defaultChecked;g=Se(f.value!=null?f.value:g),c._wrapperState={initialChecked:_,initialValue:g,controlled:f.type==="checkbox"||f.type==="radio"?f.checked!=null:f.value!=null}}function rt(c,f){f=f.checked,f!=null&&P(c,"checked",f,!1)}function zt(c,f){rt(c,f);var g=Se(f.value),_=f.type;if(g!=null)_==="number"?(g===0&&c.value===""||c.value!=g)&&(c.value=""+g):c.value!==""+g&&(c.value=""+g);else if(_==="submit"||_==="reset"){c.removeAttribute("value");return}f.hasOwnProperty("value")?He(c,f.type,g):f.hasOwnProperty("defaultValue")&&He(c,f.type,Se(f.defaultValue)),f.checked==null&&f.defaultChecked!=null&&(c.defaultChecked=!!f.defaultChecked)}function gt(c,f,g){if(f.hasOwnProperty("value")||f.hasOwnProperty("defaultValue")){var _=f.type;if(!(_!=="submit"&&_!=="reset"||f.value!==void 0&&f.value!==null))return;f=""+c._wrapperState.initialValue,g||f===c.value||(c.value=f),c.defaultValue=f}g=c.name,g!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,g!==""&&(c.name=g)}function He(c,f,g){(f!=="number"||Le(c.ownerDocument)!==c)&&(g==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+g&&(c.defaultValue=""+g))}var ft=Array.isArray;function lt(c,f,g,_){if(c=c.options,f){f={};for(var R=0;R<g.length;R++)f["$"+g[R]]=!0;for(g=0;g<c.length;g++)R=f.hasOwnProperty("$"+c[g].value),c[g].selected!==R&&(c[g].selected=R),R&&_&&(c[g].defaultSelected=!0)}else{for(g=""+Se(g),f=null,R=0;R<c.length;R++){if(c[R].value===g){c[R].selected=!0,_&&(c[R].defaultSelected=!0);return}f!==null||c[R].disabled||(f=c[R])}f!==null&&(f.selected=!0)}}function Et(c,f){if(f.dangerouslySetInnerHTML!=null)throw Error(t(91));return fe({},f,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function pt(c,f){var g=f.value;if(g==null){if(g=f.children,f=f.defaultValue,g!=null){if(f!=null)throw Error(t(92));if(ft(g)){if(1<g.length)throw Error(t(93));g=g[0]}f=g}f==null&&(f=""),g=f}c._wrapperState={initialValue:Se(g)}}function En(c,f){var g=Se(f.value),_=Se(f.defaultValue);g!=null&&(g=""+g,g!==c.value&&(c.value=g),f.defaultValue==null&&c.defaultValue!==g&&(c.defaultValue=g)),_!=null&&(c.defaultValue=""+_)}function $t(c){var f=c.textContent;f===c._wrapperState.initialValue&&f!==""&&f!==null&&(c.value=f)}function Qt(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function an(c,f){return c==null||c==="http://www.w3.org/1999/xhtml"?Qt(f):c==="http://www.w3.org/2000/svg"&&f==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var qt,vt=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(f,g,_,R){MSApp.execUnsafeLocalFunction(function(){return c(f,g,_,R)})}:c})(function(c,f){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=f;else{for(qt=qt||document.createElement("div"),qt.innerHTML="<svg>"+f.valueOf().toString()+"</svg>",f=qt.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;f.firstChild;)c.appendChild(f.firstChild)}});function en(c,f){if(f){var g=c.firstChild;if(g&&g===c.lastChild&&g.nodeType===3){g.nodeValue=f;return}}c.textContent=f}var yt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dr=["Webkit","ms","Moz","O"];Object.keys(yt).forEach(function(c){dr.forEach(function(f){f=f+c.charAt(0).toUpperCase()+c.substring(1),yt[f]=yt[c]})});function mn(c,f,g){return f==null||typeof f=="boolean"||f===""?"":g||typeof f!="number"||f===0||yt.hasOwnProperty(c)&&yt[c]?(""+f).trim():f+"px"}function rn(c,f){c=c.style;for(var g in f)if(f.hasOwnProperty(g)){var _=g.indexOf("--")===0,R=mn(g,f[g],_);g==="float"&&(g="cssFloat"),_?c.setProperty(g,R):c[g]=R}}var un=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function On(c,f){if(f){if(un[c]&&(f.children!=null||f.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(f.dangerouslySetInnerHTML!=null){if(f.children!=null)throw Error(t(60));if(typeof f.dangerouslySetInnerHTML!="object"||!("__html"in f.dangerouslySetInnerHTML))throw Error(t(61))}if(f.style!=null&&typeof f.style!="object")throw Error(t(62))}}function Ot(c,f){if(c.indexOf("-")===-1)return typeof f.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bn=null;function Ht(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Jt=null,jn=null,Dt=null;function Gt(c){if(c=_c(c)){if(typeof Jt!="function")throw Error(t(280));var f=c.stateNode;f&&(f=Ph(f),Jt(c.stateNode,c.type,f))}}function Cn(c){jn?Dt?Dt.push(c):Dt=[c]:jn=c}function Mo(){if(jn){var c=jn,f=Dt;if(Dt=jn=null,Gt(c),f)for(c=0;c<f.length;c++)Gt(f[c])}}function ai(c,f){return c(f)}function As(){}var ui=!1;function Kt(c,f,g){if(ui)return c(f,g);ui=!0;try{return ai(c,f,g)}finally{ui=!1,(jn!==null||Dt!==null)&&(As(),Mo())}}function go(c,f){var g=c.stateNode;if(g===null)return null;var _=Ph(g);if(_===null)return null;g=_[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(c=c.type,_=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!_;break e;default:c=!1}if(c)return null;if(g&&typeof g!="function")throw Error(t(231,f,typeof g));return g}var Yi=!1;if(a)try{var li={};Object.defineProperty(li,"passive",{get:function(){Yi=!0}}),window.addEventListener("test",li,li),window.removeEventListener("test",li,li)}catch{Yi=!1}function vo(c,f,g,_,R,V,K,ye,Ee){var ze=Array.prototype.slice.call(arguments,3);try{f.apply(g,ze)}catch(ot){this.onError(ot)}}var Xn=!1,or=null,Rr=!1,Ei=null,Ks={onError:function(c){Xn=!0,or=c}};function Oo(c,f,g,_,R,V,K,ye,Ee){Xn=!1,or=null,vo.apply(Ks,arguments)}function Fo(c,f,g,_,R,V,K,ye,Ee){if(Oo.apply(this,arguments),Xn){if(Xn){var ze=or;Xn=!1,or=null}else throw Error(t(198));Rr||(Rr=!0,Ei=ze)}}function Vr(c){var f=c,g=c;if(c.alternate)for(;f.return;)f=f.return;else{c=f;do f=c,(f.flags&4098)!==0&&(g=f.return),c=f.return;while(c)}return f.tag===3?g:null}function yo(c){if(c.tag===13){var f=c.memoizedState;if(f===null&&(c=c.alternate,c!==null&&(f=c.memoizedState)),f!==null)return f.dehydrated}return null}function wo(c){if(Vr(c)!==c)throw Error(t(188))}function xa(c){var f=c.alternate;if(!f){if(f=Vr(c),f===null)throw Error(t(188));return f!==c?null:c}for(var g=c,_=f;;){var R=g.return;if(R===null)break;var V=R.alternate;if(V===null){if(_=R.return,_!==null){g=_;continue}break}if(R.child===V.child){for(V=R.child;V;){if(V===g)return wo(R),c;if(V===_)return wo(R),f;V=V.sibling}throw Error(t(188))}if(g.return!==_.return)g=R,_=V;else{for(var K=!1,ye=R.child;ye;){if(ye===g){K=!0,g=R,_=V;break}if(ye===_){K=!0,_=R,g=V;break}ye=ye.sibling}if(!K){for(ye=V.child;ye;){if(ye===g){K=!0,g=V,_=R;break}if(ye===_){K=!0,_=V,g=R;break}ye=ye.sibling}if(!K)throw Error(t(189))}}if(g.alternate!==_)throw Error(t(190))}if(g.tag!==3)throw Error(t(188));return g.stateNode.current===g?c:f}function cs(c){return c=xa(c),c!==null?hs(c):null}function hs(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var f=hs(c);if(f!==null)return f;c=c.sibling}return null}var _a=e.unstable_scheduleCallback,Xs=e.unstable_cancelCallback,Cs=e.unstable_shouldYield,Ys=e.unstable_requestPaint,Qn=e.unstable_now,cc=e.unstable_getCurrentPriorityLevel,Ka=e.unstable_ImmediatePriority,Qi=e.unstable_UserBlockingPriority,Qs=e.unstable_NormalPriority,Nu=e.unstable_LowPriority,Ea=e.unstable_IdlePriority,Sa=null,Ji=null;function xl(c){if(Ji&&typeof Ji.onCommitFiberRoot=="function")try{Ji.onCommitFiberRoot(Sa,c,void 0,(c.current.flags&128)===128)}catch{}}var Pr=Math.clz32?Math.clz32:pr,bo=Math.log,Bo=Math.LN2;function pr(c){return c>>>=0,c===0?32:31-(bo(c)/Bo|0)|0}var fs=64,Oi=4194304;function Tn(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function Is(c,f){var g=c.pendingLanes;if(g===0)return 0;var _=0,R=c.suspendedLanes,V=c.pingedLanes,K=g&268435455;if(K!==0){var ye=K&~R;ye!==0?_=Tn(ye):(V&=K,V!==0&&(_=Tn(V)))}else K=g&~R,K!==0?_=Tn(K):V!==0&&(_=Tn(V));if(_===0)return 0;if(f!==0&&f!==_&&(f&R)===0&&(R=_&-_,V=f&-f,R>=V||R===16&&(V&4194240)!==0))return f;if((_&4)!==0&&(_|=g&16),f=c.entangledLanes,f!==0)for(c=c.entanglements,f&=_;0<f;)g=31-Pr(f),R=1<<g,_|=c[g],f&=~R;return _}function Si(c,f){switch(c){case 1:case 2:case 4:return f+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function br(c,f){for(var g=c.suspendedLanes,_=c.pingedLanes,R=c.expirationTimes,V=c.pendingLanes;0<V;){var K=31-Pr(V),ye=1<<K,Ee=R[K];Ee===-1?((ye&g)===0||(ye&_)!==0)&&(R[K]=Si(ye,f)):Ee<=f&&(c.expiredLanes|=ye),V&=~ye}}function ds(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function Ru(){var c=fs;return fs<<=1,(fs&4194240)===0&&(fs=64),c}function _l(c){for(var f=[],g=0;31>g;g++)f.push(c);return f}function Xa(c,f,g){c.pendingLanes|=f,f!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,f=31-Pr(f),c[f]=g}function Ts(c,f){var g=c.pendingLanes&~f;c.pendingLanes=f,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=f,c.mutableReadLanes&=f,c.entangledLanes&=f,f=c.entanglements;var _=c.eventTimes;for(c=c.expirationTimes;0<g;){var R=31-Pr(g),V=1<<R;f[R]=0,_[R]=-1,c[R]=-1,g&=~V}}function Pu(c,f){var g=c.entangledLanes|=f;for(c=c.entanglements;g;){var _=31-Pr(g),R=1<<_;R&f|c[_]&f&&(c[_]|=f),g&=~R}}var An=0;function xo(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var Js,Du,El,Sl,Ya,ps=!1,Zi=[],ks=null,eo=null,jr=null,Qa=new Map,Xt=new Map,_o=[],hc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Aa(c,f){switch(c){case"focusin":case"focusout":ks=null;break;case"dragenter":case"dragleave":eo=null;break;case"mouseover":case"mouseout":jr=null;break;case"pointerover":case"pointerout":Qa.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xt.delete(f.pointerId)}}function ci(c,f,g,_,R,V){return c===null||c.nativeEvent!==V?(c={blockedOn:f,domEventName:g,eventSystemFlags:_,nativeEvent:V,targetContainers:[R]},f!==null&&(f=_c(f),f!==null&&Du(f)),c):(c.eventSystemFlags|=_,f=c.targetContainers,R!==null&&f.indexOf(R)===-1&&f.push(R),c)}function Ns(c,f,g,_,R){switch(f){case"focusin":return ks=ci(ks,c,f,g,_,R),!0;case"dragenter":return eo=ci(eo,c,f,g,_,R),!0;case"mouseover":return jr=ci(jr,c,f,g,_,R),!0;case"pointerover":var V=R.pointerId;return Qa.set(V,ci(Qa.get(V)||null,c,f,g,_,R)),!0;case"gotpointercapture":return V=R.pointerId,Xt.set(V,ci(Xt.get(V)||null,c,f,g,_,R)),!0}return!1}function Lu(c){var f=Wu(c.target);if(f!==null){var g=Vr(f);if(g!==null){if(f=g.tag,f===13){if(f=yo(g),f!==null){c.blockedOn=f,Ya(c.priority,function(){El(g)});return}}else if(f===3&&g.stateNode.current.memoizedState.isDehydrated){c.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Jn(c){if(c.blockedOn!==null)return!1;for(var f=c.targetContainers;0<f.length;){var g=Ia(c.domEventName,c.eventSystemFlags,f[0],c.nativeEvent);if(g===null){g=c.nativeEvent;var _=new g.constructor(g.type,g);Bn=_,g.target.dispatchEvent(_),Bn=null}else return f=_c(g),f!==null&&Du(f),c.blockedOn=g,!1;f.shift()}return!0}function Ja(c,f,g){Jn(c)&&g.delete(f)}function Al(){ps=!1,ks!==null&&Jn(ks)&&(ks=null),eo!==null&&Jn(eo)&&(eo=null),jr!==null&&Jn(jr)&&(jr=null),Qa.forEach(Ja),Xt.forEach(Ja)}function Vo(c,f){c.blockedOn===f&&(c.blockedOn=null,ps||(ps=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Al)))}function Ca(c){function f(R){return Vo(R,c)}if(0<Zi.length){Vo(Zi[0],c);for(var g=1;g<Zi.length;g++){var _=Zi[g];_.blockedOn===c&&(_.blockedOn=null)}}for(ks!==null&&Vo(ks,c),eo!==null&&Vo(eo,c),jr!==null&&Vo(jr,c),Qa.forEach(f),Xt.forEach(f),g=0;g<_o.length;g++)_=_o[g],_.blockedOn===c&&(_.blockedOn=null);for(;0<_o.length&&(g=_o[0],g.blockedOn===null);)Lu(g),g.blockedOn===null&&_o.shift()}var Fi=C.ReactCurrentBatchConfig,Zs=!0;function jo(c,f,g,_){var R=An,V=Fi.transition;Fi.transition=null;try{An=1,Ou(c,f,g,_)}finally{An=R,Fi.transition=V}}function Mu(c,f,g,_){var R=An,V=Fi.transition;Fi.transition=null;try{An=4,Ou(c,f,g,_)}finally{An=R,Fi.transition=V}}function Ou(c,f,g,_){if(Zs){var R=Ia(c,f,g,_);if(R===null)kh(c,f,_,Ai,g),Aa(c,_);else if(Ns(R,c,f,g,_))_.stopPropagation();else if(Aa(c,_),f&4&&-1<hc.indexOf(c)){for(;R!==null;){var V=_c(R);if(V!==null&&Js(V),V=Ia(c,f,g,_),V===null&&kh(c,f,_,Ai,g),V===R)break;R=V}R!==null&&_.stopPropagation()}else kh(c,f,_,null,g)}}var Ai=null;function Ia(c,f,g,_){if(Ai=null,c=Ht(_),c=Wu(c),c!==null)if(f=Vr(c),f===null)c=null;else if(g=f.tag,g===13){if(c=yo(f),c!==null)return c;c=null}else if(g===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;c=null}else f!==c&&(c=null);return Ai=c,null}function ea(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cc()){case Ka:return 1;case Qi:return 4;case Qs:case Nu:return 16;case Ea:return 536870912;default:return 16}default:return 16}}var Bi=null,Rs=null,ms=null;function Cl(){if(ms)return ms;var c,f=Rs,g=f.length,_,R="value"in Bi?Bi.value:Bi.textContent,V=R.length;for(c=0;c<g&&f[c]===R[c];c++);var K=g-c;for(_=1;_<=K&&f[g-_]===R[V-_];_++);return ms=R.slice(c,1<_?1-_:void 0)}function Ta(c){var f=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&f===13&&(c=13)):c=f,c===10&&(c=13),32<=c||c===13?c:0}function Ci(){return!0}function gs(){return!1}function hi(c){function f(g,_,R,V,K){this._reactName=g,this._targetInst=R,this.type=_,this.nativeEvent=V,this.target=K,this.currentTarget=null;for(var ye in c)c.hasOwnProperty(ye)&&(g=c[ye],this[ye]=g?g(V):V[ye]);return this.isDefaultPrevented=(V.defaultPrevented!=null?V.defaultPrevented:V.returnValue===!1)?Ci:gs,this.isPropagationStopped=gs,this}return fe(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Ci)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Ci)},persist:function(){},isPersistent:Ci}),f}var to={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ka=hi(to),N=fe({},to,{view:0,detail:0}),H=hi(N),pe,be,Ne,Xe=fe({},N,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:on,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Ne&&(Ne&&c.type==="mousemove"?(pe=c.screenX-Ne.screenX,be=c.screenY-Ne.screenY):be=pe=0,Ne=c),pe)},movementY:function(c){return"movementY"in c?c.movementY:be}}),Ze=hi(Xe),wt=fe({},Xe,{dataTransfer:0}),It=hi(wt),Zt=fe({},N,{relatedTarget:0}),Ft=hi(Zt),kn=fe({},to,{animationName:0,elapsedTime:0,pseudoElement:0}),mr=hi(kn),sr=fe({},to,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),w=hi(sr),B=fe({},to,{data:0}),q=hi(B),ne={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Re={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},je={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function at(c){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(c):(c=je[c])?!!f[c]:!1}function on(){return at}var gr=fe({},N,{key:function(c){if(c.key){var f=ne[c.key]||c.key;if(f!=="Unidentified")return f}return c.type==="keypress"?(c=Ta(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?Re[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:on,charCode:function(c){return c.type==="keypress"?Ta(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Ta(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),Nn=hi(gr),vr=fe({},Xe,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fi=hi(vr),no=fe({},N,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:on}),yr=hi(no),ro=fe({},to,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ps=hi(ro),Za=fe({},Xe,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),_h=hi(Za),Eo=[9,13,27,32],ta=a&&"CompositionEvent"in window,Na=null;a&&"documentMode"in document&&(Na=document.documentMode);var If=a&&"TextEvent"in window&&!Na,vs=a&&(!ta||Na&&8<Na&&11>=Na),Fu=" ",fc=!1;function dc(c,f){switch(c){case"keyup":return Eo.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eu(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Ds=!1;function ys(c,f){switch(c){case"compositionend":return eu(f);case"keypress":return f.which!==32?null:(fc=!0,Fu);case"textInput":return c=f.data,c===Fu&&fc?null:c;default:return null}}function ws(c,f){if(Ds)return c==="compositionend"||!ta&&dc(c,f)?(c=Cl(),ms=Rs=Bi=null,Ds=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return vs&&f.locale!=="ko"?null:f.data;default:return null}}var Bu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ra(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f==="input"?!!Bu[c.type]:f==="textarea"}function tu(c,f,g,_){Cn(_),f=Pf(f,"onChange"),0<f.length&&(g=new ka("onChange","change",null,g,_),c.push({event:g,listeners:f}))}var nu=null,Pa=null;function Ur(c){Ih(c,0)}function Il(c){var f=Fl(c);if(Be(f))return c}function Da(c,f){if(c==="change")return f}var na=!1;if(a){var Tl;if(a){var kl="oninput"in document;if(!kl){var pc=document.createElement("div");pc.setAttribute("oninput","return;"),kl=typeof pc.oninput=="function"}Tl=kl}else Tl=!1;na=Tl&&(!document.documentMode||9<document.documentMode)}function mc(){nu&&(nu.detachEvent("onpropertychange",ru),Pa=nu=null)}function ru(c){if(c.propertyName==="value"&&Il(Pa)){var f=[];tu(f,Pa,c,Ht(c)),Kt(Ur,f)}}function Vu(c,f,g){c==="focusin"?(mc(),nu=f,Pa=g,nu.attachEvent("onpropertychange",ru)):c==="focusout"&&mc()}function ju(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Il(Pa)}function Nl(c,f){if(c==="click")return Il(f)}function Uu(c,f){if(c==="input"||c==="change")return Il(f)}function Rl(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var Dr=typeof Object.is=="function"?Object.is:Rl;function Uo(c,f){if(Dr(c,f))return!0;if(typeof c!="object"||c===null||typeof f!="object"||f===null)return!1;var g=Object.keys(c),_=Object.keys(f);if(g.length!==_.length)return!1;for(_=0;_<g.length;_++){var R=g[_];if(!u.call(f,R)||!Dr(c[R],f[R]))return!1}return!0}function qn(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function tr(c,f){var g=qn(c);c=0;for(var _;g;){if(g.nodeType===3){if(_=c+g.textContent.length,c<=f&&_>=f)return{node:g,offset:f-c};c=_}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=qn(g)}}function Lr(c,f){return c&&f?c===f?!0:c&&c.nodeType===3?!1:f&&f.nodeType===3?Lr(c,f.parentNode):"contains"in c?c.contains(f):c.compareDocumentPosition?!!(c.compareDocumentPosition(f)&16):!1:!1}function Zr(){for(var c=window,f=Le();f instanceof c.HTMLIFrameElement;){try{var g=typeof f.contentWindow.location.href=="string"}catch{g=!1}if(g)c=f.contentWindow;else break;f=Le(c.document)}return f}function ra(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f&&(f==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||f==="textarea"||c.contentEditable==="true")}function Eh(c){var f=Zr(),g=c.focusedElem,_=c.selectionRange;if(f!==g&&g&&g.ownerDocument&&Lr(g.ownerDocument.documentElement,g)){if(_!==null&&ra(g)){if(f=_.start,c=_.end,c===void 0&&(c=f),"selectionStart"in g)g.selectionStart=f,g.selectionEnd=Math.min(c,g.value.length);else if(c=(f=g.ownerDocument||document)&&f.defaultView||window,c.getSelection){c=c.getSelection();var R=g.textContent.length,V=Math.min(_.start,R);_=_.end===void 0?V:Math.min(_.end,R),!c.extend&&V>_&&(R=_,_=V,V=R),R=tr(g,V);var K=tr(g,_);R&&K&&(c.rangeCount!==1||c.anchorNode!==R.node||c.anchorOffset!==R.offset||c.focusNode!==K.node||c.focusOffset!==K.offset)&&(f=f.createRange(),f.setStart(R.node,R.offset),c.removeAllRanges(),V>_?(c.addRange(f),c.extend(K.node,K.offset)):(f.setEnd(K.node,K.offset),c.addRange(f)))}}for(f=[],c=g;c=c.parentNode;)c.nodeType===1&&f.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<f.length;g++)c=f[g],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var gc=a&&"documentMode"in document&&11>=document.documentMode,iu=null,Tf=null,vc=null,kf=!1;function fp(c,f,g){var _=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;kf||iu==null||iu!==Le(_)||(_=iu,"selectionStart"in _&&ra(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),vc&&Uo(vc,_)||(vc=_,_=Pf(Tf,"onSelect"),0<_.length&&(f=new ka("onSelect","select",null,f,g),c.push({event:f,listeners:_}),f.target=iu)))}function Sh(c,f){var g={};return g[c.toLowerCase()]=f.toLowerCase(),g["Webkit"+c]="webkit"+f,g["Moz"+c]="moz"+f,g}var Pl={animationend:Sh("Animation","AnimationEnd"),animationiteration:Sh("Animation","AnimationIteration"),animationstart:Sh("Animation","AnimationStart"),transitionend:Sh("Transition","TransitionEnd")},Dl={},dp={};a&&(dp=document.createElement("div").style,"AnimationEvent"in window||(delete Pl.animationend.animation,delete Pl.animationiteration.animation,delete Pl.animationstart.animation),"TransitionEvent"in window||delete Pl.transitionend.transition);function Ah(c){if(Dl[c])return Dl[c];if(!Pl[c])return c;var f=Pl[c],g;for(g in f)if(f.hasOwnProperty(g)&&g in dp)return Dl[c]=f[g];return c}var pp=Ah("animationend"),mp=Ah("animationiteration"),gp=Ah("animationstart"),vp=Ah("transitionend"),yp=new Map,wp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function La(c,f){yp.set(c,f),o(f,[c])}for(var yc=0;yc<wp.length;yc++){var So=wp[yc],Ls=So.toLowerCase(),Nf=So[0].toUpperCase()+So.slice(1);La(Ls,"on"+Nf)}La(pp,"onAnimationEnd"),La(mp,"onAnimationIteration"),La(gp,"onAnimationStart"),La("dblclick","onDoubleClick"),La("focusin","onFocus"),La("focusout","onBlur"),La(vp,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lg=new Set("cancel close invalid load scroll toggle".split(" ").concat(zu));function Ch(c,f,g){var _=c.type||"unknown-event";c.currentTarget=g,Fo(_,f,void 0,c),c.currentTarget=null}function Ih(c,f){f=(f&4)!==0;for(var g=0;g<c.length;g++){var _=c[g],R=_.event;_=_.listeners;e:{var V=void 0;if(f)for(var K=_.length-1;0<=K;K--){var ye=_[K],Ee=ye.instance,ze=ye.currentTarget;if(ye=ye.listener,Ee!==V&&R.isPropagationStopped())break e;Ch(R,ye,ze),V=Ee}else for(K=0;K<_.length;K++){if(ye=_[K],Ee=ye.instance,ze=ye.currentTarget,ye=ye.listener,Ee!==V&&R.isPropagationStopped())break e;Ch(R,ye,ze),V=Ee}}}if(Rr)throw c=Ei,Rr=!1,Ei=null,c}function ar(c,f){var g=f[Wo];g===void 0&&(g=f[Wo]=new Set);var _=c+"__bubble";g.has(_)||(Th(f,c,2,!1),g.add(_))}function Rf(c,f,g){var _=0;f&&(_|=4),Th(g,c,_,f)}var wc="_reactListening"+Math.random().toString(36).slice(2);function Ll(c){if(!c[wc]){c[wc]=!0,r.forEach(function(g){g!=="selectionchange"&&(lg.has(g)||Rf(g,!1,c),Rf(g,!0,c))});var f=c.nodeType===9?c:c.ownerDocument;f===null||f[wc]||(f[wc]=!0,Rf("selectionchange",!1,f))}}function Th(c,f,g,_){switch(ea(f)){case 1:var R=jo;break;case 4:R=Mu;break;default:R=Ou}g=R.bind(null,f,g,c),R=void 0,!Yi||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(R=!0),_?R!==void 0?c.addEventListener(f,g,{capture:!0,passive:R}):c.addEventListener(f,g,!0):R!==void 0?c.addEventListener(f,g,{passive:R}):c.addEventListener(f,g,!1)}function kh(c,f,g,_,R){var V=_;if((f&1)===0&&(f&2)===0&&_!==null)e:for(;;){if(_===null)return;var K=_.tag;if(K===3||K===4){var ye=_.stateNode.containerInfo;if(ye===R||ye.nodeType===8&&ye.parentNode===R)break;if(K===4)for(K=_.return;K!==null;){var Ee=K.tag;if((Ee===3||Ee===4)&&(Ee=K.stateNode.containerInfo,Ee===R||Ee.nodeType===8&&Ee.parentNode===R))return;K=K.return}for(;ye!==null;){if(K=Wu(ye),K===null)return;if(Ee=K.tag,Ee===5||Ee===6){_=V=K;continue e}ye=ye.parentNode}}_=_.return}Kt(function(){var ze=V,ot=Ht(g),st=[];e:{var it=yp.get(c);if(it!==void 0){var mt=ka,Tt=c;switch(c){case"keypress":if(Ta(g)===0)break e;case"keydown":case"keyup":mt=Nn;break;case"focusin":Tt="focus",mt=Ft;break;case"focusout":Tt="blur",mt=Ft;break;case"beforeblur":case"afterblur":mt=Ft;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":mt=Ze;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":mt=It;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":mt=yr;break;case pp:case mp:case gp:mt=mr;break;case vp:mt=Ps;break;case"scroll":mt=H;break;case"wheel":mt=_h;break;case"copy":case"cut":case"paste":mt=w;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":mt=fi}var Pt=(f&4)!==0,mi=!Pt&&c==="scroll",Me=Pt?it!==null?it+"Capture":null:it;Pt=[];for(var ke=ze,Ve;ke!==null;){Ve=ke;var ut=Ve.stateNode;if(Ve.tag===5&&ut!==null&&(Ve=ut,Me!==null&&(ut=go(ke,Me),ut!=null&&Pt.push(Nh(ke,ut,Ve)))),mi)break;ke=ke.return}0<Pt.length&&(it=new mt(it,Tt,null,g,ot),st.push({event:it,listeners:Pt}))}}if((f&7)===0){e:{if(it=c==="mouseover"||c==="pointerover",mt=c==="mouseout"||c==="pointerout",it&&g!==Bn&&(Tt=g.relatedTarget||g.fromElement)&&(Wu(Tt)||Tt[io]))break e;if((mt||it)&&(it=ot.window===ot?ot:(it=ot.ownerDocument)?it.defaultView||it.parentWindow:window,mt?(Tt=g.relatedTarget||g.toElement,mt=ze,Tt=Tt?Wu(Tt):null,Tt!==null&&(mi=Vr(Tt),Tt!==mi||Tt.tag!==5&&Tt.tag!==6)&&(Tt=null)):(mt=null,Tt=ze),mt!==Tt)){if(Pt=Ze,ut="onMouseLeave",Me="onMouseEnter",ke="mouse",(c==="pointerout"||c==="pointerover")&&(Pt=fi,ut="onPointerLeave",Me="onPointerEnter",ke="pointer"),mi=mt==null?it:Fl(mt),Ve=Tt==null?it:Fl(Tt),it=new Pt(ut,ke+"leave",mt,g,ot),it.target=mi,it.relatedTarget=Ve,ut=null,Wu(ot)===ze&&(Pt=new Pt(Me,ke+"enter",Tt,g,ot),Pt.target=Ve,Pt.relatedTarget=mi,ut=Pt),mi=ut,mt&&Tt)t:{for(Pt=mt,Me=Tt,ke=0,Ve=Pt;Ve;Ve=Ml(Ve))ke++;for(Ve=0,ut=Me;ut;ut=Ml(ut))Ve++;for(;0<ke-Ve;)Pt=Ml(Pt),ke--;for(;0<Ve-ke;)Me=Ml(Me),Ve--;for(;ke--;){if(Pt===Me||Me!==null&&Pt===Me.alternate)break t;Pt=Ml(Pt),Me=Ml(Me)}Pt=null}else Pt=null;mt!==null&&cg(st,it,mt,Pt,!1),Tt!==null&&mi!==null&&cg(st,mi,Tt,Pt,!0)}}e:{if(it=ze?Fl(ze):window,mt=it.nodeName&&it.nodeName.toLowerCase(),mt==="select"||mt==="input"&&it.type==="file")var Bt=Da;else if(Ra(it))if(na)Bt=Uu;else{Bt=ju;var tn=Vu}else(mt=it.nodeName)&&mt.toLowerCase()==="input"&&(it.type==="checkbox"||it.type==="radio")&&(Bt=Nl);if(Bt&&(Bt=Bt(c,ze))){tu(st,Bt,g,ot);break e}tn&&tn(c,it,ze),c==="focusout"&&(tn=it._wrapperState)&&tn.controlled&&it.type==="number"&&He(it,"number",it.value)}switch(tn=ze?Fl(ze):window,c){case"focusin":(Ra(tn)||tn.contentEditable==="true")&&(iu=tn,Tf=ze,vc=null);break;case"focusout":vc=Tf=iu=null;break;case"mousedown":kf=!0;break;case"contextmenu":case"mouseup":case"dragend":kf=!1,fp(st,g,ot);break;case"selectionchange":if(gc)break;case"keydown":case"keyup":fp(st,g,ot)}var nn;if(ta)e:{switch(c){case"compositionstart":var fn="onCompositionStart";break e;case"compositionend":fn="onCompositionEnd";break e;case"compositionupdate":fn="onCompositionUpdate";break e}fn=void 0}else Ds?dc(c,g)&&(fn="onCompositionEnd"):c==="keydown"&&g.keyCode===229&&(fn="onCompositionStart");fn&&(vs&&g.locale!=="ko"&&(Ds||fn!=="onCompositionStart"?fn==="onCompositionEnd"&&Ds&&(nn=Cl()):(Bi=ot,Rs="value"in Bi?Bi.value:Bi.textContent,Ds=!0)),tn=Pf(ze,fn),0<tn.length&&(fn=new q(fn,c,null,g,ot),st.push({event:fn,listeners:tn}),nn?fn.data=nn:(nn=eu(g),nn!==null&&(fn.data=nn)))),(nn=If?ys(c,g):ws(c,g))&&(ze=Pf(ze,"onBeforeInput"),0<ze.length&&(ot=new q("onBeforeInput","beforeinput",null,g,ot),st.push({event:ot,listeners:ze}),ot.data=nn))}Ih(st,f)})}function Nh(c,f,g){return{instance:c,listener:f,currentTarget:g}}function Pf(c,f){for(var g=f+"Capture",_=[];c!==null;){var R=c,V=R.stateNode;R.tag===5&&V!==null&&(R=V,V=go(c,g),V!=null&&_.unshift(Nh(c,V,R)),V=go(c,f),V!=null&&_.push(Nh(c,V,R))),c=c.return}return _}function Ml(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function cg(c,f,g,_,R){for(var V=f._reactName,K=[];g!==null&&g!==_;){var ye=g,Ee=ye.alternate,ze=ye.stateNode;if(Ee!==null&&Ee===_)break;ye.tag===5&&ze!==null&&(ye=ze,R?(Ee=go(g,V),Ee!=null&&K.unshift(Nh(g,Ee,ye))):R||(Ee=go(g,V),Ee!=null&&K.push(Nh(g,Ee,ye)))),g=g.return}K.length!==0&&c.push({event:f,listeners:K})}var S1=/\r\n?/g,A1=/\u0000|\uFFFD/g;function hg(c){return(typeof c=="string"?c:""+c).replace(S1,`
`).replace(A1,"")}function Df(c,f,g){if(f=hg(f),hg(c)!==f&&g)throw Error(t(425))}function bc(){}var Rh=null,Ol=null;function bp(c,f){return c==="textarea"||c==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var xp=typeof setTimeout=="function"?setTimeout:void 0,fg=typeof clearTimeout=="function"?clearTimeout:void 0,dg=typeof Promise=="function"?Promise:void 0,C1=typeof queueMicrotask=="function"?queueMicrotask:typeof dg<"u"?function(c){return dg.resolve(null).then(c).catch(I1)}:xp;function I1(c){setTimeout(function(){throw c})}function _p(c,f){var g=f,_=0;do{var R=g.nextSibling;if(c.removeChild(g),R&&R.nodeType===8)if(g=R.data,g==="/$"){if(_===0){c.removeChild(R),Ca(f);return}_--}else g!=="$"&&g!=="$?"&&g!=="$!"||_++;g=R}while(g);Ca(f)}function Ao(c){for(;c!=null;c=c.nextSibling){var f=c.nodeType;if(f===1||f===3)break;if(f===8){if(f=c.data,f==="$"||f==="$!"||f==="$?")break;if(f==="/$")return null}}return c}function Ms(c){c=c.previousSibling;for(var f=0;c;){if(c.nodeType===8){var g=c.data;if(g==="$"||g==="$!"||g==="$?"){if(f===0)return c;f--}else g==="/$"&&f++}c=c.previousSibling}return null}var zo=Math.random().toString(36).slice(2),Ma="__reactFiber$"+zo,xc="__reactProps$"+zo,io="__reactContainer$"+zo,Wo="__reactEvents$"+zo,T1="__reactListeners$"+zo,k1="__reactHandles$"+zo;function Wu(c){var f=c[Ma];if(f)return f;for(var g=c.parentNode;g;){if(f=g[io]||g[Ma]){if(g=f.alternate,f.child!==null||g!==null&&g.child!==null)for(c=Ms(c);c!==null;){if(g=c[Ma])return g;c=Ms(c)}return f}c=g,g=c.parentNode}return null}function _c(c){return c=c[Ma]||c[io],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Fl(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function Ph(c){return c[xc]||null}var Ep=[],ou=-1;function ia(c){return{current:c}}function Zn(c){0>ou||(c.current=Ep[ou],Ep[ou]=null,ou--)}function nr(c,f){ou++,Ep[ou]=c.current,c.current=f}var qu={},Vi=ia(qu),qo=ia(!1),Bl=qu;function Ec(c,f){var g=c.type.contextTypes;if(!g)return qu;var _=c.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===f)return _.__reactInternalMemoizedMaskedChildContext;var R={},V;for(V in g)R[V]=f[V];return _&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=f,c.__reactInternalMemoizedMaskedChildContext=R),R}function Ho(c){return c=c.childContextTypes,c!=null}function Lf(){Zn(qo),Zn(Vi)}function pg(c,f,g){if(Vi.current!==qu)throw Error(t(168));nr(Vi,f),nr(qo,g)}function Sp(c,f,g){var _=c.stateNode;if(f=f.childContextTypes,typeof _.getChildContext!="function")return g;_=_.getChildContext();for(var R in _)if(!(R in f))throw Error(t(108,we(c)||"Unknown",R));return fe({},g,_)}function Vl(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||qu,Bl=Vi.current,nr(Vi,c),nr(qo,qo.current),!0}function mg(c,f,g){var _=c.stateNode;if(!_)throw Error(t(169));g?(c=Sp(c,f,Bl),_.__reactInternalMemoizedMergedChildContext=c,Zn(qo),Zn(Vi),nr(Vi,c)):Zn(qo),nr(qo,g)}var su=null,Dh=!1,v=!1;function S(c){su===null?su=[c]:su.push(c)}function F(c){Dh=!0,S(c)}function U(){if(!v&&su!==null){v=!0;var c=0,f=An;try{var g=su;for(An=1;c<g.length;c++){var _=g[c];do _=_(!0);while(_!==null)}su=null,Dh=!1}catch(R){throw su!==null&&(su=su.slice(c+1)),_a(Ka,U),R}finally{An=f,v=!1}}return null}var G=[],Y=0,Z=null,ee=0,ie=[],le=0,_e=null,De=1,he="";function Ce(c,f){G[Y++]=ee,G[Y++]=Z,Z=c,ee=f}function Pe(c,f,g){ie[le++]=De,ie[le++]=he,ie[le++]=_e,_e=c;var _=De;c=he;var R=32-Pr(_)-1;_&=~(1<<R),g+=1;var V=32-Pr(f)+R;if(30<V){var K=R-R%5;V=(_&(1<<K)-1).toString(32),_>>=K,R-=K,De=1<<32-Pr(f)+R|g<<R|_,he=V+c}else De=1<<V|g<<R|_,he=c}function $e(c){c.return!==null&&(Ce(c,1),Pe(c,1,0))}function Oe(c){for(;c===Z;)Z=G[--Y],G[Y]=null,ee=G[--Y],G[Y]=null;for(;c===_e;)_e=ie[--le],ie[le]=null,he=ie[--le],ie[le]=null,De=ie[--le],ie[le]=null}var qe=null,Ge=null,Qe=!1,Je=null;function Lt(c,f){var g=ja(5,null,null,0);g.elementType="DELETED",g.stateNode=f,g.return=c,f=c.deletions,f===null?(c.deletions=[g],c.flags|=16):f.push(g)}function bt(c,f){switch(c.tag){case 5:var g=c.type;return f=f.nodeType!==1||g.toLowerCase()!==f.nodeName.toLowerCase()?null:f,f!==null?(c.stateNode=f,qe=c,Ge=Ao(f.firstChild),!0):!1;case 6:return f=c.pendingProps===""||f.nodeType!==3?null:f,f!==null?(c.stateNode=f,qe=c,Ge=null,!0):!1;case 13:return f=f.nodeType!==8?null:f,f!==null?(g=_e!==null?{id:De,overflow:he}:null,c.memoizedState={dehydrated:f,treeContext:g,retryLane:1073741824},g=ja(18,null,null,0),g.stateNode=f,g.return=c,c.child=g,qe=c,Ge=null,!0):!1;default:return!1}}function gn(c){return(c.mode&1)!==0&&(c.flags&128)===0}function Ct(c){if(Qe){var f=Ge;if(f){var g=f;if(!bt(c,f)){if(gn(c))throw Error(t(418));f=Ao(g.nextSibling);var _=qe;f&&bt(c,f)?Lt(_,g):(c.flags=c.flags&-4097|2,Qe=!1,qe=c)}}else{if(gn(c))throw Error(t(418));c.flags=c.flags&-4097|2,Qe=!1,qe=c}}}function Rn(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;qe=c}function Mr(c){if(c!==qe)return!1;if(!Qe)return Rn(c),Qe=!0,!1;var f;if((f=c.tag!==3)&&!(f=c.tag!==5)&&(f=c.type,f=f!=="head"&&f!=="body"&&!bp(c.type,c.memoizedProps)),f&&(f=Ge)){if(gn(c))throw yn(),Error(t(418));for(;f;)Lt(c,f),f=Ao(f.nextSibling)}if(Rn(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,f=0;c;){if(c.nodeType===8){var g=c.data;if(g==="/$"){if(f===0){Ge=Ao(c.nextSibling);break e}f--}else g!=="$"&&g!=="$!"&&g!=="$?"||f++}c=c.nextSibling}Ge=null}}else Ge=qe?Ao(c.stateNode.nextSibling):null;return!0}function yn(){for(var c=Ge;c;)c=Ao(c.nextSibling)}function xt(){Ge=qe=null,Qe=!1}function ct(c){Je===null?Je=[c]:Je.push(c)}var zr=C.ReactCurrentBatchConfig;function ln(c,f,g){if(c=g.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(t(309));var _=g.stateNode}if(!_)throw Error(t(147,c));var R=_,V=""+c;return f!==null&&f.ref!==null&&typeof f.ref=="function"&&f.ref._stringRef===V?f.ref:(f=function(K){var ye=R.refs;K===null?delete ye[V]:ye[V]=K},f._stringRef=V,f)}if(typeof c!="string")throw Error(t(284));if(!g._owner)throw Error(t(290,c))}return c}function In(c,f){throw c=Object.prototype.toString.call(f),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":c))}function wr(c){var f=c._init;return f(c._payload)}function Ii(c){function f(Me,ke){if(c){var Ve=Me.deletions;Ve===null?(Me.deletions=[ke],Me.flags|=16):Ve.push(ke)}}function g(Me,ke){if(!c)return null;for(;ke!==null;)f(Me,ke),ke=ke.sibling;return null}function _(Me,ke){for(Me=new Map;ke!==null;)ke.key!==null?Me.set(ke.key,ke):Me.set(ke.index,ke),ke=ke.sibling;return Me}function R(Me,ke){return Me=Dc(Me,ke),Me.index=0,Me.sibling=null,Me}function V(Me,ke,Ve){return Me.index=Ve,c?(Ve=Me.alternate,Ve!==null?(Ve=Ve.index,Ve<ke?(Me.flags|=2,ke):Ve):(Me.flags|=2,ke)):(Me.flags|=1048576,ke)}function K(Me){return c&&Me.alternate===null&&(Me.flags|=2),Me}function ye(Me,ke,Ve,ut){return ke===null||ke.tag!==6?(ke=iy(Ve,Me.mode,ut),ke.return=Me,ke):(ke=R(ke,Ve),ke.return=Me,ke)}function Ee(Me,ke,Ve,ut){var Bt=Ve.type;return Bt===L?ot(Me,ke,Ve.props.children,ut,Ve.key):ke!==null&&(ke.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===ge&&wr(Bt)===ke.type)?(ut=R(ke,Ve.props),ut.ref=ln(Me,ke,Ve),ut.return=Me,ut):(ut=Mg(Ve.type,Ve.key,Ve.props,null,Me.mode,ut),ut.ref=ln(Me,ke,Ve),ut.return=Me,ut)}function ze(Me,ke,Ve,ut){return ke===null||ke.tag!==4||ke.stateNode.containerInfo!==Ve.containerInfo||ke.stateNode.implementation!==Ve.implementation?(ke=oy(Ve,Me.mode,ut),ke.return=Me,ke):(ke=R(ke,Ve.children||[]),ke.return=Me,ke)}function ot(Me,ke,Ve,ut,Bt){return ke===null||ke.tag!==7?(ke=Uh(Ve,Me.mode,ut,Bt),ke.return=Me,ke):(ke=R(ke,Ve),ke.return=Me,ke)}function st(Me,ke,Ve){if(typeof ke=="string"&&ke!==""||typeof ke=="number")return ke=iy(""+ke,Me.mode,Ve),ke.return=Me,ke;if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case D:return Ve=Mg(ke.type,ke.key,ke.props,null,Me.mode,Ve),Ve.ref=ln(Me,null,ke),Ve.return=Me,Ve;case z:return ke=oy(ke,Me.mode,Ve),ke.return=Me,ke;case ge:var ut=ke._init;return st(Me,ut(ke._payload),Ve)}if(ft(ke)||ae(ke))return ke=Uh(ke,Me.mode,Ve,null),ke.return=Me,ke;In(Me,ke)}return null}function it(Me,ke,Ve,ut){var Bt=ke!==null?ke.key:null;if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number")return Bt!==null?null:ye(Me,ke,""+Ve,ut);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case D:return Ve.key===Bt?Ee(Me,ke,Ve,ut):null;case z:return Ve.key===Bt?ze(Me,ke,Ve,ut):null;case ge:return Bt=Ve._init,it(Me,ke,Bt(Ve._payload),ut)}if(ft(Ve)||ae(Ve))return Bt!==null?null:ot(Me,ke,Ve,ut,null);In(Me,Ve)}return null}function mt(Me,ke,Ve,ut,Bt){if(typeof ut=="string"&&ut!==""||typeof ut=="number")return Me=Me.get(Ve)||null,ye(ke,Me,""+ut,Bt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case D:return Me=Me.get(ut.key===null?Ve:ut.key)||null,Ee(ke,Me,ut,Bt);case z:return Me=Me.get(ut.key===null?Ve:ut.key)||null,ze(ke,Me,ut,Bt);case ge:var tn=ut._init;return mt(Me,ke,Ve,tn(ut._payload),Bt)}if(ft(ut)||ae(ut))return Me=Me.get(Ve)||null,ot(ke,Me,ut,Bt,null);In(ke,ut)}return null}function Tt(Me,ke,Ve,ut){for(var Bt=null,tn=null,nn=ke,fn=ke=0,lo=null;nn!==null&&fn<Ve.length;fn++){nn.index>fn?(lo=nn,nn=null):lo=nn.sibling;var Yn=it(Me,nn,Ve[fn],ut);if(Yn===null){nn===null&&(nn=lo);break}c&&nn&&Yn.alternate===null&&f(Me,nn),ke=V(Yn,ke,fn),tn===null?Bt=Yn:tn.sibling=Yn,tn=Yn,nn=lo}if(fn===Ve.length)return g(Me,nn),Qe&&Ce(Me,fn),Bt;if(nn===null){for(;fn<Ve.length;fn++)nn=st(Me,Ve[fn],ut),nn!==null&&(ke=V(nn,ke,fn),tn===null?Bt=nn:tn.sibling=nn,tn=nn);return Qe&&Ce(Me,fn),Bt}for(nn=_(Me,nn);fn<Ve.length;fn++)lo=mt(nn,Me,fn,Ve[fn],ut),lo!==null&&(c&&lo.alternate!==null&&nn.delete(lo.key===null?fn:lo.key),ke=V(lo,ke,fn),tn===null?Bt=lo:tn.sibling=lo,tn=lo);return c&&nn.forEach(function(Lc){return f(Me,Lc)}),Qe&&Ce(Me,fn),Bt}function Pt(Me,ke,Ve,ut){var Bt=ae(Ve);if(typeof Bt!="function")throw Error(t(150));if(Ve=Bt.call(Ve),Ve==null)throw Error(t(151));for(var tn=Bt=null,nn=ke,fn=ke=0,lo=null,Yn=Ve.next();nn!==null&&!Yn.done;fn++,Yn=Ve.next()){nn.index>fn?(lo=nn,nn=null):lo=nn.sibling;var Lc=it(Me,nn,Yn.value,ut);if(Lc===null){nn===null&&(nn=lo);break}c&&nn&&Lc.alternate===null&&f(Me,nn),ke=V(Lc,ke,fn),tn===null?Bt=Lc:tn.sibling=Lc,tn=Lc,nn=lo}if(Yn.done)return g(Me,nn),Qe&&Ce(Me,fn),Bt;if(nn===null){for(;!Yn.done;fn++,Yn=Ve.next())Yn=st(Me,Yn.value,ut),Yn!==null&&(ke=V(Yn,ke,fn),tn===null?Bt=Yn:tn.sibling=Yn,tn=Yn);return Qe&&Ce(Me,fn),Bt}for(nn=_(Me,nn);!Yn.done;fn++,Yn=Ve.next())Yn=mt(nn,Me,fn,Yn.value,ut),Yn!==null&&(c&&Yn.alternate!==null&&nn.delete(Yn.key===null?fn:Yn.key),ke=V(Yn,ke,fn),tn===null?Bt=Yn:tn.sibling=Yn,tn=Yn);return c&&nn.forEach(function(gD){return f(Me,gD)}),Qe&&Ce(Me,fn),Bt}function mi(Me,ke,Ve,ut){if(typeof Ve=="object"&&Ve!==null&&Ve.type===L&&Ve.key===null&&(Ve=Ve.props.children),typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case D:e:{for(var Bt=Ve.key,tn=ke;tn!==null;){if(tn.key===Bt){if(Bt=Ve.type,Bt===L){if(tn.tag===7){g(Me,tn.sibling),ke=R(tn,Ve.props.children),ke.return=Me,Me=ke;break e}}else if(tn.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===ge&&wr(Bt)===tn.type){g(Me,tn.sibling),ke=R(tn,Ve.props),ke.ref=ln(Me,tn,Ve),ke.return=Me,Me=ke;break e}g(Me,tn);break}else f(Me,tn);tn=tn.sibling}Ve.type===L?(ke=Uh(Ve.props.children,Me.mode,ut,Ve.key),ke.return=Me,Me=ke):(ut=Mg(Ve.type,Ve.key,Ve.props,null,Me.mode,ut),ut.ref=ln(Me,ke,Ve),ut.return=Me,Me=ut)}return K(Me);case z:e:{for(tn=Ve.key;ke!==null;){if(ke.key===tn)if(ke.tag===4&&ke.stateNode.containerInfo===Ve.containerInfo&&ke.stateNode.implementation===Ve.implementation){g(Me,ke.sibling),ke=R(ke,Ve.children||[]),ke.return=Me,Me=ke;break e}else{g(Me,ke);break}else f(Me,ke);ke=ke.sibling}ke=oy(Ve,Me.mode,ut),ke.return=Me,Me=ke}return K(Me);case ge:return tn=Ve._init,mi(Me,ke,tn(Ve._payload),ut)}if(ft(Ve))return Tt(Me,ke,Ve,ut);if(ae(Ve))return Pt(Me,ke,Ve,ut);In(Me,Ve)}return typeof Ve=="string"&&Ve!==""||typeof Ve=="number"?(Ve=""+Ve,ke!==null&&ke.tag===6?(g(Me,ke.sibling),ke=R(ke,Ve),ke.return=Me,Me=ke):(g(Me,ke),ke=iy(Ve,Me.mode,ut),ke.return=Me,Me=ke),K(Me)):g(Me,ke)}return mi}var ei=Ii(!0),Ir=Ii(!1),di=ia(null),Ti=null,Er=null,Ln=null;function Hn(){Ln=Er=Ti=null}function Sr(c){var f=di.current;Zn(di),c._currentValue=f}function Gn(c,f,g){for(;c!==null;){var _=c.alternate;if((c.childLanes&f)!==f?(c.childLanes|=f,_!==null&&(_.childLanes|=f)):_!==null&&(_.childLanes&f)!==f&&(_.childLanes|=f),c===g)break;c=c.return}}function Or(c,f){Ti=c,Ln=Er=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&f)!==0&&(Fs=!0),c.firstContext=null)}function Fr(c){var f=c._currentValue;if(Ln!==c)if(c={context:c,memoizedValue:f,next:null},Er===null){if(Ti===null)throw Error(t(308));Er=c,Ti.dependencies={lanes:0,firstContext:c}}else Er=Er.next=c;return f}var ur=null;function oo(c){ur===null?ur=[c]:ur.push(c)}function rr(c,f,g,_){var R=f.interleaved;return R===null?(g.next=g,oo(f)):(g.next=R.next,R.next=g),f.interleaved=g,lr(c,_)}function lr(c,f){c.lanes|=f;var g=c.alternate;for(g!==null&&(g.lanes|=f),g=c,c=c.return;c!==null;)c.childLanes|=f,g=c.alternate,g!==null&&(g.childLanes|=f),g=c,c=c.return;return g.tag===3?g.stateNode:null}var ti=!1;function ji(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Go(c,f){c=c.updateQueue,f.updateQueue===c&&(f.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function Wr(c,f){return{eventTime:c,lane:f,tag:0,payload:null,callback:null,next:null}}function qr(c,f,g){var _=c.updateQueue;if(_===null)return null;if(_=_.shared,($n&2)!==0){var R=_.pending;return R===null?f.next=f:(f.next=R.next,R.next=f),_.pending=f,lr(c,g)}return R=_.interleaved,R===null?(f.next=f,oo(_)):(f.next=R.next,R.next=f),_.interleaved=f,lr(c,g)}function so(c,f,g){if(f=f.updateQueue,f!==null&&(f=f.shared,(g&4194240)!==0)){var _=f.lanes;_&=c.pendingLanes,g|=_,f.lanes=g,Pu(c,g)}}function cr(c,f){var g=c.updateQueue,_=c.alternate;if(_!==null&&(_=_.updateQueue,g===_)){var R=null,V=null;if(g=g.firstBaseUpdate,g!==null){do{var K={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};V===null?R=V=K:V=V.next=K,g=g.next}while(g!==null);V===null?R=V=f:V=V.next=f}else R=V=f;g={baseState:_.baseState,firstBaseUpdate:R,lastBaseUpdate:V,shared:_.shared,effects:_.effects},c.updateQueue=g;return}c=g.lastBaseUpdate,c===null?g.firstBaseUpdate=f:c.next=f,g.lastBaseUpdate=f}function ao(c,f,g,_){var R=c.updateQueue;ti=!1;var V=R.firstBaseUpdate,K=R.lastBaseUpdate,ye=R.shared.pending;if(ye!==null){R.shared.pending=null;var Ee=ye,ze=Ee.next;Ee.next=null,K===null?V=ze:K.next=ze,K=Ee;var ot=c.alternate;ot!==null&&(ot=ot.updateQueue,ye=ot.lastBaseUpdate,ye!==K&&(ye===null?ot.firstBaseUpdate=ze:ye.next=ze,ot.lastBaseUpdate=Ee))}if(V!==null){var st=R.baseState;K=0,ot=ze=Ee=null,ye=V;do{var it=ye.lane,mt=ye.eventTime;if((_&it)===it){ot!==null&&(ot=ot.next={eventTime:mt,lane:0,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null});e:{var Tt=c,Pt=ye;switch(it=f,mt=g,Pt.tag){case 1:if(Tt=Pt.payload,typeof Tt=="function"){st=Tt.call(mt,st,it);break e}st=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=Pt.payload,it=typeof Tt=="function"?Tt.call(mt,st,it):Tt,it==null)break e;st=fe({},st,it);break e;case 2:ti=!0}}ye.callback!==null&&ye.lane!==0&&(c.flags|=64,it=R.effects,it===null?R.effects=[ye]:it.push(ye))}else mt={eventTime:mt,lane:it,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},ot===null?(ze=ot=mt,Ee=st):ot=ot.next=mt,K|=it;if(ye=ye.next,ye===null){if(ye=R.shared.pending,ye===null)break;it=ye,ye=it.next,it.next=null,R.lastBaseUpdate=it,R.shared.pending=null}}while(!0);if(ot===null&&(Ee=st),R.baseState=Ee,R.firstBaseUpdate=ze,R.lastBaseUpdate=ot,f=R.shared.interleaved,f!==null){R=f;do K|=R.lane,R=R.next;while(R!==f)}else V===null&&(R.shared.lanes=0);Fh|=K,c.lanes=K,c.memoizedState=st}}function Os(c,f,g){if(c=f.effects,f.effects=null,c!==null)for(f=0;f<c.length;f++){var _=c[f],R=_.callback;if(R!==null){if(_.callback=null,_=g,typeof R!="function")throw Error(t(191,R));R.call(_)}}}var oa={},ki=ia(oa),Hr=ia(oa),Hu=ia(oa);function au(c){if(c===oa)throw Error(t(174));return c}function Sc(c,f){switch(nr(Hu,f),nr(Hr,c),nr(ki,oa),c=f.nodeType,c){case 9:case 11:f=(f=f.documentElement)?f.namespaceURI:an(null,"");break;default:c=c===8?f.parentNode:f,f=c.namespaceURI||null,c=c.tagName,f=an(f,c)}Zn(ki),nr(ki,f)}function Oa(){Zn(ki),Zn(Hr),Zn(Hu)}function gg(c){au(Hu.current);var f=au(ki.current),g=an(f,c.type);f!==g&&(nr(Hr,c),nr(ki,g))}function Ap(c){Hr.current===c&&(Zn(ki),Zn(Hr))}var xr=ia(0);function sa(c){for(var f=c;f!==null;){if(f.tag===13){var g=f.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var Cp=[];function Ip(){for(var c=0;c<Cp.length;c++)Cp[c]._workInProgressVersionPrimary=null;Cp.length=0}var Mf=C.ReactCurrentDispatcher,Of=C.ReactCurrentBatchConfig,Fa=0,Ar=null,ni=null,Gr=null,Ac=!1,uu=!1,Cc=0,N1=0;function pi(){throw Error(t(321))}function Ff(c,f){if(f===null)return!1;for(var g=0;g<f.length&&g<c.length;g++)if(!Dr(c[g],f[g]))return!1;return!0}function Lh(c,f,g,_,R,V){if(Fa=V,Ar=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,Mf.current=c===null||c.memoizedState===null?zP:WP,c=g(_,R),uu){V=0;do{if(uu=!1,Cc=0,25<=V)throw Error(t(301));V+=1,Gr=ni=null,f.updateQueue=null,Mf.current=qP,c=g(_,R)}while(uu)}if(Mf.current=xg,f=ni!==null&&ni.next!==null,Fa=0,Gr=ni=Ar=null,Ac=!1,f)throw Error(t(300));return c}function Ba(){var c=Cc!==0;return Cc=0,c}function aa(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gr===null?Ar.memoizedState=Gr=c:Gr=Gr.next=c,Gr}function bs(){if(ni===null){var c=Ar.alternate;c=c!==null?c.memoizedState:null}else c=ni.next;var f=Gr===null?Ar.memoizedState:Gr.next;if(f!==null)Gr=f,ni=c;else{if(c===null)throw Error(t(310));ni=c,c={memoizedState:ni.memoizedState,baseState:ni.baseState,baseQueue:ni.baseQueue,queue:ni.queue,next:null},Gr===null?Ar.memoizedState=Gr=c:Gr=Gr.next=c}return Gr}function Mh(c,f){return typeof f=="function"?f(c):f}function Bf(c){var f=bs(),g=f.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=c;var _=ni,R=_.baseQueue,V=g.pending;if(V!==null){if(R!==null){var K=R.next;R.next=V.next,V.next=K}_.baseQueue=R=V,g.pending=null}if(R!==null){V=R.next,_=_.baseState;var ye=K=null,Ee=null,ze=V;do{var ot=ze.lane;if((Fa&ot)===ot)Ee!==null&&(Ee=Ee.next={lane:0,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null}),_=ze.hasEagerState?ze.eagerState:c(_,ze.action);else{var st={lane:ot,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null};Ee===null?(ye=Ee=st,K=_):Ee=Ee.next=st,Ar.lanes|=ot,Fh|=ot}ze=ze.next}while(ze!==null&&ze!==V);Ee===null?K=_:Ee.next=ye,Dr(_,f.memoizedState)||(Fs=!0),f.memoizedState=_,f.baseState=K,f.baseQueue=Ee,g.lastRenderedState=_}if(c=g.interleaved,c!==null){R=c;do V=R.lane,Ar.lanes|=V,Fh|=V,R=R.next;while(R!==c)}else R===null&&(g.lanes=0);return[f.memoizedState,g.dispatch]}function Gu(c){var f=bs(),g=f.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=c;var _=g.dispatch,R=g.pending,V=f.memoizedState;if(R!==null){g.pending=null;var K=R=R.next;do V=c(V,K.action),K=K.next;while(K!==R);Dr(V,f.memoizedState)||(Fs=!0),f.memoizedState=V,f.baseQueue===null&&(f.baseState=V),g.lastRenderedState=V}return[V,_]}function vg(){}function Tp(c,f){var g=Ar,_=bs(),R=f(),V=!Dr(_.memoizedState,R);if(V&&(_.memoizedState=R,Fs=!0),_=_.queue,Uf(wg.bind(null,g,_,c),[c]),_.getSnapshot!==f||V||Gr!==null&&Gr.memoizedState.tag&1){if(g.flags|=2048,xs(9,kp.bind(null,g,_,R,f),void 0,null),uo===null)throw Error(t(349));(Fa&30)!==0||yg(g,f,R)}return R}function yg(c,f,g){c.flags|=16384,c={getSnapshot:f,value:g},f=Ar.updateQueue,f===null?(f={lastEffect:null,stores:null},Ar.updateQueue=f,f.stores=[c]):(g=f.stores,g===null?f.stores=[c]:g.push(c))}function kp(c,f,g,_){f.value=g,f.getSnapshot=_,Ic(f)&&Vf(c)}function wg(c,f,g){return g(function(){Ic(f)&&Vf(c)})}function Ic(c){var f=c.getSnapshot;c=c.value;try{var g=f();return!Dr(c,g)}catch{return!0}}function Vf(c){var f=lr(c,1);f!==null&&du(f,c,1,-1)}function Oh(c){var f=aa();return typeof c=="function"&&(c=c()),f.memoizedState=f.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mh,lastRenderedState:c},f.queue=c,c=c.dispatch=UP.bind(null,Ar,c),[f.memoizedState,c]}function xs(c,f,g,_){return c={tag:c,create:f,destroy:g,deps:_,next:null},f=Ar.updateQueue,f===null?(f={lastEffect:null,stores:null},Ar.updateQueue=f,f.lastEffect=c.next=c):(g=f.lastEffect,g===null?f.lastEffect=c.next=c:(_=g.next,g.next=c,c.next=_,f.lastEffect=c)),c}function lu(){return bs().memoizedState}function ua(c,f,g,_){var R=aa();Ar.flags|=c,R.memoizedState=xs(1|f,g,void 0,_===void 0?null:_)}function jl(c,f,g,_){var R=bs();_=_===void 0?null:_;var V=void 0;if(ni!==null){var K=ni.memoizedState;if(V=K.destroy,_!==null&&Ff(_,K.deps)){R.memoizedState=xs(f,g,V,_);return}}Ar.flags|=c,R.memoizedState=xs(1|f,g,V,_)}function jf(c,f){return ua(8390656,8,c,f)}function Uf(c,f){return jl(2048,8,c,f)}function bg(c,f){return jl(4,2,c,f)}function zf(c,f){return jl(4,4,c,f)}function Wf(c,f){if(typeof f=="function")return c=c(),f(c),function(){f(null)};if(f!=null)return c=c(),f.current=c,function(){f.current=null}}function C_(c,f,g){return g=g!=null?g.concat([c]):null,jl(4,4,Wf.bind(null,f,c),g)}function R1(){}function I_(c,f){var g=bs();f=f===void 0?null:f;var _=g.memoizedState;return _!==null&&f!==null&&Ff(f,_[1])?_[0]:(g.memoizedState=[c,f],c)}function T_(c,f){var g=bs();f=f===void 0?null:f;var _=g.memoizedState;return _!==null&&f!==null&&Ff(f,_[1])?_[0]:(c=c(),g.memoizedState=[c,f],c)}function k_(c,f,g){return(Fa&21)===0?(c.baseState&&(c.baseState=!1,Fs=!0),c.memoizedState=g):(Dr(g,f)||(g=Ru(),Ar.lanes|=g,Fh|=g,c.baseState=!0),f)}function VP(c,f){var g=An;An=g!==0&&4>g?g:4,c(!0);var _=Of.transition;Of.transition={};try{c(!1),f()}finally{An=g,Of.transition=_}}function N_(){return bs().memoizedState}function jP(c,f,g){var _=Rc(c);if(g={lane:_,action:g,hasEagerState:!1,eagerState:null,next:null},R_(c))P_(f,g);else if(g=rr(c,f,g,_),g!==null){var R=Es();du(g,c,_,R),D_(g,f,_)}}function UP(c,f,g){var _=Rc(c),R={lane:_,action:g,hasEagerState:!1,eagerState:null,next:null};if(R_(c))P_(f,R);else{var V=c.alternate;if(c.lanes===0&&(V===null||V.lanes===0)&&(V=f.lastRenderedReducer,V!==null))try{var K=f.lastRenderedState,ye=V(K,g);if(R.hasEagerState=!0,R.eagerState=ye,Dr(ye,K)){var Ee=f.interleaved;Ee===null?(R.next=R,oo(f)):(R.next=Ee.next,Ee.next=R),f.interleaved=R;return}}catch{}finally{}g=rr(c,f,R,_),g!==null&&(R=Es(),du(g,c,_,R),D_(g,f,_))}}function R_(c){var f=c.alternate;return c===Ar||f!==null&&f===Ar}function P_(c,f){uu=Ac=!0;var g=c.pending;g===null?f.next=f:(f.next=g.next,g.next=f),c.pending=f}function D_(c,f,g){if((g&4194240)!==0){var _=f.lanes;_&=c.pendingLanes,g|=_,f.lanes=g,Pu(c,g)}}var xg={readContext:Fr,useCallback:pi,useContext:pi,useEffect:pi,useImperativeHandle:pi,useInsertionEffect:pi,useLayoutEffect:pi,useMemo:pi,useReducer:pi,useRef:pi,useState:pi,useDebugValue:pi,useDeferredValue:pi,useTransition:pi,useMutableSource:pi,useSyncExternalStore:pi,useId:pi,unstable_isNewReconciler:!1},zP={readContext:Fr,useCallback:function(c,f){return aa().memoizedState=[c,f===void 0?null:f],c},useContext:Fr,useEffect:jf,useImperativeHandle:function(c,f,g){return g=g!=null?g.concat([c]):null,ua(4194308,4,Wf.bind(null,f,c),g)},useLayoutEffect:function(c,f){return ua(4194308,4,c,f)},useInsertionEffect:function(c,f){return ua(4,2,c,f)},useMemo:function(c,f){var g=aa();return f=f===void 0?null:f,c=c(),g.memoizedState=[c,f],c},useReducer:function(c,f,g){var _=aa();return f=g!==void 0?g(f):f,_.memoizedState=_.baseState=f,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:f},_.queue=c,c=c.dispatch=jP.bind(null,Ar,c),[_.memoizedState,c]},useRef:function(c){var f=aa();return c={current:c},f.memoizedState=c},useState:Oh,useDebugValue:R1,useDeferredValue:function(c){return aa().memoizedState=c},useTransition:function(){var c=Oh(!1),f=c[0];return c=VP.bind(null,c[1]),aa().memoizedState=c,[f,c]},useMutableSource:function(){},useSyncExternalStore:function(c,f,g){var _=Ar,R=aa();if(Qe){if(g===void 0)throw Error(t(407));g=g()}else{if(g=f(),uo===null)throw Error(t(349));(Fa&30)!==0||yg(_,f,g)}R.memoizedState=g;var V={value:g,getSnapshot:f};return R.queue=V,jf(wg.bind(null,_,V,c),[c]),_.flags|=2048,xs(9,kp.bind(null,_,V,g,f),void 0,null),g},useId:function(){var c=aa(),f=uo.identifierPrefix;if(Qe){var g=he,_=De;g=(_&~(1<<32-Pr(_)-1)).toString(32)+g,f=":"+f+"R"+g,g=Cc++,0<g&&(f+="H"+g.toString(32)),f+=":"}else g=N1++,f=":"+f+"r"+g.toString(32)+":";return c.memoizedState=f},unstable_isNewReconciler:!1},WP={readContext:Fr,useCallback:I_,useContext:Fr,useEffect:Uf,useImperativeHandle:C_,useInsertionEffect:bg,useLayoutEffect:zf,useMemo:T_,useReducer:Bf,useRef:lu,useState:function(){return Bf(Mh)},useDebugValue:R1,useDeferredValue:function(c){var f=bs();return k_(f,ni.memoizedState,c)},useTransition:function(){var c=Bf(Mh)[0],f=bs().memoizedState;return[c,f]},useMutableSource:vg,useSyncExternalStore:Tp,useId:N_,unstable_isNewReconciler:!1},qP={readContext:Fr,useCallback:I_,useContext:Fr,useEffect:Uf,useImperativeHandle:C_,useInsertionEffect:bg,useLayoutEffect:zf,useMemo:T_,useReducer:Gu,useRef:lu,useState:function(){return Gu(Mh)},useDebugValue:R1,useDeferredValue:function(c){var f=bs();return ni===null?f.memoizedState=c:k_(f,ni.memoizedState,c)},useTransition:function(){var c=Gu(Mh)[0],f=bs().memoizedState;return[c,f]},useMutableSource:vg,useSyncExternalStore:Tp,useId:N_,unstable_isNewReconciler:!1};function cu(c,f){if(c&&c.defaultProps){f=fe({},f),c=c.defaultProps;for(var g in c)f[g]===void 0&&(f[g]=c[g]);return f}return f}function P1(c,f,g,_){f=c.memoizedState,g=g(_,f),g=g==null?f:fe({},f,g),c.memoizedState=g,c.lanes===0&&(c.updateQueue.baseState=g)}var _g={isMounted:function(c){return(c=c._reactInternals)?Vr(c)===c:!1},enqueueSetState:function(c,f,g){c=c._reactInternals;var _=Es(),R=Rc(c),V=Wr(_,R);V.payload=f,g!=null&&(V.callback=g),f=qr(c,V,R),f!==null&&(du(f,c,R,_),so(f,c,R))},enqueueReplaceState:function(c,f,g){c=c._reactInternals;var _=Es(),R=Rc(c),V=Wr(_,R);V.tag=1,V.payload=f,g!=null&&(V.callback=g),f=qr(c,V,R),f!==null&&(du(f,c,R,_),so(f,c,R))},enqueueForceUpdate:function(c,f){c=c._reactInternals;var g=Es(),_=Rc(c),R=Wr(g,_);R.tag=2,f!=null&&(R.callback=f),f=qr(c,R,_),f!==null&&(du(f,c,_,g),so(f,c,_))}};function L_(c,f,g,_,R,V,K){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(_,V,K):f.prototype&&f.prototype.isPureReactComponent?!Uo(g,_)||!Uo(R,V):!0}function M_(c,f,g){var _=!1,R=qu,V=f.contextType;return typeof V=="object"&&V!==null?V=Fr(V):(R=Ho(f)?Bl:Vi.current,_=f.contextTypes,V=(_=_!=null)?Ec(c,R):qu),f=new f(g,V),c.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=_g,c.stateNode=f,f._reactInternals=c,_&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=R,c.__reactInternalMemoizedMaskedChildContext=V),f}function O_(c,f,g,_){c=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(g,_),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(g,_),f.state!==c&&_g.enqueueReplaceState(f,f.state,null)}function D1(c,f,g,_){var R=c.stateNode;R.props=g,R.state=c.memoizedState,R.refs={},ji(c);var V=f.contextType;typeof V=="object"&&V!==null?R.context=Fr(V):(V=Ho(f)?Bl:Vi.current,R.context=Ec(c,V)),R.state=c.memoizedState,V=f.getDerivedStateFromProps,typeof V=="function"&&(P1(c,f,V,g),R.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(f=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),f!==R.state&&_g.enqueueReplaceState(R,R.state,null),ao(c,g,R,_),R.state=c.memoizedState),typeof R.componentDidMount=="function"&&(c.flags|=4194308)}function qf(c,f){try{var g="",_=f;do g+=de(_),_=_.return;while(_);var R=g}catch(V){R=`
Error generating stack: `+V.message+`
`+V.stack}return{value:c,source:f,stack:R,digest:null}}function L1(c,f,g){return{value:c,source:null,stack:g??null,digest:f??null}}function M1(c,f){try{console.error(f.value)}catch(g){setTimeout(function(){throw g})}}var HP=typeof WeakMap=="function"?WeakMap:Map;function F_(c,f,g){g=Wr(-1,g),g.tag=3,g.payload={element:null};var _=f.value;return g.callback=function(){kg||(kg=!0,Y1=_),M1(c,f)},g}function B_(c,f,g){g=Wr(-1,g),g.tag=3;var _=c.type.getDerivedStateFromError;if(typeof _=="function"){var R=f.value;g.payload=function(){return _(R)},g.callback=function(){M1(c,f)}}var V=c.stateNode;return V!==null&&typeof V.componentDidCatch=="function"&&(g.callback=function(){M1(c,f),typeof _!="function"&&(kc===null?kc=new Set([this]):kc.add(this));var K=f.stack;this.componentDidCatch(f.value,{componentStack:K!==null?K:""})}),g}function V_(c,f,g){var _=c.pingCache;if(_===null){_=c.pingCache=new HP;var R=new Set;_.set(f,R)}else R=_.get(f),R===void 0&&(R=new Set,_.set(f,R));R.has(g)||(R.add(g),c=oD.bind(null,c,f,g),f.then(c,c))}function j_(c){do{var f;if((f=c.tag===13)&&(f=c.memoizedState,f=f!==null?f.dehydrated!==null:!0),f)return c;c=c.return}while(c!==null);return null}function U_(c,f,g,_,R){return(c.mode&1)===0?(c===f?c.flags|=65536:(c.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(f=Wr(-1,1),f.tag=2,qr(g,f,1))),g.lanes|=1),c):(c.flags|=65536,c.lanes=R,c)}var GP=C.ReactCurrentOwner,Fs=!1;function _s(c,f,g,_){f.child=c===null?Ir(f,null,g,_):ei(f,c.child,g,_)}function z_(c,f,g,_,R){g=g.render;var V=f.ref;return Or(f,R),_=Lh(c,f,g,_,V,R),g=Ba(),c!==null&&!Fs?(f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~R,Ul(c,f,R)):(Qe&&g&&$e(f),f.flags|=1,_s(c,f,_,R),f.child)}function W_(c,f,g,_,R){if(c===null){var V=g.type;return typeof V=="function"&&!ry(V)&&V.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(f.tag=15,f.type=V,q_(c,f,V,_,R)):(c=Mg(g.type,null,_,f,f.mode,R),c.ref=f.ref,c.return=f,f.child=c)}if(V=c.child,(c.lanes&R)===0){var K=V.memoizedProps;if(g=g.compare,g=g!==null?g:Uo,g(K,_)&&c.ref===f.ref)return Ul(c,f,R)}return f.flags|=1,c=Dc(V,_),c.ref=f.ref,c.return=f,f.child=c}function q_(c,f,g,_,R){if(c!==null){var V=c.memoizedProps;if(Uo(V,_)&&c.ref===f.ref)if(Fs=!1,f.pendingProps=_=V,(c.lanes&R)!==0)(c.flags&131072)!==0&&(Fs=!0);else return f.lanes=c.lanes,Ul(c,f,R)}return O1(c,f,g,_,R)}function H_(c,f,g){var _=f.pendingProps,R=_.children,V=c!==null?c.memoizedState:null;if(_.mode==="hidden")if((f.mode&1)===0)f.memoizedState={baseLanes:0,cachePool:null,transitions:null},nr(Gf,la),la|=g;else{if((g&1073741824)===0)return c=V!==null?V.baseLanes|g:g,f.lanes=f.childLanes=1073741824,f.memoizedState={baseLanes:c,cachePool:null,transitions:null},f.updateQueue=null,nr(Gf,la),la|=c,null;f.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=V!==null?V.baseLanes:g,nr(Gf,la),la|=_}else V!==null?(_=V.baseLanes|g,f.memoizedState=null):_=g,nr(Gf,la),la|=_;return _s(c,f,R,g),f.child}function G_(c,f){var g=f.ref;(c===null&&g!==null||c!==null&&c.ref!==g)&&(f.flags|=512,f.flags|=2097152)}function O1(c,f,g,_,R){var V=Ho(g)?Bl:Vi.current;return V=Ec(f,V),Or(f,R),g=Lh(c,f,g,_,V,R),_=Ba(),c!==null&&!Fs?(f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~R,Ul(c,f,R)):(Qe&&_&&$e(f),f.flags|=1,_s(c,f,g,R),f.child)}function $_(c,f,g,_,R){if(Ho(g)){var V=!0;Vl(f)}else V=!1;if(Or(f,R),f.stateNode===null)Sg(c,f),M_(f,g,_),D1(f,g,_,R),_=!0;else if(c===null){var K=f.stateNode,ye=f.memoizedProps;K.props=ye;var Ee=K.context,ze=g.contextType;typeof ze=="object"&&ze!==null?ze=Fr(ze):(ze=Ho(g)?Bl:Vi.current,ze=Ec(f,ze));var ot=g.getDerivedStateFromProps,st=typeof ot=="function"||typeof K.getSnapshotBeforeUpdate=="function";st||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ye!==_||Ee!==ze)&&O_(f,K,_,ze),ti=!1;var it=f.memoizedState;K.state=it,ao(f,_,K,R),Ee=f.memoizedState,ye!==_||it!==Ee||qo.current||ti?(typeof ot=="function"&&(P1(f,g,ot,_),Ee=f.memoizedState),(ye=ti||L_(f,g,ye,_,it,Ee,ze))?(st||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount()),typeof K.componentDidMount=="function"&&(f.flags|=4194308)):(typeof K.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=_,f.memoizedState=Ee),K.props=_,K.state=Ee,K.context=ze,_=ye):(typeof K.componentDidMount=="function"&&(f.flags|=4194308),_=!1)}else{K=f.stateNode,Go(c,f),ye=f.memoizedProps,ze=f.type===f.elementType?ye:cu(f.type,ye),K.props=ze,st=f.pendingProps,it=K.context,Ee=g.contextType,typeof Ee=="object"&&Ee!==null?Ee=Fr(Ee):(Ee=Ho(g)?Bl:Vi.current,Ee=Ec(f,Ee));var mt=g.getDerivedStateFromProps;(ot=typeof mt=="function"||typeof K.getSnapshotBeforeUpdate=="function")||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ye!==st||it!==Ee)&&O_(f,K,_,Ee),ti=!1,it=f.memoizedState,K.state=it,ao(f,_,K,R);var Tt=f.memoizedState;ye!==st||it!==Tt||qo.current||ti?(typeof mt=="function"&&(P1(f,g,mt,_),Tt=f.memoizedState),(ze=ti||L_(f,g,ze,_,it,Tt,Ee)||!1)?(ot||typeof K.UNSAFE_componentWillUpdate!="function"&&typeof K.componentWillUpdate!="function"||(typeof K.componentWillUpdate=="function"&&K.componentWillUpdate(_,Tt,Ee),typeof K.UNSAFE_componentWillUpdate=="function"&&K.UNSAFE_componentWillUpdate(_,Tt,Ee)),typeof K.componentDidUpdate=="function"&&(f.flags|=4),typeof K.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof K.componentDidUpdate!="function"||ye===c.memoizedProps&&it===c.memoizedState||(f.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ye===c.memoizedProps&&it===c.memoizedState||(f.flags|=1024),f.memoizedProps=_,f.memoizedState=Tt),K.props=_,K.state=Tt,K.context=Ee,_=ze):(typeof K.componentDidUpdate!="function"||ye===c.memoizedProps&&it===c.memoizedState||(f.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ye===c.memoizedProps&&it===c.memoizedState||(f.flags|=1024),_=!1)}return F1(c,f,g,_,V,R)}function F1(c,f,g,_,R,V){G_(c,f);var K=(f.flags&128)!==0;if(!_&&!K)return R&&mg(f,g,!1),Ul(c,f,V);_=f.stateNode,GP.current=f;var ye=K&&typeof g.getDerivedStateFromError!="function"?null:_.render();return f.flags|=1,c!==null&&K?(f.child=ei(f,c.child,null,V),f.child=ei(f,null,ye,V)):_s(c,f,ye,V),f.memoizedState=_.state,R&&mg(f,g,!0),f.child}function K_(c){var f=c.stateNode;f.pendingContext?pg(c,f.pendingContext,f.pendingContext!==f.context):f.context&&pg(c,f.context,!1),Sc(c,f.containerInfo)}function X_(c,f,g,_,R){return xt(),ct(R),f.flags|=256,_s(c,f,g,_),f.child}var B1={dehydrated:null,treeContext:null,retryLane:0};function V1(c){return{baseLanes:c,cachePool:null,transitions:null}}function Y_(c,f,g){var _=f.pendingProps,R=xr.current,V=!1,K=(f.flags&128)!==0,ye;if((ye=K)||(ye=c!==null&&c.memoizedState===null?!1:(R&2)!==0),ye?(V=!0,f.flags&=-129):(c===null||c.memoizedState!==null)&&(R|=1),nr(xr,R&1),c===null)return Ct(f),c=f.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((f.mode&1)===0?f.lanes=1:c.data==="$!"?f.lanes=8:f.lanes=1073741824,null):(K=_.children,c=_.fallback,V?(_=f.mode,V=f.child,K={mode:"hidden",children:K},(_&1)===0&&V!==null?(V.childLanes=0,V.pendingProps=K):V=Og(K,_,0,null),c=Uh(c,_,g,null),V.return=f,c.return=f,V.sibling=c,f.child=V,f.child.memoizedState=V1(g),f.memoizedState=B1,c):j1(f,K));if(R=c.memoizedState,R!==null&&(ye=R.dehydrated,ye!==null))return $P(c,f,K,_,ye,R,g);if(V){V=_.fallback,K=f.mode,R=c.child,ye=R.sibling;var Ee={mode:"hidden",children:_.children};return(K&1)===0&&f.child!==R?(_=f.child,_.childLanes=0,_.pendingProps=Ee,f.deletions=null):(_=Dc(R,Ee),_.subtreeFlags=R.subtreeFlags&14680064),ye!==null?V=Dc(ye,V):(V=Uh(V,K,g,null),V.flags|=2),V.return=f,_.return=f,_.sibling=V,f.child=_,_=V,V=f.child,K=c.child.memoizedState,K=K===null?V1(g):{baseLanes:K.baseLanes|g,cachePool:null,transitions:K.transitions},V.memoizedState=K,V.childLanes=c.childLanes&~g,f.memoizedState=B1,_}return V=c.child,c=V.sibling,_=Dc(V,{mode:"visible",children:_.children}),(f.mode&1)===0&&(_.lanes=g),_.return=f,_.sibling=null,c!==null&&(g=f.deletions,g===null?(f.deletions=[c],f.flags|=16):g.push(c)),f.child=_,f.memoizedState=null,_}function j1(c,f){return f=Og({mode:"visible",children:f},c.mode,0,null),f.return=c,c.child=f}function Eg(c,f,g,_){return _!==null&&ct(_),ei(f,c.child,null,g),c=j1(f,f.pendingProps.children),c.flags|=2,f.memoizedState=null,c}function $P(c,f,g,_,R,V,K){if(g)return f.flags&256?(f.flags&=-257,_=L1(Error(t(422))),Eg(c,f,K,_)):f.memoizedState!==null?(f.child=c.child,f.flags|=128,null):(V=_.fallback,R=f.mode,_=Og({mode:"visible",children:_.children},R,0,null),V=Uh(V,R,K,null),V.flags|=2,_.return=f,V.return=f,_.sibling=V,f.child=_,(f.mode&1)!==0&&ei(f,c.child,null,K),f.child.memoizedState=V1(K),f.memoizedState=B1,V);if((f.mode&1)===0)return Eg(c,f,K,null);if(R.data==="$!"){if(_=R.nextSibling&&R.nextSibling.dataset,_)var ye=_.dgst;return _=ye,V=Error(t(419)),_=L1(V,_,void 0),Eg(c,f,K,_)}if(ye=(K&c.childLanes)!==0,Fs||ye){if(_=uo,_!==null){switch(K&-K){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(_.suspendedLanes|K))!==0?0:R,R!==0&&R!==V.retryLane&&(V.retryLane=R,lr(c,R),du(_,c,R,-1))}return ny(),_=L1(Error(t(421))),Eg(c,f,K,_)}return R.data==="$?"?(f.flags|=128,f.child=c.child,f=sD.bind(null,c),R._reactRetry=f,null):(c=V.treeContext,Ge=Ao(R.nextSibling),qe=f,Qe=!0,Je=null,c!==null&&(ie[le++]=De,ie[le++]=he,ie[le++]=_e,De=c.id,he=c.overflow,_e=f),f=j1(f,_.children),f.flags|=4096,f)}function Q_(c,f,g){c.lanes|=f;var _=c.alternate;_!==null&&(_.lanes|=f),Gn(c.return,f,g)}function U1(c,f,g,_,R){var V=c.memoizedState;V===null?c.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:_,tail:g,tailMode:R}:(V.isBackwards=f,V.rendering=null,V.renderingStartTime=0,V.last=_,V.tail=g,V.tailMode=R)}function J_(c,f,g){var _=f.pendingProps,R=_.revealOrder,V=_.tail;if(_s(c,f,_.children,g),_=xr.current,(_&2)!==0)_=_&1|2,f.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=f.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Q_(c,g,f);else if(c.tag===19)Q_(c,g,f);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===f)break e;for(;c.sibling===null;){if(c.return===null||c.return===f)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}_&=1}if(nr(xr,_),(f.mode&1)===0)f.memoizedState=null;else switch(R){case"forwards":for(g=f.child,R=null;g!==null;)c=g.alternate,c!==null&&sa(c)===null&&(R=g),g=g.sibling;g=R,g===null?(R=f.child,f.child=null):(R=g.sibling,g.sibling=null),U1(f,!1,R,g,V);break;case"backwards":for(g=null,R=f.child,f.child=null;R!==null;){if(c=R.alternate,c!==null&&sa(c)===null){f.child=R;break}c=R.sibling,R.sibling=g,g=R,R=c}U1(f,!0,g,null,V);break;case"together":U1(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Sg(c,f){(f.mode&1)===0&&c!==null&&(c.alternate=null,f.alternate=null,f.flags|=2)}function Ul(c,f,g){if(c!==null&&(f.dependencies=c.dependencies),Fh|=f.lanes,(g&f.childLanes)===0)return null;if(c!==null&&f.child!==c.child)throw Error(t(153));if(f.child!==null){for(c=f.child,g=Dc(c,c.pendingProps),f.child=g,g.return=f;c.sibling!==null;)c=c.sibling,g=g.sibling=Dc(c,c.pendingProps),g.return=f;g.sibling=null}return f.child}function KP(c,f,g){switch(f.tag){case 3:K_(f),xt();break;case 5:gg(f);break;case 1:Ho(f.type)&&Vl(f);break;case 4:Sc(f,f.stateNode.containerInfo);break;case 10:var _=f.type._context,R=f.memoizedProps.value;nr(di,_._currentValue),_._currentValue=R;break;case 13:if(_=f.memoizedState,_!==null)return _.dehydrated!==null?(nr(xr,xr.current&1),f.flags|=128,null):(g&f.child.childLanes)!==0?Y_(c,f,g):(nr(xr,xr.current&1),c=Ul(c,f,g),c!==null?c.sibling:null);nr(xr,xr.current&1);break;case 19:if(_=(g&f.childLanes)!==0,(c.flags&128)!==0){if(_)return J_(c,f,g);f.flags|=128}if(R=f.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),nr(xr,xr.current),_)break;return null;case 22:case 23:return f.lanes=0,H_(c,f,g)}return Ul(c,f,g)}var Z_,z1,e5,t5;Z_=function(c,f){for(var g=f.child;g!==null;){if(g.tag===5||g.tag===6)c.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},z1=function(){},e5=function(c,f,g,_){var R=c.memoizedProps;if(R!==_){c=f.stateNode,au(ki.current);var V=null;switch(g){case"input":R=tt(c,R),_=tt(c,_),V=[];break;case"select":R=fe({},R,{value:void 0}),_=fe({},_,{value:void 0}),V=[];break;case"textarea":R=Et(c,R),_=Et(c,_),V=[];break;default:typeof R.onClick!="function"&&typeof _.onClick=="function"&&(c.onclick=bc)}On(g,_);var K;g=null;for(ze in R)if(!_.hasOwnProperty(ze)&&R.hasOwnProperty(ze)&&R[ze]!=null)if(ze==="style"){var ye=R[ze];for(K in ye)ye.hasOwnProperty(K)&&(g||(g={}),g[K]="")}else ze!=="dangerouslySetInnerHTML"&&ze!=="children"&&ze!=="suppressContentEditableWarning"&&ze!=="suppressHydrationWarning"&&ze!=="autoFocus"&&(i.hasOwnProperty(ze)?V||(V=[]):(V=V||[]).push(ze,null));for(ze in _){var Ee=_[ze];if(ye=R!=null?R[ze]:void 0,_.hasOwnProperty(ze)&&Ee!==ye&&(Ee!=null||ye!=null))if(ze==="style")if(ye){for(K in ye)!ye.hasOwnProperty(K)||Ee&&Ee.hasOwnProperty(K)||(g||(g={}),g[K]="");for(K in Ee)Ee.hasOwnProperty(K)&&ye[K]!==Ee[K]&&(g||(g={}),g[K]=Ee[K])}else g||(V||(V=[]),V.push(ze,g)),g=Ee;else ze==="dangerouslySetInnerHTML"?(Ee=Ee?Ee.__html:void 0,ye=ye?ye.__html:void 0,Ee!=null&&ye!==Ee&&(V=V||[]).push(ze,Ee)):ze==="children"?typeof Ee!="string"&&typeof Ee!="number"||(V=V||[]).push(ze,""+Ee):ze!=="suppressContentEditableWarning"&&ze!=="suppressHydrationWarning"&&(i.hasOwnProperty(ze)?(Ee!=null&&ze==="onScroll"&&ar("scroll",c),V||ye===Ee||(V=[])):(V=V||[]).push(ze,Ee))}g&&(V=V||[]).push("style",g);var ze=V;(f.updateQueue=ze)&&(f.flags|=4)}},t5=function(c,f,g,_){g!==_&&(f.flags|=4)};function Np(c,f){if(!Qe)switch(c.tailMode){case"hidden":f=c.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?c.tail=null:g.sibling=null;break;case"collapsed":g=c.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?f||c.tail===null?c.tail=null:c.tail.sibling=null:_.sibling=null}}function $o(c){var f=c.alternate!==null&&c.alternate.child===c.child,g=0,_=0;if(f)for(var R=c.child;R!==null;)g|=R.lanes|R.childLanes,_|=R.subtreeFlags&14680064,_|=R.flags&14680064,R.return=c,R=R.sibling;else for(R=c.child;R!==null;)g|=R.lanes|R.childLanes,_|=R.subtreeFlags,_|=R.flags,R.return=c,R=R.sibling;return c.subtreeFlags|=_,c.childLanes=g,f}function XP(c,f,g){var _=f.pendingProps;switch(Oe(f),f.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $o(f),null;case 1:return Ho(f.type)&&Lf(),$o(f),null;case 3:return _=f.stateNode,Oa(),Zn(qo),Zn(Vi),Ip(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(c===null||c.child===null)&&(Mr(f)?f.flags|=4:c===null||c.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Je!==null&&(Z1(Je),Je=null))),z1(c,f),$o(f),null;case 5:Ap(f);var R=au(Hu.current);if(g=f.type,c!==null&&f.stateNode!=null)e5(c,f,g,_,R),c.ref!==f.ref&&(f.flags|=512,f.flags|=2097152);else{if(!_){if(f.stateNode===null)throw Error(t(166));return $o(f),null}if(c=au(ki.current),Mr(f)){_=f.stateNode,g=f.type;var V=f.memoizedProps;switch(_[Ma]=f,_[xc]=V,c=(f.mode&1)!==0,g){case"dialog":ar("cancel",_),ar("close",_);break;case"iframe":case"object":case"embed":ar("load",_);break;case"video":case"audio":for(R=0;R<zu.length;R++)ar(zu[R],_);break;case"source":ar("error",_);break;case"img":case"image":case"link":ar("error",_),ar("load",_);break;case"details":ar("toggle",_);break;case"input":re(_,V),ar("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!V.multiple},ar("invalid",_);break;case"textarea":pt(_,V),ar("invalid",_)}On(g,V),R=null;for(var K in V)if(V.hasOwnProperty(K)){var ye=V[K];K==="children"?typeof ye=="string"?_.textContent!==ye&&(V.suppressHydrationWarning!==!0&&Df(_.textContent,ye,c),R=["children",ye]):typeof ye=="number"&&_.textContent!==""+ye&&(V.suppressHydrationWarning!==!0&&Df(_.textContent,ye,c),R=["children",""+ye]):i.hasOwnProperty(K)&&ye!=null&&K==="onScroll"&&ar("scroll",_)}switch(g){case"input":Ae(_),gt(_,V,!0);break;case"textarea":Ae(_),$t(_);break;case"select":case"option":break;default:typeof V.onClick=="function"&&(_.onclick=bc)}_=R,f.updateQueue=_,_!==null&&(f.flags|=4)}else{K=R.nodeType===9?R:R.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Qt(g)),c==="http://www.w3.org/1999/xhtml"?g==="script"?(c=K.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof _.is=="string"?c=K.createElement(g,{is:_.is}):(c=K.createElement(g),g==="select"&&(K=c,_.multiple?K.multiple=!0:_.size&&(K.size=_.size))):c=K.createElementNS(c,g),c[Ma]=f,c[xc]=_,Z_(c,f,!1,!1),f.stateNode=c;e:{switch(K=Ot(g,_),g){case"dialog":ar("cancel",c),ar("close",c),R=_;break;case"iframe":case"object":case"embed":ar("load",c),R=_;break;case"video":case"audio":for(R=0;R<zu.length;R++)ar(zu[R],c);R=_;break;case"source":ar("error",c),R=_;break;case"img":case"image":case"link":ar("error",c),ar("load",c),R=_;break;case"details":ar("toggle",c),R=_;break;case"input":re(c,_),R=tt(c,_),ar("invalid",c);break;case"option":R=_;break;case"select":c._wrapperState={wasMultiple:!!_.multiple},R=fe({},_,{value:void 0}),ar("invalid",c);break;case"textarea":pt(c,_),R=Et(c,_),ar("invalid",c);break;default:R=_}On(g,R),ye=R;for(V in ye)if(ye.hasOwnProperty(V)){var Ee=ye[V];V==="style"?rn(c,Ee):V==="dangerouslySetInnerHTML"?(Ee=Ee?Ee.__html:void 0,Ee!=null&&vt(c,Ee)):V==="children"?typeof Ee=="string"?(g!=="textarea"||Ee!=="")&&en(c,Ee):typeof Ee=="number"&&en(c,""+Ee):V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&V!=="autoFocus"&&(i.hasOwnProperty(V)?Ee!=null&&V==="onScroll"&&ar("scroll",c):Ee!=null&&P(c,V,Ee,K))}switch(g){case"input":Ae(c),gt(c,_,!1);break;case"textarea":Ae(c),$t(c);break;case"option":_.value!=null&&c.setAttribute("value",""+Se(_.value));break;case"select":c.multiple=!!_.multiple,V=_.value,V!=null?lt(c,!!_.multiple,V,!1):_.defaultValue!=null&&lt(c,!!_.multiple,_.defaultValue,!0);break;default:typeof R.onClick=="function"&&(c.onclick=bc)}switch(g){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(f.flags|=4)}f.ref!==null&&(f.flags|=512,f.flags|=2097152)}return $o(f),null;case 6:if(c&&f.stateNode!=null)t5(c,f,c.memoizedProps,_);else{if(typeof _!="string"&&f.stateNode===null)throw Error(t(166));if(g=au(Hu.current),au(ki.current),Mr(f)){if(_=f.stateNode,g=f.memoizedProps,_[Ma]=f,(V=_.nodeValue!==g)&&(c=qe,c!==null))switch(c.tag){case 3:Df(_.nodeValue,g,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&Df(_.nodeValue,g,(c.mode&1)!==0)}V&&(f.flags|=4)}else _=(g.nodeType===9?g:g.ownerDocument).createTextNode(_),_[Ma]=f,f.stateNode=_}return $o(f),null;case 13:if(Zn(xr),_=f.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(Qe&&Ge!==null&&(f.mode&1)!==0&&(f.flags&128)===0)yn(),xt(),f.flags|=98560,V=!1;else if(V=Mr(f),_!==null&&_.dehydrated!==null){if(c===null){if(!V)throw Error(t(318));if(V=f.memoizedState,V=V!==null?V.dehydrated:null,!V)throw Error(t(317));V[Ma]=f}else xt(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;$o(f),V=!1}else Je!==null&&(Z1(Je),Je=null),V=!0;if(!V)return f.flags&65536?f:null}return(f.flags&128)!==0?(f.lanes=g,f):(_=_!==null,_!==(c!==null&&c.memoizedState!==null)&&_&&(f.child.flags|=8192,(f.mode&1)!==0&&(c===null||(xr.current&1)!==0?Ui===0&&(Ui=3):ny())),f.updateQueue!==null&&(f.flags|=4),$o(f),null);case 4:return Oa(),z1(c,f),c===null&&Ll(f.stateNode.containerInfo),$o(f),null;case 10:return Sr(f.type._context),$o(f),null;case 17:return Ho(f.type)&&Lf(),$o(f),null;case 19:if(Zn(xr),V=f.memoizedState,V===null)return $o(f),null;if(_=(f.flags&128)!==0,K=V.rendering,K===null)if(_)Np(V,!1);else{if(Ui!==0||c!==null&&(c.flags&128)!==0)for(c=f.child;c!==null;){if(K=sa(c),K!==null){for(f.flags|=128,Np(V,!1),_=K.updateQueue,_!==null&&(f.updateQueue=_,f.flags|=4),f.subtreeFlags=0,_=g,g=f.child;g!==null;)V=g,c=_,V.flags&=14680066,K=V.alternate,K===null?(V.childLanes=0,V.lanes=c,V.child=null,V.subtreeFlags=0,V.memoizedProps=null,V.memoizedState=null,V.updateQueue=null,V.dependencies=null,V.stateNode=null):(V.childLanes=K.childLanes,V.lanes=K.lanes,V.child=K.child,V.subtreeFlags=0,V.deletions=null,V.memoizedProps=K.memoizedProps,V.memoizedState=K.memoizedState,V.updateQueue=K.updateQueue,V.type=K.type,c=K.dependencies,V.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),g=g.sibling;return nr(xr,xr.current&1|2),f.child}c=c.sibling}V.tail!==null&&Qn()>$f&&(f.flags|=128,_=!0,Np(V,!1),f.lanes=4194304)}else{if(!_)if(c=sa(K),c!==null){if(f.flags|=128,_=!0,g=c.updateQueue,g!==null&&(f.updateQueue=g,f.flags|=4),Np(V,!0),V.tail===null&&V.tailMode==="hidden"&&!K.alternate&&!Qe)return $o(f),null}else 2*Qn()-V.renderingStartTime>$f&&g!==1073741824&&(f.flags|=128,_=!0,Np(V,!1),f.lanes=4194304);V.isBackwards?(K.sibling=f.child,f.child=K):(g=V.last,g!==null?g.sibling=K:f.child=K,V.last=K)}return V.tail!==null?(f=V.tail,V.rendering=f,V.tail=f.sibling,V.renderingStartTime=Qn(),f.sibling=null,g=xr.current,nr(xr,_?g&1|2:g&1),f):($o(f),null);case 22:case 23:return ty(),_=f.memoizedState!==null,c!==null&&c.memoizedState!==null!==_&&(f.flags|=8192),_&&(f.mode&1)!==0?(la&1073741824)!==0&&($o(f),f.subtreeFlags&6&&(f.flags|=8192)):$o(f),null;case 24:return null;case 25:return null}throw Error(t(156,f.tag))}function YP(c,f){switch(Oe(f),f.tag){case 1:return Ho(f.type)&&Lf(),c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 3:return Oa(),Zn(qo),Zn(Vi),Ip(),c=f.flags,(c&65536)!==0&&(c&128)===0?(f.flags=c&-65537|128,f):null;case 5:return Ap(f),null;case 13:if(Zn(xr),c=f.memoizedState,c!==null&&c.dehydrated!==null){if(f.alternate===null)throw Error(t(340));xt()}return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 19:return Zn(xr),null;case 4:return Oa(),null;case 10:return Sr(f.type._context),null;case 22:case 23:return ty(),null;case 24:return null;default:return null}}var Ag=!1,Ko=!1,QP=typeof WeakSet=="function"?WeakSet:Set,At=null;function Hf(c,f){var g=c.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(_){ri(c,f,_)}else g.current=null}function W1(c,f,g){try{g()}catch(_){ri(c,f,_)}}var n5=!1;function JP(c,f){if(Rh=Zs,c=Zr(),ra(c)){if("selectionStart"in c)var g={start:c.selectionStart,end:c.selectionEnd};else e:{g=(g=c.ownerDocument)&&g.defaultView||window;var _=g.getSelection&&g.getSelection();if(_&&_.rangeCount!==0){g=_.anchorNode;var R=_.anchorOffset,V=_.focusNode;_=_.focusOffset;try{g.nodeType,V.nodeType}catch{g=null;break e}var K=0,ye=-1,Ee=-1,ze=0,ot=0,st=c,it=null;t:for(;;){for(var mt;st!==g||R!==0&&st.nodeType!==3||(ye=K+R),st!==V||_!==0&&st.nodeType!==3||(Ee=K+_),st.nodeType===3&&(K+=st.nodeValue.length),(mt=st.firstChild)!==null;)it=st,st=mt;for(;;){if(st===c)break t;if(it===g&&++ze===R&&(ye=K),it===V&&++ot===_&&(Ee=K),(mt=st.nextSibling)!==null)break;st=it,it=st.parentNode}st=mt}g=ye===-1||Ee===-1?null:{start:ye,end:Ee}}else g=null}g=g||{start:0,end:0}}else g=null;for(Ol={focusedElem:c,selectionRange:g},Zs=!1,At=f;At!==null;)if(f=At,c=f.child,(f.subtreeFlags&1028)!==0&&c!==null)c.return=f,At=c;else for(;At!==null;){f=At;try{var Tt=f.alternate;if((f.flags&1024)!==0)switch(f.tag){case 0:case 11:case 15:break;case 1:if(Tt!==null){var Pt=Tt.memoizedProps,mi=Tt.memoizedState,Me=f.stateNode,ke=Me.getSnapshotBeforeUpdate(f.elementType===f.type?Pt:cu(f.type,Pt),mi);Me.__reactInternalSnapshotBeforeUpdate=ke}break;case 3:var Ve=f.stateNode.containerInfo;Ve.nodeType===1?Ve.textContent="":Ve.nodeType===9&&Ve.documentElement&&Ve.removeChild(Ve.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ut){ri(f,f.return,ut)}if(c=f.sibling,c!==null){c.return=f.return,At=c;break}At=f.return}return Tt=n5,n5=!1,Tt}function Rp(c,f,g){var _=f.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var R=_=_.next;do{if((R.tag&c)===c){var V=R.destroy;R.destroy=void 0,V!==void 0&&W1(f,g,V)}R=R.next}while(R!==_)}}function Cg(c,f){if(f=f.updateQueue,f=f!==null?f.lastEffect:null,f!==null){var g=f=f.next;do{if((g.tag&c)===c){var _=g.create;g.destroy=_()}g=g.next}while(g!==f)}}function q1(c){var f=c.ref;if(f!==null){var g=c.stateNode;switch(c.tag){case 5:c=g;break;default:c=g}typeof f=="function"?f(c):f.current=c}}function r5(c){var f=c.alternate;f!==null&&(c.alternate=null,r5(f)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(f=c.stateNode,f!==null&&(delete f[Ma],delete f[xc],delete f[Wo],delete f[T1],delete f[k1])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function i5(c){return c.tag===5||c.tag===3||c.tag===4}function o5(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||i5(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function H1(c,f,g){var _=c.tag;if(_===5||_===6)c=c.stateNode,f?g.nodeType===8?g.parentNode.insertBefore(c,f):g.insertBefore(c,f):(g.nodeType===8?(f=g.parentNode,f.insertBefore(c,g)):(f=g,f.appendChild(c)),g=g._reactRootContainer,g!=null||f.onclick!==null||(f.onclick=bc));else if(_!==4&&(c=c.child,c!==null))for(H1(c,f,g),c=c.sibling;c!==null;)H1(c,f,g),c=c.sibling}function G1(c,f,g){var _=c.tag;if(_===5||_===6)c=c.stateNode,f?g.insertBefore(c,f):g.appendChild(c);else if(_!==4&&(c=c.child,c!==null))for(G1(c,f,g),c=c.sibling;c!==null;)G1(c,f,g),c=c.sibling}var Co=null,hu=!1;function Tc(c,f,g){for(g=g.child;g!==null;)s5(c,f,g),g=g.sibling}function s5(c,f,g){if(Ji&&typeof Ji.onCommitFiberUnmount=="function")try{Ji.onCommitFiberUnmount(Sa,g)}catch{}switch(g.tag){case 5:Ko||Hf(g,f);case 6:var _=Co,R=hu;Co=null,Tc(c,f,g),Co=_,hu=R,Co!==null&&(hu?(c=Co,g=g.stateNode,c.nodeType===8?c.parentNode.removeChild(g):c.removeChild(g)):Co.removeChild(g.stateNode));break;case 18:Co!==null&&(hu?(c=Co,g=g.stateNode,c.nodeType===8?_p(c.parentNode,g):c.nodeType===1&&_p(c,g),Ca(c)):_p(Co,g.stateNode));break;case 4:_=Co,R=hu,Co=g.stateNode.containerInfo,hu=!0,Tc(c,f,g),Co=_,hu=R;break;case 0:case 11:case 14:case 15:if(!Ko&&(_=g.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){R=_=_.next;do{var V=R,K=V.destroy;V=V.tag,K!==void 0&&((V&2)!==0||(V&4)!==0)&&W1(g,f,K),R=R.next}while(R!==_)}Tc(c,f,g);break;case 1:if(!Ko&&(Hf(g,f),_=g.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=g.memoizedProps,_.state=g.memoizedState,_.componentWillUnmount()}catch(ye){ri(g,f,ye)}Tc(c,f,g);break;case 21:Tc(c,f,g);break;case 22:g.mode&1?(Ko=(_=Ko)||g.memoizedState!==null,Tc(c,f,g),Ko=_):Tc(c,f,g);break;default:Tc(c,f,g)}}function a5(c){var f=c.updateQueue;if(f!==null){c.updateQueue=null;var g=c.stateNode;g===null&&(g=c.stateNode=new QP),f.forEach(function(_){var R=aD.bind(null,c,_);g.has(_)||(g.add(_),_.then(R,R))})}}function fu(c,f){var g=f.deletions;if(g!==null)for(var _=0;_<g.length;_++){var R=g[_];try{var V=c,K=f,ye=K;e:for(;ye!==null;){switch(ye.tag){case 5:Co=ye.stateNode,hu=!1;break e;case 3:Co=ye.stateNode.containerInfo,hu=!0;break e;case 4:Co=ye.stateNode.containerInfo,hu=!0;break e}ye=ye.return}if(Co===null)throw Error(t(160));s5(V,K,R),Co=null,hu=!1;var Ee=R.alternate;Ee!==null&&(Ee.return=null),R.return=null}catch(ze){ri(R,f,ze)}}if(f.subtreeFlags&12854)for(f=f.child;f!==null;)u5(f,c),f=f.sibling}function u5(c,f){var g=c.alternate,_=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(fu(f,c),$u(c),_&4){try{Rp(3,c,c.return),Cg(3,c)}catch(Pt){ri(c,c.return,Pt)}try{Rp(5,c,c.return)}catch(Pt){ri(c,c.return,Pt)}}break;case 1:fu(f,c),$u(c),_&512&&g!==null&&Hf(g,g.return);break;case 5:if(fu(f,c),$u(c),_&512&&g!==null&&Hf(g,g.return),c.flags&32){var R=c.stateNode;try{en(R,"")}catch(Pt){ri(c,c.return,Pt)}}if(_&4&&(R=c.stateNode,R!=null)){var V=c.memoizedProps,K=g!==null?g.memoizedProps:V,ye=c.type,Ee=c.updateQueue;if(c.updateQueue=null,Ee!==null)try{ye==="input"&&V.type==="radio"&&V.name!=null&&rt(R,V),Ot(ye,K);var ze=Ot(ye,V);for(K=0;K<Ee.length;K+=2){var ot=Ee[K],st=Ee[K+1];ot==="style"?rn(R,st):ot==="dangerouslySetInnerHTML"?vt(R,st):ot==="children"?en(R,st):P(R,ot,st,ze)}switch(ye){case"input":zt(R,V);break;case"textarea":En(R,V);break;case"select":var it=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!V.multiple;var mt=V.value;mt!=null?lt(R,!!V.multiple,mt,!1):it!==!!V.multiple&&(V.defaultValue!=null?lt(R,!!V.multiple,V.defaultValue,!0):lt(R,!!V.multiple,V.multiple?[]:"",!1))}R[xc]=V}catch(Pt){ri(c,c.return,Pt)}}break;case 6:if(fu(f,c),$u(c),_&4){if(c.stateNode===null)throw Error(t(162));R=c.stateNode,V=c.memoizedProps;try{R.nodeValue=V}catch(Pt){ri(c,c.return,Pt)}}break;case 3:if(fu(f,c),$u(c),_&4&&g!==null&&g.memoizedState.isDehydrated)try{Ca(f.containerInfo)}catch(Pt){ri(c,c.return,Pt)}break;case 4:fu(f,c),$u(c);break;case 13:fu(f,c),$u(c),R=c.child,R.flags&8192&&(V=R.memoizedState!==null,R.stateNode.isHidden=V,!V||R.alternate!==null&&R.alternate.memoizedState!==null||(X1=Qn())),_&4&&a5(c);break;case 22:if(ot=g!==null&&g.memoizedState!==null,c.mode&1?(Ko=(ze=Ko)||ot,fu(f,c),Ko=ze):fu(f,c),$u(c),_&8192){if(ze=c.memoizedState!==null,(c.stateNode.isHidden=ze)&&!ot&&(c.mode&1)!==0)for(At=c,ot=c.child;ot!==null;){for(st=At=ot;At!==null;){switch(it=At,mt=it.child,it.tag){case 0:case 11:case 14:case 15:Rp(4,it,it.return);break;case 1:Hf(it,it.return);var Tt=it.stateNode;if(typeof Tt.componentWillUnmount=="function"){_=it,g=it.return;try{f=_,Tt.props=f.memoizedProps,Tt.state=f.memoizedState,Tt.componentWillUnmount()}catch(Pt){ri(_,g,Pt)}}break;case 5:Hf(it,it.return);break;case 22:if(it.memoizedState!==null){h5(st);continue}}mt!==null?(mt.return=it,At=mt):h5(st)}ot=ot.sibling}e:for(ot=null,st=c;;){if(st.tag===5){if(ot===null){ot=st;try{R=st.stateNode,ze?(V=R.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none"):(ye=st.stateNode,Ee=st.memoizedProps.style,K=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null,ye.style.display=mn("display",K))}catch(Pt){ri(c,c.return,Pt)}}}else if(st.tag===6){if(ot===null)try{st.stateNode.nodeValue=ze?"":st.memoizedProps}catch(Pt){ri(c,c.return,Pt)}}else if((st.tag!==22&&st.tag!==23||st.memoizedState===null||st===c)&&st.child!==null){st.child.return=st,st=st.child;continue}if(st===c)break e;for(;st.sibling===null;){if(st.return===null||st.return===c)break e;ot===st&&(ot=null),st=st.return}ot===st&&(ot=null),st.sibling.return=st.return,st=st.sibling}}break;case 19:fu(f,c),$u(c),_&4&&a5(c);break;case 21:break;default:fu(f,c),$u(c)}}function $u(c){var f=c.flags;if(f&2){try{e:{for(var g=c.return;g!==null;){if(i5(g)){var _=g;break e}g=g.return}throw Error(t(160))}switch(_.tag){case 5:var R=_.stateNode;_.flags&32&&(en(R,""),_.flags&=-33);var V=o5(c);G1(c,V,R);break;case 3:case 4:var K=_.stateNode.containerInfo,ye=o5(c);H1(c,ye,K);break;default:throw Error(t(161))}}catch(Ee){ri(c,c.return,Ee)}c.flags&=-3}f&4096&&(c.flags&=-4097)}function ZP(c,f,g){At=c,l5(c)}function l5(c,f,g){for(var _=(c.mode&1)!==0;At!==null;){var R=At,V=R.child;if(R.tag===22&&_){var K=R.memoizedState!==null||Ag;if(!K){var ye=R.alternate,Ee=ye!==null&&ye.memoizedState!==null||Ko;ye=Ag;var ze=Ko;if(Ag=K,(Ko=Ee)&&!ze)for(At=R;At!==null;)K=At,Ee=K.child,K.tag===22&&K.memoizedState!==null?f5(R):Ee!==null?(Ee.return=K,At=Ee):f5(R);for(;V!==null;)At=V,l5(V),V=V.sibling;At=R,Ag=ye,Ko=ze}c5(c)}else(R.subtreeFlags&8772)!==0&&V!==null?(V.return=R,At=V):c5(c)}}function c5(c){for(;At!==null;){var f=At;if((f.flags&8772)!==0){var g=f.alternate;try{if((f.flags&8772)!==0)switch(f.tag){case 0:case 11:case 15:Ko||Cg(5,f);break;case 1:var _=f.stateNode;if(f.flags&4&&!Ko)if(g===null)_.componentDidMount();else{var R=f.elementType===f.type?g.memoizedProps:cu(f.type,g.memoizedProps);_.componentDidUpdate(R,g.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var V=f.updateQueue;V!==null&&Os(f,V,_);break;case 3:var K=f.updateQueue;if(K!==null){if(g=null,f.child!==null)switch(f.child.tag){case 5:g=f.child.stateNode;break;case 1:g=f.child.stateNode}Os(f,K,g)}break;case 5:var ye=f.stateNode;if(g===null&&f.flags&4){g=ye;var Ee=f.memoizedProps;switch(f.type){case"button":case"input":case"select":case"textarea":Ee.autoFocus&&g.focus();break;case"img":Ee.src&&(g.src=Ee.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(f.memoizedState===null){var ze=f.alternate;if(ze!==null){var ot=ze.memoizedState;if(ot!==null){var st=ot.dehydrated;st!==null&&Ca(st)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ko||f.flags&512&&q1(f)}catch(it){ri(f,f.return,it)}}if(f===c){At=null;break}if(g=f.sibling,g!==null){g.return=f.return,At=g;break}At=f.return}}function h5(c){for(;At!==null;){var f=At;if(f===c){At=null;break}var g=f.sibling;if(g!==null){g.return=f.return,At=g;break}At=f.return}}function f5(c){for(;At!==null;){var f=At;try{switch(f.tag){case 0:case 11:case 15:var g=f.return;try{Cg(4,f)}catch(Ee){ri(f,g,Ee)}break;case 1:var _=f.stateNode;if(typeof _.componentDidMount=="function"){var R=f.return;try{_.componentDidMount()}catch(Ee){ri(f,R,Ee)}}var V=f.return;try{q1(f)}catch(Ee){ri(f,V,Ee)}break;case 5:var K=f.return;try{q1(f)}catch(Ee){ri(f,K,Ee)}}}catch(Ee){ri(f,f.return,Ee)}if(f===c){At=null;break}var ye=f.sibling;if(ye!==null){ye.return=f.return,At=ye;break}At=f.return}}var eD=Math.ceil,Ig=C.ReactCurrentDispatcher,$1=C.ReactCurrentOwner,Va=C.ReactCurrentBatchConfig,$n=0,uo=null,Ni=null,Io=0,la=0,Gf=ia(0),Ui=0,Pp=null,Fh=0,Tg=0,K1=0,Dp=null,Bs=null,X1=0,$f=1/0,zl=null,kg=!1,Y1=null,kc=null,Ng=!1,Nc=null,Rg=0,Lp=0,Q1=null,Pg=-1,Dg=0;function Es(){return($n&6)!==0?Qn():Pg!==-1?Pg:Pg=Qn()}function Rc(c){return(c.mode&1)===0?1:($n&2)!==0&&Io!==0?Io&-Io:zr.transition!==null?(Dg===0&&(Dg=Ru()),Dg):(c=An,c!==0||(c=window.event,c=c===void 0?16:ea(c.type)),c)}function du(c,f,g,_){if(50<Lp)throw Lp=0,Q1=null,Error(t(185));Xa(c,g,_),(($n&2)===0||c!==uo)&&(c===uo&&(($n&2)===0&&(Tg|=g),Ui===4&&Pc(c,Io)),Vs(c,_),g===1&&$n===0&&(f.mode&1)===0&&($f=Qn()+500,Dh&&U()))}function Vs(c,f){var g=c.callbackNode;br(c,f);var _=Is(c,c===uo?Io:0);if(_===0)g!==null&&Xs(g),c.callbackNode=null,c.callbackPriority=0;else if(f=_&-_,c.callbackPriority!==f){if(g!=null&&Xs(g),f===1)c.tag===0?F(p5.bind(null,c)):S(p5.bind(null,c)),C1(function(){($n&6)===0&&U()}),g=null;else{switch(xo(_)){case 1:g=Ka;break;case 4:g=Qi;break;case 16:g=Qs;break;case 536870912:g=Ea;break;default:g=Qs}g=_5(g,d5.bind(null,c))}c.callbackPriority=f,c.callbackNode=g}}function d5(c,f){if(Pg=-1,Dg=0,($n&6)!==0)throw Error(t(327));var g=c.callbackNode;if(Kf()&&c.callbackNode!==g)return null;var _=Is(c,c===uo?Io:0);if(_===0)return null;if((_&30)!==0||(_&c.expiredLanes)!==0||f)f=Lg(c,_);else{f=_;var R=$n;$n|=2;var V=g5();(uo!==c||Io!==f)&&(zl=null,$f=Qn()+500,Vh(c,f));do try{rD();break}catch(ye){m5(c,ye)}while(!0);Hn(),Ig.current=V,$n=R,Ni!==null?f=0:(uo=null,Io=0,f=Ui)}if(f!==0){if(f===2&&(R=ds(c),R!==0&&(_=R,f=J1(c,R))),f===1)throw g=Pp,Vh(c,0),Pc(c,_),Vs(c,Qn()),g;if(f===6)Pc(c,_);else{if(R=c.current.alternate,(_&30)===0&&!tD(R)&&(f=Lg(c,_),f===2&&(V=ds(c),V!==0&&(_=V,f=J1(c,V))),f===1))throw g=Pp,Vh(c,0),Pc(c,_),Vs(c,Qn()),g;switch(c.finishedWork=R,c.finishedLanes=_,f){case 0:case 1:throw Error(t(345));case 2:jh(c,Bs,zl);break;case 3:if(Pc(c,_),(_&130023424)===_&&(f=X1+500-Qn(),10<f)){if(Is(c,0)!==0)break;if(R=c.suspendedLanes,(R&_)!==_){Es(),c.pingedLanes|=c.suspendedLanes&R;break}c.timeoutHandle=xp(jh.bind(null,c,Bs,zl),f);break}jh(c,Bs,zl);break;case 4:if(Pc(c,_),(_&4194240)===_)break;for(f=c.eventTimes,R=-1;0<_;){var K=31-Pr(_);V=1<<K,K=f[K],K>R&&(R=K),_&=~V}if(_=R,_=Qn()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*eD(_/1960))-_,10<_){c.timeoutHandle=xp(jh.bind(null,c,Bs,zl),_);break}jh(c,Bs,zl);break;case 5:jh(c,Bs,zl);break;default:throw Error(t(329))}}}return Vs(c,Qn()),c.callbackNode===g?d5.bind(null,c):null}function J1(c,f){var g=Dp;return c.current.memoizedState.isDehydrated&&(Vh(c,f).flags|=256),c=Lg(c,f),c!==2&&(f=Bs,Bs=g,f!==null&&Z1(f)),c}function Z1(c){Bs===null?Bs=c:Bs.push.apply(Bs,c)}function tD(c){for(var f=c;;){if(f.flags&16384){var g=f.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var _=0;_<g.length;_++){var R=g[_],V=R.getSnapshot;R=R.value;try{if(!Dr(V(),R))return!1}catch{return!1}}}if(g=f.child,f.subtreeFlags&16384&&g!==null)g.return=f,f=g;else{if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Pc(c,f){for(f&=~K1,f&=~Tg,c.suspendedLanes|=f,c.pingedLanes&=~f,c=c.expirationTimes;0<f;){var g=31-Pr(f),_=1<<g;c[g]=-1,f&=~_}}function p5(c){if(($n&6)!==0)throw Error(t(327));Kf();var f=Is(c,0);if((f&1)===0)return Vs(c,Qn()),null;var g=Lg(c,f);if(c.tag!==0&&g===2){var _=ds(c);_!==0&&(f=_,g=J1(c,_))}if(g===1)throw g=Pp,Vh(c,0),Pc(c,f),Vs(c,Qn()),g;if(g===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=f,jh(c,Bs,zl),Vs(c,Qn()),null}function ey(c,f){var g=$n;$n|=1;try{return c(f)}finally{$n=g,$n===0&&($f=Qn()+500,Dh&&U())}}function Bh(c){Nc!==null&&Nc.tag===0&&($n&6)===0&&Kf();var f=$n;$n|=1;var g=Va.transition,_=An;try{if(Va.transition=null,An=1,c)return c()}finally{An=_,Va.transition=g,$n=f,($n&6)===0&&U()}}function ty(){la=Gf.current,Zn(Gf)}function Vh(c,f){c.finishedWork=null,c.finishedLanes=0;var g=c.timeoutHandle;if(g!==-1&&(c.timeoutHandle=-1,fg(g)),Ni!==null)for(g=Ni.return;g!==null;){var _=g;switch(Oe(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Lf();break;case 3:Oa(),Zn(qo),Zn(Vi),Ip();break;case 5:Ap(_);break;case 4:Oa();break;case 13:Zn(xr);break;case 19:Zn(xr);break;case 10:Sr(_.type._context);break;case 22:case 23:ty()}g=g.return}if(uo=c,Ni=c=Dc(c.current,null),Io=la=f,Ui=0,Pp=null,K1=Tg=Fh=0,Bs=Dp=null,ur!==null){for(f=0;f<ur.length;f++)if(g=ur[f],_=g.interleaved,_!==null){g.interleaved=null;var R=_.next,V=g.pending;if(V!==null){var K=V.next;V.next=R,_.next=K}g.pending=_}ur=null}return c}function m5(c,f){do{var g=Ni;try{if(Hn(),Mf.current=xg,Ac){for(var _=Ar.memoizedState;_!==null;){var R=_.queue;R!==null&&(R.pending=null),_=_.next}Ac=!1}if(Fa=0,Gr=ni=Ar=null,uu=!1,Cc=0,$1.current=null,g===null||g.return===null){Ui=1,Pp=f,Ni=null;break}e:{var V=c,K=g.return,ye=g,Ee=f;if(f=Io,ye.flags|=32768,Ee!==null&&typeof Ee=="object"&&typeof Ee.then=="function"){var ze=Ee,ot=ye,st=ot.tag;if((ot.mode&1)===0&&(st===0||st===11||st===15)){var it=ot.alternate;it?(ot.updateQueue=it.updateQueue,ot.memoizedState=it.memoizedState,ot.lanes=it.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var mt=j_(K);if(mt!==null){mt.flags&=-257,U_(mt,K,ye,V,f),mt.mode&1&&V_(V,ze,f),f=mt,Ee=ze;var Tt=f.updateQueue;if(Tt===null){var Pt=new Set;Pt.add(Ee),f.updateQueue=Pt}else Tt.add(Ee);break e}else{if((f&1)===0){V_(V,ze,f),ny();break e}Ee=Error(t(426))}}else if(Qe&&ye.mode&1){var mi=j_(K);if(mi!==null){(mi.flags&65536)===0&&(mi.flags|=256),U_(mi,K,ye,V,f),ct(qf(Ee,ye));break e}}V=Ee=qf(Ee,ye),Ui!==4&&(Ui=2),Dp===null?Dp=[V]:Dp.push(V),V=K;do{switch(V.tag){case 3:V.flags|=65536,f&=-f,V.lanes|=f;var Me=F_(V,Ee,f);cr(V,Me);break e;case 1:ye=Ee;var ke=V.type,Ve=V.stateNode;if((V.flags&128)===0&&(typeof ke.getDerivedStateFromError=="function"||Ve!==null&&typeof Ve.componentDidCatch=="function"&&(kc===null||!kc.has(Ve)))){V.flags|=65536,f&=-f,V.lanes|=f;var ut=B_(V,ye,f);cr(V,ut);break e}}V=V.return}while(V!==null)}y5(g)}catch(Bt){f=Bt,Ni===g&&g!==null&&(Ni=g=g.return);continue}break}while(!0)}function g5(){var c=Ig.current;return Ig.current=xg,c===null?xg:c}function ny(){(Ui===0||Ui===3||Ui===2)&&(Ui=4),uo===null||(Fh&268435455)===0&&(Tg&268435455)===0||Pc(uo,Io)}function Lg(c,f){var g=$n;$n|=2;var _=g5();(uo!==c||Io!==f)&&(zl=null,Vh(c,f));do try{nD();break}catch(R){m5(c,R)}while(!0);if(Hn(),$n=g,Ig.current=_,Ni!==null)throw Error(t(261));return uo=null,Io=0,Ui}function nD(){for(;Ni!==null;)v5(Ni)}function rD(){for(;Ni!==null&&!Cs();)v5(Ni)}function v5(c){var f=x5(c.alternate,c,la);c.memoizedProps=c.pendingProps,f===null?y5(c):Ni=f,$1.current=null}function y5(c){var f=c;do{var g=f.alternate;if(c=f.return,(f.flags&32768)===0){if(g=XP(g,f,la),g!==null){Ni=g;return}}else{if(g=YP(g,f),g!==null){g.flags&=32767,Ni=g;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Ui=6,Ni=null;return}}if(f=f.sibling,f!==null){Ni=f;return}Ni=f=c}while(f!==null);Ui===0&&(Ui=5)}function jh(c,f,g){var _=An,R=Va.transition;try{Va.transition=null,An=1,iD(c,f,g,_)}finally{Va.transition=R,An=_}return null}function iD(c,f,g,_){do Kf();while(Nc!==null);if(($n&6)!==0)throw Error(t(327));g=c.finishedWork;var R=c.finishedLanes;if(g===null)return null;if(c.finishedWork=null,c.finishedLanes=0,g===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var V=g.lanes|g.childLanes;if(Ts(c,V),c===uo&&(Ni=uo=null,Io=0),(g.subtreeFlags&2064)===0&&(g.flags&2064)===0||Ng||(Ng=!0,_5(Qs,function(){return Kf(),null})),V=(g.flags&15990)!==0,(g.subtreeFlags&15990)!==0||V){V=Va.transition,Va.transition=null;var K=An;An=1;var ye=$n;$n|=4,$1.current=null,JP(c,g),u5(g,c),Eh(Ol),Zs=!!Rh,Ol=Rh=null,c.current=g,ZP(g),Ys(),$n=ye,An=K,Va.transition=V}else c.current=g;if(Ng&&(Ng=!1,Nc=c,Rg=R),V=c.pendingLanes,V===0&&(kc=null),xl(g.stateNode),Vs(c,Qn()),f!==null)for(_=c.onRecoverableError,g=0;g<f.length;g++)R=f[g],_(R.value,{componentStack:R.stack,digest:R.digest});if(kg)throw kg=!1,c=Y1,Y1=null,c;return(Rg&1)!==0&&c.tag!==0&&Kf(),V=c.pendingLanes,(V&1)!==0?c===Q1?Lp++:(Lp=0,Q1=c):Lp=0,U(),null}function Kf(){if(Nc!==null){var c=xo(Rg),f=Va.transition,g=An;try{if(Va.transition=null,An=16>c?16:c,Nc===null)var _=!1;else{if(c=Nc,Nc=null,Rg=0,($n&6)!==0)throw Error(t(331));var R=$n;for($n|=4,At=c.current;At!==null;){var V=At,K=V.child;if((At.flags&16)!==0){var ye=V.deletions;if(ye!==null){for(var Ee=0;Ee<ye.length;Ee++){var ze=ye[Ee];for(At=ze;At!==null;){var ot=At;switch(ot.tag){case 0:case 11:case 15:Rp(8,ot,V)}var st=ot.child;if(st!==null)st.return=ot,At=st;else for(;At!==null;){ot=At;var it=ot.sibling,mt=ot.return;if(r5(ot),ot===ze){At=null;break}if(it!==null){it.return=mt,At=it;break}At=mt}}}var Tt=V.alternate;if(Tt!==null){var Pt=Tt.child;if(Pt!==null){Tt.child=null;do{var mi=Pt.sibling;Pt.sibling=null,Pt=mi}while(Pt!==null)}}At=V}}if((V.subtreeFlags&2064)!==0&&K!==null)K.return=V,At=K;else e:for(;At!==null;){if(V=At,(V.flags&2048)!==0)switch(V.tag){case 0:case 11:case 15:Rp(9,V,V.return)}var Me=V.sibling;if(Me!==null){Me.return=V.return,At=Me;break e}At=V.return}}var ke=c.current;for(At=ke;At!==null;){K=At;var Ve=K.child;if((K.subtreeFlags&2064)!==0&&Ve!==null)Ve.return=K,At=Ve;else e:for(K=ke;At!==null;){if(ye=At,(ye.flags&2048)!==0)try{switch(ye.tag){case 0:case 11:case 15:Cg(9,ye)}}catch(Bt){ri(ye,ye.return,Bt)}if(ye===K){At=null;break e}var ut=ye.sibling;if(ut!==null){ut.return=ye.return,At=ut;break e}At=ye.return}}if($n=R,U(),Ji&&typeof Ji.onPostCommitFiberRoot=="function")try{Ji.onPostCommitFiberRoot(Sa,c)}catch{}_=!0}return _}finally{An=g,Va.transition=f}}return!1}function w5(c,f,g){f=qf(g,f),f=F_(c,f,1),c=qr(c,f,1),f=Es(),c!==null&&(Xa(c,1,f),Vs(c,f))}function ri(c,f,g){if(c.tag===3)w5(c,c,g);else for(;f!==null;){if(f.tag===3){w5(f,c,g);break}else if(f.tag===1){var _=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(kc===null||!kc.has(_))){c=qf(g,c),c=B_(f,c,1),f=qr(f,c,1),c=Es(),f!==null&&(Xa(f,1,c),Vs(f,c));break}}f=f.return}}function oD(c,f,g){var _=c.pingCache;_!==null&&_.delete(f),f=Es(),c.pingedLanes|=c.suspendedLanes&g,uo===c&&(Io&g)===g&&(Ui===4||Ui===3&&(Io&130023424)===Io&&500>Qn()-X1?Vh(c,0):K1|=g),Vs(c,f)}function b5(c,f){f===0&&((c.mode&1)===0?f=1:(f=Oi,Oi<<=1,(Oi&130023424)===0&&(Oi=4194304)));var g=Es();c=lr(c,f),c!==null&&(Xa(c,f,g),Vs(c,g))}function sD(c){var f=c.memoizedState,g=0;f!==null&&(g=f.retryLane),b5(c,g)}function aD(c,f){var g=0;switch(c.tag){case 13:var _=c.stateNode,R=c.memoizedState;R!==null&&(g=R.retryLane);break;case 19:_=c.stateNode;break;default:throw Error(t(314))}_!==null&&_.delete(f),b5(c,g)}var x5;x5=function(c,f,g){if(c!==null)if(c.memoizedProps!==f.pendingProps||qo.current)Fs=!0;else{if((c.lanes&g)===0&&(f.flags&128)===0)return Fs=!1,KP(c,f,g);Fs=(c.flags&131072)!==0}else Fs=!1,Qe&&(f.flags&1048576)!==0&&Pe(f,ee,f.index);switch(f.lanes=0,f.tag){case 2:var _=f.type;Sg(c,f),c=f.pendingProps;var R=Ec(f,Vi.current);Or(f,g),R=Lh(null,f,_,c,R,g);var V=Ba();return f.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(f.tag=1,f.memoizedState=null,f.updateQueue=null,Ho(_)?(V=!0,Vl(f)):V=!1,f.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,ji(f),R.updater=_g,f.stateNode=R,R._reactInternals=f,D1(f,_,c,g),f=F1(null,f,_,!0,V,g)):(f.tag=0,Qe&&V&&$e(f),_s(null,f,R,g),f=f.child),f;case 16:_=f.elementType;e:{switch(Sg(c,f),c=f.pendingProps,R=_._init,_=R(_._payload),f.type=_,R=f.tag=lD(_),c=cu(_,c),R){case 0:f=O1(null,f,_,c,g);break e;case 1:f=$_(null,f,_,c,g);break e;case 11:f=z_(null,f,_,c,g);break e;case 14:f=W_(null,f,_,cu(_.type,c),g);break e}throw Error(t(306,_,""))}return f;case 0:return _=f.type,R=f.pendingProps,R=f.elementType===_?R:cu(_,R),O1(c,f,_,R,g);case 1:return _=f.type,R=f.pendingProps,R=f.elementType===_?R:cu(_,R),$_(c,f,_,R,g);case 3:e:{if(K_(f),c===null)throw Error(t(387));_=f.pendingProps,V=f.memoizedState,R=V.element,Go(c,f),ao(f,_,null,g);var K=f.memoizedState;if(_=K.element,V.isDehydrated)if(V={element:_,isDehydrated:!1,cache:K.cache,pendingSuspenseBoundaries:K.pendingSuspenseBoundaries,transitions:K.transitions},f.updateQueue.baseState=V,f.memoizedState=V,f.flags&256){R=qf(Error(t(423)),f),f=X_(c,f,_,g,R);break e}else if(_!==R){R=qf(Error(t(424)),f),f=X_(c,f,_,g,R);break e}else for(Ge=Ao(f.stateNode.containerInfo.firstChild),qe=f,Qe=!0,Je=null,g=Ir(f,null,_,g),f.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(xt(),_===R){f=Ul(c,f,g);break e}_s(c,f,_,g)}f=f.child}return f;case 5:return gg(f),c===null&&Ct(f),_=f.type,R=f.pendingProps,V=c!==null?c.memoizedProps:null,K=R.children,bp(_,R)?K=null:V!==null&&bp(_,V)&&(f.flags|=32),G_(c,f),_s(c,f,K,g),f.child;case 6:return c===null&&Ct(f),null;case 13:return Y_(c,f,g);case 4:return Sc(f,f.stateNode.containerInfo),_=f.pendingProps,c===null?f.child=ei(f,null,_,g):_s(c,f,_,g),f.child;case 11:return _=f.type,R=f.pendingProps,R=f.elementType===_?R:cu(_,R),z_(c,f,_,R,g);case 7:return _s(c,f,f.pendingProps,g),f.child;case 8:return _s(c,f,f.pendingProps.children,g),f.child;case 12:return _s(c,f,f.pendingProps.children,g),f.child;case 10:e:{if(_=f.type._context,R=f.pendingProps,V=f.memoizedProps,K=R.value,nr(di,_._currentValue),_._currentValue=K,V!==null)if(Dr(V.value,K)){if(V.children===R.children&&!qo.current){f=Ul(c,f,g);break e}}else for(V=f.child,V!==null&&(V.return=f);V!==null;){var ye=V.dependencies;if(ye!==null){K=V.child;for(var Ee=ye.firstContext;Ee!==null;){if(Ee.context===_){if(V.tag===1){Ee=Wr(-1,g&-g),Ee.tag=2;var ze=V.updateQueue;if(ze!==null){ze=ze.shared;var ot=ze.pending;ot===null?Ee.next=Ee:(Ee.next=ot.next,ot.next=Ee),ze.pending=Ee}}V.lanes|=g,Ee=V.alternate,Ee!==null&&(Ee.lanes|=g),Gn(V.return,g,f),ye.lanes|=g;break}Ee=Ee.next}}else if(V.tag===10)K=V.type===f.type?null:V.child;else if(V.tag===18){if(K=V.return,K===null)throw Error(t(341));K.lanes|=g,ye=K.alternate,ye!==null&&(ye.lanes|=g),Gn(K,g,f),K=V.sibling}else K=V.child;if(K!==null)K.return=V;else for(K=V;K!==null;){if(K===f){K=null;break}if(V=K.sibling,V!==null){V.return=K.return,K=V;break}K=K.return}V=K}_s(c,f,R.children,g),f=f.child}return f;case 9:return R=f.type,_=f.pendingProps.children,Or(f,g),R=Fr(R),_=_(R),f.flags|=1,_s(c,f,_,g),f.child;case 14:return _=f.type,R=cu(_,f.pendingProps),R=cu(_.type,R),W_(c,f,_,R,g);case 15:return q_(c,f,f.type,f.pendingProps,g);case 17:return _=f.type,R=f.pendingProps,R=f.elementType===_?R:cu(_,R),Sg(c,f),f.tag=1,Ho(_)?(c=!0,Vl(f)):c=!1,Or(f,g),M_(f,_,R),D1(f,_,R,g),F1(null,f,_,!0,c,g);case 19:return J_(c,f,g);case 22:return H_(c,f,g)}throw Error(t(156,f.tag))};function _5(c,f){return _a(c,f)}function uD(c,f,g,_){this.tag=c,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ja(c,f,g,_){return new uD(c,f,g,_)}function ry(c){return c=c.prototype,!(!c||!c.isReactComponent)}function lD(c){if(typeof c=="function")return ry(c)?1:0;if(c!=null){if(c=c.$$typeof,c===M)return 11;if(c===ue)return 14}return 2}function Dc(c,f){var g=c.alternate;return g===null?(g=ja(c.tag,f,c.key,c.mode),g.elementType=c.elementType,g.type=c.type,g.stateNode=c.stateNode,g.alternate=c,c.alternate=g):(g.pendingProps=f,g.type=c.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=c.flags&14680064,g.childLanes=c.childLanes,g.lanes=c.lanes,g.child=c.child,g.memoizedProps=c.memoizedProps,g.memoizedState=c.memoizedState,g.updateQueue=c.updateQueue,f=c.dependencies,g.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},g.sibling=c.sibling,g.index=c.index,g.ref=c.ref,g}function Mg(c,f,g,_,R,V){var K=2;if(_=c,typeof c=="function")ry(c)&&(K=1);else if(typeof c=="string")K=5;else e:switch(c){case L:return Uh(g.children,R,V,f);case I:K=8,R|=8;break;case A:return c=ja(12,g,f,R|2),c.elementType=A,c.lanes=V,c;case j:return c=ja(13,g,f,R),c.elementType=j,c.lanes=V,c;case X:return c=ja(19,g,f,R),c.elementType=X,c.lanes=V,c;case ce:return Og(g,R,V,f);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case O:K=10;break e;case k:K=9;break e;case M:K=11;break e;case ue:K=14;break e;case ge:K=16,_=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return f=ja(K,g,f,R),f.elementType=c,f.type=_,f.lanes=V,f}function Uh(c,f,g,_){return c=ja(7,c,_,f),c.lanes=g,c}function Og(c,f,g,_){return c=ja(22,c,_,f),c.elementType=ce,c.lanes=g,c.stateNode={isHidden:!1},c}function iy(c,f,g){return c=ja(6,c,null,f),c.lanes=g,c}function oy(c,f,g){return f=ja(4,c.children!==null?c.children:[],c.key,f),f.lanes=g,f.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},f}function cD(c,f,g,_,R){this.tag=f,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_l(0),this.expirationTimes=_l(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_l(0),this.identifierPrefix=_,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function sy(c,f,g,_,R,V,K,ye,Ee){return c=new cD(c,f,g,ye,Ee),f===1?(f=1,V===!0&&(f|=8)):f=0,V=ja(3,null,null,f),c.current=V,V.stateNode=c,V.memoizedState={element:_,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},ji(V),c}function hD(c,f,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:_==null?null:""+_,children:c,containerInfo:f,implementation:g}}function E5(c){if(!c)return qu;c=c._reactInternals;e:{if(Vr(c)!==c||c.tag!==1)throw Error(t(170));var f=c;do{switch(f.tag){case 3:f=f.stateNode.context;break e;case 1:if(Ho(f.type)){f=f.stateNode.__reactInternalMemoizedMergedChildContext;break e}}f=f.return}while(f!==null);throw Error(t(171))}if(c.tag===1){var g=c.type;if(Ho(g))return Sp(c,g,f)}return f}function S5(c,f,g,_,R,V,K,ye,Ee){return c=sy(g,_,!0,c,R,V,K,ye,Ee),c.context=E5(null),g=c.current,_=Es(),R=Rc(g),V=Wr(_,R),V.callback=f??null,qr(g,V,R),c.current.lanes=R,Xa(c,R,_),Vs(c,_),c}function Fg(c,f,g,_){var R=f.current,V=Es(),K=Rc(R);return g=E5(g),f.context===null?f.context=g:f.pendingContext=g,f=Wr(V,K),f.payload={element:c},_=_===void 0?null:_,_!==null&&(f.callback=_),c=qr(R,f,K),c!==null&&(du(c,R,K,V),so(c,R,K)),K}function Bg(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function A5(c,f){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var g=c.retryLane;c.retryLane=g!==0&&g<f?g:f}}function ay(c,f){A5(c,f),(c=c.alternate)&&A5(c,f)}function fD(){return null}var C5=typeof reportError=="function"?reportError:function(c){console.error(c)};function uy(c){this._internalRoot=c}Vg.prototype.render=uy.prototype.render=function(c){var f=this._internalRoot;if(f===null)throw Error(t(409));Fg(c,f,null,null)},Vg.prototype.unmount=uy.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var f=c.containerInfo;Bh(function(){Fg(null,c,null,null)}),f[io]=null}};function Vg(c){this._internalRoot=c}Vg.prototype.unstable_scheduleHydration=function(c){if(c){var f=Sl();c={blockedOn:null,target:c,priority:f};for(var g=0;g<_o.length&&f!==0&&f<_o[g].priority;g++);_o.splice(g,0,c),g===0&&Lu(c)}};function ly(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function jg(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function I5(){}function dD(c,f,g,_,R){if(R){if(typeof _=="function"){var V=_;_=function(){var ze=Bg(K);V.call(ze)}}var K=S5(f,_,c,0,null,!1,!1,"",I5);return c._reactRootContainer=K,c[io]=K.current,Ll(c.nodeType===8?c.parentNode:c),Bh(),K}for(;R=c.lastChild;)c.removeChild(R);if(typeof _=="function"){var ye=_;_=function(){var ze=Bg(Ee);ye.call(ze)}}var Ee=sy(c,0,!1,null,null,!1,!1,"",I5);return c._reactRootContainer=Ee,c[io]=Ee.current,Ll(c.nodeType===8?c.parentNode:c),Bh(function(){Fg(f,Ee,g,_)}),Ee}function Ug(c,f,g,_,R){var V=g._reactRootContainer;if(V){var K=V;if(typeof R=="function"){var ye=R;R=function(){var Ee=Bg(K);ye.call(Ee)}}Fg(f,K,c,R)}else K=dD(g,f,c,R,_);return Bg(K)}Js=function(c){switch(c.tag){case 3:var f=c.stateNode;if(f.current.memoizedState.isDehydrated){var g=Tn(f.pendingLanes);g!==0&&(Pu(f,g|1),Vs(f,Qn()),($n&6)===0&&($f=Qn()+500,U()))}break;case 13:Bh(function(){var _=lr(c,1);if(_!==null){var R=Es();du(_,c,1,R)}}),ay(c,1)}},Du=function(c){if(c.tag===13){var f=lr(c,134217728);if(f!==null){var g=Es();du(f,c,134217728,g)}ay(c,134217728)}},El=function(c){if(c.tag===13){var f=Rc(c),g=lr(c,f);if(g!==null){var _=Es();du(g,c,f,_)}ay(c,f)}},Sl=function(){return An},Ya=function(c,f){var g=An;try{return An=c,f()}finally{An=g}},Jt=function(c,f,g){switch(f){case"input":if(zt(c,g),f=g.name,g.type==="radio"&&f!=null){for(g=c;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+f)+'][type="radio"]'),f=0;f<g.length;f++){var _=g[f];if(_!==c&&_.form===c.form){var R=Ph(_);if(!R)throw Error(t(90));Be(_),zt(_,R)}}}break;case"textarea":En(c,g);break;case"select":f=g.value,f!=null&&lt(c,!!g.multiple,f,!1)}},ai=ey,As=Bh;var pD={usingClientEntryPoint:!1,Events:[_c,Fl,Ph,Cn,Mo,ey]},Mp={findFiberByHostInstance:Wu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mD={bundleType:Mp.bundleType,version:Mp.version,rendererPackageName:Mp.rendererPackageName,rendererConfig:Mp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=cs(c),c===null?null:c.stateNode},findFiberByHostInstance:Mp.findFiberByHostInstance||fD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zg.isDisabled&&zg.supportsFiber)try{Sa=zg.inject(mD),Ji=zg}catch{}}return js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pD,js.createPortal=function(c,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ly(f))throw Error(t(200));return hD(c,f,null,g)},js.createRoot=function(c,f){if(!ly(c))throw Error(t(299));var g=!1,_="",R=C5;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(_=f.identifierPrefix),f.onRecoverableError!==void 0&&(R=f.onRecoverableError)),f=sy(c,1,!1,null,null,g,!1,_,R),c[io]=f.current,Ll(c.nodeType===8?c.parentNode:c),new uy(f)},js.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var f=c._reactInternals;if(f===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=cs(f),c=c===null?null:c.stateNode,c},js.flushSync=function(c){return Bh(c)},js.hydrate=function(c,f,g){if(!jg(f))throw Error(t(200));return Ug(null,c,f,!0,g)},js.hydrateRoot=function(c,f,g){if(!ly(c))throw Error(t(405));var _=g!=null&&g.hydratedSources||null,R=!1,V="",K=C5;if(g!=null&&(g.unstable_strictMode===!0&&(R=!0),g.identifierPrefix!==void 0&&(V=g.identifierPrefix),g.onRecoverableError!==void 0&&(K=g.onRecoverableError)),f=S5(f,null,c,1,g??null,R,!1,V,K),c[io]=f.current,Ll(c),_)for(c=0;c<_.length;c++)g=_[c],R=g._getVersion,R=R(g._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[g,R]:f.mutableSourceEagerHydrationData.push(g,R);return new Vg(f)},js.render=function(c,f,g){if(!jg(f))throw Error(t(200));return Ug(null,c,f,!1,g)},js.unmountComponentAtNode=function(c){if(!jg(c))throw Error(t(40));return c._reactRootContainer?(Bh(function(){Ug(null,null,c,!1,function(){c._reactRootContainer=null,c[io]=null})}),!0):!1},js.unstable_batchedUpdates=ey,js.unstable_renderSubtreeIntoContainer=function(c,f,g,_){if(!jg(g))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return Ug(c,f,g,!1,_)},js.version="18.3.1-next-f1338f8080-20240426",js}var M5;function AD(){if(M5)return fy.exports;M5=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),fy.exports=SD(),fy.exports}var O5;function CD(){if(O5)return Wg;O5=1;var n=AD();return Wg.createRoot=n.createRoot,Wg.hydrateRoot=n.hydrateRoot,Wg}var ID=CD();const K4=Ke.createContext(),TD=({children:n})=>{const[e,t]=Ke.useState(!1),[r,i]=Ke.useState(!1),[o,s]=Ke.useState("STANDBY"),[a,u]=Ke.useState("HOME"),[l]=Ke.useState({name:"Jim",access:"Admin"}),[h,d]=Ke.useState(100),[m,p]=Ke.useState([]),[y,b]=Ke.useState(0),[x,E]=Ke.useState({speed:0,heading:0,altitude:0,accuracy:0}),[T,P]=Ke.useState(()=>{const Ae=localStorage.getItem("jarvis_face_db_v2");return Ae?JSON.parse(Ae):[]}),[C,D]=Ke.useState(()=>{const Ae=localStorage.getItem("jarvis_incidents");return Ae?JSON.parse(Ae):[]}),[z,L]=Ke.useState(()=>{const Ae=localStorage.getItem("jarvis_leads");return Ae?JSON.parse(Ae):[]});Ke.useEffect(()=>{localStorage.setItem("jarvis_face_db_v2",JSON.stringify(T))},[T]),Ke.useEffect(()=>{localStorage.setItem("jarvis_incidents",JSON.stringify(C))},[C]),Ke.useEffect(()=>{localStorage.setItem("jarvis_leads",JSON.stringify(z))},[z]);const I=Ae=>{const Be={...Ae,id:Date.now(),date:new Date().toLocaleString()};D(Le=>[Be,...Le]),$("Incident logged. Analysis complete.")},A=Ae=>{D(Be=>Be.filter(Le=>Le.id!==Ae))},O=Ae=>{const Be={...Ae,id:Date.now(),status:"Potential",dateAdded:new Date().toLocaleDateString()};L(Le=>[Be,...Le]),$("Target acquired. Added to sales pipeline.")},k=(Ae,Be)=>{L(Le=>Le.map(tt=>tt.id===Ae?{...tt,status:Be}:tt)),$(`Status updated to ${Be}.`)},M=Ae=>{L(Be=>Be.filter(Le=>Le.id!==Ae))},j=Ae=>{const Be=[...T],Le=Be[Ae].name;Be.splice(Ae,1),P(Be),$(`Record for ${Le} deleted.`)},X=(Ae,Be)=>{const Le=[...T];Le[Ae]={...Le[Ae],...Be},P(Le),$("Record updated.")},ue=Ae=>{P(Be=>[...Be,{...Ae,dateAdded:new Date().toLocaleDateString()}]),$("New identity added.")},ge=()=>{P([]),$("Database wiped.")};Ke.useEffect(()=>{const Ae=()=>{const Be=window.speechSynthesis.getVoices();if(Be.length>0){p(Be);const Le=localStorage.getItem("jarvis_voice_index");if(Le)b(parseInt(Le));else{const tt=Be.findIndex(re=>re.name.includes("Google UK English Male"));tt!==-1&&b(tt)}}};Ae(),window.speechSynthesis.onvoiceschanged=Ae},[]);const ce=Ae=>{b(Ae),localStorage.setItem("jarvis_voice_index",Ae)},$=(Ae,Be=!1)=>{if(!window.speechSynthesis)return;window.speechSynthesis.cancel(),e&&de(),i(!0);const Le=new SpeechSynthesisUtterance(Ae);m.length>0&&(Le.voice=m[y]),Le.rate=1,Le.pitch=1,Le.onend=()=>{i(!1),Be&&setTimeout(()=>te(),200)},window.speechSynthesis.speak(Le)},ae=Ke.useRef(null),[fe,Q]=Ke.useState("IDLE"),[W,J]=Ke.useState({});Ke.useEffect(()=>{const Ae=window.SpeechRecognition||window.webkitSpeechRecognition;if(Ae){const Be=new Ae;Be.continuous=!1,Be.interimResults=!1,Be.lang="en-US",Be.onstart=()=>t(!0),Be.onend=()=>t(!1),Be.onresult=Le=>we(Le.results[0][0].transcript.toLowerCase().trim()),ae.current=Be}},[fe,W,T]);const te=()=>{if(ae.current)try{ae.current.start(),Fe("click")}catch{}},de=()=>{if(ae.current)try{ae.current.stop()}catch{}},ve=()=>{e?de():te()},we=Ae=>{if(fe!=="IDLE"){Se(Ae);return}Ae.includes("vision")?(u("VISION"),$("Visual sensors active.")):Ae.includes("scan")?(u("VISION"),Q("SCANNING"),$("Scanning target.")):Ae.includes("database")?(u("DATABASE"),$("Accessing records.")):Ae.includes("ops")||Ae.includes("incident")?(u("OPS"),$("Operations center online.")):Ae.includes("recon")||Ae.includes("sales")?(u("RECON"),$("Sales targeting engaged.")):Ae.includes("drive")?(u("HUD"),$("Driving mode engaged.")):Ae.includes("home")&&(u("HOME"),Q("IDLE"),$("Interface minimized."))},Se=Ae=>{const Be={...W};if(fe==="ASK_NAME")Be.name=Ae.replace(/\./g,""),J(Be),Q("ASK_GENDER"),$(`Registered ${Be.name}. Male or Female?`,!0);else if(fe==="ASK_GENDER")Be.gender=Ae.includes("female")?"Female":"Male",J(Be),Q("ASK_AGE"),$("Approximate age?",!0);else if(fe==="ASK_AGE")Be.age=Ae.replace(/\D/g,"")||"Unknown",J(Be),Q("ASK_ACCESS"),$("Access Level?",!0);else if(fe==="ASK_ACCESS"){let Le="No Access";Ae.includes("admin")&&(Le="Admin"),Ae.includes("medium")&&(Le="Medium"),Ae.includes("missing")&&(Le="Missing"),Be.accessLevel=Le,Be.dateAdded=new Date().toLocaleDateString(),P(tt=>[...tt,Be]),Q("IDLE"),J({}),$("Identity archived.")}},Ie=Ae=>{fe==="SCANNING"&&(J({descriptor:Ae}),Q("ASK_NAME"),$("Target captured. Who is this person?",!0))};Ke.useEffect(()=>{"getBattery"in navigator&&navigator.getBattery().then(Le=>d(Math.round(Le.level*100)));const Ae=navigator.geolocation.watchPosition(Le=>E(tt=>({...tt,speed:Le.coords.speed?Math.round(Le.coords.speed*3.6):0,altitude:Math.round(Le.coords.altitude||0)})),Le=>{},{enableHighAccuracy:!0}),Be=Le=>{Le.webkitCompassHeading?E(tt=>({...tt,heading:Le.webkitCompassHeading})):Le.alpha&&E(tt=>({...tt,heading:360-Le.alpha}))};return window.addEventListener("deviceorientation",Be),()=>{navigator.geolocation.clearWatch(Ae),window.removeEventListener("deviceorientation",Be)}},[]);const Fe=Ae=>{try{const Be=window.AudioContext||window.webkitAudioContext;if(!Be)return;const Le=new Be,tt=Le.createOscillator(),re=Le.createGain();tt.connect(re),re.connect(Le.destination),Ae==="click"?(tt.frequency.value=800,re.gain.value=.1,re.gain.exponentialRampToValueAtTime(.01,Le.currentTime+.1),tt.start(),tt.stop(Le.currentTime+.1)):Ae==="startup"&&(tt.frequency.value=150,tt.frequency.exponentialRampToValueAtTime(600,Le.currentTime+.4),re.gain.value=.1,re.gain.linearRampToValueAtTime(0,Le.currentTime+.4),tt.start(),tt.stop(Le.currentTime+.4))}catch{}};return oe.jsx(K4.Provider,{value:{isListening:e,toggleListening:ve,isSpeaking:r,speak:$,systemStatus:o,setSystemStatus:s,activeMode:a,setActiveMode:u,user:l,battery:h,playSound:Fe,availableVoices:m,selectedVoiceIndex:y,changeVoice:ce,conversationState:fe,triggerInterview:Ie,faceDatabase:T,deletePerson:j,updatePerson:X,addPerson:ue,clearDatabase:ge,hudData:x,incidentLog:C,addIncident:I,deleteIncident:A,leadsLog:z,addLead:O,updateLeadStatus:k,deleteLead:M},children:n})},Eu=()=>Ke.useContext(K4),kD=()=>{const n=Ke.useRef(null),{isSpeaking:e,isListening:t,activeMode:r}=Eu();return Ke.useEffect(()=>{const i=n.current,o=i.getContext("2d");let s,a=0;const u={cyan:"#00E5FF",cyanDim:"rgba(0, 229, 255, 0.2)",white:"#FFFFFF",orange:"#FF8C00",alert:"#FF0000"},l=()=>{i.width=window.innerWidth,i.height=window.innerHeight};window.addEventListener("resize",l),l();const h=(m,p,y,b=0,x=[])=>{o.beginPath(),o.arc(0,0,m,0,Math.PI*2),o.strokeStyle=y,o.lineWidth=p,o.shadowBlur=b,o.shadowColor=y,o.setLineDash(x),o.stroke(),o.setLineDash([])},d=()=>{a++;const m=i.width,p=i.height,y=m/2,b=p/2,x=Math.min(m,p)*(m<768?.35:.25);o.clearRect(0,0,m,p),o.translate(y,b);const T=a*.0015,P=r==="WARNING"?u.alert:u.cyan,C=r==="WARNING"?u.alert:u.white;o.save(),o.rotate(T);for(let L=0;L<72;L++){o.rotate(Math.PI*2/72),o.beginPath();const I=L%4===0?1.15:1.1;o.moveTo(x*1.05,0),o.lineTo(x*I,0),o.strokeStyle=P,o.lineWidth=L%4===0?3:1.5,o.shadowBlur=10,o.shadowColor=P,o.stroke()}o.restore(),o.save(),o.rotate(-T*1.2),h(x*.95,x*.08,u.cyanDim,5,[x*.2,x*.05,x*.05,x*.05]),o.rotate(Math.PI/3),h(x*.95,x*.02,P,15,[x*.3,x*1.5]),o.restore(),o.save(),o.rotate(T*1.5),h(x*.85,2,P,5,[5,10]),o.restore(),o.save(),o.rotate(-T*.8),h(x*.7,8,u.cyanDim,10),h(x*.7,4,P,20,[x*.5,x*1.2]),r!=="WARNING"&&(o.beginPath(),o.arc(0,0,x*.7,Math.PI*.5,Math.PI*.85),o.strokeStyle=u.orange,o.lineWidth=10,o.shadowBlur=30,o.shadowColor=u.orange,o.stroke(),o.beginPath(),o.arc(0,0,x*.7,Math.PI*.52,Math.PI*.83),o.strokeStyle=u.white,o.lineWidth=3,o.shadowBlur=10,o.shadowColor=u.white,o.stroke()),o.restore(),o.save(),o.rotate(T*2),h(x*.55,3,P,5,[10,15]);for(let L=0;L<4;L++)o.rotate(Math.PI/2),o.beginPath(),o.moveTo(x*.5,0),o.lineTo(x*.6,0),o.lineWidth=6,o.stroke();o.restore(),o.save(),o.rotate(-T*3),o.shadowBlur=20,o.shadowColor=P;for(let L=0;L<12;L++)o.rotate(Math.PI*2/12),o.beginPath(),o.moveTo(x*.3,0),o.lineTo(x*.45,x*.05),o.strokeStyle=P,o.lineWidth=2,o.stroke();o.restore();const D=1+Math.sin(a*.05)*.1,z=e?Math.random()*.2:0;o.save(),o.beginPath(),o.arc(0,0,x*.25*D,0,Math.PI*2),o.fillStyle=C,o.shadowBlur=50*D,o.shadowColor=C,o.fill(),h(x*.28*D,5,P,30),z>0&&h(x*.2*(1+z),10,u.white,40),o.restore(),o.resetTransform(),s=requestAnimationFrame(d)};return d(),()=>{window.removeEventListener("resize",l),cancelAnimationFrame(s)}},[e,t,r]),oe.jsx("canvas",{ref:n,className:"fixed top-0 left-0 w-full h-full z-0 pointer-events-none"})},ND=({onClose:n})=>{const{availableVoices:e,selectedVoiceIndex:t,changeVoice:r,playSound:i}=Eu();return oe.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-md flex flex-col p-6 animate-fade-in",children:[oe.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-cyan/30 pb-4",children:[oe.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"SYSTEM CONFIG"}),oe.jsx("button",{onClick:()=>{i("click"),n()},className:"text-cyan hover:text-white",children:oe.jsx("i",{className:"fas fa-times text-2xl"})})]}),oe.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar",children:[oe.jsx("h3",{className:"text-cyan-dim font-mono text-xs mb-4",children:"VOCAL SYNTHESIS MODULE"}),oe.jsxs("div",{className:"flex flex-col gap-2",children:[e.length===0&&oe.jsx("div",{className:"text-red-500 font-mono text-sm",children:"LOADING VOICE PACKS..."}),e.map((o,s)=>oe.jsxs("button",{onClick:()=>{i("click"),r(s)},className:`
                p-4 text-left font-mono text-sm border transition-all
                ${t===s?"border-cyan bg-cyan/10 text-cyan shadow-[0_0_10px_rgba(0,229,255,0.2)]":"border-white/10 text-gray-500 hover:border-cyan/50 hover:text-cyan/70"}
              `,children:[oe.jsx("div",{className:"font-bold truncate",children:o.name}),oe.jsx("div",{className:"text-[10px] opacity-70",children:o.lang})]},s))]})]}),oe.jsx("div",{className:"mt-6 text-center text-cyan-dim text-[10px] font-mono",children:"T-FORCE SECURITY PROTOCOLS VER 1.0"})]})},ab=Ke.createContext({});function ub(n){const e=Ke.useRef(null);return e.current===null&&(e.current=n()),e.current}const F0=Ke.createContext(null),lb=Ke.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class RD extends Ke.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function PD({children:n,isPresent:e}){const t=Ke.useId(),r=Ke.useRef(null),i=Ke.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=Ke.useContext(lb);return Ke.useInsertionEffect(()=>{const{width:s,height:a,top:u,left:l}=i.current;if(e||!r.current||!s||!a)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return o&&(h.nonce=o),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${a}px !important;
            top: ${u}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),oe.jsx(RD,{isPresent:e,childRef:r,sizeRef:i,children:Ke.cloneElement(n,{ref:r})})}const DD=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:o,mode:s})=>{const a=ub(LD),u=Ke.useId(),l=Ke.useCallback(d=>{a.set(d,!0);for(const m of a.values())if(!m)return;r&&r()},[a,r]),h=Ke.useMemo(()=>({id:u,initial:e,isPresent:t,custom:i,onExitComplete:l,register:d=>(a.set(d,!1),()=>a.delete(d))}),o?[Math.random(),l]:[t,l]);return Ke.useMemo(()=>{a.forEach((d,m)=>a.set(m,!1))},[t]),Ke.useEffect(()=>{!t&&!a.size&&r&&r()},[t]),s==="popLayout"&&(n=oe.jsx(PD,{isPresent:t,children:n})),oe.jsx(F0.Provider,{value:h,children:n})};function LD(){return new Map}function X4(n=!0){const e=Ke.useContext(F0);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,o=Ke.useId();Ke.useEffect(()=>{n&&i(o)},[n]);const s=Ke.useCallback(()=>n&&r&&r(o),[o,r,n]);return!t&&r?[!1,s]:[!0]}const qg=n=>n.key||"";function F5(n){const e=[];return Ke.Children.forEach(n,t=>{Ke.isValidElement(t)&&e.push(t)}),e}const cb=typeof window<"u",Y4=cb?Ke.useLayoutEffect:Ke.useEffect,MD=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:o="sync",propagate:s=!1})=>{const[a,u]=X4(s),l=Ke.useMemo(()=>F5(n),[n]),h=s&&!a?[]:l.map(qg),d=Ke.useRef(!0),m=Ke.useRef(l),p=ub(()=>new Map),[y,b]=Ke.useState(l),[x,E]=Ke.useState(l);Y4(()=>{d.current=!1,m.current=l;for(let C=0;C<x.length;C++){const D=qg(x[C]);h.includes(D)?p.delete(D):p.get(D)!==!0&&p.set(D,!1)}},[x,h.length,h.join("-")]);const T=[];if(l!==y){let C=[...l];for(let D=0;D<x.length;D++){const z=x[D],L=qg(z);h.includes(L)||(C.splice(D,0,z),T.push(z))}o==="wait"&&T.length&&(C=T),E(F5(C)),b(l);return}const{forceRender:P}=Ke.useContext(ab);return oe.jsx(oe.Fragment,{children:x.map(C=>{const D=qg(C),z=s&&!a?!1:l===x||h.includes(D),L=()=>{if(p.has(D))p.set(D,!0);else return;let I=!0;p.forEach(A=>{A||(I=!1)}),I&&(P==null||P(),E(m.current),s&&(u==null||u()),r&&r())};return oe.jsx(DD,{isPresent:z,initial:!d.current||t?void 0:!1,custom:z?void 0:e,presenceAffectsLayout:i,mode:o,onExitComplete:z?void 0:L,children:C},D)})})},ya=n=>n;let Q4=ya;function hb(n){let e;return()=>(e===void 0&&(e=n()),e)}const Bd=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Ql=n=>n*1e3,Jl=n=>n/1e3,OD={useManualTiming:!1};function FD(n){let e=new Set,t=new Set,r=!1,i=!1;const o=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1};function a(l){o.has(l)&&(u.schedule(l),n()),l(s)}const u={schedule:(l,h=!1,d=!1)=>{const p=d&&r?e:t;return h&&o.add(l),p.has(l)||p.add(l),l},cancel:l=>{t.delete(l),o.delete(l)},process:l=>{if(s=l,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(a),e.clear(),r=!1,i&&(i=!1,u.process(l))}};return u}const Hg=["read","resolveKeyframes","update","preRender","render","postRender"],BD=40;function J4(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>t=!0,s=Hg.reduce((E,T)=>(E[T]=FD(o),E),{}),{read:a,resolveKeyframes:u,update:l,preRender:h,render:d,postRender:m}=s,p=()=>{const E=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(E-i.timestamp,BD),1),i.timestamp=E,i.isProcessing=!0,a.process(i),u.process(i),l.process(i),h.process(i),d.process(i),m.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(p))},y=()=>{t=!0,r=!0,i.isProcessing||n(p)};return{schedule:Hg.reduce((E,T)=>{const P=s[T];return E[T]=(C,D=!1,z=!1)=>(t||y(),P.schedule(C,D,z)),E},{}),cancel:E=>{for(let T=0;T<Hg.length;T++)s[Hg[T]].cancel(E)},state:i,steps:s}}const{schedule:Nr,cancel:sh,state:To,steps:my}=J4(typeof requestAnimationFrame<"u"?requestAnimationFrame:ya,!0),Z4=Ke.createContext({strict:!1}),B5={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Vd={};for(const n in B5)Vd[n]={isEnabled:e=>B5[n].some(t=>!!e[t])};function VD(n){for(const e in n)Vd[e]={...Vd[e],...n[e]}}const jD=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Wv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||jD.has(n)}let e3=n=>!Wv(n);function UD(n){n&&(e3=e=>e.startsWith("on")?!Wv(e):n(e))}try{UD(require("@emotion/is-prop-valid").default)}catch{}function zD(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(e3(i)||t===!0&&Wv(i)||!e&&!Wv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function WD(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const B0=Ke.createContext({});function pm(n){return typeof n=="string"||Array.isArray(n)}function V0(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const fb=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],db=["initial",...fb];function j0(n){return V0(n.animate)||db.some(e=>pm(n[e]))}function t3(n){return!!(j0(n)||n.variants)}function qD(n,e){if(j0(n)){const{initial:t,animate:r}=n;return{initial:t===!1||pm(t)?t:void 0,animate:pm(r)?r:void 0}}return n.inherit!==!1?e:{}}function HD(n){const{initial:e,animate:t}=qD(n,Ke.useContext(B0));return Ke.useMemo(()=>({initial:e,animate:t}),[V5(e),V5(t)])}function V5(n){return Array.isArray(n)?n.join(" "):n}const GD=Symbol.for("motionComponentSymbol");function fd(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function $D(n,e,t){return Ke.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):fd(t)&&(t.current=r))},[e])}const pb=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),KD="framerAppearId",n3="data-"+pb(KD),{schedule:mb}=J4(queueMicrotask,!1),r3=Ke.createContext({});function XD(n,e,t,r,i){var o,s;const{visualElement:a}=Ke.useContext(B0),u=Ke.useContext(Z4),l=Ke.useContext(F0),h=Ke.useContext(lb).reducedMotion,d=Ke.useRef(null);r=r||u.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:h}));const m=d.current,p=Ke.useContext(r3);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&YD(d.current,t,i,p);const y=Ke.useRef(!1);Ke.useInsertionEffect(()=>{m&&y.current&&m.update(t,l)});const b=t[n3],x=Ke.useRef(!!b&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,b))&&((s=window.MotionHasOptimisedAnimation)===null||s===void 0?void 0:s.call(window,b)));return Y4(()=>{m&&(y.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),mb.render(m.render),x.current&&m.animationState&&m.animationState.animateChanges())}),Ke.useEffect(()=>{m&&(!x.current&&m.animationState&&m.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var E;(E=window.MotionHandoffMarkAsComplete)===null||E===void 0||E.call(window,b)}),x.current=!1))}),m}function YD(n,e,t,r){const{layoutId:i,layout:o,drag:s,dragConstraints:a,layoutScroll:u,layoutRoot:l}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:i3(n.parent)),n.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:!!s||a&&fd(a),visualElement:n,animationType:typeof o=="string"?o:"both",initialPromotionConfig:r,layoutScroll:u,layoutRoot:l})}function i3(n){if(n)return n.options.allowProjection!==!1?n.projection:i3(n.parent)}function QD({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var o,s;n&&VD(n);function a(l,h){let d;const m={...Ke.useContext(lb),...l,layoutId:JD(l)},{isStatic:p}=m,y=HD(l),b=r(l,p);if(!p&&cb){ZD();const x=eL(m);d=x.MeasureLayout,y.visualElement=XD(i,b,m,e,x.ProjectionNode)}return oe.jsxs(B0.Provider,{value:y,children:[d&&y.visualElement?oe.jsx(d,{visualElement:y.visualElement,...m}):null,t(i,l,$D(b,y.visualElement,h),b,p,y.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${(s=(o=i.displayName)!==null&&o!==void 0?o:i.name)!==null&&s!==void 0?s:""})`}`;const u=Ke.forwardRef(a);return u[GD]=i,u}function JD({layoutId:n}){const e=Ke.useContext(ab).id;return e&&n!==void 0?e+"-"+n:n}function ZD(n,e){Ke.useContext(Z4).strict}function eL(n){const{drag:e,layout:t}=Vd;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(n)||t!=null&&t.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const tL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function gb(n){return typeof n!="string"||n.includes("-")?!1:!!(tL.indexOf(n)>-1||/[A-Z]/u.test(n))}function j5(n){const e=[{},{}];return n==null||n.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function vb(n,e,t,r){if(typeof e=="function"){const[i,o]=j5(r);e=e(t!==void 0?t:n.custom,i,o)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,o]=j5(r);e=e(t!==void 0?t:n.custom,i,o)}return e}const F2=n=>Array.isArray(n),nL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),rL=n=>F2(n)?n[n.length-1]||0:n,as=n=>!!(n&&n.getVelocity);function Ev(n){const e=as(n)?n.get():n;return nL(e)?e.toValue():e}function iL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,o){const s={latestValues:oL(r,i,o,n),renderState:e()};return t&&(s.onMount=a=>t({props:r,current:a,...s}),s.onUpdate=a=>t(a)),s}const o3=n=>(e,t)=>{const r=Ke.useContext(B0),i=Ke.useContext(F0),o=()=>iL(n,e,r,i);return t?o():ub(o)};function oL(n,e,t,r){const i={},o=r(n,{});for(const m in o)i[m]=Ev(o[m]);let{initial:s,animate:a}=n;const u=j0(n),l=t3(n);e&&l&&!u&&n.inherit!==!1&&(s===void 0&&(s=e.initial),a===void 0&&(a=e.animate));let h=t?t.initial===!1:!1;h=h||s===!1;const d=h?a:s;if(d&&typeof d!="boolean"&&!V0(d)){const m=Array.isArray(d)?d:[d];for(let p=0;p<m.length;p++){const y=vb(n,m[p]);if(y){const{transitionEnd:b,transition:x,...E}=y;for(const T in E){let P=E[T];if(Array.isArray(P)){const C=h?P.length-1:0;P=P[C]}P!==null&&(i[T]=P)}for(const T in b)i[T]=b[T]}}}return i}const ep=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],vf=new Set(ep),s3=n=>e=>typeof e=="string"&&e.startsWith(n),a3=s3("--"),sL=s3("var(--"),yb=n=>sL(n)?aL.test(n.split("/*")[0].trim()):!1,aL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,u3=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Zl=(n,e,t)=>t>e?e:t<n?n:t,tp={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},mm={...tp,transform:n=>Zl(0,1,n)},Gg={...tp,default:1},Fm=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),jc=Fm("deg"),sl=Fm("%"),sn=Fm("px"),uL=Fm("vh"),lL=Fm("vw"),U5={...sl,parse:n=>sl.parse(n)/100,transform:n=>sl.transform(n*100)},cL={borderWidth:sn,borderTopWidth:sn,borderRightWidth:sn,borderBottomWidth:sn,borderLeftWidth:sn,borderRadius:sn,radius:sn,borderTopLeftRadius:sn,borderTopRightRadius:sn,borderBottomRightRadius:sn,borderBottomLeftRadius:sn,width:sn,maxWidth:sn,height:sn,maxHeight:sn,top:sn,right:sn,bottom:sn,left:sn,padding:sn,paddingTop:sn,paddingRight:sn,paddingBottom:sn,paddingLeft:sn,margin:sn,marginTop:sn,marginRight:sn,marginBottom:sn,marginLeft:sn,backgroundPositionX:sn,backgroundPositionY:sn},hL={rotate:jc,rotateX:jc,rotateY:jc,rotateZ:jc,scale:Gg,scaleX:Gg,scaleY:Gg,scaleZ:Gg,skew:jc,skewX:jc,skewY:jc,distance:sn,translateX:sn,translateY:sn,translateZ:sn,x:sn,y:sn,z:sn,perspective:sn,transformPerspective:sn,opacity:mm,originX:U5,originY:U5,originZ:sn},z5={...tp,transform:Math.round},wb={...cL,...hL,zIndex:z5,size:sn,fillOpacity:mm,strokeOpacity:mm,numOctaves:z5},fL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},dL=ep.length;function pL(n,e,t){let r="",i=!0;for(let o=0;o<dL;o++){const s=ep[o],a=n[s];if(a===void 0)continue;let u=!0;if(typeof a=="number"?u=a===(s.startsWith("scale")?1:0):u=parseFloat(a)===0,!u||t){const l=u3(a,wb[s]);if(!u){i=!1;const h=fL[s]||s;r+=`${h}(${l}) `}t&&(e[s]=l)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function bb(n,e,t){const{style:r,vars:i,transformOrigin:o}=n;let s=!1,a=!1;for(const u in e){const l=e[u];if(vf.has(u)){s=!0;continue}else if(a3(u)){i[u]=l;continue}else{const h=u3(l,wb[u]);u.startsWith("origin")?(a=!0,o[u]=h):r[u]=h}}if(e.transform||(s||t?r.transform=pL(e,n.transform,t):r.transform&&(r.transform="none")),a){const{originX:u="50%",originY:l="50%",originZ:h=0}=o;r.transformOrigin=`${u} ${l} ${h}`}}const mL={offset:"stroke-dashoffset",array:"stroke-dasharray"},gL={offset:"strokeDashoffset",array:"strokeDasharray"};function vL(n,e,t=1,r=0,i=!0){n.pathLength=1;const o=i?mL:gL;n[o.offset]=sn.transform(-r);const s=sn.transform(e),a=sn.transform(t);n[o.array]=`${s} ${a}`}function W5(n,e,t){return typeof n=="string"?n:sn.transform(e+t*n)}function yL(n,e,t){const r=W5(e,n.x,n.width),i=W5(t,n.y,n.height);return`${r} ${i}`}function xb(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:o,pathLength:s,pathSpacing:a=1,pathOffset:u=0,...l},h,d){if(bb(n,l,d),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:p,dimensions:y}=n;m.transform&&(y&&(p.transform=m.transform),delete m.transform),y&&(i!==void 0||o!==void 0||p.transform)&&(p.transformOrigin=yL(y,i!==void 0?i:.5,o!==void 0?o:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),r!==void 0&&(m.scale=r),s!==void 0&&vL(m,s,a,u,!1)}const _b=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),l3=()=>({..._b(),attrs:{}}),Eb=n=>typeof n=="string"&&n.toLowerCase()==="svg";function c3(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const o in t)n.style.setProperty(o,t[o])}const h3=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function f3(n,e,t,r){c3(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(h3.has(i)?i:pb(i),e.attrs[i])}const qv={};function wL(n){Object.assign(qv,n)}function d3(n,{layout:e,layoutId:t}){return vf.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!qv[n]||n==="opacity")}function Sb(n,e,t){var r;const{style:i}=n,o={};for(const s in i)(as(i[s])||e.style&&as(e.style[s])||d3(s,n)||((r=t==null?void 0:t.getValue(s))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(o[s]=i[s]);return o}function p3(n,e,t){const r=Sb(n,e,t);for(const i in n)if(as(n[i])||as(e[i])){const o=ep.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[o]=n[i]}return r}function bL(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const q5=["x","y","width","height","cx","cy","r"],xL={useVisualState:o3({scrapeMotionValuesFromProps:p3,createRenderState:l3,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let o=!!n.drag;if(!o){for(const a in i)if(vf.has(a)){o=!0;break}}if(!o)return;let s=!e;if(e)for(let a=0;a<q5.length;a++){const u=q5[a];n[u]!==e[u]&&(s=!0)}s&&Nr.read(()=>{bL(t,r),Nr.render(()=>{xb(r,i,Eb(t.tagName),n.transformTemplate),f3(t,r)})})}})},_L={useVisualState:o3({scrapeMotionValuesFromProps:Sb,createRenderState:_b})};function m3(n,e,t){for(const r in e)!as(e[r])&&!d3(r,t)&&(n[r]=e[r])}function EL({transformTemplate:n},e){return Ke.useMemo(()=>{const t=_b();return bb(t,e,n),Object.assign({},t.vars,t.style)},[e])}function SL(n,e){const t=n.style||{},r={};return m3(r,t,n),Object.assign(r,EL(n,e)),r}function AL(n,e){const t={},r=SL(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function CL(n,e,t,r){const i=Ke.useMemo(()=>{const o=l3();return xb(o,e,Eb(r),n.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(n.style){const o={};m3(o,n.style,n),i.style={...o,...i.style}}return i}function IL(n=!1){return(t,r,i,{latestValues:o},s)=>{const u=(gb(t)?CL:AL)(r,o,s,t),l=zD(r,typeof t=="string",n),h=t!==Ke.Fragment?{...l,...u,ref:i}:{},{children:d}=r,m=Ke.useMemo(()=>as(d)?d.get():d,[d]);return Ke.createElement(t,{...h,children:m})}}function TL(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const s={...gb(r)?xL:_L,preloadedFeatures:n,useRender:IL(i),createVisualElement:e,Component:r};return QD(s)}}function g3(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function U0(n,e,t){const r=n.getProps();return vb(r,e,t!==void 0?t:r.custom,n)}const kL=hb(()=>window.ScrollTimeline!==void 0);class NL{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(kL()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,o)=>{i&&i(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class RL extends NL{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Ab(n,e){return n?n[e]||n.default||n:void 0}const B2=2e4;function v3(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<B2;)e+=t,r=n.next(e);return e>=B2?1/0:e}function Cb(n){return typeof n=="function"}function H5(n,e){n.timeline=e,n.onfinish=null}const Ib=n=>Array.isArray(n)&&typeof n[0]=="number",PL={linearEasing:void 0};function DL(n,e){const t=hb(n);return()=>{var r;return(r=PL[e])!==null&&r!==void 0?r:t()}}const Hv=DL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),y3=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let o=0;o<i;o++)r+=n(Bd(0,i-1,o))+", ";return`linear(${r.substring(0,r.length-2)})`};function w3(n){return!!(typeof n=="function"&&Hv()||!n||typeof n=="string"&&(n in V2||Hv())||Ib(n)||Array.isArray(n)&&n.every(w3))}const qp=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,V2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:qp([0,.65,.55,1]),circOut:qp([.55,0,1,.45]),backIn:qp([.31,.01,.66,-.59]),backOut:qp([.33,1.53,.69,.99])};function b3(n,e){if(n)return typeof n=="function"&&Hv()?y3(n,e):Ib(n)?qp(n):Array.isArray(n)?n.map(t=>b3(t,e)||V2.easeOut):V2[n]}const mu={x:!1,y:!1};function x3(){return mu.x||mu.y}function LL(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const o=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return o?Array.from(o):[]}return Array.from(n)}function _3(n,e){const t=LL(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function G5(n){return e=>{e.pointerType==="touch"||x3()||n(e)}}function ML(n,e,t={}){const[r,i,o]=_3(n,t),s=G5(a=>{const{target:u}=a,l=e(a);if(typeof l!="function"||!u)return;const h=G5(d=>{l(d),u.removeEventListener("pointerleave",h)});u.addEventListener("pointerleave",h,i)});return r.forEach(a=>{a.addEventListener("pointerenter",s,i)}),o}const E3=(n,e)=>e?n===e?!0:E3(n,e.parentElement):!1,Tb=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,OL=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function FL(n){return OL.has(n.tagName)||n.tabIndex!==-1}const Hp=new WeakSet;function $5(n){return e=>{e.key==="Enter"&&n(e)}}function gy(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const BL=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=$5(()=>{if(Hp.has(t))return;gy(t,"down");const i=$5(()=>{gy(t,"up")}),o=()=>gy(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",o,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function K5(n){return Tb(n)&&!x3()}function VL(n,e,t={}){const[r,i,o]=_3(n,t),s=a=>{const u=a.currentTarget;if(!K5(a)||Hp.has(u))return;Hp.add(u);const l=e(a),h=(p,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",m),!(!K5(p)||!Hp.has(u))&&(Hp.delete(u),typeof l=="function"&&l(p,{success:y}))},d=p=>{h(p,t.useGlobalTarget||E3(u,p.target))},m=p=>{h(p,!1)};window.addEventListener("pointerup",d,i),window.addEventListener("pointercancel",m,i)};return r.forEach(a=>{!FL(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(t.useGlobalTarget?window:a).addEventListener("pointerdown",s,i),a.addEventListener("focus",l=>BL(l,i),i)}),o}function jL(n){return n==="x"||n==="y"?mu[n]?null:(mu[n]=!0,()=>{mu[n]=!1}):mu.x||mu.y?null:(mu.x=mu.y=!0,()=>{mu.x=mu.y=!1})}const S3=new Set(["width","height","top","left","right","bottom",...ep]);let Sv;function UL(){Sv=void 0}const al={now:()=>(Sv===void 0&&al.set(To.isProcessing||OD.useManualTiming?To.timestamp:performance.now()),Sv),set:n=>{Sv=n,queueMicrotask(UL)}};function kb(n,e){n.indexOf(e)===-1&&n.push(e)}function Nb(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class Rb{constructor(){this.subscriptions=[]}add(e){return kb(this.subscriptions,e),()=>Nb(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let o=0;o<i;o++){const s=this.subscriptions[o];s&&s(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function A3(n,e){return e?n*(1e3/e):0}const X5=30,zL=n=>!isNaN(parseFloat(n));class WL{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const o=al.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=al.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=zL(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Rb);const r=this.events[e].add(t);return e==="change"?()=>{r(),Nr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=al.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>X5)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,X5);return A3(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function gm(n,e){return new WL(n,e)}function qL(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,gm(t))}function HL(n,e){const t=U0(n,e);let{transitionEnd:r={},transition:i={},...o}=t||{};o={...o,...r};for(const s in o){const a=rL(o[s]);qL(n,s,a)}}function GL(n){return!!(as(n)&&n.add)}function j2(n,e){const t=n.getValue("willChange");if(GL(t))return t.add(e)}function C3(n){return n.props[n3]}const I3=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,$L=1e-7,KL=12;function XL(n,e,t,r,i){let o,s,a=0;do s=e+(t-e)/2,o=I3(s,r,i)-n,o>0?t=s:e=s;while(Math.abs(o)>$L&&++a<KL);return s}function Bm(n,e,t,r){if(n===e&&t===r)return ya;const i=o=>XL(o,0,1,n,t);return o=>o===0||o===1?o:I3(i(o),e,r)}const T3=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,k3=n=>e=>1-n(1-e),N3=Bm(.33,1.53,.69,.99),Pb=k3(N3),R3=T3(Pb),P3=n=>(n*=2)<1?.5*Pb(n):.5*(2-Math.pow(2,-10*(n-1))),Db=n=>1-Math.sin(Math.acos(n)),D3=k3(Db),L3=T3(Db),M3=n=>/^0[^.\s]+$/u.test(n);function YL(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||M3(n):!0}const Zp=n=>Math.round(n*1e5)/1e5,Lb=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function QL(n){return n==null}const JL=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Mb=(n,e)=>t=>!!(typeof t=="string"&&JL.test(t)&&t.startsWith(n)||e&&!QL(t)&&Object.prototype.hasOwnProperty.call(t,e)),O3=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,o,s,a]=r.match(Lb);return{[n]:parseFloat(i),[e]:parseFloat(o),[t]:parseFloat(s),alpha:a!==void 0?parseFloat(a):1}},ZL=n=>Zl(0,255,n),vy={...tp,transform:n=>Math.round(ZL(n))},Jh={test:Mb("rgb","red"),parse:O3("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+vy.transform(n)+", "+vy.transform(e)+", "+vy.transform(t)+", "+Zp(mm.transform(r))+")"};function e6(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const U2={test:Mb("#"),parse:e6,transform:Jh.transform},dd={test:Mb("hsl","hue"),parse:O3("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+sl.transform(Zp(e))+", "+sl.transform(Zp(t))+", "+Zp(mm.transform(r))+")"},es={test:n=>Jh.test(n)||U2.test(n)||dd.test(n),parse:n=>Jh.test(n)?Jh.parse(n):dd.test(n)?dd.parse(n):U2.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Jh.transform(n):dd.transform(n)},t6=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function n6(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(Lb))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(t6))===null||t===void 0?void 0:t.length)||0)>0}const F3="number",B3="color",r6="var",i6="var(",Y5="${}",o6=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function vm(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let o=0;const a=e.replace(o6,u=>(es.test(u)?(r.color.push(o),i.push(B3),t.push(es.parse(u))):u.startsWith(i6)?(r.var.push(o),i.push(r6),t.push(u)):(r.number.push(o),i.push(F3),t.push(parseFloat(u))),++o,Y5)).split(Y5);return{values:t,split:a,indexes:r,types:i}}function V3(n){return vm(n).values}function j3(n){const{split:e,types:t}=vm(n),r=e.length;return i=>{let o="";for(let s=0;s<r;s++)if(o+=e[s],i[s]!==void 0){const a=t[s];a===F3?o+=Zp(i[s]):a===B3?o+=es.transform(i[s]):o+=i[s]}return o}}const s6=n=>typeof n=="number"?0:n;function a6(n){const e=V3(n);return j3(n)(e.map(s6))}const ah={test:n6,parse:V3,createTransformer:j3,getAnimatableNone:a6},u6=new Set(["brightness","contrast","saturate","opacity"]);function l6(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(Lb)||[];if(!r)return n;const i=t.replace(r,"");let o=u6.has(e)?1:0;return r!==t&&(o*=100),e+"("+o+i+")"}const c6=/\b([a-z-]*)\(.*?\)/gu,z2={...ah,getAnimatableNone:n=>{const e=n.match(c6);return e?e.map(l6).join(" "):n}},h6={...wb,color:es,backgroundColor:es,outlineColor:es,fill:es,stroke:es,borderColor:es,borderTopColor:es,borderRightColor:es,borderBottomColor:es,borderLeftColor:es,filter:z2,WebkitFilter:z2},Ob=n=>h6[n];function U3(n,e){let t=Ob(n);return t!==z2&&(t=ah),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const f6=new Set(["auto","none","0"]);function d6(n,e,t){let r=0,i;for(;r<n.length&&!i;){const o=n[r];typeof o=="string"&&!f6.has(o)&&vm(o).values.length&&(i=n[r]),r++}if(i&&t)for(const o of e)n[o]=U3(t,i)}const Q5=n=>n===tp||n===sn,J5=(n,e)=>parseFloat(n.split(", ")[e]),Z5=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return J5(i[1],e);{const o=r.match(/^matrix\((.+)\)$/u);return o?J5(o[1],n):0}},p6=new Set(["x","y","z"]),m6=ep.filter(n=>!p6.has(n));function g6(n){const e=[];return m6.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const jd={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:Z5(4,13),y:Z5(5,14)};jd.translateX=jd.x;jd.translateY=jd.y;const nf=new Set;let W2=!1,q2=!1;function z3(){if(q2){const n=Array.from(nf).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=g6(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([o,s])=>{var a;(a=r.getValue(o))===null||a===void 0||a.set(s)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}q2=!1,W2=!1,nf.forEach(n=>n.complete()),nf.clear()}function W3(){nf.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(q2=!0)})}function v6(){W3(),z3()}class Fb{constructor(e,t,r,i,o,s=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=o,this.isAsync=s}scheduleResolve(){this.isScheduled=!0,this.isAsync?(nf.add(this),W2||(W2=!0,Nr.read(W3),Nr.resolveKeyframes(z3))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const s=i==null?void 0:i.get(),a=e[e.length-1];if(s!==void 0)e[0]=s;else if(r&&t){const u=r.readValue(t,a);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=a),i&&s===void 0&&i.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),nf.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,nf.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const q3=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),y6=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function w6(n){const e=y6.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function H3(n,e,t=1){const[r,i]=w6(n);if(!r)return;const o=window.getComputedStyle(e).getPropertyValue(r);if(o){const s=o.trim();return q3(s)?parseFloat(s):s}return yb(i)?H3(i,e,t+1):i}const G3=n=>e=>e.test(n),b6={test:n=>n==="auto",parse:n=>n},$3=[tp,sn,sl,jc,lL,uL,b6],eE=n=>$3.find(G3(n));class K3 extends Fb{constructor(e,t,r,i,o){super(e,t,r,i,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let l=e[u];if(typeof l=="string"&&(l=l.trim(),yb(l))){const h=H3(l,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=l)}}if(this.resolveNoneKeyframes(),!S3.has(r)||e.length!==2)return;const[i,o]=e,s=eE(i),a=eE(o);if(s!==a)if(Q5(s)&&Q5(a))for(let u=0;u<e.length;u++){const l=e[u];typeof l=="string"&&(e[u]=parseFloat(l))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)YL(e[i])&&r.push(i);r.length&&d6(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=jd[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const o=t.getValue(r);o&&o.jump(this.measuredOrigin,!1);const s=i.length-1,a=i[s];i[s]=jd[r](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,l])=>{t.getValue(u).set(l)}),this.resolveNoneKeyframes()}}const tE=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ah.test(n)||n==="0")&&!n.startsWith("url("));function x6(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function _6(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const o=n[n.length-1],s=tE(i,e),a=tE(o,e);return!s||!a?!1:x6(n)||(t==="spring"||Cb(t))&&r}const E6=n=>n!==null;function z0(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(E6),o=e&&t!=="loop"&&e%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const S6=40;class X3{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:s="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=al.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:o,repeatType:s,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>S6?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&v6(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=al.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:o,delay:s,onComplete:a,onUpdate:u,isGenerator:l}=this.options;if(!l&&!_6(e,r,i,o))if(s)this.options.duration=0;else{u&&u(z0(e,this.options,t)),a&&a(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Xr=(n,e,t)=>n+(e-n)*t;function yy(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function A6({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,o=0,s=0;if(!e)i=o=s=t;else{const a=t<.5?t*(1+e):t+e-t*e,u=2*t-a;i=yy(u,a,n+1/3),o=yy(u,a,n),s=yy(u,a,n-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(s*255),alpha:r}}function Gv(n,e){return t=>t>0?e:n}const wy=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},C6=[U2,Jh,dd],I6=n=>C6.find(e=>e.test(n));function nE(n){const e=I6(n);if(!e)return!1;let t=e.parse(n);return e===dd&&(t=A6(t)),t}const rE=(n,e)=>{const t=nE(n),r=nE(e);if(!t||!r)return Gv(n,e);const i={...t};return o=>(i.red=wy(t.red,r.red,o),i.green=wy(t.green,r.green,o),i.blue=wy(t.blue,r.blue,o),i.alpha=Xr(t.alpha,r.alpha,o),Jh.transform(i))},T6=(n,e)=>t=>e(n(t)),Vm=(...n)=>n.reduce(T6),H2=new Set(["none","hidden"]);function k6(n,e){return H2.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function N6(n,e){return t=>Xr(n,e,t)}function Bb(n){return typeof n=="number"?N6:typeof n=="string"?yb(n)?Gv:es.test(n)?rE:D6:Array.isArray(n)?Y3:typeof n=="object"?es.test(n)?rE:R6:Gv}function Y3(n,e){const t=[...n],r=t.length,i=n.map((o,s)=>Bb(o)(o,e[s]));return o=>{for(let s=0;s<r;s++)t[s]=i[s](o);return t}}function R6(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=Bb(n[i])(n[i],e[i]));return i=>{for(const o in r)t[o]=r[o](i);return t}}function P6(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const s=e.types[o],a=n.indexes[s][i[s]],u=(t=n.values[a])!==null&&t!==void 0?t:0;r[o]=u,i[s]++}return r}const D6=(n,e)=>{const t=ah.createTransformer(e),r=vm(n),i=vm(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?H2.has(n)&&!i.values.length||H2.has(e)&&!r.values.length?k6(n,e):Vm(Y3(P6(r,i),i.values),t):Gv(n,e)};function Q3(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Xr(n,e,t):Bb(n)(n,e)}const L6=5;function J3(n,e,t){const r=Math.max(e-L6,0);return A3(t-n(r),e-r)}const si={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},by=.001;function M6({duration:n=si.duration,bounce:e=si.bounce,velocity:t=si.velocity,mass:r=si.mass}){let i,o,s=1-e;s=Zl(si.minDamping,si.maxDamping,s),n=Zl(si.minDuration,si.maxDuration,Jl(n)),s<1?(i=l=>{const h=l*s,d=h*n,m=h-t,p=G2(l,s),y=Math.exp(-d);return by-m/p*y},o=l=>{const d=l*s*n,m=d*t+t,p=Math.pow(s,2)*Math.pow(l,2)*n,y=Math.exp(-d),b=G2(Math.pow(l,2),s);return(-i(l)+by>0?-1:1)*((m-p)*y)/b}):(i=l=>{const h=Math.exp(-l*n),d=(l-t)*n+1;return-by+h*d},o=l=>{const h=Math.exp(-l*n),d=(t-l)*(n*n);return h*d});const a=5/n,u=F6(i,o,a);if(n=Ql(n),isNaN(u))return{stiffness:si.stiffness,damping:si.damping,duration:n};{const l=Math.pow(u,2)*r;return{stiffness:l,damping:s*2*Math.sqrt(r*l),duration:n}}}const O6=12;function F6(n,e,t){let r=t;for(let i=1;i<O6;i++)r=r-n(r)/e(r);return r}function G2(n,e){return n*Math.sqrt(1-e*e)}const B6=["duration","bounce"],V6=["stiffness","damping","mass"];function iE(n,e){return e.some(t=>n[t]!==void 0)}function j6(n){let e={velocity:si.velocity,stiffness:si.stiffness,damping:si.damping,mass:si.mass,isResolvedFromDuration:!1,...n};if(!iE(n,V6)&&iE(n,B6))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,o=2*Zl(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:si.mass,stiffness:i,damping:o}}else{const t=M6(n);e={...e,...t,mass:si.mass},e.isResolvedFromDuration=!0}return e}function Z3(n=si.visualDuration,e=si.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const o=t.keyframes[0],s=t.keyframes[t.keyframes.length-1],a={done:!1,value:o},{stiffness:u,damping:l,mass:h,duration:d,velocity:m,isResolvedFromDuration:p}=j6({...t,velocity:-Jl(t.velocity||0)}),y=m||0,b=l/(2*Math.sqrt(u*h)),x=s-o,E=Jl(Math.sqrt(u/h)),T=Math.abs(x)<5;r||(r=T?si.restSpeed.granular:si.restSpeed.default),i||(i=T?si.restDelta.granular:si.restDelta.default);let P;if(b<1){const D=G2(E,b);P=z=>{const L=Math.exp(-b*E*z);return s-L*((y+b*E*x)/D*Math.sin(D*z)+x*Math.cos(D*z))}}else if(b===1)P=D=>s-Math.exp(-E*D)*(x+(y+E*x)*D);else{const D=E*Math.sqrt(b*b-1);P=z=>{const L=Math.exp(-b*E*z),I=Math.min(D*z,300);return s-L*((y+b*E*x)*Math.sinh(I)+D*x*Math.cosh(I))/D}}const C={calculatedDuration:p&&d||null,next:D=>{const z=P(D);if(p)a.done=D>=d;else{let L=0;b<1&&(L=D===0?Ql(y):J3(P,D,z));const I=Math.abs(L)<=r,A=Math.abs(s-z)<=i;a.done=I&&A}return a.value=a.done?s:z,a},toString:()=>{const D=Math.min(v3(C),B2),z=y3(L=>C.next(D*L).value,D,30);return D+"ms "+z}};return C}function oE({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:s,min:a,max:u,restDelta:l=.5,restSpeed:h}){const d=n[0],m={done:!1,value:d},p=I=>a!==void 0&&I<a||u!==void 0&&I>u,y=I=>a===void 0?u:u===void 0||Math.abs(a-I)<Math.abs(u-I)?a:u;let b=t*e;const x=d+b,E=s===void 0?x:s(x);E!==x&&(b=E-d);const T=I=>-b*Math.exp(-I/r),P=I=>E+T(I),C=I=>{const A=T(I),O=P(I);m.done=Math.abs(A)<=l,m.value=m.done?E:O};let D,z;const L=I=>{p(m.value)&&(D=I,z=Z3({keyframes:[m.value,y(m.value)],velocity:J3(P,I,m.value),damping:i,stiffness:o,restDelta:l,restSpeed:h}))};return L(0),{calculatedDuration:null,next:I=>{let A=!1;return!z&&D===void 0&&(A=!0,C(I),L(I)),D!==void 0&&I>=D?z.next(I-D):(!A&&C(I),m)}}}const U6=Bm(.42,0,1,1),z6=Bm(0,0,.58,1),eI=Bm(.42,0,.58,1),W6=n=>Array.isArray(n)&&typeof n[0]!="number",q6={linear:ya,easeIn:U6,easeInOut:eI,easeOut:z6,circIn:Db,circInOut:L3,circOut:D3,backIn:Pb,backInOut:R3,backOut:N3,anticipate:P3},sE=n=>{if(Ib(n)){Q4(n.length===4);const[e,t,r,i]=n;return Bm(e,t,r,i)}else if(typeof n=="string")return q6[n];return n};function H6(n,e,t){const r=[],i=t||Q3,o=n.length-1;for(let s=0;s<o;s++){let a=i(n[s],n[s+1]);if(e){const u=Array.isArray(e)?e[s]||ya:e;a=Vm(u,a)}r.push(a)}return r}function G6(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const o=n.length;if(Q4(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const s=n[0]===n[1];n[0]>n[o-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=H6(e,r,i),u=a.length,l=h=>{if(s&&h<n[0])return e[0];let d=0;if(u>1)for(;d<n.length-2&&!(h<n[d+1]);d++);const m=Bd(n[d],n[d+1],h);return a[d](m)};return t?h=>l(Zl(n[0],n[o-1],h)):l}function $6(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=Bd(0,e,r);n.push(Xr(t,1,i))}}function K6(n){const e=[0];return $6(e,n.length-1),e}function X6(n,e){return n.map(t=>t*e)}function Y6(n,e){return n.map(()=>e||eI).splice(0,n.length-1)}function $v({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=W6(r)?r.map(sE):sE(r),o={done:!1,value:e[0]},s=X6(t&&t.length===e.length?t:K6(e),n),a=G6(s,e,{ease:Array.isArray(i)?i:Y6(e,i)});return{calculatedDuration:n,next:u=>(o.value=a(u),o.done=u>=n,o)}}const Q6=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Nr.update(e,!0),stop:()=>sh(e),now:()=>To.isProcessing?To.timestamp:al.now()}},J6={decay:oE,inertia:oE,tween:$v,keyframes:$v,spring:Z3},Z6=n=>n/100;class Vb extends X3{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:r,element:i,keyframes:o}=this.options,s=(i==null?void 0:i.KeyframeResolver)||Fb,a=(u,l)=>this.onKeyframesResolved(u,l);this.resolver=new s(o,a,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o,velocity:s=0}=this.options,a=Cb(t)?t:J6[t]||$v;let u,l;a!==$v&&typeof e[0]!="number"&&(u=Vm(Z6,Q3(e[0],e[1])),e=[0,100]);const h=a({...this.options,keyframes:e});o==="mirror"&&(l=a({...this.options,keyframes:[...e].reverse(),velocity:-s})),h.calculatedDuration===null&&(h.calculatedDuration=v3(h));const{calculatedDuration:d}=h,m=d+i,p=m*(r+1)-i;return{generator:h,mirroredGenerator:l,mapPercentToKeyframes:u,calculatedDuration:d,resolvedDuration:m,totalDuration:p}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:I}=this.options;return{done:!0,value:I[I.length-1]}}const{finalKeyframe:i,generator:o,mirroredGenerator:s,mapPercentToKeyframes:a,keyframes:u,calculatedDuration:l,totalDuration:h,resolvedDuration:d}=r;if(this.startTime===null)return o.next(0);const{delay:m,repeat:p,repeatType:y,repeatDelay:b,onUpdate:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const E=this.currentTime-m*(this.speed>=0?1:-1),T=this.speed>=0?E<0:E>h;this.currentTime=Math.max(E,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let P=this.currentTime,C=o;if(p){const I=Math.min(this.currentTime,h)/d;let A=Math.floor(I),O=I%1;!O&&I>=1&&(O=1),O===1&&A--,A=Math.min(A,p+1),!!(A%2)&&(y==="reverse"?(O=1-O,b&&(O-=b/d)):y==="mirror"&&(C=s)),P=Zl(0,1,O)*d}const D=T?{done:!1,value:u[0]}:C.next(P);a&&(D.value=a(D.value));let{done:z}=D;!T&&l!==null&&(z=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const L=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&z);return L&&i!==void 0&&(D.value=z0(u,this.options,i)),x&&x(D.value),L&&this.finish(),D}get duration(){const{resolved:e}=this;return e?Jl(e.calculatedDuration):0}get time(){return Jl(this.currentTime)}set time(e){e=Ql(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Jl(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Q6,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const eM=new Set(["opacity","clipPath","filter","transform"]);function tM(n,e,t,{delay:r=0,duration:i=300,repeat:o=0,repeatType:s="loop",ease:a="easeInOut",times:u}={}){const l={[e]:t};u&&(l.offset=u);const h=b3(a,i);return Array.isArray(h)&&(l.easing=h),n.animate(l,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:o+1,direction:s==="reverse"?"alternate":"normal"})}const nM=hb(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Kv=10,rM=2e4;function iM(n){return Cb(n.type)||n.type==="spring"||!w3(n.ease)}function oM(n,e){const t=new Vb({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let o=0;for(;!r.done&&o<rM;)r=t.sample(o),i.push(r.value),o+=Kv;return{times:void 0,keyframes:i,duration:o-Kv,ease:"linear"}}const tI={anticipate:P3,backInOut:R3,circInOut:L3};function sM(n){return n in tI}class aE extends X3{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:o}=this.options;this.resolver=new K3(o,(s,a)=>this.onKeyframesResolved(s,a),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:o,type:s,motionValue:a,name:u,startTime:l}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof o=="string"&&Hv()&&sM(o)&&(o=tI[o]),iM(this.options)){const{onComplete:d,onUpdate:m,motionValue:p,element:y,...b}=this.options,x=oM(e,b);e=x.keyframes,e.length===1&&(e[1]=e[0]),r=x.duration,i=x.times,o=x.ease,s="keyframes"}const h=tM(a.owner.current,u,e,{...this.options,duration:r,times:i,ease:o});return h.startTime=l??this.calcStartTime(),this.pendingTimeline?(H5(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:d}=this.options;a.set(z0(e,this.options,t)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:s,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Jl(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Jl(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Ql(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return ya;const{animation:r}=t;H5(r,e)}return ya}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:o,ease:s,times:a}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:l,onUpdate:h,onComplete:d,element:m,...p}=this.options,y=new Vb({...p,keyframes:r,duration:i,type:o,ease:s,times:a,isGenerator:!0}),b=Ql(this.time);l.setWithVelocity(y.sample(b-Kv).value,y.sample(b).value,Kv)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:o,damping:s,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:l}=t.owner.getProps();return nM()&&r&&eM.has(r)&&!u&&!l&&!i&&o!=="mirror"&&s!==0&&a!=="inertia"}}const aM={type:"spring",stiffness:500,damping:25,restSpeed:10},uM=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),lM={type:"keyframes",duration:.8},cM={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},hM=(n,{keyframes:e})=>e.length>2?lM:vf.has(n)?n.startsWith("scale")?uM(e[1]):aM:cM;function fM({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:o,repeatType:s,repeatDelay:a,from:u,elapsed:l,...h}){return!!Object.keys(h).length}const jb=(n,e,t,r={},i,o)=>s=>{const a=Ab(r,n)||{},u=a.delay||r.delay||0;let{elapsed:l=0}=r;l=l-Ql(u);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-l,onUpdate:m=>{e.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{s(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:o?void 0:i};fM(a)||(h={...h,...hM(n,h)}),h.duration&&(h.duration=Ql(h.duration)),h.repeatDelay&&(h.repeatDelay=Ql(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let d=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(d=!0)),d&&!o&&e.get()!==void 0){const m=z0(h.keyframes,a);if(m!==void 0)return Nr.update(()=>{h.onUpdate(m),h.onComplete()}),new RL([])}return!o&&aE.supports(h)?new aE(h):new Vb(h)};function dM({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function nI(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var o;let{transition:s=n.getDefaultTransition(),transitionEnd:a,...u}=e;r&&(s=r);const l=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const d in u){const m=n.getValue(d,(o=n.latestValues[d])!==null&&o!==void 0?o:null),p=u[d];if(p===void 0||h&&dM(h,d))continue;const y={delay:t,...Ab(s||{},d)};let b=!1;if(window.MotionHandoffAnimation){const E=C3(n);if(E){const T=window.MotionHandoffAnimation(E,d,Nr);T!==null&&(y.startTime=T,b=!0)}}j2(n,d),m.start(jb(d,m,p,n.shouldReduceMotion&&S3.has(d)?{type:!1}:y,n,b));const x=m.animation;x&&l.push(x)}return a&&Promise.all(l).then(()=>{Nr.update(()=>{a&&HL(n,a)})}),l}function $2(n,e,t={}){var r;const i=U0(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:o=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(o=t.transitionOverride);const s=i?()=>Promise.all(nI(n,i,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(l=0)=>{const{delayChildren:h=0,staggerChildren:d,staggerDirection:m}=o;return pM(n,e,h+l,d,m,t)}:()=>Promise.resolve(),{when:u}=o;if(u){const[l,h]=u==="beforeChildren"?[s,a]:[a,s];return l().then(()=>h())}else return Promise.all([s(),a(t.delay)])}function pM(n,e,t=0,r=0,i=1,o){const s=[],a=(n.variantChildren.size-1)*r,u=i===1?(l=0)=>l*r:(l=0)=>a-l*r;return Array.from(n.variantChildren).sort(mM).forEach((l,h)=>{l.notify("AnimationStart",e),s.push($2(l,e,{...o,delay:t+u(h)}).then(()=>l.notify("AnimationComplete",e)))}),Promise.all(s)}function mM(n,e){return n.sortNodePosition(e)}function gM(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(o=>$2(n,o,t));r=Promise.all(i)}else if(typeof e=="string")r=$2(n,e,t);else{const i=typeof e=="function"?U0(n,e,t.custom):e;r=Promise.all(nI(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const vM=db.length;function rI(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?rI(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<vM;t++){const r=db[t],i=n.props[r];(pm(i)||i===!1)&&(e[r]=i)}return e}const yM=[...fb].reverse(),wM=fb.length;function bM(n){return e=>Promise.all(e.map(({animation:t,options:r})=>gM(n,t,r)))}function xM(n){let e=bM(n),t=uE(),r=!0;const i=u=>(l,h)=>{var d;const m=U0(n,h,u==="exit"?(d=n.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(m){const{transition:p,transitionEnd:y,...b}=m;l={...l,...b,...y}}return l};function o(u){e=u(n)}function s(u){const{props:l}=n,h=rI(n.parent)||{},d=[],m=new Set;let p={},y=1/0;for(let x=0;x<wM;x++){const E=yM[x],T=t[E],P=l[E]!==void 0?l[E]:h[E],C=pm(P),D=E===u?T.isActive:null;D===!1&&(y=x);let z=P===h[E]&&P!==l[E]&&C;if(z&&r&&n.manuallyAnimateOnMount&&(z=!1),T.protectedKeys={...p},!T.isActive&&D===null||!P&&!T.prevProp||V0(P)||typeof P=="boolean")continue;const L=_M(T.prevProp,P);let I=L||E===u&&T.isActive&&!z&&C||x>y&&C,A=!1;const O=Array.isArray(P)?P:[P];let k=O.reduce(i(E),{});D===!1&&(k={});const{prevResolvedValues:M={}}=T,j={...M,...k},X=ce=>{I=!0,m.has(ce)&&(A=!0,m.delete(ce)),T.needsAnimating[ce]=!0;const $=n.getValue(ce);$&&($.liveStyle=!1)};for(const ce in j){const $=k[ce],ae=M[ce];if(p.hasOwnProperty(ce))continue;let fe=!1;F2($)&&F2(ae)?fe=!g3($,ae):fe=$!==ae,fe?$!=null?X(ce):m.add(ce):$!==void 0&&m.has(ce)?X(ce):T.protectedKeys[ce]=!0}T.prevProp=P,T.prevResolvedValues=k,T.isActive&&(p={...p,...k}),r&&n.blockInitialAnimation&&(I=!1),I&&(!(z&&L)||A)&&d.push(...O.map(ce=>({animation:ce,options:{type:E}})))}if(m.size){const x={};m.forEach(E=>{const T=n.getBaseTarget(E),P=n.getValue(E);P&&(P.liveStyle=!0),x[E]=T??null}),d.push({animation:x})}let b=!!d.length;return r&&(l.initial===!1||l.initial===l.animate)&&!n.manuallyAnimateOnMount&&(b=!1),r=!1,b?e(d):Promise.resolve()}function a(u,l){var h;if(t[u].isActive===l)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(m=>{var p;return(p=m.animationState)===null||p===void 0?void 0:p.setActive(u,l)}),t[u].isActive=l;const d=s(u);for(const m in t)t[m].protectedKeys={};return d}return{animateChanges:s,setActive:a,setAnimateFunction:o,getState:()=>t,reset:()=>{t=uE(),r=!0}}}function _M(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!g3(e,n):!1}function zh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function uE(){return{animate:zh(!0),whileInView:zh(),whileHover:zh(),whileTap:zh(),whileDrag:zh(),whileFocus:zh(),exit:zh()}}class vh{constructor(e){this.isMounted=!1,this.node=e}update(){}}class EM extends vh{constructor(e){super(e),e.animationState||(e.animationState=xM(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();V0(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let SM=0;class AM extends vh{constructor(){super(...arguments),this.id=SM++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const CM={animation:{Feature:EM},exit:{Feature:AM}};function ym(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function jm(n){return{point:{x:n.pageX,y:n.pageY}}}const IM=n=>e=>Tb(e)&&n(e,jm(e));function em(n,e,t,r){return ym(n,e,IM(t),r)}const lE=(n,e)=>Math.abs(n-e);function TM(n,e){const t=lE(n.x,e.x),r=lE(n.y,e.y);return Math.sqrt(t**2+r**2)}class iI{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=_y(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,p=TM(d.offset,{x:0,y:0})>=3;if(!m&&!p)return;const{point:y}=d,{timestamp:b}=To;this.history.push({...y,timestamp:b});const{onStart:x,onMove:E}=this.handlers;m||(x&&x(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),E&&E(this.lastMoveEvent,d)},this.handlePointerMove=(d,m)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=xy(m,this.transformPagePoint),Nr.update(this.updatePoint,!0)},this.handlePointerUp=(d,m)=>{this.end();const{onEnd:p,onSessionEnd:y,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=_y(d.type==="pointercancel"?this.lastMoveEventInfo:xy(m,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,x),y&&y(d,x)},!Tb(e))return;this.dragSnapToOrigin=o,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const s=jm(e),a=xy(s,this.transformPagePoint),{point:u}=a,{timestamp:l}=To;this.history=[{...u,timestamp:l}];const{onSessionStart:h}=t;h&&h(e,_y(a,this.history)),this.removeListeners=Vm(em(this.contextWindow,"pointermove",this.handlePointerMove),em(this.contextWindow,"pointerup",this.handlePointerUp),em(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),sh(this.updatePoint)}}function xy(n,e){return e?{point:e(n.point)}:n}function cE(n,e){return{x:n.x-e.x,y:n.y-e.y}}function _y({point:n},e){return{point:n,delta:cE(n,oI(e)),offset:cE(n,kM(e)),velocity:NM(e,.1)}}function kM(n){return n[0]}function oI(n){return n[n.length-1]}function NM(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=oI(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ql(e)));)t--;if(!r)return{x:0,y:0};const o=Jl(i.timestamp-r.timestamp);if(o===0)return{x:0,y:0};const s={x:(i.x-r.x)/o,y:(i.y-r.y)/o};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}const sI=1e-4,RM=1-sI,PM=1+sI,aI=.01,DM=0-aI,LM=0+aI;function ba(n){return n.max-n.min}function MM(n,e,t){return Math.abs(n-e)<=t}function hE(n,e,t,r=.5){n.origin=r,n.originPoint=Xr(e.min,e.max,n.origin),n.scale=ba(t)/ba(e),n.translate=Xr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=RM&&n.scale<=PM||isNaN(n.scale))&&(n.scale=1),(n.translate>=DM&&n.translate<=LM||isNaN(n.translate))&&(n.translate=0)}function tm(n,e,t,r){hE(n.x,e.x,t.x,r?r.originX:void 0),hE(n.y,e.y,t.y,r?r.originY:void 0)}function fE(n,e,t){n.min=t.min+e.min,n.max=n.min+ba(e)}function OM(n,e,t){fE(n.x,e.x,t.x),fE(n.y,e.y,t.y)}function dE(n,e,t){n.min=e.min-t.min,n.max=n.min+ba(e)}function nm(n,e,t){dE(n.x,e.x,t.x),dE(n.y,e.y,t.y)}function FM(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Xr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Xr(t,n,r.max):Math.min(n,t)),n}function pE(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function BM(n,{top:e,left:t,bottom:r,right:i}){return{x:pE(n.x,t,i),y:pE(n.y,e,r)}}function mE(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function VM(n,e){return{x:mE(n.x,e.x),y:mE(n.y,e.y)}}function jM(n,e){let t=.5;const r=ba(n),i=ba(e);return i>r?t=Bd(e.min,e.max-r,n.min):r>i&&(t=Bd(n.min,n.max-i,e.min)),Zl(0,1,t)}function UM(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const K2=.35;function zM(n=K2){return n===!1?n=0:n===!0&&(n=K2),{x:gE(n,"left","right"),y:gE(n,"top","bottom")}}function gE(n,e,t){return{min:vE(n,e),max:vE(n,t)}}function vE(n,e){return typeof n=="number"?n:n[e]||0}const yE=()=>({translate:0,scale:1,origin:0,originPoint:0}),pd=()=>({x:yE(),y:yE()}),wE=()=>({min:0,max:0}),gi=()=>({x:wE(),y:wE()});function za(n){return[n("x"),n("y")]}function uI({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function WM({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function qM(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function Ey(n){return n===void 0||n===1}function X2({scale:n,scaleX:e,scaleY:t}){return!Ey(n)||!Ey(e)||!Ey(t)}function qh(n){return X2(n)||lI(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function lI(n){return bE(n.x)||bE(n.y)}function bE(n){return n&&n!=="0%"}function Xv(n,e,t){const r=n-t,i=e*r;return t+i}function xE(n,e,t,r,i){return i!==void 0&&(n=Xv(n,i,r)),Xv(n,t,r)+e}function Y2(n,e=0,t=1,r,i){n.min=xE(n.min,e,t,r,i),n.max=xE(n.max,e,t,r,i)}function cI(n,{x:e,y:t}){Y2(n.x,e.translate,e.scale,e.originPoint),Y2(n.y,t.translate,t.scale,t.originPoint)}const _E=.999999999999,EE=1.0000000000001;function HM(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let o,s;for(let a=0;a<i;a++){o=t[a],s=o.projectionDelta;const{visualElement:u}=o.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&gd(n,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),s&&(e.x*=s.x.scale,e.y*=s.y.scale,cI(n,s)),r&&qh(o.latestValues)&&gd(n,o.latestValues))}e.x<EE&&e.x>_E&&(e.x=1),e.y<EE&&e.y>_E&&(e.y=1)}function md(n,e){n.min=n.min+e,n.max=n.max+e}function SE(n,e,t,r,i=.5){const o=Xr(n.min,n.max,i);Y2(n,e,t,o,r)}function gd(n,e){SE(n.x,e.x,e.scaleX,e.scale,e.originX),SE(n.y,e.y,e.scaleY,e.scale,e.originY)}function hI(n,e){return uI(qM(n.getBoundingClientRect(),e))}function GM(n,e,t){const r=hI(n,t),{scroll:i}=e;return i&&(md(r.x,i.offset.x),md(r.y,i.offset.y)),r}const fI=({current:n})=>n?n.ownerDocument.defaultView:null,$M=new WeakMap;class KM{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=gi(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(jm(h).point)},o=(h,d)=>{const{drag:m,dragPropagation:p,onDragStart:y}=this.getProps();if(m&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=jL(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),za(x=>{let E=this.getAxisMotionValue(x).get()||0;if(sl.test(E)){const{projection:T}=this.visualElement;if(T&&T.layout){const P=T.layout.layoutBox[x];P&&(E=ba(P)*(parseFloat(E)/100))}}this.originPoint[x]=E}),y&&Nr.postRender(()=>y(h,d)),j2(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},s=(h,d)=>{const{dragPropagation:m,dragDirectionLock:p,onDirectionLock:y,onDrag:b}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:x}=d;if(p&&this.currentDirection===null){this.currentDirection=XM(x),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,x),this.updateAxis("y",d.point,x),this.visualElement.render(),b&&b(h,d)},a=(h,d)=>this.stop(h,d),u=()=>za(h=>{var d;return this.getAnimationState(h)==="paused"&&((d=this.getAxisMotionValue(h).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:l}=this.getProps();this.panSession=new iI(e,{onSessionStart:i,onStart:o,onMove:s,onSessionEnd:a,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:l,contextWindow:fI(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&Nr.postRender(()=>o(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!$g(e,i,this.currentDirection))return;const o=this.getAxisMotionValue(e);let s=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(s=FM(s,this.constraints[e],this.elastic[e])),o.set(s)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,o=this.constraints;t&&fd(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=BM(i.layoutBox,t):this.constraints=!1,this.elastic=zM(r),o!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&za(s=>{this.constraints!==!1&&this.getAxisMotionValue(s)&&(this.constraints[s]=UM(i.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!fd(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=GM(r,i.root,this.visualElement.getTransformPagePoint());let s=VM(i.layout.layoutBox,o);if(t){const a=t(WM(s));this.hasMutatedConstraints=!!a,a&&(s=uI(a))}return s}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:o,dragSnapToOrigin:s,onDragTransitionEnd:a}=this.getProps(),u=this.constraints||{},l=za(h=>{if(!$g(h,t,this.currentDirection))return;let d=u&&u[h]||{};s&&(d={min:0,max:0});const m=i?200:1e6,p=i?40:1e7,y={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...o,...d};return this.startAxisValueAnimation(h,y)});return Promise.all(l).then(a)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return j2(this.visualElement,e),r.start(jb(e,r,0,t,this.visualElement,!1))}stopAnimation(){za(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){za(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){za(t=>{const{drag:r}=this.getProps();if(!$g(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(t);if(i&&i.layout){const{min:s,max:a}=i.layout.layoutBox[t];o.set(e[t]-Xr(s,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!fd(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};za(s=>{const a=this.getAxisMotionValue(s);if(a&&this.constraints!==!1){const u=a.get();i[s]=jM({min:u,max:u},this.constraints[s])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),za(s=>{if(!$g(s,e,null))return;const a=this.getAxisMotionValue(s),{min:u,max:l}=this.constraints[s];a.set(Xr(u,l,i[s]))})}addListeners(){if(!this.visualElement.current)return;$M.set(this.visualElement,this);const e=this.visualElement.current,t=em(e,"pointerdown",u=>{const{drag:l,dragListener:h=!0}=this.getProps();l&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();fd(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Nr.read(r);const s=ym(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:l})=>{this.isDragging&&l&&(za(h=>{const d=this.getAxisMotionValue(h);d&&(this.originPoint[h]+=u[h].translate,d.set(d.get()+u[h].translate))}),this.visualElement.render())}));return()=>{s(),t(),o(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:s=K2,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:o,dragElastic:s,dragMomentum:a}}}function $g(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function XM(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class YM extends vh{constructor(e){super(e),this.removeGroupControls=ya,this.removeListeners=ya,this.controls=new KM(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ya}unmount(){this.removeGroupControls(),this.removeListeners()}}const AE=n=>(e,t)=>{n&&Nr.postRender(()=>n(e,t))};class QM extends vh{constructor(){super(...arguments),this.removePointerDownListener=ya}onPointerDown(e){this.session=new iI(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:fI(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:AE(e),onStart:AE(t),onMove:r,onEnd:(o,s)=>{delete this.session,i&&Nr.postRender(()=>i(o,s))}}}mount(){this.removePointerDownListener=em(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Av={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function CE(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Fp={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(sn.test(n))n=parseFloat(n);else return n;const t=CE(n,e.target.x),r=CE(n,e.target.y);return`${t}% ${r}%`}},JM={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=ah.parse(n);if(i.length>5)return r;const o=ah.createTransformer(n),s=typeof i[0]!="number"?1:0,a=t.x.scale*e.x,u=t.y.scale*e.y;i[0+s]/=a,i[1+s]/=u;const l=Xr(a,u,.5);return typeof i[2+s]=="number"&&(i[2+s]/=l),typeof i[3+s]=="number"&&(i[3+s]/=l),o(i)}};class ZM extends Ke.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:o}=e;wL(eO),o&&(t.group&&t.group.add(o),r&&r.register&&i&&r.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),Av.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:o}=this.props,s=r.projection;return s&&(s.isPresent=o,i||e.layoutDependency!==t||t===void 0?s.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?s.promote():s.relegate()||Nr.postRender(()=>{const a=s.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),mb.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function dI(n){const[e,t]=X4(),r=Ke.useContext(ab);return oe.jsx(ZM,{...n,layoutGroup:r,switchLayoutGroup:Ke.useContext(r3),isPresent:e,safeToRemove:t})}const eO={borderRadius:{...Fp,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Fp,borderTopRightRadius:Fp,borderBottomLeftRadius:Fp,borderBottomRightRadius:Fp,boxShadow:JM};function tO(n,e,t){const r=as(n)?n:gm(n);return r.start(jb("",r,e,t)),r.animation}function nO(n){return n instanceof SVGElement&&n.tagName!=="svg"}const rO=(n,e)=>n.depth-e.depth;class iO{constructor(){this.children=[],this.isDirty=!1}add(e){kb(this.children,e),this.isDirty=!0}remove(e){Nb(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(rO),this.isDirty=!1,this.children.forEach(e)}}function oO(n,e){const t=al.now(),r=({timestamp:i})=>{const o=i-t;o>=e&&(sh(r),n(o-e))};return Nr.read(r,!0),()=>sh(r)}const pI=["TopLeft","TopRight","BottomLeft","BottomRight"],sO=pI.length,IE=n=>typeof n=="string"?parseFloat(n):n,TE=n=>typeof n=="number"||sn.test(n);function aO(n,e,t,r,i,o){i?(n.opacity=Xr(0,t.opacity!==void 0?t.opacity:1,uO(r)),n.opacityExit=Xr(e.opacity!==void 0?e.opacity:1,0,lO(r))):o&&(n.opacity=Xr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let s=0;s<sO;s++){const a=`border${pI[s]}Radius`;let u=kE(e,a),l=kE(t,a);if(u===void 0&&l===void 0)continue;u||(u=0),l||(l=0),u===0||l===0||TE(u)===TE(l)?(n[a]=Math.max(Xr(IE(u),IE(l),r),0),(sl.test(l)||sl.test(u))&&(n[a]+="%")):n[a]=l}(e.rotate||t.rotate)&&(n.rotate=Xr(e.rotate||0,t.rotate||0,r))}function kE(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const uO=mI(0,.5,D3),lO=mI(.5,.95,ya);function mI(n,e,t){return r=>r<n?0:r>e?1:t(Bd(n,e,r))}function NE(n,e){n.min=e.min,n.max=e.max}function Ua(n,e){NE(n.x,e.x),NE(n.y,e.y)}function RE(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function PE(n,e,t,r,i){return n-=e,n=Xv(n,1/t,r),i!==void 0&&(n=Xv(n,1/i,r)),n}function cO(n,e=0,t=1,r=.5,i,o=n,s=n){if(sl.test(e)&&(e=parseFloat(e),e=Xr(s.min,s.max,e/100)-s.min),typeof e!="number")return;let a=Xr(o.min,o.max,r);n===o&&(a-=e),n.min=PE(n.min,e,t,a,i),n.max=PE(n.max,e,t,a,i)}function DE(n,e,[t,r,i],o,s){cO(n,e[t],e[r],e[i],e.scale,o,s)}const hO=["x","scaleX","originX"],fO=["y","scaleY","originY"];function LE(n,e,t,r){DE(n.x,e,hO,t?t.x:void 0,r?r.x:void 0),DE(n.y,e,fO,t?t.y:void 0,r?r.y:void 0)}function ME(n){return n.translate===0&&n.scale===1}function gI(n){return ME(n.x)&&ME(n.y)}function OE(n,e){return n.min===e.min&&n.max===e.max}function dO(n,e){return OE(n.x,e.x)&&OE(n.y,e.y)}function FE(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function vI(n,e){return FE(n.x,e.x)&&FE(n.y,e.y)}function BE(n){return ba(n.x)/ba(n.y)}function VE(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class pO{constructor(){this.members=[]}add(e){kb(this.members,e),e.scheduleRender()}remove(e){if(Nb(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){r=o;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function mO(n,e,t){let r="";const i=n.x.translate/e.x,o=n.y.translate/e.y,s=(t==null?void 0:t.z)||0;if((i||o||s)&&(r=`translate3d(${i}px, ${o}px, ${s}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:l,rotate:h,rotateX:d,rotateY:m,skewX:p,skewY:y}=t;l&&(r=`perspective(${l}px) ${r}`),h&&(r+=`rotate(${h}deg) `),d&&(r+=`rotateX(${d}deg) `),m&&(r+=`rotateY(${m}deg) `),p&&(r+=`skewX(${p}deg) `),y&&(r+=`skewY(${y}deg) `)}const a=n.x.scale*e.x,u=n.y.scale*e.y;return(a!==1||u!==1)&&(r+=`scale(${a}, ${u})`),r||"none"}const Hh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Gp=typeof window<"u"&&window.MotionDebug!==void 0,Sy=["","X","Y","Z"],gO={visibility:"hidden"},jE=1e3;let vO=0;function Ay(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function yI(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=C3(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:o}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Nr,!(i||o))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&yI(r)}function wI({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(s={},a=e==null?void 0:e()){this.id=vO++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Gp&&(Hh.totalNodes=Hh.resolvedTargetDeltas=Hh.recalculatedProjection=0),this.nodes.forEach(bO),this.nodes.forEach(AO),this.nodes.forEach(CO),this.nodes.forEach(xO),Gp&&window.MotionDebug.record(Hh)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new iO)}addEventListener(s,a){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new Rb),this.eventHandlers.get(s).add(a)}notifyListeners(s,...a){const u=this.eventHandlers.get(s);u&&u.notify(...a)}hasListeners(s){return this.eventHandlers.has(s)}mount(s,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=nO(s),this.instance=s;const{layoutId:u,layout:l,visualElement:h}=this.options;if(h&&!h.current&&h.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(l||u)&&(this.isLayoutDirty=!0),n){let d;const m=()=>this.root.updateBlockedByResize=!1;n(s,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=oO(m,250),Av.hasAnimatedSinceResize&&(Av.hasAnimatedSinceResize=!1,this.nodes.forEach(zE))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&h&&(u||l)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:m,hasRelativeTargetChanged:p,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||h.getDefaultTransition()||RO,{onLayoutAnimationStart:x,onLayoutAnimationComplete:E}=h.getProps(),T=!this.targetLayout||!vI(this.targetLayout,y)||p,P=!m&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||P||m&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,P);const C={...Ab(b,"layout"),onPlay:x,onComplete:E};(h.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C)}else m||zE(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,sh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(IO),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&yI(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const d=this.path[h];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:u}=this.options;if(a===void 0&&!u)return;const l=this.getTransformTemplate();this.prevTransformTemplateValue=l?l(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(UE);return}this.isUpdating||this.nodes.forEach(EO),this.isUpdating=!1,this.nodes.forEach(SO),this.nodes.forEach(yO),this.nodes.forEach(wO),this.clearAllSnapshots();const a=al.now();To.delta=Zl(0,1e3/60,a-To.timestamp),To.timestamp=a,To.isProcessing=!0,my.update.process(To),my.preRender.process(To),my.render.process(To),To.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,mb.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(_O),this.sharedNodes.forEach(TO)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Nr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Nr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=gi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(a=!1),a){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:s,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const s=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!gI(this.projectionDelta),u=this.getTransformTemplate(),l=u?u(this.latestValues,""):void 0,h=l!==this.prevTransformTemplateValue;s&&(a||qh(this.latestValues)||h)&&(i(this.instance,l),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const a=this.measurePageBox();let u=this.removeElementScroll(a);return s&&(u=this.removeTransform(u)),PO(u),{animationId:this.root.animationId,measuredBox:a,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var s;const{visualElement:a}=this.options;if(!a)return gi();const u=a.measureViewportBox();if(!(((s=this.scroll)===null||s===void 0?void 0:s.wasRoot)||this.path.some(DO))){const{scroll:h}=this.root;h&&(md(u.x,h.offset.x),md(u.y,h.offset.y))}return u}removeElementScroll(s){var a;const u=gi();if(Ua(u,s),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return u;for(let l=0;l<this.path.length;l++){const h=this.path[l],{scroll:d,options:m}=h;h!==this.root&&d&&m.layoutScroll&&(d.wasRoot&&Ua(u,s),md(u.x,d.offset.x),md(u.y,d.offset.y))}return u}applyTransform(s,a=!1){const u=gi();Ua(u,s);for(let l=0;l<this.path.length;l++){const h=this.path[l];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&gd(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),qh(h.latestValues)&&gd(u,h.latestValues)}return qh(this.latestValues)&&gd(u,this.latestValues),u}removeTransform(s){const a=gi();Ua(a,s);for(let u=0;u<this.path.length;u++){const l=this.path[u];if(!l.instance||!qh(l.latestValues))continue;X2(l.latestValues)&&l.updateSnapshot();const h=gi(),d=l.measurePageBox();Ua(h,d),LE(a,l.latestValues,l.snapshot?l.snapshot.layoutBox:void 0,h)}return qh(this.latestValues)&&LE(a,this.latestValues),a}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==To.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){var a;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==u;if(!(s||l&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:m}=this.options;if(!(!this.layout||!(d||m))){if(this.resolvedRelativeTargetAt=To.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=gi(),this.relativeTargetOrigin=gi(),nm(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),Ua(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=gi(),this.targetWithTransforms=gi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),OM(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ua(this.target,this.layout.layoutBox),cI(this.target,this.targetDelta)):Ua(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=gi(),this.relativeTargetOrigin=gi(),nm(this.relativeTargetOrigin,this.target,p.target),Ua(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Gp&&Hh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||X2(this.parent.latestValues)||lI(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var s;const a=this.getLead(),u=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty)&&(l=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===To.timestamp&&(l=!1),l)return;const{layout:h,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||d))return;Ua(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,p=this.treeScale.y;HM(this.layoutCorrected,this.treeScale,this.path,u),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=gi());const{target:y}=a;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(RE(this.prevProjectionDelta.x,this.projectionDelta.x),RE(this.prevProjectionDelta.y,this.projectionDelta.y)),tm(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==p||!VE(this.projectionDelta.x,this.prevProjectionDelta.x)||!VE(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),Gp&&Hh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),s){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=pd(),this.projectionDelta=pd(),this.projectionDeltaWithTransform=pd()}setAnimationOrigin(s,a=!1){const u=this.snapshot,l=u?u.latestValues:{},h={...this.latestValues},d=pd();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=gi(),p=u?u.source:void 0,y=this.layout?this.layout.source:void 0,b=p!==y,x=this.getStack(),E=!x||x.members.length<=1,T=!!(b&&!E&&this.options.crossfade===!0&&!this.path.some(NO));this.animationProgress=0;let P;this.mixTargetDelta=C=>{const D=C/1e3;WE(d.x,s.x,D),WE(d.y,s.y,D),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(nm(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),kO(this.relativeTarget,this.relativeTargetOrigin,m,D),P&&dO(this.relativeTarget,P)&&(this.isProjectionDirty=!1),P||(P=gi()),Ua(P,this.relativeTarget)),b&&(this.animationValues=h,aO(h,l,this.latestValues,D,T,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(sh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Nr.update(()=>{Av.hasAnimatedSinceResize=!0,this.currentAnimation=tO(0,jE,{...s,onUpdate:a=>{this.mixTargetDelta(a),s.onUpdate&&s.onUpdate(a)},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(jE),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:a,target:u,layout:l,latestValues:h}=s;if(!(!a||!u||!l)){if(this!==s&&this.layout&&l&&bI(this.options.animationType,this.layout.layoutBox,l.layoutBox)){u=this.target||gi();const d=ba(this.layout.layoutBox.x);u.x.min=s.target.x.min,u.x.max=u.x.min+d;const m=ba(this.layout.layoutBox.y);u.y.min=s.target.y.min,u.y.max=u.y.min+m}Ua(a,u),gd(a,h),tm(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(s,a){this.sharedNodes.has(s)||this.sharedNodes.set(s,new pO),this.sharedNodes.get(s).add(a);const l=a.options.initialPromotionConfig;a.promote({transition:l?l.transition:void 0,preserveFollowOpacity:l&&l.shouldPreserveFollowOpacity?l.shouldPreserveFollowOpacity(a):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){var s;const{layoutId:a}=this.options;return a?((s=this.getStack())===null||s===void 0?void 0:s.lead)||this:this}getPrevLead(){var s;const{layoutId:a}=this.options;return a?(s=this.getStack())===null||s===void 0?void 0:s.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:a,preserveFollowOpacity:u}={}){const l=this.getStack();l&&l.promote(this,u),s&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetSkewAndRotation(){const{visualElement:s}=this.options;if(!s)return;let a=!1;const{latestValues:u}=s;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(a=!0),!a)return;const l={};u.z&&Ay("z",s,l,this.animationValues);for(let h=0;h<Sy.length;h++)Ay(`rotate${Sy[h]}`,s,l,this.animationValues),Ay(`skew${Sy[h]}`,s,l,this.animationValues);s.render();for(const h in l)s.setStaticValue(h,l[h]),this.animationValues&&(this.animationValues[h]=l[h]);s.scheduleRender()}getProjectionStyles(s){var a,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return gO;const l={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,l.opacity="",l.pointerEvents=Ev(s==null?void 0:s.pointerEvents)||"",l.transform=h?h(this.latestValues,""):"none",l;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const b={};return this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=Ev(s==null?void 0:s.pointerEvents)||""),this.hasProjected&&!qh(this.latestValues)&&(b.transform=h?h({},""):"none",this.hasProjected=!1),b}const m=d.animationValues||d.latestValues;this.applyTransformsToTarget(),l.transform=mO(this.projectionDeltaWithTransform,this.treeScale,m),h&&(l.transform=h(m,l.transform));const{x:p,y}=this.projectionDelta;l.transformOrigin=`${p.origin*100}% ${y.origin*100}% 0`,d.animationValues?l.opacity=d===this?(u=(a=m.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:l.opacity=d===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const b in qv){if(m[b]===void 0)continue;const{correct:x,applyTo:E}=qv[b],T=l.transform==="none"?m[b]:x(m[b],d);if(E){const P=E.length;for(let C=0;C<P;C++)l[E[C]]=T}else l[b]=T}return this.options.layoutId&&(l.pointerEvents=d===this?Ev(s==null?void 0:s.pointerEvents)||"":"none"),l}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>{var a;return(a=s.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(UE),this.root.sharedNodes.clear()}}}function yO(n){n.updateLayout()}function wO(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:o}=n.options,s=t.source!==n.layout.source;o==="size"?za(d=>{const m=s?t.measuredBox[d]:t.layoutBox[d],p=ba(m);m.min=r[d].min,m.max=m.min+p}):bI(o,t.layoutBox,r)&&za(d=>{const m=s?t.measuredBox[d]:t.layoutBox[d],p=ba(r[d]);m.max=m.min+p,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[d].max=n.relativeTarget[d].min+p)});const a=pd();tm(a,r,t.layoutBox);const u=pd();s?tm(u,n.applyTransform(i,!0),t.measuredBox):tm(u,r,t.layoutBox);const l=!gI(a);let h=!1;if(!n.resumeFrom){const d=n.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:m,layout:p}=d;if(m&&p){const y=gi();nm(y,t.layoutBox,m.layoutBox);const b=gi();nm(b,r,p.layoutBox),vI(y,b)||(h=!0),d.options.layoutRoot&&(n.relativeTarget=b,n.relativeTargetOrigin=y,n.relativeParent=d)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:u,layoutDelta:a,hasLayoutChanged:l,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function bO(n){Gp&&Hh.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function xO(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function _O(n){n.clearSnapshot()}function UE(n){n.clearMeasurements()}function EO(n){n.isLayoutDirty=!1}function SO(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function zE(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function AO(n){n.resolveTargetDelta()}function CO(n){n.calcProjection()}function IO(n){n.resetSkewAndRotation()}function TO(n){n.removeLeadSnapshot()}function WE(n,e,t){n.translate=Xr(e.translate,0,t),n.scale=Xr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function qE(n,e,t,r){n.min=Xr(e.min,t.min,r),n.max=Xr(e.max,t.max,r)}function kO(n,e,t,r){qE(n.x,e.x,t.x,r),qE(n.y,e.y,t.y,r)}function NO(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const RO={duration:.45,ease:[.4,0,.1,1]},HE=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),GE=HE("applewebkit/")&&!HE("chrome/")?Math.round:ya;function $E(n){n.min=GE(n.min),n.max=GE(n.max)}function PO(n){$E(n.x),$E(n.y)}function bI(n,e,t){return n==="position"||n==="preserve-aspect"&&!MM(BE(e),BE(t),.2)}function DO(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const LO=wI({attachResizeListener:(n,e)=>ym(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Cy={current:void 0},xI=wI({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!Cy.current){const n=new LO({});n.mount(window),n.setOptions({layoutScroll:!0}),Cy.current=n}return Cy.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),MO={pan:{Feature:QM},drag:{Feature:YM,ProjectionNode:xI,MeasureLayout:dI}};function KE(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,o=r[i];o&&Nr.postRender(()=>o(e,jm(e)))}class OO extends vh{mount(){const{current:e}=this.node;e&&(this.unmount=ML(e,t=>(KE(this.node,t,"Start"),r=>KE(this.node,r,"End"))))}unmount(){}}class FO extends vh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Vm(ym(this.node.current,"focus",()=>this.onFocus()),ym(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function XE(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),o=r[i];o&&Nr.postRender(()=>o(e,jm(e)))}class BO extends vh{mount(){const{current:e}=this.node;e&&(this.unmount=VL(e,t=>(XE(this.node,t,"Start"),(r,{success:i})=>XE(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Q2=new WeakMap,Iy=new WeakMap,VO=n=>{const e=Q2.get(n.target);e&&e(n)},jO=n=>{n.forEach(VO)};function UO({root:n,...e}){const t=n||document;Iy.has(t)||Iy.set(t,{});const r=Iy.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(jO,{root:n,...e})),r[i]}function zO(n,e,t){const r=UO(e);return Q2.set(n,t),r.observe(n),()=>{Q2.delete(n),r.unobserve(n)}}const WO={some:0,all:1};class qO extends vh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:o}=e,s={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:WO[i]},a=u=>{const{isIntersecting:l}=u;if(this.isInView===l||(this.isInView=l,o&&!l&&this.hasEnteredView))return;l&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",l);const{onViewportEnter:h,onViewportLeave:d}=this.node.getProps(),m=l?h:d;m&&m(u)};return zO(this.node.current,s,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(HO(e,t))&&this.startObserver()}unmount(){}}function HO({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const GO={inView:{Feature:qO},tap:{Feature:BO},focus:{Feature:FO},hover:{Feature:OO}},$O={layout:{ProjectionNode:xI,MeasureLayout:dI}},J2={current:null},_I={current:!1};function KO(){if(_I.current=!0,!!cb)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>J2.current=n.matches;n.addListener(e),e()}else J2.current=!1}const XO=[...$3,es,ah],YO=n=>XO.find(G3(n)),YE=new WeakMap;function QO(n,e,t){for(const r in e){const i=e[r],o=t[r];if(as(i))n.addValue(r,i);else if(as(o))n.addValue(r,gm(i,{owner:n}));else if(o!==i)if(n.hasValue(r)){const s=n.getValue(r);s.liveStyle===!0?s.jump(i):s.hasAnimated||s.set(i)}else{const s=n.getStaticValue(r);n.addValue(r,gm(s!==void 0?s:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const QE=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class JO{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:o,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Fb,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=al.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,Nr.render(this.render,!1,!0))};const{latestValues:u,renderState:l,onUpdate:h}=s;this.onUpdate=h,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=j0(t),this.isVariantNode=t3(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const p in m){const y=m[p];u[p]!==void 0&&as(y)&&y.set(u[p],!1)}}mount(e){this.current=e,YE.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),_I.current||KO(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:J2.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){YE.delete(this.current),this.projection&&this.projection.unmount(),sh(this.notifyUpdate),sh(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=vf.has(e),i=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Nr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),o=t.on("renderRequest",this.scheduleRender);let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),o(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Vd){const t=Vd[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):gi()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<QE.length;r++){const i=QE[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o="on"+i,s=e[o];s&&(this.propEventSubscriptions[i]=this.on(i,s))}this.prevMotionValues=QO(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=gm(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(q3(i)||M3(i))?i=parseFloat(i):!YO(i)&&ah.test(t)&&(i=U3(e,t)),this.setBaseTarget(e,as(i)?i.get():i)),as(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const s=vb(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);s&&(i=s[e])}if(r&&i!==void 0)return i;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!as(o)?o:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Rb),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class EI extends JO{constructor(){super(...arguments),this.KeyframeResolver=K3}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;as(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function ZO(n){return window.getComputedStyle(n)}class eF extends EI{constructor(){super(...arguments),this.type="html",this.renderInstance=c3}readValueFromInstance(e,t){if(vf.has(t)){const r=Ob(t);return r&&r.default||0}else{const r=ZO(e),i=(a3(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return hI(e,t)}build(e,t,r){bb(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return Sb(e,t,r)}}class tF extends EI{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=gi}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(vf.has(t)){const r=Ob(t);return r&&r.default||0}return t=h3.has(t)?t:pb(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return p3(e,t,r)}build(e,t,r){xb(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){f3(e,t,r,i)}mount(e){this.isSVGTag=Eb(e.tagName),super.mount(e)}}const nF=(n,e)=>gb(n)?new tF(e):new eF(e,{allowProjection:n!==Ke.Fragment}),rF=TL({...CM,...GO,...MO,...$O},nF),JE=WD(rF),iF=({isOpen:n,onClose:e,onOpenSettings:t})=>{const{setActiveMode:r,playSound:i,speak:o}=Eu(),[s,a]=Ke.useState(null),u=160,d=s==="COMMS"?[{id:"whatsapp",label:"WHATSAPP",icon:"fab fa-whatsapp",angle:225,url:"https://wa.me/"},{id:"messenger",label:"MESSENGER",icon:"fab fa-facebook-messenger",angle:180,url:"https://m.me/"},{id:"viber",label:"VIBER",icon:"fab fa-viber",angle:135,url:"viber://forward?text=Status%20Check"},{id:"facebook",label:"FACEBOOK",icon:"fab fa-facebook-f",angle:90,url:"https://facebook.com/"},{id:"instagram",label:"INSTAGRAM",icon:"fab fa-instagram",angle:45,url:"https://instagram.com/"},{id:"x",label:"X",icon:"fab fa-x-twitter",angle:0,url:"https://x.com/"},{id:"youtube",label:"YOUTUBE",icon:"fab fa-youtube",angle:-45,url:"https://youtube.com/"},{id:"back",label:"BACK",icon:"fa-undo",angle:-90,action:()=>a(null)}]:[{id:"hud",label:"DRIVE",icon:"fa-car",angle:-90,action:()=>{r("HUD"),o("Driving protocols initiated.")}},{id:"database",label:"DATABASE",icon:"fa-database",angle:-45,action:()=>{r("DATABASE"),o("Accessing personnel records.")}},{id:"recon",label:"RECON",icon:"fa-search-location",angle:0,action:()=>{r("RECON"),o("Sales targeting engaged.")}},{id:"ops",label:"OPS LOG",icon:"fa-file-medical-alt",angle:45,action:()=>{r("OPS"),o("Operations center online.")}},{id:"media",label:"MEDIA",icon:"fa-music",angle:90,action:()=>{r("MEDIA"),o("Media player ready.")}},{id:"vision",label:"VISION",icon:"fa-eye",angle:135,action:()=>{r("VISION"),o("Vision systems active.")}},{id:"guardian",label:"GUARDIAN",icon:"fa-shield-alt",angle:180,action:()=>{r("GUARDIAN")}},{id:"comms",label:"COMMS",icon:"fa-comments",angle:225,action:()=>{a("COMMS"),o("Comms open.")}}],m=y=>{const b=y*Math.PI/180;return{x:Math.cos(b)*u,y:Math.sin(b)*u*.8}},p=y=>{i("click"),y.url?(o(`Opening ${y.label}`),y.url.startsWith("viber://")||y.url.startsWith("whatsapp://")?window.location.href=y.url:window.open(y.url,"_blank")):y.action&&y.action(),y.id!=="comms"&&y.id!=="back"&&(e(),a(null))};return oe.jsx(MD,{children:n&&oe.jsx(JE.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 backdrop-blur-[2px]",onClick:()=>{e(),a(null)},children:oe.jsxs("div",{className:"relative w-0 h-0 flex items-center justify-center",onClick:y=>y.stopPropagation(),children:[oe.jsx("div",{className:"absolute w-32 h-32 rounded-full cursor-pointer",onClick:()=>{e(),a(null)}}),d.map((y,b)=>{const x=m(y.angle);return oe.jsxs(JE.button,{initial:{x:0,y:0,scale:0,opacity:0},animate:{x:x.x,y:x.y,scale:1,opacity:1},exit:{x:0,y:0,scale:0,opacity:0},transition:{type:"spring",stiffness:200,damping:20,delay:b*.03},onClick:()=>p(y),className:`
                    absolute w-20 h-20 rounded-full border border-cyan/50 bg-black/80
                    flex flex-col items-center justify-center gap-1
                    shadow-[0_0_15px_rgba(0,229,255,0.2)]
                    hover:scale-110 hover:border-cyan hover:bg-cyan/20 hover:shadow-[0_0_25px_rgba(0,229,255,0.6)]
                    active:scale-95 transition-all
                    ${y.id==="back"?"border-red-500/50 text-red-500 hover:border-red-500":"text-cyan"}
                  `,children:[oe.jsx("i",{className:`fas ${y.icon} text-2xl`}),oe.jsx("span",{className:"font-orbitron text-[8px] tracking-wider mt-1",children:y.label}),oe.jsx("div",{className:"absolute top-1/2 left-1/2 w-[160px] h-[1px] bg-cyan/20 -z-10 origin-left pointer-events-none",style:{transform:`rotate(${y.angle+180}deg)`,width:`${u}px`,left:"50%",top:"50%"}})]},y.id)})]})})})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var SI=function(n,e){return(SI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])})(n,e)};function Su(n,e){function t(){this.constructor=n}SI(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Nt(n,e,t,r){return new(t||(t=Promise))((function(i,o){function s(l){try{u(r.next(l))}catch(h){o(h)}}function a(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):new t((function(h){h(l.value)})).then(s,a)}u((r=r.apply(n,[])).next())}))}function Rt(n,e){var t,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(i=2&h[0]?r.return:h[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,h[1])).done)return i;switch(r=0,i&&(h=[2&h[0],i.value]),h[0]){case 0:case 1:i=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,r=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(h[0]===6||h[0]===2)){s=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){s.label=h[1];break}if(h[0]===6&&s.label<i[1]){s.label=i[1],i=h;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(h);break}i[2]&&s.ops.pop(),s.trys.pop();continue}h=e.call(n,s)}catch(d){h=[6,d],r=0}finally{t=i=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([u,l])}}}var oF=(function(){function n(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return n.prototype.setPlatform=function(e,t){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},n.prototype.registerFlag=function(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){var i=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+i+"."),this.set(e,i)}},n.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},n.prototype.getNumber=function(e){return this.get(e)},n.prototype.getBool=function(e){return this.get(e)},n.prototype.getFlags=function(){return this.flags},Object.defineProperty(n.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),n.prototype.set=function(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)},n.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},n.prototype.setFlags=function(e){this.flags=Object.assign({},e)},n.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},n.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var t,r,i=(t=this.global.location.search,r={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(o){for(var s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];return sF(r,s[0],s[1]),s.join("=")})),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach((function(o){var s=o.split(":"),a=s[0],u=s[1];e.urlFlags[a]=(function(l,h){if((h=h.toLowerCase())==="true"||h==="false")return h==="true";if(""+ +h===h)return+h;throw new Error("Could not parse value flag value "+h+" for flag "+l+".")})(a,u)}))}},n})();function sF(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function Ye(){return AI}var AI=null,Yv=new Map,Z2=new Map;function CI(n,e){var t=TI(n,e);return Yv.get(t)}function aF(n){return Z2.get(n)}function ZE(n){for(var e=Yv.entries(),t=[];;){var r=e.next(),i=r.done,o=r.value;if(i)break;var s=o[0],a=o[1];s.split("_")[0]===n&&t.push(a)}return t}function II(n){var e=n.kernelName,t=n.backendName,r=TI(e,t);if(Yv.has(r))throw new Error("The kernel '"+e+"' for backend '"+t+"' is already registered");Yv.set(r,n)}function uF(n){var e=n.kernelName;Z2.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),Z2.set(e,n)}function TI(n,e){return e+"_"+n}function ew(n,e,t){return Math.max(n,Math.min(e,t))}function kI(n){return n%2==0?n:n+1}function lF(n){for(var e=0,t=0;t<n.length;t++)e+=n[t];return e}function me(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function ir(n,e,t){t===void 0&&(t=""),me(po(n,e),(function(){return t+" Shapes "+n+" and "+e+" must match"}))}function np(n){me(n!=null,(function(){return"The input to the tensor constructor must be a non-null value."}))}function Ud(n,e,t){if(e===void 0&&(e=[]),t===void 0&&(t=!1),e==null&&(e=[]),Array.isArray(n)||ul(n)&&!t)for(var r=0;r<n.length;++r)Ud(n[r],e,t);else e.push(n);return e}function Mt(n){if(n.length===0)return 1;for(var e=n[0],t=1;t<n.length;t++)e*=n[t];return e}function po(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function xi(n){return n%1==0}function cF(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;var e=Math.exp(2*n);return(e-1)/(e+1)}function tw(n){var e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function wd(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function eS(n,e,t){return e===void 0&&(e=function(r){return 0}),new Promise((function(r,i){var o=0,s=function(){if(n())r();else{o++;var a=e(o);t!=null&&o>=t?i():setTimeout(s,a)}};s()}))}function hF(n,e){for(var t=1,r=-1,i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(n[i]<0)throw Error("Shapes can not be < 0. Found "+n[i]+" at dim "+i);if(r===-1){if(e>0&&e!==t)throw Error("Size("+e+") must match the product of shape "+n);return n}if(t===0)throw Error("Cannot infer the missing size in ["+n+"] when there are 0 elements");if(e%t!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+t);var o=n.slice();return o[r]=e/t,o}function Xi(n,e){var t=e.length;return me((n=n==null?e.map((function(r,i){return i})):[].concat(n)).every((function(r){return r>=-t&&r<t})),(function(){return"All values in axis param must be in range [-"+t+", "+t+") but got axis "+n})),me(n.every((function(r){return xi(r)})),(function(){return"All values in axis param must be integers but got axis "+n})),n.map((function(r){return r<0?t+r:r}))}function Yh(n,e){for(var t=[],r=[],i=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||i?null:Xi(e,n).sort(),s=0,a=0;a<n.length;++a){if(o!=null){if(o[s]===a&&n[a]!==1)throw new Error("Can't squeeze axis "+a+" since its dim '"+n[a]+"' is not 1");(o[s]==null||o[s]>a)&&n[a]===1&&(t.push(n[a]),r.push(a)),o[s]<=a&&s++}n[a]!==1&&(t.push(n[a]),r.push(a))}return{newShape:t,keptDims:r}}function wm(n,e){var t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else{if(n!=="bool")throw new Error("Unknown data type "+n);t=new Uint8Array(e)}return t}function Qv(n,e){var t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else{if(n!=="string")throw new Error("Unknown data type "+n);t=new Array(e)}return t}function fF(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function dF(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function pF(n,e){return e!=="complex64"&&(e!=="float32"||n==="complex64")&&(e!=="int32"||n==="float32"||n==="complex64")&&(e!=="bool"||n!=="bool")}function ul(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array}function NI(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error("Unknown dtype "+n)}function mF(n){if(n==null)return 0;var e=0;return n.forEach((function(t){return e+=t.length})),e}function Ub(n){return typeof n=="string"||n instanceof String}function gF(n){return typeof n=="boolean"}function vF(n){return typeof n=="number"}function Um(n){return Array.isArray(n)?Um(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array?"int32":vF(n)?"float32":Ub(n)?"string":gF(n)?"bool":"float32"}function nw(n){return!!(n&&n.constructor&&n.call&&n.apply)}function rw(n,e){for(var t=e;t<n;++t)if(n%t==0)return t;return n}function ll(n){var e=n.length;if(e<2)return[];var t=new Array(e-1);t[e-2]=n[e-1];for(var r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function RI(n,e,t){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Ud(n)),t&&fF(n,e),(function(o,s){return o instanceof Float32Array&&s==="float32"||o instanceof Int32Array&&s==="int32"||o instanceof Uint8Array&&s==="bool"})(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){for(var r=new Uint8Array(n.length),i=0;i<r.length;++i)Math.round(n[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function tS(n,e){if(n.length===0)return e[0];var t=n.reduce((function(r,i){return r*i}));if(t===0)return[];if(t!==e.length)throw new Error("["+n+"] does not match the input size.");return(function r(i,o,s){var a=new Array;if(o.length===1)for(var u=o[0],l=0;l<u;l++)a[l]=s[i+l];else{u=o[0];var h=o.slice(1),d=h.reduce((function(m,p){return m*p}));for(l=0;l<u;l++)a[l]=r(i+l*d,h,s)}return a})(0,n,e)}function PI(n,e){for(var t=zm(n,e),r=0;r<t.length;r++)t[r]=1;return t}function zm(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error("Unknown data type "+e)}function Zu(){return Ye().platform.now()}function DI(n){n.forEach((function(e){me(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+n+"]."}))}))}function yF(n,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",Ye().platform.encode(n,e)}function Jv(n,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",Ye().platform.decode(n,e)}function nS(n,e,t){if(e===0)return 0;if(e===1)return n[0];for(var r=n[n.length-1],i=0;i<n.length-1;++i)r+=t[i]*n[i];return r}function wF(n,e,t){if(e===0)return[];if(e===1)return[n];for(var r=new Array(e),i=0;i<r.length-1;++i)r[i]=Math.floor(n/t[i]),n-=r[i]*t[i];return r[r.length-1]=n,r}var bF=(function(){function n(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new xF)}return n.prototype.profileKernel=function(e,t,r){var i,o=this,s=this.backendTimer.time((function(){i=r()}));return i.forEach((function(a){a.data().then((function(u){(function(l,h,d){if(h!=="float32")return!1;for(var m=0;m<l.length;m++){var p=l[m];if(isNaN(p)||!isFinite(p))return console.warn("Found "+p+" in the result of '"+d+"'"),!0}})(u,a.dtype,e),s.then((function(l){var h="";l.getExtraProfileInfo!=null&&(h=l.getExtraProfileInfo()),o.logger.logKernelProfile(e,a,u,l.kernelMs,t,h)}))}))})),i},n})(),xF=(function(){function n(){}return n.prototype.logKernelProfile=function(e,t,r,i,o,s){var a=typeof i=="number"?wd(i+"ms",9):i.error,u=wd(e,25),l=t.rank,h=t.size,d=wd(t.shape.toString(),14),m="";for(var p in o){var y=o[p].shape||t.shape,b=y.length;m+=p+": "+b+"D "+(b>0?y:"")+" "}console.log("%c"+u+"	%c"+a+"	%c"+l+"D "+d+"	%c"+h+"	%c"+m+"	%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},n})(),rS=20,Bp=3,Ty=7;function _F(n,e,t,r){var i=ll(e),o=(function(l,h,d,m){var p=Mt(h),y=m[m.length-1],b=new Array(y).fill(0),x=h.length,E=d==="complex64"?jp(l):l;if(x>1)for(var T=0;T<p/y;T++)for(var P=T*y,C=0;C<y;C++)b[C]=Math.max(b[C],Vp(E[P+C],0,d).length);return b})(n,e,t,i),s=e.length,a=(function l(h,d,m,p,y,b){b===void 0&&(b=!0);var x=m==="complex64"?2:1,E=d[0],T=d.length;if(T===0)return m==="complex64"?[Vp(jp(h)[0],0,m)]:m==="bool"?[LI(h[0])]:[h[0].toString()];if(T===1){if(E>rS){var P=Bp*x,C=Array.from(h.slice(0,P)),D=Array.from(h.slice((E-Bp)*x,E*x));return m==="complex64"&&(C=jp(C),D=jp(D)),["["+C.map((function(ue,ge){return Vp(ue,y[ge],m)})).join(", ")+", ..., "+D.map((function(ue,ge){return Vp(ue,y[E-Bp+ge],m)})).join(", ")+"]"]}return["["+(m==="complex64"?jp(h):Array.from(h)).map((function(ue,ge){return Vp(ue,y[ge],m)})).join(", ")+"]"]}var z=d.slice(1),L=p.slice(1),I=p[0]*x,A=[];if(E>rS){for(var O=0;O<Bp;O++){var k=(M=O*I)+I;A.push.apply(A,l(h.slice(M,k),z,m,L,y,!1))}for(A.push("..."),O=E-Bp;O<E;O++)k=(M=O*I)+I,A.push.apply(A,l(h.slice(M,k),z,m,L,y,O===E-1))}else for(O=0;O<E;O++){var M;k=(M=O*I)+I,A.push.apply(A,l(h.slice(M,k),z,m,L,y,O===E-1))}var j=T===2?",":"";for(A[0]="["+A[0]+j,O=1;O<A.length-1;O++)A[O]=" "+A[O]+j;var X=`,
`;for(O=2;O<T;O++)X+=`
`;return A[A.length-1]=" "+A[A.length-1]+"]"+(b?"":X),A})(n,e,t,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+t),u.push("  rank: "+s),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(a.map((function(l){return"    "+l})).join(`
`)),u.join(`
`)}function Vp(n,e,t){return wd(Array.isArray(n)?parseFloat(n[0].toFixed(Ty))+" + "+parseFloat(n[1].toFixed(Ty))+"j":Ub(n)?"'"+n+"'":t==="bool"?LI(n):parseFloat(n.toFixed(Ty)).toString(),e)}function LI(n){return n===0?"false":"true"}function jp(n){for(var e=[],t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}var bm=(function(){function n(e,t,r){var i=this;if(this.dtype=t,this.shape=e.slice(),this.size=Mt(e),r!=null){var o=r.length;me(o===this.size,(function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+i.size+"'."}))}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Qv(t,this.size),this.strides=ll(e)}return n.prototype.set=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),me(r.length===this.rank,(function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+t.rank+")"}));var o=this.locToIndex(r);this.values[o]=e},n.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length===0&&(e=[0]);for(var r=0,i=0,o=e;i<o.length;i++){var s=o[i];if(s<0||s>=this.shape[r]){var a="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(a)}r++}for(var u=e[e.length-1],l=0;l<e.length-1;++l)u+=this.strides[l]*e[l];return this.values[u]},n.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var t=e[e.length-1],r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t},n.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var t=new Array(this.shape.length),r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.toTensor=function(){return el().makeTensor(this.values,this.shape,this.dtype)},n})(),el=null,We=null,MI=null,$r=(function(){function n(e,t,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Mt(e),this.strides=ll(e),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return n.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},n.prototype.asScalar=function(){return this.throwIfDisposed(),me(this.size===1,(function(){return"The array must have only 1 element."})),this.reshape([])},n.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},n.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},n.prototype.as3D=function(e,t,r){return this.throwIfDisposed(),this.reshape([e,t,r])},n.prototype.as4D=function(e,t,r,i){return this.throwIfDisposed(),this.reshape([e,t,r,i])},n.prototype.as5D=function(e,t,r,i,o){return this.throwIfDisposed(),this.reshape([e,t,r,i,o])},n.prototype.asType=function(e){return this.throwIfDisposed(),We.cast(this,e)},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.buffer=function(){return Nt(this,void 0,void 0,(function(){var e;return Rt(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,We.buffer(this.shape,this.dtype,e)]}}))}))},n.prototype.bufferSync=function(){return We.buffer(this.shape,this.dtype,this.dataSync())},n.prototype.array=function(){return Nt(this,void 0,void 0,(function(){var e;return Rt(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,tS(this.shape,e)]}}))}))},n.prototype.arraySync=function(){return tS(this.shape,this.dataSync())},n.prototype.data=function(){return Nt(this,void 0,void 0,(function(){var e,t;return Rt(this,(function(r){switch(r.label){case 0:return this.throwIfDisposed(),e=el().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:t=r.sent();try{return[2,t.map((function(i){return Jv(i)}))]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,e]}}))}))},n.prototype.dataSync=function(){this.throwIfDisposed();var e=el().readSync(this.dataId);if(this.dtype==="string")try{return e.map((function(t){return Jv(t)}))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},n.prototype.bytes=function(){return Nt(this,void 0,void 0,(function(){var e;return Rt(this,(function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,el().read(this.dataId)];case 1:return e=t.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}}))}))},n.prototype.dispose=function(){this.isDisposed||(el().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(n.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),n.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},n.prototype.toFloat=function(){return this.asType("float32")},n.prototype.toInt=function(){return this.asType("int32")},n.prototype.toBool=function(){return this.asType("bool")},n.prototype.print=function(e){return e===void 0&&(e=!1),We.print(this,e)},n.prototype.reshape=function(e){return this.throwIfDisposed(),We.reshape(this,e)},n.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},n.prototype.expandDims=function(e){return e===void 0&&(e=0),We.expandDims(this,e)},n.prototype.cumsum=function(e,t,r){return e===void 0&&(e=0),t===void 0&&(t=!1),r===void 0&&(r=!1),We.cumsum(this,e,t,r)},n.prototype.squeeze=function(e){return this.throwIfDisposed(),We.squeeze(this,e)},n.prototype.clone=function(){return this.throwIfDisposed(),We.clone(this)},n.prototype.oneHot=function(e,t,r){return this.throwIfDisposed(),We.oneHot(this,e,t,r)},n.prototype.toString=function(e){return e===void 0&&(e=!1),_F(this.dataSync(),this.shape,this.dtype,e)},n.prototype.tile=function(e){return this.throwIfDisposed(),We.tile(this,e)},n.prototype.gather=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),We.gather(this,e,t)},n.prototype.matMul=function(e,t,r){return t===void 0&&(t=!1),r===void 0&&(r=!1),this.throwIfDisposed(),We.matMul(this,e,t,r)},n.prototype.dot=function(e){return this.throwIfDisposed(),We.dot(this,e)},n.prototype.norm=function(e,t,r){return e===void 0&&(e="euclidean"),t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),We.norm(this,e,t,r)},n.prototype.slice=function(e,t){return this.throwIfDisposed(),We.slice(this,e,t)},n.prototype.reverse=function(e){return this.throwIfDisposed(),We.reverse(this,e)},n.prototype.concat=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),e instanceof n&&(e=[e]),We.concat([this].concat(e),t)},n.prototype.split=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),We.split(this,e,t)},n.prototype.stack=function(e,t){return t===void 0&&(t=0),We.stack([this,e],t)},n.prototype.unstack=function(e){return e===void 0&&(e=0),We.unstack(this,e)},n.prototype.pad=function(e,t){return t===void 0&&(t=0),We.pad(this,e,t)},n.prototype.batchNormalization=function(e,t,r,i,o){return r===void 0&&(r=.001),MI("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,o,i,r)},n.prototype.batchNorm=function(e,t,r,i,o){return o===void 0&&(o=.001),this.throwIfDisposed(),We.batchNorm(this,e,t,r,i,o)},n.prototype.all=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.all(this,e,t)},n.prototype.any=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.any(this,e,t)},n.prototype.logSumExp=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.logSumExp(this,e,t)},n.prototype.sum=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.sum(this,e,t)},n.prototype.prod=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.prod(this,e,t)},n.prototype.mean=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.mean(this,e,t)},n.prototype.min=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.min(this,e,t)},n.prototype.max=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),We.max(this,e,t)},n.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),We.argMin(this,e)},n.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),We.argMax(this,e)},n.prototype.cast=function(e){return this.throwIfDisposed(),We.cast(this,e)},n.prototype.add=function(e){return this.throwIfDisposed(),We.add(this,e)},n.prototype.addStrict=function(e){return this.throwIfDisposed(),We.addStrict(this,e)},n.prototype.atan2=function(e){return this.throwIfDisposed(),We.atan2(this,e)},n.prototype.sub=function(e){return this.throwIfDisposed(),We.sub(this,e)},n.prototype.subStrict=function(e){return this.throwIfDisposed(),We.subStrict(this,e)},n.prototype.pow=function(e){return this.throwIfDisposed(),We.pow(this,e)},n.prototype.powStrict=function(e){return this.throwIfDisposed(),We.powStrict(this,e)},n.prototype.mul=function(e){return this.throwIfDisposed(),We.mul(this,e)},n.prototype.mulStrict=function(e){return this.throwIfDisposed(),We.mulStrict(this,e)},n.prototype.div=function(e){return this.throwIfDisposed(),We.div(this,e)},n.prototype.divNoNan=function(e){return this.throwIfDisposed(),We.divNoNan(this,e)},n.prototype.floorDiv=function(e){return this.throwIfDisposed(),We.floorDiv(this,e)},n.prototype.divStrict=function(e){return this.throwIfDisposed(),We.divStrict(this,e)},n.prototype.minimum=function(e){return this.throwIfDisposed(),We.minimum(this,e)},n.prototype.minimumStrict=function(e){return this.throwIfDisposed(),We.minimumStrict(this,e)},n.prototype.maximum=function(e){return this.throwIfDisposed(),We.maximum(this,e)},n.prototype.maximumStrict=function(e){return this.throwIfDisposed(),We.maximumStrict(this,e)},n.prototype.mod=function(e){return this.throwIfDisposed(),We.mod(this,e)},n.prototype.modStrict=function(e){return this.throwIfDisposed(),We.modStrict(this,e)},n.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),We.squaredDifferenceStrict(this,e)},n.prototype.transpose=function(e){return this.throwIfDisposed(),We.transpose(this,e)},n.prototype.notEqual=function(e){return this.throwIfDisposed(),We.notEqual(this,e)},n.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),We.notEqualStrict(this,e)},n.prototype.less=function(e){return this.throwIfDisposed(),We.less(this,e)},n.prototype.lessStrict=function(e){return this.throwIfDisposed(),We.lessStrict(this,e)},n.prototype.equal=function(e){return this.throwIfDisposed(),We.equal(this,e)},n.prototype.equalStrict=function(e){return this.throwIfDisposed(),We.equalStrict(this,e)},n.prototype.lessEqual=function(e){return this.throwIfDisposed(),We.lessEqual(this,e)},n.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),We.lessEqualStrict(this,e)},n.prototype.greater=function(e){return this.throwIfDisposed(),We.greater(this,e)},n.prototype.greaterStrict=function(e){return this.throwIfDisposed(),We.greaterStrict(this,e)},n.prototype.greaterEqual=function(e){return this.throwIfDisposed(),We.greaterEqual(this,e)},n.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),We.greaterEqualStrict(this,e)},n.prototype.logicalAnd=function(e){return this.throwIfDisposed(),We.logicalAnd(this,e)},n.prototype.logicalOr=function(e){return this.throwIfDisposed(),We.logicalOr(this,e)},n.prototype.logicalNot=function(){return this.throwIfDisposed(),We.logicalNot(this)},n.prototype.logicalXor=function(e){return this.throwIfDisposed(),We.logicalXor(this,e)},n.prototype.where=function(e,t){return this.throwIfDisposed(),We.where(e,this,t)},n.prototype.neg=function(){return this.throwIfDisposed(),We.neg(this)},n.prototype.ceil=function(){return this.throwIfDisposed(),We.ceil(this)},n.prototype.floor=function(){return this.throwIfDisposed(),We.floor(this)},n.prototype.sign=function(){return this.throwIfDisposed(),We.sign(this)},n.prototype.isNaN=function(){return this.throwIfDisposed(),We.isNaN(this)},n.prototype.isInf=function(){return this.throwIfDisposed(),We.isInf(this)},n.prototype.isFinite=function(){return this.throwIfDisposed(),We.isFinite(this)},n.prototype.exp=function(){return this.throwIfDisposed(),We.exp(this)},n.prototype.expm1=function(){return this.throwIfDisposed(),We.expm1(this)},n.prototype.log=function(){return this.throwIfDisposed(),We.log(this)},n.prototype.log1p=function(){return this.throwIfDisposed(),We.log1p(this)},n.prototype.sqrt=function(){return this.throwIfDisposed(),We.sqrt(this)},n.prototype.rsqrt=function(){return this.throwIfDisposed(),We.rsqrt(this)},n.prototype.square=function(){return this.throwIfDisposed(),We.square(this)},n.prototype.reciprocal=function(){return this.throwIfDisposed(),We.reciprocal(this)},n.prototype.abs=function(){return this.throwIfDisposed(),We.abs(this)},n.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),We.clipByValue(this,e,t)},n.prototype.relu=function(){return this.throwIfDisposed(),We.relu(this)},n.prototype.relu6=function(){return this.throwIfDisposed(),We.relu6(this)},n.prototype.elu=function(){return this.throwIfDisposed(),We.elu(this)},n.prototype.selu=function(){return this.throwIfDisposed(),We.selu(this)},n.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),We.leakyRelu(this,e)},n.prototype.prelu=function(e){return this.throwIfDisposed(),We.prelu(this,e)},n.prototype.sigmoid=function(){return this.throwIfDisposed(),We.sigmoid(this)},n.prototype.logSigmoid=function(){return this.throwIfDisposed(),We.logSigmoid(this)},n.prototype.softplus=function(){return this.throwIfDisposed(),We.softplus(this)},n.prototype.zerosLike=function(){return this.throwIfDisposed(),We.zerosLike(this)},n.prototype.onesLike=function(){return this.throwIfDisposed(),We.onesLike(this)},n.prototype.sin=function(){return this.throwIfDisposed(),We.sin(this)},n.prototype.cos=function(){return this.throwIfDisposed(),We.cos(this)},n.prototype.tan=function(){return this.throwIfDisposed(),We.tan(this)},n.prototype.asin=function(){return this.throwIfDisposed(),We.asin(this)},n.prototype.acos=function(){return this.throwIfDisposed(),We.acos(this)},n.prototype.atan=function(){return this.throwIfDisposed(),We.atan(this)},n.prototype.sinh=function(){return this.throwIfDisposed(),We.sinh(this)},n.prototype.cosh=function(){return this.throwIfDisposed(),We.cosh(this)},n.prototype.tanh=function(){return this.throwIfDisposed(),We.tanh(this)},n.prototype.asinh=function(){return this.throwIfDisposed(),We.asinh(this)},n.prototype.acosh=function(){return this.throwIfDisposed(),We.acosh(this)},n.prototype.atanh=function(){return this.throwIfDisposed(),We.atanh(this)},n.prototype.erf=function(){return this.throwIfDisposed(),We.erf(this)},n.prototype.round=function(){return this.throwIfDisposed(),We.round(this)},n.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),We.step(this,e)},n.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),We.softmax(this,e)},n.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),We.logSoftmax(this,e)},n.prototype.resizeBilinear=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),We.image.resizeBilinear(this,e,t)},n.prototype.resizeNearestNeighbor=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),We.image.resizeNearestNeighbor(this,e,t)},n.prototype.conv1d=function(e,t,r,i,o,s){return i===void 0&&(i="NWC"),o===void 0&&(o=1),this.throwIfDisposed(),We.conv1d(this,e,t,r,i,o,s)},n.prototype.conv2d=function(e,t,r,i,o,s){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),We.conv2d(this,e,t,r,i,o,s)},n.prototype.conv2dTranspose=function(e,t,r,i,o){return this.throwIfDisposed(),We.conv2dTranspose(this,e,t,r,i,o)},n.prototype.depthwiseConv2D=function(e,t,r,i,o,s){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),We.depthwiseConv2d(this,e,t,r,i,o,s)},n.prototype.separableConv2d=function(e,t,r,i,o,s){return o===void 0&&(o=[1,1]),s===void 0&&(s="NHWC"),this.throwIfDisposed(),We.separableConv2d(this,e,t,r,i,o,s)},n.prototype.avgPool=function(e,t,r,i){return this.throwIfDisposed(),We.avgPool(this,e,t,r,i)},n.prototype.maxPool=function(e,t,r,i){return this.throwIfDisposed(),We.maxPool(this,e,t,r,i)},n.prototype.localResponseNormalization=function(e,t,r,i){return e===void 0&&(e=5),t===void 0&&(t=1),r===void 0&&(r=1),i===void 0&&(i=.5),We.localResponseNormalization(this,e,t,r,i)},n.prototype.pool=function(e,t,r,i,o){return this.throwIfDisposed(),We.pool(this,e,t,r,i,o)},n.prototype.variable=function(e,t,r){return e===void 0&&(e=!0),this.throwIfDisposed(),el().makeVariable(this,e,t,r)},n.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),We.unsortedSegmentSum(this,e,t)},n.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),We.batchToSpaceND(this,e,t)},n.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),We.spaceToBatchND(this,e,t)},n.prototype.topk=function(e,t){return e===void 0&&(e=1),t===void 0&&(t=!0),this.throwIfDisposed(),We.topk(this,e,t)},n.prototype.stridedSlice=function(e,t,r,i,o,s,a,u){return i===void 0&&(i=0),o===void 0&&(o=0),s===void 0&&(s=0),a===void 0&&(a=0),u===void 0&&(u=0),this.throwIfDisposed(),We.stridedSlice(this,e,t,r,i,o,s,a,u)},n.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),We.depthToSpace(this,e,t)},n.prototype.fft=function(){return this.throwIfDisposed(),We.spectral.fft(this)},n.prototype.ifft=function(){return this.throwIfDisposed(),We.spectral.ifft(this)},n.prototype.rfft=function(){return this.throwIfDisposed(),We.spectral.rfft(this)},n.prototype.irfft=function(){return this.throwIfDisposed(),We.spectral.irfft(this)},n})();Object.defineProperty($r,Symbol.hasInstance,{value:function(n){return!!n&&n.dataId!=null&&n.shape!=null&&n.dtype!=null}});var iS,iw,ow,sw,aw,zd=(function(n){function e(t,r,i,o){var s=n.call(this,t.shape,t.dtype,t.dataId,o)||this;return s.trainable=r,s.name=i,s}return Su(e,n),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!po(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");el().disposeTensor(this),this.dataId=t.dataId,el().incRef(this,null)},e.prototype.dispose=function(){el().disposeVariable(this),this.isDisposedInternal=!0},e})($r);Object.defineProperty(zd,Symbol.hasInstance,{value:function(n){return n instanceof $r&&n.assign!=null&&n.assign instanceof Function}}),(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(iS||(iS={})),(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(iw||(iw={})),(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(ow||(ow={})),(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(sw||(sw={})),(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(aw||(aw={}));var EF={float32:sw,int32:iw,bool:ow,complex64:aw};function No(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error("Can not upcast "+n+" with "+e)}return EF[n][e]}function ky(n){return No(n,"int32")}function Jr(n,e){if(n.dtype===e.dtype)return[n,e];var t=No(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function SF(n,e){me(n.dtype===e.dtype,(function(){return"The dtypes of the first("+n.dtype+") and second("+e.dtype+") input must match"}))}function OI(n){var e=[];return(function t(r,i,o){if(r!=null){if(r instanceof $r)return void i.push(r);if(s=r,!(!Array.isArray(s)&&typeof s!="object")){var s,a=r;for(var u in a){var l=a[u];o.has(l)||(o.add(l),t(l,i,o))}}}})(n,e,new Set),e}var Ny,oS=(function(){function n(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return n.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},n})(),AF=(function(){function n(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new oS}return n.prototype.ready=function(){return Nt(this,void 0,void 0,(function(){var e,t,r;return Rt(this,(function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then((function(){}))];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),t=0,i.label=1;case 1:return t<e.length?(r=e[t],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(n.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),n.prototype.backendNames=function(){return Object.keys(this.registryFactory)},n.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},n.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},n.prototype.registerBackend=function(e,t,r){return r===void 0&&(r=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:r},!0)},n.prototype.setBackend=function(e){return Nt(this,void 0,void 0,(function(){var t,r,i;return Rt(this,(function(o){switch(o.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),r=t.success,t.asyncInit?[4,r]:[3,2]);case 1:return i=o.sent(),[3,3];case 2:i=r,o.label=3;case 3:if(!i)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new bF(this.backendInstance),[2,!0]}}))}))},n.prototype.setupRegisteredKernels=function(){var e=this;ZE(this.backendName).forEach((function(t){t.setupFunc!=null&&t.setupFunc(e.backendInstance)}))},n.prototype.disposeRegisteredKernels=function(e){var t=this;ZE(e).forEach((function(r){r.disposeFunc!=null&&r.disposeFunc(t.registry[e])}))},n.prototype.initializeBackend=function(e){var t=this,r=this.registryFactory[e];if(r==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var o=++this.pendingBackendInitId,s=i.then((function(a){return!(o<t.pendingBackendInitId)&&(t.registry[e]=a,t.pendingBackendInit=null,!0)})).catch((function(a){return!(o<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(a.stack||a.message),!1)}));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[e]=i,{success:!0,asyncInit:!1}}catch(a){return console.warn("Initialization of backend "+e+" failed"),console.warn(a.stack||a.message),{success:!1,asyncInit:!1}}},n.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},n.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,r){return e.registryFactory[r].priority-e.registryFactory[t].priority}))},n.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var r=e[t],i=this.initializeBackend(r),o=i.success,s=i.asyncInit;if(s||o)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},n.prototype.moveData=function(e,t){var r=this.state.tensorInfo.get(t),i=r.backend,o=this.readSync(t);i.disposeData(t),r.backend=e,e.move(t,o,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},n.prototype.tidy=function(e,t){var r,i=this,o=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}return this.scopedRun((function(){return i.startScope(o)}),(function(){return i.endScope(r)}),(function(){return(r=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r}))},n.prototype.scopedRun=function(e,t,r){e();try{var i=r();return t(),i}catch(o){throw t(),o}},n.prototype.nextTensorId=function(){return n.nextTensorId++},n.prototype.nextVariableId=function(){return n.nextVariableId++},n.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),r={x:e};return this.addTapeNode(this.state.activeScope.name,r,[t],(function(i){return{x:function(){return i.toFloat()}}}),[]),t},n.prototype.runKernel=function(e,t,r,i,o){return this.runKernelFunc(null,t,null,e,r,i,o)},n.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},n.prototype.checkKernelForMemLeak=function(e,t,r){var i=this.backend.numDataIds(),o=0;r.forEach((function(u){o+=u.dtype==="complex64"?3:1}));var s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=i-t-o-s;if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+e+"'")},n.prototype.runKernelFunc=function(e,t,r,i,o,s,a){var u,l=this;s===void 0&&(s=[]),a===void 0&&(a=[]);var h=[],d=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");var m,p=function(T){d&&(h=T.map((function(P){return l.keep(l.clone(P))})))},y=this.state.numBytes,b=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var x,E=CI(i,this.backendName);return m=E!=null?function(){var T=l.backend.numDataIds();x=E.kernelFunc({inputs:t,attrs:o,backend:l.backend});var P=Array.isArray(x)?x:[x];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,T,P);var C=P.map((function(z){var L=z.dataId,I=z.shape,A=z.dtype;return l.makeTensorFromDataId(L,I,A)})),D=C.filter((function(z,L){return a[L]}));return p((s||[]).slice().concat(D)),C}:function(){var T=l.backend.numDataIds();x=l.tidy((function(){return e(l.backend,p)}));var P=Array.isArray(x)?x:[x];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,T,P),P},this.scopedRun((function(){return l.state.kernelDepth++}),(function(){return l.state.kernelDepth--}),(function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(i,t,(function(){return m()})):m()})),d&&this.addTapeNode(i,t,u,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-y,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-b,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(T){return t[T].shape})),outputShapes:u.map((function(T){return T.shape}))}),Array.isArray(x)?u:u[0]},n.prototype.makeTensor=function(e,t,r,i){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var o=e;r==="string"&&Ub(e[0])&&(o=e.map((function(h){return yF(h)})));var s=i.write(o,t,r),a=new $r(t,r,s,this.nextTensorId());if(this.incRef(a,i),r==="string"){var u=this.state.tensorInfo.get(s),l=mF(o);this.state.numBytes+=l-u.bytes,u.bytes=l}return a},n.prototype.makeTensorFromDataId=function(e,t,r,i){var o=new $r(t,r=r||"float32",e,this.nextTensorId());return this.incRef(o,i),o},n.prototype.makeVariable=function(e,t,r,i){t===void 0&&(t=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==e.dtype&&(e=e.asType(i));var o=new zd(e,t,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},n.prototype.incRef=function(e,t){var r=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(i=e.size*NI(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof zd||this.track(e)},n.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},n.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},n.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},n.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},n.prototype.profile=function(e){return Nt(this,void 0,void 0,(function(){var t,r;return Rt(this,(function(i){return this.state.profiling=!0,t=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(o){return o.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]}))}))},n.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},n.prototype.addTapeNode=function(e,t,r,i,o){var s=this,a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:o},u=aF(e);u!=null&&(i=u.gradFunc),i!=null&&(a.gradient=function(l){return l=l.map((function(h,d){if(h==null){var m=r[d],p=zm(m.size,m.dtype);return s.makeTensor(p,m.shape,m.dtype)}return h})),i(l.length>1?l:l[0],o)}),this.state.activeTape.push(a)},n.prototype.keep=function(e){return e.kept=!0,e},n.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},n.prototype.endTape=function(){this.state.gradientDepth--},n.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},n.prototype.endScope=function(e){for(var t=this,r=OI(e),i=new Set(r.map((function(u){return u.id}))),o=0;o<this.state.activeScope.track.length;o++){var s=this.state.activeScope.track[o];s.kept||i.has(s.id)||s.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach((function(u){u.kept||u.scopeId!==a.id||t.track(u)}))},n.prototype.gradients=function(e,t,r,i){var o=this;if(i===void 0&&(i=!1),me(t.length>0,(function(){return"gradients() received an empty list of xs."})),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var s=this.scopedRun((function(){return o.startTape()}),(function(){return o.endTape()}),(function(){return o.tidy("forward",e)}));me(s instanceof $r,(function(){return"The result y returned by f() must be a tensor."}));var a=(function(u,l,h){for(var d={},m={},p=0;p<l.length;p++)d[l[p].id]=!0;for(p=0;p<u.length;p++){var y=(z=u[p]).inputs;for(var b in y){for(var x=y[b],E=!1,T=0;T<l.length;T++)if(d[x.id]){z.outputs.forEach((function(O){return d[O.id]=!0})),E=!0,m[z.id]=!0;break}if(E)break}}var P={};P[h.id]=!0;var C={};for(p=u.length-1;p>=0;p--)for(y=(z=u[p]).inputs,T=0;T<z.outputs.length;T++)if(P[z.outputs[T].id]){for(var b in y)P[y[b].id]=!0,C[z.id]=!0;break}var D=[];for(p=0;p<u.length;p++){var z;if(m[(z=u[p]).id]&&C[z.id]){var L={};for(var b in z.inputs){var I=z.inputs[b];d[I.id]&&(L[b]=I)}var A=Object.assign({},z);A.inputs=L,A.outputs=z.outputs,D.push(A)}}return D})(this.state.activeTape,t,s);if(!i&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var u,l,h={};h[s.id]=r??(u=s.shape,l=PI(Mt(u),"float32"),Te.makeTensor(l,u,"float32")),(function(m,p,y){for(var b=function(E){var T=p[E],P=[];if(T.outputs.forEach((function(L){var I=m[L.id];I!=null?P.push(I):P.push(null)})),T.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+T.kernelName+".");var C=T.gradient(P),D=function(L){if(!(L in C))throw new Error("Cannot backprop through input "+L+". Available gradients found: "+Object.keys(C)+".");var I=y((function(){return C[L]()}));if(I.dtype!=="float32")throw new Error("Error in gradient for op "+T.kernelName+". The gradient of input "+L+" must have 'float32' dtype, but has '"+I.dtype+"'");var A=T.inputs[L];if(!po(I.shape,A.shape))throw new Error("Error in gradient for op "+T.kernelName+". The gradient of input '"+L+"' has shape '"+I.shape+"', which does not match the shape of the input '"+A.shape+"'");if(m[A.id]==null)m[A.id]=I;else{var O=m[A.id];m[A.id]=O.add(I),O.dispose()}};for(var z in T.inputs)D(z)},x=p.length-1;x>=0;x--)b(x)})(h,a,(function(m){return o.tidy(m)}));var d=t.map((function(m){return h[m.id]}));return o.state.gradientDepth===0&&(o.state.activeTape.forEach((function(m){for(var p=0,y=m.saved;p<y.length;p++)y[p].dispose()})),o.state.activeTape=null),{value:s,grads:d}}))},n.prototype.customGrad=function(e){var t=this;return me(nw(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var r,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];me(i.every((function(a){return a instanceof $r})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var s={};return i.forEach((function(a,u){s[u]=a})),t.runKernelFunc((function(a,u){return me((r=e.apply(void 0,i.concat([u]))).value instanceof $r,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),me(nw(r.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),r.value}),s,(function(a,u){var l=r.gradFunc(a,u),h=Array.isArray(l)?l:[l];me(h.length===i.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),me(h.every((function(m){return m instanceof $r})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var d={};return h.forEach((function(m,p){d[p]=function(){return m}})),d}))}},n.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},n.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},n.prototype.time=function(e){return Nt(this,void 0,void 0,(function(){var t,r;return Rt(this,(function(i){switch(i.label){case 0:return t=Zu(),[4,this.backend.time(e)];case 1:return(r=i.sent()).wallMs=Zu()-t,[2,r]}}))}))},n.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(n.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),n.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new oS,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},n.nextTensorId=0,n.nextVariableId=0,n})(),Te=(function(){var n=(function(){if(Ny==null){var t=void 0;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else{if(typeof self>"u")throw new Error("Could not find a global object");t=self}Ny=t}return Ny})();if(n._tfengine==null){var e=new oF(n);n._tfengine=new AF(e)}return(function(t){AI=t})(n._tfengine.ENV),el=function(){return n._tfengine},n._tfengine})();function FI(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Wl=Ye();Wl.registerFlag("DEBUG",(function(){return!1}),(function(n){n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Wl.registerFlag("IS_BROWSER",(function(){return FI()})),Wl.registerFlag("IS_NODE",(function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0})),Wl.registerFlag("IS_CHROME",(function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Wl.registerFlag("PROD",(function(){return!1})),Wl.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Wl.getBool("DEBUG")})),Wl.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Wl.registerFlag("IS_TEST",(function(){return!1}));var xm,da,fa,Gh={},Ry={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function CF(n,e){Gh[n]=e}function vl(n){n in Gh||(Gh[n]=(function(t){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=(function(i){if(typeof OffscreenCanvas<"u"&&i===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")})(t);return r.addEventListener("webglcontextlost",(function(i){i.preventDefault(),delete Gh[t]}),!1),t===1?r.getContext("webgl",Ry)||r.getContext("experimental-webgl",Ry):r.getContext("webgl2",Ry)})(n));var e=Gh[n];return e.isContextLost()?(delete Gh[n],vl(n)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Gh[n])}function W0(n,e){return[e,n]}function rm(n){var e=Mt(n);return tw(Math.ceil(e/4))}function Wm(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function zb(n,e){var t,r,i,o,s,a,u,l,h,d=n;return Ye().getNumber("WEBGL_VERSION")===2?(t=d.R32F,r=d.R16F,i=d.RGBA16F,o=d.RGBA32F,s=d.RED,a=4,u=1,l=d.HALF_FLOAT,h=d.FLOAT):(t=n.RGBA,r=n.RGBA,i=n.RGBA,o=d.RGBA,s=n.RGBA,a=4,u=4,l=e!=null?e.HALF_FLOAT_OES:null,h=n.FLOAT),{internalFormatFloat:t,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:n.RGBA,downloadUnpackNumChannels:a,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:h}}function Vt(n,e,t){var r=t();return e&&(function(i){var o=i.getError();if(o!==i.NO_ERROR)throw new Error("WebGL Error: "+NF(i,o))})(n),r}(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(xm||(xm={})),(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(da||(da={})),(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(fa||(fa={}));var IF=596e-10,TF=65504;function kF(n){return!!(Ye().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||IF<Math.abs(n)&&Math.abs(n)<TF)}function NF(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function Kg(n,e,t){return rc(n,e,(function(){return n.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function RF(n,e,t){var r=rc(n,e,(function(){return n.createShader(n.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Vt(n,e,(function(){return n.shaderSource(r,t)})),Vt(n,e,(function(){return n.compileShader(r)})),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function PF(n,e,t){var r=rc(n,e,(function(){return n.createShader(n.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Vt(n,e,(function(){return n.shaderSource(r,t)})),Vt(n,e,(function(){return n.compileShader(r)})),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw(function(i,o){var s=DF.exec(o);if(s==null)return console.log("Couldn't parse line number in error: "+o),void console.log(i);for(var a=+s[1],u=i.split(`
`),l=u.length.toString().length+2,h=u.map((function(x,E){return wd((E+1).toString(),l)+x})),d=0,m=0;m<h.length;m++)d=Math.max(h[m].length,d);var p=h.slice(0,a-1),y=h.slice(a-1,a),b=h.slice(a);console.log(p.join(`
`)),console.log(o.split(`
`)[0]),console.log("%c "+wd(y[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(b.join(`
`))})(t,n.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Py,Dy,DF=/ERROR: [0-9]+:([0-9]+):/g;function LF(n,e){return rc(n,e,(function(){return n.createProgram()}),"Unable to create WebGLProgram.")}function MF(n,e,t){if(Vt(n,e,(function(){return n.linkProgram(t)})),n.getProgramParameter(t,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function Ly(n,e,t){if(Vt(n,e,(function(){return n.validateProgram(t)})),n.getProgramParameter(t,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function OF(n,e,t){var r=rc(n,e,(function(){return n.createBuffer()}),"Unable to create WebGLBuffer");return Vt(n,e,(function(){return n.bindBuffer(n.ARRAY_BUFFER,r)})),Vt(n,e,(function(){return n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)})),r}function FF(n,e,t){var r=rc(n,e,(function(){return n.createBuffer()}),"Unable to create WebGLBuffer");return Vt(n,e,(function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r)})),Vt(n,e,(function(){return n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)})),r}function BF(n,e){return rc(n,e,(function(){return n.createTexture()}),"Unable to create WebGLTexture.")}function VF(n,e){var t=Ye().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){var r="["+n+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t)throw r="["+n+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+t+"x"+t+"]")+".")}function jF(n,e){return rc(n,e,(function(){return n.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function sS(n,e,t,r,i,o,s,a){var u=n.getAttribLocation(t,r);return u!==-1&&(Vt(n,e,(function(){return n.bindBuffer(n.ARRAY_BUFFER,i)})),Vt(n,e,(function(){return n.vertexAttribPointer(u,o,n.FLOAT,!1,s,a)})),Vt(n,e,(function(){return n.enableVertexAttribArray(u)})),!0)}function UF(n,e,t,r){GF(n,r),Vt(n,e,(function(){return n.activeTexture(n.TEXTURE0+r)})),Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,t)}))}function zF(n,e,t,r){return rc(n,e,(function(){return n.getUniformLocation(t,r)}),'uniform "'+r+'" not present in program.')}function WF(n,e,t){return n.getUniformLocation(e,t)}function qF(n,e,t,r,i,o){Vt(n,e,(function(){return UF(n,e,r,o)})),Vt(n,e,(function(){return n.uniform1i(i,o)}))}function My(n,e,t,r){Vt(n,e,(function(){return n.bindFramebuffer(n.FRAMEBUFFER,r)})),Vt(n,e,(function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0)}))}function aS(n,e,t){Vt(n,e,(function(){return n.bindFramebuffer(n.FRAMEBUFFER,t)})),Vt(n,e,(function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0)}))}function Xg(n){var e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+HF(n,e))}function HF(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function rc(n,e,t,r){var i=Vt(n,e,(function(){return t()}));if(i==null)throw new Error(r);return i}function GF(n,e){var t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+t+"]")+".")}function Zv(n,e){return e===void 0&&(e=2),Mt(n.slice(0,n.length-e))}function e0(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Oy(n){var e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Zv(n)].concat(e0(n))),e}function $F(n,e){var t;e===void 0&&(e=!1);var r=Ye().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,(n=n.map((function(l,h){return h>=n.length-2?kI(n[h]):n[h]}))).length===1&&(n=[2,n[0]])),n.length!==2){var i=Yh(n);n=i.newShape}var o=Mt(n);if(n.length<=1&&o<=r)return[1,o];if(n.length===2&&n[0]<=r&&n[1]<=r)return n;if(n.length===3&&n[0]*n[1]<=r&&n[2]<=r)return[n[0]*n[1],n[2]];if(n.length===3&&n[0]<=r&&n[1]*n[2]<=r)return[n[0],n[1]*n[2]];if(n.length===4&&n[0]*n[1]*n[2]<=r&&n[3]<=r)return[n[0]*n[1]*n[2],n[3]];if(n.length===4&&n[0]<=r&&n[1]*n[2]*n[3]<=r)return[n[0],n[1]*n[2]*n[3]];if(e){var s=Zv(n),a=2,u=2;return n.length&&(a=(t=e0(n))[0],u=t[1]),tw(o=s*(a/2)*(u/2)).map((function(l){return 2*l}))}return tw(o)}function Yg(n){return n%2==0}function Qg(n,e){if(po(n=n.slice(-2),e=e.slice(-2))||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){var t=n.slice(-1)[0],r=e.slice(-1)[0];if(t===r||Yg(t)&&Yg(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&Yg(n[0])&&Yg(e[0])}function KF(n){if(Py==null){var e=vl(n);Py=e.getParameter(e.MAX_TEXTURE_SIZE)}return Py}function XF(n){if(Dy==null){var e=vl(n);Dy=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Dy)}function YF(n){if(n===0)return 0;var e=vl(n);return Ha(e,"EXT_disjoint_timer_query_webgl2")&&n===2?2:Ha(e,"EXT_disjoint_timer_query")?1:0}function Ha(n,e){return n.getExtension(e)!=null}function uS(n){try{if(vl(n)!=null)return!0}catch{return!1}return!1}function QF(n){if(n===0)return!1;var e=vl(n);if(n===1){if(!Ha(e,"OES_texture_float"))return!1}else if(!Ha(e,"EXT_color_buffer_float"))return!1;return uw(e)}function JF(n){if(n===0)return!1;var e=vl(n);if(n!==1){if(Ha(e,"EXT_color_buffer_float"))return uw(e);if(Ha(e,"EXT_color_buffer_half_float")){var t=e.getExtension("EXT_color_buffer_half_float");return(function(r,i){var o=zb(r,i),s=r.createTexture();r.bindTexture(r.TEXTURE_2D,s),r.texImage2D(r.TEXTURE_2D,0,o.internalFormatHalfFloat,1,1,0,o.textureFormatFloat,o.textureTypeHalfFloat,null);var a=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,a),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,s,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(s),r.deleteFramebuffer(a),u})(e,t)}return!1}return!!Ha(e,"OES_texture_float")&&!!Ha(e,"WEBGL_color_buffer_float")&&uw(e)}function uw(n){var e=zb(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);var i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(r),i}function ZF(n){return n===2&&vl(n).fenceSync!=null}var dn=Ye();function BI(n){Ye().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function _t(n,e){return Te.tidy(n,e)}function qs(n){OI(n).forEach((function(e){return e.dispose()}))}function e8(n){return Te.keep(n)}function t0(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];Ye().getBool("IS_TEST")||console.warn.apply(console,n)}function yh(n,e){var t=n;if(ul(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];for(var r=[];Array.isArray(t)||ul(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&Ye().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&(function i(o,s,a){if(a=a||[],!Array.isArray(o)&&!ul(o))return void me(s.length===0,(function(){return"Element arr["+a.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"}));me(s.length>0,(function(){return"Element arr["+a.join("][")+"] should be a primitive, but is an array of "+o.length+" elements"})),me(o.length===s[0],(function(){return"Element arr["+a.join("][")+"] should have "+s[0]+" elements, but has "+o.length+" elements"}));for(var u=s.slice(1),l=0;l<o.length;++l)i(o[l],u,a.concat(l))})(n,r,[]),r}function lS(n,e,t,r){if(n!=null&&(n!=="numeric"&&n!==e||n==="numeric"&&e==="string"))throw new Error("Argument '"+t+"' passed to '"+r+"' must be "+n+" tensor, but got "+e+" tensor")}function se(n,e,t,r){if(r===void 0&&(r="numeric"),n instanceof $r)return lS(r,n.dtype,e,t),n;var i=Um(n);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),lS(r,i,e,t),n==null||!ul(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){var o=n==null?"null":n.constructor.name;throw new Error("Argument '"+e+"' passed to '"+t+"' must be a Tensor or TensorLike, but got '"+o+"'")}var s=yh(n,i);ul(n)||Array.isArray(n)||(n=[n]);var a=i!=="string"?RI(n,i,Ye().getBool("DEBUG")):Ud(n,[],!0);return Te.makeTensor(a,s,i)}function n0(n,e,t,r){if(r===void 0&&(r="numeric"),!Array.isArray(n))throw new Error("Argument "+e+" passed to "+t+" must be a `Tensor[]` or `TensorLike[]`");return n.map((function(i,o){return se(i,e+"["+o+"]",t)}),r)}function VI(n,e){for(var t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function t8(n,e,t){for(var r=n.length+e.length,i=[],o=0,s=0,a=0;a<r;a++)t.indexOf(a)===-1?i.push(n[o++]):i.push(e[s++]);return i}function ts(n,e){for(var t=[],r=n.length,i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);return[t,e.map((function(o){return n[o]}))]}function Hs(n,e){return t8(n,e.map((function(t){return 1})),e)}function ha(n,e,t){me(VI(e,t),(function(){return n+" supports only inner-most axes for now. Got axes "+e+" and rank-"+t+" input."}))}function yl(n,e){if(VI(n,e))return null;for(var t=[],r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach((function(i){return t.push(i)})),t}function Wb(n){return n.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function wl(n,e){for(var t=[],r=e-n;r<e;++r)t.push(r);return t}function n8(n,e){var t=n[0].length;n.forEach((function(i,o){me(i.length===t,(function(){return"Error in concat"+t+"D: rank of tensors["+o+"] must be the same as the rank of the rest ("+t+")"}))})),me(e>=0&&e<t,(function(){return"Error in concat"+t+"D: axis must be between 0 and "+(t-1)+"."}));var r=n[0];n.forEach((function(i,o){for(var s=0;s<t;s++)me(s===e||i[s]===r[s],(function(){return"Error in concat"+t+"D: Shape of tensors["+o+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."}))}))}function Wd(n,e){for(var t=n[0].slice(),r=1;r<n.length;r++)t[e]+=n[r][e];return t}function xe(n){var e=Object.keys(n);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var t=e[0],r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1));var i=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];Te.startScope(t);try{var a=r.apply(void 0,o);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Te.endScope(a),a}catch(u){throw Te.endScope(null),u}};return Object.defineProperty(i,"name",{value:t,configurable:!0}),i}dn.registerFlag("HAS_WEBGL",(function(){return dn.getNumber("WEBGL_VERSION")>0})),dn.registerFlag("WEBGL_VERSION",(function(){return uS(2)?2:uS(1)?1:0})),dn.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return dn.get("WEBGL_VERSION")===2})),dn.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),dn.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),dn.registerFlag("WEBGL_PACK",(function(){return dn.getBool("HAS_WEBGL")})),dn.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_CLIP",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),dn.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_PACK_REDUCE",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_CONV_IM2COL",(function(){return dn.getBool("WEBGL_PACK")})),dn.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return KF(dn.getNumber("WEBGL_VERSION"))})),dn.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return XF(dn.getNumber("WEBGL_VERSION"))})),dn.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var n=dn.getNumber("WEBGL_VERSION");return n===0?0:YF(n)})),dn.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return dn.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(n=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))));var n})),dn.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return QF(dn.getNumber("WEBGL_VERSION"))})),dn.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!dn.getBool("WEBGL_FORCE_F16_TEXTURES")&&dn.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),dn.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return JF(dn.getNumber("WEBGL_VERSION"))})),dn.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return ZF(dn.getNumber("WEBGL_VERSION"))})),dn.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return dn.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),MI=BI;var ko=xe({complex_:function(n,e){var t=se(n,"real","complex"),r=se(e,"imag","complex");return ir(t.shape,r.shape,"real and imag shapes, "+t.shape+" and "+r.shape+", must match in call to tf.complex()."),Te.runKernelFunc((function(i){return i.complex(t,r)}),{$real:t,$imag:r})}}),qa=xe({real_:function(n){var e=se(n,"input","real");return Te.runKernelFunc((function(t){return t.real(e)}),{$input:e})}}),tl=xe({imag_:function(n){var e=se(n,"input","imag");return Te.runKernelFunc((function(t){return t.imag(e)}),{$input:e})}});function Po(n,e,t){return wh(n,e,yh(n,t),t)}function wh(n,e,t,r){if(r==null&&(r=Um(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!ul(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){DI(e);var i=Mt(e),o=Mt(t);me(i===o,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o}));for(var s=0;s<t.length;++s){var a=t[s],u=s!==t.length-1||a!==Mt(e.slice(s));me(t[s]===e[s]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+t+") does not match the provided shape ("+e+"). "}))}}return ul(n)||Array.isArray(n)||(n=[n]),e=e||t,n=r!=="string"?RI(n,r,Ye().getBool("DEBUG")):Ud(n,[],!0),Te.makeTensor(n,e,r)}function dt(n,e){if((ul(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&ul(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return wh(n,[],[],e)}function Di(n,e){np(n);var t=yh(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return wh(n,null,t,e)}function Yc(n,e,t){if(np(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=yh(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return wh(n,e,r,t)}function qb(n,e,t){if(np(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=yh(n,t);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return wh(n,e,r,t)}function zs(n,e,t){if(np(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=yh(n,t);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return wh(n,e,r,t)}function r8(n,e,t){if(np(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=yh(n,t);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return wh(n,e,r,t)}function i8(n,e,t){if(np(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=yh(n,t);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return wh(n,e=e||r,r,t)}function o8(n,e,t,r){return e===void 0&&(e=!0),Te.makeVariable(n,e,t,r)}function rp(n,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=rp(n,"float32"),r=Tr(n,"float32");return ko(t,r)}var i=PI(Mt(n),e);return Te.makeTensor(i,n,e)}function Tr(n,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=Tr(n,"float32"),r=Tr(n,"float32");return ko(t,r)}var i=zm(Mt(n),e);return Te.makeTensor(i,n,e)}function cl(n,e,t){return Te.runKernelFunc((function(r){return r.fill(n,e,t)}),{})}function s8(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");return Te.runKernelFunc((function(r){return r.linspace(n,e,t)}),{})}function r0(n,e,t,r){if(t===void 0&&(t=1),r===void 0&&(r="float32"),t===0)throw new Error("Cannot have a step of zero");if(n===e||n<e&&t<0||e<n&&t>1)return Tr([0],r);var i=zm(Math.abs(Math.ceil((e-n)/t)),r);e<n&&t===1&&(t=-1),i[0]=n;for(var o=1;o<i.length;o++)i[o]=i[o-1]+t;return Di(i,r)}var jI=xe({onesLike_:function(n){var e=se(n,"x","onesLike");if(e.dtype==="complex64"){var t=jI(qa(e)),r=zn(tl(e));return ko(t,r)}return Te.runKernelFunc((function(i){return i.onesLike(e)}),{$x:e},(function(i,o){return{$x:function(){return zn(i)}}}))}}),zn=xe({zerosLike_:function(n){var e=se(n,"x","zerosLike");return Te.runKernelFunc((function(t){return t.zerosLike(e)}),{$x:e},(function(t,r){return{$x:function(){return zn(t)}}}))}}),qi=xe({concat_:function(n,e){e===void 0&&(e=0),me(n.length>=1,(function(){return"Pass at least one tensor to concat"}));var t=n0(n,"tensors","concat");t[0].dtype==="complex64"&&t.forEach((function(a){if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+a.dtype+". ")})),e=Xi(e,t[0].shape)[0];var r=Wd(t.map((function(a){return a.shape})),e);if(Mt(r)===0)return Po([],r);if((t=t.filter((function(a){return a.size>0}))).length===1)return t[0];var i=t.map((function(a){return a.shape}));n8(i,e);var o=t,s={axis:e};return Te.runKernelFunc((function(a){return a.concat(t,e)}),o,(function(a){var u=i.map((function(l){return l[e]}));return Hb(a,u,e).map((function(l){return function(){return l}}))}),"Concat",s)}}),a8=xe({concat1d_:function(n){return qi(n,0)}}),u8=xe({concat2d_:function(n,e){return qi(n,e)}}),l8=xe({concat3d_:function(n,e){return qi(n,e)}}),c8=xe({concat4d_:function(n,e){return qi(n,e)}}),Hb=xe({split_:function(n,e,t){t===void 0&&(t=0);var r,i=se(n,"x","split");return t=Xi(t,i.shape)[0],typeof e=="number"?(me(i.shape[t]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[t]/e)):(me(i.shape[t]===e.reduce((function(o,s){return o+s})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),Te.runKernelFunc((function(o){return o.split(i,r,t)}),{$x:i},(function(o){return{$x:function(){return qi(o,t)}}}))}});function yf(n,e){return n(e={exports:{}},e.exports),e.exports}var h8=yf((function(n){(function(e,t,r){function i(a){var u,l=this,h=(u=4022871197,function(d){d=d.toString();for(var m=0;m<d.length;m++){var p=.02519603282416938*(u+=d.charCodeAt(m));p-=u=p>>>0,u=(p*=u)>>>0,u+=4294967296*(p-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var d=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=h(" "),l.s1=h(" "),l.s2=h(" "),l.s0-=h(a),l.s0<0&&(l.s0+=1),l.s1-=h(a),l.s1<0&&(l.s1+=1),l.s2-=h(a),l.s2<0&&(l.s2+=1),h=null}function o(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function s(a,u){var l=new i(a),h=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.alea=s})(0,n)})),f8=yf((function(n){(function(e,t,r){function i(a){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},a===(0|a)?u.x=a:l+=a;for(var h=0;h<l.length+64;h++)u.x^=0|l.charCodeAt(h),u.next()}function o(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u}function s(a,u){var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var m=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=l.next,d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xor128=s})(0,n)})),d8=yf((function(n){(function(e,t,r){function i(a){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,a===(0|a)?u.x=a:l+=a;for(var h=0;h<l.length+64;h++)u.x^=0|l.charCodeAt(h),h==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u.v=a.v,u.d=a.d,u}function s(a,u){var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var m=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=l.next,d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xorwow=s})(0,n)})),p8=yf((function(n){(function(e,t,r){function i(a){var u=this;u.next=function(){var l,h,d=u.x,m=u.i;return l=d[m],h=(l^=l>>>7)^l<<24,h^=(l=d[m+1&7])^l>>>10,h^=(l=d[m+3&7])^l>>>3,h^=(l=d[m+4&7])^l<<7,l=d[m+7&7],h^=(l^=l<<13)^l<<9,d[m]=h,u.i=m+1&7,h},(function(l,h){var d,m=[];if(h===(0|h))m[0]=h;else for(h=""+h,d=0;d<h.length;++d)m[7&d]=m[7&d]<<15^h.charCodeAt(d)+m[d+1&7]<<13;for(;m.length<8;)m.push(0);for(d=0;d<8&&m[d]===0;++d);for(d==8?m[7]=-1:m[d],l.x=m,l.i=0,d=256;d>0;--d)l.next()})(u,a)}function o(a,u){return u.x=a.x.slice(),u.i=a.i,u}function s(a,u){a==null&&(a=+new Date);var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var m=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=l.next,d.quick=d,h&&(h.x&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xorshift7=s})(0,n)})),m8=yf((function(n){(function(e,t,r){function i(a){var u=this;u.next=function(){var l,h,d=u.w,m=u.X,p=u.i;return u.w=d=d+1640531527|0,h=m[p+34&127],l=m[p=p+1&127],h^=h<<13,l^=l<<17,h^=h>>>15,l^=l>>>12,h=m[p]=h^l,u.i=p,h+(d^d>>>16)|0},(function(l,h){var d,m,p,y,b,x=[],E=128;for(h===(0|h)?(m=h,h=null):(h+="\0",m=0,E=Math.max(E,h.length)),p=0,y=-32;y<E;++y)h&&(m^=h.charCodeAt((y+32)%h.length)),y===0&&(b=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,y>=0&&(b=b+1640531527|0,p=(d=x[127&y]^=m+b)==0?p+1:0);for(p>=128&&(x[127&(h&&h.length||0)]=-1),p=127,y=512;y>0;--y)m=x[p+34&127],d=x[p=p+1&127],m^=m<<13,d^=d<<17,m^=m>>>15,d^=d>>>12,x[p]=m^d;l.w=b,l.X=x,l.i=p})(u,a)}function o(a,u){return u.i=a.i,u.w=a.w,u.X=a.X.slice(),u}function s(a,u){a==null&&(a=+new Date);var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var m=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=l.next,d.quick=d,h&&(h.X&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.xor4096=s})(0,n)})),g8=yf((function(n){(function(e,t,r){function i(a){var u=this,l="";u.next=function(){var d=u.b,m=u.c,p=u.d,y=u.a;return d=d<<25^d>>>7^m,m=m-p|0,p=p<<24^p>>>8^y,y=y-d|0,u.b=d=d<<20^d>>>12^m,u.c=m=m-p|0,u.d=p<<16^m>>>16^y,u.a=y-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,a===Math.floor(a)?(u.a=a/4294967296|0,u.b=0|a):l+=a;for(var h=0;h<l.length+20;h++)u.b^=0|l.charCodeAt(h),u.next()}function o(a,u){return u.a=a.a,u.b=a.b,u.c=a.c,u.d=a.d,u}function s(a,u){var l=new i(a),h=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var m=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(m===0);return m},d.int32=l.next,d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}t&&t.exports?t.exports=s:this.tychei=s})(0,n)})),$h=yf((function(n){(function(e,t){var r,i=this,o=256,s=6,a="random",u=t.pow(o,s),l=t.pow(2,52),h=2*l,d=o-1;function m(E,T,P){var C=[],D=b((function I(A,O){var k,M=[],j=typeof A;if(O&&j=="object")for(k in A)try{M.push(I(A[k],O-1))}catch{}return M.length?M:j=="string"?A:A+"\0"})((T=T==1?{entropy:!0}:T||{}).entropy?[E,x(e)]:E??(function(){try{var I;return r&&(I=r.randomBytes)?I=I(o):(I=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(I)),x(I)}catch{var A=i.navigator,O=A&&A.plugins;return[+new Date,i,O,i.screen,x(e)]}})(),3),C),z=new p(C),L=function(){for(var I=z.g(s),A=u,O=0;I<l;)I=(I+O)*o,A*=o,O=z.g(1);for(;I>=h;)I/=2,A/=2,O>>>=1;return(I+O)/A};return L.int32=function(){return 0|z.g(4)},L.quick=function(){return z.g(4)/4294967296},L.double=L,b(x(z.S),e),(T.pass||P||function(I,A,O,k){return k&&(k.S&&y(k,z),I.state=function(){return y(z,{})}),O?(t[a]=I,A):I})(L,D,"global"in T?T.global:this==t,T.state)}function p(E){var T,P=E.length,C=this,D=0,z=C.i=C.j=0,L=C.S=[];for(P||(E=[P++]);D<o;)L[D]=D++;for(D=0;D<o;D++)L[D]=L[z=d&z+E[D%P]+(T=L[D])],L[z]=T;(C.g=function(I){for(var A,O=0,k=C.i,M=C.j,j=C.S;I--;)A=j[k=d&k+1],O=O*o+j[d&(j[k]=j[M=d&M+A])+(j[M]=A)];return C.i=k,C.j=M,O})(o)}function y(E,T){return T.i=E.i,T.j=E.j,T.S=E.S.slice(),T}function b(E,T){for(var P,C=E+"",D=0;D<C.length;)T[d&D]=d&(P^=19*T[d&D])+C.charCodeAt(D++);return x(T)}function x(E){return String.fromCharCode.apply(0,E)}if(t["seed"+a]=m,b(t.random(),e),n.exports){n.exports=m;try{r=require("crypto")}catch{}}})([],Math)}));$h.alea=h8,$h.xor128=f8,$h.xorwow=d8,$h.xorshift7=p8,$h.xor4096=m8,$h.tychei=g8;var q0=$h.alea,Gb=(function(){function n(e,t,r,i,o){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=o||Math.random();this.random=q0(s.toString())}return n.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,r,i=!1;!i;){var o=void 0,s=void 0,a=void 0;do a=(o=2*this.random()-1)*o+(s=2*this.random()-1)*s;while(a>=1||a===0);var u=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*o*u,r=this.mean+this.stdDev*s*u,this.truncated&&!this.isValidTruncated(t)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(t)},n.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},n.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},n})(),v8=(function(){function n(e,t,r,i){this.alpha=e,this.beta=1/t,this.dtype=r;var o=i||Math.random();this.randu=q0(o.toString()),this.randn=new Gb(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return n.prototype.nextValue=function(){for(var e,t,r,i,o,s;;){do i=this.randn.nextValue(),s=1+this.c*i;while(s<=0);if(s*=s*s,t=1-.331*(e=i*i)*e,r=.5*e+this.d*(1-s+Math.log(s)),(o=this.randu())<t||Math.log(o)<r)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},n.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},n})(),y8=(function(){function n(e,t,r,i){var o=this;if(e===void 0&&(e=0),t===void 0&&(t=1),this.canReturnFloat=function(){return o.dtype==null||o.dtype==="float32"},this.min=e,this.range=t-e,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=q0(i)}return n.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},n.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},n})();function wn(n,e,t){return e===void 0&&(e="float32"),e=e||"float32",DI(n),new bm(n,e,t)}function w8(n,e){e===void 0&&(e=!1),console.log(n.toString(e))}var UI=xe({batchToSpaceND_:function(n,e,t){var r=se(n,"x","batchToSpaceND"),i=e.reduce((function(o,s){return o*s}));return me(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),me(t.length===e.length,(function(){return"crops.length is "+t.length+" but should be equal to blockShape.length  "+e.length})),me(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),Te.runKernelFunc((function(o){return o.batchToSpaceND(r,e,t)}),{$x:r},(function(o){return{$x:function(){return o.spaceToBatchND(e,t)}}}))}}),b8=xe({broadcastTo_:function(n,e){var t=se(n,"broadcastTo","x"),r=t.shape;if(e.some((function(u){return!(u>0)||u%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<t.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+t.rank+".");if(e.length>t.rank){for(var i=t.shape.slice();i.length<e.length;)i.unshift(1);t=t.reshape(i)}for(var o=Array.from(e),s=e.length-1;s>=0;s--)if(t.shape[s]===e[s])o[s]=1;else if(t.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var a=o.map((function(u,l){return u>1?l:-1})).filter((function(u){return u>=0}));return a.length===0?t.clone():Te.runKernelFunc((function(u){return u.tile(t,o)}),{input:t},(function(u){return{input:function(){return u.sum(a,!0)}}}))}}),x8=xe({cast_:function(n,e){var t=se(n,"x","cast");if(!dF(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:e};return Te.runKernelFunc((function(i){return i.cast(t,e)}),{x:t},(function(i){return{x:function(){return i.clone()}}}),"Cast",r)}}),_8=xe({clone_:function(n){var e=se(n,"x","clone",null);return Te.runKernelFunc((function(){return Te.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),E8=xe({cumsum_:function(n,e,t,r){e===void 0&&(e=0),t===void 0&&(t=!1),r===void 0&&(r=!1);var i=se(n,"x","cumsum"),o=yl([e|=0],i.rank),s=i;o!=null&&(s=i.transpose(o));var a=wl(1,i.rank)[0],u=Te.runKernelFunc((function(l){return l.cumsum(s,a,t,r)}),{permutedX:s},(function(l){return{permutedX:function(){return l.cumsum(e,t,!r)}}}));return o!=null&&(u=u.transpose(o)),u}}),S8=xe({depthToSpace_:function(n,e,t){t===void 0&&(t="NHWC");var r=se(n,"x","depthToSpace"),i=t==="NHWC"?r.shape[1]:r.shape[2],o=t==="NHWC"?r.shape[2]:r.shape[3],s=t==="NHWC"?r.shape[3]:r.shape[1];return me(i*e>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+`  for depthToSpace with input shape
      `+r.shape})),me(o*e>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+e+` for depthToSpace with input shape
          `+r.shape})),me(s%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+s+" for depthToSpace with input shape "+r.shape})),Te.runKernelFunc((function(a){return a.depthToSpace(r,e,t)}),{$x:r})}}),Wa=xe({expandDims_:function(n,e){e===void 0&&(e=0);var t=se(n,"x","expandDims",null);me(e<=t.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=t.shape.slice();return e<0&&(me(-(t.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(t.rank+1)+", "+t.rank+"]"})),e=t.rank+e+1),r.splice(e,0,1),yu(t,r)}}),zI=xe({eye_:function(n,e,t,r){r===void 0&&(r="float32"),e==null&&(e=n);for(var i=wn([n,e],r),o=n<=e?n:e,s=0;s<o;++s)i.set(1,s,s);var a=i.toTensor().as2D(n,e);if(t==null)return a;if(t.length===1)return bd(Wa(a,0),[t[0],1,1]);if(t.length===2)return bd(Wa(Wa(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return bd(Wa(Wa(Wa(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+t.length+"D.")}}),A8=xe({multinomial_:function(n,e,t,r){r===void 0&&(r=!1);var i=se(n,"logits","multinomial"),o=i.size,s=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);t=t||Math.random();var a=s===1?i.as2D(1,-1):i,u=Te.runKernelFunc((function(l){return l.multinomial(a,r,e,t)}),{logits2D:a});return s===1?u.as1D():u}}),lw=xe({oneHot_:function(n,e,t,r){if(t===void 0&&(t=1),r===void 0&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=se(n,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),Te.runKernelFunc((function(s){return s.oneHot(i,e,t,r)}),{$indices:i},(function(s){return{$indices:function(){return Tr(i.shape,"float32")}}})).reshape(o)}}),wf=xe({pad_:function(n,e,t){t===void 0&&(t=0);var r=se(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:e,constantValue:t};return Te.runKernelFunc((function(o){return o.pad(r,e,t)}),{x:r},(function(o){var s=e.map((function(a){return a[0]}));return{x:function(){return o.slice(s,r.shape)}}}),"PadV2",i)}}),C8=xe({pad1d_:function(n,e,t){return t===void 0&&(t=0),me(e.length===2,(function(){return"Invalid number of paddings. Must be length of 2."})),wf(n,[e],t)}}),I8=xe({pad2d_:function(n,e,t){return t===void 0&&(t=0),me(e.length===2&&e[0].length===2&&e[1].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),wf(n,e,t)}}),T8=xe({pad3d_:function(n,e,t){return t===void 0&&(t=0),me(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),wf(n,e,t)}}),k8=xe({pad4d_:function(n,e,t){return t===void 0&&(t=0),me(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),wf(n,e,t)}}),N8=xe({rand_:function(n,e,t){var r=Mt(n),i=null;if(t==null||t==="float32")i=new Float32Array(r);else if(t==="int32")i=new Int32Array(r);else{if(t!=="bool")throw new Error("Unknown data type "+t);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return Te.makeTensor(i,n,t)}}),R8=xe({randomNormal_:function(n,e,t,r,i){if(e===void 0&&(e=0),t===void 0&&(t=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new Gb(e,t,r,!1,i),s=wn(n,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),P8=xe({randomGamma_:function(n,e,t,r,i){if(t===void 0&&(t=1),r===void 0&&(r="float32"),t==null&&(t=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var o=new v8(e,t,r,i),s=wn(n,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),WI=xe({randomUniform_:function(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=1),r===void 0&&(r="float32");for(var o=wn(n,r),s=new y8(e,t,null,i),a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),yu=xe({reshape_:function(n,e){var t=se(n,"x","reshape",null);e=hF(e,t.size),me(t.size===Mt(e),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:e};return Te.runKernelFunc((function(i){return i.reshape(t,e)}),{x:t},(function(i){return{x:function(){return i.reshape(t.shape)}}}),"Reshape",r)}}),qI=xe({spaceToBatchND_:function(n,e,t){var r=se(n,"x","spaceToBatchND");return me(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),me(t.length===e.length,(function(){return"paddings.shape[0] "+t.length+" must be equal to [blockShape] "+e.length})),me(r.shape.reduce((function(i,o,s){return s>0&&s<=e.length?i&&(o+t[s-1][0]+t[s-1][1])%e[s-1]==0:i}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+t.toString()+" must be divisible by blockShapes "+e.toString()})),Te.runKernelFunc((function(i){return i.spaceToBatchND(r,e,t)}),{$x:r},(function(i){return{$x:function(){return i.batchToSpaceND(e,t)}}}))}}),HI=xe({squeeze_:function(n,e){var t=se(n,"x","squeeze");return yu(t,Yh(t.shape,e).newShape)}}),wa=xe({stack_:function(n,e){e===void 0&&(e=0);var t=n0(n,"tensors","stack");if(me(t.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),t.length===1)return t[0].expandDims(e);var r=t[0].rank,i=t[0].shape,o=t[0].dtype;me(e<=r,(function(){return"Axis must be <= rank of the tensor"})),t.forEach((function(a){ir(i,a.shape,"All tensors passed to stack must have matching shapes")})),t.forEach((function(a){me(o===a.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var s=t.map((function(a){return a.expandDims(e)}));return qi(s,e)}}),bd=xe({tile_:function(n,e){var t=se(n,"x","tile",null);me(t.rank===e.length,(function(){return"Error in transpose: rank of input "+t.rank+" must match length of reps "+e+"."}));var r=[t],i={reps:e};return Te.runKernelFunc((function(o,s){var a=o.tile(t,e);return s([t]),a}),{x:t},(function(o,s){var a=s[0];return{x:function(){var u=zn(a);if(a.rank===1)for(var l=0;l<e[0];++l)u=u.add(o.slice([l*a.shape[0]],[a.shape[0]]));else if(a.rank===2)for(l=0;l<e[0];++l)for(var h=0;h<e[1];++h)u=u.add(o.slice([l*a.shape[0],h*a.shape[1]],[a.shape[0],a.shape[1]]));else if(a.rank===3)for(l=0;l<e[0];++l)for(h=0;h<e[1];++h)for(var d=0;d<e[2];++d)u=u.add(o.slice([l*a.shape[0],h*a.shape[1],d*a.shape[2]],[a.shape[0],a.shape[1],a.shape[2]]));else{if(a.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+a.rank+" tensors yet.");for(l=0;l<e[0];++l)for(h=0;h<e[1];++h)for(d=0;d<e[2];++d)for(var m=0;m<e[3];++m)u=u.add(o.slice([l*a.shape[0],h*a.shape[1],d*a.shape[2],m*a.shape[3]],[a.shape[0],a.shape[1],a.shape[2],a.shape[3]]))}return u}}}),"Tile",i,r)}}),D8=xe({truncatedNormal_:function(n,e,t,r,i){if(e===void 0&&(e=0),t===void 0&&(t=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new Gb(e,t,r,!0,i),s=wn(n,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),Hi=xe({unstack_:function(n,e){e===void 0&&(e=0),e=e||0;var t=se(n,"x","unstack");me(e>=-t.shape.length&&e<t.shape.length,(function(){return"Axis = "+e+" is not in [-"+t.shape.length+", "+t.shape.length+")"})),e<0&&(e+=t.shape.length);var r={axis:e};return Te.runKernelFunc((function(i){return i.unstack(t,e)}),{x:t},(function(i){return{x:function(){return wa(i,e)}}}),"Unpack",r)}}),L8=function(n,e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h,d;return Rt(this,(function(m){switch(m.label){case 0:return t=se(n,"x","setdiff1d"),r=se(e,"y","setdiff1d"),me(t.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+t.dtype+") and y ("+r.dtype+")."})),me(t.rank===1,(function(){return"x should be 1D tensor, but got x ("+t.shape+")."})),me(r.rank===1,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,t.data()];case 1:return i=m.sent(),[4,r.data()];case 2:for(o=m.sent(),s=new Set(o),a=0,h=0;h<i.length;h++)s.has(i[h])||a++;for(u=new bm([a],t.dtype),l=new bm([a],"int32"),h=0,d=0;h<i.length;h++)s.has(i[h])||(u.values[d]=i[h],l.values[d]=h,d++);return[2,[u.toTensor(),l.toTensor()]]}}))}))};function i0(n,e,t,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(n[0]/t),i=i.concat(n.slice(1));else{i=i.concat(n[0]);for(var o=e.length,s=0;s<o;++s)i=i.concat([n[s+1]/e[s],e[s]]);i=i.concat(n.slice(o+1))}return i}function o0(n,e,t){t===void 0&&(t=!0);var r=[];if(t){r.push(e);for(var i=e+1;i<n;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],s=[];for(i=1;i<n;++i)i>=2*e+1||i%2==1?s.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,s)}return r}function s0(n,e,t,r){r===void 0&&(r=!0);var i=[];r?i.push(n[0]/t):i.push(n[0]*t);for(var o=1;o<n.length;++o)o<=e.length?r?i.push(e[o-1]*n[o]):i.push(n[o]/e[o-1]):i.push(n[o]);return i}function GI(n,e){for(var t=[0],r=0;r<e;++r)t.push(n[r][0]);return t}function $I(n,e,t){for(var r=n.slice(0,1),i=0;i<t;++i)r.push(n[i+1]-e[i][0]-e[i][1]);return r}function KI(n,e){if(n.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+n.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>n.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+n.rank);if(n.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+n.shape+".");for(var t=e.shape,r=t[t.length-1],i=1,o=0;o<t.length-1;++o)i*=t[o];var s=n.shape,a=t.slice();a.pop();var u=1;for(o=r;o<n.rank;++o)u*=s[o],a.push(s[o]);var l=ll(n.shape).map((function(h){return h/u})).concat([1]).slice(0,r);return[a,i,u,l]}var XI=30;function Fy(n){return n<=XI?n:rw(n,Math.floor(Math.sqrt(n)))}function M8(n,e,t){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+t.shape+", indices.shape: "+e.shape+", shape: "+n+", sliceDim: "+r+", and batchDim: "+i+".";if(t.rank<i)throw new Error(o+" update.rank < "+i+". ");if(n.length<r+(t.rank-i))throw new Error(o+" Output shape length < "+(r+(t.rank-i)));if(t.rank!==i+n.length-r)throw new Error(o+" update.rank != "+(i+n.length-r));for(var s=0;s<i;++s)if(t.shape[s]!==e.shape[s])throw new Error(o+" updates.shape["+s+"] ("+t.shape[s]+") != indices.shape["+s+"] ("+e.shape[s]+").");for(s=0;s<t.rank-i;++s)if(t.shape[s+i]!==n[s+r])throw new Error(o+" updates.shape["+(s+i)+"] ("+t.shape[s+i]+") != shape["+(s+i)+"] ("+n[s+i]+")")}function O8(n,e,t){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(n.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+n.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+t);if(t.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(n.size===0)throw new Error("Updates specified for empty output. updates shape: "+n.shape)}M8(t,e,n)}function a0(n,e,t){for(var r=e.shape.length,i=r>1?e.shape[r-1]:1,o=t.length,s=1,a=i;a<o;++a)s*=t[a];var u=i<1?1:i;return{sliceRank:i,numUpdates:Mt(e.shape)/u,sliceSize:s,strides:ll(t.slice(0,i)).concat([1]),outputSize:Mt(t)}}function F8(n,e,t){me(n.rank===e.length,(function(){return"Error in slice"+n.rank+"D: Length of begin "+e+" must match the rank of the array ("+n.rank+")."})),me(n.rank===t.length,(function(){return"Error in slice"+n.rank+"D: Length of size "+t+" must match the rank of the array ("+n.rank+")."}));for(var r=function(o){me(e[o]+t[o]<=n.shape[o],(function(){return"Error in slice"+n.rank+"D: begin["+o+"] + size["+o+"] ("+(e[o]+t[o])+") would overflow input.shape["+o+"] ("+n.shape[o]+")"}))},i=0;i<n.rank;++i)r(i)}function cS(n){for(var e=[],t=0;n>0;)1&n&&e.push(t),n/=2,t++;return e}function $b(n,e,t){for(var r=[],i=0;i<n.length;i++)r[i]=Math.ceil((e[i]-n[i])/t[i]);return r}function B8(n,e,t,r,i){var o=e[i],s=t[i]||1;(n&1<<i||o==null)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),o=ew(0,o,a-1)}function V8(n,e,t,r,i){var o=e[i],s=t[i]||1;(n&1<<i||o==null)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),o=s>0?ew(0,o,a):ew(-1,o,a-1)}function YI(n,e,t){for(var r=t.length,i=0;i<t.length;i++)if(t[i]>1){r=i;break}for(i=r+1;i<t.length;i++)if(e[i]>0||t[i]!==n[i])return!1;return!0}function QI(n,e){for(var t=n.length>0?n[n.length-1]:1,r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function j8(n,e){me(nw(n),(function(){return"The f passed in variableGrads(f) must be a function"})),me(e==null||Array.isArray(e)&&e.every((function(h){return h instanceof zd})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var t=e!=null;if(!t)for(var r in e=[],Te.registeredVariables)e.push(Te.registeredVariables[r]);var i=t?e.filter((function(h){return!h.trainable})):null,o=e.length;me((e=e.filter((function(h){return h.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."}));var s=Te.gradients(n,e,null,!0),a=s.value,u=s.grads;me(u.some((function(h){return h!=null})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),me(a.rank===0,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+a.rank+" tensor"}));var l={};return e.forEach((function(h,d){u[d]!=null&&(l[h.name]=u[d])})),i!=null&&i.forEach((function(h){return l[h.name]=null})),{value:a,grads:l}}function H0(n){return Te.customGrad(n)}var ic=xe({softmax_:function(n,e){e===void 0&&(e=-1);var t=se(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and dim was "+e);return Te.runKernelFunc((function(r,i){var o=r.softmax(t,e);return i([o]),o}),{logits:t},(function(r,i){var o=i[0],s=r.mul(o);return{logits:function(){return s.sub(s.sum([e],!0).mul(o))}}}),"Softmax",{dim:e},[],[!0])}}),U8=xe({logSoftmax_:function(n,e){e===void 0&&(e=-1);var t=se(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and axis was "+e);return H0((function(r,i){var o=r.max(e,!0),s=r.sub(o),a=s.toFloat().sub(s.exp().sum(e,!0).log());return i([a]),{value:a,gradFunc:function(u,l){var h=l[0].exp();return u.sub(u.sum(e,!0).mul(h))}}}))(t)}}),JI=(function(){function n(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return n.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},n.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},n.prototype.has=function(e){return this.data.has(e)},n.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},n.prototype.numDataIds=function(){return this.dataIdsCount},n})(),ZI=(function(){function n(){}return n.prototype.time=function(e){return Ue("time")},n.prototype.read=function(e){return Ue("read")},n.prototype.readSync=function(e){return Ue("readSync")},n.prototype.numDataIds=function(){return Ue("numDataIds")},n.prototype.disposeData=function(e){return Ue("disposeData")},n.prototype.write=function(e,t,r){return Ue("write")},n.prototype.move=function(e,t,r,i){return Ue("move")},n.prototype.memory=function(){return Ue("memory")},n.prototype.floatPrecision=function(){return Ue("floatPrecision")},n.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},n.prototype.batchMatMul=function(e,t,r,i){return Ue("batchMatMul")},n.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,Ue("fusedBatchMatMul")},n.prototype.slice=function(e,t,r){return Ue("slice")},n.prototype.stridedSlice=function(e,t,r,i){return Ue("stridedSlice")},n.prototype.unstack=function(e,t){return Ue("unstack")},n.prototype.reverse=function(e,t){return Ue("reverse")},n.prototype.concat=function(e,t){return Ue("concat")},n.prototype.neg=function(e){return Ue("neg")},n.prototype.add=function(e,t){return Ue("add")},n.prototype.addN=function(e){return Ue("addN")},n.prototype.subtract=function(e,t){return Ue("subtract")},n.prototype.multiply=function(e,t){return Ue("multiply")},n.prototype.realDivide=function(e,t){return Ue("realDivide")},n.prototype.floorDiv=function(e,t){return Ue("floorDiv")},n.prototype.sum=function(e,t){return Ue("sum")},n.prototype.prod=function(e,t){return Ue("prod")},n.prototype.unsortedSegmentSum=function(e,t,r){return Ue("unsortedSegmentSum")},n.prototype.argMin=function(e,t){return Ue("argMin")},n.prototype.argMax=function(e,t){return Ue("argMax")},n.prototype.equal=function(e,t){return Ue("equal")},n.prototype.notEqual=function(e,t){return Ue("notEqual")},n.prototype.less=function(e,t){return Ue("less")},n.prototype.lessEqual=function(e,t){return Ue("lessEqual")},n.prototype.greater=function(e,t){return Ue("greater")},n.prototype.greaterEqual=function(e,t){return Ue("greaterEqual")},n.prototype.logicalNot=function(e){return Ue("logicalNot")},n.prototype.logicalAnd=function(e,t){return Ue("logicalAnd")},n.prototype.logicalOr=function(e,t){return Ue("logicalOr")},n.prototype.where=function(e){return Ue("where")},n.prototype.select=function(e,t,r){return Ue("select")},n.prototype.topk=function(e,t,r){return Ue("topk")},n.prototype.min=function(e,t){return Ue("min")},n.prototype.minimum=function(e,t){return Ue("minimum")},n.prototype.mod=function(e,t){return Ue("mod")},n.prototype.max=function(e,t){return Ue("max")},n.prototype.maximum=function(e,t){return Ue("maximum")},n.prototype.all=function(e,t){return Ue("all")},n.prototype.any=function(e,t){return Ue("any")},n.prototype.squaredDifference=function(e,t){return Ue("squaredDifference")},n.prototype.ceil=function(e){return Ue("ceil")},n.prototype.floor=function(e){return Ue("floor")},n.prototype.round=function(e){return Ue("round")},n.prototype.sign=function(e){return Ue("sign")},n.prototype.isNaN=function(e){return Ue("isNaN")},n.prototype.isInf=function(e){return Ue("isInf")},n.prototype.isFinite=function(e){return Ue("isFinite")},n.prototype.pow=function(e,t){return Ue("pow")},n.prototype.exp=function(e){return Ue("exp")},n.prototype.expm1=function(e){return Ue("expm1")},n.prototype.softmax=function(e,t){return Ue("softmax")},n.prototype.log=function(e){return Ue("log")},n.prototype.log1p=function(e){return Ue("log1p")},n.prototype.sqrt=function(e){return Ue("sqrt")},n.prototype.rsqrt=function(e){return Ue("rsqrt")},n.prototype.square=function(e){return Ue("square")},n.prototype.reciprocal=function(e){return Ue("reciprocal")},n.prototype.relu=function(e){return Ue("relu")},n.prototype.relu6=function(e){return Ue("relu6")},n.prototype.prelu=function(e,t){return Ue("prelu")},n.prototype.elu=function(e){return Ue("elu")},n.prototype.eluDer=function(e,t){return Ue("eluDer")},n.prototype.selu=function(e){return Ue("selu")},n.prototype.int=function(e){return Ue("int")},n.prototype.clip=function(e,t,r){return Ue("clip")},n.prototype.abs=function(e){return Ue("abs")},n.prototype.complexAbs=function(e){return Ue("complexAbs")},n.prototype.sigmoid=function(e){return Ue("sigmoid")},n.prototype.softplus=function(e){return Ue("softplus")},n.prototype.sin=function(e){return Ue("sin")},n.prototype.cos=function(e){return Ue("cos")},n.prototype.tan=function(e){return Ue("tan")},n.prototype.asin=function(e){return Ue("asin")},n.prototype.acos=function(e){return Ue("acos")},n.prototype.atan=function(e){return Ue("atan")},n.prototype.atan2=function(e,t){return Ue("atan2")},n.prototype.sinh=function(e){return Ue("sinh")},n.prototype.cosh=function(e){return Ue("cosh")},n.prototype.tanh=function(e){return Ue("tanh")},n.prototype.asinh=function(e){return Ue("asinh")},n.prototype.acosh=function(e){return Ue("acosh")},n.prototype.atanh=function(e){return Ue("atanh")},n.prototype.erf=function(e){return Ue("erf")},n.prototype.step=function(e,t){return Ue("step")},n.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Ue("fusedConv2d")},n.prototype.conv2d=function(e,t,r){return Ue("conv2d")},n.prototype.conv2dDerInput=function(e,t,r){return Ue("conv2dDerInput")},n.prototype.conv2dDerFilter=function(e,t,r){return Ue("conv2dDerFilter")},n.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Ue("fusedDepthwiseConv2D")},n.prototype.depthwiseConv2D=function(e,t,r){return Ue("depthwiseConv2D")},n.prototype.depthwiseConv2DDerInput=function(e,t,r){return Ue("depthwiseConv2DDerInput")},n.prototype.depthwiseConv2DDerFilter=function(e,t,r){return Ue("depthwiseConv2DDerFilter")},n.prototype.conv3d=function(e,t,r){return Ue("conv3d")},n.prototype.conv3dDerInput=function(e,t,r){return Ue("conv3dDerInput")},n.prototype.conv3dDerFilter=function(e,t,r){return Ue("conv3dDerFilter")},n.prototype.maxPool=function(e,t){return Ue("maxPool")},n.prototype.maxPoolBackprop=function(e,t,r,i){return Ue("maxPoolBackprop")},n.prototype.avgPool=function(e,t){return Ue("avgPool")},n.prototype.avgPoolBackprop=function(e,t,r){return Ue("avgPoolBackprop")},n.prototype.avgPool3d=function(e,t){return Ue("avgPool3d")},n.prototype.avgPool3dBackprop=function(e,t,r){return Ue("avgPool3dBackprop")},n.prototype.maxPool3d=function(e,t){return Ue("maxPool3d")},n.prototype.maxPool3dBackprop=function(e,t,r,i){return Ue("maxPool3dBackprop")},n.prototype.reshape=function(e,t){return Ue("reshape")},n.prototype.cast=function(e,t){return Ue("cast")},n.prototype.tile=function(e,t){return Ue("tile")},n.prototype.pad=function(e,t,r){return Ue("pad")},n.prototype.transpose=function(e,t){return Ue("transpose")},n.prototype.gather=function(e,t,r){return Ue("gather")},n.prototype.gatherND=function(e,t){return Ue("gatherND")},n.prototype.scatterND=function(e,t,r){return Ue("scatterND")},n.prototype.batchToSpaceND=function(e,t,r){return Ue("batchToSpaceND")},n.prototype.spaceToBatchND=function(e,t,r){return Ue("spaceToBatchND")},n.prototype.resizeBilinear=function(e,t,r,i){return Ue("resizeBilinear")},n.prototype.resizeBilinearBackprop=function(e,t,r){return Ue("resizeBilinearBackprop")},n.prototype.resizeNearestNeighbor=function(e,t,r,i){return Ue("resizeNearestNeighbor")},n.prototype.resizeNearestNeighborBackprop=function(e,t,r){return Ue("resizeNearestNeighborBackprop")},n.prototype.batchNormalization=function(e,t,r,i,o,s){return Ue("batchNormalization")},n.prototype.localResponseNormalization4D=function(e,t,r,i,o){return Ue("localResponseNormalization4D")},n.prototype.LRNGrad=function(e,t,r,i,o,s,a){return Ue("LRNGrad")},n.prototype.multinomial=function(e,t,r,i){return Ue("multinomial")},n.prototype.oneHot=function(e,t,r,i){return Ue("oneHot")},n.prototype.cumsum=function(e,t,r,i){return Ue("cumsum")},n.prototype.nonMaxSuppression=function(e,t,r,i,o){return Ue("nonMaxSuppression")},n.prototype.fft=function(e){return Ue("fft")},n.prototype.ifft=function(e){return Ue("ifft")},n.prototype.complex=function(e,t){return Ue("complex")},n.prototype.real=function(e){return Ue("real")},n.prototype.imag=function(e){return Ue("imag")},n.prototype.cropAndResize=function(e,t,r,i,o,s){return Ue("cropAndResize")},n.prototype.depthToSpace=function(e,t,r){return Ue("depthToSpace")},n.prototype.split=function(e,t,r){return Ue("split")},n.prototype.sparseToDense=function(e,t,r,i){return Ue("sparseToDense")},n.prototype.diag=function(e){return Ue("diag")},n.prototype.fill=function(e,t,r){return Ue("fill")},n.prototype.onesLike=function(e){return Ue("onesLike")},n.prototype.zerosLike=function(e){return Ue("zerosLike")},n.prototype.linspace=function(e,t,r){return Ue("linspace")},n.prototype.dispose=function(){return Ue("dispose")},n})();function Ue(n){throw new Error("'"+n+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Hc(n,e){for(var t=n.length,r=[],i=0;i<t;i++){var o=t-1-i,s=n[o]||1;(e[e.length-1-i]||1)>1&&s===1&&r.unshift(o)}return r}function $i(n,e){for(var t=[],r=0;r<e.length;r++){var i=n[n.length-r-1],o=e.length-r-1,s=e[o];(i==null||i===1&&s>1)&&t.unshift(o)}return t}function Mn(n,e){for(var t=[],r=Math.max(n.length,e.length),i=0;i<r;i++){var o=n[n.length-i-1];o==null&&(o=1);var s=e[e.length-i-1];if(s==null&&(s=1),o===1)t.unshift(s);else if(s===1)t.unshift(o);else{if(o!==s)throw Error("Operands could not be broadcast together with shapes "+n+" and "+e+".");t.unshift(o)}}return t}function _m(n,e,t,r,i,o,s){s===void 0&&(s="channelsLast");var a,u=c0(e),l=u[0],h=u[1];if(s==="channelsLast")a=[l,h,n[3],n[3]];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);a=[l,h,n[1],n[1]]}return bf(n,a,t,r,i,o,!1,s)}function u0(n,e,t,r,i,o,s){s===void 0&&(s="NDHWC");var a,u,l=cw(e),h=l[0],d=l[1],m=l[2];if(s==="NDHWC")u="channelsLast",a=[h,d,m,n[4],n[4]];else{if(s!=="NCDHW")throw new Error("Unknown dataFormat "+s);u="channelsFirst",a=[h,d,m,n[1],n[1]]}return l0(n,a,t,r,i,!1,u,o)}function bf(n,e,t,r,i,o,s,a){s===void 0&&(s=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1],l=u[0],h=u[1],d=u[2],m=u[3];if(a==="channelsLast")l=n[0],h=n[1],d=n[2],m=n[3];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=n[0],m=n[1],h=n[2],d=n[3]}var p,y=e[0],b=e[1],x=e[3],E=c0(t),T=E[0],P=E[1],C=c0(r),D=C[0],z=C[1],L=xd(y,D),I=xd(b,z),A=(function(X,ue,ge,ce,$,ae,fe,Q){var W,J,te;if(typeof X=="number"){W={top:X,bottom:X,left:X,right:X,type:X===0?"VALID":"NUMBER"};var de=(function(Ae,Be,Le,tt,re){tt==null&&(tt=eT(Ae,Be,Le));var rt=Ae[0],zt=Ae[1],gt=im((rt-Be+2*tt)/Le+1,re);me(xi(gt),(function(){return"The output # of rows ("+gt+") must be an integer. Change the stride and/or zero pad parameters"}));var He=im((zt-Be+2*tt)/Le+1,re);return me(xi(He),(function(){return"The output # of columns ("+He+") must be an integer. Change the stride and/or zero pad parameters"})),[gt,He]})([ue,ge],ae,ce,X,Q);J=de[0],te=de[1]}else if(X==="same"){J=Math.ceil(ue/ce),te=Math.ceil(ge/$);var ve=Math.max(0,(J-1)*ce+ae-ue),we=Math.max(0,(te-1)*$+fe-ge),Se=Math.floor(ve/2),Ie=ve-Se,Fe=Math.floor(we/2);W={top:Se,bottom:Ie,left:Fe,right:we-Fe,type:"SAME"}}else{if(X!=="valid")throw Error("Unknown padding parameter: "+X);W={top:0,bottom:0,left:0,right:0,type:"VALID"},J=Math.ceil((ue-ae+1)/ce),te=Math.ceil((ge-fe+1)/$)}return{padInfo:W,outHeight:J,outWidth:te}})(i,h,d,T,P,L,I,o),O=A.padInfo,k=A.outHeight,M=A.outWidth,j=s?x*m:x;return a==="channelsFirst"?p=[l,j,k,M]:a==="channelsLast"&&(p=[l,k,M,j]),{batchSize:l,dataFormat:a,inHeight:h,inWidth:d,inChannels:m,outHeight:k,outWidth:M,outChannels:j,padInfo:O,strideHeight:T,strideWidth:P,filterHeight:y,filterWidth:b,effectiveFilterHeight:L,effectiveFilterWidth:I,dilationHeight:D,dilationWidth:z,inShape:n,outShape:p,filterShape:e}}function l0(n,e,t,r,i,o,s,a){o===void 0&&(o=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],h=u[1],d=u[2],m=u[3],p=u[4];if(s==="channelsLast")l=n[0],h=n[1],d=n[2],m=n[3],p=n[4];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=n[0],p=n[1],h=n[2],d=n[3],m=n[4]}var y,b=e[0],x=e[1],E=e[2],T=e[4],P=cw(t),C=P[0],D=P[1],z=P[2],L=cw(r),I=L[0],A=L[1],O=L[2],k=xd(b,I),M=xd(x,A),j=xd(E,O),X=(function(fe,Q,W,J,te,de,ve,we,Se,Ie,Fe){var Ae,Be,Le,tt;if(typeof fe=="number"){Ae={top:fe,bottom:fe,left:fe,right:fe,front:fe,back:fe,type:fe===0?"VALID":"NUMBER"};var re=(function(En,$t,Qt,an,qt,vt){qt==null&&(qt=eT(En,$t,an));var en=En[0],yt=En[1],dr=En[2],mn=im((en-$t+2*qt)/an+1,vt);me(xi(mn),(function(){return"The output # of depths ("+mn+") must be an integer. Change the stride and/or zero pad parameters"}));var rn=im((yt-$t+2*qt)/an+1,vt);me(xi(rn),(function(){return"The output # of rows ("+rn+") must be an integer. Change the stride and/or zero pad parameters"}));var un=im((dr-$t+2*qt)/an+1,vt);return me(xi(un),(function(){return"The output # of columns ("+un+") must be an integer. Change the stride and/or zero pad parameters"})),[mn,rn,un,Qt]})([Q,W,J,1],we,1,te,fe,Fe);Be=re[0],Le=re[1],tt=re[2]}else if(fe==="same"){Be=Math.ceil(Q/te),Le=Math.ceil(W/de),tt=Math.ceil(J/ve);var rt=(Be-1)*te+we-Q,zt=(Le-1)*de+Se-W,gt=(tt-1)*ve+Ie-J,He=Math.floor(rt/2),ft=rt-He,lt=Math.floor(zt/2),Et=zt-lt,pt=Math.floor(gt/2);Ae={top:lt,bottom:Et,left:pt,right:gt-pt,front:He,back:ft,type:"SAME"}}else{if(fe!=="valid")throw Error("Unknown padding parameter: "+fe);Ae={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Be=Math.ceil((Q-we+1)/te),Le=Math.ceil((W-Se+1)/de),tt=Math.ceil((J-Ie+1)/ve)}return{padInfo:Ae,outDepth:Be,outHeight:Le,outWidth:tt}})(i,h,d,m,C,D,z,k,M,j,a),ue=X.padInfo,ge=X.outDepth,ce=X.outHeight,$=X.outWidth,ae=o?T*p:T;return s==="channelsFirst"?y=[l,ae,ge,ce,$]:s==="channelsLast"&&(y=[l,ge,ce,$,ae]),{batchSize:l,dataFormat:s,inDepth:h,inHeight:d,inWidth:m,inChannels:p,outDepth:ge,outHeight:ce,outWidth:$,outChannels:ae,padInfo:ue,strideDepth:C,strideHeight:D,strideWidth:z,filterDepth:b,filterHeight:x,filterWidth:E,effectiveFilterDepth:k,effectiveFilterHeight:M,effectiveFilterWidth:j,dilationDepth:I,dilationHeight:A,dilationWidth:O,inShape:n,outShape:y,filterShape:e}}function eT(n,e,t,r){r===void 0&&(r=1);var i=xd(e,r);return Math.floor((n[0]*(t-1)-t+i)/2)}function c0(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function cw(n){return typeof n=="number"?[n,n,n]:n}function xd(n,e){return e<=1?n:n+(n-1)*(e-1)}function im(n,e){if(!e)return n;switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error("Unknown roundingMode "+e)}}function qd(n){var e=c0(n),t=e[0],r=e[1],i=e[2];return t===1&&r===1&&i===1}function Gs(n,e){return qd(n)||qd(e)}function Kb(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+n)}function tT(n,e,t){if(e==="complex64"){if(n.dtype==="complex64")return n.clone();var r=Tr(n.shape),i=n.toFloat(),o=t.complex(i,r);return r.dispose(),i.dispose(),o}if(!pF(n.dtype,e))return Te.makeTensorFromDataId(n.dataId,n.shape,e);if(n.dtype==="complex64"){var s=t.real(n);return o=s.cast(e),s.dispose(),o}if(e==="int32")return t.int(n);if(e==="bool"){var a=dt(0,n.dtype);return o=t.notEqual(n,a),a.dispose(),o}throw new Error("Error in Cast: failed to cast "+n.dtype+" to "+e)}function hw(n,e){return Te.makeTensorFromDataId(n.dataId,e,n.dtype)}function nT(n,e,t){var r=(e-n)/(t-1),i=zm(t,"float32");i[0]=n;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return Di(i,"float32")}function fw(n,e){if(n.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+n.length+", imag: "+e.length+".");for(var t=new Float32Array(2*n.length),r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function hS(n,e){return{real:n[2*e],imag:n[2*e+1]}}function z8(n,e,t,r){n[2*r]=e,n[2*r+1]=t}function W8(n,e,t){var r=(t?2:-2)*Math.PI*(n/e);return{real:Math.cos(r),imag:Math.sin(r)}}function q8(n,e,t){var r=(function(o,s,a){return(function(u,l,h){for(var d=0,m=u.length,p=0,y=!1;d<m;){var b=h(l,u[p=d+(m-d>>>1)]);b>0?d=p+1:(m=p,y=!b)}return y?d:-d-1})(o,s,a||H8)})(n,e,t),i=r<0?-(r+1):r;n.splice(i,0,e)}function H8(n,e){return n>e?1:n<e?-1:0}function Xb(n,e,t,r,i){return rT(n,e,t,r,i,0).selectedIndices}function Yb(n,e,t,r,i,o){var s=rT(n,e,t,r,i,o);return s.numValidOutputs.dispose(),{selectedIndices:s.selectedIndices,selectedScores:s.selectedScores}}function rT(n,e,t,r,i,o,s,a){a===void 0&&(a=!1);for(var u=Array.from(e).map((function(C,D){return{score:C,boxIndex:D,suppressBeginIndex:0}})).filter((function(C){return C.score>i})).sort(fS),l=o>0?-.5/o:0,h=[],d=[];h.length<t&&u.length>0;){var m=u.pop(),p=m.score,y=m.boxIndex,b=m.suppressBeginIndex;if(p<i)break;for(var x=!1,E=h.length-1;E>=b;--E){var T=G8(n,y,h[E]);if(T>=r){x=!0;break}if(m.score=m.score*$8(r,l,T),m.score<=i)break}m.suppressBeginIndex=h.length,x||(m.score===p?(h.push(y),d.push(m.score)):m.score>i&&q8(u,m,fS))}var P=h.length;return a&&(h.fill(0,P),d.fill(0,P)),{selectedIndices:Di(h,"int32"),selectedScores:Di(d,"float32"),numValidOutputs:dt(P,"int32")}}function G8(n,e,t){var r=n.subarray(4*e,4*e+4),i=n.subarray(4*t,4*t+4),o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),h=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),m=Math.max(i[1],i[3]),p=(a-o)*(u-s),y=(d-l)*(m-h);if(p<=0||y<=0)return 0;var b=Math.max(o,l),x=Math.max(s,h),E=Math.min(a,d),T=Math.min(u,m),P=Math.max(E-b,0)*Math.max(T-x,0);return P/(p+y-P)}function $8(n,e,t){var r=Math.exp(e*t*t);return t<=n?r:0}function fS(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}function iT(n,e,t){var r=new Array(n.rank).fill(0),i=n.shape.slice();return e.map((function(o){i[t]=o;var s=n.slice(r,i);return r[t]+=o,s}))}function oT(n,e){for(var t=new Array(n.rank),r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];var i=wn(t,n.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),s=new Array(n.rank),a=0;a<s.length;a++)s[a]=o[a]%n.shape[a];var u=n.locToIndex(s);i.values[r]=n.values[u]}return i.toTensor()}function sT(n,e,t,r,i){for(var o=e[e.length-1],s=[n.length/o,o],a=s[0],u=s[1],l=wm(t,a*r),h=wm("int32",a*r),d=0;d<a;d++){for(var m=d*u,p=n.subarray(m,m+u),y=[],b=0;b<p.length;b++)y.push({value:p[b],index:b});y.sort((function(C,D){return D.value-C.value}));var x=d*r,E=l.subarray(x,x+r),T=h.subarray(x,x+r);for(b=0;b<r;b++)E[b]=y[b].value,T[b]=y[b].index}var P=e.slice();return P[P.length-1]=r,[Po(l,P,t),Po(h,P,"int32")]}function Qb(n,e){for(var t=[],r=0;r<e.length;r++)e[r]&&t.push(r);var i=wn(n,"int32"),o=wn([t.length,n.length],"int32");for(r=0;r<t.length;r++){var s=i.indexToLoc(t[r]),a=r*n.length;o.values.set(s,a)}return o.toTensor()}var K8=function(n,e){this.outputShape=[],this.outputShape=n,this.variableNames=e.map((function(i,o){return"T"+o}));var t=[];this.variableNames.forEach((function(i){t.push("float v"+i+" = get"+i+"AtOutCoords();")}));var r=this.variableNames.map((function(i){return"v"+i})).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},X8=function(n,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=e.map((function(i,o){return"T"+o}));var t=[];this.variableNames.forEach((function(i){t.push("vec4 v"+i+" = get"+i+"AtOutCoords();")}));var r=this.variableNames.map((function(i){return"v"+i})).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},Y8=function(n,e,t){this.variableNames=["A"];var r=n.windowSize,i=n.batchSize,o=n.inSize,s=Math.ceil(o/r);t||this.variableNames.push("bestIndicesA"),this.outputShape=[i,s];var a=e==="max"?">":"<",u=t?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+a+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function aT(n,e){return["x","y","z","w","u","v"].slice(0,e).map((function(t){return n+"."+t}))}function Ws(n,e){return e===1?[n]:aT(n,e)}function os(){var n,e,t,r,i,o,s,a,u,l;return Ye().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",i="texture",o="outputColor",s="out vec4 outputColor;",a=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",i="texture2D",o="gl_FragColor",s="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:i,output:o,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:u,defineRound:l}}function Zh(n,e,t){t===void 0&&(t="index");var r=ll(e);return r.map((function(i,o){return"int "+n[o]+" = "+t+" / "+i+"; "+(o===r.length-1?"int "+n[o+1]+" = "+t+" - "+n[o]+" * "+i:"index -= "+n[o]+" * "+i)+";"})).join("")}function Jb(n){var e=ll(n).map((function(t){return t.toString()}));return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var uT=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function Q8(n,e,t,r){var i=[];n.forEach((function(p){var y=Mt(p.shapeInfo.logicalShape);p.shapeInfo.isUniform?i.push("uniform float "+p.name+(y>1?"["+y+"]":"")+";"):(i.push("uniform sampler2D "+p.name+";"),i.push("uniform int offset"+p.name+";"))}));var o,s,a=i.join(`
`),u=n.map((function(p){return(function(y,b,x){x===void 0&&(x=!1);var E="";E+=x?lT(y):nd(y);var T=y.shapeInfo.logicalShape,P=b.logicalShape;return T.length<=P.length&&(E+=x?(function(C,D){var z,L=C.name,I=L.charAt(0).toUpperCase()+L.slice(1),A="get"+I+"AtOutCoords",O=C.shapeInfo.logicalShape.length,k=D.logicalShape.length,M=Hc(C.shapeInfo.logicalShape,D.logicalShape),j=Cr(k),X=k-O,ue=["x","y","z","w","u","v"];z=O===0?"":k<2&&M.length>=1?"coords = 0;":M.map((function(W){return"coords."+ue[W+X]+" = 0;"})).join(`
`);var ge="";ge=k<2&&O>0?"coords":C.shapeInfo.logicalShape.map((function(W,J){return"coords."+ue[J+X]})).join(", ");var ce="return outputValue;",$=Mt(C.shapeInfo.logicalShape)===1,ae=Mt(D.logicalShape)===1;if(O!==1||$||ae){if($&&!ae)ce=k===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(M.length){var fe=O-2,Q=O-1;M.indexOf(fe)>-1&&M.indexOf(Q)>-1?ce="return vec4(outputValue.x);":M.indexOf(fe)>-1?ce="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":M.indexOf(Q)>-1&&(ce="return vec4(outputValue.xx, outputValue.zz);")}}else ce=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+A+`() {
      `+j+` coords = getOutputCoords();
      `+z+`
      vec4 outputValue = get`+I+"("+ge+`);
      `+ce+`
    }
  `})(y,b):(function(C,D){var z=C.name,L=z.charAt(0).toUpperCase()+z.slice(1),I="get"+L+"AtOutCoords",A=D.texShape,O=C.shapeInfo.texShape,k=C.shapeInfo.logicalShape.length,M=D.logicalShape.length;if(!C.shapeInfo.isUniform&&k===M&&C.shapeInfo.flatOffset==null&&po(O,A))return`
      float `+I+`() {
        return sampleTexture(`+z+`, resultUV);
      }
    `;var j,X=Cr(M),ue=Hc(C.shapeInfo.logicalShape,D.logicalShape),ge=M-k,ce=["x","y","z","w","u","v"];j=k===0?"":M<2&&ue.length>=1?"coords = 0;":ue.map((function(ae){return"coords."+ce[ae+ge]+" = 0;"})).join(`
`);var $="";return $=M<2&&k>0?"coords":C.shapeInfo.logicalShape.map((function(ae,fe){return"coords."+ce[fe+ge]})).join(", "),`
    float `+I+`() {
      `+X+` coords = getOutputCoords();
      `+j+`
      return get`+L+"("+$+`);
    }
  `})(y,b)),E})(p,e,r)})).join(`
`),l=e.texShape,h=os(),d=(function(p){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+p.texture2D+`(textureSampler, uv).r;
    }
  `})(h),m=(function(p){return p.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+p.varyingFs+` vec2 resultUV;
    `+p.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+p.defineSpecialNaN+`
    `+p.defineSpecialInf+`
    `+p.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+J8+`
    `+Z8+`
    `+eB+`
  `})(h);return e.isPacked?(o=(function(p,y){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(C,D){var z=[Math.ceil(D[0]/2),Math.ceil(D[1]/2)];return z[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+z[1]+`.0);
      }
    `:z[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+z[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+z[0]+", "+z[1]+`));
      return 2 * (resTexRC.x * `+z[1]+` + resTexRC.y);
    }
  `})(0,y);case 2:return(function(C,D){var z=[Math.ceil(D[0]/2),Math.ceil(D[1]/2)];if(po(C,D))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+z[0]+", "+z[1]+`));
      }
    `;var L=Math.ceil(C[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+z[0]+", "+z[1]+`));

      int index = resTexRC.x * `+z[1]+` + resTexRC.y;
      int r = 2 * (index / `+L+`);
      int c = imod(index, `+L+`) * 2;

      return ivec2(r, c);
    }
  `})(p,y);case 3:return b=p,x=y,E=[Math.ceil(x[0]/2),Math.ceil(x[1]/2)],T=Math.ceil(b[2]/2),P=T*Math.ceil(b[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      int b = index / `+P+`;
      index -= b * `+P+`;

      int r = 2 * (index / `+T+`);
      int c = imod(index, `+T+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return(function(C,D){for(var z=[Math.ceil(D[0]/2),Math.ceil(D[1]/2)],L=Math.ceil(C[C.length-1]/2),I=L*Math.ceil(C[C.length-2]/2),A=I,O="",k="b, r, c",M=2;M<C.length-1;M++)A*=C[C.length-M-1],O=`
      int b`+M+" = index / "+A+`;
      index -= b`+M+" * "+A+`;
    `+O,k="b"+M+", "+k;return`
    ivec`+C.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+z[0]+", "+z[1]+`));
      int index = resTexRC.x * `+z[1]+` + resTexRC.y;

      `+O+`

      int b = index / `+I+`;
      index -= b * `+I+`;

      int r = 2 * (index / `+L+`);
      int c = imod(index, `+L+`) * 2;

      return ivec`+C.length+"("+k+`);
    }
  `})(p,y)}var b,x,E,T,P})(e.logicalShape,l),s=(function(p){return`
    void setOutput(vec4 val) {
      `+p.output+` = val;
    }
  `})(h)):(o=(function(p,y){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(E,T){return T[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+T[1]+`.0);
      }
    `:T[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+T[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+T[0]+", "+T[1]+`));
      return resTexRC.x * `+T[1]+` + resTexRC.y;
    }
  `})(0,y);case 2:return(function(E,T){return po(E,T)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+T[0]+", "+T[1]+`));
      }
    `:E[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+T[0]+", "+T[1]+`));
        int index = resTexRC.x * `+T[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:E[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+T[0]+", "+T[1]+`));
        int index = resTexRC.x * `+T[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+T[0]+", "+T[1]+`));
      int index = resTexRC.x * `+T[1]+` + resTexRC.y;
      int r = index / `+E[1]+`;
      int c = index - r * `+E[1]+`;
      return ivec2(r, c);
    }
  `})(p,y);case 3:return b=y,x=Zh(["r","c","d"],p),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+b[0]+", "+b[1]+`));
      int index = resTexRC.x * `+b[1]+` + resTexRC.y;
      `+x+`
      return ivec3(r, c, d);
    }
  `;case 4:return(function(E,T){var P=Zh(["r","c","d","d2"],E);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+T[0]+", "+T[1]+`));
      int index = resTexRC.x * `+T[1]+` + resTexRC.y;
      `+P+`
      return ivec4(r, c, d, d2);
    }
  `})(p,y);case 5:return(function(E,T){var P=Zh(["r","c","d","d2","d3"],E);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+T[0]+`,
                             `+T[1]+`));

      int index = resTexRC.x * `+T[1]+` + resTexRC.y;

      `+P+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `})(p,y);case 6:return(function(E,T){var P=Zh(["r","c","d","d2","d3","d4"],E);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+T[0]+", "+T[1]+`));
      int index = resTexRC.x * `+T[1]+` + resTexRC.y;

      `+P+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `})(p,y);default:throw new Error(p.length+"-D output sampling is not yet supported")}var b,x})(e.logicalShape,l),s=(function(p){return`
    void setOutput(float val) {
      `+p.output+` = vec4(val, 0, 0, 0);
    }
  `})(h)),r&&(m+=tB),[m,d,s,a,o,u,t].join(`
`)}function nd(n){var e=n.shapeInfo.logicalShape;switch(e.length){case 0:return(function(t){var r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var o=t.shapeInfo.texShape,s=o[0],a=o[1];if(s===1&&a===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=t.shapeInfo.texShape,l=u[0],h=u[1],d=Wh(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+l+", "+h+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `})(n);case 1:return(function(t){var r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+Xf(t)+`
      }
    `;var o=t.shapeInfo.texShape,s=o[0],a=o[1];if(a===1&&s===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Wh(r);return a===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+s+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+a+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+s+", "+a+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `})(n);case 2:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=t.shapeInfo.texShape;if(s!=null&&po(r,s)){var a=s[0],u=s[1];return`
    float `+o+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+a+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var l=Yh(r),h=l.newShape,d=l.keptDims,m=h;if(m.length<r.length){var p=rd(t,m);return`
      `+nd(p)+`
      float `+o+`(int row, int col) {
        return `+o+"("+id(["row","col"],d)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Xf(t)+`
      }
    `;var y=s[0],b=s[1],x=Wh(i);return b===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+x+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+y+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:y===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+x+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+b+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+o+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+x+`;
    vec2 uv = uvFromFlat(`+y+", "+b+`, index);
    return sampleTexture(`+i+`, uv);
  }
`})(n);case 3:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=r[1]*r[2],a=r[2],u=Yh(r),l=u.newShape,h=u.keptDims,d=l;if(d.length<r.length){var m=rd(t,d);return`
        `+nd(m)+`
        float `+o+`(int row, int col, int depth) {
          return `+o+"("+id(["row","col","depth"],h)+`);
        }
      `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+s+", "+a+`, 1)));
        `+Xf(t)+`
      }
    `;var p=t.shapeInfo.texShape,y=p[0],b=p[1],x=t.shapeInfo.flatOffset;if(b===s&&x==null)return`
        float `+o+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+a+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+b+".0, "+y+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(b===a&&x==null)return`
    float `+o+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+b+".0, "+y+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var E=Wh(i);return`
      float `+o+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+s+" + col * "+a+" + depth + "+E+`;
        vec2 uv = uvFromFlat(`+y+", "+b+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `})(n);case 4:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=r[3],a=r[2]*s,u=r[1]*a,l=Yh(r),h=l.newShape,d=l.keptDims;if(h.length<r.length){var m=rd(t,h);return`
      `+nd(m)+`
      float `+o+`(int row, int col, int depth, int depth2) {
        return `+o+"("+id(["row","col","depth","depth2"],d)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+a+", "+s+`, 1)));
        `+Xf(t)+`
      }
    `;var p=t.shapeInfo.flatOffset,y=t.shapeInfo.texShape,b=y[0],x=y[1];if(x===u&&p==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+a+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+b+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(x===s&&p==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+b+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var E=Wh(i);return`
    float `+o+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+a+` +
          depth * `+s+` + depth2;
      vec2 uv = uvFromFlat(`+b+", "+x+", index + "+E+`);
      return sampleTexture(`+i+`, uv);
    }
  `})(n);case 5:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=r[4],a=r[3]*s,u=r[2]*a,l=r[1]*u,h=Yh(r),d=h.newShape,m=h.keptDims;if(d.length<r.length){var p=rd(t,d);return`
      `+nd(p)+`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        return `+o+"("+id(["row","col","depth","depth2","depth3"],m)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+a+", "+s+`)) +
          depth3;
        `+Xf(t)+`
      }
    `;var y=t.shapeInfo.flatOffset,b=t.shapeInfo.texShape,x=b[0],E=b[1];if(E===l&&y==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+a+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+E+".0, "+x+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(E===s&&y==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+E+".0, "+x+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var T=Wh(i);return`
    float `+o+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+a+` +
          depth2 * `+s+" + depth3 + "+T+`;
      vec2 uv = uvFromFlat(`+x+", "+E+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `})(n);case 6:return(function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),s=Yh(r),a=s.newShape,u=s.keptDims;if(a.length<r.length){var l=rd(t,a);return`
      `+nd(l)+`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+o+"("+id(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var h=r[5],d=r[4]*h,m=r[3]*d,p=r[2]*m,y=r[1]*p;if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+y+", "+p+", "+m+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+h+`, 1)));
        `+Xf(t)+`
      }
    `;var b=t.shapeInfo.flatOffset,x=t.shapeInfo.texShape,E=x[0],T=x[1];if(T===y&&b==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+p+", "+m+", "+d+", "+h+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+T+".0, "+E+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(T===h&&b==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+T+".0, "+E+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var P=Wh(i);return`
    float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+y+" + col * "+p+" + depth * "+m+` +
          depth2 * `+d+" + depth3 * "+h+" + depth4 + "+P+`;
      vec2 uv = uvFromFlat(`+E+", "+T+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `})(n);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function lT(n){var e,t,r;switch(n.shapeInfo.logicalShape.length){case 0:return e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=os(),`
    vec4 `+t+`() {
      return `+r.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return(function(i){var o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),a=i.shapeInfo.texShape,u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=os();return`
    vec4 `+s+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+o+`, uv);
    }
  `})(n);case 2:return(function(i){var o=i.shapeInfo.logicalShape,s=i.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),u=i.shapeInfo.texShape,l=u[0],h=u[1],d=os();if(u!=null&&po(o,u))return`
      vec4 `+a+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+h+".0, "+l+`.0);

        return `+d.texture2D+"("+s+`, uv);
      }
    `;var m=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],p=Math.ceil(o[1]/2);return`
    vec4 `+a+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+p+", "+m[0]+", "+m[1]+`, row, col);
      return `+d.texture2D+"("+s+`, uv);
    }
  `})(n);case 3:return(function(i){var o=i.shapeInfo.logicalShape,s=i.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),u=i.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(o[0]===1){var h=o.slice(1),d=rd(i,h);return`
        `+lT(d)+`
        vec4 `+a+`(int b, int row, int col) {
          return `+a+"("+id(["b","row","col"],[1,2])+`);
        }
      `}var m=l[0],p=l[1],y=Math.ceil(o[2]/2),b=y*Math.ceil(o[1]/2),x=os();return`
    vec4 `+a+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+m+", "+p+", "+b+", "+y+`, b, row, col);
      return `+x.texture2D+"("+s+`, uv);
    }
  `})(n);default:return(function(i){for(var o=i.shapeInfo.logicalShape,s=o.length,a=i.name,u="get"+a.charAt(0).toUpperCase()+a.slice(1),l=i.shapeInfo.texShape,h=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=h[0],m=h[1],p=Math.ceil(o[s-1]/2),y=p*Math.ceil(o[s-2]/2),b="int b, int row, int col",x="b * "+y+" + (row / 2) * "+p+" + (col / 2)",E=2;E<s-1;E++)b="int b"+E+", "+b,y*=o[s-E-1],x="b"+E+" * "+y+" + "+x;var T=os();return`
    vec4 `+u+"("+b+`) {
      int index = `+x+`;
      int texR = index / `+m+`;
      int texC = index - texR * `+m+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+", "+d+`);
      return `+T.texture2D+"("+a+`, uv);
    }
  `})(n)}}var J8=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Z8=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,eB=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,tB=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Wh(n){return"offset"+n}function Xf(n){var e=n.name,t=Mt(n.shapeInfo.logicalShape);return t<2?"return "+e+";":`
    for (int i = 0; i < `+t+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function Cr(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error("GPU for rank "+n+" is not yet supported")}function rd(n,e){var t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function id(n,e){return e.map((function(t){return n[t]})).join(", ")}var nB=function(n,e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,me(n.length>2,(function(){return"Packed arg"+(t.charAt(0).toUpperCase()+t.slice(1))+" supports only inputs with rank above 2."}));var i=n[n.length-1],o=Math.ceil(i/e);this.outputShape=n.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");var s,a,u=this.outputShape,l=u.length,h=Cr(l),d=Ws("coords",l);if(o===1){var m=Cr(a=l+1);s=`
        `+m+" sourceLocR = "+m+"("+d.join()+`, 0);
        ++`+d[l-1]+`;
        `+m+" sourceLocG = "+m+"("+d.join()+`, 0);
        ++`+d[l-2]+`;
        `+m+" sourceLocA = "+m+"("+d.join()+`, 0);
        --`+d[l-1]+`;
        `+m+" sourceLocB = "+m+"("+d.join()+`, 0);
        --`+d[l-2]+";"}else a=l,s=`
        `+h+` sourceLocR = coords;
        ++`+d[l-1]+`;
        `+h+` sourceLocG = coords;
        ++`+d[l-2]+`;
        `+h+` sourceLocA = coords;
        --`+d[l-1]+`;
        `+h+` sourceLocB = coords;
        --`+d[l-2]+";";var p=["x","y","z","w","u","v"].slice(0,a),y="."+p[a-1],b=p.map((function(I){return"int "+I})),x=Ws("sourceLocR",a-1).concat("inIdx.r"),E=Ws("sourceLocG",a-1).concat("inIdx.g"),T=Ws("sourceLocB",a-1).concat("inIdx.b"),P=Ws("sourceLocA",a-1).concat("inIdx.a"),C=t==="max"?"greaterThan":"lessThan",D=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+E.join()+`),
                             getBestIndicesAChannel(`+T.join()+`),
                             getBestIndicesAChannel(`+P.join()+")));",z=`vec4(
            getAChannel(`+x.join()+`),
            hasNextCol ? getAChannel(`+E.join()+`) : 0.,
            hasNextRow ? getAChannel(`+T.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+P.join()+") : 0.)",L=r?"":`
      float getBestIndicesAChannel(`+b.join()+`) {
        return getChannel(getBestIndicesA(`+p.join()+`),
                                          vec2(`+p.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+b.join()+`) {
        return getChannel(getA(`+p.join()+`),
                               vec2(`+p.slice(-2).join()+`));
      }
      `+L+`
      void main() {
        `+h+` coords = getOutputCoords();
        bool hasNextCol = `+d[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+d[l-2]+" < "+(u[l-2]-1)+`;
        `+s+`
        ivec4 srcIdx = ivec4(sourceLocR`+y+", sourceLocG"+y+`,
          sourceLocB`+y+", sourceLocA"+y+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+z+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+D+`
          vec4 candidate = `+z+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+C+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},rB=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=n.dilationHeight,s=n.dilationWidth,a=n.effectiveFilterHeight,u=n.effectiveFilterWidth,l=a-1-n.padInfo.top,h=u-1-n.padInfo.left,d=1/(e*t);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+h+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
            wR += `+o+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+s+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},iB=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var e=n.filterDepth,t=n.filterHeight,r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,h=n.effectiveFilterDepth,d=n.effectiveFilterHeight,m=n.effectiveFilterWidth,p=h-1-n.padInfo.front,y=d-1-n.padInfo.top,b=m-1-n.padInfo.left,x=1/(e*t*r);this.userCode=`
      const ivec3 pads = ivec3(`+p+", "+y+", "+b+`);
      const float avgMultiplier = float(`+x+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+h+`;
            wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+m+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},oB=function(n,e,t,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Mn(n,e),Mn(n,t);var s="0.0";r!=null&&(Mn(n,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="1.0";i!=null&&(Mn(n,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+s+`;
        float scale = `+a+`;
        float inv = scale * inversesqrt(variance + float(`+o+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},sB=function(n,e,t,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Mn(n,e),Mn(n,t);var s="vec4(0.0)";r!=null&&(Mn(n,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="vec4(1.0)";i!=null&&(Mn(n,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        vec4 offset = `+s+`;
        vec4 scale = `+a+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+o+`));

        setOutput((x - mean) * inv + offset);
      }
    `},aB="return areal * breal - aimag * bimag;",uB="return areal * bimag + aimag * breal;",dS=function(n,e,t){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Mn(e,t),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+n+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},By="return a + b;",Vy="return a - b;",pS="return a * b;",cT="return (a < 0.) ? b * a : a;",ii=function(n,e,t){this.variableNames=["A","B"],this.outputShape=Mn(e,t),this.userCode=`
      float binaryOperation(float a, float b) {
        `+n+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},hT=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Gl=function(n,e,t,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Mn(e,t);var i=this.outputShape.length,o="";if(r)if(i===0||Mt(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          `+Cr(i)+` coords = getOutputCoords();
        `,i===1)o+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var s=Ws("coords",i);o+=`
            bool nextRowOutOfBounds =
              (`+s[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+s[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+n+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+o+`

        setOutput(result);
      }
    `},lB=(function(){function n(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return n.prototype.getCustomSetupFunc=function(e,t){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,e),i.gl.uniform1f(r.maxLoc,t)}},n})(),cB=(function(){function n(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return n.prototype.getCustomSetupFunc=function(e,t){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,e),i.gl.uniform1f(r.maxLoc,t)}},n})(),hB=function(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},fB=function(n){this.outputShape=[],this.outputShape=Wd(n,1),this.variableNames=n.map((function(a,u){return"T"+u}));var e=new Array(n.length-1);e[0]=n[0][1];for(var t=1;t<e.length;t++)e[t]=e[t-1]+n[t][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(t=1;t<e.length;t++){var i=e[t-1];r.push("else if (yC < "+e[t]+") setOutput(getT"+t+"(yR, yC-"+i+"));")}var o=e.length,s=e[e.length-1];r.push("else setOutput(getT"+o+"(yR, yC-"+s+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},dB=function(n,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Wd(n,e);var t=this.outputShape,r=t.length,i=Cr(r),o=Ws("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=n.map((function(x,E){return"T"+E}));var a=new Array(n.length-1);a[0]=n[0][e];for(var u=1;u<a.length;u++)a[u]=a[u-1]+n[u][e];var l=s[e],h=s.slice(-2),d=s.join(),m="if ("+l+" < "+a[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+h.join()+`));
        }`;for(u=1;u<a.length;u++){var p=a[u-1];m+=`
        if (`+l+" < "+a[u]+"  && "+l+" >= "+a[u-1]+`) {
          return getChannel(
            getT`+u+"("+Jg(s,l,p)+`),
            vec2(`+Jg(h,l,p)+`));
        }`}var y=a.length,b=a[a.length-1];m+=`
        return getChannel(
          getT`+y+"("+Jg(s,l,b)+`),
          vec2(`+Jg(h,l,b)+"));",this.userCode=`
      float getValue(`+s.map((function(x){return"int "+x}))+`) {
        `+m+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+o+`), 0., 0., 0.);

        `+o[r-1]+" = "+o[r-1]+` + 1;
        if (`+o[r-1]+" < "+t[r-1]+`) {
          result.g = getValue(`+o+`);
        }

        `+o[r-2]+" = "+o[r-2]+` + 1;
        if (`+o[r-2]+" < "+t[r-2]+`) {
          result.a = getValue(`+o+`);
        }

        `+o[r-1]+" = "+o[r-1]+` - 1;
        if (`+o[r-2]+" < "+t[r-2]+` &&
            `+o[r-1]+" < "+t[r-1]+`) {
          result.b = getValue(`+o+`);
        }
        setOutput(result);
      }
    `};function Jg(n,e,t){var r=n.indexOf(e);return n.map((function(i,o){return o===r?i+" - "+t:i})).join()}var pB=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideHeight,t=n.strideWidth,r=n.padInfo.top,i=n.padInfo.left,o=n.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+i+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              if (`+o+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},mB=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=n.dataFormat==="channelsLast",s=e-1-n.padInfo.top,a=t-1-n.padInfo.left,u=o?1:2,l=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+h+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {

              if (`+o+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},gB=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideDepth,t=n.strideHeight,r=n.strideWidth,i=n.padInfo.front,o=n.padInfo.top,s=n.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yF = 0; yF < `+n.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+i+`;

            if (xF < 0 || xF >= `+n.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+n.outHeight+`; yR++) {
              int xR = wR + yR * `+t+" - "+o+`;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+n.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+s+`;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},vB=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterDepth,t=n.filterHeight,r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=e-1-n.padInfo.front,u=t-1-n.padInfo.top,l=r-1-n.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+a+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+n.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+t+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+t+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},yB=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideHeight,t=n.strideWidth,r=n.padInfo.top,i=n.padInfo.left,o=n.outChannels/n.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+o+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+i+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},wB=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=e-1-n.padInfo.top,s=t-1-n.padInfo.left,a=n.outChannels/n.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+a+`; dm++) {
              int d2 = d1 * `+a+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},mS=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var i=n.padInfo.top,o=n.padInfo.left,s=n.strideHeight,a=n.strideWidth,u=n.dilationHeight,l=n.dilationWidth,h=n.filterHeight,d=n.filterWidth,m=4*Math.floor(n.inChannels/4),p=n.inChannels%4,y=n.dataFormat==="channelsLast",b=y?1:2,x=y?2:3,E=y?3:1,T="",P="";t&&(T=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,P="result = activation(result);");var C=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+T+`

      const ivec2 strides = ivec2(`+s+", "+a+`);
      const ivec2 pads = ivec2(`+i+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+E+`];

        ivec2 xRCCorner =
            ivec2(coords[`+b+"], coords["+x+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+h+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+n.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+m+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+y+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(p===1)+`) {

              if (`+y+`) {
                dotProd +=
                    getX(batch, xR, xC, `+m+`) *
                    getW(wR, wC, `+m+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+m+`, xR, xC) *
                    getW(wR, wC, `+m+`, d2);
              }

            } else if (`+(p===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2)
              );

              if (`+y+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(p===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2),
                getW(wR, wC, `+m+` + 2, d2)
              );

              if (`+y+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1),
                  getX(batch, xR, xC, `+m+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC),
                  getX(batch, `+m+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+C+`
        `+P+`
        setOutput(result);
      }
    `},bB=function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var e=n.padInfo.front,t=n.padInfo.top,r=n.padInfo.left,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,h=n.filterDepth,d=n.filterHeight,m=n.filterWidth,p=4*Math.floor(n.inChannels/4),y=n.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+o+", "+s+`);
      const ivec3 pads = ivec3(`+e+", "+t+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+h+`; wF++) {
          int xF = xFCorner + wF * `+a+`;

          if (xF < 0 || xF >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+m+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+p+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(y===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+p+`) *
                  getW(wF, wR, wC, `+p+`, d2);
              } else if (`+(y===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(y===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1),
                  getX(batch, xF, xR, xC, `+p+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2),
                  getW(wF, wR, wC, `+p+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},gS=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var i=n.inHeight,o=n.inWidth,s=n.padInfo.top,a=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,h=n.dilationHeight,d=n.dilationWidth,m=n.filterHeight,p=n.filterWidth,y=n.outChannels/n.inChannels,b="",x="";t&&(b=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,x="result = activation(result);");var E=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+b+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+y+`;
        int q = d2 - d1 * `+y+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+m+`; wR++) {
          int xR = xRCorner + wR * `+h+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+o+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+E+`
        `+x+`
        setOutput(result);
      }
    `},vS=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.outShape;for(var i=n.inHeight,o=n.inWidth,s=n.padInfo.top,a=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,h=n.dilationHeight,d=n.dilationWidth,m=n.filterHeight,p=n.filterWidth,y=p,b="int xR; int xC; int xCOffset;",x=0;x<m;x++)for(var E=0;E<p;E++)b+=`
          vec4 xTexelR`+x+"C"+2*E+` = vec4(0.);
          vec4 wR`+x+"C"+E+` = vec4(0.);
          vec4 xR`+x+"C"+E+" = vec4(0.);";for(x=0;x<m;x++)for(var T=0;T<y;T++){if(b+=`
          xR = xRCorner + `+x*h+`;
          xC = xCCorner + `+(E=2*T)*d+`;
        `,l===1){if(E<p&&(b+=a%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    xTexelR`+x+"C"+E+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+x+"C"+E+" = vec4(previous.zw, xTexelR"+x+"C"+E+`.xy);
                } else {
                  xR`+x+"C"+E+" = vec4(0, 0, xTexelR"+x+"C"+E+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                xR`+x+"C"+E+" = xTexelR"+x+"C"+E+`;
              `,E+1<p)){var P=a%2==0?kI(d):d;d%2==0&&a%2==1||d%2!=0&&a%2!=1?(b+=`
                  xCOffset = xC + `+a%2+" + "+P+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(b+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+o+`) {
                      xTexelR`+x+"C"+E+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+x+"C"+E+` = vec4(0.);
                    }
                  `),b+=`
                  xR`+x+"C"+(E+1)+` = vec4(
                    xTexelR`+x+"C"+E+".zw, xTexelR"+x+"C"+(E+2)+`.xy);
                `):b+=`
                  xCOffset = xC + `+P+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+x+"C"+(E+1)+" = xTexelR"+x+"C"+(E+2)+`;
                `}}else E<p&&(b+=`
              if(xR >= 0 && xR < `+i+`) {
            `,a%2==1?(b+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+o+`) {
                  xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+x+"C"+(E+2)+` = vec4(0.);
                }

                xR`+x+"C"+E+` = vec4(
                  xTexelR`+x+"C"+E+".zw, xTexelR"+x+"C"+(E+2)+`.zw);
              `,E+1<p&&(b+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+o+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+x+"C"+(E+1)+" = vec4(xTexelR"+x+"C"+(E+2)+`.xy, final.xy);
                `)):(b+=`
                if(xC >= 0 && xC < `+o+`) {
                  xTexelR`+x+"C"+E+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+x+"C"+E+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+x+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+x+"C"+(E+2)+` = vec4(0.);
                }

                xR`+x+"C"+E+` = vec4(
                  xTexelR`+x+"C"+E+".xy, xTexelR"+x+"C"+(E+2)+`.xy);
              `,E+1<p&&(b+=`
                  xR`+x+"C"+(E+1)+` = vec4(
                    xTexelR`+x+"C"+E+".zw, xTexelR"+x+"C"+(E+2)+`.zw);
                `)),b+="}");E<p&&(b+=`
            vec4 wTexelR`+x+"C"+E+" = getW("+x+", "+E+`, d1, q);
            wR`+x+"C"+E+" = vec4(wTexelR"+x+"C"+E+".xz, wTexelR"+x+"C"+E+`.xz);
          `,E+1<p&&(b+=`
              vec4 wTexelR`+x+"C"+(E+1)+" = getW("+x+", "+(E+1)+`, d1, q);
              wR`+x+"C"+(E+1)+` =
                vec4(wTexelR`+x+"C"+(E+1)+".xz, wTexelR"+x+"C"+(E+1)+".xz);"))}for(x=0;x<m;x++)for(E=0;E<p;E++)b+="dotProd += xR"+x+"C"+E+" * wR"+x+"C"+E+";";var C="",D="";t&&(C=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`vec4 activation(vec4 x) {
          `+t+`
        }`,D="result = activation(result);");var z=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+C+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+b+`

        vec4 result = dotProd;
        `+z+`
        `+D+`
        setOutput(result);
      }
    `},xB=function(n,e,t,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=n[0],s=n[1],a=n[2],u=n[3],l=e[0],h=t[0],d=t[1];this.outputShape=[l,h,d,u];var m=r==="bilinear"?1:0,p=[s-1+".0",a-1+".0"],y=p[0],b=p[1],x=h>1?[""+(s-1)/(h-1),"(y2-y1) * height_ratio","y1*"+y+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+y],E=x[0],T=x[1],P=x[2],C=d>1?[""+(a-1)/(d-1),"(x2-x1) * width_ratio","x1*"+b+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+b],D=C[0],z=C[1],L=C[2];this.userCode=`
      const float height_ratio = float(`+E+`);
      const float width_ratio = float(`+D+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+o+`) {
          return;
        }

        float height_scale = `+T+`;
        float width_scale = `+z+`;

        float in_y = `+P+`;
        if( in_y < 0.0 || in_y > `+y+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+L+`;
        if( in_x < 0.0 || in_x > `+b+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+m+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},_B=function(n,e,t){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=n[n.length-1],o=t?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(t?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Cr(r)+` coords = getOutputCoords();
        int end = `+yS(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+o+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+yS(r,"coords")+` = idx;
          val += getX(`+(function(s,a){if(s===1)return""+a;if(s===2)return a+".x, "+a+".y";if(s===3)return a+".x, "+a+".y, "+a+".z";if(s===4)return a+".x, "+a+".y, "+a+".z, "+a+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")})(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function yS(n,e){if(n===1)return""+e;if(n===2)return e+".y";if(n===3)return e+".z";if(n===4)return e+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}var EB=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=xm.DENSE;var e=rm(n),t=os();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Zh(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+t.output+` = result;
      }
    `},SB=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=xm.DENSE;var e=rm(n),t=os();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Zh(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+t.output+` = result;
      }
    `},AB=(function(){function n(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+t+`;
      int offset_h = imod(h, `+t+`);
      int in_w = w / `+t+`;
      int offset_w = imod(w, `+t+`);
      int offset_d = (offset_h * `+t+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return n.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},n.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},n.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},n.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},n.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},n})(),CB=function(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},IB=function(n){this.variableNames=["A"],this.outTexUsage=da.DOWNLOAD;var e=os();this.outputShape=n,this.userCode=`
      `+uT+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `},TB=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=da.DOWNLOAD;var e=os();this.outputShape=n,this.userCode=`
      `+uT+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `},kB=function(n,e,t){t===void 0&&(t=!1),this.variableNames=["A"];var r=os(),i=e[0],o=e[1];this.outputShape=n;var s="result";t&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      `+Jb(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+o+`;
        int c = imod(flatIndex, `+o+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+s+`, 0., 0., 0.);
      }
    `},NB=function(n,e,t){t===void 0&&(t=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=os(),i=e[0],o=e[1];this.outputShape=n;var s="",a="result";t&&(a="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var h=2*u+l;s+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+n[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+n[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+o+`;
              c = imod(flatIndex, `+o+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+h+`] = values[0];
              } else if(offset == 1) {
                result[`+h+`] = values[1];
              } else if(offset == 2) {
                result[`+h+`] = values[2];
              } else {
                result[`+h+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Jb(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+s+`

        `+r.output+" = "+a+`;
      }
    `},RB="return real * expR - imag * expI;",PB="return real * expI + imag * expR;",wS=function(n,e,t){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=t?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=t?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+n+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+o+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},DB=(function(){function n(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;return function(r,i){t.valueLoc==null&&(t.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(t.valueLoc,e)}},n})(),LB=function(n,e,t){this.variableNames=["A","indices"];var r=n.slice();r[t]=e,this.outputShape=r,this.rank=r.length;var i=Cr(this.rank),o=(function(s,a){var u=s.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],h=[],d=0;d<s.length;d++)d===a?h.push("int(getIndices("+l[d]+"))"):h.push(""+l[d]);return h.join()})(n,t);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},MB=function(n,e,t){this.sliceDim=n,this.strides=e,this.variableNames=["x","indices"],this.outputShape=t;var r=Cr(e.length),i=Cr(t.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+o+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function OB(n,e){var t=os();return RF(n,e,t.version+`
    precision highp float;
    `+t.attribute+` vec3 clipSpacePos;
    `+t.attribute+` vec2 uv;
    `+t.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function FB(n,e){return OF(n,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function BB(n,e){return FF(n,e,new Uint16Array([0,1,2,2,1,3]))}function qm(n,e,t,r,i,o,s){VF(t,r);var a=BF(n,e),u=n.TEXTURE_2D;return Vt(n,e,(function(){return n.bindTexture(u,a)})),Vt(n,e,(function(){return n.texParameteri(u,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)})),Vt(n,e,(function(){return n.texParameteri(u,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)})),Vt(n,e,(function(){return n.texParameteri(u,n.TEXTURE_MIN_FILTER,n.NEAREST)})),Vt(n,e,(function(){return n.texParameteri(u,n.TEXTURE_MAG_FILTER,n.NEAREST)})),Vt(n,e,(function(){return n.texImage2D(u,0,i,t,r,0,o,s,null)})),Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,null)})),a}function VB(n,e,t,r,i){var o=W0(t,r);return qm(n,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,n.FLOAT)}function jB(n,e,t,r,i){var o=W0(t,r);return qm(n,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function UB(n,e,t,r,i){var o=W0(t,r);return qm(n,e,o[0],o[1],n.RGBA,n.RGBA,n.UNSIGNED_BYTE)}function zB(n,e,t,r,i){var o=Wm(t,r);return qm(n,e,o[0],o[1],i.internalFormatPackedFloat,n.RGBA,n.FLOAT)}function WB(n,e,t,r,i){var o=Wm(t,r);return qm(n,e,o[0],o[1],i.internalFormatPackedHalfFloat,n.RGBA,i.textureTypeHalfFloat)}function qB(n,e,t,r){return Vt(n,e,(function(){return n.bindBuffer(n.ARRAY_BUFFER,r)})),sS(n,e,t,"clipSpacePos",r,3,20,0)&&sS(n,e,t,"uv",r,2,20,12)}function HB(n,e,t,r,i,o,s){var a,u,l;Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,t)})),o instanceof Uint8Array?(a=new Uint8Array(r*i*4),u=n.UNSIGNED_BYTE,l=n.RGBA):(a=new Float32Array(r*i*4),u=n.FLOAT,l=s.internalFormatPackedFloat),a.set(o),Vt(n,e,(function(){return n.texImage2D(n.TEXTURE_2D,0,l,r,i,0,n.RGBA,u,a)})),Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,null)}))}function GB(n,e,t,r){Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,t)})),r.data instanceof Uint8Array?Vt(n,e,(function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r.width,r.height,0,n.RGBA,n.UNSIGNED_BYTE,r.data)})):Vt(n,e,(function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)})),Vt(n,e,(function(){return n.bindTexture(n.TEXTURE_2D,null)}))}function $B(n,e,t,r,i){var o=n.createBuffer();Vt(n,e,(function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,o)}));var s=16*t*r;return Vt(n,e,(function(){return n.bufferData(n.PIXEL_PACK_BUFFER,s,n.STREAM_READ)})),Vt(n,e,(function(){return n.readPixels(0,0,r,t,n.RGBA,n.FLOAT,0)})),Vt(n,e,(function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,null)})),o}function KB(n,e,t){var r=n,i=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function XB(n,e,t,r,i){var o=W0(t,r),s=o[0],a=o[1],u=new Uint8Array(t*r*4);return Vt(n,e,(function(){return n.readPixels(0,0,s,a,i.downloadTextureFormat,n.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function YB(n,e,t,r,i,o,s,a){var u=n,l=new Float32Array((function(h,d){var m=Wm(h,d);return m[0]*m[1]*4})(o,s));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function QB(n,e,t,r){var i=new Float32Array(t*r*4);return Vt(n,e,(function(){return n.readPixels(0,0,r,t,n.RGBA,n.FLOAT,i)})),i}var JB=(function(){function n(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=Ye().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,CF(t,e)):this.gl=vl(t);var r="WEBGL_color_buffer_float";if(Ye().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Kg(this.gl,this.debug,"OES_texture_float"),Ha(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Kg(this.gl,this.debug,"OES_texture_half_float");else if(Ye().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Ha(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Kg(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Ye().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Ha(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Ha(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=FB(this.gl,this.debug),this.indexBuffer=BB(this.gl,this.debug),this.framebuffer=jF(this.gl,this.debug),this.textureConfig=zb(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(n.prototype,"debug",{get:function(){return Ye().getBool("DEBUG")},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Vt(t,this.debug,(function(){return t.finish()})),Vt(t,this.debug,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Vt(t,this.debug,(function(){return t.deleteFramebuffer(e.framebuffer)})),Vt(t,this.debug,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),Vt(t,this.debug,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),Vt(t,this.debug,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},n.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),VB(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),jB(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),UB(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),GB(this.gl,this.debug,e,t)},n.prototype.uploadDenseMatrixToTexture=function(e,t,r,i){this.throwIfDisposed(),HB(this.gl,this.debug,e,t,r,i,this.textureConfig)},n.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),WB(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),zB(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(aS(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Vt(this.gl,this.debug,(function(){return t.gl.deleteTexture(e)}))},n.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,r){var i=this;return this.downloadMatrixDriver(e,(function(){return XB(i.gl,i.debug,t,r,i.textureConfig)}))},n.prototype.downloadPackedMatrixFromBuffer=function(e,t,r,i,o,s){return YB(this.gl,e,0,0,0,o,s,this.textureConfig)},n.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return KB(this.gl,e,t)},n.prototype.createBufferFromTexture=function(e,t,r){this.bindTextureToFrameBuffer(e);var i=$B(this.gl,this.debug,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},n.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},n.prototype.createFence=function(e){var t,r,i=this;if(Ye().getBool("WEBGL_FENCE_API_ENABLED")){var o=e,s=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=function(){var a=o.clientWaitSync(s,0,0);return a===o.ALREADY_SIGNALED||a===o.CONDITION_SATISFIED},t=s}else Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(t,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:t,isFencePassed:r}},n.prototype.downloadMatrixFromPackedTexture=function(e,t,r){var i=this;return this.downloadMatrixDriver(e,(function(){return QB(i.gl,i.debug,t,r)}))},n.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,r=PF(t,this.debug,e),i=OB(t,this.debug),o=LF(t,this.debug);return Vt(t,this.debug,(function(){return t.attachShader(o,i)})),Vt(t,this.debug,(function(){return t.attachShader(o,r)})),MF(t,this.debug,o),this.debug&&Ly(t,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=qB(t,this.debug,this.program,this.vertexBuffer)),o},n.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&Vt(this.gl,this.debug,(function(){return t.gl.deleteProgram(e)}))},n.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Ly(this.gl,this.debug,this.program),Vt(this.gl,this.debug,(function(){return t.gl.useProgram(e)}))},n.prototype.getUniformLocation=function(e,t,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?zF(this.gl,this.debug,e,t):WF(this.gl,e,t)},n.prototype.getAttributeLocation=function(e,t){var r=this;return this.throwIfDisposed(),Vt(this.gl,this.debug,(function(){return r.gl.getAttribLocation(e,t)}))},n.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},n.prototype.setInputMatrixTexture=function(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),qF(this.gl,this.debug,this.program,e,t,r)},n.prototype.setOutputMatrixTexture=function(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)},n.prototype.setOutputPackedMatrixTexture=function(e,t,r){this.throwIfDisposed();var i=Wm(t,r),o=i[0],s=i[1];this.setOutputMatrixTextureDriver(e,o,s)},n.prototype.setOutputMatrixWriteRegion=function(e,t,r,i){this.setOutputMatrixWriteRegionDriver(r,e,i,t)},n.prototype.setOutputPackedMatrixWriteRegion=function(e,t,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},n.prototype.debugValidate=function(){this.program!=null&&Ly(this.gl,this.debug,this.program),Xg(this.gl)},n.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),Vt(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},n.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),Vt(this.gl,this.debug,(function(){return e.gl.finish()}))},n.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Kg(this.gl,this.debug,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},n.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},n.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},n.prototype.beginQuery=function(){if(Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),r=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),o=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,o),o},n.prototype.endQuery=function(){if(Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT)}},n.prototype.waitForQueryAndGetTime=function(e){return Nt(this,void 0,void 0,(function(){var t=this;return Rt(this,(function(r){switch(r.label){case 0:return[4,eS((function(){return t.disposed||t.isQueryAvailable(e,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return r.sent(),[2,this.getQueryTime(e,Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},n.prototype.getQueryTime=function(e,t){if(t===0)return null;if(t===2){var r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(e,i.QUERY_RESULT_EXT)/1e6},n.prototype.isQueryAvailable=function(e,t){if(t===0)return!0;if(t===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint},n.prototype.pollFence=function(e){var t=this;return new Promise((function(r){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return r()}))}))},n.prototype.pollItems=function(){for(var e=(function(r){for(var i=0;i<r.length&&r[i]();++i);return i-1})(this.itemsToPoll.map((function(r){return r.isDoneFn}))),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},n.prototype.addItemToPoll=function(e,t){var r=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||eS((function(){return r.pollItems(),r.itemsToPoll.length===0}))},n.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),My(this.gl,this.debug,e,this.framebuffer),this.debug&&Xg(this.gl)},n.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(My(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Xg(this.gl)):aS(this.gl,this.debug,this.framebuffer)},n.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var r=t();return this.unbindTextureToFrameBuffer(),r},n.prototype.setOutputMatrixTextureDriver=function(e,t,r){this.throwIfDisposed();var i=this.gl;My(i,this.debug,e,this.framebuffer),this.debug&&Xg(i),this.outputTexture=e,Vt(i,this.debug,(function(){return i.viewport(0,0,t,r)})),Vt(i,this.debug,(function(){return i.scissor(0,0,t,r)}))},n.prototype.setOutputMatrixWriteRegionDriver=function(e,t,r,i){var o=this;this.throwIfDisposed(),Vt(this.gl,this.debug,(function(){return o.gl.scissor(e,t,r,i)}))},n.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},n.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},n})();function bS(n,e){if(n.length!==e.length)throw Error("Binary was compiled with "+n.length+" inputs, but was executed with "+e.length+" inputs");n.forEach((function(t,r){var i=t.logicalShape,o=e[r],s=o.shape;if(!po(i,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+s+" must match");if(!t.isUniform||!o.isUniform){var a=t.texShape,u=o.isUniform?null:o.texData.texShape;if(!po(a,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+u+" must match")}}))}var ZB=function(n,e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var r=t.filterWidth,i=t.inChannels,o=t.strideWidth,s=t.strideHeight,a=t.padInfo,u=t.outWidth,l=t.dilationWidth,h=t.dilationHeight,d=t.dataFormat,m=a.left,p=a.top,y=i*r,b=os(),x=d==="channelsLast",E=x?0:1,T=x?1:2,P="",C=0;C<=1;C++)for(var D=0;D<=1;D++)P+=`
          blockIndex = rc.y + `+D+`;
          pos = rc.x + `+C+`;

          if(blockIndex < `+n[1]+" && pos < "+n[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+s+" - "+p+`;
            d0 = offsetY + `+h+" * (pos / "+y+`);

            if(d0 < `+e[E]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+o+". - "+m+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+y+".) / "+i+`.));

              if(d1 < `+e[T]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+x+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*C+D)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*C+D)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+P+`

        `+b.output+` = result;
      }
    `},e7=function(n,e,t,r,i){this.variableNames=["x"],this.outputShape=[];var o,s=e,a=n[3]-1;this.outputShape=n;var u="float("+t+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+s+"; j <= "+s+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+a+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+o+`;
        setOutput(val);
      }
    `},t7=function(n,e,t,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=e,this.bias=t,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+t+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},n7=function(n,e,t,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=e,a=n[3]-1;this.outputShape=n;var u="float("+t+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+s+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+s+"; j <= "+s+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+a+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+o+`;
        setOutput(result);
      }
    `},r7=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var e=n.strideHeight,t=n.strideWidth,r=n.dilationHeight,i=n.effectiveFilterHeight,o=n.effectiveFilterWidth,s=i-1-n.padInfo.top,a=o-1-n.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+o+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+t+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+o+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},i7=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var e=n.strideDepth,t=n.strideHeight,r=n.strideWidth,i=n.dilationDepth,o=n.dilationHeight,s=n.dilationWidth,a=n.effectiveFilterDepth,u=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=a-1-n.padInfo.front,d=u-1-n.padInfo.top,m=l-1-n.padInfo.left,p=a*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+d+", "+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+a+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+o+`) {
            float dyR = float(dyRCorner + wR) / `+t+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+p+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},jy=function(n,e,t,r,i,o,s){t===void 0&&(t=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),o===void 0&&(o=null),s===void 0&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var a=t?n[1]:n[2],u=Math.ceil(a/2),l=t?"i * 2, rc.y":"rc.y, i * 2",h=r?"rc.z, i * 2":"i * 2, rc.z",d=t?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",y="";o&&(p=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+o+`
        }`:`vec4 activation(vec4 x) {
          `+o+`
        }`,y="result = activation(result);");var b=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+p+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+h+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+m[0]+`);
          result += (`+d[1]+" * "+m[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+b+`

        `+y+`

        setOutput(result);
      }
    `},o7=(function(){function n(e,t,r){this.variableNames=["probs"],this.outputShape=[e,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(t-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(t-1)+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;return function(r,i){t.seedLoc==null&&(t.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(t.seedLoc,e)}},n})(),s7=function(n,e,t,r){this.variableNames=["indices"],this.outputShape=[n,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+t+`),
                      float(index == coords.y)));
      }
    `},a7=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n;var e=n.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var t=Ws("rc",e),r=Cr(e),i=(function(a,u,l){if(a===1)return"rc > "+u[0];for(var h="",d=a-2;d<a;d++)h+=l[d]+" >= "+u[d],d<a-1&&(h+="||");return h})(e,n,t),o=(function(a,u,l,h){if(a===1)return"";var d=h.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `})(e,n[n.length-1],n[n.length-2],t),s=(function(a,u){var l=a.length,h=(function(d,m){for(var p=[],y=0;y<=1;y++)for(var b=0;b<=1;b++){for(var x=(y===0?"r":"rp1")+", "+(b===0?"c":"cp1"),E=2;E<d;E++)x=m[m.length-1-E]+","+x;p.push(x)}return p})(l,u);return l===1?`getA(rc),
            rc + 1 >= `+a[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+h[0]+`),
          cEdge ? 0. : getA(`+h[1]+`),
          rEdge ? 0. : getA(`+h[2]+`),
          rEdge || cEdge ? 0. : getA(`+h[3]+")"})(n,t);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+o+`

            setOutput(vec4(`+s+`));
          }
        }
      `}},u7=function(n,e,t){this.variableNames=["x"],this.outputShape=e.map((function(u,l){return u[0]+n[l]+u[1]}));var r=n.length,i=Cr(r),o=e.map((function(u){return u[0]})).join(","),s=e.map((function(u,l){return u[0]+n[l]})).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+o+`);
      `+i+" end = "+i+"("+s+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+t+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+a+`));
        }
      }
    `:`
        int start = `+o+`;
        int end = `+s+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+t+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},l7=function(n,e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(x,E){return x[0]+n[E]+x[1]}));for(var r=n.length,i=Cr(r),o=e.map((function(x){return x[0]})).join(","),s=e.map((function(x,E){return x[0]+n[E]})).join(","),a=Ws("rc",r),u=Ws("source",r),l=a[r-1]+" < "+this.outputShape[r-1],h=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[i+" rc = outputLoc;",a[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+a[r-2]+` += 1;
       if(`+a[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+a[r-1]+` += 1;
         if(`+l+") {"],m=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",y=0,b=r===1?2:4;y<b;y++)p+=`
        `+d[y]+`
        if (`+m+`) {
          result[`+y+"] = float("+t+`);
        } else {
          `+i+` source = rc - start;
          result[`+y+"] = getChannel(getX("+u.join()+"), "+h+`);
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+o+`);
      const `+i+" end = "+i+"("+s+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+p+`
        setOutput(result);
      }
    `},Uy=function(n,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,i=n.strideHeight,o=n.strideWidth,s=n.dilationHeight,a=n.dilationWidth,u=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=n.padInfo.top,d=n.padInfo.left;this.outputShape=n.outShape;var m=e==="avg",p="0.0";if(m||(p="-1.0 / 1e-20"),t)this.userCode=`
        const ivec2 strides = ivec2(`+i+", "+o+`);
        const ivec2 pads = ivec2(`+h+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+s+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(y="avgValue / count");var b=4*Math.floor(r/4),x=r%4,E=`
      if (`+m+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+i+", "+o+`);
      const ivec2 pads = ivec2(`+h+", "+d+`);
      const float initializationValue = `+p+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+p+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+s+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+a+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              getValue(batch, xR, xC + 2 * `+a+`, d),
              getValue(batch, xR, xC + 3 * `+a+`, d)
            );

            `+E+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(x===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+E+`
          } else if (`+(x===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              initializationValue,
              initializationValue
            );

            `+E+`
          } else if (`+(x===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              getValue(batch, xR, xC + 2 * `+a+`, d),
              initializationValue
            );

            `+E+`
          }
        }
        setOutput(`+y+`);
      }
    `}},zy=function(n,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,h=n.effectiveFilterDepth,d=n.effectiveFilterHeight,m=n.effectiveFilterWidth,p=n.padInfo.front,y=n.padInfo.top,b=n.padInfo.left;this.outputShape=n.outShape;var x=e==="avg",E="0.0";if(x||(E="-1.0 / 1e-20"),t)this.userCode=`
        const ivec3 strides =
            ivec3(`+i+", "+o+", "+s+`);
        const ivec3 pads = ivec3(`+p+", "+y+", "+b+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+h+`;
              wD += `+a+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+n.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+m+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+m+` +
                      wR * `+m+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var T=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(T="avgValue / count");var P=4*Math.floor(r/4),C=r%4,D=`
      if (`+x+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+i+", "+o+", "+s+`);
      const ivec3 pads = ivec3(`+p+", "+y+", "+b+`);
      const float initializationValue = `+E+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+E+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+h+`;
            wD += `+a+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+P+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+D+`
            }

            int xC = xCCorner + `+P+`;
            if (`+(C===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+D+`
            } else if (`+(C===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+D+`
            } else if (`+(C===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+D+`
            }
          }
          setOutput(`+T+`);
        }
      }
    `}},c7=function(n,e){this.variableNames=["x"];var t=n.windowSize,r=n.batchSize,i=n.inSize,o=Math.ceil(i/t);this.outputShape=[r,o];var s="0.0",a="";e==="prod"?s="1.0":e==="min"?(s="1.0 / 1e-20",a="min"):e==="max"&&(s="-1.0 / 1e-20",a="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?u="sumValue":e==="prod"?u="prodValue":e==="all"?u="allValue":e==="any"&&(u="anyValue");var l=4*Math.floor(t/4),h=t%4,d=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+a+`(values, minMaxValue);
      }
    `,m="vec4";e==="all"?(s="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):e==="any"&&(s="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");var p="";i%t>0&&(p=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+s+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+p+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+t+`;

        vec4 minMaxValue = vec4(`+s+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(h===1)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(h===2)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(h===3)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},h7=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var t="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),t+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Zh(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+Jb(n)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+n[1]+`;
        int cols = `+n[2]+`;

        `+t+`

        setOutput(result);
      }
    `},f7=function(n,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=n.shape,a=s[1],u=s[2],l=[t&&a>1?i-1:i,t&&u>1?o-1:o],h=[t&&a>1?a-1:a,t&&u>1?u-1:u],d=l[0]/h[0],m=l[1]/h[1],p=1/d,y=1/m,b=2*Math.ceil(p)+2,x=2*Math.ceil(y)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+y+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+x+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+a+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(o-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},d7=function(n,e,t,r){this.variableNames=["A"],this.outputShape=[];var i=n[0],o=n[1],s=n[2],a=n[3];this.outputShape=[i,e,t,a];var u=[r&&e>1?o-1:o,r&&t>1?s-1:s],l=[r&&e>1?e-1:e,r&&t>1?t-1:t];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},p7=function(n,e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=n[0],o=n[1],s=n[2],a=n[3];this.outputShape=[i,e,t,a];var u=[r&&e>1?o-1:o,r&&t>1?s-1:s],l=[r&&e>1?e-1:e,r&&t>1?t-1:t];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+o+".0, "+s+`.0,
                                     `+s+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(a-1)+`;
        bool hasNextRow = coords.z < `+(t-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},m7=function(n,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=n.shape,a=s[1],u=s[2],l=[t&&a>1?i-1:i,t&&u>1?o-1:o],h=[t&&a>1?a-1:a,t&&u>1?u-1:u],d=l[0]/h[0],m=l[1]/h[1],p=1/d,y=1/m,b=2*Math.ceil(p)+2,x=2*Math.ceil(y)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+y+`);

        const int winHeight = int(`+b+`);
        const int winWidth = int(`+x+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+a+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+h[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+h[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+t+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+o+`) - 1),
                `+t+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},g7=function(n,e,t,r){this.variableNames=["A"],this.outputShape=[];var i=n[0],o=n[1],s=n[2],a=n[3];this.outputShape=[i,e,t,a];var u=[r&&e>1?o-1:o,r&&t>1?s-1:s],l=[r&&e>1?e-1:e,r&&t>1?t-1:t],h=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+h+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},v7=function(n,e){this.variableNames=["x"];var t=n.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");if(this.outputShape=n,t!==1){var r=n.map((function(o,s){return(function(a){return e.indexOf(a)!==-1&&n[a]!==1?n[a]+" - coords["+a+"] - 1":"coords["+a+"]"})(s)})).join(","),i=Cr(t);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+n[0]+` - coord - 1));
        }
      `},y7=function(n,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var t=n.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");this.outputShape=n;var r=Ws("rc",t),i=r[t-1]+" + 1 < "+this.outputShape[t-1],o=r[t-2]+" + 1 < "+this.outputShape[t-2],s=Cr(t);function a(u){var l=n.map((function(h,d){return(function(m,p){return e.indexOf(m)!==-1&&n[m]!==1?n[m]+" - "+p[m]+" - 1":""+p[m]})(d,u)}));return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=t===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+n[0]+` - rc - 1),
            `+n[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+n[0]+` - (rc  + 1) - 1),
                `+n[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+s+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+(function(u){return a(u)})(r.slice())+`;
          if(`+i+`){
            result.g = `+(function(u){return u[t-1]="("+u[t-1]+" + 1)",a(u)})(r.slice())+`;
          }
          if(`+o+`) {
            result.b = `+(function(u){return u[t-2]="("+u[t-2]+" + 1)",a(u)})(r.slice())+`;
            if(`+i+`) {
              result.a = `+(function(u){return u[t-1]="("+u[t-1]+" + 1)",u[t-2]="("+u[t-2]+" + 1)",a(u)})(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},xS=function(n,e,t,r,i,o,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var a=Cr(i.length),u=Cr(o.length),l="";t===1?l="i":t===2&&(l="i, j");var h="getIndices("+l+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var m="getUpdates("+d+")",p=e>1?"strides[j]":"strides";this.userCode=`
        `+a+" strides = "+a+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+n+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+h+`);
              flattenedIndex += index * `+p+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+m+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},w7=function(n,e){this.variableNames=["x","segmentIds"];var t=n.windowSize,r=n.batchSize,i=n.inSize,o=n.numSegments,s=o*Math.ceil(i/t);this.outputShape=[r,s];var a=4*Math.floor(t/4),u=t%4,l=`
        sumValue += dot(values, segFilter);
    `,h="";i%t>0&&(h=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var d="";i%t>0&&(d=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+o+")) * float("+t+`));
        int currentSeg = int(mod(float(outIdx), float(`+o+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+a+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+a+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},b7=function(n,e,t){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,t>4)throw Error("Where for rank "+t+" is not yet supported");if(t===1)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],a=[],u=0;u<e.length;u++)a.push(""+o[u]),u<n&&s.push(""+o[u]);r=s.join(),i=a.join()}var l=Cr(t);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `},x7=(function(){function n(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,r=Cr(this.rank),i="uniform int start["+this.rank+"];",o=(function(s){if(s===1)return"sourceLoc";if(s<=6)return Wy.slice(0,s).map((function(a){return"sourceLoc."+a})).join(",");throw Error("Slicing for rank "+s+" is not yet supported")})(this.rank);t=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+e.map((function(s,a){return"sourceLoc."+Wy[a]+" = start["+a+"] + coords."+Wy[a]+";"})).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+t+`
        setOutput(getSource(`+o+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,i){t.startLoc==null&&(t.startLoc=r.getUniformLocationNoThrow(i,"start"),t.startLoc==null)||r.gl.uniform1iv(t.startLoc,e)}},n})(),Wy=["x","y","z","w","u","v"],_7=(function(){function n(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=Cr(this.rank),r=Ws("coords",this.rank),i=Ws("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",s="getChannel(getSource("+i.join()+"), "+o+")",a=`
      result.x = `+s+`;
      if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+s+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+s+`;
        if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+s+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+t+"("+e.map((function(h,d){return"start["+d+"]"})).join()+");":e.map((function(h,d){return i[d]+" = "+r[d]+" + start["+d+"];"})).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+t+` coords = getOutputCoords();
        `+t+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+a+`
        `+u+`
        setOutput(result);
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,i){t.startLoc==null&&(t.startLoc=r.getUniformLocationNoThrow(i,"start"),t.startLoc==null)||r.gl.uniform1iv(t.startLoc,e)}},n})(),E7=function(n,e,t){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=Cr(t.length),o=Cr(t.length),s="";if(r===1)s="coords * strides + begin";else{var a=0;s=t.map((function(u,l){return a++,t.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(a-1)+"] * strides["+l+"] + begin["+l+"]"})).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+n+`);
      `+i+" strides = "+i+"("+e+`);

      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+s+`));
      }
    `},S7=(function(){function n(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return n.prototype.acquireTexture=function(e,t,r){var i,o=_S(t,r),s=ES(e,o,r);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[s].shift();return this.usedTextures[s].push(a),a}return this.numUsedTextures++,this.log(),o===fa.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===fa.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===fa.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===fa.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===fa.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[s].push(i),i},n.prototype.releaseTexture=function(e,t,r,i){if(this.freeTextures!=null){var o=ES(t,_S(r,i),i);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(e),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[o],a=s.indexOf(e);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(a,1),this.log()}},n.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},n.prototype.getNumUsedTextures=function(){return this.numUsedTextures},n.prototype.getNumFreeTextures=function(){return this.numFreeTextures},n.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(r){e.gpgpu.deleteMatrixTexture(r)}));for(var t in this.usedTextures)this.usedTextures[t].forEach((function(i){e.gpgpu.deleteMatrixTexture(i)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},n})();function _S(n,e){if(n===da.UPLOAD)return fa.PACKED_2X2_FLOAT32;if(n===da.RENDER||n==null)return(function(t){return Ye().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?fa.PACKED_2X2_FLOAT32:fa.UNPACKED_FLOAT32:t?fa.PACKED_2X2_FLOAT16:fa.UNPACKED_FLOAT16})(e);if(n===da.DOWNLOAD||n===da.PIXELS)return fa.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+n)}function ES(n,e,t){return n[0]+"_"+n[1]+"_"+e+"_"+t}var A7=function(n,e){this.variableNames=["A"];for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[r]*e[r];this.outputShape=t,this.rank=t.length;var i=Cr(this.rank),o=(function(s){var a=s.length;if(a>5)throw Error("Tile for rank "+a+" is not yet supported");if(a===1)return"imod(resRC, "+s[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],h=0;h<s.length;h++)l.push("imod("+u[h]+", "+s[h]+")");return l.join()})(n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},C7=function(n,e){this.variableNames=["A"];for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[e[r]];this.outputShape=t,this.rank=t.length;var i=Cr(this.rank),o=(function(s){var a=s.length;if(a>6)throw Error("Transpose for rank "+a+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(a),h=0;h<s.length;h++)l[s[h]]=u[h];return l.join()})(e);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+o+`));
    }
    `},I7=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[e[r]];if(this.outputShape=t,this.rank=t.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Cr(this.rank),o=aT("rc",this.rank),s=new Array(this.rank);for(r=0;r<e.length;r++)s[e[r]]=o[r];var a="vec2("+s.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+t[this.rank-1],l="getChannel(getA("+s.join()+"), "+a+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+o[this.rank-1]+`;
      if(++`+o[this.rank-2]+" < "+t[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},Zb=1.7580993408473768,ex=1.0507009873554805,Sn=function(n,e){this.variableNames=["A"],this.outputShape=n,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Au="if (isnan(x)) return x;",T7="return x;",SS="return abs(x);",fT=Au+`
  return (x < 0.0) ? 0.0 : x;
`,dT=Au+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,pT="return (x >= 0.0) ? x : (exp(x) - 1.0);",k7=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Zb+`;
  float scale = `+ex+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,AS="return -x;",CS="return ceil(x);",IS="return floor(x);",TS="return exp(x);",kS="return exp(x) - 1.0;",N7=Au+`
  return sin(x);
`,R7=Au+`
  return cos(x);
`,P7=Au+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,D7=Au+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,L7=Au+`
  return atan(x);
`,M7=Au+"return log(x + sqrt(x * x + 1.0));",O7=Au+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,F7=Au+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Zg="return x;",B7="return x;",mT=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,gT=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,vT=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Up=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},V7=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n;var e=n.length,t=Ws("rc",e),r=Cr(e),i=(function(a,u){if(a===1)return"rc";for(var l="",h=0;h<a;h++)l+=u[h],h<a-1&&(l+=",");return l})(e,t),o=t.slice(-2),s=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+s+`));
      }
    `},ev={};function tv(n,e){if(e===void 0&&(e=!1),n==="linear")return e?B7:T7;if(n==="relu")return e?mT:fT;if(n==="elu")return e?vT:pT;if(n==="relu6")return e?gT:dT;if(n==="prelu")return e?hT:cT;throw new Error("Activation "+n+" has not been implemented for the WebGL backend.")}var j7=600,U7=(function(n){function e(t){var r,i=n.call(this)||this;if(i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!Ye().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(t==null){var o=vl(Ye().getNumber("WEBGL_VERSION"));i.binaryCache=((r=Ye().getNumber("WEBGL_VERSION"))in ev||(ev[r]={}),ev[r]),i.gpgpu=new JB(o),i.canvas=o.canvas,i.gpgpuCreatedLocally=!0}else i.gpgpu=t,i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=t.gl.canvas;return i.textureManager=new S7(i.gpgpu),i.numMBBeforeWarning=Ye().global.screen==null?1024:Ye().global.screen.height*Ye().global.screen.width*window.devicePixelRatio*j7/1024/1024,i.texData=new JI(i,Te),i}return Su(e,n),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(t,r,i){if(Ye().getBool("DEBUG")&&this.checkNumericalProblems(t),i==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var o={};return this.texData.set(o,{shape:r,dtype:i,values:t,usage:da.UPLOAD}),o},e.prototype.move=function(t,r,i,o){if(Ye().getBool("DEBUG")&&this.checkNumericalProblems(r),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:i,dtype:o,values:r,usage:da.UPLOAD})},e.prototype.readSync=function(t){var r=this.texData.get(t),i=r.values,o=r.dtype,s=r.complexTensors,a=r.slice,u=r.shape,l=r.isPacked;if(a!=null){var h=void 0;h=l?new Up(u,Zg):new Sn(u,Zg);var d=this.runWebGLProgram(h,[{dataId:t,shape:u,dtype:o}],o),m=this.readSync(d.dataId);return this.disposeData(d.dataId),m}if(i!=null)return this.convertAndCacheOnCPU(t);if(o==="string")return i;var p,y,b=this.activeTimers!=null;return b&&(p=Zu()),o==="complex64"?y=fw(s.real.dataSync(),s.imag.dataSync()):y=this.getValuesFromTexture(t),b&&(this.downloadWaitMs+=Zu()-p),this.convertAndCacheOnCPU(t,y)},e.prototype.read=function(t){return Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,C,D,z,L,I;return Rt(this,(function(A){switch(A.label){case 0:if(this.pendingRead.has(t))return r=this.pendingRead.get(t),[2,new Promise((function(O){return r.push(O)}))];if(i=this.texData.get(t),o=i.values,s=i.shape,a=i.slice,u=i.dtype,l=i.complexTensors,h=i.isPacked,a!=null)return d=void 0,d=h?new Up(s,Zg):new Sn(s,Zg),m=this.runWebGLProgram(d,[{dataId:t,shape:s,dtype:u}],u),p=this.read(m.dataId),this.disposeData(m.dataId),[2,p];if(o!=null)return[2,this.convertAndCacheOnCPU(t)];if(!Ye().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Ye().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return y=null,u!=="complex64"&&Ye().get("WEBGL_BUFFER_SUPPORTED")&&(b=this.decode(t),x=this.texData.get(b.dataId),y=(I=this.gpgpu).createBufferFromTexture.apply(I,[x.texture].concat(rm(s)))),this.pendingRead.set(t,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:A.sent(),A.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return T=A.sent(),P=T[0],C=T[1],E=fw(P,C),[3,5];case 4:y==null?E=this.getValuesFromTexture(t):(D=Mt(s),E=this.gpgpu.downloadFloat32MatrixFromBuffer(y,D)),A.label=5;case 5:return b!=null&&this.disposeData(b.dataId),z=this.convertAndCacheOnCPU(t,E),L=this.pendingRead.get(t),this.pendingRead.delete(t),L.forEach((function(O){return O(z)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,z]}}))}))},e.prototype.checkNumericalProblems=function(t){if(t!=null)for(var r=0;r<t.length;r++){var i=t[r];if(!kF(i))throw Ye().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(t){var r,i=this.texData.get(t),o=i.shape,s=i.dtype,a=i.isPacked,u=Mt(o);if(Ye().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(t),h=this.texData.get(l.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[h.texture].concat(rm(o))).subarray(0,u);return this.disposeData(l.dataId),d}var m=Ye().getBool("WEBGL_PACK")&&a===!0,p=m?Oy(o):o,y=m?new TB(p):new IB(p),b=this.runWebGLProgram(y,[{shape:p,dtype:s,dataId:t}],"float32"),x=this.texData.get(b.dataId),E=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(x.texture,x.texShape[0],x.texShape[1]).subarray(0,u);return this.disposeData(b.dataId),E},e.prototype.time=function(t){return Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l;return Rt(this,(function(h){switch(h.label){case 0:return r=this.activeTimers,i=[],o=!1,this.programTimersStack==null?(this.programTimersStack=i,o=!0):this.activeTimers.push(i),this.activeTimers=i,t(),s=Ud(this.activeTimers.map((function(d){return d.query}))).filter((function(d){return d!=null})),a=Ud(this.activeTimers.map((function(d){return d.name}))).filter((function(d){return d!=null})),this.activeTimers=r,o&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(s)]:[3,2];case 1:return l=h.sent(),u.kernelMs=lF(l),u.getExtraProfileInfo=function(){return l.map((function(d,m){return{name:a[m],ms:d}})).map((function(d){return d.name+": "+d.ms})).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},h.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Zu(),endMs:null}},e.prototype.endTimer=function(t){return Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=Zu(),t)},e.prototype.getQueryTime=function(t){return Nt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){return Ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(r=t).endMs-r.startMs]}))}))},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var r=this.texData.get(t).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var r=this.texData.get(t),i=r.texture,o=r.dtype,s=r.texShape,a=r.usage,u=r.isPacked,l=r.slice,h=l&&l.origDataId||t,d=this.dataRefCount.get(h);d>1?this.dataRefCount.set(h,d-1):(this.dataRefCount.delete(h),i!=null&&(this.numBytesInGPU-=this.computeBytes(s,o),this.textureManager.releaseTexture(i,s,a,u)));var m=this.texData.get(t);m.texture=null,m.texShape=null,m.isPacked=!1,m.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return Ye().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=Te.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&t.every((function(o){return i.texData.get(o.dataId).texture==null&&o.size<r}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,r){var i=this.makeOutput(t.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:Te.keep(t.clone()),imag:Te.keep(r.clone())},i},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,r,i){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,r,i);if(Mt(i)===0)return Po([],i,t.dtype);var o=this.texData.get(t.dataId).isPacked,s=YI(t.shape,r,i);if(o||!s){var a=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _7(i):new x7(i),u=a.getCustomSetupFunc(r);return this.compileAndRun(a,[t],null,u)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,r,i)},e.prototype.shallowSlice=function(t,r,i){var o=this.texData.get(t.dataId),s=this.makeOutput(i,t.dtype),a=this.texData.get(s.dataId);Object.assign(a,o),a.shape=i,a.dtype=t.dtype;var u=QI(r,t.strides);o.slice&&(u+=o.slice.flatOffset),a.slice={flatOffset:u,origDataId:o.slice&&o.slice.origDataId||t.dataId};var l=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,l+1),s},e.prototype.stridedSlice=function(t,r,i,o){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,r,i,o);var s=$b(r,i,o);if(s.some((function(u){return u===0})))return Po([],s);var a=new E7(r,o,s);return this.compileAndRun(a,[t])},e.prototype.reverse=function(t,r){var i=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new y7(t.shape,r):new v7(t.shape,r);return this.compileAndRun(i,[t])},e.prototype.concat=function(t,r){if(t[0].dtype==="complex64"){var i=t.map((function(p){return qa(p)})),o=t.map((function(p){return tl(p)}));return ko(this.concat(i,r),this.concat(o,r))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,r);if(t.length===1)return t[0];if(t.length>Ye().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(t.length/2),a=this.concat(t.slice(0,s),r),u=this.concat(t.slice(s),r);return this.concat([a,u],r)}if(Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var l=new dB(t.map((function(p){return p.shape})),r);return this.compileAndRun(l,t)}var h=Wd(t.map((function(p){return p.shape})),r),d=t.map((function(p){return p.as2D(-1,Mt(p.shape.slice(r)))})),m=new fB(d.map((function(p){return p.shape})));return this.compileAndRun(m,d).reshape(h)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,AS,t.dtype);var r=new Sn(t.shape,AS);return this.compileAndRun(r,[t])},e.prototype.batchMatMul=function(t,r,i,o){var s=i?t.shape[2]:t.shape[1],a=o?r.shape[1]:r.shape[2],u=i?t.shape[1]:t.shape[2],l=t.shape[0];if((s===1||a===1)&&u>1e3){i&&(t=t.transpose([0,2,1])),o&&(r=r.transpose([0,2,1]));var h=a===1?t:t.as3D(l,u,1),d=a===1?2:1,m=a===1?r.as3D(l,1,u):r;return this.multiply(h,m).sum(d,!0)}var p=No(t.dtype,r.dtype),y=new jy(t.shape,[l,s,a],i,o);return this.compileAndRun(y,[t,r],p)},e.prototype.fusedBatchMatMul=function(t){var r=t.a,i=t.b,o=t.transposeA,s=t.transposeB,a=t.bias,u=t.activation,l=t.preluActivationWeights,h=o?r.shape[2]:r.shape[1],d=s?i.shape[1]:i.shape[2],m=r.shape[0],p=No(r.dtype,i.dtype),y=a!=null,b=l!=null,x=u?tv(u,!0):null,E=new jy(r.shape,[m,h,d],o,s,y,x,b),T=[r,i];return a&&T.push(a),l&&T.push(l),this.compileAndRun(E,T,p)},e.prototype.multiply=function(t,r){if(t.dtype==="complex64"){var i=this.texData.get(t.dataId),o=this.texData.get(r.dataId),s=new dS(aB,t.shape,r.shape),a=new dS(uB,t.shape,r.shape),u=[this.makeComplexComponentTensorInfo(t,i.complexTensors.real),this.makeComplexComponentTensorInfo(t,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,o.complexTensors.real),this.makeComplexComponentTensorInfo(r,o.complexTensors.imag)],l=this.compileAndRun(s,u),h=this.compileAndRun(a,u),d=this.complex(l,h);return l.dispose(),h.dispose(),d}if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.multiply(t,r);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,pS,t.dtype);var m=new ii(pS,t.shape,r.shape);return this.compileAndRun(m,[t,r],t.dtype)},e.prototype.batchNormalization=function(t,r,i,o,s,a){var u=[t,r,i],l=null;a!=null&&(l=a.shape,u.push(a));var h=null;if(s!=null&&(h=s.shape,u.push(s)),Ye().getBool("WEBGL_PACK_NORMALIZATION")){var d=new sB(t.shape,r.shape,i.shape,l,h,o);return this.compileAndRun(d,u)}var m=new oB(t.shape,r.shape,i.shape,l,h,o);return this.compileAndRun(m,u)},e.prototype.localResponseNormalization4D=function(t,r,i,o,s){var a=Ye().getBool("WEBGL_PACK_NORMALIZATION")?new n7(t.shape,r,i,o,s):new e7(t.shape,r,i,o,s);return this.compileAndRun(a,[t])},e.prototype.LRNGrad=function(t,r,i,o,s,a,u){var l=new t7(r.shape,o,s,a,u);return this.compileAndRun(l,[r,i,t])},e.prototype.tile=function(t,r){if(t.dtype==="string"){var i=this.readSync(t.dataId).map((function(s){return Jv(s)}));return oT(wn(t.shape,t.dtype,i),r)}var o=new A7(t.shape,r);return this.compileAndRun(o,[t])},e.prototype.pad=function(t,r,i){var o=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new l7(t.shape,r,i):new u7(t.shape,r,i);return this.compileAndRun(o,[t])},e.prototype.transpose=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,r);var i=Ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new I7(t.shape,r):new C7(t.shape,r);return this.compileAndRun(i,[t])},e.prototype.gather=function(t,r,i){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.gather(t,r,i);var o=new LB(t.shape,r.size,i);return this.compileAndRun(o,[t,r])},e.prototype.batchToSpaceND=function(t,r,i){me(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var o=r.reduce((function(d,m){return d*m})),s=i0(t.shape,r,o),a=o0(s.length,r.length),u=s0(t.shape,r,o),l=GI(i,r.length),h=$I(u,i,r.length);return t.reshape(s).transpose(a).reshape(u).slice(l,h)},e.prototype.spaceToBatchND=function(t,r,i){me(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var o=r.reduce((function(m,p){return m*p})),s=[[0,0]];s.push.apply(s,i);for(var a=1+r.length;a<t.shape.length;++a)s.push([0,0]);var u=t.pad(s),l=i0(u.shape,r,o,!1),h=o0(l.length,r.length,!1),d=s0(u.shape,r,o,!1);return u.reshape(l).transpose(h).reshape(d)},e.prototype.reduce=function(t,r,i){var o=t.shape[0],s=t.shape[1],a=Fy(s),u=new c7({windowSize:a,inSize:s,batchSize:o},r),l=this.compileAndRun(u,[t],i);return l.shape[1]===1?l:this.reduce(l,r,i)},e.prototype.argReduce=function(t,r,i){i===void 0&&(i=null);var o=t.shape[0],s=t.shape[1];i!=null&&(o=i.shape[0],s=i.shape[1]);var a=Fy(s),u=new Y8({windowSize:a,inSize:s,batchSize:o},r,i==null),l=[t];i!=null&&l.push(i);var h=this.compileAndRun(u,l,"int32");return h.shape[1]===1?h:this.argReduce(t,r,h)},e.prototype.argReducePacked=function(t,r,i){i===void 0&&(i=null);var o=i!=null?i.shape:t.shape,s=Fy(o[o.length-1]),a=new nB(o,s,r,i==null),u=i==null?[t]:[t,i],l=this.compileAndRun(a,u,"int32");return l.rank===t.rank?this.argReducePacked(t,r,l):l},e.prototype.sum=function(t,r){ha("sum",r,t.rank);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s),u=ky(t.dtype);return this.reduce(a,"sum",u).reshape(o)},e.prototype.prod=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,r);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s),u=ky(t.dtype);return this.reduce(a,"prod",u).reshape(o)},e.prototype.unsortedSegmentSum=function(t,r,i){var o=0,s=yl([o],t.rank),a=t;s!=null&&(a=t.transpose(s),o=wl(1,t.rank)[0]);var u=(function(p,y,b){for(var x=[],E=p.length,T=0;T<E;T++)T!==y?x.push(p[T]):x.push(b);return x})(a.shape,o,i),l=Mt([a.shape[o]]),h=a.as2D(-1,l),d=ky(t.dtype),m=this.segOpCompute(h,"unsortedSegmentSum",r,d,i).reshape(u);return s!=null&&(m=m.transpose(Wb(s))),m},e.prototype.segOpCompute=function(t,r,i,o,s){var a=t.shape[0],u=t.shape[1],l=(function(m,p){var y,b=!1;for(m<=XI?(y=m,b=!0):y=rw(m,Math.floor(Math.sqrt(m)));!b;)y>p||y===m?b=!0:y=rw(m,y+1);return y})(u,s),h=new w7({windowSize:l,inSize:u,batchSize:a,numSegments:s}),d=this.compileAndRun(h,[t,i],o);return d.shape[1]===s?d:(i=r0(0,s).tile([u/l]),this.segOpCompute(d,r,i,o,s))},e.prototype.argMinMaxReduce=function(t,r,i){var o=[r];if(ha("arg"+i.charAt(0).toUpperCase()+i.slice(1),o,t.rank),!Ye().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var s=ts(t.shape,o),a=s[0],u=Mt(s[1]),l=t.as2D(-1,u);return this.argReduce(l,i).reshape(a)}return this.argReducePacked(t,i)},e.prototype.argMin=function(t,r){return this.argMinMaxReduce(t,r,"min")},e.prototype.argMax=function(t,r){return this.argMinMaxReduce(t,r,"max")},e.prototype.cumsum=function(t,r,i,o){if(r!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+r);var s=new _B(t.shape,i,o);return this.compileAndRun(s,[t])},e.prototype.equal=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(equal(a, b));
`,"bool");var i=new ii("return float(a == b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.notEqual=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new ii("return float(a != b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.less=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.less(t,r);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new ii("return float(a < b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.lessEqual=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new ii("return float(a <= b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.greater=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.greater(t,r);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new ii("return float(a > b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.greaterEqual=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new ii("return float(a >= b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.logicalNot=function(t){var r=new Sn(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[t])},e.prototype.logicalAnd=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new ii("return float(a >= 1.0 && b >= 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.logicalOr=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new ii("return float(a >= 1.0 || b >= 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.select=function(t,r,i){var o=new b7(t.rank,r.shape,r.rank);return this.compileAndRun(o,[t,r,i],No(r.dtype,i.dtype))},e.prototype.where=function(t){t0("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=t.dataSync();return Qb(t.shape,r)},e.prototype.topk=function(t,r,i){return sT(t.dataSync(),t.shape,t.dtype,r)},e.prototype.min=function(t,r){ha("min",r,t.rank);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"min",a.dtype).reshape(o)},e.prototype.minimum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.minimum(t,r);var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new ii(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.mod=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new ii(`if (b == 0.0) return NAN;
  return mod(a, b);`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.max=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,r);ha("max",r,t.rank);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"max",a.dtype).reshape(o)},e.prototype.maximum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.maximum(t,r);var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new ii(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.all=function(t,r){ha("all",r,t.rank);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"all",a.dtype).reshape(o)},e.prototype.any=function(t,r){ha("any",r,t.rank);var i=ts(t.shape,r),o=i[0],s=Mt(i[1]),a=t.as2D(-1,s);return this.reduce(a,"any",a.dtype).reshape(o)},e.prototype.realDivide=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var i=new ii(`
if (a == b) {
  return 1.0;
};
return a / b;`,t.shape,r.shape);return this.compileAndRun(i,[t,r],"float32")},e.prototype.floorDiv=function(t,r){if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new ii(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,t.shape,r.shape);return this.compileAndRun(i,[t,r],"int32")},e.prototype.add=function(t,r){if(t.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(t,r,By);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.add(t,r);var i=No(t.dtype,r.dtype);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,By,i);var o=new ii(By,t.shape,r.shape);return this.compileAndRun(o,[t,r],i)},e.prototype.packedUnaryOp=function(t,r,i){var o=new Up(t.shape,r);return this.compileAndRun(o,[t],i)},e.prototype.packedBinaryOp=function(t,r,i,o,s){s===void 0&&(s=!1);var a=new Gl(i,t.shape,r.shape,s);return this.compileAndRun(a,[t,r],o)},e.prototype.complexSeparableBinaryOp=function(t,r,i){var o=this,s=this.texData.get(t.dataId),a=this.texData.get(r.dataId),u=[[s.complexTensors.real,a.complexTensors.real],[s.complexTensors.imag,a.complexTensors.imag]].map((function(m){var p=m[0],y=m[1],b=o.makeComplexComponentTensorInfo(t,p),x=o.makeComplexComponentTensorInfo(r,y),E=new ii(i,t.shape,r.shape);return o.compileAndRun(E,[b,x],No(p.dtype,y.dtype))})),l=u[0],h=u[1],d=this.complex(l,h);return l.dispose(),h.dispose(),d},e.prototype.makeComplexComponentTensorInfo=function(t,r){return{dataId:r.dataId,dtype:r.dtype,shape:t.shape}},e.prototype.addN=function(t){if(t.length===1)return t[0];if(t.length>Ye().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(t.length/2),i=this.addN(t.slice(0,r)),o=this.addN(t.slice(r));return this.addN([i,o])}var s=t.map((function(l){return l.dtype})).reduce((function(l,h){return No(l,h)})),a=t.map((function(l){return l.shape})),u=Ye().getBool("WEBGL_PACK")?new X8(t[0].shape,a):new K8(t[0].shape,a);return this.compileAndRun(u,t,s)},e.prototype.subtract=function(t,r){if(t.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(t,r,Vy);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.subtract(t,r);var i=No(t.dtype,r.dtype);if(Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,Vy,t.dtype);var o=new ii(Vy,t.shape,r.shape);return this.compileAndRun(o,[t,r],i)},e.prototype.pow=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new ii(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,t.shape,r.shape),o=No(t.dtype,r.dtype);return this.compileAndRun(i,[t,r],o)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,CS,t.dtype);var r=new Sn(t.shape,CS);return this.compileAndRun(r,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,IS,t.dtype);var r=new Sn(t.shape,IS);return this.compileAndRun(r,[t])},e.prototype.sign=function(t){var r=new Sn(t.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[t])},e.prototype.isNaN=function(t){var r=new Sn(t.shape,"return float(isnan(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.isInf=function(t){var r=new Sn(t.shape,"return float(isinf(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.isFinite=function(t){var r=new Sn(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.round=function(t){var r=new Sn(t.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,TS,t.dtype);var r=new Sn(t.shape,TS);return this.compileAndRun(r,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,kS,t.dtype);var r=new Sn(t.shape,kS);return this.compileAndRun(r,[t])},e.prototype.softmax=function(t,r){var i=Xi([r],t.shape),o=this.max(t,i),s=Hs(o.shape,i),a=this.subtract(t,o.reshape(s)),u=this.exp(a),l=this.sum(u,i).reshape(s);return this.realDivide(u,l)},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,t.dtype);var r=new Sn(t.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[t])},e.prototype.log1p=function(t){var r=new Sn(t.shape,"return log(1.0 + x);");return this.compileAndRun(r,[t])},e.prototype.sqrt=function(t){var r=new Sn(t.shape,"return sqrt(x);");return this.compileAndRun(r,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var r=new Sn(t.shape,"return inversesqrt(x);");return this.compileAndRun(r,[t])},e.prototype.reciprocal=function(t){var r=new Sn(t.shape,"return 1.0 / x;");return this.compileAndRun(r,[t])},e.prototype.relu=function(t){var r;return r=Ye().getBool("WEBGL_PACK")?new Up(t.shape,mT):new Sn(t.shape,fT),this.compileAndRun(r,[t])},e.prototype.relu6=function(t){var r;return r=Ye().getBool("WEBGL_PACK")?new Up(t.shape,gT):new Sn(t.shape,dT),this.compileAndRun(r,[t])},e.prototype.prelu=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(hT,t.shape,r.shape):new ii(cT,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.elu=function(t){if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,vT,t.dtype);var r=new Sn(t.shape,pT);return this.compileAndRun(r,[t])},e.prototype.eluDer=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,t.shape,r.shape):new ii("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.selu=function(t){var r=new Sn(t.shape,k7);return this.compileAndRun(r,[t])},e.prototype.int=function(t){var r=new Sn(t.shape,"return float(int(x));");return this.compileAndRun(r,[t],"int32")},e.prototype.clip=function(t,r,i){var o,s=(o=Ye().getBool("WEBGL_PACK_CLIP")?new cB(t.shape):new lB(t.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(o,[t],null,s)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(Ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,SS,t.dtype);var r=new Sn(t.shape,SS);return this.compileAndRun(r,[t])},e.prototype.complexAbs=function(t){var r=this.texData.get(t.dataId),i=new hB(t.shape),o=[this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)];return this.compileAndRun(i,o)},e.prototype.sigmoid=function(t){var r=new Sn(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[t])},e.prototype.softplus=function(t){var r=new Sn(t.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[t])},e.prototype.sin=function(t){var r=new Sn(t.shape,N7);return this.compileAndRun(r,[t])},e.prototype.cos=function(t){var r=new Sn(t.shape,R7);return this.compileAndRun(r,[t])},e.prototype.tan=function(t){var r=new Sn(t.shape,"return tan(x);");return this.compileAndRun(r,[t])},e.prototype.asin=function(t){var r=new Sn(t.shape,P7);return this.compileAndRun(r,[t])},e.prototype.acos=function(t){var r=new Sn(t.shape,D7);return this.compileAndRun(r,[t])},e.prototype.atan=function(t){var r=new Sn(t.shape,L7);return this.compileAndRun(r,[t])},e.prototype.atan2=function(t,r){var i=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new ii(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.sinh=function(t){var r=new Sn(t.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[t])},e.prototype.cosh=function(t){var r=new Sn(t.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[t])},e.prototype.tanh=function(t){var r=new Sn(t.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[t])},e.prototype.asinh=function(t){var r=new Sn(t.shape,M7);return this.compileAndRun(r,[t])},e.prototype.acosh=function(t){var r=new Sn(t.shape,O7);return this.compileAndRun(r,[t])},e.prototype.atanh=function(t){var r=new Sn(t.shape,F7);return this.compileAndRun(r,[t])},e.prototype.erf=function(t){var r=new Sn(t.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[t])},e.prototype.step=function(t,r){var i=new Sn(t.shape,(function(o){return o===void 0&&(o=0),Au+`
    return x > 0.0 ? 1.0 : float(`+o+`);
  `})(r));return this.compileAndRun(i,[t])},e.prototype.conv2dByMatMul=function(t,r,i,o,s,a){var u=t.shape,l=this.texData.get(t.dataId),h=i.inChannels,d=u[0]*u[1]*u[2],m=i.outChannels,p=i.dataFormat==="channelsLast",y=(d===1||m===1)&&h>1e3,b=u[2]%2!=0&&!!l.isPacked;if(y||!Ye().getBool("WEBGL_LAZILY_UNPACK")||!Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!b){var x=p?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],E=this.reshape(t,[1,x,i.inChannels]),T=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:E,b:T,transposeA:!1,transposeB:!1,bias:o,activation:s,preluActivationWeights:a}),i.outShape)}var P=p?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),C={dataId:t.dataId,shape:[1,P,i.inChannels],dtype:t.dtype},D=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,me(Qg(l.shape,C.shape),(function(){return"packed reshape "+l.shape+" to "+C.shape+" isn't free"}));var z=this.reshape(r,[1,i.inChannels,i.outChannels]),L=this.fusedBatchMatMul({a:C,b:z,transposeA:!1,transposeB:!1,bias:o,activation:s,preluActivationWeights:a}),I=this.texData.get(L.dataId);return me(I.isPacked,(function(){return"batchMatMul result is expected to be packed"})),l.shape=D,I.shape=i.outShape,Te.makeTensorFromDataId(L.dataId,i.outShape,L.dtype)},e.prototype.conv2dWithIm2Row=function(t,r,i,o,s,a){var u=i.filterWidth,l=i.filterHeight,h=i.inChannels,d=i.outWidth,m=i.outHeight,p=i.dataFormat==="channelsLast",y=u*l*h,b=m*d,x=[y,b],E=t.squeeze([0]),T=r.reshape([1,y,-1]),P=new ZB(x,E.shape,i),C=this.compileAndRun(P,[E]).reshape([1,x[0],x[1]]),D=o!=null,z=a!=null,L=s?tv(s,!0):null,I=new jy(C.shape,[1,b,i.outChannels],!0,!1,D,L,z),A=[C,T];o&&A.push(o),z&&A.push(a);var O=this.compileAndRun(I,A);return p?O.reshape([1,m,d,i.outChannels]):O.reshape([1,i.outChannels,m,d])},e.prototype.fusedConv2d=function(t){var r=t.input,i=t.filter,o=t.convInfo,s=t.bias,a=t.activation,u=t.preluActivationWeights;if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,o,s,a,u);if(Ye().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,o,s,a,u);var l=s!=null,h=u!=null,d=a?tv(a,!1):null,m=new mS(o,l,d,h),p=[r,i];return s&&p.push(s),u&&p.push(u),this.compileAndRun(m,p)},e.prototype.conv2d=function(t,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(t,r,i);if(Ye().getBool("WEBGL_CONV_IM2COL")&&t.shape[0]===1)return this.conv2dWithIm2Row(t,r,i);var o=new mS(i);return this.compileAndRun(o,[t,r])},e.prototype.conv2dDerInput=function(t,r,i){var o=new mB(i);return this.compileAndRun(o,[t,r])},e.prototype.conv2dDerFilter=function(t,r,i){var o=new pB(i);return this.compileAndRun(o,[t,r])},e.prototype.fusedDepthwiseConv2D=function(t){var r,i=t.input,o=t.filter,s=t.convInfo,a=t.bias,u=t.activation,l=t.preluActivationWeights,h=Ye().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,d=u?tv(u,h):null,m=[i,o],p=a!=null,y=l!=null;return p&&m.push(a),y&&m.push(l),h?(r=new vS(s,p,d,y),this.compileAndRun(r,m)):(r=new gS(s,p,d,y),this.compileAndRun(r,m))},e.prototype.depthwiseConv2D=function(t,r,i){var o;return Ye().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(o=new vS(i),this.compileAndRun(o,[t,r])):(o=new gS(i),this.compileAndRun(o,[t,r]))},e.prototype.depthwiseConv2DDerInput=function(t,r,i){var o=new wB(i);return this.compileAndRun(o,[t,r])},e.prototype.depthwiseConv2DDerFilter=function(t,r,i){var o=new yB(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3d=function(t,r,i){var o=new bB(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3dDerInput=function(t,r,i){var o=new vB(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3dDerFilter=function(t,r,i){var o=new gB(i);return this.compileAndRun(o,[t,r])},e.prototype.maxPool=function(t,r){var i=new Uy(r,"max",!1);return this.compileAndRun(i,[t])},e.prototype.avgPool=function(t,r){var i=new Uy(r,"avg",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.maxPoolBackprop=function(t,r,i,o){var s=new Uy(o,"max",!0),a=this.compileAndRun(s,[r]),u=new r7(o),l=this.compileAndRun(u,[t,a],r.dtype);return a.dispose(),l},e.prototype.avgPoolBackprop=function(t,r,i){var o=new rB(i);return this.compileAndRun(o,[t],r.dtype)},e.prototype.cast=function(t,r){return tT(t,r,this)},e.prototype.unstack=function(t,r){for(var i=t.shape[r],o=new Array(t.rank-1),s=0,a=0;a<t.rank;a++)a!==r&&(o[s++]=t.shape[a]);var u=new Array(t.rank).fill(0),l=t.shape.slice();l[r]=1;var h=new Array(i);for(a=0;a<h.length;a++)u[r]=a,h[a]=this.slice(t,u,l).reshape(o);return h},e.prototype.avgPool3d=function(t,r){var i=new zy(r,"avg",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,r,i){var o=new iB(i);return this.compileAndRun(o,[t],r.dtype)},e.prototype.maxPool3d=function(t,r){var i=new zy(r,"max",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,r,i,o){var s=new zy(o,"max",!0),a=this.compileAndRun(s,[r]),u=new i7(o),l=this.compileAndRun(u,[t,a],r.dtype);return a.dispose(),l},e.prototype.reshape=function(t,r){var i=this.texData.get(t.dataId);if(i.isPacked&&!Qg(t.shape,r)&&(i.texture===null||!Qg(i.shape,r))){var o=this.packedReshape(t,r);return Te.makeTensorFromDataId(o.dataId,o.shape,o.dtype)}return hw(t,r)},e.prototype.resizeBilinear=function(t,r,i,o){var s=Ye().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new p7(t.shape,r,i,o):new d7(t.shape,r,i,o);return this.compileAndRun(s,[t],"float32")},e.prototype.resizeBilinearBackprop=function(t,r,i){var o=new f7(t,r,i);return this.compileAndRun(o,[t])},e.prototype.resizeNearestNeighbor=function(t,r,i,o){var s=new g7(t.shape,r,i,o);return this.compileAndRun(s,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,r,i){var o=new m7(t,r,i);return this.compileAndRun(o,[t])},e.prototype.multinomial=function(t,r,i,o){var s=r?t:ic(t),a=s.shape[0],u=s.shape[1],l=new o7(a,u,i),h=l.getCustomSetupFunc(o);return this.compileAndRun(l,[s],"int32",h)},e.prototype.oneHot=function(t,r,i,o){var s=new s7(t.size,r,i,o);return this.compileAndRun(s,[t])},e.prototype.diag=function(t){var r=new CB(t.size);return this.compileAndRun(r,[t])},e.prototype.nonMaxSuppression=function(t,r,i,o,s){return t0("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Xb(t.dataSync(),r.dataSync(),i,o,s)},e.prototype.cropAndResize=function(t,r,i,o,s,a){var u=new xB(t.shape,r.shape,o,s,a);return this.compileAndRun(u,[t,r,i],"float32")},e.prototype.depthToSpace=function(t,r,i){me(r>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+r}));var o=t.shape[0],s=i==="NHWC"?t.shape[1]:t.shape[2],a=i==="NHWC"?t.shape[2]:t.shape[3],u=i==="NHWC"?t.shape[3]:t.shape[1],l=s*r,h=a*r,d=u/(r*r),m=new AB(i==="NHWC"?[o,l,h,d]:[o,d,l,h],r,i);return this.compileAndRun(m,[t])},e.prototype.split=function(t,r,i){return iT(t,r,i)},e.prototype.scatterND=function(t,r,i){var o=a0(0,t,i),s=o.sliceRank,a=o.numUpdates,u=o.sliceSize,l=o.strides,h=o.outputSize,d=[h/u,u],m=t.reshape([a,s]),p=r.reshape([a,u]);if(h===0)return hw(Po([]),i);var y=dt(0),b=new xS(a,s,m.rank,p.rank,l,d);return this.compileAndRun(b,[p,m,y]).reshape(i)},e.prototype.sparseToDense=function(t,r,i,o){var s=a0(0,t,i),a=s.sliceRank,u=s.numUpdates,l=s.strides,h=s.outputSize,d=new xS(u,a,t.rank,r.rank,l,[h,1]);return this.compileAndRun(d,[r,t,o]).reshape(i)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,r){var i=this.texData.get(t.dataId),o=new wS(RB,t.shape,r),s=new wS(PB,t.shape,r),a=[this.makeComplexComponentTensorInfo(t,i.complexTensors.real),this.makeComplexComponentTensorInfo(t,i.complexTensors.imag)],u=this.compileAndRun(o,a),l=this.compileAndRun(s,a),h=this.complex(u,l).as2D(t.shape[0],t.shape[1]);return u.dispose(),l.dispose(),h},e.prototype.gatherND=function(t,r){var i=r.shape,o=i[i.length-1],s=KI(t,r),a=s[0],u=s[1],l=s[2],h=s[3],d=r.reshape([u,o]),m=t.reshape([t.size/l,l]),p=new MB(o,h,[u,l]);return this.compileAndRun(p,[m,d]).reshape(a)},e.prototype.fill=function(t,r,i){if((i=i||Um(r))==="string"){var o=Qv(i,Mt(t));return o.fill(r),Te.makeTensor(o,t,i,this)}var s=new DB(t,r),a=s.getCustomSetupFunc(r);return this.compileAndRun(s,[],i,a)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,t.dtype==="string"?"":0,t.dtype)},e.prototype.linspace=function(t,r,i){return nT(t,r,i)},e.prototype.makeTensorInfo=function(t,r){var i=this.write(null,t,r);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:r}},e.prototype.makeOutput=function(t,r){var i=this.makeTensorInfo(t,r).dataId;return Te.makeTensorFromDataId(i,t,r,this)},e.prototype.unpackTensor=function(t){var r=new V7(t.shape);return this.runWebGLProgram(r,[t],t.dtype)},e.prototype.packTensor=function(t){var r=new a7(t.shape);return this.runWebGLProgram(r,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,r){var i=[Zv(t.shape)].concat(e0(t.shape)),o={dtype:t.dtype,shape:i,dataId:t.dataId},s=[Zv(r)].concat(e0(r)),a=new h7(s,i),u=this.runWebGLProgram(a,[o],t.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},e.prototype.decode=function(t){var r,i=this.texData.get(t),o=i.isPacked,s=i.shape,a=i.dtype,u=Oy(s);return r=o?new SB(u):new EB(u),{dtype:a,shape:s,dataId:this.runWebGLProgram(r,[{shape:u,dtype:a,dataId:t}],a,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,r,i,o,s){var a=this;s===void 0&&(s=!1);var u=this.makeTensorInfo(t.outputShape,i),l=this.texData.get(u.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===xm.DENSE){var h=rm(t.outputShape);l.texShape=h.map((function(P){return 2*P}))}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),Mt(u.shape)===0)return l.values=wm(u.dtype,0),u;var d=[],m=r.map((function(P){if(P.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var C=a.texData.get(P.dataId);if(C.texture==null){if(!t.packedInputs&&Mt(P.shape)<=Ye().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:P.shape,texData:null,isUniform:!0,uniformValues:C.values};t.packedInputs&&(C.isPacked=!0,C.shape=P.shape)}else if(!!C.isPacked!=!!t.packedInputs)P=C.isPacked?a.unpackTensor(P):a.packTensor(P),d.push(P),C=a.texData.get(P.dataId);else if(C.isPacked&&!Qg(C.shape,P.shape)){var D=P,z=P.shape;P.shape=C.shape,P=a.packedReshape(P,z),d.push(P),C=a.texData.get(P.dataId),D.shape=z}return a.uploadToGPU(P.dataId),{shape:P.shape,texData:C,isUniform:!1}}));this.uploadToGPU(u.dataId);var p,y={shape:u.shape,texData:l,isUniform:!1},b=(function(P,C,D){var z="";C.concat(D).forEach((function(A){var O=A.texData!=null&&A.texData.slice!=null&&A.texData.slice.flatOffset>0,k=A.isUniform?"uniform":A.texData.texShape;z+=A.shape+"_"+k+"_"+O}));var L=P.userCode,I=P.constructor.name;return I+="_"+z+"_"+L})(t,m,y),x=this.getAndSaveBinary(b,(function(){return(function(P,C,D,z){var L=C.userCode,I=D.map((function($,ae){var fe={logicalShape:$.shape,texShape:$.isUniform?null:$.texData.texShape,isUniform:$.isUniform,isPacked:!$.isUniform&&$.texData.isPacked,flatOffset:null};return $.texData!=null&&$.texData.slice!=null&&$.texData.slice.flatOffset>0&&(fe.flatOffset=$.texData.slice.flatOffset),{name:C.variableNames[ae],shapeInfo:fe}})),A=I.map((function($){return $.shapeInfo})),O={logicalShape:z.shape,texShape:z.texData.texShape,isUniform:!1,isPacked:z.texData.isPacked,flatOffset:null},k=Q8(I,O,L,C.packedInputs),M=P.createProgram(k),j=null,X=P.getUniformLocation(M,"NAN",!1);Ye().getNumber("WEBGL_VERSION")===1&&(j=P.getUniformLocation(M,"INFINITY",!1));for(var ue={},ge=0;ge<C.variableNames.length;ge++){var ce=C.variableNames[ge];ue[ce]=P.getUniformLocation(M,ce,!1),ue["offset"+ce]=P.getUniformLocation(M,"offset"+ce,!1)}return{program:C,source:k,webGLProgram:M,uniformLocations:ue,inShapeInfos:A,outShapeInfo:O,infLoc:j,nanLoc:X}})(a.gpgpu,t,m,y)})),E=this.activeTimers!=null;if(E&&(p=this.startTimer()),(function(P,C,D,z,L){bS(C.inShapeInfos,D),bS([C.outShapeInfo],[z]);var I=z.texData.texture,A=z.texData.texShape;z.texData.isPacked?P.setOutputPackedMatrixTexture(I,A[0],A[1]):P.setOutputMatrixTexture(I,A[0],A[1]),P.setProgram(C.webGLProgram),Ye().getNumber("WEBGL_VERSION")===1&&C.infLoc!==null&&P.gl.uniform1f(C.infLoc,1/0),C.nanLoc!==null&&P.gl.uniform1f(C.nanLoc,NaN),D.forEach((function(O,k){var M=C.program.variableNames[k],j=C.uniformLocations[M],X=C.uniformLocations["offset"+M];if(j!=null)if(O.isUniform)if(Mt(O.shape)<2)P.gl.uniform1f(j,O.uniformValues[0]);else{var ue=O.uniformValues;ue instanceof Float32Array||(ue=new Float32Array(ue)),P.gl.uniform1fv(j,ue)}else O.texData.slice!=null&&X!=null&&P.gl.uniform1i(X,O.texData.slice.flatOffset),P.setInputMatrixTexture(O.texData.texture,j,k)})),L!=null&&L(P,C.webGLProgram),P.executeProgram()})(this.gpgpu,x,m,y,o),d.forEach((function(P){return a.disposeData(P.dataId)})),E&&(p=this.endTimer(p),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(p)})),!Ye().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&s===!1){var T=this.unpackTensor(u);return this.disposeData(u.dataId),T}return u},e.prototype.compileAndRun=function(t,r,i,o,s){s===void 0&&(s=!1),i=i||r[0].dtype;var a=this.runWebGLProgram(t,r,i,o,s);return Te.makeTensorFromDataId(a.dataId,a.shape,a.dtype)},e.prototype.getAndSaveBinary=function(t,r){return t in this.binaryCache||(this.binaryCache[t]=r()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var t=this;this.disposed||(Ye().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(r){t.gpgpu.deleteProgram(t.binaryCache[r].webGLProgram),delete t.binaryCache[r]})),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=_t((function(){if(!Ye().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=Ye().getBool("DEBUG");Ye().set("DEBUG",!1);var i=t.abs(dt(1e-8)).dataSync()[0];if(Ye().set("DEBUG",r),i>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var r,i=this.texData.get(t),o=i.shape,s=i.dtype,a=i.values,u=i.texture,l=i.usage,h=i.isPacked;if(u==null){var d,m=this.activeTimers!=null;m&&(d=Zu());var p=i.texShape;if(p==null&&(p=$F(o,h),i.texShape=p),a!=null){var y=Oy(o),b=void 0,x=p[1],E=p[0],T=a instanceof Uint8Array;h?(x=(r=Wm(p[0],p[1]))[0],E=r[1],b=new NB(y,[E,x],T)):b=new kB(y,[E,x],T);var P=this.makeTensorInfo([E,x],s);this.texData.get(P.dataId).usage=T?da.PIXELS:da.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(P.dataId),x,E,a);var C=this.runWebGLProgram(b,[P],s,null,!0),D=this.texData.get(C.dataId);i.texture=D.texture,i.texShape=D.texShape,i.isPacked=D.isPacked,i.usage=D.usage,this.disposeData(P.dataId),this.texData.delete(C.dataId),i.values=null,m&&(this.uploadWaitMs+=Zu()-d)}else{var z=this.acquireTexture(p,l,s,h);i.texture=z}}},e.prototype.convertAndCacheOnCPU=function(t,r){var i=this.texData.get(t),o=i.dtype;return this.releaseGPUData(t),r!=null&&(i.values=(function(s,a){if(a==="float32"||a==="complex64")return s;if(a==="int32"||a==="bool"){for(var u=a==="int32"?new Int32Array(s.length):new Uint8Array(s.length),l=0;l<u.length;++l)u[l]=Math.round(s[l]);return u}throw new Error("Unknown dtype "+a)})(r,o)),i.values},e.prototype.acquireTexture=function(t,r,i,o){if(this.numBytesInGPU+=this.computeBytes(t,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,r,o)},e.prototype.computeBytes=function(t,r){return t[0]*t[1]*NI(r)},e})(ZI);FI()&&Te.registerBackend("webgl",(function(){return new U7}),2);var z7=xe({square_:function(n){var e=se(n,"x","square"),t=[e];return Te.runKernelFunc((function(r,i){return i([e]),r.square(e)}),{x:e},null,"Square",{},t,[])}}),Em="SquaredDifference",yT=xe({squaredDifference_:function(n,e){var t,r=se(n,"a","squaredDifference"),i=se(e,"b","squaredDifference");t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape);var o={a:r,b:i},s=[r,i];return Te.runKernelFunc((function(a,u){var l=a.squaredDifference(r,i);return u([r,i]),l}),o,(function(a,u){var l=u[0],h=u[1],d=dt(2);return{a:function(){return a.mul(l.sub(h).mul(d))},b:function(){return a.mul(h.sub(l).mul(d))}}}),Em,{},s,[])}}),W7=xe({abs_:function(n){var e=se(n,"x","abs");return e.dtype==="complex64"?Te.runKernelFunc((function(t){return t.complexAbs(e)}),{$x:e}):Te.runKernelFunc((function(t,r){var i=t.abs(e);return r([e]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return t.mul(i.toFloat().step(-1))}}}),"Abs")}}),q7=xe({acos_:function(n){var e=se(n,"x","acos");return Te.runKernelFunc((function(t,r){var i=t.acos(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(dt(1).sub(i.toFloat().square()).sqrt()).neg()}}}))}}),H7=xe({acosh_:function(n){var e=se(n,"x","acosh");return Te.runKernelFunc((function(t,r){var i=t.acosh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(i.toFloat().square().sub(1).sqrt())}}}))}}),G7=xe({asin_:function(n){var e=se(n,"x","asin");return Te.runKernelFunc((function(t,r){var i=t.asin(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(dt(1).sub(i.toFloat().square()).sqrt())}}}))}}),$7=xe({asinh_:function(n){var e=se(n,"x","asinh");return Te.runKernelFunc((function(t,r){var i=t.asinh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.divStrict(dt(1).add(i.toFloat().square()).sqrt())}}}))}}),K7=xe({atan_:function(n){var e=se(n,"x","atan");return Te.runKernelFunc((function(t,r){var i=t.atan(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat().square().add(1))}}}))}}),X7=xe({atanh_:function(n){var e=se(n,"x","atanh");return Te.runKernelFunc((function(t,r){var i=t.atanh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(dt(1).sub(i.toFloat().square()))}}}))}}),Y7=xe({ceil_:function(n){var e=se(n,"x","ceil");return Te.runKernelFunc((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),tx=xe({clipByValue_:function(n,e,t){var r=se(n,"x","clipByValue");me(e<=t,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+t+")."}));var i=[r],o={min:e,max:t};return Te.runKernelFunc((function(s,a){var u=s.clip(r,e,t);return a([r]),u}),{x:r},(function(s,a){var u=a[0];return{x:function(){return s.where(u.greaterEqual(e).logicalAnd(u.lessEqual(t)),zn(s))}}}),"ClipByValue",o,i)}}),Q7=xe({cos_:function(n){var e=se(n,"x","cos"),t=[e];return Te.runKernelFunc((function(r,i){var o=r.cos(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return o.toFloat().sin().neg().mul(r)}}}),"Cos",{},t)}}),J7=xe({cosh_:function(n){var e=se(n,"x","cosh");return Te.runKernelFunc((function(t,r){var i=t.cosh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(t)}}}))}}),Z7=xe({erf_:function(n){var e=se(n,"x","erf");return me(e.dtype==="int32"||e.dtype==="float32",(function(){return"Input dtype must be `int32` or `float32`."})),e.dtype==="int32"&&(e=e.toFloat()),Te.runKernelFunc((function(t,r){var i=t.erf(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),dw=xe({exp_:function(n){var e=se(n,"x","exp");return Te.runKernelFunc((function(t,r){var i=t.exp(e);return r([i]),i}),{x:e},(function(t,r){return{x:function(){return t.mulStrict(r[0])}}}),"Exp",{},[],[!0])}}),eV=xe({expm1_:function(n){var e=se(n,"x","expm1");return Te.runKernelFunc((function(t,r){var i=t.expm1(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.exp())}}}))}}),tV=xe({floor_:function(n){var e=se(n,"x","floor");return Te.runKernelFunc((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),nV=xe({log_:function(n){var e=se(n,"x","log"),t=[e];return Te.runKernelFunc((function(r,i){var o=r.log(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return r.div(o.toFloat())}}}),"Log",{},t)}}),rV=xe({log1p_:function(n){var e=se(n,"x","log1p");return Te.runKernelFunc((function(t,r){var i=t.log1p(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.add(1))}}}))}}),iV=xe({logSigmoid_:function(n){var e=se(n,"x","logSigmoid");return Te.runKernelFunc((function(t,r){var i=t.softplus(e.neg()).neg();return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.neg().sigmoid())}}}))}}),h0=xe({neg_:function(n){var e=se(n,"x","neg"),t=[e];return Te.runKernelFunc((function(r){return r.neg(e)}),{x:e},(function(r){return{x:function(){return r.neg()}}}),"Neg",{},t)}}),oV=xe({reciprocal_:function(n){var e=se(n,"x","reciprocal");return Te.runKernelFunc((function(t,r){var i=t.reciprocal(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.square().neg())}}}))}}),sV=xe({round_:function(n){var e=se(n,"x","round");return Te.runKernelFunc((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),wT=xe({rsqrt_:function(n){var e=se(n,"x","rsqrt"),t=[e];return Te.runKernelFunc((function(r,i){var o=r.rsqrt(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return r.div(o.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},t)}}),bT=xe({sigmoid_:function(n){var e=se(n,"x","sigmoid");return Te.runKernelFunc((function(t,r){var i=t.sigmoid(e);return r([i]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return t.mul(i.mul(dt(1).sub(i)))}}}),"Sigmoid")}}),aV=xe({sign_:function(n){var e=se(n,"x","sign");return Te.runKernelFunc((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),uV=xe({isNaN_:function(n){var e=se(n,"x","isNaN");return Te.runKernelFunc((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),lV=xe({isInf_:function(n){var e=se(n,"x","isInf");return Te.runKernelFunc((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),cV=xe({isFinite_:function(n){var e=se(n,"x","isFinite");return Te.runKernelFunc((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return zn(t)}}}))}}),hV=xe({sin_:function(n){var e=se(n,"x","sin"),t=[e];return Te.runKernelFunc((function(r,i){var o=r.sin(e);return i([e]),o}),{x:e},(function(r,i){var o=i[0];return{x:function(){return o.toFloat().cos().mul(r)}}}),"Sin",{},t)}}),fV=xe({sinh_:function(n){var e=se(n,"x","sinh");return Te.runKernelFunc((function(t,r){var i=t.sinh(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(t)}}}))}}),dV=xe({softplus_:function(n){var e=se(n,"x","softplus");return Te.runKernelFunc((function(t,r){var i=t.softplus(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.mul(i.sigmoid())}}}))}}),pV=xe({sqrt_:function(n){var e=se(n,"x","sqrt");return Te.runKernelFunc((function(t,r){var i=t.sqrt(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat().sqrt().mul(2))}}}))}}),mV=xe({step_:function(n,e){e===void 0&&(e=0);var t=se(n,"x","step");return Te.runKernelFunc((function(r){return r.step(t,e)}),{$x:t},(function(r){return{$x:function(){return zn(r)}}}))}}),gV=xe({tan_:function(n){var e=se(n,"x","tan");return Te.runKernelFunc((function(t,r){var i=t.tan(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return t.div(i.cos().square())}}}))}}),vV=xe({tanh_:function(n){var e=se(n,"x","tanh");return Te.runKernelFunc((function(t,r){var i=t.tanh(e);return r([i]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return dt(1).sub(i.square()).mulStrict(t)}}}),"Tanh",{},null,[!0])}});function xT(n,e,t,r,i,o){var s,a,u=se(n,"x","batchNorm"),l=se(e,"mean","batchNorm"),h=se(t,"variance","batchNorm");return i!=null&&(s=se(i,"scale","batchNorm")),r!=null&&(a=se(r,"offset","batchNorm")),me(u.rank===2,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),me(l.rank===2||l.rank===1,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."})),me(h.rank===2||h.rank===1,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+h.rank+"."})),s!=null&&me(s.rank===2||s.rank===1,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."})),a!=null&&me(a.rank===2||a.rank===1,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+a.rank+"."})),Hm(u,l,h,a,s,o)}function _T(n,e,t,r,i,o){var s,a,u=se(n,"x","batchNorm"),l=se(e,"mean","batchNorm"),h=se(t,"variance","batchNorm");return i!=null&&(s=se(i,"scale","batchNorm")),r!=null&&(a=se(r,"offset","batchNorm")),me(u.rank===3,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),me(l.rank===3||l.rank===1,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."})),me(h.rank===3||h.rank===1,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+h.rank+"."})),s!=null&&me(s.rank===3||s.rank===1,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."})),a!=null&&me(a.rank===3||a.rank===1,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+a.rank+"."})),Hm(u,l,h,a,s,o)}function ET(n,e,t,r,i,o){var s,a,u=se(n,"x","batchNorm"),l=se(e,"mean","batchNorm"),h=se(t,"variance","batchNorm");return i!=null&&(s=se(i,"scale","batchNorm")),r!=null&&(a=se(r,"offset","batchNorm")),me(u.rank===4,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),me(l.rank===4||l.rank===1,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."})),me(h.rank===4||h.rank===1,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+h.rank+"."})),s!=null&&me(s.rank===4||s.rank===1,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."})),a!=null&&me(a.rank===4||a.rank===1,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+a.rank+"."})),Hm(u,l,h,a,s,o)}function Hm(n,e,t,r,i,o){o==null&&(o=.001);var s,a,u,l=se(n,"x","batchNorm"),h=se(e,"mean","batchNorm"),d=se(t,"variance","batchNorm");i!=null&&(s=se(i,"scale","batchNorm")),r!=null&&(a=se(r,"offset","batchNorm")),me(h.rank===d.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),me(a==null||h.rank===a.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),me(s==null||h.rank===s.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var m=[l,h,d,s];return Te.runKernelFunc((function(p,y){var b=p.batchNormalization(u,nv(h),nv(d),o,nv(s),nv(a));return y([l,h,d,s]),b}),{x:l,mean:h,variance:d,scale:s,offset:a},(function(p,y){var b=y,x=b[0],E=b[1],T=b[2],P=b[3],C=P??dt(1),D=$i(E.shape,u.shape),z=[];if(E.rank===1){for(var L=0;L<u.shape.length-1;++L)z.push(u.shape[L]);z.push(1)}var I=x.sub(E),A=p.mul(C),O=wT(T.add(dt(o))),k=O.mul(O).mul(O).mul(dt(-.5));return{x:function(){return E.rank===1?p.mul(bd(O.as4D(1,1,1,E.shape[0]),z)).mul(C).reshape(x.shape):p.mul(O).mul(C).reshape(x.shape)},mean:function(){var M=O.mul(dt(-1)).mul(A);return E.rank===1&&(M=M.sum(D)),M.reshape(E.shape)},variance:function(){var M=k.mul(I).mul(A);return E.rank===1&&(M=M.sum(D)),M.reshape(E.shape)},scale:function(){var M=I.mul(O),j=p.mul(M);return E.rank===1&&(j=j.sum(D)),j.reshape(E.shape)},offset:function(){var M=p;return E.rank===1&&(M=M.sum(D)),M.reshape(E.shape)}}}),"BatchNormalization",{varianceEpsilon:o},m).reshape(l.shape)}function nv(n){return n==null?null:n.rank===0?n.as1D():n.rank===1?n:n.rank===2?n.as4D(1,1,n.shape[0],n.shape[1]):n.rank===3?n.as4D(1,n.shape[0],n.shape[1],n.shape[2]):n}function G0(){BI("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var yV=xe({batchNormalization2d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),G0(),xT(n,e,t,o,i,r)}}),wV=xe({batchNormalization3d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),G0(),_T(n,e,t,o,i,r)}}),bV=xe({batchNormalization4d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),G0(),ET(n,e,t,o,i,r)}}),xV=xe({batchNormalization_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),G0(),Hm(n,e,t,o,i,r)}}),ST=xe({batchNorm_:Hm}),_V=xe({batchNorm2d_:xT}),EV=xe({batchNorm3d_:_T}),SV=xe({batchNorm4d_:ET}),$0=xe({logicalAnd_:function(n,e){var t=se(n,"a","logicalAnd","bool"),r=se(e,"b","logicalAnd","bool");return Mn(t.shape,r.shape),Te.runKernelFunc((function(i){return i.logicalAnd(t,r)}),{a:t,b:r},null,"LogicalAnd")}}),AV=xe({logicalNot_:function(n){var e=se(n,"x","logicalNot","bool");return Te.runKernelFunc((function(t){return t.logicalNot(e)}),{$x:e})}}),AT=xe({logicalOr_:function(n,e){var t=se(n,"a","logicalOr","bool"),r=se(e,"b","logicalOr","bool");return Mn(t.shape,r.shape),Te.runKernelFunc((function(i){return i.logicalOr(t,r)}),{$a:t,$b:r})}}),CV=xe({logicalXor_:function(n,e){var t=se(n,"a","logicalXor","bool"),r=se(e,"b","logicalXor","bool");return Mn(t.shape,r.shape),AT(n,e).logicalAnd($0(n,e).logicalNot())}}),lf=xe({where_:function(n,e,t){var r=se(e,"a","where"),i=se(t,"b","where"),o=se(n,"condition","where","bool");return ir(r.shape,i.shape,"Error in where: "),o.rank===1?me(o.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):ir(o.shape,i.shape,"Error in where: "),Te.runKernelFunc((function(s,a){var u=s.select(o,r,i);return a([o]),u}),{$condition:o,$a:r,$b:i},(function(s,a){var u=a[0];return{$condition:function(){return zn(u).toFloat()},$a:function(){return s.mul(u.cast(s.dtype))},$b:function(){return s.mul(u.logicalNot().cast(s.dtype))}}}))}}),CT=function(n){return Nt(this,void 0,void 0,(function(){var e,t,r;return Rt(this,(function(i){switch(i.label){case 0:return[4,(e=se(n,"condition","whereAsync","bool")).data()];case 1:return t=i.sent(),r=Qb(e.shape,t),n!==e&&e.dispose(),[2,r]}}))}))},Dn=xe({add_:function(n,e){var t,r=se(n,"a","add"),i=se(e,"b","add");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Te.runKernelFunc((function(s){return s.add(r,i)}),{a:r,b:i},(function(s){return{a:function(){var a=s,u=$i(r.shape,o);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)},b:function(){var a=s,u=$i(i.shape,o);return u.length>0&&(a=a.sum(u)),a.reshape(i.shape)}}}),"Add")}}),IV=xe({addN_:function(n){me(Array.isArray(n),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),me(n.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+n.length}));var e=n.map((function(i,o){return se(i,"tensors"+o,"addN")})),t=e[0];e.forEach((function(i){if(i.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(i){if(!po(i.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=e;return Te.runKernelFunc((function(i){return i.addN(e)}),r,(function(i){var o={};return e.forEach((function(s,a){o[a]=function(){return i.clone()}})),o}),"AddN")}}),TV=xe({addStrict_:function(n,e){var t=se(n,"a","addStrict"),r=se(e,"b","addStrict");return ir(t.shape,r.shape,"Error in addStrict: "),t.add(r)}}),kV=xe({atan2_:function(n,e){var t,r=se(n,"a","atan2"),i=se(e,"b","atan2");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Te.runKernelFunc((function(s,a){var u=s.atan2(r,i);return a([r,i]),u}),{$a:r,$b:i},(function(s,a){var u=a[0],l=a[1];return{$a:function(){var h=Dn(u.square(),l.square()),d=s.mul(l.div(h)),m=$i(u.shape,o);return m.length>0&&(d=d.sum(m)),d.reshape(u.shape)},$b:function(){var h=Dn(u.square(),l.square()),d=h0(s.mul(u.div(h))),m=$i(l.shape,o);return m.length>0&&(d=d.sum(m)),d.reshape(l.shape)}}}))}}),gu=xe({div_:function(n,e){var t,r=se(n,"a","div"),i=se(e,"b","div");if(t=Jr(r,i),r=t[0],i=t[1],r.dtype==="int32"&&i.dtype==="int32")return IT(r,i);var o=Mn(r.shape,i.shape);return Te.runKernelFunc((function(s,a){var u=s.realDivide(r,i);return a([r,i]),u}),{a:r,b:i},(function(s,a){var u=a[0],l=a[1];return{a:function(){var h=s.div(l.toFloat()),d=$i(u.shape,o);return d.length>0?h.sum(d).reshape(u.shape):h},b:function(){var h=s.mul(u.toFloat()),d=$i(l.shape,o);d.length>0&&(h=h.sum(d).reshape(l.shape));var m=l.square();return h.div(m.toFloat()).neg()}}}),"Div")}}),NV=xe({divNoNan_:function(n,e){var t,r=se(n,"a","div"),i=se(e,"b","div");r=(t=Jr(r,i))[0],i=t[1];var o=gu(r,i),s=zn(o),a=i.equal(s);return lf(a,s,o)}}),RV=xe({divStrict_:function(n,e){var t=se(n,"a","div"),r=se(e,"b","div");return ir(t.shape,r.shape,"Error in divideStrict: "),t.div(r)}}),IT=xe({floorDiv_:function(n,e){var t,r=se(n,"a","floorDiv"),i=se(e,"b","floorDiv");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Te.runKernelFunc((function(s,a){var u=s.floorDiv(r,i);return a([r,i]),u}),{a:r,b:i},(function(s,a){var u=a[0],l=a[1];return{a:function(){var h=s.div(l.toFloat()),d=$i(u.shape,o);return d.length>0?h.sum(d).reshape(u.shape):h},b:function(){var h=s.mul(u.toFloat()),d=$i(l.shape,o);d.length>0&&(h=h.sum(d).reshape(l.shape));var m=l.square();return h.div(m.toFloat()).neg()}}}),"FloorDiv")}}),nx=xe({maximum_:function(n,e){var t,r=se(n,"a","maximum"),i=se(e,"b","maximum");return t=Jr(r,i),r=t[0],i=t[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Mn(r.shape,i.shape),Te.runKernelFunc((function(o,s){var a=o.maximum(r,i);return s([r,i]),a}),{a:r,b:i},(function(o,s){var a=s[0],u=s[1];return{a:function(){return o.mul(a.greaterEqual(u).toFloat())},b:function(){return o.mul(a.less(u).toFloat())}}}),"Maximum")}}),PV=xe({maximumStrict_:function(n,e){var t=se(n,"a","maximumStrict"),r=se(e,"b","maximumStrict");return ir(t.shape,r.shape,"Error in maximumStrict: "),t.maximum(r)}}),TT=xe({minimum_:function(n,e){var t,r=se(n,"a","minimum"),i=se(e,"b","minimum");return t=Jr(r,i),r=t[0],i=t[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Mn(r.shape,i.shape),Te.runKernelFunc((function(o,s){var a=o.minimum(r,i);return s([r,i]),a}),{a:r,b:i},(function(o,s){var a=s[0],u=s[1];return{a:function(){return o.mul(a.lessEqual(u).toFloat())},b:function(){return o.mul(a.greater(u).toFloat())}}}),"Minimum")}}),DV=xe({minimumStrict_:function(n,e){var t=se(n,"a","minimumStrict"),r=se(e,"b","minimumStrict");return ir(t.shape,r.shape,"Error in minimumStrict: "),t.minimum(r)}}),LV=xe({mod_:function(n,e){var t,r=se(n,"a","mod"),i=se(e,"b","mod");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Te.runKernelFunc((function(s,a){var u=s.mod(r,i);return a([r,i]),u}),{$a:r,$b:i},(function(s,a){var u=a[0],l=a[1];return{$a:function(){var h=$i(u.shape,o);return h.length>0?s.sum(h).reshape(u.shape):s},$b:function(){var h=s.mul(u.div(l).floor().neg()),d=$i(l.shape,o);return d.length>0?h.sum(d).reshape(l.shape):h}}}))}}),MV=xe({modStrict_:function(n,e){var t=se(n,"a","modStrict"),r=se(e,"b","modStrict");return ir(t.shape,r.shape,"Error in modStrict: "),t.mod(r)}}),us=xe({mul_:function(n,e){var t,r=se(n,"a","mul"),i=se(e,"b","mul");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Te.runKernelFunc((function(s,a){var u=s.multiply(r,i);return a([r,i]),u}),{a:r,b:i},(function(s,a){var u=a[0],l=a[1];return{a:function(){var h=s.mul(l.toFloat()),d=$i(u.shape,o);return d.length>0?h.sum(d).reshape(u.shape):h},b:function(){var h=s.mul(u.toFloat()),d=$i(l.shape,o);return d.length>0?h.sum(d).reshape(l.shape):h}}}),"Mul")}}),OV=xe({mulStrict_:function(n,e){var t=se(n,"a","mul"),r=se(e,"b","mul");return ir(t.shape,r.shape,"Error in multiplyStrict: "),t.mul(r)}}),f0=xe({pow_:function(n,e){var t,r=se(n,"base","pow"),i=se(e,"exp","pow");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape),s=[r,i];return Te.runKernelFunc((function(a,u){var l=a.pow(r,i);return u([r,i,l]),l}),{a:r,b:i},(function(a,u){var l=u[0],h=u[1],d=u[2];return{a:function(){var m=h.toFloat(),p=a.mul(m.mul(l.pow(m.sub(dt(1))))),y=$i(l.shape,o);return y.length>0&&(p=p.sum(y)),p.reshape(l.shape)},b:function(){var m=l.greater(0),p=l.log().where(m,zn(l)),y=a.mul(d.mul(p)),b=$i(h.shape,o);return b.length>0&&(y=y.sum(b)),y.reshape(h.shape)}}}),"Pow",{},s,[!0])}}),FV=xe({powStrict_:function(n,e){return ir(n.shape,e.shape,"Error in powStrict: "),n.pow(e)}}),BV=xe({squaredDifferenceStrict_:function(n,e){var t=se(n,"a","squaredDifferenceStrict"),r=se(e,"b","squaredDifferenceStrict");return ir(t.shape,r.shape,"Error in squaredDifferenceStrict: "),t.squaredDifference(r)}}),Ki=xe({sub_:function(n,e){var t,r=se(n,"a","sub"),i=se(e,"b","sub");t=Jr(r,i),r=t[0],i=t[1];var o=Mn(r.shape,i.shape);return Te.runKernelFunc((function(s){return s.subtract(r,i)}),{a:r,b:i},(function(s){return{a:function(){var a=s,u=$i(r.shape,o);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)},b:function(){var a=s,u=$i(i.shape,o);return u.length>0&&(a=a.sum(u)),a.neg().reshape(i.shape)}}}),"Sub")}}),VV=xe({subStrict_:function(n,e){var t=se(n,"a","subStrict"),r=se(e,"b","subStrict");return ir(t.shape,r.shape,"Error in subStrict: "),t.sub(r)}}),kT=xe({equal_:function(n,e){var t,r=se(n,"a","equal"),i=se(e,"b","equal");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Te.runKernelFunc((function(o){return o.equal(r,i)}),{$a:r,$b:i})}}),jV=xe({equalStrict_:function(n,e){var t=se(n,"a","equalStrict"),r=se(e,"b","equalStrict");return ir(t.shape,r.shape,"Error in equalStrict: "),t.equal(r)}}),UV=xe({greater_:function(n,e){var t,r=se(n,"a","greater"),i=se(e,"b","greater");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Te.runKernelFunc((function(o){return o.greater(r,i)}),{a:r,b:i},null,"Greater")}}),NT=xe({greaterEqual_:function(n,e){var t,r=se(n,"a","greaterEqual"),i=se(e,"b","greaterEqual");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Te.runKernelFunc((function(o,s){var a=o.greaterEqual(r,i);return s([r,i]),a}),{a:r,b:i},(function(o,s){var a=s[0],u=s[1];return{a:function(){return zn(a)},b:function(){return zn(u)}}}),"GreaterEqual")}}),zV=xe({greaterEqualStrict_:function(n,e){var t=se(n,"a","greaterEqualStrict"),r=se(e,"b","greaterEqualStrict");return ir(t.shape,r.shape,"Error in greaterEqualStrict: "),t.greaterEqual(r)}}),WV=xe({greaterStrict_:function(n,e){var t=se(n,"a","greaterStrict"),r=se(e,"b","greaterStrict");return ir(t.shape,r.shape,"Error in greaterStrict: "),t.greater(r)}}),qV=xe({less_:function(n,e){var t,r=se(n,"a","less"),i=se(e,"b","less");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Te.runKernelFunc((function(o){return o.less(r,i)}),{a:r,b:i},null,"Less")}}),HV=xe({lessEqual_:function(n,e){var t,r=se(n,"a","lessEqual"),i=se(e,"b","lessEqual");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Te.runKernelFunc((function(o,s){var a=o.lessEqual(r,i);return s([r,i]),a}),{a:r,b:i},null,"LessEqual")}}),GV=xe({lessEqualStrict_:function(n,e){var t=se(n,"a","lessEqualStrict"),r=se(e,"b","lessEqualStrict");return ir(t.shape,r.shape,"Error in lessEqualStrict: "),t.lessEqual(r)}}),$V=xe({lessStrict_:function(n,e){var t=se(n,"a","lessStrict"),r=se(e,"b","lessStrict");return ir(t.shape,r.shape,"Error in lessStrict: "),t.less(r)}}),KV=xe({notEqual_:function(n,e){var t,r=se(n,"a","notEqual"),i=se(e,"b","notEqual");return t=Jr(r,i),r=t[0],i=t[1],Mn(r.shape,i.shape),Te.runKernelFunc((function(o){return o.notEqual(r,i)}),{a:r,b:i},null,"NotEqual")}}),XV=xe({notEqualStrict_:function(n,e){var t=se(n,"a","notEqualStrict"),r=se(e,"b","notEqualStrict");return ir(t.shape,r.shape,"Error in notEqualStrict: "),t.notEqual(r)}});function NS(n,e){for(var t=[],r=n;r<e;++r)t.push(r);return t}function RS(n){for(var e=[],t=0;t<n.length;++t)for(var r=0;r<n[t].length;++r)e.push(n[t][r]);return e}var rx=xe({gather_:function(n,e,t){t===void 0&&(t=0);var r=se(n,"x","gather"),i=se(e,"indices","gather","int32");t=Xi(t,r.shape)[0];var o=(function(s,a,u){for(var l=s.shape[u],h=[],d=1,m=1,p=0;p<u;p++)h.push(s.shape[p]),d*=s.shape[p];for(p=0;p<a.rank;p++)h.push(a.shape[p]);for(p=u+1;p<s.rank;p++)h.push(s.shape[p]),m*=s.shape[p];return{batchSize:d,sliceSize:m,dimSize:l,outputShape:h}})(r,i,t);return Te.runKernelFunc((function(s,a){var u=s.gather(r,i.flatten(),t);return a([i]),u}),{x:r,indices:i},(function(s,a){var u=a[0];return{x:function(){var l=r.shape,h=u.size,d=l.slice(0,t),m=d.length,p=l.slice(t,l.length).slice(1),y=p.length,b=NS(0,m),x=NS(m+1,m+1+y),E=RS([d,[h],p]),T=s.reshape(E),P=u.reshape([h]),C=RS([[m],b,x]),D=T.transpose(C),z=RT(D,P,r.shape[t]),L=Wb(C);return z=z.transpose(L)},indices:function(){return u}}}),"Gather",{axis:t}).reshape(o.outputShape)}}),RT=xe({unsortedSegmentSum_:function(n,e,t){var r=se(n,"x","unsortedSegmentSum"),i=se(e,"segmentIds","unsortedSegmentSum","int32");return me(xi(t),(function(){return"numSegments must be of dtype int"})),Te.runKernelFunc((function(o,s){var a=o.unsortedSegmentSum(r,i,t);return s([i]),a}),{$x:r},(function(o,s){var a=s[0];return{$x:function(){return(function(u,l){for(var h=nx(l,zn(l)),d=rx(u,h),m=NT(l,dt(0,"int32")),p=d.rank-m.rank,y=0;y<p;++y)m=Wa(m,y+1);m=$0(m,rp(d.shape,"bool"));var b=zn(d);return lf(m,d,b)})(o,a)}}}))}}),YV=function(n,e,t){return Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d,m,p,y,b;return Rt(this,(function(x){switch(x.label){case 0:for(r=se(n,"tensor","boolMask"),i=se(e,"mask","boolMask","bool"),o=t??0,s=i.rank,a=r.shape,me(s>0,(function(){return"mask cannot be scalar"})),ir(a.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=o;l<o+s;l++)u*=a[l];return h=a.slice(0,o).concat([u],a.slice(o+s)),d=r.reshape(h),m=i.reshape([-1]),[4,CT(m)];case 1:return p=x.sent(),y=p.squeeze([1]),b=rx(d,y,o),n!==r&&r.dispose(),e!==i&&i.dispose(),y.dispose(),d.dispose(),m.dispose(),p.dispose(),[2,b]}}))}))};function PT(n,e,t,r,i,o,s){o===void 0&&(o="NHWC"),me(n.length===e.rank,(function(){return"Length of inShape ("+n.length+") and rank of dy ("+e.rank+") must match"}));var a=n,u=e,l=!1;e.rank===3&&(l=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),a=[1,n[0],n[1],n[2]]),me(a.length===4,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+a.length+"."})),me(u.rank===4,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),me(t.rank===4,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+t.rank}));var h=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?u.shape[3]:u.shape[1];me(h===t.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+h+") must match input depth for filter "+t.shape[2]+"."})),me(d===t.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+t.shape[3]+"."})),s!=null&&me(xi(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+i+"."}));var m=Kb(o),p=bf(a,t.shape,r,1,i,s,!1,m),y=Te.runKernelFunc((function(b,x){var E=b.conv2dDerInput(u,t,p);return x([t,u]),E}),{dy4D:u,filter:t},(function(b,x){var E=x[0],T=x[1];return{dy4D:function(){return $a(b,E,r,i,o,1,s)},filter:function(){return ix(b,T,E.shape,r,i,o,s)}}}));return l?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}function qy(n){var e=(function(o){return typeof o=="number"?[o,o,o]:o.length===2?[o[0],o[1],1]:o})(n),t=e[0],r=e[1],i=e[2];return t===1&&r===1&&i===1}function DT(n,e,t,r,i){me(n.length===e.rank,(function(){return"Length of inShape ("+n.length+") and rank of dy ("+e.rank+") must match"}));var o=n,s=e,a=!1;e.rank===4&&(a=!0,s=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,n[0],n[1],n[2],n[3]]);var u=o[4],l=s.shape[4];me(o.length===5,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."})),me(s.rank===5,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank})),me(t.rank===5,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+t.rank})),me(u===t.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+t.shape[3]+"."})),me(l===t.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+t.shape[4]+"."}));var h=l0(o,t.shape,r,1,i),d=Te.runKernelFunc((function(m){return m.conv3dDerInput(s,t,h)}),{dy5D:s});return a?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var QV=xe({conv1d_:function(n,e,t,r,i,o,s){i===void 0&&(i="NWC"),o===void 0&&(o=1);var a=se(n,"x","conv1d"),u=se(e,"filter","conv1d"),l=a,h=!1;a.rank===2&&(h=!0,l=a.as3D(1,a.shape[0],a.shape[1])),me(l.rank===3,(function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."})),me(u.rank===3,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),s!=null&&me(xi(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."})),me(l.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),me(Gs(t,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+t+" and dilation '"+o+"'"})),me(i==="NWC",(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),m=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),p=$a(m,d,[1,t],r,"NHWC",[1,o],s);return h?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),$a=xe({conv2d_:function(n,e,t,r,i,o,s){i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]);var a=se(n,"x","conv2d"),u=se(e,"filter","conv2d"),l=a,h=!1;a.rank===3&&(h=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),me(l.rank===4,(function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."})),me(u.rank===4,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),s!=null&&me(xi(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}));var d=i==="NHWC"?l.shape[3]:l.shape[1];me(d===u.shape[2],(function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."})),me(Gs(t,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"}));var m=Kb(i),p=bf(l.shape,u.shape,t,o,r,s,!1,m),y=[u,l],b=Te.runKernelFunc((function(x,E){var T=x.conv2d(l,u,p);return E([u,l]),T}),{x:l,filter:u},(function(x,E){var T=E,P=T[0],C=T[1];return me(qd(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"})),{x:function(){return LT(C.shape,x,P,t,r,i)},filter:function(){return ix(C,x,P.shape,t,r,i)}}}),"Conv2D",p,y);return h?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),JV=xe({conv3d_:function(n,e,t,r,i,o){i===void 0&&(i="NDHWC"),o===void 0&&(o=[1,1,1]);var s=se(n,"x","conv3d"),a=se(e,"filter","conv3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),me(u.rank===5,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),me(a.rank===5,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+a.rank+"."})),me(u.shape[4]===a.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+a.shape[3]+"."})),me((function(m,p){return qy(m)||qy(p)})(t,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"})),me(i==="NDHWC",(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var h=l0(u.shape,a.shape,t,o,r),d=Te.runKernelFunc((function(m,p){var y=m.conv3d(u,a,h);return p([u,a]),y}),{x:u,$filter:a},(function(m,p){me(qy(o),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}));var y=p[0],b=p[1];return{x:function(){return DT(y.shape,m,b,t,r)},$filter:function(){return(function(x,E,T,P,C){var D=x;x.rank===4&&(D=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]));var z=E;z.rank===4&&(z=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),me(D.rank===5,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+D.shape+"."})),me(z.rank===5,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+z.shape+"."})),me(T.length===5,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+T+"."})),me(D.shape[4]===T[3],(function(){return"Error in conv3dDerFilter: depth of input "+D.shape[4]+") must match input depth in filter ("+T[3]+"."})),me(z.shape[4]===T[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+z.shape[4]+") must match output depth for filter ("+T[4]+")."}));var L=l0(D.shape,T,P,1,C);return Te.runKernelFunc((function(I){return I.conv3dDerFilter(D,z,L)}),{x5D:D,dy5D:z})})(y,m,b.shape,t,r)}}}));return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),ix=xe({conv2dDerFilter_:function(n,e,t,r,i,o,s){o===void 0&&(o="NHWC");var a=n;n.rank===3&&(a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var u=e;u.rank===3&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),me(a.rank===4,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+a.shape+"."})),me(u.rank===4,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),me(t.length===4,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+t+"."}));var l=o==="NHWC"?a.shape[3]:a.shape[1],h=o==="NHWC"?u.shape[3]:u.shape[1];me(l===t[2],(function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+t[2]+"."})),me(h===t[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+h+") must match output depth for filter ("+t[3]+")."})),s!=null&&me(xi(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+i+"."}));var d=Kb(o),m=bf(a.shape,t,r,1,i,s,!1,d);return Te.runKernelFunc((function(p){return p.conv2dDerFilter(a,u,m)}),{x4D:a,dy4D:u})}}),LT=xe({conv2dDerInput_:PT}),K0=xe({depthwiseConv2d_:function(n,e,t,r,i,o,s){o===void 0&&(o=[1,1]);var a=se(n,"x","depthwiseConv2d"),u=se(e,"filter","depthwiseConv2d"),l=a,h=!1;a.rank===3&&(h=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),me(l.rank===4,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."})),me(u.rank===4,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),me(l.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),o==null&&(o=[1,1]),me(Gs(t,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"})),s!=null&&me(xi(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}));var d=bf(l.shape,u.shape,t,o,r,s,!0),m=[l,u],p=Te.runKernelFunc((function(y,b){var x=y.depthwiseConv2D(l,u,d);return b([l,u]),x}),{x:l,filter:u},(function(y,b){me(qd(o),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var x=b[0],E=b[1];return{x:function(){return MT(x.shape,y,E,d)},filter:function(){return OT(x,y,E.shape,d)}}}),"DepthwiseConv2dNative",d,m);return h?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),MT=xe({depthwiseConv2dDerInput_:function(n,e,t,r){var i=e,o=!1;e.rank===3&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var s=Te.runKernelFunc((function(a){return a.depthwiseConv2DDerInput(i,t,r)}),{dy4D:i});return o?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),OT=xe({depthwiseConv2dDerFilter_:function(n,e,t,r){var i=n;n.rank===3&&(i=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var o=e;return o.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),Te.runKernelFunc((function(s){return s.depthwiseConv2DDerFilter(i,o,r)}),{x4D:i,dy4D:o})}}),ox=xe({separableConv2d_:function(n,e,t,r,i,o,s){o===void 0&&(o=[1,1]),s===void 0&&(s="NHWC");var a=se(n,"x","separableConv2d"),u=se(e,"depthwiseFilter","separableConv2d"),l=se(t,"pointwiseFilter","separableConv2d"),h=a,d=!1;if(a.rank===3&&(d=!0,h=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");me(h.rank===4,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+h.rank+"."})),me(u.rank===4,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),me(l.rank===4,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),me(l.shape[0]===1,(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."})),me(l.shape[1]===1,(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."}));var m=u.shape[2],p=u.shape[3];me(l.shape[2]===m*p,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+m*p+", but got "+l.shape[2]+"."}));var y=K0(h,u,r,i,s,o),b=$a(y,l,1,"valid",s);return d?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),ZV=xe({conv2dTranspose_:function(n,e,t,r,i,o){return PT(t,se(n,"x","conv2dTranspose"),se(e,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),ej=xe({conv3dTranspose_:function(n,e,t,r,i){return DT(t,se(n,"x","conv3dTranspose"),se(e,"filter","conv3dTranspose"),r,i)}}),X0=xe({matMul_:function(n,e,t,r){var i;t===void 0&&(t=!1),r===void 0&&(r=!1);var o=se(n,"a","matMul"),s=se(e,"b","matMul");i=Jr(o,s),o=i[0],s=i[1];var a=t?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?s.shape[s.rank-1]:s.shape[s.rank-2],l=t?o.shape[o.rank-1]:o.shape[o.rank-2],h=r?s.shape[s.rank-2]:s.shape[s.rank-1],d=o.shape.slice(0,-2),m=s.shape.slice(0,-2),p=Mt(d),y=Mt(m);me(o.rank>=2&&s.rank>=2&&o.rank===s.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+s.rank+"."})),me(po(d,m),(function(){return"Error in matMul: outer dimensions ("+d+") and ("+m+") of Tensors with shapes "+o.shape+" and "+s.shape+" must match."})),me(a===u,(function(){return"Error in matMul: inner shapes ("+a+") and ("+u+") of Tensors with shapes "+o.shape+" and "+s.shape+" and transposeA="+t+" and transposeB="+r+" must match."}));var b=o.shape.slice(0,-2).concat([l,h]),x=t?o.as3D(p,a,l):o.as3D(p,l,a),E=r?s.as3D(y,h,u):s.as3D(y,u,h),T={transposeA:t,transposeB:r};return Te.runKernelFunc((function(P,C){var D=P.batchMatMul(x,E,t,r);return C([x,E]),D}),{a:x,b:E},(function(P,C){var D=C,z=D[0],L=D[1];return t||r?!t&&r?{a:function(){return P.matMul(L,!1,!1)},b:function(){return P.matMul(z,!0,!1)}}:t&&!r?{a:function(){return L.matMul(P,!1,!0)},b:function(){return z.matMul(P,!1,!1)}}:{a:function(){return L.matMul(P,!0,!0)},b:function(){return P.matMul(z,!0,!0)}}:{a:function(){return P.matMul(L,!1,!0)},b:function(){return z.matMul(P,!0,!1)}}}),"BatchMatMul",T).reshape(b)}}),tj=xe({dot_:function(n,e){var t=se(n,"t1","dot"),r=se(e,"t2","dot");me(!(t.rank!==1&&t.rank!==2||r.rank!==1&&r.rank!==2),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+t.rank+" and "+r.rank+"."}));var i=t.rank===1?t.size:t.shape[1],o=r.rank===1?r.size:r.shape[0];return me(i===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."})),t.rank===1&&r.rank===1?t.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():t.rank===1&&r.rank===2?t.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():t.rank===2&&r.rank===1?t.matMul(r.as2D(-1,1)).as1D():t.matMul(r.as2D(r.shape[0],r.shape[1]))}}),nj=xe({outerProduct_:function(n,e){var t=se(n,"v1","outerProduct"),r=se(e,"v2","outerProduct");return me(t.rank===1&&r.rank===1,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+t.rank+" and "+r.rank+"."})),t.as2D(-1,1).matMul(r.as2D(1,-1))}}),Gm=xe({reverse_:function(n,e){var t=se(n,"x","reverse");if(t.rank===0)return t.clone();var r=Xi(e,t.shape);return Te.runKernelFunc((function(i){return i.reverse(t,r)}),{$x:t},(function(i){return{$x:function(){return i.reverse(r)}}})).reshapeAs(t)}}),rj=xe({reverse1d_:function(n){var e=se(n,"x","reverse");return me(e.rank===1,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),Gm(e,0)}}),ij=xe({reverse2d_:function(n,e){var t=se(n,"x","reverse");return me(t.rank===2,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+t.rank+"."})),Gm(t,e)}}),oj=xe({reverse3d_:function(n,e){var t=se(n,"x","reverse");return me(t.rank===3,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+t.rank+"."})),Gm(t,e)}}),sj=xe({reverse4d_:function(n,e){var t=se(n,"x","reverse");return me(t.rank===4,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+t.rank+"."})),Gm(t,e)}});function FT(n,e,t,r,i,o){var s=se(n,"x","maxPool"),a=s,u=!1;s.rank===3&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),me(a.rank===4,(function(){return"Error in maxPool: input must be rank 4 but got rank "+a.rank+"."})),me(Gs(t,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"})),o!=null&&me(xi(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var l=_m(a.shape,e,t,r,i,o);if(l.filterWidth===1&&l.filterHeight===1&&po(l.inShape,l.outShape))return s.clone();var h=[a],d=Te.runKernelFunc((function(m,p){var y=m.maxPool(a,l);return p([a,y]),y}),{x:a},(function(m,p){var y=p[0],b=p[1];return{x:function(){return(function(x,E,T,P,C,D,z,L){var I=se(x,"dy","maxPoolBackprop"),A=se(E,"input","maxPoolBackprop"),O=se(T,"output","maxPoolBackprop");me(A.rank===I.rank,(function(){return"Rank of input ("+A.rank+") does not match rank of dy ("+I.rank+")"})),me(Gs(C,D),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+C+" and dilations '"+D+"'"})),me(I.rank===4,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+I.rank+"."})),me(A.rank===4,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+A.rank+"."}));var k=_m(A.shape,P,C,D,z,L);return Te.runKernelFunc((function(M){return M.maxPoolBackprop(I,A,O,k)}),{$dy:I,$input:A})})(m,y,b,e,t,r,i)}}}),"MaxPool",l,h);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function BT(n,e,t,r,i,o){var s=se(n,"x","avgPool","float32");me(Gs(t,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"}));var a=s,u=!1;s.rank===3&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),me(a.rank===4,(function(){return"Error in avgPool: x must be rank 4 but got rank "+a.rank+"."})),o!=null&&me(xi(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var l=_m(a.shape,e,t,r,i,o);if(l.filterWidth===1&&l.filterHeight===1&&po(l.inShape,l.outShape))return s.clone();var h=Te.runKernelFunc((function(d){return d.avgPool(a,l)}),{x:a},(function(d){return{x:function(){return(function(m,p,y,b,x,E){var T=se(m,"dy","avgPoolBackprop"),P=se(p,"input","avgPoolBackprop");me(P.rank===T.rank,(function(){return"Rank of input ("+P.rank+") does not match rank of dy ("+T.rank+")"})),me(Gs(b,x),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+x+"'"}));var C=P,D=T,z=!1;P.rank===3&&(z=!0,C=P.as4D(1,P.shape[0],P.shape[1],P.shape[2]),D=T.as4D(1,T.shape[0],T.shape[1],T.shape[2])),me(D.rank===4,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+D.rank+"."})),me(C.rank===4,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+C.rank+"."}));var L=_m(C.shape,y,b,x,E),I=Te.runKernelFunc((function(A){return A.avgPoolBackprop(D,C,L)}),{dy4D:D,input4D:C});return z?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I})(d,a,e,t,r,i)}}}),"AvgPool",l);return h=h.cast(s.dtype),u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}var co=xe({maxPool_:function(n,e,t,r,i){return FT(n,e,t,1,r,i)}}),$m=xe({avgPool_:function(n,e,t,r,i){return BT(n,e,t,1,r,i)}}),aj=xe({pool_:function(n,e,t,r,i,o){i==null&&(i=[1,1]),o==null&&(o=1),r===0&&(r="valid");var s=se(n,"x","maxPool"),a=s,u=!1;s.rank===3&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),me(Gs(o,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"}));var l,h=_m(a.shape,e,o,i,r),d=[h.dilationHeight,h.dilationWidth];l=r==="same"?(function(C,D){var z=C.map((function(A,O){return A+(A-1)*(D[O]-1)})).map((function(A){return A-1})),L=z.map((function(A){return Math.floor(A/2)})),I=z.map((function(A,O){return A-L[O]}));return z.map((function(A,O){return[L[O],I[O]]}))})([h.filterHeight,h.filterWidth],d):[[0,0],[0,0]];var m=d[0]===1&&d[1]===1,p=(function(C,D,z){var L=z.map((function(X){return X[0]})),I=z.map((function(X){return X[1]})),A=C.concat(L,I),O=D.map((function(X,ue){return(X-A[ue]%X)%X})),k=I.map((function(X,ue){return X+O[ue]})),M=D.map((function(X,ue){return[L[ue],k[ue]]})),j=D.map((function(X,ue){return[0,O[ue]]}));return[M,j]})([h.inHeight,h.inWidth],d,l),y=p[0],b=p[1],x=m?r:"valid",E=m?a:qI(a,d,y),T=(t==="avg"?function(){return BT(E,e,o,1,x)}:function(){return FT(E,e,o,1,x)})(),P=m?T:UI(T,d,b);return u?P.as3D(P.shape[1],P.shape[2],P.shape[3]):P}}),uj=xe({maxPool3d_:function(n,e,t,r,i,o,s){o===void 0&&(o="NDHWC");var a=se(n,"x","maxPool3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),s==null&&(s=[1,1,1]),me(u.rank===5,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),me(o==="NDHWC",(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),me(Gs(t,s),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"})),i!=null&&me(xi(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var h=u0(u.shape,e,t,s,r,i,o),d=Te.runKernelFunc((function(m,p){var y=m.maxPool3d(u,h);return p([u,y]),y}),{x:u},(function(m,p){var y=p[0],b=p[1];return{x:function(){return(function(x,E,T,P,C,D,z,L){var I=se(x,"dy","maxPool3dBackprop"),A=se(E,"input","maxPool3dBackprop"),O=se(T,"output","maxPool3dBackprop"),k=I,M=A,j=O,X=!1;A.rank===4&&(X=!0,k=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3]),M=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3]),j=O.as5D(1,O.shape[0],O.shape[1],O.shape[2],O.shape[3])),me(k.rank===5,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+k.rank+"."})),me(M.rank===5,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+M.rank+"."})),me(j.rank===5,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+j.rank+"."})),D==null&&(D=[1,1,1]),me(Gs(C,D),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+C+" and dilations '"+D+"'"})),L!=null&&me(xi(z),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+L+" but got pad "+z+"."}));var ue=u0(M.shape,P,C,D,z,L),ge=Te.runKernelFunc((function(ce){return ce.maxPool3dBackprop(k,M,j,ue)}),{dy5D:k,input5D:M});return X?ge.as4D(ge.shape[1],ge.shape[2],ge.shape[3],ge.shape[4]):ge})(m,y,b,e,t,s,r,i)}}}));return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),lj=xe({avgPool3d_:function(n,e,t,r,i,o,s){o===void 0&&(o="NDHWC");var a=se(n,"x","avgPool3d","float32"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),s==null&&(s=[1,1,1]),me(u.rank===5,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),me(o==="NDHWC",(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),me(Gs(t,s),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"})),i!=null&&me(xi(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var h=u0(u.shape,e,t,s,r,i,o),d=Te.runKernelFunc((function(m){return m.avgPool3d(u,h)}),{x:u},(function(m){return{x:function(){return(function(p,y,b,x,E,T,P){var C=se(p,"dy","avgPool3dBackprop"),D=se(y,"input","avgPool3dBackprop"),z=C,L=D,I=!1;D.rank===4&&(I=!0,z=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),L=D.as5D(1,D.shape[0],D.shape[1],D.shape[2],D.shape[3])),me(z.rank===5,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+z.rank+"."})),me(L.rank===5,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+L.rank+"."})),E==null&&(E=[1,1,1]),me(Gs(x,E),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+E+"'"})),P!=null&&me(xi(T),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+P+" but got pad "+T+"."}));var A=u0(L.shape,b,x,E,T,P),O=Te.runKernelFunc((function(k){return k.avgPool3dBackprop(z,L,A)}),{dy5D:z,input5D:L});return I?O.as4D(O.shape[1],O.shape[2],O.shape[3],O.shape[4]):O})(m,u,e,t,s,r,i)}}}));return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),pl=xe({slice_:function(n,e,t){var r,i,o=se(n,"x","slice");if(o.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof e=="number"?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice()).forEach((function(u){me(u!==-1,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=t==null?new Array(o.rank).fill(-1):typeof t=="number"?[t].concat(new Array(o.rank-1).fill(-1)):t.length<o.rank?t.concat(new Array(o.rank-t.length).fill(-1)):t).map((function(u,l){return u>=0?u:(me(u===-1,(function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."})),o.shape[l]-r[l])})),F8(o,r,i);var s=o.shape,a={begin:r,size:i};return Te.runKernelFunc((function(u){return u.slice(o,r,i)}),{x:o},(function(u){for(var l=[],h=0;h<u.rank;h++)l.push([r[h],s[h]-r[h]-i[h]]);return{x:function(){return u.pad(l)}}}),"Slice",a)}}),cj=xe({slice1d_:function(n,e,t){var r=se(n,"x","slice1d");return me(r.rank===1,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),pl(r,[e],[t])}}),hj=xe({slice2d_:function(n,e,t){var r=se(n,"x","slice2d");return me(r.rank===2,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),pl(r,e,t)}}),VT=xe({slice3d_:function(n,e,t){var r=se(n,"x","slice3d");return me(r.rank===3,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),pl(r,e,t)}}),fj=xe({slice4d_:function(n,e,t){var r=se(n,"x","slice4d");return me(r.rank===4,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),pl(r,e,t)}});function jT(n,e,t,r,i){return e.rank<t.rank&&(e=e.reshape(Hs(e.shape,r))),n.rank<t.rank&&(n=n.reshape(Hs(n.shape,r))),{x:function(){var o=n.mul(t.equal(e).cast(n.dtype));return i==null?o:o.transpose(i)}}}var dj=xe({all_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=se(n,"x","all","bool"),i=Xi(e,r.shape),o=i,s=yl(o,r.rank);s!=null&&(r=r.transpose(s),o=wl(o.length,r.rank));var a=Te.runKernelFunc((function(l){return l.all(r,o)}),{$x:r});if(t){var u=Hs(a.shape,i);return a.reshape(u)}return a}}),pj=xe({any_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=se(n,"x","any","bool"),i=Xi(e,r.shape),o=i,s=yl(o,r.rank);s!=null&&(r=r.transpose(s),o=wl(o.length,r.rank));var a=Te.runKernelFunc((function(l){return l.any(r,o)}),{$x:r});if(t){var u=Hs(a.shape,i);return a.reshape(u)}return a}}),mj=xe({argMax_:function(n,e){e===void 0&&(e=0);var t=se(n,"x","argMax");e==null&&(e=0);var r=Xi(e,t.shape),i=yl(r,t.rank);i!=null&&(t=t.transpose(i),r=wl(r.length,t.rank));var o={axis:r[0]},s=[t];return Te.runKernelFunc((function(a,u){var l=a.argMax(t,r[0]);return u([t]),l}),{x:t},(function(a,u){var l=u[0];return{x:function(){return zn(l)}}}),"ArgMax",o,s)}}),gj=xe({argMin_:function(n,e){e===void 0&&(e=0);var t=se(n,"x","argMin");e==null&&(e=0);var r=Xi(e,t.shape),i=yl(r,t.rank);return i!=null&&(t=t.transpose(i),r=wl(r.length,t.rank)),Te.runKernelFunc((function(o,s){var a=o.argMin(t,r[0]);return s([t]),a}),{$x:t},(function(o,s){var a=s[0];return{$x:function(){return zn(a)}}}))}}),vj=xe({logSumExp_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=se(n,"x","logSumExp"),i=Xi(e,r.shape),o=r.max(i,!0),s=r.sub(o).exp().sum(i).log(),a=o.reshape(s.shape).add(s);if(t){var u=Hs(a.shape,i);return a.reshape(u)}return a}}),Y0=xe({max_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=se(n,"x","max"),i=r,o=Xi(e,r.shape),s=o,a=yl(s,r.rank);a!=null&&(r=r.transpose(a),s=wl(s.length,r.rank));var u=[r],l=Te.runKernelFunc((function(d,m){var p=d.max(r,s);return m([i,p]),p}),{x:r},(function(d,m){return jT(d,m[1],m[0],o,a)}),"Max",{axes:s},u,[!0]);if(t){var h=Hs(l.shape,o);l=l.reshape(h)}return l}}),yj=xe({mean_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=se(n,"x","mean"),i=Xi(e,r.shape),o=Mt(ts(r.shape,i)[1]);return H0((function(s){var a=dt(o);return{value:(a.dtype===s.dtype?s:s.cast(a.dtype)).div(a).sum(e,t),gradFunc:function(u){var l=s.shape.slice();return i.forEach((function(h){l[h]=1})),u.reshape(l).mul(rp(s.shape,"float32")).div(o)}}}))(r)}}),wj=xe({min_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=se(n,"x","min"),i=r,o=Xi(e,r.shape),s=o,a=yl(s,r.rank);a!=null&&(r=r.transpose(a),s=wl(s.length,r.rank));var u=[r],l=Te.runKernelFunc((function(d,m){var p=d.min(r,s);return m([i,p]),p}),{x:r},(function(d,m){return jT(d,m[1],m[0],o,a)}),"Min",{axes:s},u,[!0]);if(t){var h=Hs(l.shape,o);l=l.reshape(h)}return l}}),bj=xe({moments_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Xi(e,(n=se(n,"x","moments")).shape),i=n.mean(r,t),o=i.shape;t||(o=Hs(i.shape,r));var s=n.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:s.mean(r,t)}}}),UT=xe({sum_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=se(n,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=Xi(e,r.shape);return H0((function(o){var s=yl(i,o.rank),a=i,u=o;s!=null&&(u=o.transpose(s),a=wl(a.length,o.rank));var l=function(p){var y=o.shape.slice();return i.forEach((function(b){y[b]=1})),p.reshape(y).mul(rp(o.shape,"float32"))},h={axes:a},d=Te.runKernelFunc((function(p){return p.sum(u,a)}),{x:u},(function(p){return{x:function(){return l(p)}}}),"Sum",h);if(t){var m=Hs(d.shape,i);d=d.reshape(m)}return{value:d,gradFunc:l}}))(r)}}),xj=xe({prod_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=se(n,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=Xi(e,r.shape),o=yl(i,r.rank),s=i,a=r;o!=null&&(a=r.transpose(o),s=wl(s.length,r.rank));var u=Te.runKernelFunc((function(h){return h.prod(a,s)}),{permutedX:a});if(t){var l=Hs(u.shape,i);u=u.reshape(l)}return u}}),zT=xe({elu_:function(n){var e=se(n,"x","elu");return Te.runKernelFunc((function(t,r){var i=t.elu(e);return r([i]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){return Te.runKernelFunc((function(o){return o.eluDer(t,i)}),{dy:t,y:i})}}}))}}),_j=xe({leakyRelu_:function(n,e){e===void 0&&(e=.2);var t=se(n,"x","leakyRelu");return nx(dt(e).mul(t),t)}}),WT=xe({prelu_:function(n,e){var t=se(n,"x","prelu"),r=se(e,"alpha","prelu");return Te.runKernelFunc((function(i,o){var s=i.prelu(t,r);return o([t,r]),s}),{x:t,alpha:r},(function(i,o){var s=o[0],a=o[1],u=s.greater(0);return{x:function(){return lf(u,i,i.mul(a))},alpha:function(){var l=lf(u,zn(i),i.mul(s)),h=$i(a.shape,i.shape);return h.length>0&&(l=l.sum(h)),l.reshape(a.shape)}}}),"Prelu")}}),Yr=xe({relu_:function(n){var e=se(n,"x","relu");return e.dtype==="bool"?e.toInt():Te.runKernelFunc((function(t,r){var i=t.relu(e);return r([e]),i}),{x:e},(function(t,r){var i=r[0];return{x:function(){return t.mulStrict(i.step().toFloat())}}}),"Relu")}}),qT=xe({relu6_:function(n){var e=se(n,"x","relu6");return e.dtype==="bool"?e.toInt():Te.runKernelFunc((function(t,r){var i=t.relu6(e);return r([e]),i}),{x:e},(function(t,r){var i=r[0],o=i.lessEqual(6).mul(i.step());return{x:function(){return t.mulStrict(o.toFloat())}}}),"Relu6")}}),Ej=xe({selu_:function(n){var e=se(n,"x","selu");return Te.runKernelFunc((function(t,r){var i=t.selu(e);return r([e]),i}),{$x:e},(function(t,r){var i=r[0];return{$x:function(){var o=i.greater(dt(0)),s=dt(Zb),a=dt(ex),u=t.mul(a),l=t.mul(s).mul(i.toFloat().exp());return lf(o,u,l)}}}))}}),uh=xe({transpose_:function(n,e){var t=se(n,"x","transpose");if(e==null&&(e=t.shape.map((function(i,o){return o})).reverse()),me(t.rank===e.length,(function(){return"Error in transpose: rank of input "+t.rank+" must match length of perm "+e+"."})),e.forEach((function(i){me(i>=0&&i<t.rank,(function(){return"All entries in 'perm' must be between 0 and "+(t.rank-1)+" but got "+e}))})),t.rank<=1)return t.clone();var r={perm:e};return Te.runKernelFunc((function(i){return i.transpose(t,e)}),{x:t},(function(i){var o=Wb(e);return{x:function(){return i.transpose(o)}}}),"Transpose",r)}}),Sj=xe({localResponseNormalization_:function(n,e,t,r,i){e===void 0&&(e=5),t===void 0&&(t=1),r===void 0&&(r=1),i===void 0&&(i=.5);var o=se(n,"x","localResponseNormalization");me(o.rank===4||o.rank===3,(function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+o.rank+"."})),me(xi(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var s=o,a=!1;o.rank===3&&(a=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=Te.runKernelFunc((function(l,h){var d=l.localResponseNormalization4D(s,e,t,r,i);return h([s,d]),d}),{x4D:s},(function(l,h){var d=h[0],m=h[1];return{x4D:function(){return Te.runKernelFunc((function(p){return p.LRNGrad(l,d,m,e,t,r,i)}),{})}}}));return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),HT=xe({norm_:function(n,e,t,r){e===void 0&&(e="euclidean"),t===void 0&&(t=null),r===void 0&&(r=!1);var i=(function a(u,l,h){if(h===void 0&&(h=null),u.rank===0)return u.abs();if(u.rank!==1&&h===null)return a(u.reshape([-1]),l,h);if(u.rank===1||typeof h=="number"||Array.isArray(h)&&h.length===1){if(l===1)return u.abs().sum(h);if(l===1/0)return u.abs().max(h);if(l===-1/0)return u.abs().min(h);if(l==="euclidean"||l===2)return u.abs().pow(dt(2,"int32")).sum(h).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(h)&&h.length===2){if(l===1)return u.abs().sum(h[0]).max(h[1]-1);if(l===1/0)return u.abs().sum(h[1]).max(h[0]);if(l===-1/0)return u.abs().sum(h[1]).min(h[0]);if(l==="fro"||l==="euclidean")return u.square().sum(h).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+h)})(n=se(n,"x","norm"),e,t),o=i.shape;if(r){var s=Xi(t,n.shape);o=Hs(i.shape,s)}return i.reshape(o)}}),Aj=xe({basicLSTMCell_:function(n,e,t,r,i,o){var s=se(n,"forgetBias","basicLSTMCell"),a=se(e,"lstmKernel","basicLSTMCell"),u=se(t,"lstmBias","basicLSTMCell"),l=se(r,"data","basicLSTMCell"),h=se(i,"c","basicLSTMCell"),d=se(o,"h","basicLSTMCell"),m=l.concat(d,1).matMul(a).add(u),p=m.shape[0],y=m.shape[1]/4,b=[p,y],x=m.slice([0,0],b),E=m.slice([0,y],b),T=m.slice([0,2*y],b),P=m.slice([0,3*y],b),C=x.sigmoid().mulStrict(E.tanh()).addStrict(h.mulStrict(s.add(T).sigmoid())),D=C.tanh().mulStrict(P.sigmoid());return[C,D]}}),Cj=xe({multiRNNCell_:function(n,e,t,r){for(var i=se(e,"data","multiRNNCell"),o=n0(t,"c","multiRNNCell"),s=n0(r,"h","multiRNNCell"),a=i,u=[],l=0;l<n.length;l++){var h=n[l](a,o[l],s[l]);u.push(h[0]),u.push(h[1]),a=h[1]}var d=[],m=[];for(l=0;l<u.length;l+=2)d.push(u[l]),m.push(u[l+1]);return[d,m]}}),Ij=xe({movingAverage_:function(n,e,t,r,i){i===void 0&&(i=!0);var o=se(n,"v","movingAverage"),s=se(e,"x","movingAverage"),a=se(t,"decay","movingAverage");SF(o,s),me(po(o.shape,s.shape),(function(){return"Shape mismatch in v and x"}));var u=dt(1),l=u.sub(a),h=s.sub(o).mul(l);if(i){me(r!=null,(function(){return"When using zeroDebias: true, step is required."}));var d=se(r,"step","movingAverage");h=h.div(u.sub(f0(a,d)))}return o.add(h)}}),Tj=xe({stridedSlice_:function(n,e,t,r,i,o,s,a,u){if(i===void 0&&(i=0),o===void 0&&(o=0),s===void 0&&(s=0),a===void 0&&(a=0),u===void 0&&(u=0),r==null&&(r=new Array(e.length)),s!==0)throw new Error("ellipsis mask is not yet supported");var l=se(n,"x","stridedSlice"),h=cS(a),d=l.shape.slice();h.forEach((function(x){e[x]=0,t[x]=1,d.splice(x,0,1)})),l=l.reshape(d);for(var m=0;m<l.rank;m++)e[m]=B8(i,e,r,l.shape,m),t[m]=V8(o,t,r,l.shape,m),r[m]=r[m]||1;var p=cS(u);p.forEach((function(x){t[x]=e[x]+1,r[x]=1}));var y=$b(e,t,r),b=y.filter((function(x,E){return p.indexOf(E)===-1}));return r.every((function(x){return x===1}))?pl(l,e,y).reshape(b):Te.runKernelFunc((function(x){return x.stridedSlice(l,e,t,r)}),{$x:l}).reshape(b)}}),kj=xe({topk_:function(n,e,t){e===void 0&&(e=1),t===void 0&&(t=!0);var r=se(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=Te.runKernelFunc((function(s){return s.topk(r,e,t)}),{$x:r});return{values:o[0],indices:o[1]}}}),Nj=xe({scatterND_:function(n,e,t){var r=se(n,"indices","scatterND","int32"),i=se(e,"updates","scatterND");return O8(i,r,t),Te.runKernelFunc((function(o){return o.scatterND(r,i,t)}),{indices:r,updates:i},null,"ScatterNd",{shape:t})}}),sx=xe({fft_:function(n){me(n.dtype==="complex64",(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+n.dtype+"."}));var e=n.shape[n.shape.length-1],t=n.size/e,r=n.as2D(t,e);return Te.runKernelFunc((function(i){return i.fft(r)}),{input:n}).reshape(n.shape)}}),d0=xe({ifft_:function(n){me(n.dtype==="complex64",(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+n.dtype+"."}));var e=n.shape[n.shape.length-1],t=n.size/e,r=n.as2D(t,e);return Te.runKernelFunc((function(i){return i.ifft(r)}),{input:n}).reshape(n.shape)}}),ax=xe({rfft_:function(n,e){me(n.dtype==="float32",(function(){return"The dtype for rfft() must be real value but got "+n.dtype}));var t,r=n.shape[n.shape.length-1],i=n.size/r;if(e!=null&&e<r){var o=n.shape.map((function(E){return 0})),s=n.shape.map((function(E){return E}));s[n.shape.length-1]=e,t=n.slice(o,s),r=e}else if(e!=null&&e>r){var a=n.shape.map((function(E){return E}));a[n.shape.length-1]=e-r,t=n.concat(Tr(a),n.shape.length-1),r=e}else t=n;var u=t.zerosLike(),l=ko(t,u).as2D(i,r),h=sx(l),d=Math.floor(r/2)+1,m=qa(h),p=tl(h),y=m.split([d,r-d],m.shape.length-1),b=p.split([d,r-d],p.shape.length-1),x=t.shape.slice();return x[t.shape.length-1]=d,ko(y[0],b[0]).reshape(x)}}),GT=xe({irfft_:function(n){var e=n.shape[n.shape.length-1],t=n.size/e;if(e<=2){var r=n.as2D(t,e),i=d0(r);return qa(i)}var o=[t,2*(e-1)],s=qa(n).as2D(t,e),a=tl(n).as2D(t,e),u=s.slice([0,1],[t,e-2]).reverse(1),l=a.slice([0,1],[t,e-2]).reverse(1).mul(dt(-1)),h=s.concat(u,1),d=a.concat(l,1);return r=ko(h,d).as2D(o[0],o[1]),i=d0(r),qa(i)}}),Rj=Object.freeze({fft:sx,ifft:d0,rfft:ax,irfft:GT}),Pj=xe({sparseToDense_:function(n,e,t,r){r===void 0&&(r=0);var i=se(n,"sparseIndices","sparseToDense","int32"),o=se(e,"sparseValues","sparseToDense"),s=se(r,"defaultValue","sparseToDense",o.dtype);return(function(a,u,l,h){if(a.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+a.dtype+".");if(a.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+a.shape+".");var d=a.rank>0?a.shape[0]:1,m=a.rank>1?a.shape[1]:1;if(l.length!==m)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+m+".");var p=u.size;if(u.rank!==0&&(u.rank!==1||p!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==h.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")})(i,o,t,s),Te.runKernelFunc((function(a){return a.sparseToDense(i,o,t,s)}),{$sparseIndices:i,$sparseValues:o,$defaultValue:s})}}),Dj=xe({gatherND_:function(n,e){var t=se(e,"indices","gatherND","int32"),r=se(n,"x","gatherND");return Te.runKernelFunc((function(i){return i.gatherND(r,t)}),{x:r,indices:t},null,"GatherNd")}}),Lj=xe({diag_:function(n){var e=se(n,"x","diag").flatten(),t=n.shape.concat(n.shape);return Te.runKernelFunc((function(r){return r.diag(e)}),{$x:e}).reshape(t)}}),Mj=xe({dropout_:function(n,e,t,r){var i=se(n,"x","dropout");if(me(i.dtype==="float32",(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."})),me(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),e===0)return n instanceof $r?i.clone():i;var o=(function(u,l){if(l==null)return u.shape.slice();if(po(u.shape,l))return l;if(u.shape.length===l.length){for(var h=[],d=0;d<u.shape.length;d++)l[d]==null&&u.shape[d]!=null?h.push(u.shape[d]):h.push(l[d]);return h}return l})(i,t),s=1-e,a=WI(o,0,1,"float32",r).add(s).floor().div(s);return i.mul(a)}});function $T(n,e,t){for(var r=1-n%2,i=new Float32Array(n),o=0;o<n;++o){var s=2*Math.PI*o/(n+r-1);i[o]=e-t*Math.cos(s)}return Di(i,"float32")}var ux=xe({hannWindow_:function(n){return $T(n,.5,.5)}}),KT=xe({hammingWindow_:function(n){return $T(n,.54,.46)}}),lx=xe({frame_:function(n,e,t,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var o=0,s=[];o+e<=n.size;)s.push(pl(n,o,e)),o+=t;if(r)for(;o<n.size;){var a=o+e-n.size,u=qi([pl(n,o,e-a),cl([a],i)]);s.push(u),o+=t}return s.length===0?Yc([],[0,e]):qi(s).as2D(s.length,e)}}),XT=xe({stft_:function(n,e,t,r,i){var o;i===void 0&&(i=ux),r==null&&(o=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var s=lx(n,e,t),a=us(s,i(e)),u=[],l=0;l<s.shape[0];l++)u.push(ax(a.slice([l,0],[1,e]),r));return qi(u)}}),Oj=Object.freeze({hannWindow:ux,hammingWindow:KT,frame:lx,stft:XT}),ss,Fj=function(n,e,t){return t===void 0&&(t=1),Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d,m,p,y,b,x;return Rt(this,(function(E){switch(E.label){case 0:return r=se(n,"predictions","inTopK"),i=se(e,"targets","inTopK"),me(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),me(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank})),ir(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],me(t>0&&t<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+t})),[4,r.data()];case 1:return s=E.sent(),[4,i.data()];case 2:for(a=E.sent(),u=[s.length/o,o],h=u[1],d=wm("bool",l=u[0]),m=0;m<l;m++){for(p=m*h,y=s.subarray(p,p+h),b=[],x=0;x<y.length;x++)b.push({value:y[x],index:x});for(b.sort((function(T,P){return P.value-T.value})),d[m]=0,x=0;x<t;x++)if(b[x].index===a[m]){d[m]=1;break}}return n!==r&&r.dispose(),e!==i&&i.dispose(),[2,Po(d,i.shape,"bool")]}}))}))};(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(ss||(ss={}));var Bj=xe({absoluteDifference_:function(n,e,t,r){r===void 0&&(r=ss.SUM_BY_NONZERO_WEIGHTS);var i=se(n,"labels","absoluteDifference"),o=se(e,"predictions","absoluteDifference"),s=null;t!=null&&(s=se(t,"weights","absoluteDifference")),ir(i.shape,o.shape,"Error in absoluteDifference: ");var a=i.sub(o).abs();return oc(a,s,r)}}),oc=xe({computeWeightedLoss_:function(n,e,t){t===void 0&&(t=ss.SUM_BY_NONZERO_WEIGHTS);var r=se(n,"losses","computeWeightedLoss"),i=null;e!=null&&(i=se(e,"weights","computeWeightedLoss"));var o=i==null?r:r.mul(i);if(t===ss.NONE)return o;if(t===ss.SUM)return o.sum();if(t===ss.MEAN){if(i==null)return o.mean();var s=r.size/i.size,a=o.sum().div(i.sum());return s>1?a.div(dt(s)):a}if(t===ss.SUM_BY_NONZERO_WEIGHTS){if(i==null)return o.sum().div(dt(r.size));var u=i.mul(rp(r.shape)).notEqual(dt(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+t)}}),Vj=xe({cosineDistance_:function(n,e,t,r,i){i===void 0&&(i=ss.SUM_BY_NONZERO_WEIGHTS);var o=se(n,"labels","cosineDistance"),s=se(e,"predictions","cosineDistance"),a=null;r!=null&&(a=se(r,"weights","cosineDistance")),ir(o.shape,s.shape,"Error in cosineDistance: ");var u=dt(1).sub(o.mul(s).sum(t,!0));return oc(u,a,i)}}),jj=xe({hingeLoss_:function(n,e,t,r){r===void 0&&(r=ss.SUM_BY_NONZERO_WEIGHTS);var i=se(n,"labels","hingeLoss"),o=se(e,"predictions","hingeLoss"),s=null;t!=null&&(s=se(t,"weights","hingeLoss")),ir(i.shape,o.shape,"Error in hingeLoss: ");var a=dt(1);i=dt(2).mul(i).sub(a);var u=a.sub(i.mul(o)).relu();return oc(u,s,r)}}),Uj=xe({huberLoss_:function(n,e,t,r,i){r===void 0&&(r=1),i===void 0&&(i=ss.SUM_BY_NONZERO_WEIGHTS);var o=se(n,"labels","huberLoss"),s=se(e,"predictions","huberLoss"),a=null;t!=null&&(a=se(t,"weights","huberLoss")),ir(o.shape,s.shape,"Error in huberLoss: ");var u=dt(r),l=s.sub(o).abs(),h=TT(l,u),d=l.sub(h),m=dt(.5).mul(h.square()).add(u.mul(d));return oc(m,a,i)}}),zj=xe({logLoss_:function(n,e,t,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=ss.SUM_BY_NONZERO_WEIGHTS);var o=se(n,"labels","logLoss"),s=se(e,"predictions","logLoss"),a=null;t!=null&&(a=se(t,"weights","logLoss")),ir(o.shape,s.shape,"Error in logLoss: ");var u=dt(1),l=dt(r),h=o.mul(s.add(l).log()).neg().sub(u.sub(o).mul(u.sub(s).add(l).log()));return oc(h,a,i)}}),Wj=xe({meanSquaredError_:function(n,e,t,r){r===void 0&&(r=ss.SUM_BY_NONZERO_WEIGHTS);var i=se(n,"labels","meanSquaredError"),o=se(e,"predictions","meanSquaredError"),s=null;t!=null&&(s=se(t,"weights","meanSquaredError")),ir(i.shape,o.shape,"Error in meanSquaredError: ");var a=i.squaredDifference(o);return oc(a,s,r)}}),qj=xe({sigmoidCrossEntropy_:function(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=ss.SUM_BY_NONZERO_WEIGHTS);var o=se(n,"multiClassLabels","sigmoidCrossEntropy"),s=se(e,"logits","sigmoidCrossEntropy"),a=null;if(t!=null&&(a=se(t,"weights","sigmoidCrossEntropy")),ir(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=dt(r),l=dt(1),h=dt(.5);o=o.mul(l.sub(u)).add(h.mul(u))}var d=(function(m,p){var y=se(m,"labels","sigmoidCrossEntropyWithLogits"),b=se(p,"logits","sigmoidCrossEntropyWithLogits");ir(y.shape,b.shape,"Error in sigmoidCrossEntropyWithLogits: ");var x=b.relu(),E=b.mul(y),T=b.abs().neg().exp().log1p();return x.sub(E).add(T)})(o,s);return oc(d,a,i)}}),Hj=xe({softmaxCrossEntropy_:function(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=ss.SUM_BY_NONZERO_WEIGHTS);var o=se(n,"onehotLabels","softmaxCrossEntropy"),s=se(e,"logits","softmaxCrossEntropy"),a=null;if(t!=null&&(a=se(t,"weights","softmaxCrossEntropy")),ir(o.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){var u=dt(r),l=dt(1),h=dt(o.shape[1]);o=o.mul(l.sub(u)).add(u.div(h))}var d=(function(m,p,y){if(y===void 0&&(y=-1),y===-1&&(y=p.rank-1),y!==p.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+p.rank+" and dim was "+y);return H0((function(b,x,E){var T=x.logSumExp([y],!0),P=x.toFloat().sub(T);return E([b,P]),{value:P.mul(b).neg().sum([y]),gradFunc:function(C,D){var z=D[0],L=D[1],I=Hs(C.shape,[y]);return[C.reshape(I).mul(z.toFloat().sub(L.exp())),C.reshape(I).mul(L.exp().sub(z.toFloat()))]}}}))(m,p)})(o,s);return oc(d,a,i)}}),Gj=Object.freeze({get Reduction(){return ss},absoluteDifference:Bj,computeWeightedLoss:oc,cosineDistance:Vj,hingeLoss:jj,huberLoss:Uj,logLoss:zj,meanSquaredError:Wj,sigmoidCrossEntropy:qj,softmaxCrossEntropy:Hj});function PS(n,e){return e===void 0&&(e=!1),Te.tidy((function(){if(n.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+n.shape.length+"D Tensor.");for(var t=n.shape[0],r=n.shape[1],i=zI(t),o=n.clone(),s=Yc([[1]],[1,1]),a=s.clone(),u=t>=r?r:t,l=function(d){var m,p=o,y=a,b=i;m=Te.tidy((function(){var x=o.slice([d,d],[t-d,1]),E=x.norm(),T=o.slice([d,d],[1,1]),P=Yc([[-1]]).where(T.greater(0),Yc([[1]])),C=T.sub(P.mul(E)),D=x.div(C);a=D.shape[0]===1?s.clone():s.concat(D.slice([1,0],[D.shape[0]-1,D.shape[1]]),0);var z=P.matMul(C).div(E).neg(),L=o.slice([d,0],[t-d,r]),I=z.mul(a);if(d===0)o=L.sub(I.matMul(a.transpose().matMul(L)));else{var A=L.sub(I.matMul(a.transpose().matMul(L)));o=o.slice([0,0],[d,r]).concat(A,0)}var O=i.slice([0,d],[t,i.shape[1]-d]);if(d===0)i=O.sub(O.matMul(a).matMul(I.transpose()));else{var k=O.sub(O.matMul(a).matMul(I.transpose()));i=i.slice([0,0],[t,d]).concat(k,1)}return[a,o,i]})),a=m[0],o=m[1],i=m[2],qs([p,y,b])},h=0;h<u;++h)l(h);return!e&&t>r&&(i=i.slice([0,0],[t,r]),o=o.slice([0,0],[r,r])),[i,o]}))}var $j=xe({bandPart_:function(n,e,t){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(t%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+t+".");var r=se(n,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,o=r.shape.slice(-2),s=o[0],a=o[1];if(!(e<=s))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+s+").");if(!(t<=a))throw new Error("bandPart(): numUpper ("+t+") must not be greater than the number of columns ("+a+").");e<0&&(e=s),t<0&&(t=a);var u=r0(0,s,1,"int32").reshape([-1,1]),l=r0(0,a,1,"int32"),h=Ki(u,l),d=$0(h.lessEqual(dt(+e,"int32")),h.greaterEqual(dt(-t,"int32"))),m=Tr([s,a],r.dtype);return wa(Hi(r.reshape([-1,s,a])).map((function(p){return lf(d,p,m)}))).reshape(i)}}),Kj=xe({gramSchmidt_:function(n){var e;if(Array.isArray(n)){e=!1,me(n!=null&&n.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var t=n[0].shape[0],r=function(u){me(n[u].shape[0]===t,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+n[u].shape[0]+" vs. "+t+")"}))},i=1;i<n.length;++i)r(i)}else e=!0,n=Hb(n,n.shape[0],0).map((function(u){return HI(u,[0])}));me(n.length<=n[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+n.length+") exceeds number of dimensions ("+n[0].shape[0]+")."}));var o=[],s=n,a=function(u){o.push(Te.tidy((function(){var l=s[u];if(u>0)for(var h=0;h<u;++h){var d=UT(o[h].mulStrict(l)).mul(o[h]);l=l.sub(d)}return l.div(HT(l,"euclidean"))})))};for(i=0;i<n.length;++i)a(i);return e?wa(o,0):o}}),Xj=xe({qr_:function(n,e){if(e===void 0&&(e=!1),n.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+n.rank);if(n.rank===2)return PS(n,e);var t=n.shape.slice(0,n.shape.length-2).reduce((function(s,a){return s*a})),r=Hi(n.reshape([t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),i=[],o=[];return r.forEach((function(s){var a=PS(s,e),u=a[0],l=a[1];i.push(u),o.push(l)})),[wa(i,0).reshape(n.shape),wa(o,0).reshape(n.shape)]}}),Yj=Object.freeze({bandPart:$j,gramSchmidt:Kj,qr:Xj});function Q0(n,e,t,r,i,o){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),o==null&&(o=0);var s=n.shape[0];return t=Math.min(t,s),me(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),me(n.rank===2,(function(){return"boxes must be a 2D tensor, but was of rank '"+n.rank+"'"})),me(n.shape[1]===4,(function(){return"boxes must have 4 columns, but 2nd dimension was "+n.shape[1]})),me(e.rank===1,(function(){return"scores must be a 1D tensor"})),me(e.shape[0]===s,(function(){return"scores has incompatible shape with boxes. Expected "+s+", but was "+e.shape[0]})),me(0<=o&&o<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+o+"'"})),{maxOutputSize:t,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}var Qj=xe({resizeBilinear_:function(n,e,t){t===void 0&&(t=!1);var r=se(n,"images","resizeBilinear");me(r.rank===3||r.rank===4,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),me(e.length===2,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=Te.runKernelFunc((function(l,h){return h([i]),l.resizeBilinear(i,s,a,t)}),{x:i},(function(l,h){return{x:function(){return Te.runKernelFunc((function(d){return d.resizeBilinearBackprop(l,h[0],t)}),{})}}}),"ResizeBilinear",{alignCorners:t,newHeight:s,newWidth:a});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Jj=xe({resizeNearestNeighbor_:function(n,e,t){t===void 0&&(t=!1);var r=se(n,"images","resizeNearestNeighbor");me(r.rank===3||r.rank===4,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),me(e.length===2,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),me(r.dtype==="float32"||r.dtype==="int32",(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=Te.runKernelFunc((function(l,h){return h([i]),l.resizeNearestNeighbor(i,s,a,t)}),{batchImages:i},(function(l,h){return{batchImages:function(){return Te.runKernelFunc((function(d){return d.resizeNearestNeighborBackprop(l,h[0],t)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Zj=xe({nonMaxSuppression_:function(n,e,t,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var o=se(n,"boxes","nonMaxSuppression"),s=se(e,"scores","nonMaxSuppression"),a=Q0(o,s,t,r,i);t=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;var u={maxOutputSize:t,iouThreshold:r,scoreThreshold:i};return Te.runKernelFunc((function(l){return l.nonMaxSuppression(o,s,t,r,i)}),{boxes:o,scores:s},null,"NonMaxSuppressionV3",u)}}),e9=function(n,e,t,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),Nt(this,void 0,void 0,(function(){var o,s,a,u,l,h,d;return Rt(this,(function(m){switch(m.label){case 0:return o=se(n,"boxes","nonMaxSuppressionAsync"),s=se(e,"scores","nonMaxSuppressionAsync"),a=Q0(o,s,t,r,i),t=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold,[4,Promise.all([o.data(),s.data()])];case 1:return u=m.sent(),l=u[0],h=u[1],d=Xb(l,h,t,r,i),o!==n&&o.dispose(),s!==e&&s.dispose(),[2,d]}}))}))},t9=xe({nonMaxSuppressionWithScore_:function(n,e,t,r,i,o){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),o===void 0&&(o=0);var s=se(n,"boxes","nonMaxSuppression"),a=se(e,"scores","nonMaxSuppression"),u=Q0(s,a,t,r,i,o),l={maxOutputSize:t=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:o=u.softNmsSigma},h=Te.runKernel("NonMaxSuppressionV5",{boxes:s,scores:a},l);return{selectedIndices:h[0],selectedScores:h[1]}}}),n9=function(n,e,t,r,i,o){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),o===void 0&&(o=0),Nt(this,void 0,void 0,(function(){var s,a,u,l,h,d,m;return Rt(this,(function(p){switch(p.label){case 0:return s=se(n,"boxes","nonMaxSuppressionAsync"),a=se(e,"scores","nonMaxSuppressionAsync"),u=Q0(s,a,t,r,i,o),t=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,o=u.softNmsSigma,[4,Promise.all([s.data(),a.data()])];case 1:return l=p.sent(),h=l[0],d=l[1],m=Yb(h,d,t,r,i,o),s!==n&&s.dispose(),a!==e&&a.dispose(),[2,m]}}))}))},r9=xe({cropAndResize_:function(n,e,t,r,i,o){var s=se(n,"image","cropAndResize"),a=se(e,"boxes","cropAndResize","float32"),u=se(t,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var l=a.shape[0];return me(s.rank===4,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."})),me(a.rank===2&&a.shape[1]===4,(function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+a.shape+"."})),me(u.rank===1&&u.shape[0]===l,(function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+a.shape+"."})),me(r.length===2,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),me(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),me(i==="bilinear"||i==="nearest",(function(){return"method must be bilinear or nearest, but was "+i})),Te.runKernelFunc((function(h,d){return h.cropAndResize(s,a,u,r,i,o)}),{images:s,boxes:a,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:o,cropSize:r})}}),cx=Object.freeze({resizeBilinear:Qj,resizeNearestNeighbor:Jj,nonMaxSuppression:Zj,nonMaxSuppressionAsync:e9,nonMaxSuppressionWithScore:t9,nonMaxSuppressionWithScoreAsync:n9,cropAndResize:r9}),hx=function(n,e){return!(n>0)||e==="linear"},fx=function(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return n.mul(e.step());throw new Error("Gradient for activation "+t+" has not been implemented yet.")},dx=function(n,e){var t=e,r=$i(n.shape,e.shape);return r.length>0&&(t=t.sum(r)),t.reshape(n.shape)},px=function(n,e,t){if(e==="linear")return n;if(e==="relu")return Yr(n);if(e==="elu")return zT(n);if(e==="relu6")return qT(n);if(e==="prelu")return WT(n,t);throw new Error("Unknown fused activation "+e+".")},i9=xe({fusedMatMul_:function(n){var e,t=n.a,r=n.b,i=n.transposeA,o=i!==void 0&&i,s=n.transposeB,a=s!==void 0&&s,u=n.bias,l=n.activation,h=l===void 0?"linear":l,d=n.preluActivationWeights;if(hx(Te.state.gradientDepth,h)===!1){var m=X0(t,r,o,a);return u!=null&&(m=Dn(m,u)),px(m,h,d)}var p=se(t,"a","fused matMul"),y=se(r,"b","fused matMul");e=Jr(p,y),p=e[0],y=e[1];var b=o?p.shape[p.rank-2]:p.shape[p.rank-1],x=a?y.shape[y.rank-1]:y.shape[y.rank-2],E=o?p.shape[p.rank-1]:p.shape[p.rank-2],T=a?y.shape[y.rank-2]:y.shape[y.rank-1],P=p.shape.slice(0,-2),C=y.shape.slice(0,-2),D=Mt(P),z=Mt(C);me(p.rank>=2&&y.rank>=2&&p.rank===y.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+y.rank+"."})),me(po(P,C),(function(){return"Error in fused matMul: outer dimensions ("+P+") and ("+C+") of Tensors with shapes "+p.shape+" and "+y.shape+" must match."})),me(b===x,(function(){return"Error in fused matMul: inner shapes ("+b+") and ("+x+") of Tensors with shapes "+p.shape+" and "+y.shape+" and transposeA="+o+" and transposeB="+a+" must match."}));var L,I,A=p.shape.slice(0,-2).concat([E,T]),O=o?p.as3D(D,b,E):p.as3D(D,E,b),k=a?y.as3D(z,T,x):y.as3D(z,x,T);u!=null&&Mn(A,(L=Jr(L=se(u,"bias","fused matMul"),p)[0]).shape),d!=null&&(I=se(d,"prelu weights","fused matMul"));var M={a:O,b:k};u!=null&&(M.bias=L),d!=null&&(M.preluActivationWeights=I);var j=[O,k];return Te.runKernelFunc((function(X,ue){var ge=X.fusedBatchMatMul({a:O,b:k,transposeA:o,transposeB:a,bias:L,activation:h,preluActivationWeights:I});return ue([O,k,ge]),ge}),M,(function(X,ue){var ge=ue[0],ce=ue[1],$=ue[2],ae=fx(X,$,h),fe={};return u!=null&&(fe={bias:function(){return dx(L,ae)}}),Object.assign(o||a?!o&&a?{a:function(){return ae.matMul(ce,!1,!1)},b:function(){return ae.matMul(ge,!0,!1)}}:o&&!a?{a:function(){return ce.matMul(ae,!1,!0)},b:function(){return ge.matMul(ae,!1,!1)}}:{a:function(){return ce.matMul(ae,!0,!0)},b:function(){return ae.matMul(ge,!0,!0)}}:{a:function(){return ae.matMul(ce,!1,!0)},b:function(){return ge.matMul(ae,!0,!1)}},fe)}),"_FusedMatMul",{transposeA:o,transposeB:a,activation:h},j,[!0]).reshape(A)}}),o9=xe({fusedConv2d_:function(n){var e=n.x,t=n.filter,r=n.strides,i=n.pad,o=n.dataFormat,s=o===void 0?"NHWC":o,a=n.dilations,u=a===void 0?[1,1]:a,l=n.dimRoundingMode,h=n.bias,d=n.activation,m=d===void 0?"linear":d,p=n.preluActivationWeights;if(m=m||"linear",hx(Te.state.gradientDepth,m)===!1){var y=$a(e,t,r,i,s,u,l);return h!=null&&(y=Dn(y,h)),px(y,m,p)}var b=se(e,"x","conv2d"),x=se(t,"filter","conv2d"),E=b,T=!1;b.rank===3&&(T=!0,E=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),me(E.rank===4,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+E.rank+"."})),me(x.rank===4,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+x.rank+"."})),l!=null&&me(xi(i),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."})),me(E.shape[3]===x.shape[2],(function(){return"Error in conv2d: depth of input ("+E.shape[3]+") must match input depth for filter "+x.shape[2]+"."})),me(Gs(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),me(s==="NHWC",(function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."}));var P,C,D=bf(E.shape,x.shape,r,u,i,l);h!=null&&(P=Jr(P=se(h,"bias","fused conv2d"),b)[0],Mn(D.outShape,P.shape)),p!=null&&(C=se(p,"prelu weights","fused conv2d"));var z={x:E,filter:x};h!=null&&(z.bias=P),p!=null&&(z.preluActivationWeights=C);var L=[x,E],I=Te.runKernelFunc((function(A,O){var k=A.fusedConv2d({input:E,filter:x,convInfo:D,bias:P,activation:m,preluActivationWeights:C});return O([x,E,k]),k}),z,(function(A,O){var k=O,M=k[0],j=k[1],X=k[2],ue=fx(A,X,m);me(qd(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var ge={};return h!=null&&(ge={bias:function(){return dx(P,ue)}}),Object.assign({x:function(){return LT(j.shape,ue,M,r,i)},filter:function(){return ix(j,ue,M.shape,r,i)}},ge)}),"FusedConv2D",{convInfo:D,activation:m},L,[!0]);return T?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}}),s9=xe({fusedDepthwiseConv2d_:function(n){var e=n.x,t=n.filter,r=n.strides,i=n.pad,o=n.dataFormat,s=o===void 0?"NHWC":o,a=n.dilations,u=a===void 0?[1,1]:a,l=n.dimRoundingMode,h=n.bias,d=n.activation,m=d===void 0?"linear":d,p=n.preluActivationWeights;if(hx(Te.state.gradientDepth,m)===!1){var y=K0(e,t,r,i,s,u,l);return h!=null&&(y=Dn(y,h)),px(y,m,p)}var b=se(e,"x","depthwiseConv2d"),x=se(t,"filter","depthwiseConv2d"),E=b,T=!1;b.rank===3&&(T=!0,E=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),me(E.rank===4,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+E.rank+"."})),me(x.rank===4,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+x.rank+"."})),me(E.shape[3]===x.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+E.shape[3]+") must match the inChannels dimension in filter "+x.shape[2]+"."})),u==null&&(u=[1,1]),me(Gs(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),l!=null&&me(xi(i),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."}));var P,C,D=bf(E.shape,x.shape,r,u,i,l,!0);h!=null&&(P=Jr(P=se(h,"bias","fused conv2d"),b)[0],Mn(D.outShape,P.shape)),p!=null&&(C=se(p,"prelu weights","fused depthwiseConv2d"));var z={x:E,filter:x};h!=null&&(z.bias=P),p!=null&&(z.preluActivationWeights=C);var L=[x,E],I=Te.runKernelFunc((function(A,O){var k=A.fusedDepthwiseConv2D({input:E,filter:x,convInfo:D,bias:P,activation:m,preluActivationWeights:C});return O([x,E,k]),k}),z,(function(A,O){me(qd(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var k=O[0],M=O[1],j=O[2],X=fx(A,j,m),ue={};return h!=null&&(ue={bias:function(){return dx(P,X)}}),Object.assign({x:function(){return MT(M.shape,X,k,D)},filter:function(){return OT(M,X,k.shape,D)}},ue)}),"FusedDepthwiseConv2D",{convInfo:D,activation:m},L,[!0]);return T?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}}),a9=Object.freeze({matMul:i9,conv2d:o9,depthwiseConv2d:s9}),u9=Object.freeze({image:cx,linalg:Yj,losses:Gj,spectral:Rj,fused:a9,signal:Oj,square:z7,squaredDifference:yT,conv1d:QV,conv2d:$a,conv3d:JV,depthwiseConv2d:K0,separableConv2d:ox,conv2dTranspose:ZV,conv3dTranspose:ej,op:xe,batchNormalization2d:yV,batchNormalization3d:wV,batchNormalization4d:bV,batchNormalization:xV,batchNorm:ST,batchNorm2d:_V,batchNorm3d:EV,batchNorm4d:SV,booleanMaskAsync:YV,complex:ko,real:qa,imag:tl,concat:qi,concat1d:a8,concat2d:u8,concat3d:l8,concat4d:c8,split:Hb,matMul:X0,dot:tj,outerProduct:nj,reverse:Gm,reverse1d:rj,reverse2d:ij,reverse3d:oj,reverse4d:sj,maxPool:co,avgPool:$m,pool:aj,maxPool3d:uj,avgPool3d:lj,slice:pl,slice1d:cj,slice2d:hj,slice3d:VT,slice4d:fj,abs:W7,acos:q7,acosh:H7,asin:G7,asinh:$7,atan:K7,atanh:X7,ceil:Y7,clipByValue:tx,cos:Q7,cosh:J7,erf:Z7,exp:dw,expm1:eV,floor:tV,log:nV,log1p:rV,logSigmoid:iV,neg:h0,reciprocal:oV,round:sV,rsqrt:wT,sigmoid:bT,sign:aV,isNaN:uV,isInf:lV,isFinite:cV,sin:hV,sinh:fV,softplus:dV,sqrt:pV,step:mV,tan:gV,tanh:vV,all:dj,any:pj,argMax:mj,argMin:gj,logSumExp:vj,max:Y0,mean:yj,min:wj,moments:bj,sum:UT,prod:xj,equal:kT,equalStrict:jV,greater:UV,greaterEqual:NT,greaterEqualStrict:zV,greaterStrict:WV,less:qV,lessEqual:HV,lessEqualStrict:GV,lessStrict:$V,notEqual:KV,notEqualStrict:XV,add:Dn,addN:IV,addStrict:TV,atan2:kV,div:gu,divNoNan:NV,divStrict:RV,floorDiv:IT,maximum:nx,maximumStrict:PV,minimum:TT,minimumStrict:DV,mod:LV,modStrict:MV,mul:us,mulStrict:OV,pow:f0,powStrict:FV,squaredDifferenceStrict:BV,sub:Ki,subStrict:VV,elu:zT,leakyRelu:_j,prelu:WT,relu:Yr,relu6:qT,selu:Ej,logicalAnd:$0,logicalNot:AV,logicalOr:AT,logicalXor:CV,where:lf,whereAsync:CT,buffer:wn,print:w8,batchToSpaceND:UI,broadcastTo:b8,cast:x8,clone:_8,cumsum:E8,depthToSpace:S8,expandDims:Wa,eye:zI,multinomial:A8,oneHot:lw,pad:wf,pad1d:C8,pad2d:I8,pad3d:T8,pad4d:k8,rand:N8,randomNormal:R8,randomGamma:P8,randomUniform:WI,reshape:yu,spaceToBatchND:qI,squeeze:HI,stack:wa,tile:bd,truncatedNormal:D8,unstack:Hi,setdiff1dAsync:L8,fill:cl,linspace:s8,ones:rp,range:r0,scalar:dt,tensor:Po,tensor1d:Di,tensor2d:Yc,tensor3d:qb,tensor4d:zs,tensor5d:r8,tensor6d:i8,variable:o8,zeros:Tr,onesLike:jI,zerosLike:zn,transpose:uh,softmax:ic,logSoftmax:U8,localResponseNormalization:Sj,norm:HT,gather:rx,unsortedSegmentSum:RT,basicLSTMCell:Aj,multiRNNCell:Cj,movingAverage:Ij,stridedSlice:Tj,topk:kj,scatterND:Nj,fft:sx,ifft:d0,rfft:ax,irfft:GT,sparseToDense:Pj,gatherND:Dj,diag:Lj,dropout:Mj,hannWindow:ux,hammingWindow:KT,frame:lx,stft:XT,inTopKAsync:Fj});function nt(n,e){Array.isArray(n)||(n=[n]),n.forEach((function(t){t!=null&&me(t.dtype!=="complex64",(function(){return e+" does not support complex64 tensors."}))}))}function Hy(n,e,t,r){if(t==="linear")return n.linear(e);if(t==="relu")return n.relu(e);if(t==="elu")return n.elu(e);if(t==="relu6")return n.relu6(e);if(t==="prelu")return n.prelu(e,r);throw new Error("Activation "+t+" has not been implemented for the CPU backend.")}var l9=(function(n){function e(){var t=n.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new JI(t,Te),t}return Su(e,n),e.prototype.write=function(t,r,i){this.firstUse&&(this.firstUse=!1,Ye().get("IS_NODE")&&t0(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var o={};return this.data.set(o,{values:t,dtype:i}),o},e.prototype.move=function(t,r,i,o){this.data.set(t,{values:r,dtype:o})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){return[2,this.readSync(t)]}))}))},e.prototype.readSync=function(t){var r=this.data.get(t),i=r.dtype,o=r.complexTensors;return i==="complex64"?fw(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var r=this.readSync(t.dataId),i=r;if(t.dtype==="string")try{i=r.map((function(o){return Jv(o)}))}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return wn(t.shape,t.dtype,i)},e.prototype.makeOutput=function(t,r,i){var o=this.write(t,r,i);return Te.makeTensorFromDataId(o,r,i,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var r=this.data.get(t).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return Nt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){return r=Zu(),t(),[2,{kernelMs:Zu()-r}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,r){var i=this.makeOutput(null,t.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:Te.keep(t.clone()),imag:Te.keep(r.clone())},i},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,r,i){if(nt(t,"slice"),YI(t.shape,r,i)){var o=QI(r,t.strides),s=Mt(i);return Po(this.readSync(t.dataId).subarray(o,o+s),i,t.dtype)}for(var a=wn(i,t.dtype),u=this.bufferSync(t),l=0;l<a.size;++l){var h=a.indexToLoc(l).map((function(d,m){return d+r[m]}));a.values[l]=u.get.apply(u,h)}return a.toTensor()},e.prototype.stridedSlice=function(t,r,i,o){nt(t,"stridedSlice");var s=$b(r,i,o);if(s.some((function(p){return p===0})))return Po([],s);for(var a=wn(s,t.dtype),u=this.bufferSync(t),l=0;l<a.size;l++){for(var h=a.indexToLoc(l),d=new Array(h.length),m=0;m<d.length;m++)d[m]=h[m]*o[m]+r[m];a.set.apply(a,[u.get.apply(u,d)].concat(h))}return a.toTensor()},e.prototype.diag=function(t){for(var r=this.readSync(t.dataId),i=wn([t.size,t.size],t.dtype),o=i.values,s=0;s<r.length;s++)o[s*t.size+s]=r[s];return i.toTensor()},e.prototype.unstack=function(t,r){for(var i=t.shape[r],o=new Array(t.rank-1),s=0,a=0;a<t.rank;a++)a!==r&&(o[s++]=t.shape[a]);var u=new Array(t.rank).fill(0),l=t.shape.slice();l[r]=1;var h=new Array(i);for(a=0;a<h.length;a++)u[r]=a,h[a]=this.slice(t,u,l).reshape(o);return h},e.prototype.reverse=function(t,r){nt(t,"reverse");for(var i=wn(t.shape,t.dtype),o=this.bufferSync(t),s=function(u){var l=i.indexToLoc(u),h=l.slice();r.forEach((function(d){return h[d]=t.shape[d]-1-h[d]})),i.set.apply(i,[o.get.apply(o,h)].concat(l))},a=0;a<i.size;a++)s(a);return i.toTensor()},e.prototype.concat=function(t,r){var i=this;if(t[0].dtype==="complex64"){var o=t.map((function(p){return qa(p)})),s=t.map((function(p){return tl(p)}));return ko(this.concat(o,r),this.concat(s,r))}var a=t.map((function(p){var y=Mt(p.shape.slice(r));return p.as2D(-1,y)})),u=Wd(a.map((function(p){return p.shape})),1),l=wn(u,t[0].dtype).values;if(a[0].shape[0]===1){var h=0;a.forEach((function(p){l.set(i.readSync(p.dataId),h),h+=p.size}))}else{var d=0;a.forEach((function(p){for(var y=i.readSync(p.dataId),b=0,x=0;x<p.shape[0];++x)for(var E=x*u[1]+d,T=0;T<p.shape[1];++T)l[E+T]=y[b++];d+=p.shape[1]}))}var m=Wd(t.map((function(p){return p.shape})),r);return Po(l,m,t[0].dtype)},e.prototype.neg=function(t){return nt(t,"neg"),this.multiply(dt(-1),t)},e.prototype.add=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),(function(i,o,s,a){return{real:i+s,imag:o+a}})):this.broadcastedBinaryOp(t,r,No(t.dtype,r.dtype),(function(i,o){return i+o}))},e.prototype.addN=function(t){var r=this;nt(t,"addN");for(var i=t.map((function(h){return r.readSync(h.dataId)})),o=wn(t[0].shape,t[0].dtype),s=o.values,a=0;a<t.length;a++)for(var u=i[a],l=0;l<s.length;l++)s[l]+=u[l];return o.toTensor()},e.prototype.softmax=function(t,r){var i=Xi([r],t.shape),o=this.max(t,i),s=Hs(o.shape,i),a=this.subtract(t,o.reshape(s)),u=this.exp(a),l=this.sum(u,i).reshape(s);return this.realDivide(u,l)},e.prototype.subtract=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),(function(i,o,s,a){return{real:i-s,imag:o-a}})):this.broadcastedBinaryOp(t,r,No(t.dtype,r.dtype),(function(i,o){return i-o}))},e.prototype.pow=function(t,r){return nt([t,r],"pow"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.pow(i,o)}))},e.prototype.batchMatMul=function(t,r,i,o){nt([t,r],"matMul");for(var s=i?t.shape[1]:t.shape[2],a=i?t.shape[2]:t.shape[1],u=o?r.shape[1]:r.shape[2],l=t.shape[0],h=this.readSync(t.dataId),d=this.readSync(r.dataId),m=i?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],p=m[0],y=m[1],b=m[2],x=o?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],E=x[0],T=x[1],P=x[2],C=a*u,D=wn([l,a,u],t.dtype),z=D.values,L=this.blockSize,I=0;I<l;I++)for(var A=0;A<a;A+=L)for(var O=0;O<u;O+=L)for(var k=0;k<s;k+=L)for(var M=Math.min(A+L,a),j=Math.min(O+L,u),X=Math.min(k+L,s),ue=A;ue<M;ue++)for(var ge=O;ge<j;ge++){for(var ce=0,$=k;$<X;$++)ce+=h[I*p+ue*y+$*b]*d[$*E+ge*T+I*P];z[I*C+(ue*u+ge)]+=ce}return D.toTensor()},e.prototype.fusedBatchMatMul=function(t){var r=t.a,i=t.b,o=t.transposeA,s=t.transposeB,a=t.bias,u=t.activation,l=t.preluActivationWeights,h=this.batchMatMul(r,i,o,s);return a&&(h=this.add(h,a)),u&&(h=Hy(this,h,u,l)),h},e.prototype.multiply=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),(function(i,o,s,a){return{real:i*s-o*a,imag:i*a+o*s}})):this.broadcastedBinaryOp(t,r,No(t.dtype,r.dtype),(function(i,o){return i*o}))},e.prototype.realDivide=function(t,r){return nt([t,r],"realDivide"),this.broadcastedBinaryOp(t,r,"float32",(function(i,o){return i/o}))},e.prototype.floorDiv=function(t,r){return nt([t,r],"floorDiv"),this.broadcastedBinaryOp(t,r,"int32",(function(i,o){return Math.floor(i/o)}))},e.prototype.sum=function(t,r){nt(t,"sum"),ha("sum",r,t.rank);for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,No(t.dtype,"int32")),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=0,y=0;y<u;++y)p+=h[m+y];l[d]=p}return a},e.prototype.prod=function(t,r){nt(t,"sum");for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,No(t.dtype,"int32")),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=1,y=0;y<u;++y)p*=h[m+y];l[d]=p}return a},e.prototype.unsortedSegmentSum=function(t,r,i){nt(t,"unsortedSegmentSum");for(var o=[],s=t.rank-r.rank,a=0;a<s;++a)r=r.expandDims(a+1);for(a=0;a<i;++a){var u=dt(a,"int32"),l=kT(u,r).asType("float32").mul(t).sum(0);o.push(l)}return wa(o)},e.prototype.argMin=function(t,r){nt(t,"argMin");var i=[r];ha("argMin",i,t.rank);for(var o=ts(t.shape,i),s=o[0],a=o[1],u=Tr(s,"int32"),l=Mt(a),h=this.readSync(u.dataId),d=this.readSync(t.dataId),m=0;m<h.length;++m){for(var p=m*l,y=d[p],b=0,x=0;x<l;++x){var E=d[p+x];E<y&&(y=E,b=x)}h[m]=b}return u},e.prototype.argMax=function(t,r){nt(t,"argMax");var i=[r];ha("argMax",i,t.rank);for(var o=ts(t.shape,i),s=o[0],a=o[1],u=Tr(s,"int32"),l=Mt(a),h=this.readSync(u.dataId),d=this.readSync(t.dataId),m=0;m<h.length;++m){for(var p=m*l,y=d[p],b=0,x=0;x<l;++x){var E=d[p+x];E>y&&(y=E,b=x)}h[m]=b}return u},e.prototype.cumsum=function(t,r,i,o){if(nt(t,"cumsum"),r!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+r);for(var s=No(t.dtype,"int32"),a=Tr(t.shape,s),u=this.readSync(a.dataId),l=this.readSync(t.dataId),h=t.shape[t.rank-1],d=o?function(x,E){return x+h-E-1}:function(x,E){return x+E},m=0;m<l.length;m+=h)for(var p=0;p<h;p++){var y=d(m,p);if(p===0)u[y]=i?0:l[y];else{var b=d(m,p-1);u[y]=i?l[b]+u[b]:l[y]+u[b]}}return a},e.prototype.equal=function(t,r){return nt([t,r],"equal"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i===o?1:0}))},e.prototype.notEqual=function(t,r){return nt([t,r],"notEqual"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i!==o?1:0}))},e.prototype.less=function(t,r){return nt([t,r],"less"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i<o?1:0}))},e.prototype.lessEqual=function(t,r){return nt([t,r],"lessEqual"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i<=o?1:0}))},e.prototype.greater=function(t,r){return nt([t,r],"greater"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i>o?1:0}))},e.prototype.greaterEqual=function(t,r){return nt([t,r],"greaterEqual"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i>=o?1:0}))},e.prototype.logicalNot=function(t){nt(t,"logicalNot");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r[o]?0:1;return this.makeOutput(i,t.shape,"bool")},e.prototype.logicalAnd=function(t,r){return nt([t,r],"logicalAnd"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i&&o}))},e.prototype.logicalOr=function(t,r){return nt([t,r],"logicalOr"),this.broadcastedBinaryOp(t,r,"bool",(function(i,o){return i||o}))},e.prototype.select=function(t,r,i){nt([t,r,i],"select");for(var o=this.readSync(t.dataId),s=this.readSync(r.dataId),a=this.readSync(i.dataId),u=Tr(r.shape,No(r.dtype,i.dtype)),l=this.readSync(u.dataId),h=0,d=t.rank===0||t.rank>1||r.rank===1?1:Mt(r.shape.slice(1)),m=0;m<o.length;m++)for(var p=0;p<d;p++)o[m]===1?l[h++]=s[m]:l[h++]=a[m];return u},e.prototype.where=function(t){nt([t],"where");var r=this.readSync(t.dataId);return Qb(t.shape,r)},e.prototype.topk=function(t,r,i){return nt(t,"topk"),sT(this.readSync(t.dataId),t.shape,t.dtype,r)},e.prototype.min=function(t,r){nt(t,"min"),ha("min",r,t.rank);for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,t.dtype),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=h[m],y=0;y<u;++y){var b=h[m+y];b<p&&(p=b)}l[d]=p}return a},e.prototype.minimum=function(t,r){return nt([t,r],"minimum"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.min(i,o)}))},e.prototype.mod=function(t,r){return nt([t,r],"mod"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){var s=i%o;return i<0&&o<0||i>=0&&o>=0?s:(s+o)%o}))},e.prototype.max=function(t,r){nt(t,"max"),ha("max",r,t.rank);for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,t.dtype),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=h[m],y=0;y<u;++y){var b=h[m+y];b>p&&(p=b)}l[d]=p}return a},e.prototype.maximum=function(t,r){return nt([t,r],"maximum"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.max(i,o)}))},e.prototype.all=function(t,r){nt(t,"all"),ha("all",r,t.rank);for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,t.dtype),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=h[m],y=0;y<u;++y){var b=h[m+y];p=p&&b}l[d]=p}return a},e.prototype.any=function(t,r){nt(t,"any"),ha("any",r,t.rank);for(var i=ts(t.shape,r),o=i[0],s=i[1],a=Tr(o,t.dtype),u=Mt(s),l=this.readSync(a.dataId),h=this.readSync(t.dataId),d=0;d<l.length;++d){for(var m=d*u,p=h[m],y=0;y<u;++y){var b=h[m+y];p=p||b}l[d]=p}return a},e.prototype.squaredDifference=function(t,r){return nt([t,r],"squaredDifference"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){var s=i-o;return s*s}))},e.prototype.ceil=function(t){nt(t,"ceil");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.ceil(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.floor=function(t){nt(t,"floor");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.floor(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.sign=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)r[o]<0?i[o]=-1:r[o]>0?i[o]=1:i[o]=0;return this.makeOutput(i,t.shape,"float32")},e.prototype.isNaN=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isNaN(r[o])&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.isInf=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Math.abs(r[o])===1/0&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.isFinite=function(t){nt(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isFinite(r[o])&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.round=function(t){nt(t,"round");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=Math.floor(r[o]);r[o]-s<.5?i[o]=Math.floor(r[o]):r[o]-s>.5?i[o]=Math.ceil(r[o]):i[o]=s%2==0?s:s+1}return this.makeOutput(i,t.shape,"float32")},e.prototype.exp=function(t){nt(t,"exp");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.exp(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.expm1=function(t){nt(t,"expm1");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.expm1(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.log=function(t){nt(t,"log");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=Math.log(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.log1p=function(t){nt(t,"log1p");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=Math.log1p(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.sqrt=function(t){nt(t,"sqrt");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=Math.sqrt(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.rsqrt=function(t){nt(t,"rsqrt");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var s=r[o];i[o]=1/Math.sqrt(s)}return this.makeOutput(i,t.shape,"float32")},e.prototype.reciprocal=function(t){nt(t,"reciprocal");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=1/r[o];return this.makeOutput(i,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){nt(t,"relu");for(var r=Tr(t.shape,t.dtype),i=this.readSync(r.dataId),o=this.readSync(t.dataId),s=0;s<o.length;++s)i[s]=Math.max(0,o[s]);return r},e.prototype.relu6=function(t){nt(t,"relu");for(var r=Tr(t.shape,t.dtype),i=this.readSync(r.dataId),o=this.readSync(t.dataId),s=0;s<o.length;++s)i[s]=Math.min(Math.max(0,o[s]),6);return r},e.prototype.prelu=function(t,r){return nt([t,r],"prelu"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return i<0?o*i:i}))},e.prototype.elu=function(t){nt(t,"elu");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var s=i[o];r[o]=s>=0?s:Math.exp(s)-1}return this.makeOutput(r,t.shape,"float32")},e.prototype.eluDer=function(t,r){nt([t,r],"eluDer");for(var i=new Float32Array(r.size),o=this.readSync(r.dataId),s=this.readSync(t.dataId),a=0;a<o.length;++a){var u=o[a];i[a]=u>=1?s[a]:s[a]*(u+1)}return this.makeOutput(i,r.shape,"float32")},e.prototype.selu=function(t){nt(t,"selu");for(var r=Zb,i=ex,o=new Float32Array(t.size),s=this.readSync(t.dataId),a=0;a<s.length;++a){var u=s[a];o[a]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(o,t.shape,"float32")},e.prototype.clip=function(t,r,i){nt(t,"clip");for(var o=new Float32Array(t.size),s=this.readSync(t.dataId),a=0;a<s.length;++a){var u=s[a];o[a]=u>i?i:u<r?r:u}return this.makeOutput(o,t.shape,"float32")},e.prototype.abs=function(t){for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.abs(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<t.size;++o){var s=i[2*o],a=i[2*o+1];r[o]=Math.hypot(s,a)}return this.makeOutput(r,t.shape,"float32")},e.prototype.int=function(t){nt(t,"int");for(var r=new Int32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=i[o];return this.makeOutput(r,t.shape,"int32")},e.prototype.sigmoid=function(t){nt(t,"sigmoid");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=1/(1+Math.exp(-i[o]));return this.makeOutput(r,t.shape,"float32")},e.prototype.softplus=function(t){nt(t,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(t.size),o=this.readSync(t.dataId),s=0;s<o.length;++s){var a=o[s]>-r,u=o[s]<r,l=Math.exp(o[s]),h=void 0;h=u?l:a?o[s]:Math.log(1+l),i[s]=h}return this.makeOutput(i,t.shape,"float32")},e.prototype.sin=function(t){nt(t,"sin");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.sin(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.cos=function(t){nt(t,"cos");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.cos(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.tan=function(t){nt(t,"tan");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.tan(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.asin=function(t){nt(t,"asin");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.asin(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.acos=function(t){nt(t,"acos");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.acos(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atan=function(t){nt(t,"atan");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.atan(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atan2=function(t,r){return nt([t,r],"atan2"),this.broadcastedBinaryOp(t,r,t.dtype,(function(i,o){return Math.atan2(i,o)}))},e.prototype.sinh=function(t){nt(t,"sinh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.sinh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.cosh=function(t){nt(t,"cosh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.cosh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.tanh=function(t){nt(t,"tanh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=cF(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.asinh=function(t){nt(t,"asinh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.asinh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.acosh=function(t){nt(t,"acosh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.acosh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atanh=function(t){nt(t,"atanh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.atanh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.erf=function(t){nt(t,"erf");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var s=Math.sign(i[o]),a=Math.abs(i[o]),u=1/(1+.3275911*a);r[o]=s*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-a*a))}return this.makeOutput(r,t.shape,"float32")},e.prototype.step=function(t,r){r===void 0&&(r=0),nt(t,"step");for(var i=new Float32Array(t.size),o=this.readSync(t.dataId),s=0;s<o.length;++s){var a=o[s];isNaN(a)?i[s]=NaN:i[s]=a>0?1:r}return this.makeOutput(i,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var r=t.input,i=t.filter,o=t.convInfo,s=t.bias,a=t.activation,u=t.preluActivationWeights,l=this.conv2d(r,i,o);return s&&(l=this.add(l,s)),a&&(l=Hy(this,l,a,u)),l},e.prototype.conv2d=function(t,r,i){nt([t,r],"conv2d");for(var o=i.filterHeight,s=i.filterWidth,a=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,h=i.padInfo.top,d=i.dataFormat==="channelsLast",m=wn(i.outShape,t.dtype),p=t.strides[0],y=d?t.strides[1]:t.strides[2],b=d?t.strides[2]:1,x=d?1:t.strides[1],E=m.strides[0],T=d?m.strides[1]:m.strides[2],P=d?m.strides[2]:1,C=d?1:m.strides[1],D=this.readSync(t.dataId),z=this.readSync(r.dataId),L=m.values,I=0;I<i.batchSize;++I)for(var A=I*p,O=I*E,k=0;k<i.outHeight;++k)for(var M=O+k*T,j=k*i.strideHeight-h,X=0;X<o;X++){var ue=j+X*a;if(!(ue<0||ue>=i.inHeight))for(var ge=X*r.strides[0],ce=A+ue*y,$=0;$<i.outWidth;++$)for(var ae=M+$*P,fe=$*i.strideWidth-l,Q=0;Q<s;Q++){var W=fe+Q*u;if(!(W<0||W>=i.inWidth))for(var J=ce+W*b,te=ge+Q*r.strides[1],de=0;de<i.inChannels;++de){for(var ve=D[J+de*x],we=0;we<i.outChannels;++we)L[ae+we*C]+=ve*z[te+we];te+=i.outChannels}}}return m.toTensor()},e.prototype.conv3d=function(t,r,i){for(var o=i.filterDepth,s=i.filterHeight,a=i.filterWidth,u=i.dilationDepth,l=i.dilationHeight,h=i.dilationWidth,d=i.padInfo.front,m=i.padInfo.left,p=i.padInfo.top,y=wn(i.outShape,t.dtype),b=this.readSync(t.dataId),x=this.readSync(r.dataId),E=y.values,T=0;T<i.batchSize;++T)for(var P=T*t.strides[0],C=T*y.strides[0],D=0;D<i.outDepth;++D)for(var z=C+D*y.strides[1],L=D*i.strideDepth-d,I=0;I<o;I++){var A=L+I*u;if(!(A<0||A>=i.inDepth))for(var O=I*r.strides[0],k=P+A*t.strides[1],M=0;M<i.outHeight;++M)for(var j=z+M*y.strides[2],X=M*i.strideHeight-p,ue=0;ue<s;ue++){var ge=X+ue*l;if(!(ge<0||ge>=i.inHeight))for(var ce=O+ue*r.strides[1],$=k+ge*t.strides[2],ae=0;ae<i.outWidth;++ae)for(var fe=j+ae*i.outChannels,Q=ae*i.strideWidth-m,W=0;W<a;W++){var J=Q+W*h;if(!(J<0||J>=i.inWidth))for(var te=ce+W*r.strides[2],de=$+J*i.inChannels,ve=te,we=0;we<i.inChannels;++we){for(var Se=b[de+we],Ie=0;Ie<i.outChannels;++Ie)E[fe+Ie]+=Se*x[ve+Ie];ve+=i.outChannels}}}}return y.toTensor()},e.prototype.conv2dDerInput=function(t,r,i){nt([t,r],"conv2dDerInput");for(var o=wn(i.inShape,"float32"),s=o.values,a=this.readSync(t.dataId),u=this.readSync(r.dataId),l=r.strides,h=l[0],d=l[1],m=l[2],p=i.batchSize,y=i.filterHeight,b=i.filterWidth,x=i.inChannels,E=i.inHeight,T=i.inWidth,P=i.outChannels,C=i.outHeight,D=i.outWidth,z=i.strideHeight,L=i.strideWidth,I=i.dataFormat,A=y-1-i.padInfo.top,O=b-1-i.padInfo.left,k=I==="channelsLast",M=o.strides[0],j=k?o.strides[1]:o.strides[2],X=k?o.strides[2]:1,ue=k?1:o.strides[1],ge=t.strides[0],ce=k?t.strides[1]:t.strides[2],$=k?t.strides[2]:1,ae=k?1:t.strides[1],fe=0;fe<p;++fe)for(var Q=0;Q<x;++Q)for(var W=0;W<E;++W)for(var J=W-A,te=Math.max(0,Math.ceil(J/z)),de=Math.min(C,(y+J)/z),ve=0;ve<T;++ve){for(var we=ve-O,Se=Math.max(0,Math.ceil(we/L)),Ie=Math.min(D,(b+we)/L),Fe=0,Ae=te;Ae<de;++Ae)for(var Be=Ae*z-J,Le=Se;Le<Ie;++Le)for(var tt=ge*fe+ce*Ae+$*Le,re=h*(y-1-Be)+d*(b-1-(Le*L-we))+m*Q,rt=0;rt<P;++rt)Fe+=a[tt+ae*rt]*u[re+rt];s[M*fe+j*W+X*ve+ue*Q]=Fe}return o.toTensor()},e.prototype.conv3dDerInput=function(t,r,i){for(var o=wn(i.inShape,"float32"),s=o.values,a=o.strides,u=a[0],l=a[1],h=a[2],d=a[3],m=this.readSync(t.dataId),p=t.strides,y=p[0],b=p[1],x=p[2],E=p[3],T=this.readSync(r.dataId),P=r.strides,C=P[0],D=P[1],z=P[2],L=P[3],I=i.batchSize,A=i.filterDepth,O=i.filterHeight,k=i.filterWidth,M=i.inChannels,j=i.inDepth,X=i.inHeight,ue=i.inWidth,ge=i.outChannels,ce=i.outDepth,$=i.outHeight,ae=i.outWidth,fe=i.strideDepth,Q=i.strideHeight,W=i.strideWidth,J=A-1-i.padInfo.front,te=O-1-i.padInfo.top,de=k-1-i.padInfo.left,ve=0;ve<I;++ve)for(var we=0;we<M;++we)for(var Se=0;Se<j;++Se)for(var Ie=Se-J,Fe=Math.max(0,Math.ceil(Ie/fe)),Ae=Math.min(ce,(A+Ie)/fe),Be=0;Be<X;++Be)for(var Le=Be-te,tt=Math.max(0,Math.ceil(Le/Q)),re=Math.min($,(O+Le)/Q),rt=0;rt<ue;++rt){for(var zt=rt-de,gt=Math.max(0,Math.ceil(zt/W)),He=Math.min(ae,(k+zt)/W),ft=0,lt=Fe;lt<Ae;++lt)for(var Et=lt*fe-Ie,pt=tt;pt<re;++pt)for(var En=pt*Q-Le,$t=gt;$t<He;++$t)for(var Qt=y*ve+b*lt+x*pt+E*$t,an=C*(A-1-Et)+D*(O-1-En)+z*(k-1-($t*W-zt))+L*we,qt=0;qt<ge;++qt)ft+=m[Qt+qt]*T[an+qt];s[u*ve+l*Se+h*Be+d*rt+we]=ft}return o.toTensor()},e.prototype.conv2dDerFilter=function(t,r,i){nt([t,r],"conv2dDerFilter");for(var o=i.strideHeight,s=i.strideWidth,a=i.filterHeight,u=i.filterWidth,l=i.dataFormat==="channelsLast",h=wn(i.filterShape,"float32"),d=i.padInfo.left,m=i.padInfo.top,p=this.bufferSync(t),y=this.bufferSync(r),b=0;b<a;++b)for(var x=Math.max(0,Math.ceil((m-b)/o)),E=Math.min(i.outHeight,(i.inHeight+m-b)/o),T=0;T<u;++T)for(var P=Math.max(0,Math.ceil((d-T)/s)),C=Math.min(i.outWidth,(i.inWidth+d-T)/s),D=0;D<i.inChannels;++D)for(var z=0;z<i.outChannels;++z){for(var L=0,I=0;I<i.batchSize;++I)for(var A=x;A<E;++A)for(var O=b+A*o-m,k=P;k<C;++k){var M=T+k*s-d;L+=l?p.get(I,O,M,D)*y.get(I,A,k,z):p.get(I,D,O,M)*y.get(I,z,A,k)}h.set(L,b,T,D,z)}return h.toTensor()},e.prototype.conv3dDerFilter=function(t,r,i){for(var o=i.strideDepth,s=i.strideHeight,a=i.strideWidth,u=i.filterDepth,l=i.filterHeight,h=i.filterWidth,d=wn(i.filterShape,"float32"),m=d.values,p=d.strides,y=p[0],b=p[1],x=p[2],E=p[3],T=this.readSync(r.dataId),P=r.strides,C=P[0],D=P[1],z=P[2],L=P[3],I=this.readSync(t.dataId),A=t.strides,O=A[0],k=A[1],M=A[2],j=A[3],X=i.padInfo.front,ue=i.padInfo.left,ge=i.padInfo.top,ce=0;ce<u;++ce)for(var $=Math.max(0,Math.ceil((X-ce)/o)),ae=Math.min(i.outDepth,(i.inDepth+X-ce)/o),fe=ce*y,Q=0;Q<l;++Q)for(var W=Math.max(0,Math.ceil((ge-Q)/s)),J=Math.min(i.outHeight,(i.inHeight+ge-Q)/s),te=Q*b+fe,de=0;de<h;++de)for(var ve=Math.max(0,Math.ceil((ue-de)/a)),we=Math.min(i.outWidth,(i.inWidth+ue-de)/a),Se=de*x+te,Ie=0;Ie<i.inChannels;++Ie)for(var Fe=Ie*E+Se,Ae=0;Ae<i.outChannels;++Ae){for(var Be=0,Le=0;Le<i.batchSize;++Le)for(var tt=Le*O,re=Le*C,rt=$;rt<ae;++rt)for(var zt=(ce+rt*o-X)*k+tt,gt=rt*D+re,He=W;He<J;++He)for(var ft=(Q+He*s-ge)*M+zt,lt=He*z+gt,Et=ve;Et<we;++Et){var pt=Et*L+lt;Be+=I[(de+Et*a-ue)*j+ft+Ie]*T[pt+Ae]}m[Fe+Ae]=Be}return d.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var r=t.input,i=t.filter,o=t.convInfo,s=t.bias,a=t.activation,u=t.preluActivationWeights,l=this.depthwiseConv2D(r,i,o);return s&&(l=this.add(l,s)),a&&(l=Hy(this,l,a,u)),l},e.prototype.depthwiseConv2D=function(t,r,i){nt([t,r],"depthwiseConv2D");for(var o=i.filterHeight,s=i.filterWidth,a=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,h=i.padInfo.top,d=i.outChannels/i.inChannels,m=wn(i.outShape,t.dtype),p=this.readSync(t.dataId),y=this.readSync(r.dataId),b=m.values,x=0;x<i.batchSize;++x)for(var E=x*t.strides[0],T=x*m.strides[0],P=0;P<i.outHeight;++P)for(var C=T+P*m.strides[1],D=P*i.strideHeight-l,z=0;z<o;++z){var L=D+z*a;if(!(L<0||L>=i.inHeight))for(var I=z*r.strides[0],A=E+L*t.strides[1],O=0;O<i.outWidth;++O)for(var k=C+O*m.strides[2],M=O*i.strideWidth-h,j=0;j<s;++j){var X=M+j*u;if(!(X<0||X>=i.inWidth))for(var ue=I+j*r.strides[1],ge=A+X*i.inChannels,ce=k,$=ue,ae=0;ae<i.inChannels;++ae){for(var fe=p[ge+ae],Q=0;Q<d;++Q)b[ce+Q]+=fe*y[$+Q];ce+=d,$+=d}}}return m.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,r,i){nt([t,r],"depthwiseConv2DDerInput");for(var o=wn(i.inShape,"float32"),s=o.values,a=o.strides,u=a[0],l=a[1],h=a[2],d=this.readSync(t.dataId),m=t.strides,p=m[0],y=m[1],b=m[2],x=this.readSync(r.dataId),E=r.strides,T=E[0],P=E[1],C=E[2],D=i.batchSize,z=i.filterHeight,L=i.filterWidth,I=i.inChannels,A=i.inHeight,O=i.inWidth,k=i.outChannels,M=i.outHeight,j=i.outWidth,X=i.strideHeight,ue=i.strideWidth,ge=z-1-i.padInfo.top,ce=L-1-i.padInfo.left,$=k/I,ae=0;ae<D;++ae)for(var fe=0;fe<I;++fe)for(var Q=0;Q<A;++Q)for(var W=Q-ge,J=Math.max(0,Math.ceil(W/X)),te=Math.min(M,(z+W)/X),de=0;de<O;++de){for(var ve=de-ce,we=Math.max(0,Math.ceil(ve/ue)),Se=Math.min(j,(L+ve)/ue),Ie=0,Fe=J;Fe<te;++Fe)for(var Ae=Fe*X-W,Be=we;Be<Se;++Be)for(var Le=p*ae+y*Fe+b*Be,tt=T*(z-1-Ae)+P*(L-1-(Be*ue-ve))+C*fe,re=0;re<$;++re)Ie+=d[Le+(fe*$+re)]*x[tt+re];s[u*ae+l*Q+h*de+fe]=Ie}return o.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,r,i){nt([t,r],"depthwiseConv2DDerFilter");for(var o=i.strideHeight,s=i.strideWidth,a=i.filterHeight,u=i.filterWidth,l=wn(i.filterShape,"float32"),h=i.padInfo.left,d=i.padInfo.top,m=i.outChannels/i.inChannels,p=this.bufferSync(t),y=this.bufferSync(r),b=0;b<a;++b)for(var x=Math.max(0,Math.ceil((d-b)/o)),E=Math.min(i.outHeight,(i.inHeight+d-b)/o),T=0;T<u;++T)for(var P=Math.max(0,Math.ceil((h-T)/s)),C=Math.min(i.outWidth,(i.inWidth+h-T)/s),D=0;D<i.outChannels;++D){for(var z=Math.trunc(D/m),L=D%m,I=0,A=0;A<i.batchSize;++A)for(var O=x;O<E;++O)for(var k=b+O*o-d,M=P;M<C;++M){var j=T+M*s-h;I+=p.get(A,k,j,z)*y.get(A,O,M,D)}l.set(I,b,T,z,L)}return l.toTensor()},e.prototype.tile=function(t,r){return nt(t,"tile"),oT(this.bufferSync(t),r)},e.prototype.pad=function(t,r,i){nt(t,"pad");var o=r.map((function(m,p){return m[0]+t.shape[p]+m[1]})),s=r.map((function(m){return m[0]})),a=this.bufferSync(t),u=wn(o,t.dtype);i!==0&&u.values.fill(i);for(var l=0;l<t.size;l++){var h=a.indexToLoc(l),d=h.map((function(m,p){return m+s[p]}));u.set.apply(u,[a.get.apply(a,h)].concat(d))}return u.toTensor()},e.prototype.transpose=function(t,r){nt(t,"transpose");for(var i=new Array(t.rank),o=0;o<i.length;o++)i[o]=t.shape[r[o]];var s=this.readSync(t.dataId),a=wn(i,t.dtype),u=this.bufferSync(t);for(o=0;o<t.size;++o){for(var l=u.indexToLoc(o),h=new Array(l.length),d=0;d<h.length;d++)h[d]=l[r[d]];var m=a.locToIndex(h);a.values[m]=s[o]}return a.toTensor()},e.prototype.gather=function(t,r,i){nt([t,r],"gather");var o=t.shape.slice(),s=this.readSync(r.dataId);o[i]=s.length;for(var a=wn(o,t.dtype),u=this.bufferSync(t),l=0;l<a.size;++l){var h=a.indexToLoc(l),d=h.slice();d[i]=s[h[i]];var m=u.locToIndex(d);a.values[l]=u.values[m]}return a.toTensor()},e.prototype.batchToSpaceND=function(t,r,i){nt([t],"batchToSpaceND");var o=r.reduce((function(d,m){return d*m})),s=i0(t.shape,r,o),a=o0(s.length,r.length),u=s0(t.shape,r,o),l=GI(i,r.length),h=$I(u,i,r.length);return t.reshape(s).transpose(a).reshape(u).slice(l,h)},e.prototype.spaceToBatchND=function(t,r,i){nt([t],"spaceToBatchND");var o=r.reduce((function(m,p){return m*p})),s=[[0,0]];s.push.apply(s,i);for(var a=1+r.length;a<t.shape.length;++a)s.push([0,0]);var u=t.pad(s),l=i0(u.shape,r,o,!1),h=o0(l.length,r.length,!1),d=s0(u.shape,r,o,!1);return u.reshape(l).transpose(h).reshape(d)},e.prototype.pool=function(t,r,i){nt(t,"pool");for(var o=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,m=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(t.dataId),b=wn(r.outShape,t.dtype),x=b.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3],T=r.outShape[2]*r.outShape[3],P=r.outShape[3],C=0;C<r.batchSize;++C)for(var D=C*E,z=C*t.strides[0],L=0;L<r.inChannels;++L)for(var I=0;I<r.outHeight;++I)for(var A=I*o-d,O=Math.max(0,A),k=Math.min(r.inHeight,l+A),M=D+I*T,j=0;j<r.outWidth;++j){for(var X=j*s-m,ue=Math.max(0,X),ge=Math.min(r.inWidth,h+X),ce=p,$=0,ae=0,fe=O;fe<k;fe+=a){for(var Q=z+fe*t.strides[1],W=ue;W<ge;W+=u){var J=y[Q+W*t.strides[2]+L];i==="max"&&J>ce?ce=J:i==="avg"&&($+=J,ae++)}if(isNaN(ce))break}x[M+j*P+L]=i==="avg"?$/ae:ce}return b.toTensor()},e.prototype.maxPool=function(t,r){return this.pool(t,r,"max")},e.prototype.maxPoolPositions=function(t,r){for(var i=wn(r.outShape,"int32"),o=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,m=r.padInfo.left,p=this.bufferSync(t),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var x=0;x<r.outHeight;++x){for(var E=x*o-d,T=E;T<0;)T+=a;for(var P=Math.min(r.inHeight,l+E),C=0;C<r.outWidth;++C){for(var D=C*s-m,z=D;z<0;)z+=u;for(var L=Math.min(r.inWidth,h+D),I=Number.NEGATIVE_INFINITY,A=-1,O=T;O<P;O+=a)for(var k=O-E,M=z;M<L;M+=u){var j=M-D,X=p.get(y,O,M,b);X>I&&(I=X,A=k*h+j)}i.set(A,y,x,C,b)}}return i.toTensor()},e.prototype.maxPoolBackprop=function(t,r,i,o){nt([r,i],"maxPoolBackprop");for(var s=this.maxPoolPositions(r,o),a=o.strideHeight,u=o.strideWidth,l=o.dilationHeight,h=o.dilationWidth,d=o.effectiveFilterHeight,m=o.effectiveFilterWidth,p=m-1-o.padInfo.left,y=d-1-o.padInfo.top,b=wn(r.shape,"float32"),x=this.bufferSync(s),E=this.bufferSync(t),T=0;T<o.batchSize;++T)for(var P=0;P<o.inChannels;++P)for(var C=0;C<o.inHeight;++C)for(var D=0;D<o.inWidth;++D){for(var z=C-y,L=D-p,I=0,A=0;A<d;A+=l){var O=(z+A)/a;if(!(O<0||O>=o.outHeight||Math.floor(O)!==O))for(var k=0;k<m;k+=h){var M=(L+k)/u;if(!(M<0||M>=o.outWidth||Math.floor(M)!==M)){var j=d*m-1-x.get(T,O,M,P)===A*m+k?1:0;j!==0&&(I+=E.get(T,O,M,P)*j)}}}b.set(I,T,C,D,P)}return b.toTensor()},e.prototype.avgPoolBackprop=function(t,r,i){nt([t,r],"avgPoolBackprop");for(var o=i.strideHeight,s=i.strideWidth,a=i.filterHeight,u=i.filterWidth,l=i.dilationHeight,h=i.dilationWidth,d=i.effectiveFilterHeight,m=i.effectiveFilterWidth,p=m-1-i.padInfo.left,y=d-1-i.padInfo.top,b=wn(r.shape,"float32"),x=1/(a*u),E=this.bufferSync(t),T=0;T<i.batchSize;++T)for(var P=0;P<i.inChannels;++P)for(var C=0;C<i.inHeight;++C)for(var D=0;D<i.inWidth;++D){for(var z=C-y,L=D-p,I=0,A=0;A<d;A+=l){var O=(z+A)/o;if(!(O<0||O>=i.outHeight||Math.floor(O)!==O))for(var k=0;k<m;k+=h){var M=(L+k)/s;M<0||M>=i.outWidth||Math.floor(M)!==M||(I+=E.get(T,O,M,P))}}b.set(I*x,T,C,D,P)}return b.toTensor()},e.prototype.pool3d=function(t,r,i){nt(t,"pool3d");for(var o=r.strideDepth,s=r.strideHeight,a=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,m=r.effectiveFilterHeight,p=r.effectiveFilterWidth,y=r.padInfo.front,b=r.padInfo.top,x=r.padInfo.left,E=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,T=this.readSync(t.dataId),P=wn(r.outShape,t.dtype),C=P.values,D=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],z=r.outShape[2]*r.outShape[3]*r.outShape[4],L=r.outShape[3]*r.outShape[4],I=r.outShape[4],A=0;A<r.batchSize;++A)for(var O=A*D,k=A*t.strides[0],M=0;M<r.inChannels;++M)for(var j=0;j<r.outDepth;++j){for(var X=j*o-y,ue=X;ue<0;)ue+=u;for(var ge=Math.min(r.inDepth,d+X),ce=O+j*z,$=0;$<r.outHeight;++$){for(var ae=$*s-b,fe=ae;fe<0;)fe+=l;for(var Q=Math.min(r.inHeight,m+ae),W=ce+$*L,J=0;J<r.outWidth;++J){for(var te=J*a-x,de=te;de<0;)de+=h;for(var ve=Math.min(r.inWidth,p+te),we=W+J*I,Se=E,Ie=0,Fe=0,Ae=ue;Ae<ge;Ae+=u){for(var Be=k+Ae*t.strides[1],Le=fe;Le<Q;Le+=l){for(var tt=Be+Le*t.strides[2],re=de;re<ve;re+=h){var rt=T[tt+re*t.strides[3]+M];if(i==="max"&&rt>Se?Se=rt:i==="avg"&&(Ie+=rt,Fe++),isNaN(Se))break}if(isNaN(Se))break}if(isNaN(Se))break}C[we+M]=i==="avg"?Ie/Fe:Se}}}return P.toTensor()},e.prototype.avgPool3d=function(t,r){return nt(t,"avgPool3d"),this.pool3d(t,r,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,r,i){nt([t,r],"avgPool3dBackprop");for(var o=i.strideDepth,s=i.strideHeight,a=i.strideWidth,u=i.filterDepth,l=i.filterHeight,h=i.filterWidth,d=i.dilationDepth,m=i.dilationHeight,p=i.dilationWidth,y=i.effectiveFilterDepth,b=i.effectiveFilterHeight,x=i.effectiveFilterWidth,E=y-1-i.padInfo.front,T=x-1-i.padInfo.left,P=b-1-i.padInfo.top,C=wn(r.shape,"float32"),D=1/(u*l*h),z=this.bufferSync(t),L=0;L<i.batchSize;++L)for(var I=0;I<i.inChannels;++I)for(var A=0;A<i.inDepth;++A)for(var O=0;O<i.inHeight;++O)for(var k=0;k<i.inWidth;++k){for(var M=A-E,j=O-P,X=k-T,ue=0,ge=0;ge<y;ge+=d){var ce=(M+ge)/o;if(!(ce<0||ce>=i.outDepth||Math.floor(ce)!==ce))for(var $=0;$<b;$+=m){var ae=(j+$)/s;if(!(ae<0||ae>=i.outHeight||Math.floor(ae)!==ae))for(var fe=0;fe<x;fe+=p){var Q=(X+fe)/a;Q<0||Q>=i.outWidth||Math.floor(Q)!==Q||(ue+=z.get(L,ce,ae,Q,I))}}}C.set(ue*D,L,A,O,k,I)}return C.toTensor()},e.prototype.maxPool3d=function(t,r){return nt(t,"maxPool3d"),this.pool3d(t,r,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,r){for(var i=wn(r.outShape,"int32"),o=r.strideDepth,s=r.strideHeight,a=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,m=r.effectiveFilterHeight,p=r.effectiveFilterWidth,y=r.padInfo.front,b=r.padInfo.top,x=r.padInfo.left,E=this.bufferSync(t),T=0;T<r.batchSize;++T)for(var P=0;P<r.inChannels;++P)for(var C=0;C<r.outDepth;++C){for(var D=C*o-y,z=D;z<0;)z+=u;for(var L=Math.min(r.inDepth,d+D),I=0;I<r.outHeight;++I){for(var A=I*s-b,O=A;O<0;)O+=l;for(var k=Math.min(r.inHeight,m+A),M=0;M<r.outWidth;++M){for(var j=M*a-x,X=j;X<0;)X+=h;for(var ue=Math.min(r.inWidth,p+j),ge=Number.NEGATIVE_INFINITY,ce=-1,$=z;$<L;$+=u)for(var ae=$-D,fe=O;fe<k;fe+=l)for(var Q=fe-A,W=X;W<ue;W+=h){var J=W-j,te=E.get(T,$,fe,W,P);te>=ge&&(ge=te,ce=ae*m*p+Q*m+J)}i.set(ce,T,C,I,M,P)}}}return i.toTensor()},e.prototype.maxPool3dBackprop=function(t,r,i,o){nt([r,i],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(r,o),a=o.strideDepth,u=o.strideHeight,l=o.strideWidth,h=o.dilationDepth,d=o.dilationHeight,m=o.dilationWidth,p=o.effectiveFilterDepth,y=o.effectiveFilterHeight,b=o.effectiveFilterWidth,x=p-1-o.padInfo.front,E=b-1-o.padInfo.left,T=y-1-o.padInfo.top,P=wn(r.shape,"float32"),C=this.bufferSync(s),D=this.bufferSync(t),z=0;z<o.batchSize;++z)for(var L=0;L<o.inChannels;++L)for(var I=0;I<o.inDepth;++I)for(var A=0;A<o.inHeight;++A)for(var O=0;O<o.inWidth;++O){for(var k=I-x,M=A-T,j=O-E,X=0,ue=0;ue<p;ue+=h){var ge=(k+ue)/a;if(!(ge<0||ge>=o.outDepth||Math.floor(ge)!==ge))for(var ce=0;ce<y;ce+=d){var $=(M+ce)/u;if(!($<0||$>=o.outHeight||Math.floor($)!==$))for(var ae=0;ae<b;ae+=m){var fe=(j+ae)/l;if(!(fe<0||fe>=o.outWidth||Math.floor(fe)!==fe)){var Q=p*y*b-1-C.get(z,ge,$,fe,L)===ue*y*b+ce*b+ae?1:0;Q!==0&&(X+=D.get(z,ge,$,fe,L)*Q)}}}}P.set(X,z,I,A,O,L)}return P.toTensor()},e.prototype.cast=function(t,r){return tT(t,r,this)},e.prototype.reshape=function(t,r){return hw(t,r)},e.prototype.avgPool=function(t,r){return nt(t,"avgPool"),this.pool(t,r,"avg").toFloat()},e.prototype.resizeBilinear=function(t,r,i,o){nt(t,"resizeBilinear");for(var s=t.shape,a=s[0],u=s[1],l=s[2],h=s[3],d=this.readSync(t.dataId),m=new Float32Array(Mt([a,r,i,h])),p=[o&&r>1?u-1:u,o&&i>1?l-1:l],y=[o&&r>1?r-1:r,o&&i>1?i-1:i],b=0,x=p[0]/y[0],E=p[1]/y[1],T=0;T<a;T++)for(var P=0;P<r;P++)for(var C=x*P,D=Math.floor(C),z=C-D,L=Math.min(u-1,Math.ceil(C)),I=T*t.strides[0]+D*t.strides[1],A=T*t.strides[0]+L*t.strides[1],O=0;O<i;O++)for(var k=E*O,M=Math.floor(k),j=k-M,X=Math.min(l-1,Math.ceil(k)),ue=I+M*t.strides[2],ge=A+M*t.strides[2],ce=I+X*t.strides[2],$=A+X*t.strides[2],ae=0;ae<h;ae++){var fe=d[ue+ae],Q=d[ge+ae],W=fe+(d[ce+ae]-fe)*j,J=W+(Q+(d[$+ae]-Q)*j-W)*z;m[b++]=J}return Po(m,[a,r,i,h])},e.prototype.resizeBilinearBackprop=function(t,r,i){nt([t,r],"resizeBilinearBackprop");for(var o=r.shape,s=o[0],a=o[1],u=o[2],l=o[3],h=t.shape,d=h[1],m=h[2],p=new Float32Array(s*a*u*l),y=[i&&d>1?a-1:a,i&&m>1?u-1:u],b=[i&&d>1?d-1:d,i&&m>1?m-1:m],x=y[0]/b[0],E=y[1]/b[1],T=this.readSync(t.dataId),P=0,C=0;C<s;C++)for(var D=C*r.strides[0],z=0;z<d;z++)for(var L=z*x,I=Math.floor(L),A=Math.min(Math.ceil(L),a-1),O=D+I*r.strides[1],k=D+A*r.strides[1],M=L-I,j=1-M,X=0;X<m;X++)for(var ue=X*E,ge=Math.floor(ue),ce=Math.min(Math.ceil(ue),u-1),$=ue-ge,ae=1-$,fe=O+ge*r.strides[2],Q=O+ce*r.strides[2],W=k+ge*r.strides[2],J=k+ce*r.strides[2],te=j*ae,de=j*$,ve=M*ae,we=M*$,Se=0;Se<l;Se++){var Ie=T[P++];p[fe+Se]+=Ie*te,p[Q+Se]+=Ie*de,p[W+Se]+=Ie*ve,p[J+Se]+=Ie*we}return zs(p,[s,u,a,l],r.dtype)},e.prototype.resizeNearestNeighbor=function(t,r,i,o){nt(t,"resizeNearestNeighbor");for(var s=t.shape,a=s[0],u=s[1],l=s[2],h=s[3],d=this.readSync(t.dataId),m=new Float32Array(a*r*i*h),p=[o&&r>1?u-1:u,o&&i>1?l-1:l],y=[o&&r>1?r-1:r,o&&i>1?i-1:i],b=p[0]/y[0],x=p[1]/y[1],E=0,T=0;T<a;T++)for(var P=T*t.strides[0],C=0;C<r;C++)for(var D=b*C,z=P+Math.min(u-1,o?Math.round(D):Math.floor(D))*t.strides[1],L=0;L<i;L++)for(var I=x*L,A=z+Math.min(l-1,o?Math.round(I):Math.floor(I))*t.strides[2],O=0;O<h;O++){var k=d[A+O];m[E++]=k}return Po(m,[a,r,i,h],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,r,i){nt([t,r],"resizeNearestNeighborBackprop");for(var o=r.shape,s=o[0],a=o[1],u=o[2],l=o[3],h=t.shape,d=h[1],m=h[2],p=new Float32Array(s*a*u*l),y=this.readSync(t.dataId),b=[i&&d>1?a-1:a,i&&m>1?u-1:u],x=[i&&d>1?d-1:d,i&&m>1?m-1:m],E=b[0]/x[0],T=b[1]/x[1],P=1/E,C=1/T,D=2*Math.ceil(P)+2,z=2*Math.ceil(C)+2,L=0;L<s;L++)for(var I=L*r.strides[0],A=0;A<a;A++)for(var O=I+A*r.strides[1],k=Math.floor(A*P),M=Math.floor(k-D/2),j=0;j<u;j++)for(var X=O+j*r.strides[2],ue=Math.floor(j*C),ge=Math.floor(ue-z/2),ce=0;ce<l;ce++){for(var $=0,ae=0;ae<D;ae++){var fe=ae+M;if(!(fe<0||fe>=d)){var Q=I+fe*t.strides[1],W=fe*E;if(A===Math.min(a-1,i?Math.round(W):Math.floor(W)))for(var J=0;J<z;J++){var te=J+ge;if(!(te<0||te>=m)){var de=Q+te*t.strides[2],ve=te*T;j===Math.min(u-1,i?Math.round(ve):Math.floor(ve))&&($+=y[de+ce])}}}}p[X+ce]=$}return zs(p,r.shape,r.dtype)},e.prototype.batchNormalization=function(t,r,i,o,s,a){nt([t,r,i,s,a],"batchNorm");for(var u=this.readSync(t.dataId),l=this.readSync(r.dataId),h=this.readSync(i.dataId),d=s?this.readSync(s.dataId):new Float32Array([1]),m=a?this.readSync(a.dataId):new Float32Array([0]),p=new Float32Array(u.length),y=m.length,b=d.length,x=h.length,E=l.length,T=0,P=0,C=0,D=0,z=0;z<u.length;++z)p[z]=m[T++]+(u[z]-l[P++])*d[C++]/Math.sqrt(h[D++]+o),T>=y&&(T=0),P>=E&&(P=0),C>=b&&(C=0),D>=x&&(D=0);return zs(p,t.shape)},e.prototype.localResponseNormalization4D=function(t,r,i,o,s){nt(t,"localResponseNormalization4D");var a=t.shape[3],u=a-1,l=this.readSync(t.dataId),h=t.size,d=new Float32Array(h);function m(x){for(var E=x%a,T=x-E+Math.max(0,E-r),P=x-E+Math.min(E+r,u),C=0;T<=P;T++){var D=l[T];C+=D*D}return C}for(var p=0;p<h;p++){var y=m(p),b=l[p]*Math.pow(i+o*y,-s);d[p]=b}return zs(d,t.shape)},e.prototype.LRNGrad=function(t,r,i,o,s,a,u){nt(t,"LRNGrad");for(var l=t.shape[3],h=this.readSync(t.dataId),d=this.readSync(r.dataId),m=this.readSync(i.dataId),p=new Float32Array(t.size),y=t.size,b=0;b<y;b++){for(var x=b%l,E=b-x+Math.max(0,x-o),T=b-x+Math.min(l,x+o+1),P=0,C=E;C<T;C++)P+=Math.pow(d[C],2);for(P=a*P+s,C=E;C<T;C++){var D=-2*a*u*d[C]*m[b]/P;b===C&&(D+=Math.pow(P,-u)),D*=h[b],p[C]+=D}}return zs(p,t.shape)},e.prototype.multinomial=function(t,r,i,o){nt(t,"multinomial");for(var s=r?t:ic(t),a=s.shape[0],u=s.shape[1],l=Tr([a,i],"int32"),h=this.readSync(l.dataId),d=this.readSync(s.dataId),m=0;m<a;++m){var p=m*u,y=new Float32Array(u-1);y[0]=d[p];for(var b=1;b<y.length;++b)y[b]=y[b-1]+d[p+b];for(var x=q0(o.toString()),E=m*i,T=0;T<i;++T){var P=x();h[E+T]=y.length;for(var C=0;C<y.length;C++)if(P<y[C]){h[E+T]=C;break}}}return l},e.prototype.oneHot=function(t,r,i,o){nt(t,"oneHot");var s=new Float32Array(t.size*r);s.fill(o);for(var a=this.readSync(t.dataId),u=0;u<t.size;++u)a[u]>=0&&a[u]<r&&(s[u*r+a[u]]=i);return Yc(s,[t.size,r],"int32")},e.prototype.nonMaxSuppression=function(t,r,i,o,s){return nt(t,"nonMaxSuppression"),Xb(this.readSync(t.dataId),this.readSync(r.dataId),i,o,s)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,r){for(var i=t.shape[0],o=t.shape[1],s=wn(t.shape,"float32"),a=wn(t.shape,"float32"),u=qa(t).as2D(i,o),l=tl(t).as2D(i,o),h=0;h<i;h++)for(var d=u.slice([h,0],[1,o]),m=l.slice([h,0],[1,o]),p=ko(d,m),y=this.readSync(this.fftImpl(p,r).dataId),b=0;b<o;b++){var x=hS(y,b);s.values[h*o+b]=x.real,a.values[h*o+b]=x.imag}return ko(s.toTensor(),a.toTensor()).as2D(i,o)},e.prototype.fftImpl=function(t,r){var i=t.as1D(),o=i.size;if(this.isExponentOf2(o)){var s=this.fftRadix2(i,o,r).as2D(t.shape[0],t.shape[1]);return r&&(s=ko(qa(s).div(dt(o)),tl(s).div(dt(o)))),s}var a=this.readSync(t.dataId),u=(function(l){for(var h=new Float32Array(l.length/2),d=new Float32Array(l.length/2),m=0;m<l.length;m+=2)h[m/2]=l[m],d[m/2]=l[m+1];return{real:h,imag:d}})(this.fourierTransformByMatmul(a,o,r));return ko(u.real,u.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return(t&t-1)==0},e.prototype.fftRadix2=function(t,r,i){if(r===1)return t;var o=this.readSync(t.dataId),s=r/2,a=(function(E){for(var T=Math.ceil(E.length/4),P=new Float32Array(T),C=new Float32Array(T),D=0;D<E.length;D+=4)P[Math.floor(D/4)]=E[D],C[Math.floor(D/4)]=E[D+1];return{real:P,imag:C}})(o),u=ko(a.real,a.imag).as1D(),l=(function(E){for(var T=Math.floor(E.length/4),P=new Float32Array(T),C=new Float32Array(T),D=2;D<E.length;D+=4)P[Math.floor(D/4)]=E[D],C[Math.floor(D/4)]=E[D+1];return{real:P,imag:C}})(o),h=ko(l.real,l.imag).as1D();u=this.fftRadix2(u,s,i),h=this.fftRadix2(h,s,i);var d=(function(E,T){for(var P=new Float32Array(E/2),C=new Float32Array(E/2),D=0;D<Math.ceil(E/2);D++){var z=(T?2:-2)*Math.PI*(D/E);P[D]=Math.cos(z),C[D]=Math.sin(z)}return{real:P,imag:C}})(r,i),m=ko(d.real,d.imag).mul(h),p=u.add(m),y=u.sub(m),b=qa(p).concat(qa(y)),x=tl(p).concat(tl(y));return ko(b,x).as1D()},e.prototype.fourierTransformByMatmul=function(t,r,i){for(var o=new Float32Array(2*r),s=0;s<r;s++){for(var a=0,u=0,l=0;l<r;l++){var h=W8(s*l,r,i),d=hS(t,l);a+=d.real*h.real-d.imag*h.imag,u+=d.real*h.imag+d.imag*h.real}i&&(a/=r,u/=r),z8(o,a,u,s)}return o},e.prototype.depthToSpace=function(t,r,i){me(i==="NHWC",(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i})),me(r>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+r}));for(var o=t.shape[0],s=t.shape[1],a=t.shape[2],u=t.shape[3],l=s*r,h=a*r,d=u/(r*r),m=this.readSync(t.dataId),p=new Float32Array(o*l*h*d),y=0,b=0;b<o;++b)for(var x=0;x<l;++x)for(var E=Math.floor(x/r),T=x%r,P=0;P<h;++P)for(var C=Math.floor(P/r),D=(T*r+P%r)*d,z=0;z<d;++z){var L=z+D+u*(C+a*(E+s*b));p[y++]=m[L]}return zs(p,[o,l,h,d])},e.prototype.broadcastedBinaryOp=function(t,r,i,o){var s=Mn(t.shape,r.shape),a=wn(s,i),u=this.readSync(t.dataId),l=this.readSync(r.dataId),h=Hc(t.shape,s),d=Hc(r.shape,s),m=a.values;if(h.length+d.length===0)for(var p=0;p<m.length;++p)m[p]=o(u[p%u.length],l[p%l.length]);else{var y=this.bufferSync(t),b=this.bufferSync(r),x=function(E){var T=a.indexToLoc(E),P=T.slice(-t.rank);h.forEach((function(L){return P[L]=0}));var C=y.locToIndex(P),D=T.slice(-r.rank);d.forEach((function(L){return D[L]=0}));var z=b.locToIndex(D);m[E]=o(u[C],l[z])};for(p=0;p<m.length;++p)x(p)}return a.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,r,i){var o=Mn(t.shape,r.shape),s=wn(o,"float32"),a=wn(o,"float32"),u=this.readSync(t.dataId),l=this.readSync(r.dataId),h=Hc(t.shape,o),d=Hc(r.shape,o),m=s.values,p=a.values;if(h.length+d.length===0)for(var y=0;y<m.length;y++){var b=y%u.length,x=y%l.length,E=i(u[2*b],u[2*b+1],l[2*x],l[2*x+1]);m[y]=E.real,p[y]=E.imag}else{var T=this.bufferSync(this.data.get(t.dataId).complexTensors.real),P=this.bufferSync(this.data.get(r.dataId).complexTensors.real),C=function(D){var z=s.indexToLoc(D),L=z.slice(-t.rank);h.forEach((function(M){return L[M]=0}));var I=T.locToIndex(L),A=z.slice(-r.rank);d.forEach((function(M){return A[M]=0}));var O=P.locToIndex(A),k=i(u[2*I],u[2*I+1],l[2*O],l[2*O+1]);m[D]=k.real,p[D]=k.imag};for(y=0;y<m.length;y++)C(y)}return this.complex(s.toTensor(),a.toTensor())},e.prototype.split=function(t,r,i){return iT(t,r,i)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,r,i,o,s,a){for(var u=t.shape,l=u[0],h=u[1],d=u[2],m=u[3],p=r.shape[0],y=o[0],b=o[1],x=wn([p,y,b,m],"float32"),E=this.readSync(r.dataId),T=this.readSync(i.dataId),P=this.readSync(t.dataId),C=t.strides,D=x.strides,z=0;z<p;z++){var L=4*z,I=E[L],A=E[L+1],O=E[L+2],k=E[L+3],M=T[z];if(!(M>=l))for(var j=y>1?(O-I)*(h-1)/(y-1):0,X=b>1?(k-A)*(d-1)/(b-1):0,ue=0;ue<y;ue++){var ge=y>1?I*(h-1)+ue*j:.5*(I+O)*(h-1);if(ge<0||ge>h-1)for(var ce=0;ce<b;ce++)for(var $=0;$<m;$++){var ae=$+ce*D[2]+ue*D[1]+z*D[0];x.values[ae]=a}else if(s==="bilinear"){var fe=Math.floor(ge),Q=Math.ceil(ge),W=ge-fe;for(ce=0;ce<b;ce++)if((Ae=b>1?A*(d-1)+ce*X:.5*(A+k)*(d-1))<0||Ae>d-1)for($=0;$<m;$++)ae=$+ce*D[2]+ue*D[1]+z*D[0],x.values[ae]=a;else{var J=Math.floor(Ae),te=Math.ceil(Ae),de=Ae-J;for($=0;$<m;$++){var ve=P[ae=$+J*C[2]+fe*C[1]+M*C[0]],we=P[ae=$+te*C[2]+fe*C[1]+M*C[0]],Se=P[ae=$+J*C[2]+Q*C[1]+M*C[0]],Ie=ve+(we-ve)*de,Fe=Se+(P[ae=$+te*C[2]+Q*C[1]+M*C[0]]-Se)*de;ae=$+ce*D[2]+ue*D[1]+z*D[0],x.values[ae]=Ie+(Fe-Ie)*W}}}else for(ce=0;ce<b;++ce){var Ae;if((Ae=b>1?A*(d-1)+ce*X:.5*(A+k)*(d-1))<0||Ae>d-1)for($=0;$<m;$++)ae=$+ce*D[2]+ue*D[1]+z*D[0],x.values[ae]=a;else{var Be=Math.round(Ae),Le=Math.round(ge);for($=0;$<m;$++){var tt=$+Be*C[2]+Le*C[1]+M*C[0],re=$+ce*D[2]+ue*D[1]+z*D[0];x.values[re]=P[tt]}}}}}return x.toTensor()},e.prototype.sparseToDense=function(t,r,i,o){var s=a0(0,t,i),a=s.sliceRank,u=s.numUpdates,l=s.sliceSize,h=s.strides,d=s.outputSize;return this.scatter(t,r,i,d,l,u,a,h,o,!1)},e.prototype.gatherND=function(t,r){var i=r.shape,o=i[i.length-1],s=KI(t,r),a=s[0],u=s[1],l=s[2],h=s[3];if(u===0)return Po([],a,t.dtype);for(var d=new bm([u,l],t.dtype),m=this.readSync(r.dataId),p=this.readSync(t.dataId),y=0;y<u;y++){for(var b=[],x=0,E=0;E<o;E++){var T=m[y*o+E];x+=T*h[E],b.push(T)}if(x<0||x>=t.size/l)throw new Error("Invalid indices: "+b+" does not index into "+t.shape);for(var P=0;P<l;P++)d.values[y*l+P]=p[x*l+P]}return d.toTensor().reshape(a)},e.prototype.scatterND=function(t,r,i){var o=a0(0,t,i),s=o.sliceRank,a=o.numUpdates,u=o.sliceSize,l=o.strides,h=o.outputSize,d=dt(0);return this.scatter(t,r,i,h,u,a,s,l,d,!0)},e.prototype.fill=function(t,r,i){var o=Qv(i=i||Um(r),Mt(t));return o.fill(r),Te.makeTensor(o,t,i,this)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var r=Qv(t.dtype,Mt(t.shape));return this.makeOutput(r,t.shape,t.dtype)},e.prototype.linspace=function(t,r,i){return nT(t,r,i)},e.prototype.scatter=function(t,r,i,o,s,a,u,l,h,d){var m=[o/s,s],p=this.readSync(t.dataId),y=this.readSync(r.dataId);if(o===0)return Po([],i,r.dtype);var b=new bm(m,r.dtype);b.values.fill(this.readSync(h.dataId)[0]);for(var x=0;x<a;x++){for(var E=[],T=0,P=0;P<u;P++){var C=p[x*u+P];E.push(C),T+=C*l[P]}if(T<0||T>=o/s)throw new Error("Invalid indices: "+E+" does not index into "+i);for(var D=0;D<s;D++)d?b.values[T*s+D]+=y[x*s+D]:b.values[T*s+D]=r.rank===0?y[0]:y[x*s+D]}return b.toTensor().reshape(i)},e})(ZI);Te.registerBackend("cpu",(function(){return new l9}),1);for(var Gy=0,DS=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs,i=e,o=i.boxes,s=i.scores,a=r,u=a.maxOutputSize,l=a.iouThreshold,h=a.scoreThreshold,d=a.softNmsSigma,m=t;nt(o,"NonMaxSuppressionWithScore");var p=Yb(m.data.get(o.dataId).values,m.data.get(s.dataId).values,u,l,h,d);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e.x,i=t;nt(r,"square");for(var o=i.data.get(r.dataId).values,s=new Float32Array(o.length),a=0;a<o.length;++a){var u=o[a];s[a]=u*u}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Em,backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e,i=r.a,o=r.b,s=t;nt([i,o],Em);var a=s.data.get(i.dataId).values,u=s.data.get(o.dataId).values,l=(function(m,p,y,b,x,E){var T=Mn(m,p),P=T.length,C=ll(T),D=wm(x,Mt(T)),z=m.length,L=p.length,I=ll(m),A=ll(p),O=Hc(m,T),k=Hc(p,T);if(O.length+k.length===0)for(var M=0;M<D.length;++M)D[M]=E(y[M%y.length],b[M%b.length]);else{var j=function(X){var ue=wF(X,P,C),ge=ue.slice(-z);O.forEach((function(fe){return ge[fe]=0}));var ce=nS(ge,z,I),$=ue.slice(-L);k.forEach((function(fe){return $[fe]=0}));var ae=nS($,L,A);D[X]=E(y[ce],b[ae])};for(M=0;M<D.length;++M)j(M)}return[D,T]})(i.shape,o.shape,a,u,i.dtype,(function(m,p){var y=m-p;return y*y})),h=l[0],d=l[1];return{dataId:s.write(h,d,i.dtype),shape:d,dtype:i.dtype}}}];Gy<DS.length;Gy++)II(DS[Gy]);var Yf,c9=function(n){this.variableNames=["A"];var e=os(),t=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+t+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},h9=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=os(),t=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+t+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `};for(var $y=0,LS=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs,i=e.pixels,o=r.numChannels,s=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,u=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=u[0],h=u[1],d=[h,l],m=[h,l,o];(a||s)&&(Yf==null&&(Yf=document.createElement("canvas").getContext("2d")),Yf.canvas.width=l,Yf.canvas.height=h,Yf.drawImage(i,0,0,l,h),i=Yf.canvas);var p=t.makeTensorInfo(d,"int32");t.texData.get(p.dataId).usage=da.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(p.dataId),i);var y=Ye().getBool("WEBGL_PACK")?new h9(m):new c9(m),b=t.runWebGLProgram(y,[p],"int32");return t.disposeData(p.dataId),b}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs;t0("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=e,o=i.boxes,s=i.scores,a=r,u=a.maxOutputSize,l=a.iouThreshold,h=a.scoreThreshold,d=a.softNmsSigma,m=t,p=Yb(m.readSync(o.dataId),m.readSync(s.dataId),u,l,h,d);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e.x,i=t,o=new Sn(r.shape,"return x * x;");return i.runWebGLProgram(o,[r],r.dtype)}},{kernelName:Em,backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e,i=r.a,o=r.b,s=t,a=Ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gl("return (a - b) * (a - b);",i.shape,o.shape):new ii("return (a - b) * (a - b);",i.shape,o.shape);return s.compileAndRun(a,[i,o])}}];$y<LS.length;$y++)II(LS[$y]);for(var Ky=0,MS=[{kernelName:"Square",gradFunc:function(n,e){var t=e[0];return{x:function(){return n.mul(t.toFloat().mul(2))}}}},{kernelName:Em,gradFunc:function(n,e){var t=e[0],r=e[1],i=dt(2);return{a:function(){return us(n,us(i,Ki(t,r)))},b:function(){return us(n,us(i,Ki(r,t)))}}}}];Ky<MS.length;Ky++)uF(MS[Ky]);var f9=(function(){function n(){}return n.prototype.fetch=function(e,t){return fetch(e,t)},n.prototype.now=function(){return performance.now()},n.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+t);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},n.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},n})();Ye().get("IS_BROWSER")&&Ye().setPlatform("browser",new f9);var Xy,d9=function(){return require("node-fetch")},p9=(function(){function n(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return n.prototype.fetch=function(e,t){return Ye().global.fetch!=null?Ye().global.fetch(e,t):(Xy==null&&(Xy=d9()),Xy(e,t))},n.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},n.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},n.prototype.decode=function(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)},n})();Ye().get("IS_NODE")&&Ye().setPlatform("node",new p9);var pw={float32:4,int32:4,uint16:2,uint8:1,bool:1},p0=4;function YT(n,e){for(var t={},r=0,i=function(a){var u=a.name,l=a.dtype,h=a.shape,d=Mt(h),m=void 0;if("quantization"in a){var p=a.quantization;if(p.dtype!=="uint8"&&p.dtype!=="uint16")throw new Error("Weight "+a.name+" has unknown quantization dtype "+p.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var y=pw[p.dtype],b=n.slice(r,r+d*y),x=p.dtype==="uint8"?new Uint8Array(b):new Uint16Array(b);if(l==="float32")m=Float32Array.from(x,(function(z){return z*p.scale+p.min}));else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);m=Int32Array.from(x,(function(z){return Math.round(z*p.scale+p.min)}))}r+=d*y}else if(l==="string"){var E=Mt(a.shape);m=[];for(var T=0;T<E;T++){var P=new Uint32Array(n.slice(r,r+p0))[0];r+=p0;var C=new Uint8Array(n.slice(r,r+P));m.push(C),r+=P}}else{var D=pw[l];if(b=n.slice(r,r+d*D),l==="float32")m=new Float32Array(b);else if(l==="int32")m=new Int32Array(b);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);m=new Uint8Array(b)}r+=d*D}t[u]=Po(m,h,l)},o=0,s=e;o<s.length;o++)i(s[o]);return t}function m9(n){if(n===null)throw new Error("Invalid input value: "+JSON.stringify(n));var e=0,t=[];n.forEach((function(o){if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+o.constructor.name)}));var r=new Uint8Array(e),i=0;return t.forEach((function(o){r.set(new Uint8Array(o.buffer),i),i+=o.byteLength})),r.buffer}var mw=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function OS(n){return mw?Buffer.byteLength(n):new Blob([n]).size}function mx(n){var e=0;n.forEach((function(i){e+=i.byteLength}));var t=new Uint8Array(e),r=0;return n.forEach((function(i){t.set(new Uint8Array(i),r),r+=i.byteLength})),t.buffer}function FS(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);var e=n.split("/");return e[e.length-1]}function Km(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:OS(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:OS(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}var pa=(function(){function n(){this.saveRouters=[],this.loadRouters=[]}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerSaveRouter=function(e){n.getInstance().saveRouters.push(e)},n.registerLoadRouter=function(e){n.getInstance().loadRouters.push(e)},n.getSaveHandlers=function(e){return n.getHandlers(e,"save")},n.getLoadHandlers=function(e,t){return n.getHandlers(e,"load",t)},n.getHandlers=function(e,t,r){var i=[];return(t==="load"?n.getInstance().loadRouters:n.getInstance().saveRouters).forEach((function(o){var s=o(e,r);s!==null&&i.push(s)})),i},n})(),_d="://",Qc=(function(){function n(){this.managers={}}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerManager=function(e,t){me(e!=null,(function(){return"scheme must not be undefined or null."})),e.endsWith(_d)&&(e=e.slice(0,e.indexOf(_d))),me(e.length>0,(function(){return"scheme must not be an empty string."}));var r=n.getInstance();me(r.managers[e]==null,(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=t},n.getManager=function(e){var t=this.getInstance().managers[e];if(t==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},n.getSchemes=function(){return Object.keys(this.getInstance().managers)},n})();function Cv(n){if(n.indexOf(_d)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Qc.getSchemes().join(","));return{scheme:n.split(_d)[0],path:n.split(_d)[1]}}function BS(n,e,t){return t===void 0&&(t=!1),Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,l,h,d;return Rt(this,(function(m){switch(m.label){case 0:return me(n!==e,(function(){return"Old path and new path are the same: '"+n+"'"})),me((r=pa.getLoadHandlers(n)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+n+"."})),me(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+n+"."})),i=r[0],me((o=pa.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),me(o.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),s=o[0],a=Cv(n).scheme,u=Cv(n).path,l=a===Cv(n).scheme,[4,i.load()];case 1:return h=m.sent(),t&&l?[4,Qc.getManager(a).removeModel(u)]:[3,3];case 2:m.sent(),m.label=3;case 3:return[4,s.save(h)];case 4:return d=m.sent(),!t||l?[3,6]:[4,Qc.getManager(a).removeModel(u)];case 5:m.sent(),m.label=6;case 6:return[2,d.modelArtifactsInfo]}}))}))}var ef="models_store",Gc="model_info_store";function QT(){if(!Ye().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var n=window||self,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function gw(n){var e=n.result;e.createObjectStore(ef,{keyPath:"modelPath"}),e.createObjectStore(Gc,{keyPath:"modelPath"})}var Ed=(function(){function n(e){if(this.indexedDB=QT(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return n.prototype.save=function(e){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},n.prototype.load=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},n.prototype.databaseAction=function(e,t){var r=this;return new Promise((function(i,o){var s=r.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return gw(s)},s.onsuccess=function(){var a=s.result;if(t==null){var u=a.transaction(ef,"readonly"),l=u.objectStore(ef).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return a.close(),o(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(l.result.modelArtifacts)},l.onerror=function(b){return a.close(),o(l.error)},u.oncomplete=function(){return a.close()}}else{var h,d=Km(t),m=a.transaction(Gc,"readwrite"),p=m.objectStore(Gc),y=p.put({modelPath:r.modelPath,modelArtifactsInfo:d});y.onsuccess=function(){var b=(h=a.transaction(ef,"readwrite")).objectStore(ef).put({modelPath:r.modelPath,modelArtifacts:t,modelArtifactsInfo:d});b.onsuccess=function(){return i({modelArtifactsInfo:d})},b.onerror=function(x){var E=(p=m.objectStore(Gc)).delete(r.modelPath);E.onsuccess=function(){return a.close(),o(b.error)},E.onerror=function(T){return a.close(),o(b.error)}}},y.onerror=function(b){return a.close(),o(y.error)},m.oncomplete=function(){h==null?a.close():h.oncomplete=function(){return a.close()}}}},s.onerror=function(a){return o(s.error)}}))},n.URL_SCHEME="indexeddb://",n})(),VS=function(n){return Ye().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ed.URL_SCHEME)?(e=n.slice(Ed.URL_SCHEME.length),new Ed(e)):null;var e};pa.registerSaveRouter(VS),pa.registerLoadRouter(VS);var g9=(function(){function n(){this.indexedDB=QT()}return n.prototype.listModels=function(){return Nt(this,void 0,void 0,(function(){var e=this;return Rt(this,(function(t){return[2,new Promise((function(r,i){var o=e.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return gw(o)},o.onsuccess=function(){var s=o.result,a=s.transaction(Gc,"readonly"),u=a.objectStore(Gc).getAll();u.onsuccess=function(){for(var l={},h=0,d=u.result;h<d.length;h++){var m=d[h];l[m.modelPath]=m.modelArtifactsInfo}r(l)},u.onerror=function(l){return s.close(),i(u.error)},a.oncomplete=function(){return s.close()}},o.onerror=function(s){return i(o.error)}}))]}))}))},n.prototype.removeModel=function(e){return Nt(this,void 0,void 0,(function(){var t=this;return Rt(this,(function(r){var i;return e=(i=e).startsWith(Ed.URL_SCHEME)?i.slice(Ed.URL_SCHEME.length):i,[2,new Promise((function(o,s){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return gw(a)},a.onsuccess=function(){var u,l=a.result,h=l.transaction(Gc,"readwrite"),d=h.objectStore(Gc),m=d.get(e);m.onsuccess=function(){if(m.result==null)return l.close(),s(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var p=d.delete(e),y=function(){var b=(u=l.transaction(ef,"readwrite")).objectStore(ef).delete(e);b.onsuccess=function(){return o(m.result.modelArtifactsInfo)},b.onerror=function(x){return s(m.error)}};p.onsuccess=y,p.onerror=function(b){return y(),l.close(),s(m.error)}},m.onerror=function(p){return l.close(),s(m.error)},h.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},a.onerror=function(u){return s(a.error)}}))]}))}))},n})();if(Ye().getBool("IS_BROWSER"))try{Qc.registerManager(Ed.URL_SCHEME,new g9)}catch{}var Kl="/",od="tensorflowjs_models",JT="info",v9="model_topology",y9="weight_specs",w9="weight_data",b9="model_metadata";function ZT(n){return{info:[od,n,JT].join(Kl),topology:[od,n,v9].join(Kl),weightSpecs:[od,n,y9].join(Kl),weightData:[od,n,w9].join(Kl),modelMetadata:[od,n,b9].join(Kl)}}function x9(n){var e=n.split(Kl);if(e.length<3)throw new Error("Invalid key format: "+n);return e.slice(1,e.length-1).join(Kl)}var Sd=(function(){function n(e){if(!Ye().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=ZT(this.modelPath)}return n.prototype.save=function(e){return Nt(this,void 0,void 0,(function(){var t,r,i;return Rt(this,(function(o){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),i=Km(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,(function(s){if(mw)return Buffer.from(s).toString("base64");for(var a=new Uint8Array(s),u="",l=0,h=a.length;l<h;l++)u+=String.fromCharCode(a[l]);return btoa(u)})(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:i}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}return[2]}))}))},n.prototype.load=function(){return Nt(this,void 0,void 0,(function(){var e,t,r,i,o,s,a;return Rt(this,(function(u){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=i,(o=this.LS.getItem(this.keys.modelMetadata))!=null&&(s=JSON.parse(o),t.format=s.format,t.generatedBy=s.generatedBy,t.convertedBy=s.convertedBy,t.userDefinedMetadata=s.userDefinedMetadata),(a=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=(function(l){if(mw){var h=Buffer.from(l,"base64");return h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength)}for(var d=atob(l),m=new Uint8Array(d.length),p=0;p<d.length;++p)m.set([d.charCodeAt(p)],p);return m.buffer})(a),[2,t]}))}))},n.URL_SCHEME="localstorage://",n})(),jS=function(n){return Ye().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Sd.URL_SCHEME)?(e=n.slice(Sd.URL_SCHEME.length),new Sd(e)):null;var e};pa.registerSaveRouter(jS),pa.registerLoadRouter(jS);var _9=(function(){function n(){me(Ye().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),me(typeof window>"u"||window.localStorage!==void 0,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return n.prototype.listModels=function(){return Nt(this,void 0,void 0,(function(){var e,t,r,i,o,s;return Rt(this,(function(a){for(e={},t=od+Kl,r=Kl+JT,i=0;i<this.LS.length;++i)(o=this.LS.key(i)).startsWith(t)&&o.endsWith(r)&&(s=x9(o),e[s]=JSON.parse(this.LS.getItem(o)));return[2,e]}))}))},n.prototype.removeModel=function(e){return Nt(this,void 0,void 0,(function(){var t,r;return Rt(this,(function(i){var o;if(e=(o=e).startsWith(Sd.URL_SCHEME)?o.slice(Sd.URL_SCHEME.length):o,t=ZT(e),this.LS.getItem(t.info)==null)throw new Error("Cannot find model at path '"+e+"'");return r=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,r]}))}))},n})();if(Ye().getBool("IS_BROWSER"))try{Qc.registerManager(Sd.URL_SCHEME,new _9)}catch{}var E9="model",S9=".json",A9=".weights.bin";function US(n){return new Promise((function(e){return setTimeout(e)})).then(n)}var Yy=(function(){function n(e){if(!Ye().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(n.URL_SCHEME)&&(e=e.slice(n.URL_SCHEME.length)),e!=null&&e.length!==0||(e=E9),this.modelTopologyFileName=e+S9,this.weightDataFileName=e+A9}return n.prototype.save=function(e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a;return Rt(this,(function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:r},o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,s.href=o,[4,US((function(){return s.dispatchEvent(new MouseEvent("click"))}))];case 2:return u.sent(),e.weightData==null?[3,4]:((a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,a.href=t,[4,US((function(){return a.dispatchEvent(new MouseEvent("click"))}))]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Km(e)}]}}))}))},n.URL_SCHEME="downloads://",n})(),C9=(function(){function n(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return n.prototype.load=function(){return Nt(this,void 0,void 0,(function(){var e,t,r=this;return Rt(this,(function(i){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(o,s){var a=new FileReader;a.onload=function(u){var l=JSON.parse(u.target.result),h=l.modelTopology;if(h!=null){t.length===0&&o({modelTopology:h});var d=l.weightsManifest;if(d!=null){var m;try{m=r.checkManifestAndWeightFiles(d,t)}catch(x){return void s(x)}var p=[],y=[],b=[];d.forEach((function(x){x.paths.forEach((function(E){y.push(E),b.push(null)})),p.push.apply(p,x.weights)})),d.forEach((function(x){x.paths.forEach((function(E){var T=new FileReader;T.onload=function(P){var C=P.target.result,D=y.indexOf(E);b[D]=C,b.indexOf(null)===-1&&o({modelTopology:h,weightSpecs:p,weightData:mx(b),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},T.onerror=function(P){return s("Failed to weights data from file of path '"+E+"'.")},T.readAsArrayBuffer(m[E])}))}))}else s(new Error("weightManifest field is missing from file "+e.name))}else s(new Error("modelTopology field is missing from file "+e.name))},a.onerror=function(u){return s("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},a.readAsText(e)}))]}))}))},n.prototype.checkManifestAndWeightFiles=function(e,t){for(var r=[],i=t.map((function(u){return FS(u.name)})),o={},s=0,a=e;s<a.length;s++)a[s].paths.forEach((function(u){var l=FS(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),i.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");o[u]=t[i.indexOf(l)]}));if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+t.length+").");return o},n})();function zS(n,e,t,r){(function(o){me(o!=null&&Array.isArray(o)&&o.length>0,(function(){return"promises must be a none empty array"}))})(n),(function(o,s){me(o>=0&&o<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+o})),me(s>=0&&s<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s})),me(s>=o,(function(){return"startFraction must be no more than endFraction, but got startFraction "+o+" and endFraction "+s}))})(t=t??0,r=r??1);var i=0;return Promise.all(n.map((function(o){return o.then((function(s){var a=t+ ++i/n.length*(r-t);return e(a),s})),o})))}function ek(n,e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h;return Rt(this,(function(d){switch(d.label){case 0:return e==null&&(e={}),t=e.fetchFunc==null?Ye().platform.fetch:e.fetchFunc,r=n.map((function(m){return t(m,e.requestInit,{isBinary:!0})})),i=0,o=.5,e.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return s=d.sent(),[3,4];case 2:return[4,zS(r,e.onProgress,i,o)];case 3:s=d.sent(),d.label=4;case 4:return a=s.map((function(m){return m.arrayBuffer()})),u=.5,l=1,e.onProgress!=null?[3,6]:[4,Promise.all(a)];case 5:return h=d.sent(),[3,8];case 6:return[4,zS(a,e.onProgress,u,l)];case 7:h=d.sent(),d.label=8;case 8:return[2,h]}}))}))}function WS(n){var e=this;return function(t,r,i){return r===void 0&&(r=""),Nt(e,void 0,void 0,(function(){var o,s,a,u,l,h,d,m,p,y;return Rt(this,(function(b){switch(b.label){case 0:if(o=t.map((function(){return!1})),s={},a=i!=null?i.map((function(){return!1})):[],u=[],t.forEach((function(x,E){var T=0;x.weights.forEach((function(P){var C="quantization"in P?P.quantization.dtype:P.dtype,D=pw[C]*Mt(P.shape),z=function(){o[E]=!0,s[E]==null&&(s[E]=[]),s[E].push({manifestEntry:P,groupOffset:T,sizeBytes:D})};i!=null?i.forEach((function(L,I){L===P.name&&(z(),a[I]=!0)})):z(),u.push(P.name),T+=D}))})),!a.every((function(x){return x})))throw l=i.filter((function(x,E){return!a[E]})),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return h=o.reduce((function(x,E,T){return E&&x.push(T),x}),[]),d=[],h.forEach((function(x){t[x].paths.forEach((function(E){var T=r+(r.endsWith("/")?"":"/")+E;d.push(T)}))})),[4,n(d)];case 1:return m=b.sent(),p={},y=0,h.forEach((function(x){for(var E=t[x].paths.length,T=0,P=0;P<E;P++)T+=m[y+P].byteLength;for(var C=new ArrayBuffer(T),D=new Uint8Array(C),z=0,L=0;L<E;L++){var I=new Uint8Array(m[y+L]);D.set(I,z),z+=I.byteLength}s[x].forEach((function(A){var O=YT(C.slice(A.groupOffset,A.groupOffset+A.sizeBytes),[A.manifestEntry]);for(var k in O)p[k]=O[k]})),y+=E})),[2,p]}}))}))}}pa.registerSaveRouter((function(n){return Ye().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Yy.URL_SCHEME)?(function(e){return e===void 0&&(e="model"),new Yy(e)})(n.slice(Yy.URL_SCHEME.length)):null}));var tk=(function(){function n(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,t.fetchFunc!=null?(me(typeof t.fetchFunc=="function",(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=t.fetchFunc):this.fetch=Ye().platform.fetch,me(e!=null&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&me(e.length===2,(function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."})),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return n.prototype.save=function(e){return Nt(this,void 0,void 0,(function(){var t,r,i,o;return Rt(this,(function(s){switch(s.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:r},t.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((o=s.sent()).ok)return[2,{modelArtifactsInfo:Km(e),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}}))}))},n.prototype.load=function(){return Nt(this,void 0,void 0,(function(){var e,t,r,i,o,s,a,u,l,h,d,m;return Rt(this,(function(p){switch(p.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=p.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");p.label=2;case 2:return p.trys.push([2,4,,5]),[4,e.json()];case 3:return t=p.sent(),[3,5];case 4:throw p.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=t.modelTopology,o=t.weightsManifest,s=t.generatedBy,a=t.convertedBy,u=t.format,l=t.userDefinedMetadata,i==null&&o==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return o==null?[3,7]:[4,this.loadWeights(o)];case 6:m=p.sent(),h=m[0],d=m[1],p.label=7;case 7:return[2,{modelTopology:i,weightSpecs:h,weightData:d,userDefinedMetadata:l,generatedBy:s,convertedBy:a,format:u}]}}))}))},n.prototype.loadWeights=function(e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h,d,m;return Rt(this,(function(p){switch(p.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,r=(function(y){var b=y.lastIndexOf("/"),x=y.lastIndexOf("?"),E=y.substring(0,b),T=x>b?y.substring(x):"";return[E+"/",T]})(t),i=r[0],o=r[1],s=this.weightPathPrefix||i,a=[],u=0,l=e;u<l.length;u++)h=l[u],a.push.apply(a,h.weights);return d=[],e.forEach((function(y){y.paths.forEach((function(b){d.push(s+b+o)}))})),[4,ek(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return m=p.sent(),[2,[a,mx(m)]]}}))}))},n.URL_SCHEME_REGEX=/^https?:\/\//,n})();function vw(n){return n.match(tk.URL_SCHEME_REGEX)!=null}var qS=function(n,e){return typeof fetch>"u"?null:(Array.isArray(n)?n.every((function(t){return vw(t)})):vw(n))?yw(n,{onProgress:e}):null};function yw(n,e){return new tk(n,e)}pa.registerSaveRouter(qS),pa.registerLoadRouter(qS);var Qy=(function(){function n(e){this.modelArtifacts=e}return n.prototype.load=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(e){return[2,this.modelArtifacts]}))}))},n})(),I9=(function(){function n(e){this.saveHandler=e}return n.prototype.save=function(e){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){return[2,this.saveHandler(e)]}))}))},n})(),nk=Object.freeze({browserFiles:function(n){return new C9(n)},browserHTTPRequest:function(n,e){return yw(n,e)},concatenateArrayBuffers:mx,decodeWeights:YT,encodeWeights:function(n,e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a=this;return Rt(this,(function(u){switch(u.label){case 0:for(t=[],r=[],i=Array.isArray(n)?n.map((function(l){return l.name})):Object.keys(n),o=function(l){var h=i[l],d=Array.isArray(n)?n[l].tensor:n[h];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+h+"': "+d.dtype);var m={name:h,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var p=new Promise((function(y){return Nt(a,void 0,void 0,(function(){var b,x,E,T,P,C,D;return Rt(this,(function(z){switch(z.label){case 0:return[4,d.bytes()];case 1:for(b=z.sent(),x=b.reduce((function(L,I){return L+I.length}),0)+p0*b.length,E=new Uint8Array(x),T=0,P=0;P<b.length;P++)C=b[P],D=new Uint8Array(new Uint32Array([C.length]).buffer),E.set(D,T),T+=p0,E.set(C,T),T+=C.length;return y(E),[2]}}))}))}));r.push(p)}else r.push(d.data());e!=null&&(m.group=e),t.push(m)},s=0;s<i.length;++s)o(s);return[4,Promise.all(r)];case 1:return[2,{data:m9(u.sent()),specs:t}]}}))}))},fromMemory:function(n,e,t,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new Qy(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Qy({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Qy({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:r}))},getLoadHandlers:function(n,e){return pa.getLoadHandlers(n,e)},getModelArtifactsInfoForJSON:Km,getSaveHandlers:function(n){return pa.getSaveHandlers(n)},http:yw,isHTTPScheme:vw,loadWeights:function(n,e,t,r){return e===void 0&&(e=""),Nt(this,void 0,void 0,(function(){return Rt(this,(function(i){return[2,WS((function(o){return ek(o,{requestInit:r})}))(n,e,t)]}))}))},registerLoadRouter:function(n){return pa.registerLoadRouter(n)},registerSaveRouter:function(n){return pa.registerSaveRouter(n)},weightsLoaderFactory:WS,withSaveHandler:function(n){return new I9(n)},copyModel:function(n,e){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){return[2,BS(n,e,!1)]}))}))},listModels:function(){return Nt(this,void 0,void 0,(function(){var n,e,t,r,i,o,s;return Rt(this,(function(a){switch(a.label){case 0:n=Qc.getSchemes(),e={},t=0,r=n,a.label=1;case 1:return t<r.length?(i=r[t],[4,Qc.getManager(i).listModels()]):[3,4];case 2:for(s in o=a.sent())e[i+_d+s]=o[s];a.label=3;case 3:return t++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(n,e){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){return[2,BS(n,e,!0)]}))}))},removeModel:function(n){return Nt(this,void 0,void 0,(function(){var e;return Rt(this,(function(t){return e=Cv(n),[2,Qc.getManager(e.scheme).removeModel(e.path)]}))}))}}),Qf;xe({confusionMatrix_:function(n,e,t){var r=se(n,"labels","confusionMatrix"),i=se(e,"predictions","confusionMatrix");me(t==null||t>0&&Number.isInteger(t),(function(){return"If provided, numClasses must be a positive integer, but got "+t})),me(r.rank===1,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),me(i.rank===1,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),me(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),me(t>0&&Number.isInteger(t),(function(){return"numClasses is required to be a positive integer, but got "+t}));var o=lw(r.asType("int32"),t),s=lw(i.asType("int32"),t);return o.transpose().matMul(s).asType("int32")}});var T9=xe({fromPixels_:function(n,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var t=!1,r=!1,i=!1,o=!1,s=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)o=!0;else{if(n.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+n.constructor.name);s=!0}if(i&&i&&n.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(CI("FromPixels",Te.backendName)!=null)return Te.runKernel("FromPixels",{pixels:n},{numChannels:e});var a,u,l=i?[n.videoWidth,n.videoHeight]:[n.width,n.height],h=l[0],d=l[1];if(s?a=n.getContext("2d").getImageData(0,0,h,d).data:r||t?a=n.data:(o||i)&&(Qf==null&&(Qf=document.createElement("canvas").getContext("2d")),Qf.canvas.width=h,Qf.canvas.height=d,Qf.drawImage(n,0,0,h,d),a=Qf.getImageData(0,0,h,d).data),e===4)u=new Int32Array(a);else{var m=h*d;u=new Int32Array(m*e);for(var p=0;p<m;p++)for(var y=0;y<e;++y)u[p*e+y]=a[4*p+y]}return qb(u,[d,h,e],"int32")}}),gx=Object.freeze({toPixels:function(n,e){return Nt(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,C,D,z,L,I;return Rt(this,(function(A){switch(A.label){case 0:if(t=se(n,"img","toPixels"),n instanceof $r||(t=t.toInt()),t.rank!==2&&t.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+t.rank+".");if(r=t.shape.slice(0,2),i=r[0],o=r[1],(s=t.rank===2?1:t.shape[2])>4||s===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,t.data()];case 1:return a=A.sent(),u=t.min(),l=t.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(h=A.sent(),d=h[0],m=h[1],p=d[0],y=m[0],u.dispose(),l.dispose(),t.dtype==="float32"){if(p<0||y>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+p+" - "+y+"].")}else{if(t.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+t.dtype+". Please use float32 or int32 tensors.");if(p<0||y>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+p+" - "+y+"].")}for(b=t.dtype==="float32"?255:1,x=new Uint8ClampedArray(o*i*4),E=0;E<i*o;++E)T=void 0,P=void 0,C=void 0,D=void 0,s===1?(T=a[E]*b,P=a[E]*b,C=a[E]*b,D=255):s===3?(T=a[3*E]*b,P=a[3*E+1]*b,C=a[3*E+2]*b,D=255):s===4&&(T=a[4*E]*b,P=a[4*E+1]*b,C=a[4*E+2]*b,D=a[4*E+3]*b),x[(z=4*E)+0]=Math.round(T),x[z+1]=Math.round(P),x[z+2]=Math.round(C),x[z+3]=Math.round(D);return e!=null&&(e.width=o,e.height=i,L=e.getContext("2d"),I=new ImageData(x,o,i),L.putImageData(I,0,0)),t!==n&&t.dispose(),[2,x]}}))}))},fromPixels:T9}),k9=(function(){function n(){}return n.prototype.getClassName=function(){return this.constructor.className},n.fromConfig=function(e,t){return new e(t)},n})(),N9=(function(){function n(){this.classNameMap={}}return n.getMap=function(){return n.instance==null&&(n.instance=new n),n.instance},n.register=function(e){n.getMap().classNameMap[e.className]=[e,e.fromConfig]},n})();function xf(n){me(n.className!=null,(function(){return"Class being registered does not have the static className property defined."})),me(typeof n.className=="string",(function(){return"className is required to be a string, but got type "+typeof n.className})),me(n.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),N9.register(n)}var _f=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Su(e,n),e.prototype.minimize=function(t,r,i){r===void 0&&(r=!1);var o=this.computeGradients(t,i),s=o.value,a=o.grads;if(i!=null){var u=i.map((function(l){return{name:l.name,tensor:a[l.name]}}));this.applyGradients(u)}else this.applyGradients(a);return qs(a),r?s:(s.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,r){return j8(t,r)},e.prototype.dispose=function(){this.iterations_!=null&&qs(this.iterations_)},e.prototype.saveIterations=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:dt(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return Nt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){switch(i.label){case 0:return r=this,[4,t[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,t.slice(1)]}}))}))},e})(k9);Object.defineProperty(_f,Symbol.hasInstance,{value:function(n){return n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null}});var R9=(function(n){function e(t,r,i){i===void 0&&(i=null);var o=n.call(this)||this;return o.learningRate=t,o.rho=r,o.epsilon=i,o.accumulatedGrads=[],o.accumulatedUpdates=[],i==null&&(o.epsilon=Te.backend.epsilon()),o}return Su(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Te.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accum_grad",variable:_t((function(){return zn(s).variable(!1)}))}),r.accumulatedUpdates[o]==null&&(r.accumulatedUpdates[o]={originalName:i+"/accum_var",variable:_t((function(){return zn(s).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[i];if(a!=null){var u=r.accumulatedGrads[o].variable,l=r.accumulatedUpdates[o].variable;_t((function(){var h=u.mul(r.rho).add(a.square().mul(1-r.rho)),d=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(a),m=l.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(h),l.assign(m);var p=d.mul(-r.learningRate).add(s);s.assign(p)}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(qs(this.accumulatedGrads.map((function(t){return t.variable}))),qs(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){var t;return Rt(this,(function(r){switch(r.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map((function(i){return{name:i.originalName,tensor:i.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),r=t.length/2,this.accumulatedGrads=t.slice(0,r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(r,2*r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,r){return new t(r.learningRate,r.rho,r.epsilon)},e.className="Adadelta",e})(_f);xf(R9);var P9=(function(n){function e(t,r){r===void 0&&(r=.1);var i=n.call(this)||this;return i.learningRate=t,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return Su(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Te.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accumulator",variable:_t((function(){return cl(s.shape,r.initialAccumulatorValue).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[i];if(a!=null){var u=r.accumulatedGrads[o].variable;_t((function(){var l=u.add(a.square());u.assign(l);var h=a.div(l.add(Te.backend.epsilon()).sqrt()).mul(-r.learningRate).add(s);s.assign(h)}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&qs(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(r){return{name:r.originalName,tensor:r.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulatedGrads=t.map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,r){return new t(r.learningRate,r.initialAccumulatorValue)},e.className="Adagrad",e})(_f);xf(P9);var D9=(function(n){function e(t,r,i,o){o===void 0&&(o=null);var s=n.call(this)||this;return s.learningRate=t,s.beta1=r,s.beta2=i,s.epsilon=o,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],_t((function(){s.accBeta1=dt(r).variable(),s.accBeta2=dt(i).variable()})),o==null&&(s.epsilon=Te.backend.epsilon()),s}return Su(e,n),e.prototype.applyGradients=function(t){var r=this,i=Array.isArray(t)?t.map((function(o){return o.name})):Object.keys(t);_t((function(){var o=Ki(1,r.accBeta1),s=Ki(1,r.accBeta2);i.forEach((function(a,u){var l=Te.registeredVariables[a];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:a+"/m",variable:_t((function(){return zn(l).variable(!1)}))}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:a+"/v",variable:_t((function(){return zn(l).variable(!1)}))});var h=Array.isArray(t)?t[u].tensor:t[a];if(h!=null){var d=r.accumulatedFirstMoment[u].variable,m=r.accumulatedSecondMoment[u].variable,p=d.mul(r.beta1).add(h.mul(1-r.beta1)),y=m.mul(r.beta2).add(h.square().mul(1-r.beta2)),b=p.div(o),x=y.div(s);d.assign(p),m.assign(y);var E=b.div(x.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(E)}})),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&qs(this.accumulatedFirstMoment.map((function(t){return t.variable}))),this.accumulatedSecondMoment!=null&&qs(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){var t;return Rt(this,(function(r){switch(r.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map((function(i){return{name:i.originalName,tensor:i.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){var r,i=this;return Rt(this,(function(o){switch(o.label){case 0:return[4,this.extractIterations(t)];case 1:return t=o.sent(),_t((function(){i.accBeta1.assign(f0(i.beta1,i.iterations_+1)),i.accBeta2.assign(f0(i.beta2,i.iterations_+1))})),r=t.length/2,this.accumulatedFirstMoment=t.slice(0,r).map((function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(r,2*r).map((function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon)},e.className="Adam",e})(_f);xf(D9);var L9=(function(n){function e(t,r,i,o,s){o===void 0&&(o=null),s===void 0&&(s=0);var a=n.call(this)||this;return a.learningRate=t,a.beta1=r,a.beta2=i,a.epsilon=o,a.decay=s,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],_t((function(){a.iteration=dt(0).variable(),a.accBeta1=dt(r).variable()})),o==null&&(a.epsilon=Te.backend.epsilon()),a}return Su(e,n),e.prototype.applyGradients=function(t){var r=this,i=Array.isArray(t)?t.map((function(o){return o.name})):Object.keys(t);_t((function(){var o=Ki(1,r.accBeta1),s=gu(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach((function(a,u){var l=Te.registeredVariables[a];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:a+"/m",variable:zn(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:a+"/v",variable:zn(l).variable(!1)});var h=Array.isArray(t)?t[u].tensor:t[a];if(h!=null){var d=r.accumulatedFirstMoment[u].variable,m=r.accumulatedWeightedInfNorm[u].variable,p=d.mul(r.beta1).add(h.mul(1-r.beta1)),y=m.mul(r.beta2),b=h.abs(),x=y.maximum(b);d.assign(p),m.assign(x);var E=s.div(o).mul(p.div(x.add(r.epsilon))).add(l);l.assign(E)}})),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&qs(this.accumulatedFirstMoment.map((function(t){return t.variable}))),this.accumulatedWeightedInfNorm!=null&&qs(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},e.className="Adamax",e})(_f);xf(L9);var rk=(function(n){function e(t){var r=n.call(this)||this;return r.learningRate=t,r.setLearningRate(t),r}return Su(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Array.isArray(t)?t[o].tensor:t[i];if(s!=null){var a=Te.registeredVariables[i];_t((function(){var u=r.c.mul(s).add(a);a.assign(u)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=e8(dt(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:if((t=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,r){return new t(r.learningRate)},e.className="SGD",e})(_f);xf(rk);var M9=(function(n){function e(t,r,i){i===void 0&&(i=!1);var o=n.call(this,t)||this;return o.learningRate=t,o.momentum=r,o.useNesterov=i,o.accumulations=[],o.m=dt(o.momentum),o}return Su(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Te.registeredVariables[i];r.accumulations[o]==null&&(r.accumulations[o]={originalName:i+"/momentum",variable:_t((function(){return zn(s).variable(!1)}))});var a=r.accumulations[o].variable,u=Array.isArray(t)?t[o].tensor:t[i];u!=null&&_t((function(){var l,h=r.m.mul(a).add(u);l=r.useNesterov?r.c.mul(u.add(h.mul(r.m))).add(s):r.c.mul(h).add(s),a.assign(h),s.assign(l)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&qs(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(r){return{name:r.originalName,tensor:r.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){return Rt(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulations=t.map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,r){return new t(r.learningRate,r.momentum,r.useNesterov)},e.className="Momentum",e})(rk);xf(M9);var O9=(function(n){function e(t,r,i,o,s){r===void 0&&(r=.9),i===void 0&&(i=0),o===void 0&&(o=null),s===void 0&&(s=!1);var a=n.call(this)||this;if(a.learningRate=t,a.decay=r,a.momentum=i,a.epsilon=o,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=s,o==null&&(a.epsilon=Te.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return a}return Su(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map((function(i){return i.name})):Object.keys(t)).forEach((function(i,o){var s=Te.registeredVariables[i];r.accumulatedMeanSquares[o]==null&&(r.accumulatedMeanSquares[o]={originalName:i+"/rms",variable:_t((function(){return zn(s).variable(!1)}))}),r.accumulatedMoments[o]==null&&(r.accumulatedMoments[o]={originalName:i+"/momentum",variable:_t((function(){return zn(s).variable(!1)}))}),r.accumulatedMeanGrads[o]==null&&r.centered&&(r.accumulatedMeanGrads[o]={originalName:i+"/mg",variable:_t((function(){return zn(s).variable(!1)}))});var a=Array.isArray(t)?t[o].tensor:t[i];if(a!=null){var u=r.accumulatedMeanSquares[o].variable,l=r.accumulatedMoments[o].variable;_t((function(){var h=u.mul(r.decay).add(a.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[o].variable,m=d.mul(r.decay).add(a.mul(1-r.decay)),p=l.mul(r.momentum).add(a.mul(r.learningRate).div(h.sub(m.square().add(r.epsilon)).sqrt()));u.assign(h),d.assign(m),l.assign(p);var y=s.sub(p);s.assign(y)}else{var b=u.mul(r.decay).add(a.square().mul(1-r.decay));p=l.mul(r.momentum).add(a.mul(r.learningRate).div(b.add(r.epsilon).sqrt())),u.assign(b),l.assign(p),y=s.sub(p),s.assign(y)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&qs(this.accumulatedMeanSquares.map((function(t){return t.variable}))),this.accumulatedMeanGrads!=null&&this.centered&&qs(this.accumulatedMeanGrads.map((function(t){return t.variable}))),this.accumulatedMoments!=null&&qs(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Nt(this,void 0,void 0,(function(){var t;return Rt(this,(function(r){switch(r.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map((function(i){return{name:i.originalName,tensor:i.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Nt(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),r=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(r,2*r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*r,3*r).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,r){return new t(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},e.className="RMSProp",e})(_f);xf(O9);$r.prototype.squaredDifference=function(n){return yT(this,n)},We=u9;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ww=function(n,e){return ww=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},ww(n,e)};function vn(n,e){ww(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var rs=function(){return rs=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},rs.apply(this,arguments)};function jt(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(h){try{l(r.next(h))}catch(d){s(d)}}function u(h){try{l(r.throw(h))}catch(d){s(d)}}function l(h){h.done?o(h.value):i(h.value).then(a,u)}l((r=r.apply(n,[])).next())})}function Ut(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(h){return u([l,h])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){t.label=l[1];break}if(l[0]===6&&t.label<o[1]){t.label=o[1],o=l;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(l);break}o[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(h){l=[6,h],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function om(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var rf=(function(){function n(e,t){if(!of(e)||!of(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}return Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),n.prototype.reverse=function(){return new n(1/this.width,1/this.height)},n})();function J0(n,e){return n instanceof $r&&n.shape.length===e}function F9(n){return J0(n,2)}function Z0(n){return J0(n,3)}function Jc(n){return J0(n,4)}function B9(n){return n%1!==0}function HS(n){return n%2===0}function V9(n,e){e===void 0&&(e=2);var t=Math.pow(10,e);return Math.floor(n*t)/t}function GS(n){return n&&n.width&&n.height}function j9(n,e){var t=n.width,r=n.height,i=e/Math.max(r,t);return new rf(Math.round(t*i),Math.round(r*i))}function vx(n){return n.reduce(function(e,t){return e.add(t)},new er(0,0)).div(new er(n.length,n.length))}function Sm(n,e,t){return Array(n).fill(0).map(function(r,i){return e+i*t})}function of(n){return!!n&&n!==1/0&&n!==-1/0&&!isNaN(n)||n===0}function $S(n){return of(n)&&0<=n&&n<=1}var er=(function(){function n(e,t){this._x=e,this._y=t}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.add=function(e){return new n(this.x+e.x,this.y+e.y)},n.prototype.sub=function(e){return new n(this.x-e.x,this.y-e.y)},n.prototype.mul=function(e){return new n(this.x*e.x,this.y*e.y)},n.prototype.div=function(e){return new n(this.x/e.x,this.y/e.y)},n.prototype.abs=function(){return new n(Math.abs(this.x),Math.abs(this.y))},n.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.floor=function(){return new n(Math.floor(this.x),Math.floor(this.y))},n})(),lh=(function(){function n(e,t){t===void 0&&(t=!0);var r=e||{},i=[r.left,r.top,r.right,r.bottom].every(of),o=[r.x,r.y,r.width,r.height].every(of);if(!o&&!i)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var s=o?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],a=s[0],u=s[1],l=s[2],h=s[3];n.assertIsValidBox({x:a,y:u,width:l,height:h},"Box.constructor",t),this._x=a,this._y=u,this._width=l,this._height=h}return n.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(of)},n.assertIsValidBox=function(e,t,r){if(r===void 0&&(r=!1),!n.isRect(e))throw new Error(t+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(t+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topLeft",{get:function(){return new er(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topRight",{get:function(){return new er(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomLeft",{get:function(){return new er(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomRight",{get:function(){return new er(this.right,this.bottom)},enumerable:!0,configurable:!0}),n.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(s){return Math.round(s)}),t=e[0],r=e[1],i=e[2],o=e[3];return new n({x:t,y:r,width:i,height:o})},n.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(s){return Math.floor(s)}),t=e[0],r=e[1],i=e[2],o=e[3];return new n({x:t,y:r,width:i,height:o})},n.prototype.toSquare=function(){var e=this,t=e.x,r=e.y,i=e.width,o=e.height,s=Math.abs(i-o);return i<o&&(t-=s/2,i+=s),o<i&&(r-=s/2,o+=s),new n({x:t,y:r,width:i,height:o})},n.prototype.rescale=function(e){var t=GS(e)?e.width:e,r=GS(e)?e.height:e;return new n({x:this.x*t,y:this.y*r,width:this.width*t,height:this.height*r})},n.prototype.pad=function(e,t){var r=[this.x-e/2,this.y-t/2,this.width+e,this.height+t],i=r[0],o=r[1],s=r[2],a=r[3];return new n({x:i,y:o,width:s,height:a})},n.prototype.clipAtImageBorders=function(e,t){var r=this,i=r.x,o=r.y,s=r.right,a=r.bottom,u=Math.max(i,0),l=Math.max(o,0),h=s-u,d=a-l,m=Math.min(h,e-u),p=Math.min(d,t-l);return new n({x:u,y:l,width:m,height:p}).floor()},n.prototype.shift=function(e,t){var r=this,i=r.width,o=r.height,s=this.x+e,a=this.y+t;return new n({x:s,y:a,width:i,height:o})},n.prototype.padAtBorders=function(e,t){var r=this.width+1,i=this.height+1,o=1,s=1,a=r,u=i,l=this.left,h=this.top,d=this.right,m=this.bottom;return d>t&&(a=-d+t+r,d=t),m>e&&(u=-m+e+i,m=e),l<1&&(u=2-l,l=1),h<1&&(u=2-h,h=1),{dy:s,edy:u,dx:o,edx:a,y:h,ey:m,x:l,ex:d,w:r,h:i}},n.prototype.calibrate=function(e){return new n({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},n})(),e1=(function(n){vn(e,n);function e(t,r,i,o,s){return s===void 0&&(s=!1),n.call(this,{left:t,top:r,right:i,bottom:o},s)||this}return e})(lh),ik=(function(){function n(e,t,r,i,o){this._imageDims=new rf(o.width,o.height),this._score=e,this._classScore=t,this._className=r,this._box=new lh(i).rescale(this._imageDims)}return Object.defineProperty(n.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativeBox",{get:function(){return new lh(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),n.prototype.forSize=function(e,t){return new n(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:t})},n})(),Cu=(function(n){vn(e,n);function e(t,r,i){return n.call(this,t,t,"",r,i)||this}return e.prototype.forSize=function(t,r){var i=n.prototype.forSize.call(this,t,r),o=i.score,s=i.relativeBox,a=i.imageDims;return new e(o,s,a)},e})(ik);function U9(n,e,t){t===void 0&&(t=!0);var r=Math.max(0,Math.min(n.right,e.right)-Math.max(n.left,e.left)),i=Math.max(0,Math.min(n.bottom,e.bottom)-Math.max(n.top,e.top)),o=r*i;return t?o/(n.area+e.area-o):o/Math.min(n.area,e.area)}function z9(n){var e=n.map(function(a){return a.x}),t=n.map(function(a){return a.y}),r=e.reduce(function(a,u){return u<a?u:a},1/0),i=t.reduce(function(a,u){return u<a?u:a},1/0),o=e.reduce(function(a,u){return a<u?u:a},0),s=t.reduce(function(a,u){return a<u?u:a},0);return new e1(r,i,o,s)}function Am(n,e,t,r){r===void 0&&(r=!0);for(var i=e.map(function(a,u){return{score:a,boxIndex:u}}).sort(function(a,u){return a.score-u.score}).map(function(a){return a.boxIndex}),o=[],s=function(){var a=i.pop();o.push(a);for(var u=i,l=[],h=0;h<u.length;h++){var d=u[h],m=n[a],p=n[d];l.push(U9(m,p,r))}i=i.filter(function(y,b){return l[b]<=t})};i.length>0;)s();return o}function Xm(n,e){return _t(function(){var t=e[0],r=e[1],i=e[2],o=cl(om(n.shape.slice(0,3),[1]),t),s=cl(om(n.shape.slice(0,3),[1]),r),a=cl(om(n.shape.slice(0,3),[1]),i),u=qi([o,s,a],3);return Ki(n,u)})}function W9(n,e){return e===void 0&&(e=!1),_t(function(){var t=n.shape.slice(1),r=t[0],i=t[1];if(r===i)return n;var o=Math.abs(r-i),s=Math.round(o*(e?.5:1)),a=r>i?2:1,u=function(p){var y=n.shape.slice();return y[a]=p,cl(y,0)},l=u(s),h=o-l.shape[a],d=e&&h?u(h):null,m=[d,n,l].filter(function(p){return!!p}).map(function(p){return p.toFloat()});return qi(m,a)})}function Jy(n){return 1/(1+Math.exp(-n))}var yx=(function(n){vn(e,n);function e(t,r,i,o,s){return s===void 0&&(s=!1),n.call(this,{x:t,y:r,width:i,height:o},s)||this}return e})(lh),q9=.5,H9=.43,G9=.45,Cm=(function(){function n(e,t,r){r===void 0&&(r=new er(0,0));var i=t.width,o=t.height;this._imgDims=new rf(i,o),this._shift=r,this._positions=e.map(function(s){return s.mul(new er(i,o)).add(r)})}return Object.defineProperty(n.prototype,"shift",{get:function(){return new er(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(t){return t.sub(e._shift).div(new er(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),n.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},n.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new er(e,t))},n.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},n.prototype.align=function(e,t){if(t===void 0&&(t={}),e){var r=e instanceof Cu?e.box.floor():new lh(e);return this.shiftBy(r.x,r.y).align(null,t)}var i=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),o=i.useDlibAlignment,s=i.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(s)},n.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),t=e[0],r=e[1],i=e[2],o=function(d){return i.sub(d).magnitude()},s=(o(t)+o(r))/2,a=Math.floor(s/G9),u=vx(e),l=Math.floor(Math.max(0,u.x-q9*a)),h=Math.floor(Math.max(0,u.y-H9*a));return new yx(l,h,Math.min(a,this.imageWidth+l),Math.min(a,this.imageHeight+h))},n.prototype.alignMinBbox=function(e){var t=z9(this.positions);return t.pad(t.width*e,t.height*e)},n.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},n})(),$9=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],vx([t[3],t[4]])]},e})(Cm),K9=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(vx)},e})(Cm),KS=(function(){function n(e,t){this._label=e,this._distance=t}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),n.prototype.toString=function(e){return e===void 0&&(e=!0),""+this.label+(e?" ("+V9(this.distance)+")":"")},n})(),XS=(function(n){vn(e,n);function e(t,r){var i=n.call(this,t)||this;return i._label=r,i}return e.assertIsValidLabeledBox=function(t,r){if(lh.assertIsValidBox(t,r),!of(t.label))throw new Error(r+" - expected property label ("+t.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e})(lh),rv=(function(){function n(e,t){if(typeof e!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),n.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},n.fromJSON=function(e){var t=e.descriptors.map(function(r){return new Float32Array(r)});return new n(e.label,t)},n})();(function(n){vn(e,n);function e(t,r,i,o){var s=n.call(this,t,r)||this;return s._score=i,s._classScore=o,s}return e.assertIsValidPredictedBox=function(t,r){if(XS.assertIsValidLabeledBox(t,r),!$S(t.score)||!$S(t.classScore))throw new Error(r+" - expected properties score ("+t.score+") and ("+t.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),e})(XS);function ok(n){return n.detection instanceof Cu}function Im(n,e){var t={detection:e};return Object.assign({},n,t)}function sk(){var n=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},e=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:n,readFile:e}}function ak(n){var e="";if(!n)try{n=require("fs")}catch(r){e=r.toString()}var t=n?function(r){return new Promise(function(i,o){n.readFile(r,function(s,a){return s?o(s):i(a)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)};return{readFile:t}}function uk(){var n=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,t=function(){if(n)return new n;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},i=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},o=ak();return rs({Canvas:n||(function(){function s(){}return s})(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||(function(){function s(){}return s})(),Image:e||(function(){function s(){}return s})(),ImageData:global.ImageData||(function(){function s(){}return s})(),Video:global.HTMLVideoElement||(function(){function s(){}return s})(),createCanvasElement:t,createImageElement:r,fetch:i},o)}function lk(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function ck(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var zi;function X9(){if(!zi)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return zi}function bw(n){zi=n}function wx(){lk()&&bw(sk()),ck()&&bw(uk())}function Y9(n){if(zi||wx(),!zi)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=n.Canvas,t=e===void 0?zi.Canvas:e,r=n.Image,i=r===void 0?zi.Image:r;zi.Canvas=t,zi.Image=i,zi.createCanvasElement=n.createCanvasElement||(function(){return new t}),zi.createImageElement=n.createImageElement||(function(){return new i}),zi.ImageData=n.ImageData||zi.ImageData,zi.Video=n.Video||zi.Video,zi.fetch=n.fetch||zi.fetch,zi.readFile=n.readFile||zi.readFile}var Do={getEnv:X9,setEnv:bw,initialize:wx,createBrowserEnv:sk,createFileSystem:ak,createNodejsEnv:uk,monkeyPatch:Y9,isBrowser:lk,isNodejs:ck};wx();function hk(n){return!Do.isNodejs()&&typeof n=="string"?document.getElementById(n):n}function cf(n){var e=Do.getEnv(),t=e.Canvas,r=e.CanvasRenderingContext2D;if(n instanceof r)return n;var i=hk(n);if(!(i instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=i.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}var YS;(function(n){n.TOP_LEFT="TOP_LEFT",n.TOP_RIGHT="TOP_RIGHT",n.BOTTOM_LEFT="BOTTOM_LEFT",n.BOTTOM_RIGHT="BOTTOM_RIGHT"})(YS||(YS={}));function fk(n){var e=Do.getEnv(),t=e.Image,r=e.Video;return n instanceof t&&n.complete||n instanceof r&&n.readyState>=3}function Q9(n){return new Promise(function(e,t){if(n instanceof Do.getEnv().Canvas||fk(n))return e();function r(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",i),e(o))}function i(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",r),o.currentTarget.removeEventListener("error",i),t(o))}n.addEventListener("load",r),n.addEventListener("error",i)})}function J9(n){return new Promise(function(e,t){if(!(n instanceof Blob))return t("bufferToImage - expected buf to be of type: Blob");var r=new FileReader;r.onload=function(){if(typeof r.result!="string")return t("bufferToImage - expected reader.result to be a string, in onload");var i=Do.getEnv().createImageElement();i.onload=function(){return e(i)},i.onerror=t,i.src=r.result},r.onerror=t,r.readAsDataURL(n)})}function dk(n){var e=Do.getEnv(),t=e.Image,r=e.Video;return n instanceof t?new rf(n.naturalWidth,n.naturalHeight):n instanceof r?new rf(n.videoWidth,n.videoHeight):new rf(n.width,n.height)}function t1(n){var e=n.width,t=n.height,r=Do.getEnv().createCanvasElement,i=r();return i.width=e,i.height=t,i}function bx(n,e){var t=Do.getEnv().ImageData;if(!(n instanceof t)&&!fk(n))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=dk(n),i=r.width,o=r.height,s=t1({width:i,height:o});return n instanceof t?cf(s).putImageData(n,0,0):cf(s).drawImage(n,0,0,i,o),s}function Z9(n,e){return jt(this,void 0,void 0,function(){var t,r,i,o,s,a;return Ut(this,function(u){switch(u.label){case 0:return t=Do.getEnv().createCanvasElement(),r=n.shape.slice(Jc(n)?1:0),i=r[0],o=r[1],s=r[2],a=_t(function(){return n.as3D(i,o,s).toInt()}),[4,gx.toPixels(a,t)];case 1:return u.sent(),a.dispose(),[2,t]}})})}function QS(n){var e=Do.getEnv(),t=e.Image,r=e.Canvas,i=e.Video;return n instanceof t||n instanceof r||n instanceof i}function eU(n,e,t){t===void 0&&(t=!1);var r=Do.getEnv(),i=r.Image,o=r.Canvas;if(!(n instanceof i||n instanceof o))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var s=dk(n),a=e/Math.max(s.height,s.width),u=a*s.width,l=a*s.height,h=t1({width:e,height:e}),d=n instanceof o?n:bx(n),m=Math.abs(u-l)/2,p=t&&u<l?m:0,y=t&&l<u?m:0;return cf(h).drawImage(d,p,y,u,l),h}var m0=(function(){function n(e,t){var r=this;if(t===void 0&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach(function(i,o){if(Z0(i)){r._imageTensors[o]=i,r._inputDimensions[o]=i.shape;return}if(Jc(i)){var s=i.shape[0];if(s!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+s+" passed, but not supported in input array");r._imageTensors[o]=i,r._inputDimensions[o]=i.shape.slice(1);return}var a=i instanceof Do.getEnv().Canvas?i:bx(i);r._canvases[o]=a,r._inputDimensions[o]=[a.height,a.width,3]})}return Object.defineProperty(n.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Sm(this.batchSize,0,1).map(function(t,r){return e.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),n.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},n.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},n.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},n.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},n.prototype.getReshapedInputDimensions=function(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var t=this.getInputWidth(e),r=this.getInputHeight(e);return j9({width:t,height:r},this.inputSize)},n.prototype.toBatchTensor=function(e,t){var r=this;return t===void 0&&(t=!0),this._inputSize=e,_t(function(){var i=Sm(r.batchSize,0,1).map(function(s){var a=r.getInput(s);if(a instanceof $r){var u=Jc(a)?a:a.expandDims();return u=W9(u,t),(u.shape[1]!==e||u.shape[2]!==e)&&(u=cx.resizeBilinear(u,[e,e])),u.as3D(e,e,3)}if(a instanceof Do.getEnv().Canvas)return gx.fromPixels(eU(a,e,t));throw new Error("toBatchTensor - at batchIdx "+s+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+a)}),o=wa(i.map(function(s){return s.toFloat()})).as4D(r.batchSize,e,e,3);return o})},n})();function mo(n){return jt(this,void 0,void 0,function(){var e,t,r;return Ut(this,function(i){switch(i.label){case 0:if(n instanceof m0)return[2,n];if(e=Array.isArray(n)?n:[n],!e.length)throw new Error("toNetInput - empty array passed as input");return t=function(o){return Array.isArray(n)?" at input index "+o+":":""},r=e.map(hk),r.forEach(function(o,s){if(!QS(o)&&!Z0(o)&&!Jc(o))throw typeof e[s]=="string"?new Error("toNetInput -"+t(s)+" string passed, but could not resolve HTMLElement for element id "+e[s]):new Error("toNetInput -"+t(s)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Jc(o)){var a=o.shape[0];if(a!==1)throw new Error("toNetInput -"+t(s)+" tf.Tensor4D with batchSize "+a+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(o){return QS(o)&&Q9(o)}))];case 1:return i.sent(),[2,new m0(r,Array.isArray(n))]}})})}function xx(n,e){return jt(this,void 0,void 0,function(){var t,r,i,o,s,a,u;return Ut(this,function(l){switch(l.label){case 0:return t=Do.getEnv().Canvas,r=n,n instanceof t?[3,5]:[4,mo(n)];case 1:if(i=l.sent(),i.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return o=i.getInput(0),o instanceof t?(s=o,[3,4]):[3,2];case 2:return[4,Z9(o)];case 3:s=l.sent(),l.label=4;case 4:r=s,l.label=5;case 5:return a=cf(r),u=e.map(function(h){return h instanceof Cu?h.forSize(r.width,r.height).box.floor():h}).map(function(h){return h.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(h){var d=h.x,m=h.y,p=h.width,y=h.height,b=t1({width:p,height:y});return cf(b).putImageData(a.getImageData(d,m,p,y),0,0),b})]}})})}function _x(n,e){return jt(this,void 0,void 0,function(){return Ut(this,function(t){if(!Z0(n)&&!Jc(n))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Jc(n)&&n.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,_t(function(){var r=n.shape.slice(Jc(n)?1:0),i=r[0],o=r[1],s=r[2],a=e.map(function(l){return l instanceof Cu?l.forSize(o,i).box:l}).map(function(l){return l.clipAtImageBorders(o,i)}),u=a.map(function(l){var h=l.x,d=l.y,m=l.width,p=l.height;return VT(n.as3D(i,o,s),[d,h,0],[p,m,s])});return u})]})})}function tU(n,e){return jt(this,void 0,void 0,function(){var t,r;return Ut(this,function(i){switch(i.label){case 0:return t=Do.getEnv().fetch,[4,t(n,e)];case 1:if(r=i.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function nU(n){return jt(this,void 0,void 0,function(){return Ut(this,function(e){switch(e.label){case 0:return[4,tU(n)];case 1:return[2,e.sent().json()]}})})}function pk(n,e){var t=e+"-weights_manifest.json";if(!n)return{modelBaseUri:"",manifestUri:t};if(n==="/")return{modelBaseUri:"/",manifestUri:"/"+t};var r=n.startsWith("http://")?"http://":n.startsWith("https://")?"https://":"";n=n.replace(r,"");var i=n.split("/").filter(function(a){return a}),o=n.endsWith(".json")?i[i.length-1]:t,s=r+(n.endsWith(".json")?i.slice(0,i.length-1):i).join("/");return s=n.startsWith("/")?"/"+s:s,{modelBaseUri:s,manifestUri:s==="/"?"/"+o:s+"/"+o}}function rU(n,e){return jt(this,void 0,void 0,function(){var t,r,i,o;return Ut(this,function(s){switch(s.label){case 0:return t=pk(n,e),r=t.manifestUri,i=t.modelBaseUri,[4,nU(r)];case 1:return o=s.sent(),[2,nk.loadWeights(o,i)]}})})}var sc=(function(){function n(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(n.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),n.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e),r=t.obj,i=t.objProp;return r[i]},n.prototype.reassignParamFromPath=function(e,t){var r=this.traversePropertyPath(e),i=r.obj,o=r.objProp;i[o].dispose(),i[o]=t},n.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(t){var r=t.paramPath;return{path:r,tensor:e.getParamFromPath(r)}})},n.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof zd})},n.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof zd)})},n.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(t){var r=t.path,i=t.tensor;e.reassignParamFromPath(r,i.variable())})},n.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(t){var r=t.path,i=t.tensor,o=Po(i.dataSync());i.dispose(),e.reassignParamFromPath(r,o)})},n.prototype.dispose=function(e){e===void 0&&(e=!0),this.getParamList().forEach(function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()}),this._params=void 0},n.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var t=e.tensor;return Array.from(t.dataSync())}).reduce(function(e,t){return e.concat(t)}))},n.prototype.load=function(e){return jt(this,void 0,void 0,function(){return Ut(this,function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}})})},n.prototype.loadFromUri=function(e){return jt(this,void 0,void 0,function(){var t;return Ut(this,function(r){switch(r.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,rU(e,this.getDefaultModelName())];case 1:return t=r.sent(),this.loadFromWeightMap(t),[2]}})})},n.prototype.loadFromDisk=function(e){return jt(this,void 0,void 0,function(){var t,r,i,o,s,a,u,l,h,d;return Ut(this,function(m){switch(m.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return t=Do.getEnv().readFile,r=pk(e,this.getDefaultModelName()),i=r.manifestUri,o=r.modelBaseUri,s=function(p){return Promise.all(p.map(function(y){return t(y).then(function(b){return b.buffer})}))},a=nk.weightsLoaderFactory(s),h=(l=JSON).parse,[4,t(i)];case 1:return u=h.apply(l,[m.sent().toString()]),[4,a(u,o)];case 2:return d=m.sent(),this.loadFromWeightMap(d),[2]}})})},n.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),r=t.paramMappings,i=t.params;this._paramMappings=r,this._params=i},n.prototype.extractWeights=function(e){var t=this.extractParams(e),r=t.paramMappings,i=t.params;this._paramMappings=r,this._params=i},n.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce(function(o,s){if(!o.nextObj.hasOwnProperty(s))throw new Error("traversePropertyPath - object does not have property "+s+", for path "+e);return{obj:o.nextObj,objProp:s,nextObj:o.nextObj[s]}},{nextObj:this.params}),r=t.obj,i=t.objProp;if(!r||!i||!(r[i]instanceof $r))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:r,objProp:i}},n})();function ma(n,e,t){return _t(function(){var r=ox(n,e.depthwise_filter,e.pointwise_filter,t,"same");return r=Dn(r,e.bias),r})}function Zy(n,e,t){return t===void 0&&(t=!1),_t(function(){var r=Yr(t?Dn($a(n,e.conv0.filters,[2,2],"same"),e.conv0.bias):ma(n,e.conv0,[2,2])),i=ma(r,e.conv1,[1,1]),o=Yr(Dn(r,i)),s=ma(o,e.conv2,[1,1]);return Yr(Dn(r,Dn(i,s)))})}function iv(n,e,t,r){return t===void 0&&(t=!1),r===void 0&&(r=!0),_t(function(){var i=Yr(t?Dn($a(n,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):ma(n,e.conv0,r?[2,2]:[1,1])),o=ma(i,e.conv1,[1,1]),s=Yr(Dn(i,o)),a=ma(s,e.conv2,[1,1]),u=Yr(Dn(i,Dn(o,a))),l=ma(u,e.conv3,[1,1]);return Yr(Dn(i,Dn(o,Dn(a,l))))})}function bu(n,e,t,r){return t===void 0&&(t="same"),r===void 0&&(r=!1),_t(function(){var i=Dn($a(n,e.filters,[1,1],t),e.bias);return r?Yr(i):i})}function ac(n,e){Object.keys(n).forEach(function(t){e.some(function(r){return r.originalPath===t})||n[t].dispose()})}function n1(n,e){return function(t,r,i,o){var s=zs(n(t*r*i*i),[i,i,t,r]),a=Di(n(r));return e.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:s,bias:a}}}function Ex(n,e){return function(t,r,i){var o=Yc(n(t*r),[t,r]),s=Di(n(r));return e.push({paramPath:i+"/weights"},{paramPath:i+"/bias"}),{weights:o,bias:s}}}var mk=(function(){function n(e,t,r){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=r}return n})();function Sx(n,e){return function(t,r,i){var o=zs(n(9*t),[3,3,t,1]),s=zs(n(t*r),[1,1,t,r]),a=Di(n(r));return e.push({paramPath:i+"/depthwise_filter"},{paramPath:i+"/pointwise_filter"},{paramPath:i+"/bias"}),new mk(o,s,a)}}function Ax(n){return function(e){var t=n(e+"/depthwise_filter",4),r=n(e+"/pointwise_filter",4),i=n(e+"/bias",1);return new mk(t,r,i)}}function bh(n,e){return function(t,r,i){var o=n[t];if(!J0(o,r))throw new Error("expected weightMap["+t+"] to be a Tensor"+r+"D, instead have "+o);return e.push({originalPath:t,paramPath:i||t}),o}}function uc(n){var e=n;function t(i){var o=e.slice(0,i);return e=e.slice(i),o}function r(){return e}return{extractWeights:t,getRemainingWeights:r}}function gk(n,e){var t=n1(n,e),r=Sx(n,e);function i(s,a,u,l){l===void 0&&(l=!1);var h=l?t(s,a,3,u+"/conv0"):r(s,a,u+"/conv0"),d=r(a,a,u+"/conv1"),m=r(a,a,u+"/conv2");return{conv0:h,conv1:d,conv2:m}}function o(s,a,u,l){l===void 0&&(l=!1);var h=i(s,a,u,l),d=h.conv0,m=h.conv1,p=h.conv2,y=r(a,a,u+"/conv3");return{conv0:d,conv1:m,conv2:p,conv3:y}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:o}}function iU(n){var e=[],t=uc(n),r=t.extractWeights,i=t.getRemainingWeights,o=gk(r,e).extractDenseBlock4Params,s=o(3,32,"dense0",!0),a=o(32,64,"dense1"),u=o(64,128,"dense2"),l=o(128,256,"dense3");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{dense0:s,dense1:a,dense2:u,dense3:l}}}function vk(n){return function(e){var t=n(e+"/filters",4),r=n(e+"/bias",1);return{filters:t,bias:r}}}function yk(n,e){var t=bh(n,e),r=vk(t),i=Ax(t);function o(a,u){u===void 0&&(u=!1);var l=u?r(a+"/conv0"):i(a+"/conv0"),h=i(a+"/conv1"),d=i(a+"/conv2");return{conv0:l,conv1:h,conv2:d}}function s(a,u){u===void 0&&(u=!1);var l=u?r(a+"/conv0"):i(a+"/conv0"),h=i(a+"/conv1"),d=i(a+"/conv2"),m=i(a+"/conv3");return{conv0:l,conv1:h,conv2:d,conv3:m}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:s}}function oU(n){var e=[],t=yk(n,e).extractDenseBlock4Params,r={dense0:t("dense0",!0),dense1:t("dense1"),dense2:t("dense2"),dense3:t("dense3")};return ac(n,e),{params:r,paramMappings:e}}var wk=(function(n){vn(e,n);function e(){return n.call(this,"FaceFeatureExtractor")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return _t(function(){var i=t.toBatchTensor(112,!0),o=[122.782,117.001,104.298],s=Xm(i,o).div(dt(255)),a=iv(s,r.dense0,!0);return a=iv(a,r.dense1),a=iv(a,r.dense2),a=iv(a,r.dense3),a=$m(a,[7,7],[2,2],"valid"),a})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(t){return oU(t)},e.prototype.extractParams=function(t){return iU(t)},e})(sc);function il(n,e){return _t(function(){return Dn(X0(n,e.weights),e.bias)})}function sU(n,e,t){var r=[],i=uc(n),o=i.extractWeights,s=i.getRemainingWeights,a=Ex(o,r),u=a(e,t,"fc");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:r,params:{fc:u}}}function aU(n){var e=[],t=bh(n,e);function r(o){var s=t(o+"/weights",2),a=t(o+"/bias",1);return{weights:s,bias:a}}var i={fc:r("fc")};return ac(n,e),{params:i,paramMappings:e}}function bk(n){var e={},t={};return Object.keys(n).forEach(function(r){var i=r.startsWith("fc")?t:e;i[r]=n[r]}),{featureExtractorMap:e,classifierMap:t}}var xk=(function(n){vn(e,n);function e(t,r){var i=n.call(this,t)||this;return i._faceFeatureExtractor=r,i}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var r=this,i=this.params;if(!i)throw new Error(this._name+" - load model before inference");return _t(function(){var o=t instanceof m0?r.faceFeatureExtractor.forwardInput(t):t;return il(o.as2D(o.shape[0],-1),i.fc)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.faceFeatureExtractor.dispose(t),n.prototype.dispose.call(this,t)},e.prototype.loadClassifierParams=function(t){var r=this.extractClassifierParams(t),i=r.params,o=r.paramMappings;this._params=i,this._paramMappings=o},e.prototype.extractClassifierParams=function(t){return sU(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(t){var r=bk(t),i=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),aU(o)},e.prototype.extractParams=function(t){var r=this.getClassifierChannelsIn(),i=this.getClassifierChannelsOut(),o=i*r+i,s=t.slice(0,t.length-o),a=t.slice(t.length-o);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(a)},e})(sc),JS=["neutral","happy","sad","angry","fearful","disgusted","surprised"],uU=(function(){function n(e){var t=this;if(e.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);JS.forEach(function(r,i){t[r]=e[i]})}return n.prototype.asSortedArray=function(){var e=this;return JS.map(function(t){return{expression:t,probability:e[t]}}).sort(function(t,r){return r.probability-t.probability})},n})(),lU=(function(n){vn(e,n);function e(t){return t===void 0&&(t=new wk),n.call(this,"FaceExpressionNet",t)||this}return e.prototype.forwardInput=function(t){var r=this;return _t(function(){return ic(r.runNet(t))})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.predictExpressions=function(t){return jt(this,void 0,void 0,function(){var r,i,o,s,a=this;return Ut(this,function(u){switch(u.label){case 0:return[4,mo(t)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return i=u.sent(),[4,Promise.all(Hi(i).map(function(l){return jt(a,void 0,void 0,function(){var h;return Ut(this,function(d){switch(d.label){case 0:return[4,l.data()];case 1:return h=d.sent(),l.dispose(),[2,h]}})})}))];case 3:return o=u.sent(),i.dispose(),s=o.map(function(l){return new uU(l)}),[2,r.isBatchInput?s:s[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e})(xk);function _k(n,e){var t={expressions:e};return Object.assign({},n,t)}function Ek(n){return ok(n)&&n.landmarks instanceof Cm&&n.unshiftedLandmarks instanceof Cm&&n.alignedRect instanceof Cu}function r1(n,e){var t=n.detection.box,r=e.shiftBy(t.x,t.y),i=r.align(),o=n.detection.imageDims,s=new Cu(n.detection.score,i.rescale(o.reverse()),o),a={landmarks:r,unshiftedLandmarks:e,alignedRect:s};return Object.assign({},n,a)}function cU(n,e){var t=n1(n,e),r=Sx(n,e);function i(s,a,u){var l=r(s,a,u+"/separable_conv0"),h=r(a,a,u+"/separable_conv1"),d=t(s,a,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:h,expansion_conv:d}}function o(s,a){var u=r(s,s,a+"/separable_conv0"),l=r(s,s,a+"/separable_conv1"),h=r(s,s,a+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:h}}return{extractConvParams:t,extractSeparableConvParams:r,extractReductionBlockParams:i,extractMainBlockParams:o}}function hU(n,e){var t=[],r=uc(n),i=r.extractWeights,o=r.getRemainingWeights,s=cU(i,t),a=s.extractConvParams,u=s.extractSeparableConvParams,l=s.extractReductionBlockParams,h=s.extractMainBlockParams,d=a(3,32,3,"entry_flow/conv_in"),m=l(32,64,"entry_flow/reduction_block_0"),p=l(64,128,"entry_flow/reduction_block_1"),y={conv_in:d,reduction_block_0:m,reduction_block_1:p},b={};Sm(e,0,1).forEach(function(P){b["main_block_"+P]=h(128,"middle_flow/main_block_"+P)});var x=l(128,256,"exit_flow/reduction_block"),E=u(256,512,"exit_flow/separable_conv"),T={reduction_block:x,separable_conv:E};if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{entry_flow:y,middle_flow:b,exit_flow:T}}}function fU(n,e){var t=bh(n,e),r=vk(t),i=Ax(t);function o(a){var u=i(a+"/separable_conv0"),l=i(a+"/separable_conv1"),h=r(a+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:h}}function s(a){var u=i(a+"/separable_conv0"),l=i(a+"/separable_conv1"),h=i(a+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:h}}return{extractConvParams:r,extractSeparableConvParams:i,extractReductionBlockParams:o,extractMainBlockParams:s}}function dU(n,e){var t=[],r=fU(n,t),i=r.extractConvParams,o=r.extractSeparableConvParams,s=r.extractReductionBlockParams,a=r.extractMainBlockParams,u=i("entry_flow/conv_in"),l=s("entry_flow/reduction_block_0"),h=s("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:l,reduction_block_1:h},m={};Sm(e,0,1).forEach(function(x){m["main_block_"+x]=a("middle_flow/main_block_"+x)});var p=s("exit_flow/reduction_block"),y=o("exit_flow/separable_conv"),b={reduction_block:p,separable_conv:y};return ac(n,t),{params:{entry_flow:d,middle_flow:m,exit_flow:b},paramMappings:t}}function Sk(n,e,t){return Dn($a(n,e.filters,t,"same"),e.bias)}function e2(n,e,t){t===void 0&&(t=!0);var r=t?Yr(n):n;return r=ma(r,e.separable_conv0,[1,1]),r=ma(Yr(r),e.separable_conv1,[1,1]),r=co(r,[3,3],[2,2],"same"),r=Dn(r,Sk(n,e.expansion_conv,[2,2])),r}function pU(n,e){var t=ma(Yr(n),e.separable_conv0,[1,1]);return t=ma(Yr(t),e.separable_conv1,[1,1]),t=ma(Yr(t),e.separable_conv2,[1,1]),t=Dn(t,n),t}var mU=(function(n){vn(e,n);function e(t){var r=n.call(this,"TinyXception")||this;return r._numMainBlocks=t,r}return e.prototype.forwardInput=function(t){var r=this,i=this.params;if(!i)throw new Error("TinyXception - load model before inference");return _t(function(){var o=t.toBatchTensor(112,!0),s=[122.782,117.001,104.298],a=Xm(o,s).div(dt(256)),u=Yr(Sk(a,i.entry_flow.conv_in,[2,2]));return u=e2(u,i.entry_flow.reduction_block_0,!1),u=e2(u,i.entry_flow.reduction_block_1),Sm(r._numMainBlocks,0,1).forEach(function(l){u=pU(u,i.middle_flow["main_block_"+l])}),u=e2(u,i.exit_flow.reduction_block),u=Yr(ma(u,i.exit_flow.separable_conv,[1,1])),u})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(t){return dU(t,this._numMainBlocks)},e.prototype.extractParams=function(t){return hU(t,this._numMainBlocks)},e})(sc);function gU(n){var e=[],t=uc(n),r=t.extractWeights,i=t.getRemainingWeights,o=Ex(r,e),s=o(512,1,"fc/age"),a=o(512,2,"fc/gender");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{fc:{age:s,gender:a}}}}function vU(n){var e=[],t=bh(n,e);function r(o){var s=t(o+"/weights",2),a=t(o+"/bias",1);return{weights:s,bias:a}}var i={fc:{age:r("fc/age"),gender:r("fc/gender")}};return ac(n,e),{params:i,paramMappings:e}}var g0;(function(n){n.FEMALE="female",n.MALE="male"})(g0||(g0={}));var yU=(function(n){vn(e,n);function e(t){t===void 0&&(t=new mU(2));var r=n.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=t,r}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var r=this,i=this.params;if(!i)throw new Error(this._name+" - load model before inference");return _t(function(){var o=t instanceof m0?r.faceFeatureExtractor.forwardInput(t):t,s=$m(o,[7,7],[2,2],"valid").as2D(o.shape[0],-1),a=il(s,i.fc.age).as1D(),u=il(s,i.fc.gender);return{age:a,gender:u}})},e.prototype.forwardInput=function(t){var r=this;return _t(function(){var i=r.runNet(t),o=i.age,s=i.gender;return{age:o,gender:ic(s)}})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.predictAgeAndGender=function(t){return jt(this,void 0,void 0,function(){var r,i,o,s,a,u,l=this;return Ut(this,function(h){switch(h.label){case 0:return[4,mo(t)];case 1:return r=h.sent(),[4,this.forwardInput(r)];case 2:return i=h.sent(),o=Hi(i.age),s=Hi(i.gender),a=o.map(function(d,m){return{ageTensor:d,genderTensor:s[m]}}),[4,Promise.all(a.map(function(d){var m=d.ageTensor,p=d.genderTensor;return jt(l,void 0,void 0,function(){var y,b,x,E,T;return Ut(this,function(P){switch(P.label){case 0:return[4,m.data()];case 1:return y=P.sent()[0],[4,p.data()];case 2:return b=P.sent()[0],x=b>.5,E=x?g0.MALE:g0.FEMALE,T=x?b:1-b,m.dispose(),p.dispose(),[2,{age:y,gender:E,genderProbability:T}]}})})}))];case 3:return u=h.sent(),i.age.dispose(),i.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.faceFeatureExtractor.dispose(t),n.prototype.dispose.call(this,t)},e.prototype.loadClassifierParams=function(t){var r=this.extractClassifierParams(t),i=r.params,o=r.paramMappings;this._params=i,this._paramMappings=o},e.prototype.extractClassifierParams=function(t){return gU(t)},e.prototype.extractParamsFromWeigthMap=function(t){var r=bk(t),i=r.featureExtractorMap,o=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),vU(o)},e.prototype.extractParams=function(t){var r=1539,i=t.slice(0,t.length-r),o=t.slice(t.length-r);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(o)},e})(sc),Ak=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.postProcess=function(t,r,i){var o=i.map(function(a){var u=a.width,l=a.height,h=r/Math.max(l,u);return{width:u*h,height:l*h}}),s=o.length;return _t(function(){var a=function(m,p){return wa([cl([68],m),cl([68],p)],1).as2D(1,136).as1D()},u=function(m,p){var y=o[m],b=y.width,x=y.height;return p(b,x)?Math.abs(b-x)/2:0},l=function(m){return u(m,function(p,y){return p<y})},h=function(m){return u(m,function(p,y){return y<p})},d=t.mul(cl([s,136],r)).sub(wa(Array.from(Array(s),function(m,p){return a(l(p),h(p))}))).div(wa(Array.from(Array(s),function(m,p){return a(o[p].width,o[p].height)})));return d})},e.prototype.forwardInput=function(t){var r=this;return _t(function(){var i=r.runNet(t);return r.postProcess(i,t.inputSize,t.inputDimensions.map(function(o){var s=o[0],a=o[1];return{height:s,width:a}}))})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.detectLandmarks=function(t){return jt(this,void 0,void 0,function(){var r,i,o,s=this;return Ut(this,function(a){switch(a.label){case 0:return[4,mo(t)];case 1:return r=a.sent(),i=_t(function(){return Hi(s.forwardInput(r))}),[4,Promise.all(i.map(function(u,l){return jt(s,void 0,void 0,function(){var h,d,m,p,y;return Ut(this,function(b){switch(b.label){case 0:return m=(d=Array).from,[4,u.data()];case 1:return h=m.apply(d,[b.sent()]),p=h.filter(function(x,E){return HS(E)}),y=h.filter(function(x,E){return!HS(E)}),[2,new K9(Array(68).fill(0).map(function(x,E){return new er(p[E],y[E])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return o=a.sent(),i.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e})(xk),Ck=(function(n){vn(e,n);function e(t){return t===void 0&&(t=new wk),n.call(this,"FaceLandmark68Net",t)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e})(Ak);function wU(n){var e=[],t=yk(n,e).extractDenseBlock3Params,r={dense0:t("dense0",!0),dense1:t("dense1"),dense2:t("dense2")};return ac(n,e),{params:r,paramMappings:e}}function bU(n){var e=[],t=uc(n),r=t.extractWeights,i=t.getRemainingWeights,o=gk(r,e).extractDenseBlock3Params,s=o(3,32,"dense0",!0),a=o(32,64,"dense1"),u=o(64,128,"dense2");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{dense0:s,dense1:a,dense2:u}}}var xU=(function(n){vn(e,n);function e(){return n.call(this,"TinyFaceFeatureExtractor")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return _t(function(){var i=t.toBatchTensor(112,!0),o=[122.782,117.001,104.298],s=Xm(i,o).div(dt(255)),a=Zy(s,r.dense0,!0);return a=Zy(a,r.dense1),a=Zy(a,r.dense2),a=$m(a,[14,14],[2,2],"valid"),a})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(t){return wU(t)},e.prototype.extractParams=function(t){return bU(t)},e})(sc),_U=(function(n){vn(e,n);function e(t){return t===void 0&&(t=new xU),n.call(this,"FaceLandmark68TinyNet",t)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e})(Ak);(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(Ck);function EU(n,e){return Dn(us(n,e.weights),e.biases)}function Cx(n,e,t,r,i){i===void 0&&(i="same");var o=e.conv,s=o.filters,a=o.bias,u=$a(n,s,t,i);return u=Dn(u,a),u=EU(u,e.scale),r?Yr(u):u}function SU(n,e){return Cx(n,e,[1,1],!0)}function Ik(n,e){return Cx(n,e,[1,1],!1)}function Tk(n,e){return Cx(n,e,[2,2],!0,"valid")}function AU(n,e){function t(a,u,l){var h=n(a),d=h.length/(u*l*l);if(B9(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+h.length+", numFilters: "+u+", filterSize: "+l);return _t(function(){return uh(zs(h,[u,d,l,l]),[2,3,1,0])})}function r(a,u,l,h){var d=t(a,u,l),m=Di(n(u));return e.push({paramPath:h+"/filters"},{paramPath:h+"/bias"}),{filters:d,bias:m}}function i(a,u){var l=Di(n(a)),h=Di(n(a));return e.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:h}}function o(a,u,l,h){var d=r(a,u,l,h+"/conv"),m=i(u,h+"/scale");return{conv:d,scale:m}}function s(a,u,l,h,d){d===void 0&&(d=!1);var m=o((d?.5:1)*a,u,l,h+"/conv1"),p=o(a,u,l,h+"/conv2");return{conv1:m,conv2:p}}return{extractConvLayerParams:o,extractResidualLayerParams:s}}function CU(n){var e=uc(n),t=e.extractWeights,r=e.getRemainingWeights,i=[],o=AU(t,i),s=o.extractConvLayerParams,a=o.extractResidualLayerParams,u=s(4704,32,7,"conv32_down"),l=a(9216,32,3,"conv32_1"),h=a(9216,32,3,"conv32_2"),d=a(9216,32,3,"conv32_3"),m=a(36864,64,3,"conv64_down",!0),p=a(36864,64,3,"conv64_1"),y=a(36864,64,3,"conv64_2"),b=a(36864,64,3,"conv64_3"),x=a(147456,128,3,"conv128_down",!0),E=a(147456,128,3,"conv128_1"),T=a(147456,128,3,"conv128_2"),P=a(589824,256,3,"conv256_down",!0),C=a(589824,256,3,"conv256_1"),D=a(589824,256,3,"conv256_2"),z=a(589824,256,3,"conv256_down_out"),L=_t(function(){return uh(Yc(t(256*128),[128,256]),[1,0])});if(i.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var I={conv32_down:u,conv32_1:l,conv32_2:h,conv32_3:d,conv64_down:m,conv64_1:p,conv64_2:y,conv64_3:b,conv128_down:x,conv128_1:E,conv128_2:T,conv256_down:P,conv256_1:C,conv256_2:D,conv256_down_out:z,fc:L};return{params:I,paramMappings:i}}function IU(n,e){var t=bh(n,e);function r(s){var a=t(s+"/scale/weights",1),u=t(s+"/scale/biases",1);return{weights:a,biases:u}}function i(s){var a=t(s+"/conv/filters",4),u=t(s+"/conv/bias",1),l=r(s);return{conv:{filters:a,bias:u},scale:l}}function o(s){return{conv1:i(s+"/conv1"),conv2:i(s+"/conv2")}}return{extractConvLayerParams:i,extractResidualLayerParams:o}}function TU(n){var e=[],t=IU(n,e),r=t.extractConvLayerParams,i=t.extractResidualLayerParams,o=r("conv32_down"),s=i("conv32_1"),a=i("conv32_2"),u=i("conv32_3"),l=i("conv64_down"),h=i("conv64_1"),d=i("conv64_2"),m=i("conv64_3"),p=i("conv128_down"),y=i("conv128_1"),b=i("conv128_2"),x=i("conv256_down"),E=i("conv256_1"),T=i("conv256_2"),P=i("conv256_down_out"),C=n.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!F9(C))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+C);var D={conv32_down:o,conv32_1:s,conv32_2:a,conv32_3:u,conv64_down:l,conv64_1:h,conv64_2:d,conv64_3:m,conv128_down:p,conv128_1:y,conv128_2:b,conv256_down:x,conv256_1:E,conv256_2:T,conv256_down_out:P,fc:C};return ac(n,e),{params:D,paramMappings:e}}function Ku(n,e){var t=SU(n,e.conv1);return t=Ik(t,e.conv2),t=Dn(t,n),t=Yr(t),t}function ov(n,e){var t=Tk(n,e.conv1);t=Ik(t,e.conv2);var r=$m(n,2,2,"valid"),i=Tr(r.shape),o=r.shape[3]!==t.shape[3],s=r.shape[1]!==t.shape[1]||r.shape[2]!==t.shape[2];if(s){var a=om(t.shape);a[1]=1;var u=Tr(a);t=qi([t,u],1);var l=om(t.shape);l[2]=1;var h=Tr(l);t=qi([t,h],2)}return r=o?qi([r,i],3):r,t=Dn(r,t),t=Yr(t),t}var kU=(function(n){vn(e,n);function e(){return n.call(this,"FaceRecognitionNet")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return _t(function(){var i=t.toBatchTensor(150,!0).toFloat(),o=[122.782,117.001,104.298],s=Xm(i,o).div(dt(256)),a=Tk(s,r.conv32_down);a=co(a,3,2,"valid"),a=Ku(a,r.conv32_1),a=Ku(a,r.conv32_2),a=Ku(a,r.conv32_3),a=ov(a,r.conv64_down),a=Ku(a,r.conv64_1),a=Ku(a,r.conv64_2),a=Ku(a,r.conv64_3),a=ov(a,r.conv128_down),a=Ku(a,r.conv128_1),a=Ku(a,r.conv128_2),a=ov(a,r.conv256_down),a=Ku(a,r.conv256_1),a=Ku(a,r.conv256_2),a=ov(a,r.conv256_down_out);var u=a.mean([1,2]),l=X0(u,r.fc);return l})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.computeFaceDescriptor=function(t){return jt(this,void 0,void 0,function(){var r,i,o,s=this;return Ut(this,function(a){switch(a.label){case 0:return[4,mo(t)];case 1:return r=a.sent(),i=_t(function(){return Hi(s.forwardInput(r))}),[4,Promise.all(i.map(function(u){return u.data()}))];case 2:return o=a.sent(),i.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?o:o[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(t){return TU(t)},e.prototype.extractParams=function(t){return CU(t)},e})(sc);function kk(n,e){var t={descriptor:e};return Object.assign({},n,t)}function Nk(n,e){var t={age:e};return Object.assign({},n,t)}function Rk(n,e,t){var r={gender:e,genderProbability:t};return Object.assign({},n,r)}var Pk=(function(){function n(e){var t=e===void 0?{}:e,r=t.minFaceSize,i=t.scaleFactor,o=t.maxNumScales,s=t.scoreThresholds,a=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=i||.709,this._maxNumScales=o||10,this._scoreThresholds=s||[.6,.7,.7],this._scaleSteps=a,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(n.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),n})();function NU(n,e){function t(u,l){var h=zs(n(9*u),[3,3,u,1]),d=Di(n(u)),m=Di(n(u)),p=Di(n(u)),y=Di(n(u));return e.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:h,batch_norm_scale:d,batch_norm_offset:m,batch_norm_mean:p,batch_norm_variance:y}}function r(u,l,h,d,m){var p=zs(n(u*l*h*h),[h,h,u,l]),y=Di(n(l));return e.push({paramPath:d+"/filters"},{paramPath:d+"/"+(m?"batch_norm_offset":"bias")}),{filters:p,bias:y}}function i(u,l,h,d){var m=r(u,l,h,d,!0),p=m.filters,y=m.bias;return{filters:p,batch_norm_offset:y}}function o(u,l,h){var d=t(u,h+"/depthwise_conv"),m=i(u,l,1,h+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:m}}function s(){var u=i(3,32,3,"mobilenetv1/conv_0"),l=o(32,64,"mobilenetv1/conv_1"),h=o(64,128,"mobilenetv1/conv_2"),d=o(128,128,"mobilenetv1/conv_3"),m=o(128,256,"mobilenetv1/conv_4"),p=o(256,256,"mobilenetv1/conv_5"),y=o(256,512,"mobilenetv1/conv_6"),b=o(512,512,"mobilenetv1/conv_7"),x=o(512,512,"mobilenetv1/conv_8"),E=o(512,512,"mobilenetv1/conv_9"),T=o(512,512,"mobilenetv1/conv_10"),P=o(512,512,"mobilenetv1/conv_11"),C=o(512,1024,"mobilenetv1/conv_12"),D=o(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:h,conv_3:d,conv_4:m,conv_5:p,conv_6:y,conv_7:b,conv_8:x,conv_9:E,conv_10:T,conv_11:P,conv_12:C,conv_13:D}}function a(){var u=i(1024,256,1,"prediction_layer/conv_0"),l=i(256,512,3,"prediction_layer/conv_1"),h=i(512,128,1,"prediction_layer/conv_2"),d=i(128,256,3,"prediction_layer/conv_3"),m=i(256,128,1,"prediction_layer/conv_4"),p=i(128,256,3,"prediction_layer/conv_5"),y=i(256,64,1,"prediction_layer/conv_6"),b=i(64,128,3,"prediction_layer/conv_7"),x=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),E=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),T=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),P=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),C=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),D=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),z=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),L=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),I=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),A=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),O=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),k=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),M={box_encoding_predictor:x,class_predictor:E},j={box_encoding_predictor:T,class_predictor:P},X={box_encoding_predictor:C,class_predictor:D},ue={box_encoding_predictor:z,class_predictor:L},ge={box_encoding_predictor:I,class_predictor:A},ce={box_encoding_predictor:O,class_predictor:k};return{conv_0:u,conv_1:l,conv_2:h,conv_3:d,conv_4:m,conv_5:p,conv_6:y,conv_7:b,box_predictor_0:M,box_predictor_1:j,box_predictor_2:X,box_predictor_3:ue,box_predictor_4:ge,box_predictor_5:ce}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:a}}function RU(n){var e=[],t=uc(n),r=t.extractWeights,i=t.getRemainingWeights,o=NU(r,e),s=o.extractMobilenetV1Params,a=o.extractPredictionLayerParams,u=s(),l=a(),h=qb(r(5118*4),[1,5118,4]),d={extra_dim:h};if(e.push({paramPath:"output_layer/extra_dim"}),i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:d},paramMappings:e}}function PU(n,e){var t=bh(n,e);function r(l,h,d){var m=t(l+"/Conv2d_"+h+"_pointwise/weights",4,d+"/filters"),p=t(l+"/Conv2d_"+h+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:m,batch_norm_offset:p}}function i(l){var h="mobilenetv1/conv_"+l,d="MobilenetV1/Conv2d_"+l+"_depthwise",m=h+"/depthwise_conv",p=h+"/pointwise_conv",y=t(d+"/depthwise_weights",4,m+"/filters"),b=t(d+"/BatchNorm/gamma",1,m+"/batch_norm_scale"),x=t(d+"/BatchNorm/beta",1,m+"/batch_norm_offset"),E=t(d+"/BatchNorm/moving_mean",1,m+"/batch_norm_mean"),T=t(d+"/BatchNorm/moving_variance",1,m+"/batch_norm_variance");return{depthwise_conv:{filters:y,batch_norm_scale:b,batch_norm_offset:x,batch_norm_mean:E,batch_norm_variance:T},pointwise_conv:r("MobilenetV1",l,p)}}function o(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:i(1),conv_2:i(2),conv_3:i(3),conv_4:i(4),conv_5:i(5),conv_6:i(6),conv_7:i(7),conv_8:i(8),conv_9:i(9),conv_10:i(10),conv_11:i(11),conv_12:i(12),conv_13:i(13)}}function s(l,h){var d=t(l+"/weights",4,h+"/filters"),m=t(l+"/biases",1,h+"/bias");return{filters:d,bias:m}}function a(l){var h=s("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),d=s("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:h,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:u}}function DU(n){var e=[],t=PU(n,e),r=t.extractMobilenetV1Params,i=t.extractPredictionLayerParams,o=n["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Z0(o))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+o);var s={mobilenetv1:r(),prediction_layer:i(),output_layer:{extra_dim:o}};return ac(n,e),{params:s,paramMappings:e}}function Qu(n,e,t){return _t(function(){var r=$a(n,e.filters,t,"same");return r=Dn(r,e.batch_norm_offset),tx(r,0,6)})}var LU=.0010000000474974513;function MU(n,e,t){return _t(function(){var r=K0(n,e.filters,t,"same");return r=ST(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,LU),tx(r,0,6)})}function OU(n){return[2,4,6,12].some(function(e){return e===n})?[2,2]:[1,1]}function FU(n,e){return _t(function(){var t=null,r=Qu(n,e.conv_0,[2,2]),i=[e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13];if(i.forEach(function(o,s){var a=s+1,u=OU(a);r=MU(r,o.depthwise_conv,u),r=Qu(r,o.pointwise_conv,[1,1]),a===11&&(t=r)}),t===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:t}})}function BU(n,e,t,r,i){var o=n.shape[0],s=Math.min(t,o),a=e.map(function(h,d){return{score:h,boxIndex:d}}).filter(function(h){return h.score>i}).sort(function(h,d){return d.score-h.score}),u=function(h){return h<=r?1:0},l=[];return a.forEach(function(h){if(!(l.length>=s)){for(var d=h.score,m=l.length-1;m>=0;--m){var p=VU(n,h.boxIndex,l[m]);if(p!==0&&(h.score*=u(p),h.score<=i))break}d===h.score&&l.push(h.boxIndex)}}),l}function VU(n,e,t){var r=n.arraySync(),i=Math.min(r[e][0],r[e][2]),o=Math.min(r[e][1],r[e][3]),s=Math.max(r[e][0],r[e][2]),a=Math.max(r[e][1],r[e][3]),u=Math.min(r[t][0],r[t][2]),l=Math.min(r[t][1],r[t][3]),h=Math.max(r[t][0],r[t][2]),d=Math.max(r[t][1],r[t][3]),m=(s-i)*(a-o),p=(h-u)*(d-l);if(m<=0||p<=0)return 0;var y=Math.max(i,u),b=Math.max(o,l),x=Math.min(s,h),E=Math.min(a,d),T=Math.max(x-y,0)*Math.max(E-b,0);return T/(m+p-T)}function jU(n){var e=Hi(uh(n,[1,0])),t=[Ki(e[2],e[0]),Ki(e[3],e[1])],r=[Dn(e[0],gu(t[0],dt(2))),Dn(e[1],gu(t[1],dt(2)))];return{sizes:t,centers:r}}function UU(n,e){var t=jU(n),r=t.sizes,i=t.centers,o=Hi(uh(e,[1,0])),s=gu(us(dw(gu(o[2],dt(5))),r[0]),dt(2)),a=Dn(us(gu(o[0],dt(10)),r[0]),i[0]),u=gu(us(dw(gu(o[3],dt(5))),r[1]),dt(2)),l=Dn(us(gu(o[1],dt(10)),r[1]),i[1]);return uh(wa([Ki(a,s),Ki(l,u),Dn(a,s),Dn(l,u)]),[1,0])}function zU(n,e,t){return _t(function(){var r=n.shape[0],i=UU(yu(bd(t.extra_dim,[r,1,1]),[-1,4]),yu(n,[-1,4]));i=yu(i,[r,i.shape[0]/r,4]);var o=bT(pl(e,[0,0,1],[-1,-1,-1])),s=pl(o,[0,0,0],[-1,-1,1]);s=yu(s,[r,s.shape[1]]);var a=Hi(i),u=Hi(s);return{boxes:a,scores:u}})}function Jf(n,e){return _t(function(){var t=n.shape[0],r=yu(bu(n,e.box_encoding_predictor),[t,-1,1,4]),i=yu(bu(n,e.class_predictor),[t,-1,3]);return{boxPredictionEncoding:r,classPrediction:i}})}function WU(n,e,t){return _t(function(){var r=Qu(n,t.conv_0,[1,1]),i=Qu(r,t.conv_1,[2,2]),o=Qu(i,t.conv_2,[1,1]),s=Qu(o,t.conv_3,[2,2]),a=Qu(s,t.conv_4,[1,1]),u=Qu(a,t.conv_5,[2,2]),l=Qu(u,t.conv_6,[1,1]),h=Qu(l,t.conv_7,[2,2]),d=Jf(e,t.box_predictor_0),m=Jf(n,t.box_predictor_1),p=Jf(i,t.box_predictor_2),y=Jf(s,t.box_predictor_3),b=Jf(u,t.box_predictor_4),x=Jf(h,t.box_predictor_5),E=qi([d.boxPredictionEncoding,m.boxPredictionEncoding,p.boxPredictionEncoding,y.boxPredictionEncoding,b.boxPredictionEncoding,x.boxPredictionEncoding],1),T=qi([d.classPrediction,m.classPrediction,p.classPrediction,y.classPrediction,b.classPrediction,x.classPrediction],1);return{boxPredictions:E,classPredictions:T}})}var Ym=(function(){function n(e){var t=e===void 0?{}:e,r=t.minConfidence,i=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=i||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(n.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),n})(),Dk=(function(n){vn(e,n);function e(){return n.call(this,"SsdMobilenetv1")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return _t(function(){var i=t.toBatchTensor(512,!1).toFloat(),o=Ki(us(i,dt(.007843137718737125)),dt(1)),s=FU(o,r.mobilenetv1),a=WU(s.out,s.conv11,r.prediction_layer),u=a.boxPredictions,l=a.classPredictions;return zU(u,l,r.output_layer)})},e.prototype.forward=function(t){return jt(this,void 0,void 0,function(){var r;return Ut(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,mo(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.locateFaces=function(t,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,C,D,z,L,I;return Ut(this,function(A){switch(A.label){case 0:return i=new Ym(r),o=i.maxResults,s=i.minConfidence,[4,mo(t)];case 1:for(a=A.sent(),u=this.forwardInput(a),l=u.boxes,h=u.scores,d=l[0],m=h[0],p=1;p<l.length;p++)l[p].dispose(),h[p].dispose();return x=(b=Array).from,[4,m.data()];case 2:return y=x.apply(b,[A.sent()]),E=.5,T=BU(d,y,o,E,s),P=a.getReshapedInputDimensions(0),C=a.inputSize,D=C/P.width,z=C/P.height,L=d.arraySync(),I=T.map(function(O){var k=[Math.max(0,L[O][0]),Math.min(1,L[O][2])].map(function(ce){return ce*z}),M=k[0],j=k[1],X=[Math.max(0,L[O][1]),Math.min(1,L[O][3])].map(function(ce){return ce*D}),ue=X[0],ge=X[1];return new Cu(y[O],new yx(ue,M,ge-ue,j-M),{height:a.getInputHeight(0),width:a.getInputWidth(0)})}),d.dispose(),m.dispose(),[2,I]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(t){return DU(t)},e.prototype.extractParams=function(t){return RU(t)},e})(sc);(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(Dk);var qU=.4,HU=[new er(.738768,.874946),new er(2.42204,2.65704),new er(4.30971,7.04493),new er(10.246,4.59428),new er(12.6868,11.8741)],GU=[new er(1.603231,2.094468),new er(6.041143,7.080126),new er(2.882459,3.518061),new er(4.266906,5.178857),new er(9.041765,10.66308)],$U=[117.001,114.697,97.404],KU="tiny_yolov2_model",XU="tiny_yolov2_separable_conv_model",sv=function(n){return typeof n=="number"};function YU(n){if(!n)throw new Error("invalid config: "+n);if(typeof n.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+n.withSeparableConvs);if(!sv(n.iouThreshold)||n.iouThreshold<0||n.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+n.iouThreshold);if(!Array.isArray(n.classes)||!n.classes.length||!n.classes.every(function(e){return typeof e=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(n.classes));if(!Array.isArray(n.anchors)||!n.anchors.length||!n.anchors.map(function(e){return e||{}}).every(function(e){return sv(e.x)&&sv(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(n.anchors));if(n.meanRgb&&(!Array.isArray(n.meanRgb)||n.meanRgb.length!==3||!n.meanRgb.every(sv)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(n.meanRgb))}function Ix(n){return _t(function(){var e=us(n,dt(.10000000149011612));return Dn(Yr(Ki(n,e)),e)})}function Mc(n,e){return _t(function(){var t=wf(n,[[0,0],[1,1],[1,1],[0,0]]);return t=$a(t,e.conv.filters,[1,1],"valid"),t=Ki(t,e.bn.sub),t=us(t,e.bn.truediv),t=Dn(t,e.conv.bias),Ix(t)})}function Oc(n,e){return _t(function(){var t=wf(n,[[0,0],[1,1],[1,1],[0,0]]);return t=ox(t,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),t=Dn(t,e.bias),Ix(t)})}function QU(n,e){var t=n1(n,e);function r(s,a){var u=Di(n(s)),l=Di(n(s));return e.push({paramPath:a+"/sub"},{paramPath:a+"/truediv"}),{sub:u,truediv:l}}function i(s,a,u){var l=t(s,a,3,u+"/conv"),h=r(a,u+"/bn");return{conv:l,bn:h}}var o=Sx(n,e);return{extractConvParams:t,extractConvWithBatchNormParams:i,extractSeparableConvParams:o}}function JU(n,e,t,r){var i=uc(n),o=i.extractWeights,s=i.getRemainingWeights,a=[],u=QU(o,a),l=u.extractConvParams,h=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,m;if(e.withSeparableConvs){var p=r[0],y=r[1],b=r[2],x=r[3],E=r[4],T=r[5],P=r[6],C=r[7],D=r[8],z=e.isFirstLayerConv2d?l(p,y,3,"conv0"):d(p,y,"conv0"),L=d(y,b,"conv1"),I=d(b,x,"conv2"),A=d(x,E,"conv3"),O=d(E,T,"conv4"),k=d(T,P,"conv5"),M=C?d(P,C,"conv6"):void 0,j=D?d(C,D,"conv7"):void 0,X=l(D||C||P,5*t,1,"conv8");m={conv0:z,conv1:L,conv2:I,conv3:A,conv4:O,conv5:k,conv6:M,conv7:j,conv8:X}}else{var p=r[0],y=r[1],b=r[2],x=r[3],E=r[4],T=r[5],P=r[6],C=r[7],D=r[8],z=h(p,y,"conv0"),L=h(y,b,"conv1"),I=h(b,x,"conv2"),A=h(x,E,"conv3"),O=h(E,T,"conv4"),k=h(T,P,"conv5"),M=h(P,C,"conv6"),j=h(C,D,"conv7"),X=l(D,5*t,1,"conv8");m={conv0:z,conv1:L,conv2:I,conv3:A,conv4:O,conv5:k,conv6:M,conv7:j,conv8:X}}if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{params:m,paramMappings:a}}function ZU(n,e){var t=bh(n,e);function r(a){var u=t(a+"/sub",1),l=t(a+"/truediv",1);return{sub:u,truediv:l}}function i(a){var u=t(a+"/filters",4),l=t(a+"/bias",1);return{filters:u,bias:l}}function o(a){var u=i(a+"/conv"),l=r(a+"/bn");return{conv:u,bn:l}}var s=Ax(t);return{extractConvParams:i,extractConvWithBatchNormParams:o,extractSeparableConvParams:s}}function ez(n,e){var t=[],r=ZU(n,t),i=r.extractConvParams,o=r.extractConvWithBatchNormParams,s=r.extractSeparableConvParams,a;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;a={conv0:e.isFirstLayerConv2d?i("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:i("conv8")}}else a={conv0:o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:o("conv6"),conv7:o("conv7"),conv8:i("conv8")};return ac(n,t),{params:a,paramMappings:t}}var ZS;(function(n){n[n.XS=224]="XS",n[n.SM=320]="SM",n[n.MD=416]="MD",n[n.LG=608]="LG"})(ZS||(ZS={}));var Tx=(function(){function n(e){var t=e===void 0?{}:e,r=t.inputSize,i=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=i||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),n})(),Lk=(function(n){vn(e,n);function e(t){var r=n.call(this,"TinyYolov2")||this;return YU(t),r._config=t,r}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(t,r){var i=Mc(t,r.conv0);return i=co(i,[2,2],[2,2],"same"),i=Mc(i,r.conv1),i=co(i,[2,2],[2,2],"same"),i=Mc(i,r.conv2),i=co(i,[2,2],[2,2],"same"),i=Mc(i,r.conv3),i=co(i,[2,2],[2,2],"same"),i=Mc(i,r.conv4),i=co(i,[2,2],[2,2],"same"),i=Mc(i,r.conv5),i=co(i,[2,2],[1,1],"same"),i=Mc(i,r.conv6),i=Mc(i,r.conv7),bu(i,r.conv8,"valid",!1)},e.prototype.runMobilenet=function(t,r){var i=this.config.isFirstLayerConv2d?Ix(bu(t,r.conv0,"valid",!1)):Oc(t,r.conv0);return i=co(i,[2,2],[2,2],"same"),i=Oc(i,r.conv1),i=co(i,[2,2],[2,2],"same"),i=Oc(i,r.conv2),i=co(i,[2,2],[2,2],"same"),i=Oc(i,r.conv3),i=co(i,[2,2],[2,2],"same"),i=Oc(i,r.conv4),i=co(i,[2,2],[2,2],"same"),i=Oc(i,r.conv5),i=co(i,[2,2],[1,1],"same"),i=r.conv6?Oc(i,r.conv6):i,i=r.conv7?Oc(i,r.conv7):i,bu(i,r.conv8,"valid",!1)},e.prototype.forwardInput=function(t,r){var i=this,o=this.params;if(!o)throw new Error("TinyYolov2 - load model before inference");return _t(function(){var s=t.toBatchTensor(r,!1).toFloat();return s=i.config.meanRgb?Xm(s,i.config.meanRgb):s,s=s.div(dt(256)),i.config.withSeparableConvs?i.runMobilenet(s,o):i.runTinyYolov2(s,o)})},e.prototype.forward=function(t,r){return jt(this,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,mo(t)];case 1:return[4,i.apply(this,[o.sent(),r])];case 2:return[2,o.sent()]}})})},e.prototype.detect=function(t,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i,o,s,a,u,l,h,d,m,p,y,b,x,E,T=this;return Ut(this,function(P){switch(P.label){case 0:return i=new Tx(r),o=i.inputSize,s=i.scoreThreshold,[4,mo(t)];case 1:return a=P.sent(),[4,this.forwardInput(a,o)];case 2:return u=P.sent(),l=_t(function(){return Hi(u)[0].expandDims()}),h={width:a.getInputWidth(0),height:a.getInputHeight(0)},[4,this.extractBoxes(l,a.getReshapedInputDimensions(0),s)];case 3:return d=P.sent(),u.dispose(),l.dispose(),m=d.map(function(C){return C.box}),p=d.map(function(C){return C.score}),y=d.map(function(C){return C.classScore}),b=d.map(function(C){return T.config.classes[C.label]}),x=Am(m.map(function(C){return C.rescale(o)}),p,this.config.iouThreshold,!0),E=x.map(function(C){return new ik(p[C],y[C],b[C],m[C],h)}),[2,E]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(t){return ez(t,this.config)},e.prototype.extractParams=function(t){var r=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,i=r?r.length:void 0;if(i!==7&&i!==8&&i!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+i+" filterSizes in config");return JU(t,this.config,this.boxEncodingSize,r)},e.prototype.extractBoxes=function(t,r,i){return jt(this,void 0,void 0,function(){var o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,C,D,z,L,I,A,O,k,M,j,X,ue,ge,ce,$=this;return Ut(this,function(ae){switch(ae.label){case 0:return o=r.width,s=r.height,a=Math.max(o,s),u=a/o,l=a/s,h=t.shape[1],d=this.config.anchors.length,m=_t(function(){var fe=t.reshape([h,h,d,$.boxEncodingSize]),Q=fe.slice([0,0,0,0],[h,h,d,4]),W=fe.slice([0,0,0,4],[h,h,d,1]),J=$.withClassScores?ic(fe.slice([0,0,0,5],[h,h,d,$.config.classes.length]),3):dt(0);return[Q,W,J]}),p=m[0],y=m[1],b=m[2],x=[],[4,y.array()];case 1:return E=ae.sent(),[4,p.array()];case 2:T=ae.sent(),P=0,ae.label=3;case 3:if(!(P<h))return[3,12];C=0,ae.label=4;case 4:if(!(C<h))return[3,11];D=0,ae.label=5;case 5:return D<d?(z=Jy(E[P][C][D][0]),!i||z>i?(L=(C+Jy(T[P][C][D][0]))/h*u,I=(P+Jy(T[P][C][D][1]))/h*l,A=Math.exp(T[P][C][D][2])*this.config.anchors[D].x/h*u,O=Math.exp(T[P][C][D][3])*this.config.anchors[D].y/h*l,k=L-A/2,M=I-O/2,j={row:P,col:C,anchor:D},this.withClassScores?[4,this.extractPredictedClass(b,j)]:[3,7]):[3,9]):[3,10];case 6:return ce=ae.sent(),[3,8];case 7:ce={classScore:1,label:0},ae.label=8;case 8:X=ce,ue=X.classScore,ge=X.label,x.push(rs({box:new e1(k,M,k+A,M+O),score:z,classScore:z*ue,label:ge},j)),ae.label=9;case 9:return D++,[3,5];case 10:return C++,[3,4];case 11:return P++,[3,3];case 12:return p.dispose(),y.dispose(),b.dispose(),[2,x]}})})},e.prototype.extractPredictedClass=function(t,r){return jt(this,void 0,void 0,function(){var i,o,s,a;return Ut(this,function(u){switch(u.label){case 0:return i=r.row,o=r.col,s=r.anchor,[4,t.array()];case 1:return a=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,h){return a[i][o][s][h]}).map(function(l,h){return{classScore:l,label:h}}).reduce(function(l,h){return l.classScore>h.classScore?l:h})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e})(sc),tz=(function(n){vn(e,n);function e(t){t===void 0&&(t=!0);var r=this,i=Object.assign({},{withSeparableConvs:t,iouThreshold:qU,classes:["face"]},t?{anchors:GU,meanRgb:$U}:{anchors:HU,withClassScores:!0});return r=n.call(this,i)||this,r}return Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,r){return jt(this,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return[4,this.detect(t,r)];case 1:return i=o.sent(),[2,i.map(function(s){return new Cu(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?XU:KU},e.prototype.extractParamsFromWeigthMap=function(t){return n.prototype.extractParamsFromWeigthMap.call(this,t)},e})(Lk),Mk=(function(n){vn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return e})(Tx),Qm=(function(){function n(){}return n.prototype.then=function(e){return jt(this,void 0,void 0,function(){var t;return Ut(this,function(r){switch(r.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[r.sent()])]}})})},n.prototype.run=function(){return jt(this,void 0,void 0,function(){return Ut(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},n})();function i1(n,e,t,r,i){return i===void 0&&(i=function(o){var s=o.alignedRect;return s}),jt(this,void 0,void 0,function(){var o,s,a,u,l;return Ut(this,function(h){switch(h.label){case 0:return o=n.map(function(d){return Ek(d)?i(d):d.detection}),a=r,a?[3,5]:e instanceof $r?[4,_x(e,o)]:[3,2];case 1:return u=h.sent(),[3,4];case 2:return[4,xx(e,o)];case 3:u=h.sent(),h.label=4;case 4:a=u,h.label=5;case 5:return s=a,[4,t(s)];case 6:return l=h.sent(),s.forEach(function(d){return d instanceof $r&&d.dispose()}),[2,l]}})})}function kx(n,e,t,r,i){return jt(this,void 0,void 0,function(){var o=this;return Ut(this,function(s){return[2,i1([n],e,function(a){return jt(o,void 0,void 0,function(){return Ut(this,function(u){return[2,t(a[0])]})})},r,i)]})})}function nz(n){return _t(function(){return wa(Hi(n,3).reverse(),3)})}var av=2,v0=12;function rz(n,e){var t=n1(n,e),r=Ex(n,e);function i(l,h){var d=Di(n(l));return e.push({paramPath:h}),d}function o(l,h,d){d===void 0&&(d=!1);var m=t(l[0],l[1],3,h+"/conv1"),p=i(l[1],h+"/prelu1_alpha"),y=t(l[1],l[2],3,h+"/conv2"),b=i(l[2],h+"/prelu2_alpha"),x=t(l[2],l[3],d?2:3,h+"/conv3"),E=i(l[3],h+"/prelu3_alpha");return{conv1:m,prelu1_alpha:p,conv2:y,prelu2_alpha:b,conv3:x,prelu3_alpha:E}}function s(){var l=o([3,10,16,32],"pnet"),h=t(32,2,1,"pnet/conv4_1"),d=t(32,4,1,"pnet/conv4_2");return rs(rs({},l),{conv4_1:h,conv4_2:d})}function a(){var l=o([3,28,48,64],"rnet",!0),h=r(576,128,"rnet/fc1"),d=i(128,"rnet/prelu4_alpha"),m=r(128,2,"rnet/fc2_1"),p=r(128,4,"rnet/fc2_2");return rs(rs({},l),{fc1:h,prelu4_alpha:d,fc2_1:m,fc2_2:p})}function u(){var l=o([3,32,64,64],"onet"),h=t(64,128,2,"onet/conv4"),d=i(128,"onet/prelu4_alpha"),m=r(1152,256,"onet/fc1"),p=i(256,"onet/prelu5_alpha"),y=r(256,2,"onet/fc2_1"),b=r(256,4,"onet/fc2_2"),x=r(256,10,"onet/fc2_3");return rs(rs({},l),{conv4:h,prelu4_alpha:d,fc1:m,prelu5_alpha:p,fc2_1:y,fc2_2:b,fc2_3:x})}return{extractPNetParams:s,extractRNetParams:a,extractONetParams:u}}function iz(n){var e=uc(n),t=e.extractWeights,r=e.getRemainingWeights,i=[],o=rz(t,i),s=o.extractPNetParams,a=o.extractRNetParams,u=o.extractONetParams,l=s(),h=a(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:h,onet:d},paramMappings:i}}function oz(n,e){var t=bh(n,e);function r(h){var d=t(h+"/weights",4,h+"/filters"),m=t(h+"/bias",1);return{filters:d,bias:m}}function i(h){var d=t(h+"/weights",2),m=t(h+"/bias",1);return{weights:d,bias:m}}function o(h){return t(h,1)}function s(h){var d=r(h+"/conv1"),m=o(h+"/prelu1_alpha"),p=r(h+"/conv2"),y=o(h+"/prelu2_alpha"),b=r(h+"/conv3"),x=o(h+"/prelu3_alpha");return{conv1:d,prelu1_alpha:m,conv2:p,prelu2_alpha:y,conv3:b,prelu3_alpha:x}}function a(){var h=s("pnet"),d=r("pnet/conv4_1"),m=r("pnet/conv4_2");return rs(rs({},h),{conv4_1:d,conv4_2:m})}function u(){var h=s("rnet"),d=i("rnet/fc1"),m=o("rnet/prelu4_alpha"),p=i("rnet/fc2_1"),y=i("rnet/fc2_2");return rs(rs({},h),{fc1:d,prelu4_alpha:m,fc2_1:p,fc2_2:y})}function l(){var h=s("onet"),d=r("onet/conv4"),m=o("onet/prelu4_alpha"),p=i("onet/fc1"),y=o("onet/prelu5_alpha"),b=i("onet/fc2_1"),x=i("onet/fc2_2"),E=i("onet/fc2_3");return rs(rs({},h),{conv4:d,prelu4_alpha:m,fc1:p,prelu5_alpha:y,fc2_1:b,fc2_2:x,fc2_3:E})}return{extractPNetParams:a,extractRNetParams:u,extractONetParams:l}}function sz(n){var e=[],t=oz(n,e),r=t.extractPNetParams,i=t.extractRNetParams,o=t.extractONetParams,s=r(),a=i(),u=o();return ac(n,e),{params:{pnet:s,rnet:a,onet:u},paramMappings:e}}function xw(n,e){var t=e[0],r=e[1];return{height:Math.floor(t*n),width:Math.floor(r*n)}}function az(n,e,t){for(var r=t[0],i=t[1],o=v0/n,s=[],a=Math.min(r,i)*o,u=0;a>=12;)s.push(o*Math.pow(e,u)),a=a*e,u+=1;return s}var Nx=(function(n){vn(e,n);function e(t,r,i,o){return n.call(this,{left:t,top:r,right:i,bottom:o},!0)||this}return e})(lh);function Ok(n){return _t(function(){return us(Ki(n,dt(127.5)),dt(.0078125))})}function Ad(n,e){return _t(function(){return Dn(Yr(n),us(e,h0(Yr(h0(n)))))})}function Rx(n,e,t){return t===void 0&&(t=!1),_t(function(){var r=bu(n,e.conv1,"valid");return r=Ad(r,e.prelu1_alpha),r=co(r,t?[2,2]:[3,3],[2,2],"same"),r=bu(r,e.conv2,"valid"),r=Ad(r,e.prelu2_alpha),r=t?r:co(r,[3,3],[2,2],"valid"),r=bu(r,e.conv3,"valid"),r=Ad(r,e.prelu3_alpha),r})}function uz(n,e){return _t(function(){var t=Rx(n,e,!0),r=bu(t,e.conv4_1,"valid"),i=Wa(Y0(r,3),3),o=ic(Ki(r,i),3),s=bu(t,e.conv4_2,"valid");return{prob:o,regions:s}})}function lz(n,e){return _t(function(){var t=xw(e,n.shape.slice(1)),r=t.height,i=t.width,o=cx.resizeBilinear(n,[r,i]),s=Ok(o);return uh(s,[0,2,1,3])})}function cz(n,e,t,r){for(var i=[],o=n.arraySync(),s=0;s<n.shape[0];s++)for(var a=0;a<n.shape[1];a++)o[s][a]>=r&&i.push(new er(a,s));var u=i.map(function(l){var h=new e1(Math.round((l.y*av+1)/t),Math.round((l.x*av+1)/t),Math.round((l.y*av+v0)/t),Math.round((l.x*av+v0)/t)),d=o[l.y][l.x],m=e.arraySync(),p=new Nx(m[l.y][l.x][0],m[l.y][l.x][1],m[l.y][l.x][2],m[l.y][l.x][3]);return{cell:h,score:d,region:p}});return u}function hz(n,e,t,r,i){i.stage1=[];var o=e.map(function(m){return _t(function(){var p={scale:m},y=lz(n,m),b=Date.now(),x=uz(y,r),E=x.prob,T=x.regions;p.pnet=Date.now()-b;var P=Hi(Hi(E,3)[1])[0],C=Hi(T)[0];return{scoresTensor:P,regionsTensor:C,scale:m,statsForScale:p}})}),s=o.map(function(m){var p=m.scoresTensor,y=m.regionsTensor,b=m.scale,x=m.statsForScale,E=cz(p,y,b,t);if(p.dispose(),y.dispose(),!E.length)return i.stage1.push(x),[];var T=Date.now(),P=Am(E.map(function(C){return C.cell}),E.map(function(C){return C.score}),.5);return x.nms=Date.now()-T,x.numBoxes=P.length,i.stage1.push(x),P.map(function(C){return E[C]})}),a=s.reduce(function(m,p){return m.concat(p)},[]),u=[],l=[];if(a.length>0){var h=Date.now(),d=Am(a.map(function(m){return m.cell}),a.map(function(m){return m.score}),.7);i.stage1_nms=Date.now()-h,l=d.map(function(m){return a[m].score}),u=d.map(function(m){return a[m]}).map(function(m){var p=m.cell,y=m.region;return new e1(p.left+y.left*p.width,p.top+y.top*p.height,p.right+y.right*p.width,p.bottom+y.bottom*p.height).toSquare().round()})}return{boxes:u,scores:l}}function Fk(n,e,t){var r=t.width,i=t.height;return jt(this,void 0,void 0,function(){var o,s,a,u=this;return Ut(this,function(l){switch(l.label){case 0:return o=cf(n),[4,Promise.all(e.map(function(h){return jt(u,void 0,void 0,function(){var d,m,p,y,b,x,E,T;return Ut(this,function(P){return d=h.padAtBorders(n.height,n.width),m=d.y,p=d.ey,y=d.x,b=d.ex,x=y-1,E=m-1,T=o.getImageData(x,E,b-x,p-E),[2,Do.isNodejs()?bx(T):createImageBitmap(T)]})})}))];case 1:return s=l.sent(),a=[],s.forEach(function(h){var d=t1({width:r,height:i}),m=cf(d);m.drawImage(h,0,0,r,i);for(var p=m.getImageData(0,0,r,i).data,y=[],b=0;b<p.length;b+=4)y.push(p[b+2]),y.push(p[b+1]),y.push(p[b]);a.push(y)}),[2,a.map(function(h){var d=_t(function(){var m=uh(zs(h,[1,r,i,3]),[0,2,1,3]).toFloat();return Ok(m)});return d})]}})})}function fz(n,e){return _t(function(){var t=Rx(n,e),r=yu(t,[t.shape[0],e.fc1.weights.shape[0]]),i=il(r,e.fc1),o=Ad(i,e.prelu4_alpha),s=il(o,e.fc2_1),a=Wa(Y0(s,1),1),u=ic(Ki(s,a),1),l=il(o,e.fc2_2),h=Hi(u,1)[1];return{scores:h,regions:l}})}function dz(n,e,t,r,i){return jt(this,void 0,void 0,function(){var o,s,a,u,l,h,d,m,p,y,b,x,E,T;return Ut(this,function(P){switch(P.label){case 0:return o=Date.now(),[4,Fk(n,e,{width:24,height:24})];case 1:return s=P.sent(),i.stage2_extractImagePatches=Date.now()-o,o=Date.now(),a=s.map(function(C){var D=fz(C,r);return C.dispose(),D}),i.stage2_rnet=Date.now()-o,u=a.length>1?qi(a.map(function(C){return C.scores})):a[0].scores,d=(h=Array).from,[4,u.data()];case 2:return l=d.apply(h,[P.sent()]),u.dispose(),m=l.map(function(C,D){return{score:C,idx:D}}).filter(function(C){return C.score>t}).map(function(C){var D=C.idx;return D}),p=m.map(function(C){return e[C]}),y=m.map(function(C){return l[C]}),b=[],x=[],p.length>0&&(o=Date.now(),E=Am(p,y,.7),i.stage2_nms=Date.now()-o,T=E.map(function(C){var D=a[m[C]].regions.arraySync();return new Nx(D[0][0],D[0][1],D[0][2],D[0][3])}),x=E.map(function(C){return y[C]}),b=E.map(function(C,D){return p[C].calibrate(T[D])})),a.forEach(function(C){C.regions.dispose(),C.scores.dispose()}),[2,{boxes:b,scores:x}]}})})}function pz(n,e){return _t(function(){var t=Rx(n,e);t=co(t,[2,2],[2,2],"same"),t=bu(t,e.conv4,"valid"),t=Ad(t,e.prelu4_alpha);var r=yu(t,[t.shape[0],e.fc1.weights.shape[0]]),i=il(r,e.fc1),o=Ad(i,e.prelu5_alpha),s=il(o,e.fc2_1),a=Wa(Y0(s,1),1),u=ic(Ki(s,a),1),l=il(o,e.fc2_2),h=il(o,e.fc2_3),d=Hi(u,1)[1];return{scores:d,regions:l,points:h}})}function mz(n,e,t,r,i){return jt(this,void 0,void 0,function(){var o,s,a,u,l,h,d,m,p,y,b,x,E,T,P;return Ut(this,function(C){switch(C.label){case 0:return o=Date.now(),[4,Fk(n,e,{width:48,height:48})];case 1:return s=C.sent(),i.stage3_extractImagePatches=Date.now()-o,o=Date.now(),a=s.map(function(D){var z=pz(D,r);return D.dispose(),z}),i.stage3_onet=Date.now()-o,u=a.length>1?qi(a.map(function(D){return D.scores})):a[0].scores,d=(h=Array).from,[4,u.data()];case 2:return l=d.apply(h,[C.sent()]),u.dispose(),m=l.map(function(D,z){return{score:D,idx:z}}).filter(function(D){return D.score>t}).map(function(D){var z=D.idx;return z}),p=m.map(function(D){var z=a[D].regions.arraySync();return new Nx(z[0][0],z[0][1],z[0][2],z[0][3])}),y=m.map(function(D,z){return e[D].calibrate(p[z])}),b=m.map(function(D){return l[D]}),x=[],E=[],T=[],y.length>0&&(o=Date.now(),P=Am(y,b,.7,!1),i.stage3_nms=Date.now()-o,x=P.map(function(D){return y[D]}),E=P.map(function(D){return b[D]}),T=P.map(function(D,z){return Array(5).fill(0).map(function(L,I){var A=a[D].points.arraySync();return new er(A[0][I]*(x[z].width+1)+x[z].left,A[0][I+5]*(x[z].height+1)+x[z].top)})})),a.forEach(function(D){D.regions.dispose(),D.scores.dispose(),D.points.dispose()}),[2,{boxes:x,scores:E,points:T}]}})})}var gz=(function(n){vn(e,n);function e(){return n.call(this,"Mtcnn")||this}return e.prototype.load=function(t){return jt(this,void 0,void 0,function(){return Ut(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.load.call(this,t)]})})},e.prototype.loadFromDisk=function(t){return jt(this,void 0,void 0,function(){return Ut(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.loadFromDisk.call(this,t)]})})},e.prototype.forwardInput=function(t,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,C,D,z,L,I;return Ut(this,function(A){switch(A.label){case 0:if(i=this.params,!i)throw new Error("Mtcnn - load model before inference");if(o=t.canvases[0],!o)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return s={},a=Date.now(),u=_t(function(){return nz(Wa(gx.fromPixels(o)).toFloat())}),l=function(O){return u.dispose(),s.total=Date.now()-a,O},h=u.shape.slice(1),d=h[0],m=h[1],p=new Pk(r),y=p.minFaceSize,b=p.scaleFactor,x=p.maxNumScales,E=p.scoreThresholds,T=p.scaleSteps,P=(T||az(y,b,[d,m])).filter(function(O){var k=xw(O,[d,m]);return Math.min(k.width,k.height)>v0}).slice(0,x),s.scales=P,s.pyramid=P.map(function(O){return xw(O,[d,m])}),C=Date.now(),[4,hz(u,P,E[0],i.pnet,s)];case 1:return D=A.sent(),s.total_stage1=Date.now()-C,D.boxes.length?(s.stage2_numInputBoxes=D.boxes.length,C=Date.now(),[4,dz(o,D.boxes,E[1],i.rnet,s)]):[2,l({results:[],stats:s})];case 2:return z=A.sent(),s.total_stage2=Date.now()-C,z.boxes.length?(s.stage3_numInputBoxes=z.boxes.length,C=Date.now(),[4,mz(o,z.boxes,E[2],i.onet,s)]):[2,l({results:[],stats:s})];case 3:return L=A.sent(),s.total_stage3=Date.now()-C,I=L.boxes.map(function(O,k){return r1(Im({},new Cu(L.scores[k],new yx(O.left/m,O.top/d,O.width/m,O.height/d),{height:d,width:m})),new $9(L.points[k].map(function(M){return M.sub(new er(O.left,O.top)).div(new er(O.width,O.height))}),{width:O.width,height:O.height}))}),[2,l({results:I,stats:s})]}})})},e.prototype.forward=function(t,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,mo(t)];case 1:return[4,i.apply(this,[o.sent(),r])];case 2:return[2,o.sent().results]}})})},e.prototype.forwardWithStats=function(t,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return i=this.forwardInput,[4,mo(t)];case 1:return[2,i.apply(this,[o.sent(),r])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(t){return sz(t)},e.prototype.extractParams=function(t){return iz(t)},e})(sc),vz=.4,yz=[new er(1.603231,2.094468),new er(6.041143,7.080126),new er(2.882459,3.518061),new er(4.266906,5.178857),new er(9.041765,10.66308)],wz=[117.001,114.697,97.404],bz=(function(n){vn(e,n);function e(){var t=this,r={withSeparableConvs:!0,iouThreshold:vz,classes:["face"],anchors:yz,meanRgb:wz,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return t=n.call(this,r)||this,t}return Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,r){return jt(this,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return[4,this.detect(t,r)];case 1:return i=o.sent(),[2,i.map(function(s){return new Cu(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(t){return n.prototype.extractParamsFromWeigthMap.call(this,t)},e})(Lk),Li={ssdMobilenetv1:new Dk,tinyFaceDetector:new bz,tinyYolov2:new tz,mtcnn:new gz,faceLandmark68Net:new Ck,faceLandmark68TinyNet:new _U,faceRecognitionNet:new kU,faceExpressionNet:new lU,ageGenderNet:new yU},Bk=(function(n){vn(e,n);function e(t,r,i){var o=n.call(this)||this;return o.parentTask=t,o.input=r,o.extractedFaces=i,o}return e})(Qm),Px=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i=this;return Ut(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return t=o.sent(),[4,i1(t,this.input,function(s){return jt(i,void 0,void 0,function(){return Ut(this,function(a){switch(a.label){case 0:return[4,Promise.all(s.map(function(u){return Li.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,a.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,t.map(function(s,a){return _k(s,r[a])})]}})})},e.prototype.withAgeAndGender=function(){return new Ox(this,this.input)},e})(Bk),Dx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r;return Ut(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),t?[4,kx(t,this.input,function(o){return Li.faceExpressionNet.predictExpressions(o)},this.extractedFaces)]:[2];case 2:return r=i.sent(),[2,_k(t,r)]}})})},e.prototype.withAgeAndGender=function(){return new Fx(this,this.input)},e})(Bk),Lx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new Bx(this,this.input)},e.prototype.withFaceDescriptors=function(){return new jx(this,this.input)},e})(Px),Mx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new Vx(this,this.input)},e.prototype.withFaceDescriptor=function(){return new Ux(this,this.input)},e})(Dx),Vk=(function(n){vn(e,n);function e(t,r,i){var o=n.call(this)||this;return o.parentTask=t,o.input=r,o.extractedFaces=i,o}return e})(Qm),Ox=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i=this;return Ut(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return t=o.sent(),[4,i1(t,this.input,function(s){return jt(i,void 0,void 0,function(){return Ut(this,function(a){switch(a.label){case 0:return[4,Promise.all(s.map(function(u){return Li.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,a.sent()]}})})},this.extractedFaces)];case 2:return r=o.sent(),[2,t.map(function(s,a){var u=r[a],l=u.age,h=u.gender,d=u.genderProbability;return Nk(Rk(s,h,d),l)})]}})})},e.prototype.withFaceExpressions=function(){return new Px(this,this.input)},e})(Vk),Fx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i,o,s;return Ut(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),t?[4,kx(t,this.input,function(u){return Li.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=a.sent(),i=r.age,o=r.gender,s=r.genderProbability,[2,Nk(Rk(t,o,s),i)]}})})},e.prototype.withFaceExpressions=function(){return new Dx(this,this.input)},e})(Vk),Bx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new Lx(this,this.input)},e.prototype.withFaceDescriptors=function(){return new jx(this,this.input)},e})(Ox),Vx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new Mx(this,this.input)},e.prototype.withFaceDescriptor=function(){return new Ux(this,this.input)},e})(Fx),jk=(function(n){vn(e,n);function e(t,r){var i=n.call(this)||this;return i.parentTask=t,i.input=r,i}return e})(Qm),jx=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r;return Ut(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),[4,i1(t,this.input,function(o){return Promise.all(o.map(function(s){return Li.faceRecognitionNet.computeFaceDescriptor(s)}))},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=i.sent(),[2,r.map(function(o,s){return kk(t[s],o)})]}})})},e.prototype.withFaceExpressions=function(){return new Lx(this,this.input)},e.prototype.withAgeAndGender=function(){return new Bx(this,this.input)},e})(jk),Ux=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r;return Ut(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),t?[4,kx(t,this.input,function(o){return Li.faceRecognitionNet.computeFaceDescriptor(o)},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=i.sent(),[2,kk(t,r)]}})})},e.prototype.withFaceExpressions=function(){return new Mx(this,this.input)},e.prototype.withAgeAndGender=function(){return new Vx(this,this.input)},e})(jk),Uk=(function(n){vn(e,n);function e(t,r,i){var o=n.call(this)||this;return o.parentTask=t,o.input=r,o.useTinyLandmarkNet=i,o}return Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Li.faceLandmark68TinyNet:Li.faceLandmark68Net},enumerable:!0,configurable:!0}),e})(Qm),xz=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i,o,s,a=this;return Ut(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return t=u.sent(),r=t.map(function(l){return l.detection}),this.input instanceof $r?[4,_x(this.input,r)]:[3,3];case 2:return o=u.sent(),[3,5];case 3:return[4,xx(this.input,r)];case 4:o=u.sent(),u.label=5;case 5:return i=o,[4,Promise.all(i.map(function(l){return a.landmarkNet.detectLandmarks(l)}))];case 6:return s=u.sent(),i.forEach(function(l){return l instanceof $r&&l.dispose()}),[2,t.map(function(l,h){return r1(l,s[h])})]}})})},e.prototype.withFaceExpressions=function(){return new Lx(this,this.input)},e.prototype.withAgeAndGender=function(){return new Bx(this,this.input)},e.prototype.withFaceDescriptors=function(){return new jx(this,this.input)},e})(Uk),_z=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i,o,s;return Ut(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),t?(r=t.detection,this.input instanceof $r?[4,_x(this.input,[r])]:[3,3]):[2];case 2:return o=a.sent(),[3,5];case 3:return[4,xx(this.input,[r])];case 4:o=a.sent(),a.label=5;case 5:return i=o,[4,this.landmarkNet.detectLandmarks(i[0])];case 6:return s=a.sent(),i.forEach(function(u){return u instanceof $r&&u.dispose()}),[2,r1(t,s)]}})})},e.prototype.withFaceExpressions=function(){return new Mx(this,this.input)},e.prototype.withAgeAndGender=function(){return new Vx(this,this.input)},e.prototype.withFaceDescriptor=function(){return new Ux(this,this.input)},e})(Uk),zk=(function(n){vn(e,n);function e(t,r){r===void 0&&(r=new Ym);var i=n.call(this)||this;return i.input=t,i.options=r,i}return e})(Qm),Wk=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r,i,o;return Ut(this,function(s){switch(s.label){case 0:return t=this,r=t.input,i=t.options,i instanceof Pk?[4,Li.mtcnn.forward(r,i)]:[3,2];case 1:return[2,s.sent().map(function(a){return a.detection})];case 2:if(o=i instanceof Mk?function(a){return Li.tinyFaceDetector.locateFaces(a,i)}:i instanceof Ym?function(a){return Li.ssdMobilenetv1.locateFaces(a,i)}:i instanceof Tx?function(a){return Li.tinyYolov2.locateFaces(a,i)}:null,!o)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,o(r)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise(function(r){return jt(t,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return i=o.sent(),[2,r(i.map(function(s){return Im({},s)}))]}})})})},e.prototype.withFaceLandmarks=function(t){return t===void 0&&(t=!1),new xz(this.runAndExtendWithFaceDetections(),this.input,t)},e.prototype.withFaceExpressions=function(){return new Px(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new Ox(this.runAndExtendWithFaceDetections(),this.input)},e})(zk),Ez=(function(n){vn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return jt(this,void 0,void 0,function(){var t,r;return Ut(this,function(i){switch(i.label){case 0:return[4,new Wk(this.input,this.options)];case 1:return t=i.sent(),r=t[0],t.forEach(function(o){o.score>r.score&&(r=o)}),[2,r]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var t=this;return new Promise(function(r){return jt(t,void 0,void 0,function(){var i;return Ut(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return i=o.sent(),[2,r(i?Im({},i):void 0)]}})})})},e.prototype.withFaceLandmarks=function(t){return t===void 0&&(t=!1),new _z(this.runAndExtendWithFaceDetection(),this.input,t)},e.prototype.withFaceExpressions=function(){return new Dx(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new Fx(this.runAndExtendWithFaceDetection(),this.input)},e})(zk);function Sz(n,e){return e===void 0&&(e=new Ym),new Ez(n,e)}function Az(n,e){return e===void 0&&(e=new Ym),new Wk(n,e)}function qk(n,e){if(n.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var t=Array.from(n),r=Array.from(e);return Math.sqrt(t.map(function(i,o){return i-r[o]}).reduce(function(i,o){return i+Math.pow(o,2)},0))}(function(){function n(e,t){t===void 0&&(t=.6),this._distanceThreshold=t;var r=Array.isArray(e)?e:[e];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var i=1,o=function(){return"person "+i++};this._labeledDescriptors=r.map(function(s){if(s instanceof rv)return s;if(s instanceof Float32Array)return new rv(o(),[s]);if(s.descriptor&&s.descriptor instanceof Float32Array)return new rv(o(),[s.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(n.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),n.prototype.computeMeanDistance=function(e,t){return t.map(function(r){return qk(r,e)}).reduce(function(r,i){return r+i},0)/(t.length||1)},n.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map(function(r){var i=r.descriptors,o=r.label;return new KS(o,t.computeMeanDistance(e,i))}).reduce(function(r,i){return r.distance<i.distance?r:i})},n.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new KS("unknown",t.distance)},n.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},n.fromJSON=function(e){var t=e.labeledDescriptors.map(function(r){return rv.fromJSON(r)});return new n(t,e.distanceThreshold)},n})();function Hk(n,e){var t=new rf(e.width,e.height),r=t.width,i=t.height;if(r<=0||i<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:i}));if(Array.isArray(n))return n.map(function(a){return Hk(a,{width:r,height:i})});if(Ek(n)){var o=n.detection.forSize(r,i),s=n.unshiftedLandmarks.forSize(o.box.width,o.box.height);return r1(Im(n,o),s)}return ok(n)?Im(n,n.detection.forSize(r,i)):n instanceof Cm||n instanceof Cu?n.forSize(r,i):n}const Cz=()=>{const n=Ke.useRef(null),e=Ke.useRef(null),t=Ke.useRef(!0),{setActiveMode:r,speak:i,playSound:o,conversationState:s,triggerInterview:a,faceDatabase:u,isListening:l,toggleListening:h}=Eu(),[d,m]=Ke.useState(!1),[p,y]=Ke.useState(0),[b,x]=Ke.useState("environment"),E=Ke.useRef(0);Ke.useEffect(()=>(t.current=!0,(async()=>{const z="https://justadudewhohacks.github.io/face-api.js/models";try{await Promise.all([Li.tinyFaceDetector.loadFromUri(z),Li.faceLandmark68TinyNet.loadFromUri(z),Li.faceRecognitionNet.loadFromUri(z),Li.ssdMobilenetv1.loadFromUri(z)]),t.current&&m(!0)}catch{t.current&&i("Neural network connection failed.")}})(),()=>{t.current=!1}),[]),Ke.useEffect(()=>{let D=null;return(async()=>{n.current&&n.current.srcObject&&n.current.srcObject.getTracks().forEach(L=>L.stop());try{D=await navigator.mediaDevices.getUserMedia({video:{facingMode:b,width:{ideal:640},height:{ideal:480},frameRate:{ideal:30}},audio:!1}),n.current&&t.current&&(n.current.srcObject=D)}catch{t.current&&i("Camera malfunction.")}})(),()=>{D&&D.getTracks().forEach(L=>L.stop())}},[b]);const T=()=>{o("click"),x(D=>D==="environment"?"user":"environment")},P=(D,z,L,I,A,O,k)=>{const M=z+I/2,j=L+A/2,X=Math.max(I,A)*.6;D.save(),D.translate(M,j),b==="user"&&D.scale(-1,1),D.beginPath(),D.rotate(k*.05),D.arc(0,0,X*.8,0,Math.PI*2),D.strokeStyle=O,D.lineWidth=3,D.setLineDash([10,5]),D.shadowBlur=10,D.shadowColor=O,D.stroke(),D.rotate(-k*.1);const ue=X*1.2;D.lineWidth=5,D.setLineDash([]);for(let ge=0;ge<3;ge++)D.rotate(Math.PI*2/3),D.beginPath(),D.arc(0,0,ue,0,1),D.stroke();D.resetTransform(),D.strokeStyle=O,D.lineWidth=1,D.globalAlpha=.5,D.beginPath(),D.moveTo(M-20,j),D.lineTo(M+20,j),D.moveTo(M,j-20),D.lineTo(M,j+20),D.stroke(),D.restore()},C=(D,z,L,I,A,O,k=!1)=>{const M=I*.2;if(D.save(),k){const j=Math.sin(Date.now()/100);D.lineWidth=4,D.shadowBlur=20*Math.abs(j),D.shadowColor=O,D.strokeStyle=`rgba(0, 68, 255, ${Math.abs(j)+.5})`}else D.lineWidth=2,D.strokeStyle=O,D.shadowBlur=0;D.beginPath(),D.moveTo(z,L+M),D.lineTo(z,L),D.lineTo(z+M,L),D.moveTo(z+I-M,L),D.lineTo(z+I,L),D.lineTo(z+I,L+M),D.moveTo(z+I,L+A-M),D.lineTo(z+I,L+A),D.lineTo(z+I-M,L+A),D.moveTo(z+M,L+A),D.lineTo(z,L+A),D.lineTo(z,L+A-M),D.stroke(),D.restore()};return Ke.useEffect(()=>{if(!d||!n.current)return;let D=!1,z;const L=new Mk({inputSize:320,scoreThreshold:.5}),I=async()=>{if(t.current){if(D){z=requestAnimationFrame(I);return}if(D=!0,n.current&&n.current.readyState===4&&e.current)try{const A=await Az(n.current,L).withFaceLandmarks(!0).withFaceDescriptors();if(!t.current)return;const O=e.current.getContext("2d"),k={width:n.current.videoWidth,height:n.current.videoHeight};e.current.width=k.width,e.current.height=k.height,b==="user"&&(O.translate(k.width,0),O.scale(-1,1));const M=Hk(A,k);O.clearRect(0,0,k.width,k.height);let j=-1,X=0,ue=!1;if(M.forEach((ge,ce)=>{const $=ge.detection.box.width*ge.detection.box.height;$>X&&(X=$,j=ce)}),M.forEach((ge,ce)=>{const $=ge.detection.box,ae=ce===j;let fe={name:"Unknown",accessLevel:"No Access",distance:1};u.length>0&&u.forEach(W=>{if(W.descriptor){const J=new Float32Array(Object.values(W.descriptor)),te=qk(ge.descriptor,J);te<.6&&te<fe.distance&&(fe={...W,distance:te})}});let Q="#888888";if(s==="SCANNING"&&ae?Q="#FFFFFF":fe.accessLevel==="Admin"?Q="#00FF00":fe.accessLevel==="Medium"?Q="#FFA500":fe.accessLevel==="Missing"&&(Q="#0044FF"),fe.accessLevel==="Missing"&&(ue=!0),ae){const W=Date.now()/20;P(O,$.x,$.y,$.width,$.height,Q,W),O.save(),b==="user"&&(O.scale(-1,1),O.translate(-($.x*2+$.width+180),0));const J=$.x+$.width+20,te=$.y;(fe.name!=="Unknown"||s==="SCANNING")&&(O.fillStyle="rgba(0, 0, 0, 0.8)",O.fillRect(J,te,160,90),O.strokeStyle=Q,O.strokeRect(J,te,160,90),O.font="bold 12px Orbitron",O.fillStyle=Q,O.fillText(fe.name.toUpperCase(),J+10,te+25),O.font="10px Share Tech Mono",O.fillStyle="#FFFFFF",O.fillText(`ACCESS: ${fe.accessLevel?fe.accessLevel.toUpperCase():"SCANNING..."}`,J+10,te+45),fe.age&&O.fillText(`AGE: ${fe.age}`,J+10,te+60)),O.restore(),s==="SCANNING"?(y(de=>de+1),O.fillStyle="#00E5FF",O.fillRect($.x,$.y-15,$.width*(p/20),8),p>20&&(y(0),a(ge.descriptor))):y(0)}else{C(O,$.x,$.y,$.width,$.height,Q,fe.accessLevel==="Missing"),O.save(),b==="user"&&(O.scale(-1,1),O.translate(-($.x*2+$.width),0)),O.font="bold 10px Orbitron",O.fillStyle=Q;const W=fe.name!=="Unknown"?fe.name.toUpperCase():"UNKNOWN";O.fillText(W,$.x,$.y-5),fe.accessLevel==="Missing"&&(O.fillStyle="#0044FF",O.font="bold 12px Orbitron",O.fillText(" MATCH FOUND",$.x,$.y-20)),O.restore()}}),ue){const ge=Date.now();ge-E.current>15e3&&(i("Alert, Sir. Missing person detected in sector.",!1),o("startup"),E.current=ge)}M.length===0&&y(0)}catch(A){console.log("Detection skip",A)}D=!1,z=requestAnimationFrame(I)}};return I(),()=>cancelAnimationFrame(z)},[d,u,s,p,a,b]),oe.jsxs("div",{className:"fixed inset-0 z-50 bg-black flex flex-col items-center justify-center",children:[oe.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,muted:!0,className:`absolute inset-0 w-full h-full object-cover ${b==="user"?"scale-x-[-1]":""}`}),oe.jsx("canvas",{ref:e,className:"absolute inset-0 w-full h-full object-cover pointer-events-none"}),oe.jsx("div",{className:"absolute top-8 left-1/2 transform -translate-x-1/2 bg-black/60 border border-cyan px-4 py-2 rounded text-cyan font-orbitron text-xs backdrop-blur-md",children:d?s==="IDLE"?"MULTI-TARGET TRACKING ACTIVE":"PRIORITY SCAN IN PROGRESS":"LOADING AI CORE..."}),oe.jsxs("div",{className:"absolute bottom-10 z-50 flex gap-4",children:[oe.jsx("button",{onClick:T,className:"w-14 h-14 rounded-full bg-black/60 border border-cyan text-cyan flex items-center justify-center backdrop-blur-md hover:bg-cyan/20 active:scale-90 transition-all",children:oe.jsx("i",{className:"fas fa-sync-alt text-xl"})}),oe.jsx("button",{onClick:h,className:`w-14 h-14 rounded-full border flex items-center justify-center backdrop-blur-md transition-all ${l?"bg-red-500/50 border-red-500 animate-pulse":"bg-black/60 border-cyan text-cyan"}`,children:oe.jsx("i",{className:"fas fa-microphone text-xl"})}),oe.jsx("button",{onClick:()=>{o("click"),r("HOME")},className:"w-14 h-14 rounded-full bg-black/60 border border-red-500 text-red-500 flex items-center justify-center backdrop-blur-md",children:oe.jsx("i",{className:"fas fa-times text-xl"})})]})]})},Iz=()=>{const{setActiveMode:n,speak:e,playSound:t}=Eu(),r=Ke.useRef(null),[i,o]=Ke.useState([]),[s,a]=Ke.useState(-1),[u,l]=Ke.useState(!1),[h,d]=Ke.useState(0),[m,p]=Ke.useState(0),y=C=>{const D=Array.from(C.target.files);if(D.length>0){const z=D.map(L=>({name:L.name.replace(/\.[^/.]+$/,""),url:URL.createObjectURL(L),file:L}));o(L=>[...L,...z]),e(`${D.length} tracks added to database.`),s===-1&&a(i.length)}};Ke.useEffect(()=>{s>=0&&s<i.length&&r.current&&(r.current.src=i[s].url,r.current.play(),l(!0))},[s]);const b=()=>{!r.current||s===-1||(u?r.current.pause():r.current.play(),l(!u))},x=()=>{s<i.length-1?a(C=>C+1):a(0)},E=()=>{s>0&&a(C=>C-1)},T=()=>{r.current&&(d(r.current.currentTime),p(r.current.duration||0))},P=C=>{const D=Math.floor(C/60),z=Math.floor(C%60);return`${D}:${z<10?"0"+z:z}`};return oe.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[oe.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[oe.jsxs("div",{className:"flex items-center gap-3",children:[oe.jsx("i",{className:"fas fa-music text-cyan text-xl animate-pulse"}),oe.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"MEDIA DECK"})]}),oe.jsx("button",{onClick:()=>{t("click"),n("HOME")},className:"text-cyan hover:text-white",children:oe.jsx("i",{className:"fas fa-times text-2xl"})})]}),oe.jsxs("div",{className:"p-6 flex flex-col items-center justify-center border-b border-cyan/10 bg-cyan/5",children:[oe.jsxs("div",{className:"w-32 h-32 rounded-full border-4 border-cyan/30 flex items-center justify-center mb-4 relative",children:[oe.jsx("div",{className:`absolute inset-0 border-t-4 border-cyan rounded-full ${u?"animate-spin":""}`}),oe.jsx("i",{className:"fas fa-compact-disc text-5xl text-cyan/50"})]}),oe.jsx("h3",{className:"text-cyan font-bold text-lg text-center truncate w-full max-w-xs",children:s!==-1?i[s].name:"NO MEDIA LOADED"}),oe.jsxs("p",{className:"text-cyan-dim font-mono text-xs mt-1",children:[P(h)," / ",P(m)]}),oe.jsx("div",{className:"w-full max-w-xs h-1 bg-cyan/20 mt-4 rounded-full overflow-hidden",children:oe.jsx("div",{className:"h-full bg-cyan transition-all duration-300",style:{width:`${h/m*100}%`}})})]}),oe.jsx("div",{className:"flex-1 overflow-y-auto p-4 no-scrollbar",children:i.length===0?oe.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-cyan-dim opacity-50",children:[oe.jsx("i",{className:"fas fa-folder-open text-4xl mb-2"}),oe.jsx("span",{className:"font-mono text-xs",children:"DATABASE EMPTY"})]}):oe.jsx("div",{className:"flex flex-col gap-2",children:i.map((C,D)=>oe.jsxs("button",{onClick:()=>a(D),className:`p-3 text-left font-mono text-sm border rounded flex items-center gap-3 transition-all ${s===D?"border-cyan bg-cyan/20 text-cyan":"border-white/5 text-gray-500 hover:border-cyan/50"}`,children:[oe.jsx("span",{className:"text-xs opacity-50",children:D+1}),oe.jsx("span",{className:"truncate flex-1",children:C.name}),s===D&&oe.jsx("i",{className:"fas fa-volume-up animate-pulse"})]},D))})}),oe.jsxs("div",{className:"p-6 pb-10 border-t border-cyan/30 bg-black flex flex-col gap-4",children:[oe.jsx("input",{type:"file",id:"audio-upload",multiple:!0,accept:"audio/*",className:"hidden",onChange:y}),oe.jsx("button",{onClick:()=>document.getElementById("audio-upload").click(),className:"w-full py-3 border border-dashed border-cyan/50 text-cyan/50 font-mono text-xs hover:bg-cyan/10 hover:text-cyan hover:border-cyan transition-all",children:"+ IMPORT AUDIO FILES"}),oe.jsxs("div",{className:"flex justify-between items-center px-4",children:[oe.jsx("button",{onClick:E,className:"text-cyan hover:text-white active:scale-90",children:oe.jsx("i",{className:"fas fa-step-backward text-2xl"})}),oe.jsx("button",{onClick:b,className:"w-16 h-16 rounded-full bg-cyan text-black flex items-center justify-center shadow-[0_0_20px_#00E5FF] hover:scale-105 active:scale-95 transition-all",children:oe.jsx("i",{className:`fas ${u?"fa-pause":"fa-play"} text-2xl`})}),oe.jsx("button",{onClick:x,className:"text-cyan hover:text-white active:scale-90",children:oe.jsx("i",{className:"fas fa-step-forward text-2xl"})})]})]}),oe.jsx("audio",{ref:r,onTimeUpdate:T,onEnded:x})]})},Tz=()=>{const{faceDatabase:n,deletePerson:e,updatePerson:t,addPerson:r,clearDatabase:i,setActiveMode:o,playSound:s,speak:a}=Eu(),[u,l]=Ke.useState("LIST"),[h,d]=Ke.useState(null),[m,p]=Ke.useState({name:"",gender:"Male",age:"",accessLevel:"No Access"}),[y,b]=Ke.useState(!1),[x,E]=Ke.useState(!1),T=L=>{const I=n[L];p({name:I.name,gender:I.gender||"Male",age:I.age||"",accessLevel:I.accessLevel||"No Access",descriptor:I.descriptor}),b(!!I.descriptor),d(L),l("EDIT")},P=()=>{p({name:"",gender:"Male",age:"",accessLevel:"No Access"}),b(!1),l("ADD")},C=()=>{if(!m.name)return a("Name is required.");u==="ADD"?r(m):t(h,m),l("LIST")},D=async L=>{const I=L.target.files[0];if(I){E(!0),a("Analyzing photo for biometric data...");try{const A="https://justadudewhohacks.github.io/face-api.js/models";await Promise.all([Li.tinyFaceDetector.loadFromUri(A),Li.faceLandmark68Net.loadFromUri(A),Li.faceRecognitionNet.loadFromUri(A),Li.ssdMobilenetv1.loadFromUri(A)]);const O=await J9(I),k=await Sz(O).withFaceLandmarks().withFaceDescriptor();k?(p(M=>({...M,descriptor:k.descriptor})),b(!0),a("Face detected and encoded.")):a("No valid face found in this image.")}catch(A){console.error(A),a("Analysis failed.")}E(!1)}},z=L=>L==="Admin"?"text-green-500 border-green-500/50 bg-green-500/10":L==="Medium"?"text-orange-500 border-orange-500/50 bg-orange-500/10":L==="Missing"?"text-blue-500 border-blue-500/50 bg-blue-500/10":"text-gray-400 border-gray-500/50 bg-gray-500/10";return oe.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[oe.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[oe.jsxs("div",{className:"flex items-center gap-3",children:[oe.jsx("i",{className:"fas fa-database text-cyan text-xl animate-pulse"}),oe.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:u==="LIST"?"IDENTITY RECORDS":u==="ADD"?"NEW ENTRY":"EDIT RECORD"})]}),oe.jsx("button",{onClick:()=>{s("click"),u==="LIST"?o("HOME"):l("LIST")},className:"text-cyan hover:text-white",children:oe.jsx("i",{className:`fas ${u==="LIST"?"fa-times":"fa-arrow-left"} text-2xl`})})]}),u==="LIST"&&oe.jsxs(oe.Fragment,{children:[oe.jsxs("div",{className:"p-4 border-b border-cyan/10 flex justify-between",children:[oe.jsxs("span",{className:"text-cyan-dim font-mono text-xs pt-2",children:["RECORDS: ",n.length]}),oe.jsx("button",{onClick:()=>{s("click"),P()},className:"px-4 py-2 bg-cyan/10 border border-cyan text-cyan font-orbitron text-xs hover:bg-cyan/30",children:"+ ADD MANUAL ENTRY"})]}),oe.jsx("div",{className:"flex-1 overflow-y-auto p-4 no-scrollbar flex flex-col gap-3",children:n.length===0?oe.jsx("div",{className:"text-center text-cyan-dim mt-20 opacity-50",children:"DATABASE EMPTY"}):n.map((L,I)=>oe.jsxs("div",{className:`p-4 border rounded-lg flex justify-between items-center ${z(L.accessLevel)}`,children:[oe.jsxs("div",{className:"flex items-center gap-4",children:[oe.jsx("div",{className:"w-10 h-10 rounded-full border flex items-center justify-center",children:oe.jsx("i",{className:`fas ${L.descriptor?"fa-fingerprint":"fa-user"} text-lg`})}),oe.jsxs("div",{children:[oe.jsx("div",{className:"font-bold",children:L.name.toUpperCase()}),oe.jsxs("div",{className:"text-xs opacity-70",children:[L.gender," | ",L.age," | ",L.accessLevel]})]})]}),oe.jsxs("div",{className:"flex gap-2",children:[oe.jsx("button",{onClick:()=>T(I),className:"w-8 h-8 border rounded hover:bg-white/10",children:oe.jsx("i",{className:"fas fa-pen text-xs"})}),oe.jsx("button",{onClick:()=>e(I),className:"w-8 h-8 border border-red-500/50 text-red-500 hover:bg-red-500/20",children:oe.jsx("i",{className:"fas fa-trash text-xs"})})]})]},I))})]}),u!=="LIST"&&oe.jsxs("div",{className:"flex-1 overflow-y-auto p-6 flex flex-col gap-6",children:[oe.jsxs("div",{className:"p-4 border border-cyan/30 rounded bg-cyan/5 text-center",children:[oe.jsx("div",{className:`w-20 h-20 mx-auto rounded-full border-2 flex items-center justify-center mb-2 ${y?"border-green-500 text-green-500":"border-cyan/30 text-cyan/30"}`,children:x?oe.jsx("i",{className:"fas fa-circle-notch fa-spin text-2xl"}):oe.jsx("i",{className:"fas fa-fingerprint text-3xl"})}),oe.jsx("div",{className:"font-mono text-xs mb-3",children:y?"BIOMETRIC DATA LINKED":"NO BIOMETRIC DATA"}),oe.jsx("input",{type:"file",id:"face-upload",accept:"image/*",className:"hidden",onChange:D}),oe.jsx("button",{onClick:()=>document.getElementById("face-upload").click(),disabled:x,className:"px-4 py-2 border border-cyan text-cyan font-mono text-xs hover:bg-cyan/10",children:y?"UPDATE PHOTO":"UPLOAD PHOTO FOR SCAN"}),oe.jsx("div",{className:"text-[10px] text-cyan-dim mt-2",children:"* Uploading a clear face photo allows JARVIS to recognize this person in the field."})]}),oe.jsxs("div",{className:"flex flex-col gap-4",children:[oe.jsxs("div",{children:[oe.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"FULL NAME"}),oe.jsx("input",{type:"text",value:m.name,onChange:L=>p({...m,name:L.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-orbitron focus:border-cyan outline-none",placeholder:"ENTER NAME"})]}),oe.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[oe.jsxs("div",{children:[oe.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"GENDER"}),oe.jsxs("select",{value:m.gender,onChange:L=>p({...m,gender:L.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-mono outline-none",children:[oe.jsx("option",{value:"Male",children:"MALE"}),oe.jsx("option",{value:"Female",children:"FEMALE"})]})]}),oe.jsxs("div",{children:[oe.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"AGE"}),oe.jsx("input",{type:"number",value:m.age,onChange:L=>p({...m,age:L.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-mono outline-none",placeholder:"00"})]})]}),oe.jsxs("div",{children:[oe.jsx("label",{className:"block text-cyan-dim font-mono text-xs mb-1",children:"ACCESS LEVEL"}),oe.jsxs("select",{value:m.accessLevel,onChange:L=>p({...m,accessLevel:L.target.value}),className:"w-full bg-black border border-cyan/30 p-3 text-cyan font-mono outline-none",children:[oe.jsx("option",{value:"No Access",children:"NO ACCESS (GREY)"}),oe.jsx("option",{value:"Medium",children:"MEDIUM (ORANGE)"}),oe.jsx("option",{value:"Admin",children:"ADMIN (GREEN)"}),oe.jsx("option",{value:"Missing",children:"MISSING PERSON (BLUE)"})]})]})]}),oe.jsx("button",{onClick:C,className:"mt-4 w-full py-4 bg-cyan/20 border border-cyan text-cyan font-bold font-orbitron tracking-widest hover:bg-cyan/40",children:"SAVE RECORD"})]})]})},kz=()=>{const{hudData:n,setActiveMode:e,playSound:t,speak:r,battery:i}=Eu(),[o,s]=Ke.useState(!1),[a,u]=Ke.useState(new Date);Ke.useEffect(()=>{const d=setInterval(()=>u(new Date),1e3);return()=>clearInterval(d)},[]);const l=()=>{s(!o),r(o?"Standard view.":"Heads up display mode active.")},h=d=>d<50?"text-cyan":d<100?"text-cyan-200":d<130?"text-orange-500":"text-red-600 animate-pulse";return oe.jsxs("div",{className:"fixed inset-0 z-30 flex flex-col items-center justify-between p-6 bg-black/10 backdrop-blur-[1px]",children:[oe.jsxs("div",{className:`w-full h-full flex flex-col justify-between relative z-10 transition-transform duration-500 ${o?"scale-x-[-1]":""}`,children:[oe.jsxs("div",{className:"flex justify-between items-start pointer-events-none",children:[oe.jsxs("div",{className:"text-cyan font-mono text-sm bg-black/40 p-2 rounded border border-cyan/20",children:[oe.jsx("div",{className:"border-b border-cyan/50 mb-1 pb-1 text-[10px]",children:"HEADING"}),oe.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(n.heading),""]}),oe.jsx("div",{className:"text-xs opacity-70",children:n.heading>=337||n.heading<23?"N":n.heading<67?"NE":n.heading<112?"E":n.heading<157?"SE":n.heading<202?"S":n.heading<247?"SW":n.heading<292?"W":"NW"})]}),oe.jsxs("div",{className:"text-right text-cyan font-mono bg-black/40 p-2 rounded border border-cyan/20",children:[oe.jsx("div",{className:"text-4xl font-bold",children:a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),oe.jsxs("div",{className:"text-xs",children:["ALT: ",n.altitude,"m"]})]})]}),oe.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center w-full pointer-events-none",children:[oe.jsx("div",{className:`font-orbitron font-black text-[100px] leading-none tracking-tighter drop-shadow-[0_0_10px_rgba(0,0,0,0.8)] ${h(n.speed)}`,children:n.speed}),oe.jsx("div",{className:"text-cyan/70 font-mono text-xl tracking-[8px] mt-2 bg-black/30 inline-block px-4 rounded",children:"KM/H"})]}),oe.jsxs("div",{className:"flex justify-between items-end w-full",children:[oe.jsxs("div",{className:"w-24 h-24 rounded-full border border-cyan/30 flex items-center justify-center relative bg-black/20 backdrop-blur-sm pointer-events-none",children:[oe.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-30 text-4xl text-cyan",children:"+"}),oe.jsx("div",{className:"w-3 h-3 bg-cyan rounded-full shadow-[0_0_10px_#00E5FF]",style:{transform:`translate(${Math.sin(a.getTime()/1e3)*10}px, ${Math.cos(a.getTime()/1e3)*10}px)`}}),oe.jsx("div",{className:"absolute -bottom-6 w-full text-center text-cyan/50 text-[10px]",children:"G-FORCE"})]}),oe.jsxs("button",{onClick:()=>{t("click"),window.open("https://maps.google.com","_blank")},className:"mb-2 bg-cyan/10 border border-cyan text-cyan px-6 py-3 rounded-full font-orbitron text-sm hover:bg-cyan/30 active:scale-95 transition-all shadow-[0_0_15px_rgba(0,229,255,0.2)]",children:[oe.jsx("i",{className:"fas fa-location-arrow mr-2"})," MAPS"]})]})]}),oe.jsxs("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 flex gap-6 z-50",children:[oe.jsx("button",{onClick:l,className:`w-14 h-14 rounded-full border flex items-center justify-center backdrop-blur-md transition-all shadow-[0_0_15px_rgba(0,229,255,0.2)] ${o?"bg-cyan text-black border-cyan":"bg-black/60 border-cyan text-cyan"}`,children:oe.jsx("i",{className:"fas fa-clone text-xl transform rotate-90"})}),oe.jsx("button",{onClick:()=>{t("click"),e("HOME")},className:"w-14 h-14 rounded-full bg-black/60 border border-red-500 text-red-500 flex items-center justify-center backdrop-blur-md shadow-[0_0_15px_rgba(255,0,0,0.3)]",children:oe.jsx("i",{className:"fas fa-times text-xl"})})]})]})},Nz="modulepreload",Rz=function(n){return"/jarvis-mobile/"+n},eA={},t2=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let s=function(l){return Promise.all(l.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=s(t.map(l=>{if(l=Rz(l),l in eA)return;eA[l]=!0;const h=l.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":Nz,h||(m.as="script"),m.crossOrigin="",m.href=l,u&&m.setAttribute("nonce",u),document.head.appendChild(m),h)return new Promise((p,y)=>{m.addEventListener("load",p),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})};function fr(n){"@babel/helpers - typeof";return fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(n)}var xu=Uint8Array,ga=Uint16Array,zx=Int32Array,Wx=new xu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),qx=new xu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),tA=new xu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gk=function(n,e){for(var t=new ga(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new zx(t[30]),r=1;r<30;++r)for(var o=t[r];o<t[r+1];++o)i[o]=o-t[r]<<5|r;return{b:t,r:i}},$k=Gk(Wx,2),Pz=$k.b,_w=$k.r;Pz[28]=258,_w[258]=28;var Dz=Gk(qx,0),nA=Dz.r,Ew=new ga(32768);for(var kr=0;kr<32768;++kr){var Fc=(kr&43690)>>1|(kr&21845)<<1;Fc=(Fc&52428)>>2|(Fc&13107)<<2,Fc=(Fc&61680)>>4|(Fc&3855)<<4,Ew[kr]=((Fc&65280)>>8|(Fc&255)<<8)>>1}var sm=(function(n,e,t){for(var r=n.length,i=0,o=new ga(e);i<r;++i)n[i]&&++o[n[i]-1];var s=new ga(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var a;if(t){a=new ga(1<<e);var u=15-e;for(i=0;i<r;++i)if(n[i])for(var l=i<<4|n[i],h=e-n[i],d=s[n[i]-1]++<<h,m=d|(1<<h)-1;d<=m;++d)a[Ew[d]>>u]=l}else for(a=new ga(r),i=0;i<r;++i)n[i]&&(a[i]=Ew[s[n[i]-1]++]>>15-n[i]);return a}),hf=new xu(288);for(var kr=0;kr<144;++kr)hf[kr]=8;for(var kr=144;kr<256;++kr)hf[kr]=9;for(var kr=256;kr<280;++kr)hf[kr]=7;for(var kr=280;kr<288;++kr)hf[kr]=8;var y0=new xu(32);for(var kr=0;kr<32;++kr)y0[kr]=5;var Lz=sm(hf,9,0),Mz=sm(y0,5,0),Kk=function(n){return(n+7)/8|0},Oz=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new xu(n.subarray(e,t))},ql=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8},zp=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8,n[r+2]|=t>>16},n2=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var i=t.length,o=t.slice();if(!i)return{t:Yk,l:0};if(i==1){var s=new xu(t[0].s+1);return s[t[0].s]=1,{t:s,l:1}}t.sort(function(D,z){return D.f-z.f}),t.push({s:-1,f:25001});var a=t[0],u=t[1],l=0,h=1,d=2;for(t[0]={s:-1,f:a.f+u.f,l:a,r:u};h!=i-1;)a=t[t[l].f<t[d].f?l++:d++],u=t[l!=h&&t[l].f<t[d].f?l++:d++],t[h++]={s:-1,f:a.f+u.f,l:a,r:u};for(var m=o[0].s,r=1;r<i;++r)o[r].s>m&&(m=o[r].s);var p=new ga(m+1),y=Sw(t[h-1],p,0);if(y>e){var r=0,b=0,x=y-e,E=1<<x;for(o.sort(function(z,L){return p[L.s]-p[z.s]||z.f-L.f});r<i;++r){var T=o[r].s;if(p[T]>e)b+=E-(1<<y-p[T]),p[T]=e;else break}for(b>>=x;b>0;){var P=o[r].s;p[P]<e?b-=1<<e-p[P]++-1:++r}for(;r>=0&&b;--r){var C=o[r].s;p[C]==e&&(--p[C],++b)}y=e}return{t:new xu(p),l:y}},Sw=function(n,e,t){return n.s==-1?Math.max(Sw(n.l,e,t+1),Sw(n.r,e,t+1)):e[n.s]=t},rA=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new ga(++e),r=0,i=n[0],o=1,s=function(u){t[r++]=u},a=1;a<=e;++a)if(n[a]==i&&a!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=n[a]}return{c:t.subarray(0,r),n:e}},Wp=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},Xk=function(n,e,t){var r=t.length,i=Kk(e+2);n[i]=r&255,n[i+1]=r>>8,n[i+2]=n[i]^255,n[i+3]=n[i+1]^255;for(var o=0;o<r;++o)n[i+o+4]=t[o];return(i+4+r)*8},iA=function(n,e,t,r,i,o,s,a,u,l,h){ql(e,h++,t),++i[256];for(var d=n2(i,15),m=d.t,p=d.l,y=n2(o,15),b=y.t,x=y.l,E=rA(m),T=E.c,P=E.n,C=rA(b),D=C.c,z=C.n,L=new ga(19),I=0;I<T.length;++I)++L[T[I]&31];for(var I=0;I<D.length;++I)++L[D[I]&31];for(var A=n2(L,7),O=A.t,k=A.l,M=19;M>4&&!O[tA[M-1]];--M);var j=l+5<<3,X=Wp(i,hf)+Wp(o,y0)+s,ue=Wp(i,m)+Wp(o,b)+s+14+3*M+Wp(L,O)+2*L[16]+3*L[17]+7*L[18];if(u>=0&&j<=X&&j<=ue)return Xk(e,h,n.subarray(u,u+l));var ge,ce,$,ae;if(ql(e,h,1+(ue<X)),h+=2,ue<X){ge=sm(m,p,0),ce=m,$=sm(b,x,0),ae=b;var fe=sm(O,k,0);ql(e,h,P-257),ql(e,h+5,z-1),ql(e,h+10,M-4),h+=14;for(var I=0;I<M;++I)ql(e,h+3*I,O[tA[I]]);h+=3*M;for(var Q=[T,D],W=0;W<2;++W)for(var J=Q[W],I=0;I<J.length;++I){var te=J[I]&31;ql(e,h,fe[te]),h+=O[te],te>15&&(ql(e,h,J[I]>>5&127),h+=J[I]>>12)}}else ge=Lz,ce=hf,$=Mz,ae=y0;for(var I=0;I<a;++I){var de=r[I];if(de>255){var te=de>>18&31;zp(e,h,ge[te+257]),h+=ce[te+257],te>7&&(ql(e,h,de>>23&31),h+=Wx[te]);var ve=de&31;zp(e,h,$[ve]),h+=ae[ve],ve>3&&(zp(e,h,de>>5&8191),h+=qx[ve])}else zp(e,h,ge[de]),h+=ce[de]}return zp(e,h,ge[256]),h+ce[256]},Fz=new zx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Yk=new xu(0),Bz=function(n,e,t,r,i,o){var s=o.z||n.length,a=new xu(r+s+5*(1+Math.ceil(s/7e3))+i),u=a.subarray(r,a.length-i),l=o.l,h=(o.r||0)&7;if(e){h&&(u[0]=o.r>>3);for(var d=Fz[e-1],m=d>>13,p=d&8191,y=(1<<t)-1,b=o.p||new ga(32768),x=o.h||new ga(y+1),E=Math.ceil(t/3),T=2*E,P=function(tt){return(n[tt]^n[tt+1]<<E^n[tt+2]<<T)&y},C=new zx(25e3),D=new ga(288),z=new ga(32),L=0,I=0,A=o.i||0,O=0,k=o.w||0,M=0;A+2<s;++A){var j=P(A),X=A&32767,ue=x[j];if(b[X]=ue,x[j]=X,k<=A){var ge=s-A;if((L>7e3||O>24576)&&(ge>423||!l)){h=iA(n,u,0,C,D,z,I,O,M,A-M,h),O=L=I=0,M=A;for(var ce=0;ce<286;++ce)D[ce]=0;for(var ce=0;ce<30;++ce)z[ce]=0}var $=2,ae=0,fe=p,Q=X-ue&32767;if(ge>2&&j==P(A-Q))for(var W=Math.min(m,ge)-1,J=Math.min(32767,A),te=Math.min(258,ge);Q<=J&&--fe&&X!=ue;){if(n[A+$]==n[A+$-Q]){for(var de=0;de<te&&n[A+de]==n[A+de-Q];++de);if(de>$){if($=de,ae=Q,de>W)break;for(var ve=Math.min(Q,de-2),we=0,ce=0;ce<ve;++ce){var Se=A-Q+ce&32767,Ie=b[Se],Fe=Se-Ie&32767;Fe>we&&(we=Fe,ue=Se)}}}X=ue,ue=b[X],Q+=X-ue&32767}if(ae){C[O++]=268435456|_w[$]<<18|nA[ae];var Ae=_w[$]&31,Be=nA[ae]&31;I+=Wx[Ae]+qx[Be],++D[257+Ae],++z[Be],k=A+$,++L}else C[O++]=n[A],++D[n[A]]}}for(A=Math.max(A,k);A<s;++A)C[O++]=n[A],++D[n[A]];h=iA(n,u,l,C,D,z,I,O,M,A-M,h),l||(o.r=h&7|u[h/8|0]<<3,h-=7,o.h=x,o.p=b,o.i=A,o.w=k)}else{for(var A=o.w||0;A<s+l;A+=65535){var Le=A+65535;Le>=s&&(u[h/8|0]=l,Le=s),h=Xk(u,h+1,n.subarray(A,Le))}o.i=s}return Oz(a,0,r+Kk(h)+i)},Qk=function(){var n=1,e=0;return{p:function(t){for(var r=n,i=e,o=t.length|0,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)i+=r+=t[s];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}n=r,e=i},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},Vz=function(n,e,t,r,i){if(!i&&(i={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new xu(o.length+n.length);s.set(o),s.set(n,o.length),n=s,i.w=o.length}return Bz(n,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,r,i)},Jk=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},jz=function(n,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=r<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var i=Qk();i.p(e.dictionary),Jk(n,2,i.d())}};function Aw(n,e){e||(e={});var t=Qk();t.p(n);var r=Vz(n,e,e.dictionary?6:2,4);return jz(r,e),Jk(r,r.length-4,t.d()),r}var Uz=typeof TextDecoder<"u"&&new TextDecoder,zz=0;try{Uz.decode(Yk,{stream:!0}),zz=1}catch{}function Wz(n){if(Array.isArray(n))return n}function qz(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,o,s,a=[],u=!0,l=!1;try{if(o=(t=t.call(n)).next,e!==0)for(;!(u=(r=o.call(t)).done)&&(a.push(r.value),a.length!==e);u=!0);}catch(h){l=!0,i=h}finally{try{if(!u&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(l)throw i}}return a}}function oA(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function Hz(n,e){if(n){if(typeof n=="string")return oA(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?oA(n,e):void 0}}function Gz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sA(n,e){return Wz(n)||qz(n,e)||Hz(n,e)||Gz()}function aA(n,e="utf8"){return new TextDecoder(e).decode(n)}const $z=new TextEncoder;function Kz(n){return $z.encode(n)}const Xz=1024*8,Yz=(()=>{const n=new Uint8Array(4),e=new Uint32Array(n.buffer);return!((e[0]=1)&n[0])})(),r2={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Hx{constructor(e=Xz,t={}){hr(this,"buffer");hr(this,"byteLength");hr(this,"byteOffset");hr(this,"length");hr(this,"offset");hr(this,"lastWrittenByte");hr(this,"littleEndian");hr(this,"_data");hr(this,"_mark");hr(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const i=t.offset?t.offset>>>0:0,o=e.byteLength-i;let s=i;(ArrayBuffer.isView(e)||e instanceof Hx)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+i),e=e.buffer),r?this.lastWrittenByte=o:this.lastWrittenByte=0,this.buffer=e,this.length=o,this.byteLength=o,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,o),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const r=r2[t].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,o=this.buffer.slice(i,i+r);if(this.littleEndian===Yz&&t!=="uint8"&&t!=="int8"){const a=new Uint8Array(this.buffer.slice(i,i+r));a.reverse();const u=new r2[t](a.buffer);return this.offset+=r,u.reverse(),u}const s=new r2[t](o);return this.offset+=r,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let r=0;r<e;r++)t+=this.readChar();return t}readUtf8(e=1){return aA(this.readBytes(e))}decodeText(e=1,t="utf8"){return aA(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(Kz(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function ip(n){let e=n.length;for(;--e>=0;)n[e]=0}const Qz=3,Jz=258,Zk=29,Zz=256,eW=Zz+1+Zk,eN=30,tW=512,nW=new Array((eW+2)*2);ip(nW);const rW=new Array(eN*2);ip(rW);const iW=new Array(tW);ip(iW);const oW=new Array(Jz-Qz+1);ip(oW);const sW=new Array(Zk);ip(sW);const aW=new Array(eN);ip(aW);const uW=(n,e,t,r)=>{let i=n&65535|0,o=n>>>16&65535|0,s=0;for(;t!==0;){s=t>2e3?2e3:t,t-=s;do i=i+e[r++]|0,o=o+i|0;while(--s);i%=65521,o%=65521}return i|o<<16|0};var Cw=uW;const lW=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},cW=new Uint32Array(lW()),hW=(n,e,t,r)=>{const i=cW,o=r+t;n^=-1;for(let s=r;s<o;s++)n=n>>>8^i[(n^e[s])&255];return n^-1};var Xu=hW,Iw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},tN={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const fW=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var dW=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const r in t)fW(t,r)&&(n[r]=t[r])}}return n},pW=n=>{let e=0;for(let r=0,i=n.length;r<i;r++)e+=n[r].length;const t=new Uint8Array(e);for(let r=0,i=0,o=n.length;r<o;r++){let s=n[r];t.set(s,i),i+=s.length}return t},nN={assign:dW,flattenChunks:pW};let rN=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{rN=!1}const Tm=new Uint8Array(256);for(let n=0;n<256;n++)Tm[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Tm[254]=Tm[254]=1;var mW=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,r,i,o,s=n.length,a=0;for(i=0;i<s;i++)t=n.charCodeAt(i),(t&64512)===55296&&i+1<s&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),o=0,i=0;o<a;i++)t=n.charCodeAt(i),(t&64512)===55296&&i+1<s&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),t<128?e[o++]=t:t<2048?(e[o++]=192|t>>>6,e[o++]=128|t&63):t<65536?(e[o++]=224|t>>>12,e[o++]=128|t>>>6&63,e[o++]=128|t&63):(e[o++]=240|t>>>18,e[o++]=128|t>>>12&63,e[o++]=128|t>>>6&63,e[o++]=128|t&63);return e};const gW=(n,e)=>{if(e<65534&&n.subarray&&rN)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let r=0;r<e;r++)t+=String.fromCharCode(n[r]);return t};var vW=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let r,i;const o=new Array(t*2);for(i=0,r=0;r<t;){let s=n[r++];if(s<128){o[i++]=s;continue}let a=Tm[s];if(a>4){o[i++]=65533,r+=a-1;continue}for(s&=a===2?31:a===3?15:7;a>1&&r<t;)s=s<<6|n[r++]&63,a--;if(a>1){o[i++]=65533;continue}s<65536?o[i++]=s:(s-=65536,o[i++]=55296|s>>10&1023,o[i++]=56320|s&1023)}return gW(o,i)},yW=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+Tm[n[t]]>e?t:e},Tw={string2buf:mW,buf2string:vW,utf8border:yW};function wW(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var bW=wW;const uv=16209,xW=16191;var _W=function(e,t){let r,i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,C,D,z,L,I,A,O;const k=e.state;r=e.next_in,A=e.input,i=r+(e.avail_in-5),o=e.next_out,O=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),u=k.dmax,l=k.wsize,h=k.whave,d=k.wnext,m=k.window,p=k.hold,y=k.bits,b=k.lencode,x=k.distcode,E=(1<<k.lenbits)-1,T=(1<<k.distbits)-1;e:do{y<15&&(p+=A[r++]<<y,y+=8,p+=A[r++]<<y,y+=8),P=b[p&E];t:for(;;){if(C=P>>>24,p>>>=C,y-=C,C=P>>>16&255,C===0)O[o++]=P&65535;else if(C&16){D=P&65535,C&=15,C&&(y<C&&(p+=A[r++]<<y,y+=8),D+=p&(1<<C)-1,p>>>=C,y-=C),y<15&&(p+=A[r++]<<y,y+=8,p+=A[r++]<<y,y+=8),P=x[p&T];n:for(;;){if(C=P>>>24,p>>>=C,y-=C,C=P>>>16&255,C&16){if(z=P&65535,C&=15,y<C&&(p+=A[r++]<<y,y+=8,y<C&&(p+=A[r++]<<y,y+=8)),z+=p&(1<<C)-1,z>u){e.msg="invalid distance too far back",k.mode=uv;break e}if(p>>>=C,y-=C,C=o-s,z>C){if(C=z-C,C>h&&k.sane){e.msg="invalid distance too far back",k.mode=uv;break e}if(L=0,I=m,d===0){if(L+=l-C,C<D){D-=C;do O[o++]=m[L++];while(--C);L=o-z,I=O}}else if(d<C){if(L+=l+d-C,C-=d,C<D){D-=C;do O[o++]=m[L++];while(--C);if(L=0,d<D){C=d,D-=C;do O[o++]=m[L++];while(--C);L=o-z,I=O}}}else if(L+=d-C,C<D){D-=C;do O[o++]=m[L++];while(--C);L=o-z,I=O}for(;D>2;)O[o++]=I[L++],O[o++]=I[L++],O[o++]=I[L++],D-=3;D&&(O[o++]=I[L++],D>1&&(O[o++]=I[L++]))}else{L=o-z;do O[o++]=O[L++],O[o++]=O[L++],O[o++]=O[L++],D-=3;while(D>2);D&&(O[o++]=O[L++],D>1&&(O[o++]=O[L++]))}}else if((C&64)===0){P=x[(P&65535)+(p&(1<<C)-1)];continue n}else{e.msg="invalid distance code",k.mode=uv;break e}break}}else if((C&64)===0){P=b[(P&65535)+(p&(1<<C)-1)];continue t}else if(C&32){k.mode=xW;break e}else{e.msg="invalid literal/length code",k.mode=uv;break e}break}}while(r<i&&o<a);D=y>>3,r-=D,y-=D<<3,p&=(1<<y)-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=o<a?257+(a-o):257-(o-a),k.hold=p,k.bits=y};const Zf=15,uA=852,lA=592,cA=0,i2=1,hA=2,EW=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),SW=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),AW=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),CW=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),IW=(n,e,t,r,i,o,s,a)=>{const u=a.bits;let l=0,h=0,d=0,m=0,p=0,y=0,b=0,x=0,E=0,T=0,P,C,D,z,L,I=null,A;const O=new Uint16Array(Zf+1),k=new Uint16Array(Zf+1);let M=null,j,X,ue;for(l=0;l<=Zf;l++)O[l]=0;for(h=0;h<r;h++)O[e[t+h]]++;for(p=u,m=Zf;m>=1&&O[m]===0;m--);if(p>m&&(p=m),m===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<m&&O[d]===0;d++);for(p<d&&(p=d),x=1,l=1;l<=Zf;l++)if(x<<=1,x-=O[l],x<0)return-1;if(x>0&&(n===cA||m!==1))return-1;for(k[1]=0,l=1;l<Zf;l++)k[l+1]=k[l]+O[l];for(h=0;h<r;h++)e[t+h]!==0&&(s[k[e[t+h]]++]=h);if(n===cA?(I=M=s,A=20):n===i2?(I=EW,M=SW,A=257):(I=AW,M=CW,A=0),T=0,h=0,l=d,L=o,y=p,b=0,D=-1,E=1<<p,z=E-1,n===i2&&E>uA||n===hA&&E>lA)return 1;for(;;){j=l-b,s[h]+1<A?(X=0,ue=s[h]):s[h]>=A?(X=M[s[h]-A],ue=I[s[h]-A]):(X=96,ue=0),P=1<<l-b,C=1<<y,d=C;do C-=P,i[L+(T>>b)+C]=j<<24|X<<16|ue|0;while(C!==0);for(P=1<<l-1;T&P;)P>>=1;if(P!==0?(T&=P-1,T+=P):T=0,h++,--O[l]===0){if(l===m)break;l=e[t+s[h]]}if(l>p&&(T&z)!==D){for(b===0&&(b=p),L+=d,y=l-b,x=1<<y;y+b<m&&(x-=O[y+b],!(x<=0));)y++,x<<=1;if(E+=1<<y,n===i2&&E>uA||n===hA&&E>lA)return 1;D=T&z,i[D]=p<<24|y<<16|L-o|0}}return T!==0&&(i[L+T]=l-b<<24|64<<16|0),a.bits=p,0};var am=IW;const TW=0,iN=1,oN=2,{Z_FINISH:fA,Z_BLOCK:kW,Z_TREES:lv,Z_OK:ff,Z_STREAM_END:NW,Z_NEED_DICT:RW,Z_STREAM_ERROR:Ga,Z_DATA_ERROR:sN,Z_MEM_ERROR:aN,Z_BUF_ERROR:PW,Z_DEFLATED:dA}=tN,o1=16180,pA=16181,mA=16182,gA=16183,vA=16184,yA=16185,wA=16186,bA=16187,xA=16188,_A=16189,w0=16190,Hl=16191,o2=16192,EA=16193,s2=16194,SA=16195,AA=16196,CA=16197,IA=16198,cv=16199,hv=16200,TA=16201,kA=16202,NA=16203,RA=16204,PA=16205,a2=16206,DA=16207,LA=16208,Br=16209,uN=16210,lN=16211,DW=852,LW=592,MW=15,OW=MW,MA=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function FW(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ef=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<o1||e.mode>lN?1:0},cN=n=>{if(Ef(n))return Ga;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=o1,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(DW),e.distcode=e.distdyn=new Int32Array(LW),e.sane=1,e.back=-1,ff},hN=n=>{if(Ef(n))return Ga;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,cN(n)},fN=(n,e)=>{let t;if(Ef(n))return Ga;const r=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Ga:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=t,r.wbits=e,hN(n))},dN=(n,e)=>{if(!n)return Ga;const t=new FW;n.state=t,t.strm=n,t.window=null,t.mode=o1;const r=fN(n,e);return r!==ff&&(n.state=null),r},BW=n=>dN(n,OW);let OA=!0,u2,l2;const VW=n=>{if(OA){u2=new Int32Array(512),l2=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(am(iN,n.lens,0,288,u2,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;am(oN,n.lens,0,32,l2,0,n.work,{bits:5}),OA=!1}n.lencode=u2,n.lenbits=9,n.distcode=l2,n.distbits=5},pN=(n,e,t,r)=>{let i;const o=n.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),r>=o.wsize?(o.window.set(e.subarray(t-o.wsize,t),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>r&&(i=r),o.window.set(e.subarray(t-r,t-r+i),o.wnext),r-=i,r?(o.window.set(e.subarray(t-r,t),0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},jW=(n,e)=>{let t,r,i,o,s,a,u,l,h,d,m,p,y,b,x=0,E,T,P,C,D,z,L,I;const A=new Uint8Array(4);let O,k;const M=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ef(n)||!n.output||!n.input&&n.avail_in!==0)return Ga;t=n.state,t.mode===Hl&&(t.mode=o2),s=n.next_out,i=n.output,u=n.avail_out,o=n.next_in,r=n.input,a=n.avail_in,l=t.hold,h=t.bits,d=a,m=u,I=ff;e:for(;;)switch(t.mode){case o1:if(t.wrap===0){t.mode=o2;break}for(;h<16;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(t.wrap&2&&l===35615){t.wbits===0&&(t.wbits=15),t.check=0,A[0]=l&255,A[1]=l>>>8&255,t.check=Xu(t.check,A,2,0),l=0,h=0,t.mode=pA;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){n.msg="incorrect header check",t.mode=Br;break}if((l&15)!==dA){n.msg="unknown compression method",t.mode=Br;break}if(l>>>=4,h-=4,L=(l&15)+8,t.wbits===0&&(t.wbits=L),L>15||L>t.wbits){n.msg="invalid window size",t.mode=Br;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=l&512?_A:Hl,l=0,h=0;break;case pA:for(;h<16;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(t.flags=l,(t.flags&255)!==dA){n.msg="unknown compression method",t.mode=Br;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=Br;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&t.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,t.check=Xu(t.check,A,2,0)),l=0,h=0,t.mode=mA;case mA:for(;h<32;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.head&&(t.head.time=l),t.flags&512&&t.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,A[2]=l>>>16&255,A[3]=l>>>24&255,t.check=Xu(t.check,A,4,0)),l=0,h=0,t.mode=gA;case gA:for(;h<16;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&t.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,t.check=Xu(t.check,A,2,0)),l=0,h=0,t.mode=vA;case vA:if(t.flags&1024){for(;h<16;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&t.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,t.check=Xu(t.check,A,2,0)),l=0,h=0}else t.head&&(t.head.extra=null);t.mode=yA;case yA:if(t.flags&1024&&(p=t.length,p>a&&(p=a),p&&(t.head&&(L=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(r.subarray(o,o+p),L)),t.flags&512&&t.wrap&4&&(t.check=Xu(t.check,r,p,o)),a-=p,o+=p,t.length-=p),t.length))break e;t.length=0,t.mode=wA;case wA:if(t.flags&2048){if(a===0)break e;p=0;do L=r[o+p++],t.head&&L&&t.length<65536&&(t.head.name+=String.fromCharCode(L));while(L&&p<a);if(t.flags&512&&t.wrap&4&&(t.check=Xu(t.check,r,p,o)),a-=p,o+=p,L)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=bA;case bA:if(t.flags&4096){if(a===0)break e;p=0;do L=r[o+p++],t.head&&L&&t.length<65536&&(t.head.comment+=String.fromCharCode(L));while(L&&p<a);if(t.flags&512&&t.wrap&4&&(t.check=Xu(t.check,r,p,o)),a-=p,o+=p,L)break e}else t.head&&(t.head.comment=null);t.mode=xA;case xA:if(t.flags&512){for(;h<16;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(t.wrap&4&&l!==(t.check&65535)){n.msg="header crc mismatch",t.mode=Br;break}l=0,h=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=Hl;break;case _A:for(;h<32;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}n.adler=t.check=MA(l),l=0,h=0,t.mode=w0;case w0:if(t.havedict===0)return n.next_out=s,n.avail_out=u,n.next_in=o,n.avail_in=a,t.hold=l,t.bits=h,RW;n.adler=t.check=1,t.mode=Hl;case Hl:if(e===kW||e===lv)break e;case o2:if(t.last){l>>>=h&7,h-=h&7,t.mode=a2;break}for(;h<3;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}switch(t.last=l&1,l>>>=1,h-=1,l&3){case 0:t.mode=EA;break;case 1:if(VW(t),t.mode=cv,e===lv){l>>>=2,h-=2;break e}break;case 2:t.mode=AA;break;case 3:n.msg="invalid block type",t.mode=Br}l>>>=2,h-=2;break;case EA:for(l>>>=h&7,h-=h&7;h<32;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if((l&65535)!==(l>>>16^65535)){n.msg="invalid stored block lengths",t.mode=Br;break}if(t.length=l&65535,l=0,h=0,t.mode=s2,e===lv)break e;case s2:t.mode=SA;case SA:if(p=t.length,p){if(p>a&&(p=a),p>u&&(p=u),p===0)break e;i.set(r.subarray(o,o+p),s),a-=p,o+=p,u-=p,s+=p,t.length-=p;break}t.mode=Hl;break;case AA:for(;h<14;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(t.nlen=(l&31)+257,l>>>=5,h-=5,t.ndist=(l&31)+1,l>>>=5,h-=5,t.ncode=(l&15)+4,l>>>=4,h-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=Br;break}t.have=0,t.mode=CA;case CA:for(;t.have<t.ncode;){for(;h<3;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.lens[M[t.have++]]=l&7,l>>>=3,h-=3}for(;t.have<19;)t.lens[M[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,O={bits:t.lenbits},I=am(TW,t.lens,0,19,t.lencode,0,t.work,O),t.lenbits=O.bits,I){n.msg="invalid code lengths set",t.mode=Br;break}t.have=0,t.mode=IA;case IA:for(;t.have<t.nlen+t.ndist;){for(;x=t.lencode[l&(1<<t.lenbits)-1],E=x>>>24,T=x>>>16&255,P=x&65535,!(E<=h);){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(P<16)l>>>=E,h-=E,t.lens[t.have++]=P;else{if(P===16){for(k=E+2;h<k;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(l>>>=E,h-=E,t.have===0){n.msg="invalid bit length repeat",t.mode=Br;break}L=t.lens[t.have-1],p=3+(l&3),l>>>=2,h-=2}else if(P===17){for(k=E+3;h<k;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}l>>>=E,h-=E,L=0,p=3+(l&7),l>>>=3,h-=3}else{for(k=E+7;h<k;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}l>>>=E,h-=E,L=0,p=11+(l&127),l>>>=7,h-=7}if(t.have+p>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=Br;break}for(;p--;)t.lens[t.have++]=L}}if(t.mode===Br)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=Br;break}if(t.lenbits=9,O={bits:t.lenbits},I=am(iN,t.lens,0,t.nlen,t.lencode,0,t.work,O),t.lenbits=O.bits,I){n.msg="invalid literal/lengths set",t.mode=Br;break}if(t.distbits=6,t.distcode=t.distdyn,O={bits:t.distbits},I=am(oN,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,O),t.distbits=O.bits,I){n.msg="invalid distances set",t.mode=Br;break}if(t.mode=cv,e===lv)break e;case cv:t.mode=hv;case hv:if(a>=6&&u>=258){n.next_out=s,n.avail_out=u,n.next_in=o,n.avail_in=a,t.hold=l,t.bits=h,_W(n,m),s=n.next_out,i=n.output,u=n.avail_out,o=n.next_in,r=n.input,a=n.avail_in,l=t.hold,h=t.bits,t.mode===Hl&&(t.back=-1);break}for(t.back=0;x=t.lencode[l&(1<<t.lenbits)-1],E=x>>>24,T=x>>>16&255,P=x&65535,!(E<=h);){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(T&&(T&240)===0){for(C=E,D=T,z=P;x=t.lencode[z+((l&(1<<C+D)-1)>>C)],E=x>>>24,T=x>>>16&255,P=x&65535,!(C+E<=h);){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}l>>>=C,h-=C,t.back+=C}if(l>>>=E,h-=E,t.back+=E,t.length=P,T===0){t.mode=PA;break}if(T&32){t.back=-1,t.mode=Hl;break}if(T&64){n.msg="invalid literal/length code",t.mode=Br;break}t.extra=T&15,t.mode=TA;case TA:if(t.extra){for(k=t.extra;h<k;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,h-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=kA;case kA:for(;x=t.distcode[l&(1<<t.distbits)-1],E=x>>>24,T=x>>>16&255,P=x&65535,!(E<=h);){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if((T&240)===0){for(C=E,D=T,z=P;x=t.distcode[z+((l&(1<<C+D)-1)>>C)],E=x>>>24,T=x>>>16&255,P=x&65535,!(C+E<=h);){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}l>>>=C,h-=C,t.back+=C}if(l>>>=E,h-=E,t.back+=E,T&64){n.msg="invalid distance code",t.mode=Br;break}t.offset=P,t.extra=T&15,t.mode=NA;case NA:if(t.extra){for(k=t.extra;h<k;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,h-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=Br;break}t.mode=RA;case RA:if(u===0)break e;if(p=m-u,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=Br;break}p>t.wnext?(p-=t.wnext,y=t.wsize-p):y=t.wnext-p,p>t.length&&(p=t.length),b=t.window}else b=i,y=s-t.offset,p=t.length;p>u&&(p=u),u-=p,t.length-=p;do i[s++]=b[y++];while(--p);t.length===0&&(t.mode=hv);break;case PA:if(u===0)break e;i[s++]=t.length,u--,t.mode=hv;break;case a2:if(t.wrap){for(;h<32;){if(a===0)break e;a--,l|=r[o++]<<h,h+=8}if(m-=u,n.total_out+=m,t.total+=m,t.wrap&4&&m&&(n.adler=t.check=t.flags?Xu(t.check,i,m,s-m):Cw(t.check,i,m,s-m)),m=u,t.wrap&4&&(t.flags?l:MA(l))!==t.check){n.msg="incorrect data check",t.mode=Br;break}l=0,h=0}t.mode=DA;case DA:if(t.wrap&&t.flags){for(;h<32;){if(a===0)break e;a--,l+=r[o++]<<h,h+=8}if(t.wrap&4&&l!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=Br;break}l=0,h=0}t.mode=LA;case LA:I=NW;break e;case Br:I=sN;break e;case uN:return aN;case lN:default:return Ga}return n.next_out=s,n.avail_out=u,n.next_in=o,n.avail_in=a,t.hold=l,t.bits=h,(t.wsize||m!==n.avail_out&&t.mode<Br&&(t.mode<a2||e!==fA))&&pN(n,n.output,n.next_out,m-n.avail_out),d-=n.avail_in,m-=n.avail_out,n.total_in+=d,n.total_out+=m,t.total+=m,t.wrap&4&&m&&(n.adler=t.check=t.flags?Xu(t.check,i,m,n.next_out-m):Cw(t.check,i,m,n.next_out-m)),n.data_type=t.bits+(t.last?64:0)+(t.mode===Hl?128:0)+(t.mode===cv||t.mode===s2?256:0),(d===0&&m===0||e===fA)&&I===ff&&(I=PW),I},UW=n=>{if(Ef(n))return Ga;let e=n.state;return e.window&&(e.window=null),n.state=null,ff},zW=(n,e)=>{if(Ef(n))return Ga;const t=n.state;return(t.wrap&2)===0?Ga:(t.head=e,e.done=!1,ff)},WW=(n,e)=>{const t=e.length;let r,i,o;return Ef(n)||(r=n.state,r.wrap!==0&&r.mode!==w0)?Ga:r.mode===w0&&(i=1,i=Cw(i,e,t,0),i!==r.check)?sN:(o=pN(n,e,t,t),o?(r.mode=uN,aN):(r.havedict=1,ff))};var qW=hN,HW=fN,GW=cN,$W=BW,KW=dN,XW=jW,YW=UW,QW=zW,JW=WW,ZW="pako inflate (from Nodeca project)",$l={inflateReset:qW,inflateReset2:HW,inflateResetKeep:GW,inflateInit:$W,inflateInit2:KW,inflate:XW,inflateEnd:YW,inflateGetHeader:QW,inflateSetDictionary:JW,inflateInfo:ZW};function eq(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var tq=eq;const mN=Object.prototype.toString,{Z_NO_FLUSH:nq,Z_FINISH:rq,Z_OK:km,Z_STREAM_END:c2,Z_NEED_DICT:h2,Z_STREAM_ERROR:iq,Z_DATA_ERROR:FA,Z_MEM_ERROR:oq}=tN;function Jm(n){this.options=nN.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new bW,this.strm.avail_out=0;let t=$l.inflateInit2(this.strm,e.windowBits);if(t!==km)throw new Error(Iw[t]);if(this.header=new tq,$l.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Tw.string2buf(e.dictionary):mN.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=$l.inflateSetDictionary(this.strm,e.dictionary),t!==km)))throw new Error(Iw[t])}Jm.prototype.push=function(n,e){const t=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?rq:nq,mN.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),o=$l.inflate(t,s),o===h2&&i&&(o=$l.inflateSetDictionary(t,i),o===km?o=$l.inflate(t,s):o===FA&&(o=h2));t.avail_in>0&&o===c2&&t.state.wrap>0&&n[t.next_in]!==0;)$l.inflateReset(t),o=$l.inflate(t,s);switch(o){case iq:case FA:case h2:case oq:return this.onEnd(o),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||o===c2))if(this.options.to==="string"){let u=Tw.utf8border(t.output,t.next_out),l=t.next_out-u,h=Tw.buf2string(t.output,u);t.next_out=l,t.avail_out=r-l,l&&t.output.set(t.output.subarray(u,u+l),0),this.onData(h)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(o===km&&a===0)){if(o===c2)return o=$l.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Jm.prototype.onData=function(n){this.chunks.push(n)};Jm.prototype.onEnd=function(n){n===km&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=nN.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function sq(n,e){const t=new Jm(e);if(t.push(n),t.err)throw t.msg||Iw[t.err];return t.result}var aq=Jm,uq=sq,lq={Inflate:aq,inflate:uq};const{Inflate:cq,inflate:hq}=lq;var BA=cq,fq=hq;const gN=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;gN[n]=e}const VA=4294967295;function dq(n,e,t){let r=n;for(let i=0;i<t;i++)r=gN[(r^e[i])&255]^r>>>8;return r}function pq(n,e){return(dq(VA,n,e)^VA)>>>0}function jA(n,e,t){const r=n.readUint32(),i=pq(new Uint8Array(n.buffer,n.byteOffset+n.offset-e-4,e),e);if(i!==r)throw new Error(`CRC mismatch for chunk ${t}. Expected ${r}, found ${i}`)}function vN(n,e,t){for(let r=0;r<t;r++)e[r]=n[r]}function yN(n,e,t,r){let i=0;for(;i<r;i++)e[i]=n[i];for(;i<t;i++)e[i]=n[i]+e[i-r]&255}function wN(n,e,t,r){let i=0;if(t.length===0)for(;i<r;i++)e[i]=n[i];else for(;i<r;i++)e[i]=n[i]+t[i]&255}function bN(n,e,t,r,i){let o=0;if(t.length===0){for(;o<i;o++)e[o]=n[o];for(;o<r;o++)e[o]=n[o]+(e[o-i]>>1)&255}else{for(;o<i;o++)e[o]=n[o]+(t[o]>>1)&255;for(;o<r;o++)e[o]=n[o]+(e[o-i]+t[o]>>1)&255}}function xN(n,e,t,r,i){let o=0;if(t.length===0){for(;o<i;o++)e[o]=n[o];for(;o<r;o++)e[o]=n[o]+e[o-i]&255}else{for(;o<i;o++)e[o]=n[o]+t[o]&255;for(;o<r;o++)e[o]=n[o]+mq(e[o-i],t[o],t[o-i])&255}}function mq(n,e,t){const r=n+e-t,i=Math.abs(r-n),o=Math.abs(r-e),s=Math.abs(r-t);return i<=o&&i<=s?n:o<=s?e:t}function gq(n,e,t,r,i,o){switch(n){case 0:vN(e,t,i);break;case 1:yN(e,t,i,o);break;case 2:wN(e,t,r,i);break;case 3:bN(e,t,r,i,o);break;case 4:xN(e,t,r,i,o);break;default:throw new Error(`Unsupported filter: ${n}`)}}const vq=new Uint16Array([255]),yq=new Uint8Array(vq.buffer),wq=yq[0]===255;function bq(n){const{data:e,width:t,height:r,channels:i,depth:o}=n,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],a=Math.ceil(o/8)*i,u=new Uint8Array(r*t*a);let l=0;for(let h=0;h<7;h++){const d=s[h],m=Math.ceil((t-d.x)/d.xStep),p=Math.ceil((r-d.y)/d.yStep);if(m<=0||p<=0)continue;const y=m*a,b=new Uint8Array(y);for(let x=0;x<p;x++){const E=e[l++],T=e.subarray(l,l+y);l+=y;const P=new Uint8Array(y);gq(E,T,P,b,y,a),b.set(P);for(let C=0;C<m;C++){const D=d.x+C*d.xStep,z=d.y+x*d.yStep;if(!(D>=t||z>=r))for(let L=0;L<a;L++)u[(z*t+D)*a+L]=P[C*a+L]}}}if(o===16){const h=new Uint16Array(u.buffer);if(wq)for(let d=0;d<h.length;d++)h[d]=xq(h[d]);return h}else return u}function xq(n){return(n&255)<<8|n>>8&255}const _q=new Uint16Array([255]),Eq=new Uint8Array(_q.buffer),Sq=Eq[0]===255,Aq=new Uint8Array(0);function UA(n){const{data:e,width:t,height:r,channels:i,depth:o}=n,s=Math.ceil(o/8)*i,a=Math.ceil(o/8*i*t),u=new Uint8Array(r*a);let l=Aq,h=0,d,m;for(let p=0;p<r;p++){switch(d=e.subarray(h+1,h+1+a),m=u.subarray(p*a,(p+1)*a),e[h]){case 0:vN(d,m,a);break;case 1:yN(d,m,a,s);break;case 2:wN(d,m,l,a);break;case 3:bN(d,m,l,a,s);break;case 4:xN(d,m,l,a,s);break;default:throw new Error(`Unsupported filter: ${e[h]}`)}l=m,h+=a+1}if(o===16){const p=new Uint16Array(u.buffer);if(Sq)for(let y=0;y<p.length;y++)p[y]=Cq(p[y]);return p}else return u}function Cq(n){return(n&255)<<8|n>>8&255}const Iv=Uint8Array.of(137,80,78,71,13,10,26,10);function zA(n){if(!Iq(n.readBytes(Iv.length)))throw new Error("wrong PNG signature")}function Iq(n){if(n.length<Iv.length)return!1;for(let e=0;e<Iv.length;e++)if(n[e]!==Iv[e])return!1;return!0}const Tq="tEXt",kq=0,_N=new TextDecoder("latin1");function Nq(n){if(Pq(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const Rq=/^[\u0000-\u00FF]*$/;function Pq(n){if(!Rq.test(n))throw new Error("invalid latin1 text")}function Dq(n,e,t){const r=EN(e);n[r]=Lq(e,t-r.length-1)}function EN(n){for(n.mark();n.readByte()!==kq;);const e=n.offset;n.reset();const t=_N.decode(n.readBytes(e-n.offset-1));return n.skip(1),Nq(t),t}function Lq(n,e){return _N.decode(n.readBytes(e))}const ca={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},f2={UNKNOWN:-1,DEFLATE:0},WA={UNKNOWN:-1,ADAPTIVE:0},d2={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},fv={NONE:0,BACKGROUND:1,PREVIOUS:2},p2={SOURCE:0,OVER:1};class Mq extends Hx{constructor(t,r={}){super(t);hr(this,"_checkCrc");hr(this,"_inflator");hr(this,"_png");hr(this,"_apng");hr(this,"_end");hr(this,"_hasPalette");hr(this,"_palette");hr(this,"_hasTransparency");hr(this,"_transparency");hr(this,"_compressionMethod");hr(this,"_filterMethod");hr(this,"_interlaceMethod");hr(this,"_colorType");hr(this,"_isAnimated");hr(this,"_numberOfFrames");hr(this,"_numberOfPlays");hr(this,"_frames");hr(this,"_writingDataChunks");const{checkCrc:i=!1}=r;this._checkCrc=i,this._inflator=new BA,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=f2.UNKNOWN,this._filterMethod=WA.UNKNOWN,this._interlaceMethod=d2.UNKNOWN,this._colorType=ca.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(zA(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeChunk(t,r)}return this.decodeImage(),this._png}decodeApng(){for(zA(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(t,r)}return this.decodeApngImage(),this._apng}decodeChunk(t,r){const i=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case Tq:Dq(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-i!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?jA(this,t+4,r):this.skip(4)}decodeApngChunk(t,r){const i=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,r),this.offset=i+t;break}if(this.offset-i!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?jA(this,t+4,r):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=Oq(this.readUint8());const r=this.readUint8();this._colorType=r;let i;switch(r){case ca.GREYSCALE:i=1;break;case ca.TRUECOLOUR:i=3;break;case ca.INDEXED_COLOUR:i=1;break;case ca.GREYSCALE_ALPHA:i=2;break;case ca.TRUECOLOUR_ALPHA:i=4;break;case ca.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==f2.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const r=t/3;this._hasPalette=!0;const i=[];this._palette=i;for(let o=0;o<r;o++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const r=t,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let r=t,i=this.offset+this.byteOffset;if(i+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case ca.GREYSCALE:case ca.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let r=0;r<t/2;r++)this._transparency[r]=this.readUint16();break}case ca.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let r=0;for(;r<t;r++){const i=this.readByte();this._palette[r].push(i)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case ca.UNKNOWN:case ca.GREYSCALE_ALPHA:case ca.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const r=EN(this),i=this.readUint8();if(i!==f2.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const o=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:fq(o)}}decodepHYs(){const t=this.readUint32(),r=this.readUint32(),i=this.readByte();this._png.resolution={x:t,y:r,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const r={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(t);if(i){if(i.data=UA({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)r.data=i.data;else{const o=this._apng.frames.at(t-1);this.disposeFrame(i,o,r),this.addFrameDataToCanvas(r,i)}this._apng.frames.push(r)}}return this._apng}disposeFrame(t,r,i){switch(t.disposeOp){case fv.NONE:break;case fv.BACKGROUND:for(let o=0;o<this._png.height;o++)for(let s=0;s<this._png.width;s++){const a=(o*t.width+s)*this._png.channels;for(let u=0;u<this._png.channels;u++)i.data[a+u]=0}break;case fv.PREVIOUS:i.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,r){const i=1<<this._png.depth,o=(s,a)=>{const u=((s+r.yOffset)*this._png.width+r.xOffset+a)*this._png.channels,l=(s*r.width+a)*this._png.channels;return{index:u,frameIndex:l}};switch(r.blendOp){case p2.SOURCE:for(let s=0;s<r.height;s++)for(let a=0;a<r.width;a++){const{index:u,frameIndex:l}=o(s,a);for(let h=0;h<this._png.channels;h++)t.data[u+h]=r.data[l+h]}break;case p2.OVER:for(let s=0;s<r.height;s++)for(let a=0;a<r.width;a++){const{index:u,frameIndex:l}=o(s,a);for(let h=0;h<this._png.channels;h++){const d=r.data[l+this._png.channels-1]/i,m=h%(this._png.channels-1)===0?1:r.data[l+h],p=Math.floor(d*m+(1-d)*t.data[u+h]);t.data[u+h]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==WA.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===d2.NO_INTERLACE)this._png.data=UA({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===d2.ADAM7)this._png.data=bq({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,r=this._frames.at(-1);r?r.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:fv.NONE,blendOp:p2.SOURCE,data:t}),this._inflator=new BA,this._writingDataChunks=!1}}function Oq(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var qA;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(qA||(qA={}));function Fq(n,e){return new Mq(n,e).decode()}var pn=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function m2(){pn.console&&typeof pn.console.log=="function"&&pn.console.log.apply(pn.console,arguments)}var _r={log:m2,warn:function(n){pn.console&&(typeof pn.console.warn=="function"?pn.console.warn.apply(pn.console,arguments):m2.call(null,arguments))},error:function(n){pn.console&&(typeof pn.console.error=="function"?pn.console.error.apply(pn.console,arguments):m2(n))}};function g2(n,e,t){var r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",r.onload=function(){Kh(r.response,e,t)},r.onerror=function(){_r.error("could not download file")},r.send()}function HA(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function dv(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Kh=pn.saveAs||((typeof window>"u"?"undefined":fr(window))!=="object"||window!==pn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var r=pn.URL||pn.webkitURL,i=document.createElement("a");e=e||n.name||"download",i.download=e,i.rel="noopener",typeof n=="string"?(i.href=n,i.origin!==location.origin?HA(i.href)?g2(n,e,t):dv(i,i.target="_blank"):dv(i)):(i.href=r.createObjectURL(n),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){dv(i)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(HA(n))g2(n,e,t);else{var r=document.createElement("a");r.href=n,r.target="_blank",setTimeout(function(){dv(r)})}else navigator.msSaveOrOpenBlob((function(i,o){return o===void 0?o={autoBom:!1}:fr(o)!=="object"&&(_r.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(n,t),e)}:function(n,e,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof n=="string")return g2(n,e,t);var i=n.type==="application/octet-stream",o=/constructor/i.test(pn.HTMLElement)||pn.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":fr(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var h=a.result;h=s?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=h:location=h,r=null},a.readAsDataURL(n)}else{var u=pn.URL||pn.webkitURL,l=u.createObjectURL(n);r?r.location=l:location.href=l,r=null,setTimeout(function(){u.revokeObjectURL(l)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function SN(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],r=0;r<t.length;r++){var i=t[r].re,o=t[r].process,s=i.exec(n);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),u=this.g.toString(16),l=this.b.toString(16);return a.length==1&&(a="0"+a),u.length==1&&(u="0"+u),l.length==1&&(l="0"+l),"#"+a+u+l}}var Tv=pn.atob.bind(pn),GA=pn.btoa.bind(pn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function v2(n,e){var t=n[0],r=n[1],i=n[2],o=n[3];t=Xo(t,r,i,o,e[0],7,-680876936),o=Xo(o,t,r,i,e[1],12,-389564586),i=Xo(i,o,t,r,e[2],17,606105819),r=Xo(r,i,o,t,e[3],22,-1044525330),t=Xo(t,r,i,o,e[4],7,-176418897),o=Xo(o,t,r,i,e[5],12,1200080426),i=Xo(i,o,t,r,e[6],17,-1473231341),r=Xo(r,i,o,t,e[7],22,-45705983),t=Xo(t,r,i,o,e[8],7,1770035416),o=Xo(o,t,r,i,e[9],12,-1958414417),i=Xo(i,o,t,r,e[10],17,-42063),r=Xo(r,i,o,t,e[11],22,-1990404162),t=Xo(t,r,i,o,e[12],7,1804603682),o=Xo(o,t,r,i,e[13],12,-40341101),i=Xo(i,o,t,r,e[14],17,-1502002290),t=Yo(t,r=Xo(r,i,o,t,e[15],22,1236535329),i,o,e[1],5,-165796510),o=Yo(o,t,r,i,e[6],9,-1069501632),i=Yo(i,o,t,r,e[11],14,643717713),r=Yo(r,i,o,t,e[0],20,-373897302),t=Yo(t,r,i,o,e[5],5,-701558691),o=Yo(o,t,r,i,e[10],9,38016083),i=Yo(i,o,t,r,e[15],14,-660478335),r=Yo(r,i,o,t,e[4],20,-405537848),t=Yo(t,r,i,o,e[9],5,568446438),o=Yo(o,t,r,i,e[14],9,-1019803690),i=Yo(i,o,t,r,e[3],14,-187363961),r=Yo(r,i,o,t,e[8],20,1163531501),t=Yo(t,r,i,o,e[13],5,-1444681467),o=Yo(o,t,r,i,e[2],9,-51403784),i=Yo(i,o,t,r,e[7],14,1735328473),t=Qo(t,r=Yo(r,i,o,t,e[12],20,-1926607734),i,o,e[5],4,-378558),o=Qo(o,t,r,i,e[8],11,-2022574463),i=Qo(i,o,t,r,e[11],16,1839030562),r=Qo(r,i,o,t,e[14],23,-35309556),t=Qo(t,r,i,o,e[1],4,-1530992060),o=Qo(o,t,r,i,e[4],11,1272893353),i=Qo(i,o,t,r,e[7],16,-155497632),r=Qo(r,i,o,t,e[10],23,-1094730640),t=Qo(t,r,i,o,e[13],4,681279174),o=Qo(o,t,r,i,e[0],11,-358537222),i=Qo(i,o,t,r,e[3],16,-722521979),r=Qo(r,i,o,t,e[6],23,76029189),t=Qo(t,r,i,o,e[9],4,-640364487),o=Qo(o,t,r,i,e[12],11,-421815835),i=Qo(i,o,t,r,e[15],16,530742520),t=Jo(t,r=Qo(r,i,o,t,e[2],23,-995338651),i,o,e[0],6,-198630844),o=Jo(o,t,r,i,e[7],10,1126891415),i=Jo(i,o,t,r,e[14],15,-1416354905),r=Jo(r,i,o,t,e[5],21,-57434055),t=Jo(t,r,i,o,e[12],6,1700485571),o=Jo(o,t,r,i,e[3],10,-1894986606),i=Jo(i,o,t,r,e[10],15,-1051523),r=Jo(r,i,o,t,e[1],21,-2054922799),t=Jo(t,r,i,o,e[8],6,1873313359),o=Jo(o,t,r,i,e[15],10,-30611744),i=Jo(i,o,t,r,e[6],15,-1560198380),r=Jo(r,i,o,t,e[13],21,1309151649),t=Jo(t,r,i,o,e[4],6,-145523070),o=Jo(o,t,r,i,e[11],10,-1120210379),i=Jo(i,o,t,r,e[2],15,718787259),r=Jo(r,i,o,t,e[9],21,-343485551),n[0]=$c(t,n[0]),n[1]=$c(r,n[1]),n[2]=$c(i,n[2]),n[3]=$c(o,n[3])}function s1(n,e,t,r,i,o){return e=$c($c(e,n),$c(r,o)),$c(e<<i|e>>>32-i,t)}function Xo(n,e,t,r,i,o,s){return s1(e&t|~e&r,n,e,i,o,s)}function Yo(n,e,t,r,i,o,s){return s1(e&r|t&~r,n,e,i,o,s)}function Qo(n,e,t,r,i,o,s){return s1(e^t^r,n,e,i,o,s)}function Jo(n,e,t,r,i,o,s){return s1(t^(e|~r),n,e,i,o,s)}function AN(n){var e,t=n.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)v2(r,Bq(n.substring(e-64,e)));n=n.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)i[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(v2(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*t,v2(r,i),r}function Bq(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}var $A="0123456789abcdef".split("");function Vq(n){for(var e="",t=0;t<4;t++)e+=$A[n>>8*t+4&15]+$A[n>>8*t&15];return e}function jq(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function kw(n){return AN(n).map(jq).join("")}var Uq=(function(n){for(var e=0;e<n.length;e++)n[e]=Vq(n[e]);return n.join("")})(AN("hello"))!="5d41402abc4b2a76b9719d911017c592";function $c(n,e){if(Uq){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Nw(n,e){var t,r,i,o;if(n!==t){for(var s=(i=n,o=1+(256/n.length|0),new Array(o+1).join(i)),a=[],u=0;u<256;u++)a[u]=u;var l=0;for(u=0;u<256;u++){var h=a[u];l=(l+h+s.charCodeAt(u))%256,a[u]=a[l],a[l]=h}t=n,r=a}else a=r;var d=e.length,m=0,p=0,y="";for(u=0;u<d;u++)p=(p+(h=a[m=(m+1)%256]))%256,a[m]=a[p],a[p]=h,s=a[(a[m]+a[p])%256],y+=String.fromCharCode(e.charCodeAt(u)^s);return y}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var KA={print:4,modify:8,copy:16,"annot-forms":32};function sd(n,e,t,r){this.v=1,this.r=2;var i=192;n.forEach(function(a){if(KA.perm!==void 0)throw new Error("Invalid permission: "+a);i+=KA[a]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(e+this.padding).substr(0,32),s=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=kw(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Nw(this.encryptionKey,this.padding)}function ad(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,r=0;r<t;r++){var i=n.charCodeAt(r);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):n[r]}return e}function XA(n){if(fr(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,r,i){if(i=i||!1,typeof t!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var o=Math.random().toString(35);return e[t][o]=[r,!!i],o},this.unsubscribe=function(t){for(var r in e)if(e[r][t])return delete e[r][t],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[t]){var s=e[t][o];try{s[0].apply(n,r)}catch(a){pn.console&&_r.error("jsPDF PubSub Error",a.message,a)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function b0(n){if(!(this instanceof b0))return new b0(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function CN(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function Qh(n,e,t,r,i){if(!(this instanceof Qh))return new Qh(n,e,t,r,i);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,CN.call(this,r,i)}function vd(n,e,t,r,i){if(!(this instanceof vd))return new vd(n,e,t,r,i);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,CN.call(this,r,i)}function Wt(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],o=arguments[3],s=[],a=1,u=16,l="S",h=null;fr(n=n||{})==="object"&&(t=n.orientation,r=n.unit||r,i=n.format||i,o=n.compress||n.compressPdf||o,(h=n.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),a=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(u=n.floatPrecision),l=n.defaultPathOperation||"S"),s=n.filters||(o===!0?["FlateEncode"]:s),r=r||"mm",t=(""+(t||"P")).toLowerCase();var d=n.putOnlyUsedFonts||!1,m={},p={internal:{},__private__:{}};p.__private__.PubSub=XA;var y="1.3",b=p.__private__.getPdfVersion=function(){return y};p.__private__.setPdfVersion=function(N){y=N};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return x};var E=p.__private__.getPageFormat=function(N){return x[N]};i=i||"a4";var T="compat",P="advanced",C=T;function D(){this.saveGraphicsState(),re(new Kt(en,0,0,-en,0,to()*en).toString()+" cm"),this.setFontSize(this.getFontSize()/en),l="n",C=P}function z(){this.restoreGraphicsState(),l="S",C=T}var L=p.__private__.combineFontStyleAndFontWeight=function(N,H){if(N=="bold"&&H=="normal"||N=="bold"&&H==400||N=="normal"&&H=="italic"||N=="bold"&&H=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return H&&(N=H==400||H==="normal"?N==="italic"?"italic":"normal":H!=700&&H!=="bold"||N!=="normal"?(H==700?"bold":H)+""+N:"bold"),N};p.advancedAPI=function(N){var H=C===T;return H&&D.call(this),typeof N!="function"||(N(this),H&&z.call(this)),this},p.compatAPI=function(N){var H=C===P;return H&&z.call(this),typeof N!="function"||(N(this),H&&D.call(this)),this},p.isAdvancedAPI=function(){return C===P};var I,A=function(N){if(C!==P)throw new Error(N+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},O=p.roundToPrecision=p.__private__.roundToPrecision=function(N,H){var pe=e||H;if(isNaN(N)||isNaN(pe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return N.toFixed(pe).replace(/0+$/,"")};I=p.hpf=p.__private__.hpf=typeof u=="number"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return O(N,u)}:u==="smart"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return O(N,N>-1&&N<1?16:5)}:function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return O(N,16)};var k=p.f2=p.__private__.f2=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f2");return O(N,2)},M=p.__private__.f3=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f3");return O(N,3)},j=p.scale=p.__private__.scale=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.scale");return C===T?N*en:C===P?N:void 0},X=function(N){return j((function(H){return C===T?to()-H:C===P?H:void 0})(N))};p.__private__.setPrecision=p.setPrecision=function(N){typeof parseInt(N,10)=="number"&&(e=parseInt(N,10))};var ue,ge="00000000000000000000000000000000",ce=p.__private__.getFileId=function(){return ge},$=p.__private__.setFileId=function(N){return ge=N!==void 0&&/^[a-fA-F0-9]{32}$/.test(N)?N.toUpperCase():ge.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(br=new sd(h.userPermissions,h.userPassword,h.ownerPassword,ge)),ge};p.setFileId=function(N){return $(N),this},p.getFileId=function(){return ce()};var ae=p.__private__.convertDateToPDFDate=function(N){var H=N.getTimezoneOffset(),pe=H<0?"+":"-",be=Math.floor(Math.abs(H/60)),Ne=Math.abs(H%60),Xe=[pe,te(be),"'",te(Ne),"'"].join("");return["D:",N.getFullYear(),te(N.getMonth()+1),te(N.getDate()),te(N.getHours()),te(N.getMinutes()),te(N.getSeconds()),Xe].join("")},fe=p.__private__.convertPDFDateToDate=function(N){var H=parseInt(N.substr(2,4),10),pe=parseInt(N.substr(6,2),10)-1,be=parseInt(N.substr(8,2),10),Ne=parseInt(N.substr(10,2),10),Xe=parseInt(N.substr(12,2),10),Ze=parseInt(N.substr(14,2),10);return new Date(H,pe,be,Ne,Xe,Ze,0)},Q=p.__private__.setCreationDate=function(N){var H;if(N===void 0&&(N=new Date),N instanceof Date)H=ae(N);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(N))throw new Error("Invalid argument passed to jsPDF.setCreationDate");H=N}return ue=H},W=p.__private__.getCreationDate=function(N){var H=ue;return N==="jsDate"&&(H=fe(ue)),H};p.setCreationDate=function(N){return Q(N),this},p.getCreationDate=function(N){return W(N)};var J,te=p.__private__.padd2=function(N){return("0"+parseInt(N)).slice(-2)},de=p.__private__.padd2Hex=function(N){return("00"+(N=N.toString())).substr(N.length)},ve=0,we=[],Se=[],Ie=0,Fe=[],Ae=[],Be=!1,Le=Se;p.__private__.setCustomOutputDestination=function(N){Be=!0,Le=N};var tt=function(N){Be||(Le=N)};p.__private__.resetCustomOutputDestination=function(){Be=!1,Le=Se};var re=p.__private__.out=function(N){return N=N.toString(),Ie+=N.length+1,Le.push(N),Le},rt=p.__private__.write=function(N){return re(arguments.length===1?N.toString():Array.prototype.join.call(arguments," "))},zt=p.__private__.getArrayBuffer=function(N){for(var H=N.length,pe=new ArrayBuffer(H),be=new Uint8Array(pe);H--;)be[H]=N.charCodeAt(H);return pe},gt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return gt};var He=n.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(N){return He=C===P?N/en:N,this};var ft,lt=p.__private__.getFontSize=p.getFontSize=function(){return C===T?He:He*en},Et=n.R2L||!1;p.__private__.setR2L=p.setR2L=function(N){return Et=N,this},p.__private__.getR2L=p.getR2L=function(){return Et};var pt,En=p.__private__.setZoomMode=function(N){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(N))ft=N;else if(isNaN(N)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(N)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+N+'" is not recognized.');ft=N}else ft=parseInt(N,10)};p.__private__.getZoomMode=function(){return ft};var $t,Qt=p.__private__.setPageMode=function(N){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(N)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+N+'" is not recognized.');pt=N};p.__private__.getPageMode=function(){return pt};var an=p.__private__.setLayoutMode=function(N){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(N)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+N+'" is not recognized.');$t=N};p.__private__.getLayoutMode=function(){return $t},p.__private__.setDisplayMode=p.setDisplayMode=function(N,H,pe){return En(N),an(H),Qt(pe),this};var qt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(N){if(Object.keys(qt).indexOf(N)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return qt[N]},p.__private__.getDocumentProperties=function(){return qt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(N){for(var H in qt)qt.hasOwnProperty(H)&&N[H]&&(qt[H]=N[H]);return this},p.__private__.setDocumentProperty=function(N,H){if(Object.keys(qt).indexOf(N)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return qt[N]=H};var vt,en,yt,dr,mn,rn={},un={},On=[],Ot={},Bn={},Ht={},Jt={},jn=null,Dt=0,Gt=[],Cn=new XA(p),Mo=n.hotfixes||[],ai={},As={},ui=[],Kt=function N(H,pe,be,Ne,Xe,Ze){if(!(this instanceof N))return new N(H,pe,be,Ne,Xe,Ze);isNaN(H)&&(H=1),isNaN(pe)&&(pe=0),isNaN(be)&&(be=0),isNaN(Ne)&&(Ne=1),isNaN(Xe)&&(Xe=0),isNaN(Ze)&&(Ze=0),this._matrix=[H,pe,be,Ne,Xe,Ze]};Object.defineProperty(Kt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Kt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Kt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Kt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Kt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Kt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Kt.prototype,"a",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Kt.prototype,"b",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Kt.prototype,"c",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Kt.prototype,"d",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Kt.prototype,"e",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Kt.prototype,"f",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Kt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Kt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Kt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Kt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Kt.prototype.join=function(N){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(N)},Kt.prototype.multiply=function(N){var H=N.sx*this.sx+N.shy*this.shx,pe=N.sx*this.shy+N.shy*this.sy,be=N.shx*this.sx+N.sy*this.shx,Ne=N.shx*this.shy+N.sy*this.sy,Xe=N.tx*this.sx+N.ty*this.shx+this.tx,Ze=N.tx*this.shy+N.ty*this.sy+this.ty;return new Kt(H,pe,be,Ne,Xe,Ze)},Kt.prototype.decompose=function(){var N=this.sx,H=this.shy,pe=this.shx,be=this.sy,Ne=this.tx,Xe=this.ty,Ze=Math.sqrt(N*N+H*H),wt=(N/=Ze)*pe+(H/=Ze)*be;pe-=N*wt,be-=H*wt;var It=Math.sqrt(pe*pe+be*be);return wt/=It,N*(be/=It)<H*(pe/=It)&&(N=-N,H=-H,wt=-wt,Ze=-Ze),{scale:new Kt(Ze,0,0,It,0,0),translate:new Kt(1,0,0,1,Ne,Xe),rotate:new Kt(N,H,-H,N,0,0),skew:new Kt(1,0,wt,1,0,0)}},Kt.prototype.toString=function(N){return this.join(" ")},Kt.prototype.inversed=function(){var N=this.sx,H=this.shy,pe=this.shx,be=this.sy,Ne=this.tx,Xe=this.ty,Ze=1/(N*be-H*pe),wt=be*Ze,It=-H*Ze,Zt=-pe*Ze,Ft=N*Ze;return new Kt(wt,It,Zt,Ft,-wt*Ne-Zt*Xe,-It*Ne-Ft*Xe)},Kt.prototype.applyToPoint=function(N){var H=N.x*this.sx+N.y*this.shx+this.tx,pe=N.x*this.shy+N.y*this.sy+this.ty;return new Ai(H,pe)},Kt.prototype.applyToRectangle=function(N){var H=this.applyToPoint(N),pe=this.applyToPoint(new Ai(N.x+N.w,N.y+N.h));return new Ia(H.x,H.y,pe.x-H.x,pe.y-H.y)},Kt.prototype.clone=function(){var N=this.sx,H=this.shy,pe=this.shx,be=this.sy,Ne=this.tx,Xe=this.ty;return new Kt(N,H,pe,be,Ne,Xe)},p.Matrix=Kt;var go=p.matrixMult=function(N,H){return H.multiply(N)},Yi=new Kt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Yi;var li=function(N,H){if(!Bn[N]){var pe=(H instanceof Qh?"Sh":"P")+(Object.keys(Ot).length+1).toString(10);H.id=pe,Bn[N]=pe,Ot[pe]=H,Cn.publish("addPattern",H)}};p.ShadingPattern=Qh,p.TilingPattern=vd,p.addShadingPattern=function(N,H){return A("addShadingPattern()"),li(N,H),this},p.beginTilingPattern=function(N){A("beginTilingPattern()"),Bi(N.boundingBox[0],N.boundingBox[1],N.boundingBox[2]-N.boundingBox[0],N.boundingBox[3]-N.boundingBox[1],N.matrix)},p.endTilingPattern=function(N,H){A("endTilingPattern()"),H.stream=Ae[J].join(`
`),li(N,H),Cn.publish("endTilingPattern",H),ui.pop().restore()};var vo,Xn=p.__private__.newObject=function(){var N=or();return Rr(N,!0),N},or=p.__private__.newObjectDeferred=function(){return ve++,we[ve]=function(){return Ie},ve},Rr=function(N,H){return H=typeof H=="boolean"&&H,we[N]=Ie,H&&re(N+" 0 obj"),N},Ei=p.__private__.newAdditionalObject=function(){var N={objId:or(),content:""};return Fe.push(N),N},Ks=or(),Oo=or(),Fo=p.__private__.decodeColorString=function(N){var H=N.split(" ");if(H.length!==2||H[1]!=="g"&&H[1]!=="G")H.length!==5||H[4]!=="k"&&H[4]!=="K"||(H=[(1-H[0])*(1-H[3]),(1-H[1])*(1-H[3]),(1-H[2])*(1-H[3]),"r"]);else{var pe=parseFloat(H[0]);H=[pe,pe,pe,"r"]}for(var be="#",Ne=0;Ne<3;Ne++)be+=("0"+Math.floor(255*parseFloat(H[Ne])).toString(16)).slice(-2);return be},Vr=p.__private__.encodeColorString=function(N){var H;typeof N=="string"&&(N={ch1:N});var pe=N.ch1,be=N.ch2,Ne=N.ch3,Xe=N.ch4,Ze=N.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof pe=="string"&&pe.charAt(0)!=="#"){var wt=new SN(pe);if(wt.ok)pe=wt.toHex();else if(!/^\d*\.?\d*$/.test(pe))throw new Error('Invalid color "'+pe+'" passed to jsPDF.encodeColorString.')}if(typeof pe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(pe)&&(pe="#"+pe[1]+pe[1]+pe[2]+pe[2]+pe[3]+pe[3]),typeof pe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(pe)){var It=parseInt(pe.substr(1),16);pe=It>>16&255,be=It>>8&255,Ne=255&It}if(be===void 0||Xe===void 0&&pe===be&&be===Ne)H=typeof pe=="string"?pe+" "+Ze[0]:N.precision===2?k(pe/255)+" "+Ze[0]:M(pe/255)+" "+Ze[0];else if(Xe===void 0||fr(Xe)==="object"){if(Xe&&!isNaN(Xe.a)&&Xe.a===0)return["1.","1.","1.",Ze[1]].join(" ");H=typeof pe=="string"?[pe,be,Ne,Ze[1]].join(" "):N.precision===2?[k(pe/255),k(be/255),k(Ne/255),Ze[1]].join(" "):[M(pe/255),M(be/255),M(Ne/255),Ze[1]].join(" ")}else H=typeof pe=="string"?[pe,be,Ne,Xe,Ze[2]].join(" "):N.precision===2?[k(pe),k(be),k(Ne),k(Xe),Ze[2]].join(" "):[M(pe),M(be),M(Ne),M(Xe),Ze[2]].join(" ");return H},yo=p.__private__.getFilters=function(){return s},wo=p.__private__.putStream=function(N){var H=(N=N||{}).data||"",pe=N.filters||yo(),be=N.alreadyAppliedFilters||[],Ne=N.addLength1||!1,Xe=H.length,Ze=N.objectId,wt=function(B){return B};if(h!==null&&Ze===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(wt=br.encryptor(Ze,0));var It={};pe===!0&&(pe=["FlateEncode"]);var Zt=N.additionalKeyValues||[],Ft=(It=Wt.API.processDataByFilters!==void 0?Wt.API.processDataByFilters(H,pe):{data:H,reverseChain:[]}).reverseChain+(Array.isArray(be)?be.join(" "):be.toString());if(It.data.length!==0&&(Zt.push({key:"Length",value:It.data.length}),Ne===!0&&Zt.push({key:"Length1",value:Xe})),Ft.length!=0)if(Ft.split("/").length-1==1)Zt.push({key:"Filter",value:Ft});else{Zt.push({key:"Filter",value:"["+Ft+"]"});for(var kn=0;kn<Zt.length;kn+=1)if(Zt[kn].key==="DecodeParms"){for(var mr=[],sr=0;sr<It.reverseChain.split("/").length-1;sr+=1)mr.push("null");mr.push(Zt[kn].value),Zt[kn].value="["+mr.join(" ")+"]"}}re("<<");for(var w=0;w<Zt.length;w++)re("/"+Zt[w].key+" "+Zt[w].value);re(">>"),It.data.length!==0&&(re("stream"),re(wt(It.data)),re("endstream"))},xa=p.__private__.putPage=function(N){var H=N.number,pe=N.data,be=N.objId,Ne=N.contentsObjId;Rr(be,!0),re("<</Type /Page"),re("/Parent "+N.rootDictionaryObjId+" 0 R"),re("/Resources "+N.resourceDictionaryObjId+" 0 R"),re("/MediaBox ["+parseFloat(I(N.mediaBox.bottomLeftX))+" "+parseFloat(I(N.mediaBox.bottomLeftY))+" "+I(N.mediaBox.topRightX)+" "+I(N.mediaBox.topRightY)+"]"),N.cropBox!==null&&re("/CropBox ["+I(N.cropBox.bottomLeftX)+" "+I(N.cropBox.bottomLeftY)+" "+I(N.cropBox.topRightX)+" "+I(N.cropBox.topRightY)+"]"),N.bleedBox!==null&&re("/BleedBox ["+I(N.bleedBox.bottomLeftX)+" "+I(N.bleedBox.bottomLeftY)+" "+I(N.bleedBox.topRightX)+" "+I(N.bleedBox.topRightY)+"]"),N.trimBox!==null&&re("/TrimBox ["+I(N.trimBox.bottomLeftX)+" "+I(N.trimBox.bottomLeftY)+" "+I(N.trimBox.topRightX)+" "+I(N.trimBox.topRightY)+"]"),N.artBox!==null&&re("/ArtBox ["+I(N.artBox.bottomLeftX)+" "+I(N.artBox.bottomLeftY)+" "+I(N.artBox.topRightX)+" "+I(N.artBox.topRightY)+"]"),typeof N.userUnit=="number"&&N.userUnit!==1&&re("/UserUnit "+N.userUnit),Cn.publish("putPage",{objId:be,pageContext:Gt[H],pageNumber:H,page:pe}),re("/Contents "+Ne+" 0 R"),re(">>"),re("endobj");var Xe=pe.join(`
`);return C===P&&(Xe+=`
Q`),Rr(Ne,!0),wo({data:Xe,filters:yo(),objectId:Ne}),re("endobj"),be},cs=p.__private__.putPages=function(){var N,H,pe=[];for(N=1;N<=Dt;N++)Gt[N].objId=or(),Gt[N].contentsObjId=or();for(N=1;N<=Dt;N++)pe.push(xa({number:N,data:Ae[N],objId:Gt[N].objId,contentsObjId:Gt[N].contentsObjId,mediaBox:Gt[N].mediaBox,cropBox:Gt[N].cropBox,bleedBox:Gt[N].bleedBox,trimBox:Gt[N].trimBox,artBox:Gt[N].artBox,userUnit:Gt[N].userUnit,rootDictionaryObjId:Ks,resourceDictionaryObjId:Oo}));Rr(Ks,!0),re("<</Type /Pages");var be="/Kids [";for(H=0;H<Dt;H++)be+=pe[H]+" 0 R ";re(be+"]"),re("/Count "+Dt),re(">>"),re("endobj"),Cn.publish("postPutPages")},hs=function(N){Cn.publish("putFont",{font:N,out:re,newObject:Xn,putStream:wo}),N.isAlreadyPutted!==!0&&(N.objectNumber=Xn(),re("<<"),re("/Type /Font"),re("/BaseFont /"+ad(N.postScriptName)),re("/Subtype /Type1"),typeof N.encoding=="string"&&re("/Encoding /"+N.encoding),re("/FirstChar 32"),re("/LastChar 255"),re(">>"),re("endobj"))},_a=function(N){N.objectNumber=Xn();var H=[];H.push({key:"Type",value:"/XObject"}),H.push({key:"Subtype",value:"/Form"}),H.push({key:"BBox",value:"["+[I(N.x),I(N.y),I(N.x+N.width),I(N.y+N.height)].join(" ")+"]"}),H.push({key:"Matrix",value:"["+N.matrix.toString()+"]"});var pe=N.pages[1].join(`
`);wo({data:pe,additionalKeyValues:H,objectId:N.objectNumber}),re("endobj")},Xs=function(N,H){H||(H=21);var pe=Xn(),be=(function(Ze,wt){var It,Zt=[],Ft=1/(wt-1);for(It=0;It<1;It+=Ft)Zt.push(It);if(Zt.push(1),Ze[0].offset!=0){var kn={offset:0,color:Ze[0].color};Ze.unshift(kn)}if(Ze[Ze.length-1].offset!=1){var mr={offset:1,color:Ze[Ze.length-1].color};Ze.push(mr)}for(var sr="",w=0,B=0;B<Zt.length;B++){for(It=Zt[B];It>Ze[w+1].offset;)w++;var q=Ze[w].offset,ne=(It-q)/(Ze[w+1].offset-q),Re=Ze[w].color,je=Ze[w+1].color;sr+=de(Math.round((1-ne)*Re[0]+ne*je[0]).toString(16))+de(Math.round((1-ne)*Re[1]+ne*je[1]).toString(16))+de(Math.round((1-ne)*Re[2]+ne*je[2]).toString(16))}return sr.trim()})(N.colors,H),Ne=[];Ne.push({key:"FunctionType",value:"0"}),Ne.push({key:"Domain",value:"[0.0 1.0]"}),Ne.push({key:"Size",value:"["+H+"]"}),Ne.push({key:"BitsPerSample",value:"8"}),Ne.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ne.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),wo({data:be,additionalKeyValues:Ne,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:pe}),re("endobj"),N.objectNumber=Xn(),re("<< /ShadingType "+N.type),re("/ColorSpace /DeviceRGB");var Xe="/Coords ["+I(parseFloat(N.coords[0]))+" "+I(parseFloat(N.coords[1]))+" ";N.type===2?Xe+=I(parseFloat(N.coords[2]))+" "+I(parseFloat(N.coords[3])):Xe+=I(parseFloat(N.coords[2]))+" "+I(parseFloat(N.coords[3]))+" "+I(parseFloat(N.coords[4]))+" "+I(parseFloat(N.coords[5])),re(Xe+="]"),N.matrix&&re("/Matrix ["+N.matrix.toString()+"]"),re("/Function "+pe+" 0 R"),re("/Extend [true true]"),re(">>"),re("endobj")},Cs=function(N,H){var pe=or(),be=Xn();H.push({resourcesOid:pe,objectOid:be}),N.objectNumber=be;var Ne=[];Ne.push({key:"Type",value:"/Pattern"}),Ne.push({key:"PatternType",value:"1"}),Ne.push({key:"PaintType",value:"1"}),Ne.push({key:"TilingType",value:"1"}),Ne.push({key:"BBox",value:"["+N.boundingBox.map(I).join(" ")+"]"}),Ne.push({key:"XStep",value:I(N.xStep)}),Ne.push({key:"YStep",value:I(N.yStep)}),Ne.push({key:"Resources",value:pe+" 0 R"}),N.matrix&&Ne.push({key:"Matrix",value:"["+N.matrix.toString()+"]"}),wo({data:N.stream,additionalKeyValues:Ne,objectId:N.objectNumber}),re("endobj")},Ys=function(N){for(var H in N.objectNumber=Xn(),re("<<"),N)switch(H){case"opacity":re("/ca "+k(N[H]));break;case"stroke-opacity":re("/CA "+k(N[H]))}re(">>"),re("endobj")},Qn=function(N){Rr(N.resourcesOid,!0),re("<<"),re("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var H in re("/Font <<"),rn)rn.hasOwnProperty(H)&&(d===!1||d===!0&&m.hasOwnProperty(H))&&re("/"+H+" "+rn[H].objectNumber+" 0 R");re(">>")})(),(function(){if(Object.keys(Ot).length>0){for(var H in re("/Shading <<"),Ot)Ot.hasOwnProperty(H)&&Ot[H]instanceof Qh&&Ot[H].objectNumber>=0&&re("/"+H+" "+Ot[H].objectNumber+" 0 R");Cn.publish("putShadingPatternDict"),re(">>")}})(),(function(H){if(Object.keys(Ot).length>0){for(var pe in re("/Pattern <<"),Ot)Ot.hasOwnProperty(pe)&&Ot[pe]instanceof p.TilingPattern&&Ot[pe].objectNumber>=0&&Ot[pe].objectNumber<H&&re("/"+pe+" "+Ot[pe].objectNumber+" 0 R");Cn.publish("putTilingPatternDict"),re(">>")}})(N.objectOid),(function(){if(Object.keys(Ht).length>0){var H;for(H in re("/ExtGState <<"),Ht)Ht.hasOwnProperty(H)&&Ht[H].objectNumber>=0&&re("/"+H+" "+Ht[H].objectNumber+" 0 R");Cn.publish("putGStateDict"),re(">>")}})(),(function(){for(var H in re("/XObject <<"),ai)ai.hasOwnProperty(H)&&ai[H].objectNumber>=0&&re("/"+H+" "+ai[H].objectNumber+" 0 R");Cn.publish("putXobjectDict"),re(">>")})(),re(">>"),re("endobj")},cc=function(N){un[N.fontName]=un[N.fontName]||{},un[N.fontName][N.fontStyle]=N.id},Ka=function(N,H,pe,be,Ne){var Xe={id:"F"+(Object.keys(rn).length+1).toString(10),postScriptName:N,fontName:H,fontStyle:pe,encoding:be,isStandardFont:Ne||!1,metadata:{}};return Cn.publish("addFont",{font:Xe,instance:this}),rn[Xe.id]=Xe,cc(Xe),Xe.id},Qi=p.__private__.pdfEscape=p.pdfEscape=function(N,H){return(function(pe,be){var Ne,Xe,Ze,wt,It,Zt,Ft,kn,mr;if(Ze=(be=be||{}).sourceEncoding||"Unicode",It=be.outputEncoding,(be.autoencode||It)&&rn[vt].metadata&&rn[vt].metadata[Ze]&&rn[vt].metadata[Ze].encoding&&(wt=rn[vt].metadata[Ze].encoding,!It&&rn[vt].encoding&&(It=rn[vt].encoding),!It&&wt.codePages&&(It=wt.codePages[0]),typeof It=="string"&&(It=wt[It]),It)){for(Ft=!1,Zt=[],Ne=0,Xe=pe.length;Ne<Xe;Ne++)(kn=It[pe.charCodeAt(Ne)])?Zt.push(String.fromCharCode(kn)):Zt.push(pe[Ne]),Zt[Ne].charCodeAt(0)>>8&&(Ft=!0);pe=Zt.join("")}for(Ne=pe.length;Ft===void 0&&Ne!==0;)pe.charCodeAt(Ne-1)>>8&&(Ft=!0),Ne--;if(!Ft)return pe;for(Zt=be.noBOM?[]:[254,255],Ne=0,Xe=pe.length;Ne<Xe;Ne++){if((mr=(kn=pe.charCodeAt(Ne))>>8)>>8)throw new Error("Character at position "+Ne+" of string '"+pe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Zt.push(mr),Zt.push(kn-(mr<<8))}return String.fromCharCode.apply(void 0,Zt)})(N,H).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Qs=p.__private__.beginPage=function(N){Ae[++Dt]=[],Gt[Dt]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(N[0]),topRightY:Number(N[1])}},Sa(Dt),tt(Ae[J])},Nu=function(N,H){var pe,be,Ne;switch(t=H||t,typeof N=="string"&&(pe=E(N.toLowerCase()),Array.isArray(pe)&&(be=pe[0],Ne=pe[1])),Array.isArray(N)&&(be=N[0]*en,Ne=N[1]*en),isNaN(be)&&(be=i[0],Ne=i[1]),(be>14400||Ne>14400)&&(_r.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),be=Math.min(14400,be),Ne=Math.min(14400,Ne)),i=[be,Ne],t.substr(0,1)){case"l":Ne>be&&(i=[Ne,be]);break;case"p":be>Ne&&(i=[Ne,be])}Qs(i),Xt(jr),re(Ja),jo!==0&&re(jo+" J"),Mu!==0&&re(Mu+" j"),Cn.publish("addPage",{pageNumber:Dt})},Ea=function(N){N>0&&N<=Dt&&(Ae.splice(N,1),Gt.splice(N,1),Dt--,J>Dt&&(J=Dt),this.setPage(J))},Sa=function(N){N>0&&N<=Dt&&(J=N)},Ji=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Ae.length-1},xl=function(N,H,pe){var be,Ne=void 0;return pe=pe||{},N=N!==void 0?N:rn[vt].fontName,H=H!==void 0?H:rn[vt].fontStyle,be=N.toLowerCase(),un[be]!==void 0&&un[be][H]!==void 0?Ne=un[be][H]:un[N]!==void 0&&un[N][H]!==void 0?Ne=un[N][H]:pe.disableWarning===!1&&_r.warn("Unable to look up font label for font '"+N+"', '"+H+"'. Refer to getFontList() for available fonts."),Ne||pe.noFallback||(Ne=un.times[H])==null&&(Ne=un.times.normal),Ne},Pr=p.__private__.putInfo=function(){var N=Xn(),H=function(be){return be};for(var pe in h!==null&&(H=br.encryptor(N,0)),re("<<"),re("/Producer ("+Qi(H("jsPDF "+Wt.version))+")"),qt)qt.hasOwnProperty(pe)&&qt[pe]&&re("/"+pe.substr(0,1).toUpperCase()+pe.substr(1)+" ("+Qi(H(qt[pe]))+")");re("/CreationDate ("+Qi(H(ue))+")"),re(">>"),re("endobj")},bo=p.__private__.putCatalog=function(N){var H=(N=N||{}).rootDictionaryObjId||Ks;switch(Xn(),re("<<"),re("/Type /Catalog"),re("/Pages "+H+" 0 R"),ft||(ft="fullwidth"),ft){case"fullwidth":re("/OpenAction [3 0 R /FitH null]");break;case"fullheight":re("/OpenAction [3 0 R /FitV null]");break;case"fullpage":re("/OpenAction [3 0 R /Fit]");break;case"original":re("/OpenAction [3 0 R /XYZ null null 1]");break;default:var pe=""+ft;pe.substr(pe.length-1)==="%"&&(ft=parseInt(ft)/100),typeof ft=="number"&&re("/OpenAction [3 0 R /XYZ null null "+k(ft)+"]")}switch($t||($t="continuous"),$t){case"continuous":re("/PageLayout /OneColumn");break;case"single":re("/PageLayout /SinglePage");break;case"two":case"twoleft":re("/PageLayout /TwoColumnLeft");break;case"tworight":re("/PageLayout /TwoColumnRight")}pt&&re("/PageMode /"+pt),Cn.publish("putCatalog"),re(">>"),re("endobj")},Bo=p.__private__.putTrailer=function(){re("trailer"),re("<<"),re("/Size "+(ve+1)),re("/Root "+ve+" 0 R"),re("/Info "+(ve-1)+" 0 R"),h!==null&&re("/Encrypt "+br.oid+" 0 R"),re("/ID [ <"+ge+"> <"+ge+"> ]"),re(">>")},pr=p.__private__.putHeader=function(){re("%PDF-"+y),re("%")},fs=p.__private__.putXRef=function(){var N="0000000000";re("xref"),re("0 "+(ve+1)),re("0000000000 65535 f ");for(var H=1;H<=ve;H++)typeof we[H]=="function"?re((N+we[H]()).slice(-10)+" 00000 n "):we[H]!==void 0?re((N+we[H]).slice(-10)+" 00000 n "):re("0000000000 00000 n ")},Oi=p.__private__.buildDocument=function(){var N;ve=0,Ie=0,Se=[],we=[],Fe=[],Ks=or(),Oo=or(),tt(Se),Cn.publish("buildDocument"),pr(),cs(),(function(){Cn.publish("putAdditionalObjects");for(var pe=0;pe<Fe.length;pe++){var be=Fe[pe];Rr(be.objId,!0),re(be.content),re("endobj")}Cn.publish("postPutAdditionalObjects")})(),N=[],(function(){for(var pe in rn)rn.hasOwnProperty(pe)&&(d===!1||d===!0&&m.hasOwnProperty(pe))&&hs(rn[pe])})(),(function(){var pe;for(pe in Ht)Ht.hasOwnProperty(pe)&&Ys(Ht[pe])})(),(function(){for(var pe in ai)ai.hasOwnProperty(pe)&&_a(ai[pe])})(),(function(pe){var be;for(be in Ot)Ot.hasOwnProperty(be)&&(Ot[be]instanceof Qh?Xs(Ot[be]):Ot[be]instanceof vd&&Cs(Ot[be],pe))})(N),Cn.publish("putResources"),N.forEach(Qn),Qn({resourcesOid:Oo,objectOid:Number.MAX_SAFE_INTEGER}),Cn.publish("postPutResources"),h!==null&&(br.oid=Xn(),re("<<"),re("/Filter /Standard"),re("/V "+br.v),re("/R "+br.r),re("/U <"+br.toHexString(br.U)+">"),re("/O <"+br.toHexString(br.O)+">"),re("/P "+br.P),re(">>"),re("endobj")),Pr(),bo();var H=Ie;return fs(),Bo(),re("startxref"),re(""+H),re("%%EOF"),tt(Ae[J]),Se.join(`
`)},Tn=p.__private__.getBlob=function(N){return new Blob([zt(N)],{type:"application/pdf"})},Is=p.output=p.__private__.output=(vo=function(N,H){switch(typeof(H=H||{})=="string"?H={filename:H}:H.filename=H.filename||"generated.pdf",N){case void 0:return Oi();case"save":p.save(H.filename);break;case"arraybuffer":return zt(Oi());case"blob":return Tn(Oi());case"bloburi":case"bloburl":if(pn.URL!==void 0&&typeof pn.URL.createObjectURL=="function")return pn.URL&&pn.URL.createObjectURL(Tn(Oi()))||void 0;_r.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var pe="",be=Oi();try{pe=GA(be)}catch{pe=GA(unescape(encodeURIComponent(be)))}return"data:application/pdf;filename="+H.filename+";base64,"+pe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(pn)==="[object Window]"){var Ne="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Xe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';H.pdfObjectUrl&&(Ne=H.pdfObjectUrl,Xe="");var Ze='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ne+'"'+Xe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(H)+");<\/script></body></html>",wt=pn.open();return wt!==null&&wt.document.write(Ze),wt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(pn)==="[object Window]"){var It='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(H.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+H.filename+'" width="500px" height="400px" /></body></html>',Zt=pn.open();if(Zt!==null){Zt.document.write(It);var Ft=this;Zt.document.documentElement.querySelector("#pdfViewer").onload=function(){Zt.document.title=H.filename,Zt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ft.output("bloburl"))}}return Zt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(pn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var kn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",H)+'"></iframe></body></html>',mr=pn.open();if(mr!==null&&(mr.document.write(kn),mr.document.title=H.filename),mr||typeof safari>"u")return mr;break;case"datauri":case"dataurl":return pn.document.location.href=this.output("datauristring",H);default:return null}},vo.foo=function(){try{return vo.apply(this,arguments)}catch(pe){var N=pe.stack||"";~N.indexOf(" at ")&&(N=N.split(" at ")[1]);var H="Error in function "+N.split(`
`)[0].split("<")[0]+": "+pe.message;if(!pn.console)throw new Error(H);pn.console.error(H,pe),pn.alert&&alert(H)}},vo.foo.bar=vo,vo.foo),Si=function(N){return Array.isArray(Mo)===!0&&Mo.indexOf(N)>-1};switch(r){case"pt":en=1;break;case"mm":en=72/25.4;break;case"cm":en=72/2.54;break;case"in":en=72;break;case"px":en=Si("px_scaling")==1?.75:96/72;break;case"pc":case"em":en=12;break;case"ex":en=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);en=r}var br=null;Q(),$();var ds=p.__private__.getPageInfo=p.getPageInfo=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Gt[N].objId,pageNumber:N,pageContext:Gt[N]}},Ru=p.__private__.getPageInfoByObjId=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var H in Gt)if(Gt[H].objId===N)break;return ds(H)},_l=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Gt[J].objId,pageNumber:J,pageContext:Gt[J]}};p.addPage=function(){return Nu.apply(this,arguments),this},p.setPage=function(){return Sa.apply(this,arguments),tt.call(this,Ae[J]),this},p.insertPage=function(N){return this.addPage(),this.movePage(J,N),this},p.movePage=function(N,H){var pe,be;if(N>H){pe=Ae[N],be=Gt[N];for(var Ne=N;Ne>H;Ne--)Ae[Ne]=Ae[Ne-1],Gt[Ne]=Gt[Ne-1];Ae[H]=pe,Gt[H]=be,this.setPage(H)}else if(N<H){pe=Ae[N],be=Gt[N];for(var Xe=N;Xe<H;Xe++)Ae[Xe]=Ae[Xe+1],Gt[Xe]=Gt[Xe+1];Ae[H]=pe,Gt[H]=be,this.setPage(H)}return this},p.deletePage=function(){return Ea.apply(this,arguments),this},p.__private__.text=p.text=function(N,H,pe,be,Ne){var Xe,Ze,wt,It,Zt,Ft,kn,mr,sr,w=(be=be||{}).scope||this;if(typeof N=="number"&&typeof H=="number"&&(typeof pe=="string"||Array.isArray(pe))){var B=pe;pe=H,H=N,N=B}if(arguments[3]instanceof Kt==0?(wt=arguments[4],It=arguments[5],fr(kn=arguments[3])==="object"&&kn!==null||(typeof wt=="string"&&(It=wt,wt=null),typeof kn=="string"&&(It=kn,kn=null),typeof kn=="number"&&(wt=kn,kn=null),be={flags:kn,angle:wt,align:It})):(A("The transform parameter of text() with a Matrix value"),sr=Ne),isNaN(H)||isNaN(pe)||N==null)throw new Error("Invalid arguments passed to jsPDF.text");if(N.length===0)return w;var q,ne="",Re=typeof be.lineHeightFactor=="number"?be.lineHeightFactor:eo,je=w.internal.scaleFactor;function at(qn){return qn=qn.split("	").join(Array(be.TabLen||9).join(" ")),Qi(qn,kn)}function on(qn){for(var tr,Lr=qn.concat(),Zr=[],ra=Lr.length;ra--;)typeof(tr=Lr.shift())=="string"?Zr.push(tr):Array.isArray(qn)&&(tr.length===1||tr[1]===void 0&&tr[2]===void 0)?Zr.push(tr[0]):Zr.push([tr[0],tr[1],tr[2]]);return Zr}function gr(qn,tr){var Lr;if(typeof qn=="string")Lr=tr(qn)[0];else if(Array.isArray(qn)){for(var Zr,ra,Eh=qn.concat(),gc=[],iu=Eh.length;iu--;)typeof(Zr=Eh.shift())=="string"?gc.push(tr(Zr)[0]):Array.isArray(Zr)&&typeof Zr[0]=="string"&&(ra=tr(Zr[0],Zr[1],Zr[2]),gc.push([ra[0],ra[1],ra[2]]));Lr=gc}return Lr}var Nn=!1,vr=!0;if(typeof N=="string")Nn=!0;else if(Array.isArray(N)){var fi=N.concat();Ze=[];for(var no,yr=fi.length;yr--;)(typeof(no=fi.shift())!="string"||Array.isArray(no)&&typeof no[0]!="string")&&(vr=!1);Nn=vr}if(Nn===!1)throw new Error('Type of text must be string or Array. "'+N+'" is not recognized.');typeof N=="string"&&(N=N.match(/[\r?\n]/)?N.split(/\r\n|\r|\n/g):[N]);var ro=He/w.internal.scaleFactor,Ps=ro*(Re-1);switch(be.baseline){case"bottom":pe-=Ps;break;case"top":pe+=ro-Ps;break;case"hanging":pe+=ro-2*Ps;break;case"middle":pe+=ro/2-Ps}if((Ft=be.maxWidth||0)>0&&(typeof N=="string"?N=w.splitTextToSize(N,Ft):Object.prototype.toString.call(N)==="[object Array]"&&(N=N.reduce(function(qn,tr){return qn.concat(w.splitTextToSize(tr,Ft))},[]))),Xe={text:N,x:H,y:pe,options:be,mutex:{pdfEscape:Qi,activeFontKey:vt,fonts:rn,activeFontSize:He}},Cn.publish("preProcessText",Xe),N=Xe.text,wt=(be=Xe.options).angle,sr instanceof Kt==0&&wt&&typeof wt=="number"){wt*=Math.PI/180,be.rotationDirection===0&&(wt=-wt),C===P&&(wt=-wt);var Za=Math.cos(wt),_h=Math.sin(wt);sr=new Kt(Za,_h,-_h,Za,0,0)}else wt&&wt instanceof Kt&&(sr=wt);C!==P||sr||(sr=Yi),(Zt=be.charSpace||Fi)!==void 0&&(ne+=I(j(Zt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(mr=be.horizontalScale)!==void 0&&(ne+=I(100*mr)+` Tz
`),be.lang;var Eo=-1,ta=be.renderingMode!==void 0?be.renderingMode:be.stroke,Na=w.internal.getCurrentPageInfo().pageContext;switch(ta){case 0:case!1:case"fill":Eo=0;break;case 1:case!0:case"stroke":Eo=1;break;case 2:case"fillThenStroke":Eo=2;break;case 3:case"invisible":Eo=3;break;case 4:case"fillAndAddForClipping":Eo=4;break;case 5:case"strokeAndAddPathForClipping":Eo=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Eo=6;break;case 7:case"addToPathForClipping":Eo=7}var If=Na.usedRenderingMode!==void 0?Na.usedRenderingMode:-1;Eo!==-1?ne+=Eo+` Tr
`:If!==-1&&(ne+=`0 Tr
`),Eo!==-1&&(Na.usedRenderingMode=Eo),It=be.align||"left";var vs,Fu=He*Re,fc=w.internal.pageSize.getWidth(),dc=rn[vt];Zt=be.charSpace||Fi,Ft=be.maxWidth||0,kn=Object.assign({autoencode:!0,noBOM:!0},be.flags);var eu=[],Ds=function(qn){return w.getStringUnitWidth(qn,{font:dc,charSpace:Zt,fontSize:He,doKerning:!1})*He/je};if(Object.prototype.toString.call(N)==="[object Array]"){var ys;Ze=on(N),It!=="left"&&(vs=Ze.map(Ds));var ws,Bu=0;if(It==="right"){H-=vs[0],N=[],yr=Ze.length;for(var Ra=0;Ra<yr;Ra++)Ra===0?(ws=ci(H),ys=Ns(pe)):(ws=j(Bu-vs[Ra]),ys=-Fu),N.push([Ze[Ra],ws,ys]),Bu=vs[Ra]}else if(It==="center"){H-=vs[0]/2,N=[],yr=Ze.length;for(var tu=0;tu<yr;tu++)tu===0?(ws=ci(H),ys=Ns(pe)):(ws=j((Bu-vs[tu])/2),ys=-Fu),N.push([Ze[tu],ws,ys]),Bu=vs[tu]}else if(It==="left"){N=[],yr=Ze.length;for(var nu=0;nu<yr;nu++)N.push(Ze[nu])}else if(It==="justify"&&dc.encoding==="Identity-H"){N=[],yr=Ze.length,Ft=Ft!==0?Ft:fc;for(var Pa=0,Ur=0;Ur<yr;Ur++)if(ys=Ur===0?Ns(pe):-Fu,ws=Ur===0?ci(H):Pa,Ur<yr-1){var Il=j((Ft-vs[Ur])/(Ze[Ur].split(" ").length-1)),Da=Ze[Ur].split(" ");N.push([Da[0]+" ",ws,ys]),Pa=0;for(var na=1;na<Da.length;na++){var Tl=(Ds(Da[na-1]+" "+Da[na])-Ds(Da[na]))*je+Il;na==Da.length-1?N.push([Da[na],Tl,0]):N.push([Da[na]+" ",Tl,0]),Pa-=Tl}}else N.push([Ze[Ur],ws,ys]);N.push(["",Pa,0])}else{if(It!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(N=[],yr=Ze.length,Ft=Ft!==0?Ft:fc,Ur=0;Ur<yr;Ur++){ys=Ur===0?Ns(pe):-Fu,ws=Ur===0?ci(H):0;var kl=Ze[Ur].split(" ").length-1,pc=kl>0?(Ft-vs[Ur])/kl:0;Ur<yr-1?eu.push(I(j(pc))):eu.push(0),N.push([Ze[Ur],ws,ys])}}}(typeof be.R2L=="boolean"?be.R2L:Et)===!0&&(N=gr(N,function(qn,tr,Lr){return[qn.split("").reverse().join(""),tr,Lr]})),Xe={text:N,x:H,y:pe,options:be,mutex:{pdfEscape:Qi,activeFontKey:vt,fonts:rn,activeFontSize:He}},Cn.publish("postProcessText",Xe),N=Xe.text,q=Xe.mutex.isHex||!1;var mc=rn[vt].encoding;mc!=="WinAnsiEncoding"&&mc!=="StandardEncoding"||(N=gr(N,function(qn,tr,Lr){return[at(qn),tr,Lr]})),Ze=on(N),N=[];for(var ru,Vu,ju,Nl=Array.isArray(Ze[0])?1:0,Uu="",Rl=function(qn,tr,Lr){var Zr="";return Lr instanceof Kt?(Lr=typeof be.angle=="number"?go(Lr,new Kt(1,0,0,1,qn,tr)):go(new Kt(1,0,0,1,qn,tr),Lr),C===P&&(Lr=go(new Kt(1,0,0,-1,0,0),Lr)),Zr=Lr.join(" ")+` Tm
`):Zr=I(qn)+" "+I(tr)+` Td
`,Zr},Dr=0;Dr<Ze.length;Dr++){switch(Uu="",Nl){case 1:ju=(q?"<":"(")+Ze[Dr][0]+(q?">":")"),ru=parseFloat(Ze[Dr][1]),Vu=parseFloat(Ze[Dr][2]);break;case 0:ju=(q?"<":"(")+Ze[Dr]+(q?">":")"),ru=ci(H),Vu=Ns(pe)}eu!==void 0&&eu[Dr]!==void 0&&(Uu=eu[Dr]+` Tw
`),Dr===0?N.push(Uu+Rl(ru,Vu,sr)+ju):Nl===0?N.push(Uu+ju):Nl===1&&N.push(Uu+Rl(ru,Vu,sr)+ju)}N=Nl===0?N.join(` Tj
T* `):N.join(` Tj
`),N+=` Tj
`;var Uo=`BT
/`;return Uo+=vt+" "+He+` Tf
`,Uo+=I(He*Re)+` TL
`,Uo+=Vo+`
`,Uo+=ne,Uo+=N,re(Uo+="ET"),m[vt]=!0,w};var Xa=p.__private__.clip=p.clip=function(N){return re(N==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return Xa("evenodd")},p.__private__.discardPath=p.discardPath=function(){return re("n"),this};var Ts=p.__private__.isValidStyle=function(N){var H=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(N)!==-1&&(H=!0),H};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(N){return Ts(N)&&(l=N),this};var Pu=p.__private__.getStyle=p.getStyle=function(N){var H=l;switch(N){case"D":case"S":H="S";break;case"F":H="f";break;case"FD":case"DF":H="B";break;case"f":case"f*":case"B":case"B*":H=N}return H},An=p.close=function(){return re("h"),this};p.stroke=function(){return re("S"),this},p.fill=function(N){return xo("f",N),this},p.fillEvenOdd=function(N){return xo("f*",N),this},p.fillStroke=function(N){return xo("B",N),this},p.fillStrokeEvenOdd=function(N){return xo("B*",N),this};var xo=function(N,H){fr(H)==="object"?El(H,N):re(N)},Js=function(N){N===null||C===P&&N===void 0||(N=Pu(N),re(N))};function Du(N,H,pe,be,Ne){var Xe=new vd(H||this.boundingBox,pe||this.xStep,be||this.yStep,this.gState,Ne||this.matrix);Xe.stream=this.stream;var Ze=N+"$$"+this.cloneIndex+++"$$";return li(Ze,Xe),Xe}var El=function(N,H){var pe=Bn[N.key],be=Ot[pe];if(be instanceof Qh)re("q"),re(Sl(H)),be.gState&&p.setGState(be.gState),re(N.matrix.toString()+" cm"),re("/"+pe+" sh"),re("Q");else if(be instanceof vd){var Ne=new Kt(1,0,0,-1,0,to());N.matrix&&(Ne=Ne.multiply(N.matrix||Yi),pe=Du.call(be,N.key,N.boundingBox,N.xStep,N.yStep,Ne).id),re("q"),re("/Pattern cs"),re("/"+pe+" scn"),be.gState&&p.setGState(be.gState),re(H),re("Q")}},Sl=function(N){switch(N){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ya=p.moveTo=function(N,H){return re(I(j(N))+" "+I(X(H))+" m"),this},ps=p.lineTo=function(N,H){return re(I(j(N))+" "+I(X(H))+" l"),this},Zi=p.curveTo=function(N,H,pe,be,Ne,Xe){return re([I(j(N)),I(X(H)),I(j(pe)),I(X(be)),I(j(Ne)),I(X(Xe)),"c"].join(" ")),this};p.__private__.line=p.line=function(N,H,pe,be,Ne){if(isNaN(N)||isNaN(H)||isNaN(pe)||isNaN(be)||!Ts(Ne))throw new Error("Invalid arguments passed to jsPDF.line");return C===T?this.lines([[pe-N,be-H]],N,H,[1,1],Ne||"S"):this.lines([[pe-N,be-H]],N,H,[1,1]).stroke()},p.__private__.lines=p.lines=function(N,H,pe,be,Ne,Xe){var Ze,wt,It,Zt,Ft,kn,mr,sr,w,B,q,ne;if(typeof N=="number"&&(ne=pe,pe=H,H=N,N=ne),be=be||[1,1],Xe=Xe||!1,isNaN(H)||isNaN(pe)||!Array.isArray(N)||!Array.isArray(be)||!Ts(Ne)||typeof Xe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ya(H,pe),Ze=be[0],wt=be[1],Zt=N.length,B=H,q=pe,It=0;It<Zt;It++)(Ft=N[It]).length===2?(B=Ft[0]*Ze+B,q=Ft[1]*wt+q,ps(B,q)):(kn=Ft[0]*Ze+B,mr=Ft[1]*wt+q,sr=Ft[2]*Ze+B,w=Ft[3]*wt+q,B=Ft[4]*Ze+B,q=Ft[5]*wt+q,Zi(kn,mr,sr,w,B,q));return Xe&&An(),Js(Ne),this},p.path=function(N){for(var H=0;H<N.length;H++){var pe=N[H],be=pe.c;switch(pe.op){case"m":Ya(be[0],be[1]);break;case"l":ps(be[0],be[1]);break;case"c":Zi.apply(this,be);break;case"h":An()}}return this},p.__private__.rect=p.rect=function(N,H,pe,be,Ne){if(isNaN(N)||isNaN(H)||isNaN(pe)||isNaN(be)||!Ts(Ne))throw new Error("Invalid arguments passed to jsPDF.rect");return C===T&&(be=-be),re([I(j(N)),I(X(H)),I(j(pe)),I(j(be)),"re"].join(" ")),Js(Ne),this},p.__private__.triangle=p.triangle=function(N,H,pe,be,Ne,Xe,Ze){if(isNaN(N)||isNaN(H)||isNaN(pe)||isNaN(be)||isNaN(Ne)||isNaN(Xe)||!Ts(Ze))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[pe-N,be-H],[Ne-pe,Xe-be],[N-Ne,H-Xe]],N,H,[1,1],Ze,!0),this},p.__private__.roundedRect=p.roundedRect=function(N,H,pe,be,Ne,Xe,Ze){if(isNaN(N)||isNaN(H)||isNaN(pe)||isNaN(be)||isNaN(Ne)||isNaN(Xe)||!Ts(Ze))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var wt=4/3*(Math.SQRT2-1);return Ne=Math.min(Ne,.5*pe),Xe=Math.min(Xe,.5*be),this.lines([[pe-2*Ne,0],[Ne*wt,0,Ne,Xe-Xe*wt,Ne,Xe],[0,be-2*Xe],[0,Xe*wt,-Ne*wt,Xe,-Ne,Xe],[2*Ne-pe,0],[-Ne*wt,0,-Ne,-Xe*wt,-Ne,-Xe],[0,2*Xe-be],[0,-Xe*wt,Ne*wt,-Xe,Ne,-Xe]],N+Ne,H,[1,1],Ze,!0),this},p.__private__.ellipse=p.ellipse=function(N,H,pe,be,Ne){if(isNaN(N)||isNaN(H)||isNaN(pe)||isNaN(be)||!Ts(Ne))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Xe=4/3*(Math.SQRT2-1)*pe,Ze=4/3*(Math.SQRT2-1)*be;return Ya(N+pe,H),Zi(N+pe,H-Ze,N+Xe,H-be,N,H-be),Zi(N-Xe,H-be,N-pe,H-Ze,N-pe,H),Zi(N-pe,H+Ze,N-Xe,H+be,N,H+be),Zi(N+Xe,H+be,N+pe,H+Ze,N+pe,H),Js(Ne),this},p.__private__.circle=p.circle=function(N,H,pe,be){if(isNaN(N)||isNaN(H)||isNaN(pe)||!Ts(be))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(N,H,pe,pe,be)},p.setFont=function(N,H,pe){return pe&&(H=L(H,pe)),vt=xl(N,H,{disableWarning:!1}),this};var ks=p.__private__.getFont=p.getFont=function(){return rn[xl.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var N,H,pe={};for(N in un)if(un.hasOwnProperty(N))for(H in pe[N]=[],un[N])un[N].hasOwnProperty(H)&&pe[N].push(H);return pe},p.addFont=function(N,H,pe,be,Ne){var Xe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Xe.indexOf(arguments[3])!==-1?Ne=arguments[3]:arguments[3]&&Xe.indexOf(arguments[3])==-1&&(pe=L(pe,be)),Ka.call(this,N,H,pe,Ne=Ne||"Identity-H")};var eo,jr=n.lineWidth||.200025,Qa=p.__private__.getLineWidth=p.getLineWidth=function(){return jr},Xt=p.__private__.setLineWidth=p.setLineWidth=function(N){return jr=N,re(I(j(N))+" w"),this};p.__private__.setLineDash=Wt.API.setLineDash=Wt.API.setLineDashPattern=function(N,H){if(N=N||[],H=H||0,isNaN(H)||!Array.isArray(N))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return N=N.map(function(pe){return I(j(pe))}).join(" "),H=I(j(H)),re("["+N+"] "+H+" d"),this};var _o=p.__private__.getLineHeight=p.getLineHeight=function(){return He*eo};p.__private__.getLineHeight=p.getLineHeight=function(){return He*eo};var hc=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(N){return typeof(N=N||1.15)=="number"&&(eo=N),this},Aa=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return eo};hc(n.lineHeight);var ci=p.__private__.getHorizontalCoordinate=function(N){return j(N)},Ns=p.__private__.getVerticalCoordinate=function(N){return C===P?N:Gt[J].mediaBox.topRightY-Gt[J].mediaBox.bottomLeftY-j(N)},Lu=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(N){return I(ci(N))},Jn=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(N){return I(Ns(N))},Ja=n.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Fo(Ja)},p.__private__.setStrokeColor=p.setDrawColor=function(N,H,pe,be){return Ja=Vr({ch1:N,ch2:H,ch3:pe,ch4:be,pdfColorType:"draw",precision:2}),re(Ja),this};var Al=n.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Fo(Al)},p.__private__.setFillColor=p.setFillColor=function(N,H,pe,be){return Al=Vr({ch1:N,ch2:H,ch3:pe,ch4:be,pdfColorType:"fill",precision:2}),re(Al),this};var Vo=n.textColor||"0 g",Ca=p.__private__.getTextColor=p.getTextColor=function(){return Fo(Vo)};p.__private__.setTextColor=p.setTextColor=function(N,H,pe,be){return Vo=Vr({ch1:N,ch2:H,ch3:pe,ch4:be,pdfColorType:"text",precision:3}),this};var Fi=n.charSpace,Zs=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Fi||0)};p.__private__.setCharSpace=p.setCharSpace=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Fi=N,this};var jo=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(N){var H=p.CapJoinStyles[N];if(H===void 0)throw new Error("Line cap style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return jo=H,re(H+" J"),this};var Mu=0;p.__private__.setLineJoin=p.setLineJoin=function(N){var H=p.CapJoinStyles[N];if(H===void 0)throw new Error("Line join style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Mu=H,re(H+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(N){if(N=N||0,isNaN(N))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return re(I(j(N))+" M"),this},p.GState=b0,p.setGState=function(N){(N=typeof N=="string"?Ht[Jt[N]]:Ou(null,N)).equals(jn)||(re("/"+N.id+" gs"),jn=N)};var Ou=function(N,H){if(!N||!Jt[N]){var pe=!1;for(var be in Ht)if(Ht.hasOwnProperty(be)&&Ht[be].equals(H)){pe=!0;break}if(pe)H=Ht[be];else{var Ne="GS"+(Object.keys(Ht).length+1).toString(10);Ht[Ne]=H,H.id=Ne}return N&&(Jt[N]=H.id),Cn.publish("addGState",H),H}};p.addGState=function(N,H){return Ou(N,H),this},p.saveGraphicsState=function(){return re("q"),On.push({key:vt,size:He,color:Vo}),this},p.restoreGraphicsState=function(){re("Q");var N=On.pop();return vt=N.key,He=N.size,Vo=N.color,jn=null,this},p.setCurrentTransformationMatrix=function(N){return re(N.toString()+" cm"),this},p.comment=function(N){return re("#"+N),this};var Ai=function(N,H){var pe=N||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return pe},set:function(Xe){isNaN(Xe)||(pe=parseFloat(Xe))}});var be=H||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return be},set:function(Xe){isNaN(Xe)||(be=parseFloat(Xe))}});var Ne="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ne},set:function(Xe){Ne=Xe.toString()}}),this},Ia=function(N,H,pe,be){Ai.call(this,N,H),this.type="rect";var Ne=pe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ne},set:function(Ze){isNaN(Ze)||(Ne=parseFloat(Ze))}});var Xe=be||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Xe},set:function(Ze){isNaN(Ze)||(Xe=parseFloat(Ze))}}),this},ea=function(){this.page=Dt,this.currentPage=J,this.pages=Ae.slice(0),this.pagesContext=Gt.slice(0),this.x=yt,this.y=dr,this.matrix=mn,this.width=ms(J),this.height=Ta(J),this.outputDestination=Le,this.id="",this.objectNumber=-1};ea.prototype.restore=function(){Dt=this.page,J=this.currentPage,Gt=this.pagesContext,Ae=this.pages,yt=this.x,dr=this.y,mn=this.matrix,Cl(J,this.width),Ci(J,this.height),Le=this.outputDestination};var Bi=function(N,H,pe,be,Ne){ui.push(new ea),Dt=J=0,Ae=[],yt=N,dr=H,mn=Ne,Qs([pe,be])};for(var Rs in p.beginFormObject=function(N,H,pe,be,Ne){return Bi(N,H,pe,be,Ne),this},p.endFormObject=function(N){return(function(H){if(As[H])ui.pop().restore();else{var pe=new ea,be="Xo"+(Object.keys(ai).length+1).toString(10);pe.id=be,As[H]=be,ai[be]=pe,Cn.publish("addFormObject",pe),ui.pop().restore()}})(N),this},p.doFormObject=function(N,H){var pe=ai[As[N]];return re("q"),re(H.toString()+" cm"),re("/"+pe.id+" Do"),re("Q"),this},p.getFormObject=function(N){var H=ai[As[N]];return{x:H.x,y:H.y,width:H.width,height:H.height,matrix:H.matrix}},p.save=function(N,H){return N=N||"generated.pdf",(H=H||{}).returnPromise=H.returnPromise||!1,H.returnPromise===!1?(Kh(Tn(Oi()),N),typeof Kh.unload=="function"&&pn.setTimeout&&setTimeout(Kh.unload,911),this):new Promise(function(pe,be){try{var Ne=Kh(Tn(Oi()),N);typeof Kh.unload=="function"&&pn.setTimeout&&setTimeout(Kh.unload,911),pe(Ne)}catch(Xe){be(Xe.message)}})},Wt.API)Wt.API.hasOwnProperty(Rs)&&(Rs==="events"&&Wt.API.events.length?(function(N,H){var pe,be,Ne;for(Ne=H.length-1;Ne!==-1;Ne--)pe=H[Ne][0],be=H[Ne][1],N.subscribe.apply(N,[pe].concat(typeof be=="function"?[be]:be))})(Cn,Wt.API.events):p[Rs]=Wt.API[Rs]);function ms(N){return Gt[N].mediaBox.topRightX-Gt[N].mediaBox.bottomLeftX}function Cl(N,H){Gt[N].mediaBox.topRightX=H+Gt[N].mediaBox.bottomLeftX}function Ta(N){return Gt[N].mediaBox.topRightY-Gt[N].mediaBox.bottomLeftY}function Ci(N,H){Gt[N].mediaBox.topRightY=H+Gt[N].mediaBox.bottomLeftY}var gs=p.getPageWidth=function(N){return ms(N=N||J)/en},hi=p.setPageWidth=function(N,H){Cl(N,H*en)},to=p.getPageHeight=function(N){return Ta(N=N||J)/en},ka=p.setPageHeight=function(N,H){Ci(N,H*en)};return p.internal={pdfEscape:Qi,getStyle:Pu,getFont:ks,getFontSize:lt,getCharSpace:Zs,getTextColor:Ca,getLineHeight:_o,getLineHeightFactor:Aa,getLineWidth:Qa,write:rt,getHorizontalCoordinate:ci,getVerticalCoordinate:Ns,getCoordinateString:Lu,getVerticalCoordinateString:Jn,collections:{},newObject:Xn,newAdditionalObject:Ei,newObjectDeferred:or,newObjectDeferredBegin:Rr,getFilters:yo,putStream:wo,events:Cn,scaleFactor:en,pageSize:{getWidth:function(){return gs(J)},setWidth:function(N){hi(J,N)},getHeight:function(){return to(J)},setHeight:function(N){ka(J,N)}},encryptionOptions:h,encryption:br,getEncryptor:function(N){return h!==null?br.encryptor(N,0):function(H){return H}},output:Is,getNumberOfPages:Ji,get pages(){return Ae},out:re,f2:k,f3:M,getPageInfo:ds,getPageInfoByObjId:Ru,getCurrentPageInfo:_l,getPDFVersion:b,Point:Ai,Rectangle:Ia,Matrix:Kt,hasHotfix:Si},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return gs(J)},set:function(N){hi(J,N)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return to(J)},set:function(N){ka(J,N)},enumerable:!0,configurable:!0}),(function(N){for(var H=0,pe=gt.length;H<pe;H++){var be=Ka.call(this,N[H][0],N[H][1],N[H][2],gt[H][3],!0);d===!1&&(m[be]=!0);var Ne=N[H][0].split("-");cc({id:be,fontName:Ne[0],fontStyle:Ne[1]||""})}Cn.publish("addFonts",{fonts:rn,dictionary:un})}).call(p,gt),vt="F1",Nu(i,t),Cn.publish("initialized"),p}sd.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},sd.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},sd.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},sd.prototype.processOwnerPassword=function(n,e){return Nw(kw(e).substr(0,5),n)},sd.prototype.encryptor=function(n,e){var t=kw(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return Nw(t,r)}},b0.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||fr(n)!==fr(this))return!1;var r=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;r++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&r--;return r===0},Wt.API={events:[]},Wt.version="3.0.4";var oi=Wt.API,Gx=1,Sf=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ed=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},bn=function(n){return n.toFixed(2)},Bc=function(n){return n.toFixed(5)};oi.__acroform__={};var $s=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},YA=function(n){return n*Gx},Yu=function(n){var e=new TN,t=kt.internal.getHeight(n)||0,r=kt.internal.getWidth(n)||0;return e.BBox=[0,0,Number(bn(r)),Number(bn(t))],e},zq=oi.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<e},Wq=oi.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<e)},qq=oi.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},yi=oi.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return qq(n,e-1)},wi=oi.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return zq(n,e-1)},bi=oi.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Wq(n,e-1)},Hq=oi.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=n[0],o=n[1],s=n[2],a=n[3],u={};return u.lowerLeft_X=t(i)||0,u.lowerLeft_Y=r(o+a)||0,u.upperRight_X=t(i+s)||0,u.upperRight_Y=r(o)||0,[Number(bn(u.lowerLeft_X)),Number(bn(u.lowerLeft_Y)),Number(bn(u.upperRight_X)),Number(bn(u.upperRight_Y))]},Gq=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,r=Rw(n,t),i=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+i+" "+bn(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Yu(n);return o.scope=n.scope,o.stream=e.join(`
`),o}},Rw=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=n.multiline?i.map(function(k){return k.split(`
`)}):i.map(function(k){return[k]});var o=t,s=kt.internal.getHeight(n)||0;s=s<0?-s:s;var a=kt.internal.getWidth(n)||0;a=a<0?-a:a;var u=function(k,M,j){if(k+1<i.length){var X=M+" "+i[k+1][0];return pv(X,n,j).width<=a-4}return!1};o++;e:for(;o>0;){e="",o--;var l,h,d=pv("3",n,o).height,m=n.multiline?s-o:(s-d)/2,p=m+=2,y=0,b=0,x=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+pv(e,n,o=12).width+", FieldWidth:"+a+`
`;break}for(var E="",T=0,P=0;P<i.length;P++)if(i.hasOwnProperty(P)){var C=!1;if(i[P].length!==1&&x!==i[P].length-1){if((d+2)*(T+2)+2>s)continue e;E+=i[P][x],C=!0,b=P,P--}else{E=(E+=i[P][x]+" ").substr(E.length-1)==" "?E.substr(0,E.length-1):E;var D=parseInt(P),z=u(D,E,o),L=P>=i.length-1;if(z&&!L){E+=" ",x=0;continue}if(z||L){if(L)b=D;else if(n.multiline&&(d+2)*(T+2)+2>s)continue e}else{if(!n.multiline||(d+2)*(T+2)+2>s)continue e;b=D}}for(var I="",A=y;A<=b;A++){var O=i[A];if(n.multiline){if(A===b){I+=O[x]+" ",x=(x+1)%O.length;continue}if(A===y){I+=O[O.length-1]+" ";continue}}I+=O[0]+" "}switch(I=I.substr(I.length-1)==" "?I.substr(0,I.length-1):I,h=pv(I,n,o).width,n.textAlign){case"right":l=a-h-2;break;case"center":l=(a-h)/2;break;default:l=2}e+=bn(l)+" "+bn(p)+` Td
`,e+="("+Sf(I)+`) Tj
`,e+=-bn(l)+` 0 Td
`,p=-(o+2),h=0,y=C?b:b+1,T++,E=""}break}return r.text=e,r.fontSize=o,r},pv=function(n,e,t){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(n,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:i}},$q={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Kq=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},Xq=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Iu.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify($q)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Gx=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new kN,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];o.objId=void 0,o.hasAnnotation&&Kq(o,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(r,i){var o=!r;for(var s in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(s)){var a=r[s],u=[],l=a.Rect;if(a.Rect&&(a.Rect=Hq(a.Rect,i)),i.internal.newObjectDeferredBegin(a.objId,!0),a.DA=kt.createDefaultAppearanceStream(a),fr(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(u=a.getKeyValueListForStream()),a.Rect=l,a.hasAppearanceStream&&!a.appearanceStreamContent){var h=Gq(a);u.push({key:"AP",value:"<</N "+h+">>"}),i.internal.acroformPlugin.xForms.push(h)}if(a.appearanceStreamContent){var d="";for(var m in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(m)){var p=a.appearanceStreamContent[m];if(d+="/"+m+" ",d+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var s in p)if(p.hasOwnProperty(s)){var y=p[s];typeof y=="function"&&(y=y.call(i,a)),d+="/"+s+" "+y+" ",i.internal.acroformPlugin.xForms.indexOf(y)>=0||i.internal.acroformPlugin.xForms.push(y)}}else typeof(y=p)=="function"&&(y=y.call(i,a)),d+="/"+s+" "+y,i.internal.acroformPlugin.xForms.indexOf(y)>=0||i.internal.acroformPlugin.xForms.push(y);d+=">>"}u.push({key:"AP",value:`<<
`+d+">>"})}i.internal.putStream({additionalKeyValues:u,objectId:a.objId}),i.internal.out("endobj")}o&&(function(b,x){for(var E in b)if(b.hasOwnProperty(E)){var T=E,P=b[E];x.internal.newObjectDeferredBegin(P.objId,!0),fr(P)==="object"&&typeof P.putStream=="function"&&P.putStream(),delete b[T]}})(i.internal.acroformPlugin.xForms,i)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},IN=oi.__acroform__.arrayToPdfArray=function(n,e,t){var r=function(s){return s};if(Array.isArray(n)){for(var i="[",o=0;o<n.length;o++)switch(o!==0&&(i+=" "),fr(n[o])){case"boolean":case"number":case"object":i+=n[o].toString();break;case"string":n[o].substr(0,1)!=="/"?(e!==void 0&&t&&(r=t.internal.getEncryptor(e)),i+="("+Sf(r(n[o].toString()))+")"):i+=n[o].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},y2=function(n,e,t){var r=function(i){return i};return e!==void 0&&t&&(r=t.internal.getEncryptor(e)),(n=n||"").toString(),"("+Sf(r(n))+")"},ol=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ol.prototype.toString=function(){return this.objId+" 0 R"},ol.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},ol.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var r=e[t],i=this[r];i&&(Array.isArray(i)?n.push({key:r,value:IN(i,this.objId,this.scope)}):i instanceof ol?(i.scope=this.scope,n.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&n.push({key:r,value:i}))}return n};var TN=function(){ol.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};$s(TN,ol);var kN=function(){ol.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Sf(t(n))+")"}},set:function(t){n=t}})};$s(kN,ol);var Iu=function n(){ol.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute F supplied.');e=E}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!yi(e,3)},set:function(E){E?this.F=wi(e,3):this.F=bi(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute Ff supplied.');t=E}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(E){r=E!==void 0?E:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(E){r[0]=E}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(E){r[1]=E}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(E){r[2]=E}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(E){r[3]=E}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(E){switch(E){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=E;break;default:throw new Error('Invalid value "'+E+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof x0)return;o="FieldObject"+n.FieldNum++}var E=function(T){return T};return this.scope&&(E=this.scope.internal.getEncryptor(this.objId)),"("+Sf(E(o))+")"},set:function(E){o=E.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(E){o=E}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(E){s=E}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(E){a=E}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(E){u=E}});var l=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return l===void 0?50/Gx:l},set:function(E){l=E}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(E){h=E}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof x0||this instanceof sf))return y2(d,this.objId,this.scope)},set:function(E){E=E.toString(),d=E}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof fo==0?y2(m,this.objId,this.scope):m},set:function(E){E=E.toString(),m=this instanceof fo==0?E.substr(0,1)==="("?ed(E.substr(1,E.length-2)):ed(E):E}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof fo==1?ed(m.substr(1,m.length-1)):m},set:function(E){E=E.toString(),m=this instanceof fo==1?"/"+E:E}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(E){this.V=E}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof fo==0?y2(p,this.objId,this.scope):p},set:function(E){E=E.toString(),p=this instanceof fo==0?E.substr(0,1)==="("?ed(E.substr(1,E.length-2)):ed(E):E}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof fo==1?ed(p.substr(1,p.length-1)):p},set:function(E){E=E.toString(),p=this instanceof fo==1?"/"+E:E}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(E){E=!!E,b=E}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(E){y=E}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,1)},set:function(E){E?this.Ff=wi(this.Ff,1):this.Ff=bi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,2)},set:function(E){E?this.Ff=wi(this.Ff,2):this.Ff=bi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,3)},set:function(E){E?this.Ff=wi(this.Ff,3):this.Ff=bi(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(E){if([0,1,2].indexOf(E)===-1)throw new Error('Invalid value "'+E+'" for attribute Q supplied.');x=E}}),Object.defineProperty(this,"textAlign",{get:function(){var E;switch(x){case 0:default:E="left";break;case 1:E="center";break;case 2:E="right"}return E},configurable:!0,enumerable:!0,set:function(E){switch(E){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};$s(Iu,ol);var Cd=function(){Iu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return IN(e,this.objId,this.scope)},set:function(t){var r,i;i=[],typeof(r=t)=="string"&&(i=(function(o,s,a){a||(a=1);for(var u,l=[];u=s.exec(o);)l.push(u[a]);return l})(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,18)},set:function(t){t?this.Ff=wi(this.Ff,18):this.Ff=bi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=wi(this.Ff,19):this.Ff=bi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,20)},set:function(t){t?(this.Ff=wi(this.Ff,20),e.sort()):this.Ff=bi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,22)},set:function(t){t?this.Ff=wi(this.Ff,22):this.Ff=bi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,23)},set:function(t){t?this.Ff=wi(this.Ff,23):this.Ff=bi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,27)},set:function(t){t?this.Ff=wi(this.Ff,27):this.Ff=bi(this.Ff,27)}}),this.hasAppearanceStream=!1};$s(Cd,Iu);var Id=function(){Cd.call(this),this.fontName="helvetica",this.combo=!1};$s(Id,Cd);var Td=function(){Id.call(this),this.combo=!0};$s(Td,Id);var kv=function(){Td.call(this),this.edit=!0};$s(kv,Td);var fo=function(){Iu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,15)},set:function(t){t?this.Ff=wi(this.Ff,15):this.Ff=bi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,16)},set:function(t){t?this.Ff=wi(this.Ff,16):this.Ff=bi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,17)},set:function(t){t?this.Ff=wi(this.Ff,17):this.Ff=bi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,26)},set:function(t){t?this.Ff=wi(this.Ff,26):this.Ff=bi(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+Sf(t(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(t){fr(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};$s(fo,Iu);var Nv=function(){fo.call(this),this.pushButton=!0};$s(Nv,fo);var kd=function(){fo.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};$s(kd,fo);var x0=function(){var n,e;Iu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(a){return a};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),r)s.push("/"+o+" ("+Sf(i(r[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){fr(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(i){t="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=kt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};$s(x0,Iu),kd.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},kd.prototype.createOption=function(n){var e=new x0;return e.Parent=this,e.optionName=n,this.Kids.push(e),Yq.call(this.scope,e),e};var Rv=function(){fo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=kt.CheckBox.createAppearanceStream()};$s(Rv,fo);var sf=function(){Iu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,13)},set:function(e){e?this.Ff=wi(this.Ff,13):this.Ff=bi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,21)},set:function(e){e?this.Ff=wi(this.Ff,21):this.Ff=bi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,23)},set:function(e){e?this.Ff=wi(this.Ff,23):this.Ff=bi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,24)},set:function(e){e?this.Ff=wi(this.Ff,24):this.Ff=bi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,25)},set:function(e){e?this.Ff=wi(this.Ff,25):this.Ff=bi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,26)},set:function(e){e?this.Ff=wi(this.Ff,26):this.Ff=bi(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};$s(sf,Iu);var Pv=function(){sf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!yi(this.Ff,14)},set:function(n){n?this.Ff=wi(this.Ff,14):this.Ff=bi(this.Ff,14)}}),this.password=!0};$s(Pv,sf);var kt={CheckBox:{createAppearanceStream:function(){return{N:{On:kt.CheckBox.YesNormal},D:{On:kt.CheckBox.YesPushDown,Off:kt.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=[],r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,i=n.scope.__private__.encodeColorString(n.color),o=Rw(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+bn(kt.internal.getWidth(n))+" "+bn(kt.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+bn(o.fontSize)+" Tf "+i),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=Yu(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),i=[],o=kt.internal.getHeight(n),s=kt.internal.getWidth(n),a=Rw(n,n.caption);return i.push("1 g"),i.push("0 0 "+bn(s)+" "+bn(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+bn(s-1)+" "+bn(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+t+" "+bn(a.fontSize)+" Tf "+r),i.push(a.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+bn(kt.internal.getWidth(n))+" "+bn(kt.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:kt.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=kt.RadioButton.Circle.YesNormal,e.D[n]=kt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=Yu(n);e.scope=n.scope;var t=[],r=kt.internal.getWidth(n)<=kt.internal.getHeight(n)?kt.internal.getWidth(n)/4:kt.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=kt.internal.Bezier_C,o=Number((r*i).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Bc(kt.internal.getWidth(n)/2)+" "+Bc(kt.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=[],r=kt.internal.getWidth(n)<=kt.internal.getHeight(n)?kt.internal.getWidth(n)/4:kt.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),o=Number((i*kt.internal.Bezier_C).toFixed(5)),s=Number((r*kt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Bc(kt.internal.getWidth(n)/2)+" "+Bc(kt.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Bc(kt.internal.getWidth(n)/2)+" "+Bc(kt.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=[],r=kt.internal.getWidth(n)<=kt.internal.getHeight(n)?kt.internal.getWidth(n)/4:kt.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),o=Number((i*kt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Bc(kt.internal.getWidth(n)/2)+" "+Bc(kt.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:kt.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=kt.RadioButton.Cross.YesNormal,e.D[n]=kt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=Yu(n);e.scope=n.scope;var t=[],r=kt.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+bn(kt.internal.getWidth(n)-2)+" "+bn(kt.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(bn(r.x1.x)+" "+bn(r.x1.y)+" m"),t.push(bn(r.x2.x)+" "+bn(r.x2.y)+" l"),t.push(bn(r.x4.x)+" "+bn(r.x4.y)+" m"),t.push(bn(r.x3.x)+" "+bn(r.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=kt.internal.calculateCross(n),r=[];return r.push("0.749023 g"),r.push("0 0 "+bn(kt.internal.getWidth(n))+" "+bn(kt.internal.getHeight(n))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+bn(kt.internal.getWidth(n)-2)+" "+bn(kt.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(bn(t.x1.x)+" "+bn(t.x1.y)+" m"),r.push(bn(t.x2.x)+" "+bn(t.x2.y)+" l"),r.push(bn(t.x4.x)+" "+bn(t.x4.y)+" m"),r.push(bn(t.x3.x)+" "+bn(t.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=Yu(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+bn(kt.internal.getWidth(n))+" "+bn(kt.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};kt.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=kt.internal.getWidth(n),t=kt.internal.getHeight(n),r=Math.min(e,t);return{x1:{x:(e-r)/2,y:(t-r)/2+r},x2:{x:(e-r)/2+r,y:(t-r)/2},x3:{x:(e-r)/2,y:(t-r)/2},x4:{x:(e-r)/2+r,y:(t-r)/2+r}}}},kt.internal.getWidth=function(n){var e=0;return fr(n)==="object"&&(e=YA(n.Rect[2])),e},kt.internal.getHeight=function(n){var e=0;return fr(n)==="object"&&(e=YA(n.Rect[3])),e};var Yq=oi.addField=function(n){if(Xq(this,n),!(n instanceof Iu))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};oi.AcroFormChoiceField=Cd,oi.AcroFormListBox=Id,oi.AcroFormComboBox=Td,oi.AcroFormEditBox=kv,oi.AcroFormButton=fo,oi.AcroFormPushButton=Nv,oi.AcroFormRadioButton=kd,oi.AcroFormCheckBox=Rv,oi.AcroFormTextField=sf,oi.AcroFormPasswordField=Pv,oi.AcroFormAppearance=kt,oi.AcroForm={ChoiceField:Cd,ListBox:Id,ComboBox:Td,EditBox:kv,Button:fo,PushButton:Nv,RadioButton:kd,CheckBox:Rv,TextField:sf,PasswordField:Pv,Appearance:kt},Wt.AcroForm={ChoiceField:Cd,ListBox:Id,ComboBox:Td,EditBox:kv,Button:fo,PushButton:Nv,RadioButton:kd,CheckBox:Rv,TextField:sf,PasswordField:Pv,Appearance:kt};Wt.AcroForm;function NN(n){return n.reduce(function(e,t,r){return e[t]=r,e},{})}(function(n){var e="addImage_";n.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=n.__addimage__.getImageFileTypeByImageData=function(k,M){var j,X,ue,ge,ce,$=t;if((M=M||t)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(z(k))for(ce in r)for(ue=r[ce],j=0;j<ue.length;j+=1){for(ge=!0,X=0;X<ue[j].length;X+=1)if(ue[j][X]!==void 0&&ue[j][X]!==k[X]){ge=!1;break}if(ge===!0){$=ce;break}}else for(ce in r)for(ue=r[ce],j=0;j<ue.length;j+=1){for(ge=!0,X=0;X<ue[j].length;X+=1)if(ue[j][X]!==void 0&&ue[j][X]!==k.charCodeAt(X)){ge=!1;break}if(ge===!0){$=ce;break}}return $===t&&M!==t&&($=M),$},o=function k(M){for(var j=this.internal.write,X=this.internal.putStream,ue=(0,this.internal.getFilters)();ue.indexOf("FlateEncode")!==-1;)ue.splice(ue.indexOf("FlateEncode"),1);M.objectId=this.internal.newObject();var ge=[];if(ge.push({key:"Type",value:"/XObject"}),ge.push({key:"Subtype",value:"/Image"}),ge.push({key:"Width",value:M.width}),ge.push({key:"Height",value:M.height}),M.colorSpace===E.INDEXED?ge.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(M.palette.length/3-1)+" "+("sMask"in M&&M.sMask!==void 0?M.objectId+2:M.objectId+1)+" 0 R]"}):(ge.push({key:"ColorSpace",value:"/"+M.colorSpace}),M.colorSpace===E.DEVICE_CMYK&&ge.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ge.push({key:"BitsPerComponent",value:M.bitsPerComponent}),"decodeParameters"in M&&M.decodeParameters!==void 0&&ge.push({key:"DecodeParms",value:"<<"+M.decodeParameters+">>"}),"transparency"in M&&Array.isArray(M.transparency)&&M.transparency.length>0){for(var ce="",$=0,ae=M.transparency.length;$<ae;$++)ce+=M.transparency[$]+" "+M.transparency[$]+" ";ge.push({key:"Mask",value:"["+ce+"]"})}M.sMask!==void 0&&ge.push({key:"SMask",value:M.objectId+1+" 0 R"});var fe=M.filter!==void 0?["/"+M.filter]:void 0;if(X({data:M.data,additionalKeyValues:ge,alreadyAppliedFilters:fe,objectId:M.objectId}),j("endobj"),"sMask"in M&&M.sMask!==void 0){var Q,W=(Q=M.sMaskBitsPerComponent)!==null&&Q!==void 0?Q:M.bitsPerComponent,J={width:M.width,height:M.height,colorSpace:"DeviceGray",bitsPerComponent:W,data:M.sMask};"filter"in M&&(J.decodeParameters="/Predictor ".concat(M.predictor," /Colors 1 /BitsPerComponent ").concat(W," /Columns ").concat(M.width),J.filter=M.filter),k.call(this,J)}if(M.colorSpace===E.INDEXED){var te=this.internal.newObject();X({data:I(new Uint8Array(M.palette)),objectId:te}),j("endobj")}},s=function(){var k=this.internal.collections[e+"images"];for(var M in k)o.call(this,k[M])},a=function(){var k,M=this.internal.collections[e+"images"],j=this.internal.write;for(var X in M)j("/I"+(k=M[X]).index,k.objectId,"0","R")},u=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var k=this.internal.collections[e+"images"];return u.call(this),k},h=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(k){return typeof n["process"+k.toUpperCase()]=="function"},m=function(k){return fr(k)==="object"&&k.nodeType===1},p=function(k,M){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var j=""+k.getAttribute("src");if(j.indexOf("data:image/")===0)return Tv(unescape(j).split("base64,").pop());var X=n.loadFile(j,!0);if(X!==void 0)return X}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var ue;switch(M){case"PNG":ue="image/png";break;case"WEBP":ue="image/webp";break;default:ue="image/jpeg"}return Tv(k.toDataURL(ue,1).split("base64,").pop())}},y=function(k){var M=this.internal.collections[e+"images"];if(M){for(var j in M)if(k===M[j].alias)return M[j]}},b=function(k,M,j){return k||M||(k=-96,M=-96),k<0&&(k=-1*j.width*72/k/this.internal.scaleFactor),M<0&&(M=-1*j.height*72/M/this.internal.scaleFactor),k===0&&(k=M*j.width/j.height),M===0&&(M=k*j.height/j.width),[k,M]},x=function(k,M,j,X,ue,ge){var ce=b.call(this,j,X,ue),$=this.internal.getCoordinateString,ae=this.internal.getVerticalCoordinateString,fe=l.call(this);if(j=ce[0],X=ce[1],fe[ue.index]=ue,ge){ge*=Math.PI/180;var Q=Math.cos(ge),W=Math.sin(ge),J=function(de){return de.toFixed(4)},te=[J(Q),J(W),J(-1*W),J(Q),0,0,"cm"]}this.internal.write("q"),ge?(this.internal.write([1,"0","0",1,$(k),ae(M+X),"cm"].join(" ")),this.internal.write(te.join(" ")),this.internal.write([$(j),"0","0",$(X),"0","0","cm"].join(" "))):this.internal.write([$(j),"0","0",$(X),$(k),ae(M+X),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ue.index+" Do"),this.internal.write("Q")},E=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var T=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},P=n.__addimage__.sHashCode=function(k){var M,j,X=0;if(typeof k=="string")for(j=k.length,M=0;M<j;M++)X=(X<<5)-X+k.charCodeAt(M),X|=0;else if(z(k))for(j=k.byteLength/2,M=0;M<j;M++)X=(X<<5)-X+k[M],X|=0;return X},C=n.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var M=!0;return k.length===0&&(M=!1),k.length%4!=0&&(M=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(M=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(M=!1),M},D=n.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var M=k.indexOf(",");return M<0?null:k.substring(0,M).trim().endsWith("base64")?k.substring(M+1):null};n.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var z=n.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},L=n.__addimage__.binaryStringToUint8Array=function(k){for(var M=k.length,j=new Uint8Array(M),X=0;X<M;X++)j[X]=k.charCodeAt(X);return j},I=n.__addimage__.arrayBufferToBinaryString=function(k){for(var M="",j=z(k)?k:new Uint8Array(k),X=0;X<j.length;X+=8192)M+=String.fromCharCode.apply(null,j.subarray(X,X+8192));return M};n.addImage=function(){var k,M,j,X,ue,ge,ce,$,ae;if(typeof arguments[1]=="number"?(M=t,j=arguments[1],X=arguments[2],ue=arguments[3],ge=arguments[4],ce=arguments[5],$=arguments[6],ae=arguments[7]):(M=arguments[1],j=arguments[2],X=arguments[3],ue=arguments[4],ge=arguments[5],ce=arguments[6],$=arguments[7],ae=arguments[8]),fr(k=arguments[0])==="object"&&!m(k)&&"imageData"in k){var fe=k;k=fe.imageData,M=fe.format||M||t,j=fe.x||j||0,X=fe.y||X||0,ue=fe.w||fe.width||ue,ge=fe.h||fe.height||ge,ce=fe.alias||ce,$=fe.compression||$,ae=fe.rotation||fe.angle||ae}var Q=this.internal.getFilters();if($===void 0&&Q.indexOf("FlateEncode")!==-1&&($="SLOW"),isNaN(j)||isNaN(X))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var W=A.call(this,k,M,ce,$);return x.call(this,j,X,ue,ge,W,ae),this};var A=function(k,M,j,X){var ue,ge,ce;if(typeof k=="string"&&i(k)===t){k=unescape(k);var $=O(k,!1);($!==""||($=n.loadFile(k,!0))!==void 0)&&(k=$)}if(m(k)&&(k=p(k,M)),M=i(k,M),!d(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(((ce=j)==null||ce.length===0)&&(j=(function(ae){return typeof ae=="string"||z(ae)?P(ae):z(ae.data)?P(ae.data):null})(k)),(ue=y.call(this,j))||(k instanceof Uint8Array||M==="RGBA"||(ge=k,k=L(k)),ue=this["process"+M.toUpperCase()](k,h.call(this),j,(function(ae){return ae&&typeof ae=="string"&&(ae=ae.toUpperCase()),ae in n.image_compression?ae:T.NONE})(X),ge)),!ue)throw new Error("An unknown error occurred whilst processing the image.");return ue},O=n.__addimage__.convertBase64ToBinaryString=function(k,M){M=typeof M!="boolean"||M;var j,X="";if(typeof k=="string"){var ue;j=(ue=D(k))!==null&&ue!==void 0?ue:k;try{X=Tv(j)}catch(ge){if(M)throw C(j)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ge.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return X};n.getImageProperties=function(k){var M,j,X="";if(m(k)&&(k=p(k)),typeof k=="string"&&i(k)===t&&((X=O(k,!1))===""&&(X=n.loadFile(k)||""),k=X),j=i(k),!d(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(k instanceof Uint8Array||(k=L(k)),!(M=this["process"+j.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return M.fileType=j,M}})(Wt.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};Wt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var r,i,o,s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(t.objId),l=t.pageContext.annotations,h=!1,d=0;d<l.length&&!h;d++)switch((r=l[d]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var m=0;m<l.length;m++){r=l[m];var p=this.internal.pdfEscape,y=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),E=this.internal.getEncryptor(b.objId),T=r.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(r.bounds.x)+" "+a(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y)+"] ")+"/Contents ("+p(E(r.contents))+")",o+=" /Popup "+x.objId+" 0 R",o+=" /P "+u.objId+" 0 R",o+=" /T ("+p(E(T))+") >>",b.content=o;var P=b.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(r.bounds.x+30)+" "+a(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w+30)+" "+a(r.bounds.y)+"] ")+" /Parent "+P,r.open&&(o+=" /Open true"),o+=" >>",x.content=o,this.internal.write(b.objId,"0 R",x.objId,"0 R");break;case"freetext":i="/Rect ["+s(r.bounds.x)+" "+a(r.bounds.y)+" "+s(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y+r.bounds.h)+"] ";var C=r.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(y(r.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+C+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(r.options.name){var D=this.annotations._nameMap[r.options.name];r.options.pageNumber=D.page,r.options.top=D.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",o="",r.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(y(r.options.url))+") >>";else if(r.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,o+=" /FitV "+r.options.left+"]";break;default:var z=a(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),o+=" /XYZ "+r.options.left+" "+z+" "+r.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},n.link=function(t,r,i,o,s){var a=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:u(t),y:l(r),w:u(t+i),h:l(r+o)},options:s,type:"link"})},n.textWithLink=function(t,r,i,o){var s,a,u=this.getTextWidth(t),l=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){a=o.maxWidth;var h=this.splitTextToSize(t,a).length;s=Math.ceil(l*h)}else a=u,s=l;return this.text(t,r,i,o),i+=.2*l,o.align==="center"&&(r-=u/2),o.align==="right"&&(r-=u),this.link(r,i-l,a,s,o),u},n.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}})(Wt.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];n.__arabicParser__={};var o=n.__arabicParser__.isInArabicSubstitutionA=function(b){return e[b.charCodeAt(0)]!==void 0},s=n.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},a=n.__arabicParser__.isArabicEndLetter=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length<=2},u=n.__arabicParser__.isArabicAlfLetter=function(b){return s(b)&&i.indexOf(b.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length>=1};var l=n.__arabicParser__.arabicLetterHasFinalForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length>=3};var h=n.__arabicParser__.arabicLetterHasMedialForm=function(b){return s(b)&&o(b)&&e[b.charCodeAt(0)].length==4},d=n.__arabicParser__.resolveLigatures=function(b){var x=0,E=t,T="",P=0;for(x=0;x<b.length;x+=1)E[b.charCodeAt(x)]!==void 0?(P++,typeof(E=E[b.charCodeAt(x)])=="number"&&(T+=String.fromCharCode(E),E=t,P=0),x===b.length-1&&(E=t,T+=b.charAt(x-(P-1)),x-=P-1,P=0)):(E=t,T+=b.charAt(x-P),x-=P,P=0);return T};n.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&r[b.charCodeAt(0)]!==void 0};var m=n.__arabicParser__.getCorrectForm=function(b,x,E){return s(b)?o(b)===!1?-1:!l(b)||!s(x)&&!s(E)||!s(E)&&a(x)||a(b)&&!s(x)||a(b)&&u(x)||a(b)&&a(x)?0:h(b)&&s(x)&&!a(x)&&s(E)&&l(E)?3:a(b)||!s(E)?1:2:-1},p=function(b){var x=0,E=0,T=0,P="",C="",D="",z=(b=b||"").split("\\s+"),L=[];for(x=0;x<z.length;x+=1){for(L.push(""),E=0;E<z[x].length;E+=1)P=z[x][E],C=z[x][E-1],D=z[x][E+1],s(P)?(T=m(P,C,D),L[x]+=T!==-1?String.fromCharCode(e[P.charCodeAt(0)][T]):P):L[x]+=P;L[x]=d(L[x])}return L.join(" ")},y=n.__arabicParser__.processArabic=n.processArabic=function(){var b,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,E=[];if(Array.isArray(x)){var T=0;for(E=[],T=0;T<x.length;T+=1)Array.isArray(x[T])?E.push([p(x[T][0]),x[T][1],x[T][2]]):E.push([p(x[T])]);b=E}else b=p(x);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};n.events.push(["preProcessText",y])})(Wt.API),Wt.API.autoPrint=function(n){var e;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(a){t=a}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(a){o=a}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(a){s=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,r){var i;if((t=t||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Wt.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(b){u=b}});var l=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return l},set:function(b){l=b}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(b){h=b}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(b){d=b}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(b){m=b}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(b){p=b}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(b){y=b}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(u){return r.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},n.getTextDimensions=function(u,l){r.call(this);var h=(l=l||{}).fontSize||this.getFontSize(),d=l.font||this.getFont(),m=l.scaleFactor||this.internal.scaleFactor,p=0,y=0,b=0,x=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var E=l.maxWidth;E>0?typeof u=="string"?u=this.splitTextToSize(u,E):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(P,C){return P.concat(x.splitTextToSize(C,E))},[])):u=Array.isArray(u)?u:[u];for(var T=0;T<u.length;T++)p<(b=this.getStringUnitWidth(u[T],{font:d})*h)&&(p=b);return p!==0&&(y=u.length),{w:p/=m,h:Math.max((y*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/m,0)}},n.cellAddPage=function(){r.call(this),this.addPage();var u=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=n.cell=function(){var u;u=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),r.call(this);var l=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,m=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return l.lineNumber!==void 0&&(l.lineNumber===u.lineNumber?(u.x=(l.x||0)+(l.width||0),u.y=l.y||0):l.y+l.height+u.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=d.top,p&&m&&(this.printHeaderRow(u.lineNumber,!0),u.y+=m[0].height)):u.y=l.y+l.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,t===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-h,u.y+h,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+h,{align:"center",baseline:"top",maxWidth:u.width-h-h}):this.text(u.text,u.x+h,u.y+h,{align:"left",baseline:"top",maxWidth:u.width-h-h})),this.internal.__cell__.lastCell=u,this};n.table=function(u,l,h,d,m){if(r.call(this),!h)throw new Error("No data for PDF table.");var p,y,b,x,E=[],T=[],P=[],C={},D={},z=[],L=[],I=(m=m||{}).autoSize||!1,A=m.printHeaders!==!1,O=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,k=m.margins||Object.assign({width:this.getPageWidth()},e),M=typeof m.padding=="number"?m.padding:3,j=m.headerBackgroundColor||"#c8c8c8",X=m.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=O,this.internal.__cell__.padding=M,this.internal.__cell__.headerBackgroundColor=j,this.internal.__cell__.headerTextColor=X,this.setFontSize(O),d==null)T=E=Object.keys(h[0]),P=E.map(function(){return"left"});else if(Array.isArray(d)&&fr(d[0])==="object")for(E=d.map(function(fe){return fe.name}),T=d.map(function(fe){return fe.prompt||fe.name||""}),P=d.map(function(fe){return fe.align||"left"}),p=0;p<d.length;p+=1)D[d[p].name]=.7499990551181103*d[p].width;else Array.isArray(d)&&typeof d[0]=="string"&&(T=E=d,P=E.map(function(){return"left"}));if(I||Array.isArray(d)&&typeof d[0]=="string")for(p=0;p<E.length;p+=1){for(C[x=E[p]]=h.map(function(fe){return fe[x]}),this.setFont(void 0,"bold"),z.push(this.getTextDimensions(T[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=C[x],this.setFont(void 0,"normal"),b=0;b<y.length;b+=1)z.push(this.getTextDimensions(y[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[x]=Math.max.apply(null,z)+M+M,z=[]}if(A){var ue={};for(p=0;p<E.length;p+=1)ue[E[p]]={},ue[E[p]].text=T[p],ue[E[p]].align=P[p];var ge=a.call(this,ue,D);L=E.map(function(fe){return new o(u,l,D[fe],ge,ue[fe].text,void 0,ue[fe].align)}),this.setTableHeaderRow(L),this.printHeaderRow(1,!1)}var ce=d.reduce(function(fe,Q){return fe[Q.name]=Q.align,fe},{});for(p=0;p<h.length;p+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:p,data:h[p]},this);var $=a.call(this,h[p],D);for(b=0;b<E.length;b+=1){var ae=h[p][E[b]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:p,col:b,data:ae},this),s.call(this,new o(u,l,D[E[b]],$,ae,p+2,ce[E[b]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=l,this};var a=function(u,l){var h=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(u).map(function(p){var y=u[p];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,l[p]-h-h)},this).map(function(p){return this.getLineHeightFactor()*p.length*d/m+h+h},this).reduce(function(p,y){return Math.max(p,y)},0)};n.setTableHeaderRow=function(u){r.call(this),this.internal.__cell__.tableHeaderRow=u},n.printHeaderRow=function(u,l){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){h=this.internal.__cell__.tableHeaderRow[p].clone(),l&&(h.y=this.internal.__cell__.margins.top||0,m.push(h)),h.lineNumber=u;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,h),this.setTextColor(y)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),t=!1}})(Wt.API);var RN={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},PN=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Pw=NN(PN),DN=[100,200,300,400,500,600,700,800,900],Qq=NN(DN);function w2(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(o){return RN[o=o||"normal"]?o:"normal"})(n.style),r=(function(o){return o?typeof o=="number"?o>=100&&o<=900&&o%100==0?o:400:/^\d00$/.test(o)?parseInt(o):o==="bold"?700:400:400})(n.weight),i=(function(o){return typeof Pw[o=o||"normal"]=="number"?o:"normal"})(n.stretch);return{family:e,style:t,weight:r,stretch:i,src:n.src||[],ref:n.ref||{name:e,style:[i,t,r].join(" ")}}}function QA(n,e,t,r){var i;for(i=t;i>=0&&i<e.length;i+=r)if(n[e[i]])return n[e[i]];for(i=t;i>=0&&i<e.length;i-=r)if(n[e[i]])return n[e[i]]}var Jq={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},JA={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function ZA(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function eC(n){return n.trimLeft()}function Zq(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function eH(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var mv,tC,nC,td,gv,rC,iC,oC,b2=["times"];function sC(n,e,t,r,i){var o=4,s=uC;switch(i){case Wt.API.image_compression.FAST:o=1,s=aC;break;case Wt.API.image_compression.MEDIUM:o=6,s=lC;break;case Wt.API.image_compression.SLOW:o=9,s=cC}n=(function(u,l,h,d){for(var m,p=u.length/l,y=new Uint8Array(u.length+p),b=[tH,aC,uC,lC,cC],x=0;x<p;x+=1){var E=x*l,T=u.subarray(E,E+l);if(d)y.set(d(T,h,m),E+x);else{for(var P=b.length,C=[],D=0;D<P;D+=1)C[D]=b[D](T,h,m);var z=rH(C.concat());y.set(C[z],E+x)}m=T}return y})(n,e,Math.ceil(t*r/8),s);var a=Aw(n,{level:o});return Wt.API.__addimage__.arrayBufferToBinaryString(a)}function tH(n){var e=Array.apply([],n);return e.unshift(0),e}function aC(n,e){var t=n.length,r=[];r[0]=1;for(var i=0;i<t;i+=1){var o=n[i-e]||0;r[i+1]=n[i]-o+256&255}return r}function uC(n,e,t){var r=n.length,i=[];i[0]=2;for(var o=0;o<r;o+=1){var s=t&&t[o]||0;i[o+1]=n[o]-s+256&255}return i}function lC(n,e,t){var r=n.length,i=[];i[0]=3;for(var o=0;o<r;o+=1){var s=n[o-e]||0,a=t&&t[o]||0;i[o+1]=n[o]+256-(s+a>>>1)&255}return i}function cC(n,e,t){var r=n.length,i=[];i[0]=4;for(var o=0;o<r;o+=1){var s=nH(n[o-e]||0,t&&t[o]||0,t&&t[o-e]||0);i[o+1]=n[o]-s+256&255}return i}function nH(n,e,t){if(n===e&&e===t)return n;var r=Math.abs(e-t),i=Math.abs(n-t),o=Math.abs(n+e-t-t);return r<=i&&r<=o?n:i<=o?e:t}function rH(n){var e=n.map(function(t){return t.reduce(function(r,i){return r+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function x2(n,e,t){var r=e*t,i=Math.floor(r/8),o=16-(r-8*i+t),s=(1<<t)-1;return LN(n,i)>>o&s}function hC(n,e,t,r){var i=t*r,o=Math.floor(i/8),s=16-(i-8*o+r),a=(1<<r)-1,u=(e&a)<<s;(function(l,h,d){if(h+1<l.byteLength)l.setUint16(h,d,!1);else{var m=d>>8&255;l.setUint8(h,m)}})(n,o,LN(n,o)&~(a<<s)&65535|u)}function LN(n,e){return e+1<n.byteLength?n.getUint16(e,!1):n.getUint8(e)<<8}function iH(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,r=n[e++]|n[e++]<<8,i=n[e++],o=i>>7,s=1<<1+(7&i);n[e++],n[e++];var a=null,u=null;o&&(a=e,u=s,e+=3*s);var l=!0,h=[],d=0,m=null,p=0,y=null;for(this.width=t,this.height=r;l&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,y=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((k=n[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var b=n[e++];d=n[e++]|n[e++]<<8,m=n[e++],1&b||(m=null),p=b>>2&7,e++;break;case 254:for(;;){if(!((k=n[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var x=n[e++]|n[e++]<<8,E=n[e++]|n[e++]<<8,T=n[e++]|n[e++]<<8,P=n[e++]|n[e++]<<8,C=n[e++],D=C>>6&1,z=1<<1+(7&C),L=a,I=u,A=!1;C>>7&&(A=!0,L=e,I=z,e+=3*z);var O=e;for(e++;;){var k;if(!((k=n[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}h.push({x,y:E,width:T,height:P,has_local_palette:A,palette_offset:L,palette_size:I,data_offset:O,data_length:e-O,transparent_index:m,interlaced:!!D,delay:d,disposal:p});break;case 59:l=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return y},this.frameInfo=function(M){if(M<0||M>=h.length)throw new Error("Frame index out of range.");return h[M]},this.decodeAndBlitFrameBGRA=function(M,j){var X=this.frameInfo(M),ue=X.width*X.height,ge=new Uint8Array(ue);fC(n,X.data_offset,ge,ue);var ce=X.palette_offset,$=X.transparent_index;$===null&&($=256);var ae=X.width,fe=t-ae,Q=ae,W=4*(X.y*t+X.x),J=4*((X.y+X.height)*t+X.x),te=W,de=4*fe;X.interlaced===!0&&(de+=4*t*7);for(var ve=8,we=0,Se=ge.length;we<Se;++we){var Ie=ge[we];if(Q===0&&(Q=ae,(te+=de)>=J&&(de=4*fe+4*t*(ve-1),te=W+(ae+fe)*(ve<<1),ve>>=1)),Ie===$)te+=4;else{var Fe=n[ce+3*Ie],Ae=n[ce+3*Ie+1],Be=n[ce+3*Ie+2];j[te++]=Be,j[te++]=Ae,j[te++]=Fe,j[te++]=255}--Q}},this.decodeAndBlitFrameRGBA=function(M,j){var X=this.frameInfo(M),ue=X.width*X.height,ge=new Uint8Array(ue);fC(n,X.data_offset,ge,ue);var ce=X.palette_offset,$=X.transparent_index;$===null&&($=256);var ae=X.width,fe=t-ae,Q=ae,W=4*(X.y*t+X.x),J=4*((X.y+X.height)*t+X.x),te=W,de=4*fe;X.interlaced===!0&&(de+=4*t*7);for(var ve=8,we=0,Se=ge.length;we<Se;++we){var Ie=ge[we];if(Q===0&&(Q=ae,(te+=de)>=J&&(de=4*fe+4*t*(ve-1),te=W+(ae+fe)*(ve<<1),ve>>=1)),Ie===$)te+=4;else{var Fe=n[ce+3*Ie],Ae=n[ce+3*Ie+1],Be=n[ce+3*Ie+2];j[te++]=Fe,j[te++]=Ae,j[te++]=Be,j[te++]=255}--Q}}}function fC(n,e,t,r){for(var i=n[e++],o=1<<i,s=o+1,a=s+1,u=i+1,l=(1<<u)-1,h=0,d=0,m=0,p=n[e++],y=new Int32Array(4096),b=null;;){for(;h<16&&p!==0;)d|=n[e++]<<h,h+=8,p===1?p=n[e++]:--p;if(h<u)break;var x=d&l;if(d>>=u,h-=u,x!==o){if(x===s)break;for(var E=x<a?x:b,T=0,P=E;P>o;)P=y[P]>>8,++T;var C=P;if(m+T+(E!==x?1:0)>r)return void _r.log("Warning, gif stream longer than expected.");t[m++]=C;var D=m+=T;for(E!==x&&(t[m++]=C),P=E;T--;)P=y[P],t[--D]=255&P,P>>=8;b!==null&&a<4096&&(y[a++]=b<<8|C,a>=l+1&&u<12&&(++u,l=l<<1|1)),b=x}else a=s+1,l=(1<<(u=i+1))-1,b=null}return m!==r&&_r.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function _2(n){var e,t,r,i,o,s=Math.floor,a=new Array(64),u=new Array(64),l=new Array(64),h=new Array(64),d=new Array(65535),m=new Array(65535),p=new Array(64),y=new Array(64),b=[],x=0,E=7,T=new Array(64),P=new Array(64),C=new Array(64),D=new Array(256),z=new Array(2048),L=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],I=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],O=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],M=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ue=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ge(W,J){for(var te=0,de=0,ve=new Array,we=1;we<=16;we++){for(var Se=1;Se<=W[we];Se++)ve[J[de]]=[],ve[J[de]][0]=te,ve[J[de]][1]=we,de++,te++;te*=2}return ve}function ce(W){for(var J=W[0],te=W[1]-1;te>=0;)J&1<<te&&(x|=1<<E),te--,--E<0&&(x==255?($(255),$(0)):$(x),E=7,x=0)}function $(W){b.push(W)}function ae(W){$(W>>8&255),$(255&W)}function fe(W,J,te,de,ve){for(var we,Se=ve[0],Ie=ve[240],Fe=(function(He,ft){var lt,Et,pt,En,$t,Qt,an,qt,vt,en,yt=0;for(vt=0;vt<8;++vt){lt=He[yt],Et=He[yt+1],pt=He[yt+2],En=He[yt+3],$t=He[yt+4],Qt=He[yt+5],an=He[yt+6];var dr=lt+(qt=He[yt+7]),mn=lt-qt,rn=Et+an,un=Et-an,On=pt+Qt,Ot=pt-Qt,Bn=En+$t,Ht=En-$t,Jt=dr+Bn,jn=dr-Bn,Dt=rn+On,Gt=rn-On;He[yt]=Jt+Dt,He[yt+4]=Jt-Dt;var Cn=.707106781*(Gt+jn);He[yt+2]=jn+Cn,He[yt+6]=jn-Cn;var Mo=.382683433*((Jt=Ht+Ot)-(Gt=un+mn)),ai=.5411961*Jt+Mo,As=1.306562965*Gt+Mo,ui=.707106781*(Dt=Ot+un),Kt=mn+ui,go=mn-ui;He[yt+5]=go+ai,He[yt+3]=go-ai,He[yt+1]=Kt+As,He[yt+7]=Kt-As,yt+=8}for(yt=0,vt=0;vt<8;++vt){lt=He[yt],Et=He[yt+8],pt=He[yt+16],En=He[yt+24],$t=He[yt+32],Qt=He[yt+40],an=He[yt+48];var Yi=lt+(qt=He[yt+56]),li=lt-qt,vo=Et+an,Xn=Et-an,or=pt+Qt,Rr=pt-Qt,Ei=En+$t,Ks=En-$t,Oo=Yi+Ei,Fo=Yi-Ei,Vr=vo+or,yo=vo-or;He[yt]=Oo+Vr,He[yt+32]=Oo-Vr;var wo=.707106781*(yo+Fo);He[yt+16]=Fo+wo,He[yt+48]=Fo-wo;var xa=.382683433*((Oo=Ks+Rr)-(yo=Xn+li)),cs=.5411961*Oo+xa,hs=1.306562965*yo+xa,_a=.707106781*(Vr=Rr+Xn),Xs=li+_a,Cs=li-_a;He[yt+40]=Cs+cs,He[yt+24]=Cs-cs,He[yt+8]=Xs+hs,He[yt+56]=Xs-hs,yt++}for(vt=0;vt<64;++vt)en=He[vt]*ft[vt],p[vt]=en>0?en+.5|0:en-.5|0;return p})(W,J),Ae=0;Ae<64;++Ae)y[L[Ae]]=Fe[Ae];var Be=y[0]-te;te=y[0],Be==0?ce(de[0]):(ce(de[m[we=32767+Be]]),ce(d[we]));for(var Le=63;Le>0&&y[Le]==0;)Le--;if(Le==0)return ce(Se),te;for(var tt,re=1;re<=Le;){for(var rt=re;y[re]==0&&re<=Le;)++re;var zt=re-rt;if(zt>=16){tt=zt>>4;for(var gt=1;gt<=tt;++gt)ce(Ie);zt&=15}we=32767+y[re],ce(ve[(zt<<4)+m[we]]),ce(d[we]),re++}return Le!=63&&ce(Se),te}function Q(W){W=Math.min(Math.max(W,1),100),o!=W&&((function(J){for(var te=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],de=0;de<64;de++){var ve=s((te[de]*J+50)/100);ve=Math.min(Math.max(ve,1),255),a[L[de]]=ve}for(var we=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Se=0;Se<64;Se++){var Ie=s((we[Se]*J+50)/100);Ie=Math.min(Math.max(Ie,1),255),u[L[Se]]=Ie}for(var Fe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ae=0,Be=0;Be<8;Be++)for(var Le=0;Le<8;Le++)l[Ae]=1/(a[L[Ae]]*Fe[Be]*Fe[Le]*8),h[Ae]=1/(u[L[Ae]]*Fe[Be]*Fe[Le]*8),Ae++})(W<50?Math.floor(5e3/W):Math.floor(200-2*W)),o=W)}this.encode=function(W,J){J&&Q(J),b=new Array,x=0,E=7,ae(65496),ae(65504),ae(16),$(74),$(70),$(73),$(70),$(0),$(1),$(1),$(0),ae(1),ae(1),$(0),$(0),(function(){ae(65499),ae(132),$(0);for(var Et=0;Et<64;Et++)$(a[Et]);$(1);for(var pt=0;pt<64;pt++)$(u[pt])})(),(function(Et,pt){ae(65472),ae(17),$(8),ae(pt),ae(Et),$(3),$(1),$(17),$(0),$(2),$(17),$(1),$(3),$(17),$(1)})(W.width,W.height),(function(){ae(65476),ae(418),$(0);for(var Et=0;Et<16;Et++)$(I[Et+1]);for(var pt=0;pt<=11;pt++)$(A[pt]);$(16);for(var En=0;En<16;En++)$(O[En+1]);for(var $t=0;$t<=161;$t++)$(k[$t]);$(1);for(var Qt=0;Qt<16;Qt++)$(M[Qt+1]);for(var an=0;an<=11;an++)$(j[an]);$(17);for(var qt=0;qt<16;qt++)$(X[qt+1]);for(var vt=0;vt<=161;vt++)$(ue[vt])})(),ae(65498),ae(12),$(3),$(1),$(0),$(2),$(17),$(3),$(17),$(0),$(63),$(0);var te=0,de=0,ve=0;x=0,E=7,this.encode.displayName="_encode_";for(var we,Se,Ie,Fe,Ae,Be,Le,tt,re,rt=W.data,zt=W.width,gt=W.height,He=4*zt,ft=0;ft<gt;){for(we=0;we<He;){for(Ae=He*ft+we,Le=-1,tt=0,re=0;re<64;re++)Be=Ae+(tt=re>>3)*He+(Le=4*(7&re)),ft+tt>=gt&&(Be-=He*(ft+1+tt-gt)),we+Le>=He&&(Be-=we+Le-He+4),Se=rt[Be++],Ie=rt[Be++],Fe=rt[Be++],T[re]=(z[Se]+z[Ie+256|0]+z[Fe+512|0]>>16)-128,P[re]=(z[Se+768|0]+z[Ie+1024|0]+z[Fe+1280|0]>>16)-128,C[re]=(z[Se+1280|0]+z[Ie+1536|0]+z[Fe+1792|0]>>16)-128;te=fe(T,l,te,e,r),de=fe(P,h,de,t,i),ve=fe(C,h,ve,t,i),we+=32}ft+=8}if(E>=0){var lt=[];lt[1]=E+1,lt[0]=(1<<E+1)-1,ce(lt)}return ae(65497),new Uint8Array(b)},n=n||50,(function(){for(var W=String.fromCharCode,J=0;J<256;J++)D[J]=W(J)})(),e=ge(I,A),t=ge(M,j),r=ge(O,k),i=ge(X,ue),(function(){for(var W=1,J=2,te=1;te<=15;te++){for(var de=W;de<J;de++)m[32767+de]=te,d[32767+de]=[],d[32767+de][1]=te,d[32767+de][0]=de;for(var ve=-(J-1);ve<=-W;ve++)m[32767+ve]=te,d[32767+ve]=[],d[32767+ve][1]=te,d[32767+ve][0]=J-1+ve;W<<=1,J<<=1}})(),(function(){for(var W=0;W<256;W++)z[W]=19595*W,z[W+256|0]=38470*W,z[W+512|0]=7471*W+32768,z[W+768|0]=-11059*W,z[W+1024|0]=-21709*W,z[W+1280|0]=32768*W+8421375,z[W+1536|0]=-27439*W,z[W+1792|0]=-5329*W})(),Q(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function pu(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function dC(n){function e(A){if(!A)throw Error("assert :P")}function t(A,O,k){for(var M=0;4>M;M++)if(A[O+M]!=k.charCodeAt(M))return!0;return!1}function r(A,O,k,M,j){for(var X=0;X<j;X++)A[O+X]=k[M+X]}function i(A,O,k,M){for(var j=0;j<M;j++)A[O+j]=k}function o(A){return new Int32Array(A)}function s(A,O){for(var k=[],M=0;M<A;M++)k.push(new O);return k}function a(A,O){var k=[];return(function M(j,X,ue){for(var ge=ue[X],ce=0;ce<ge&&(j.push(ue.length>X+1?[]:new O),!(ue.length<X+1));ce++)M(j[ce],X+1,ue)})(k,0,A),k}var u=function(){var A=this;function O(v,S){for(var F=1<<S-1>>>0;v&F;)F>>>=1;return F?(v&F-1)+F:v}function k(v,S,F,U,G){e(!(U%F));do v[S+(U-=F)]=G;while(0<U)}function M(v,S,F,U,G){if(e(2328>=G),512>=G)var Y=o(512);else if((Y=o(G))==null)return 0;return(function(Z,ee,ie,le,_e,De){var he,Ce,Pe=ee,$e=1<<ie,Oe=o(16),qe=o(16);for(e(_e!=0),e(le!=null),e(Z!=null),e(0<ie),Ce=0;Ce<_e;++Ce){if(15<le[Ce])return 0;++Oe[le[Ce]]}if(Oe[0]==_e)return 0;for(qe[1]=0,he=1;15>he;++he){if(Oe[he]>1<<he)return 0;qe[he+1]=qe[he]+Oe[he]}for(Ce=0;Ce<_e;++Ce)he=le[Ce],0<le[Ce]&&(De[qe[he]++]=Ce);if(qe[15]==1)return(le=new j).g=0,le.value=De[0],k(Z,Pe,1,$e,le),$e;var Ge,Qe=-1,Je=$e-1,Lt=0,bt=1,gn=1,Ct=1<<ie;for(Ce=0,he=1,_e=2;he<=ie;++he,_e<<=1){if(bt+=gn<<=1,0>(gn-=Oe[he]))return 0;for(;0<Oe[he];--Oe[he])(le=new j).g=he,le.value=De[Ce++],k(Z,Pe+Lt,_e,Ct,le),Lt=O(Lt,he)}for(he=ie+1,_e=2;15>=he;++he,_e<<=1){if(bt+=gn<<=1,0>(gn-=Oe[he]))return 0;for(;0<Oe[he];--Oe[he]){if(le=new j,(Lt&Je)!=Qe){for(Pe+=Ct,Ge=1<<(Qe=he)-ie;15>Qe&&!(0>=(Ge-=Oe[Qe]));)++Qe,Ge<<=1;$e+=Ct=1<<(Ge=Qe-ie),Z[ee+(Qe=Lt&Je)].g=Ge+ie,Z[ee+Qe].value=Pe-ee-Qe}le.g=he-ie,le.value=De[Ce++],k(Z,Pe+(Lt>>ie),_e,Ct,le),Lt=O(Lt,he)}}return bt!=2*qe[15]-1?0:$e})(v,S,F,U,G,Y)}function j(){this.value=this.g=0}function X(){this.value=this.g=0}function ue(){this.G=s(5,j),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Ds,X)}function ge(v,S,F,U){e(v!=null),e(S!=null),e(2147483648>U),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=S,v.pa=F,v.Jd=S,v.Yc=F+U,v.Zc=4<=U?F+U-4+1:F,Se(v)}function ce(v,S){for(var F=0;0<S--;)F|=Fe(v,128)<<S;return F}function $(v,S){var F=ce(v,S);return Ie(v)?-F:F}function ae(v,S,F,U){var G,Y=0;for(e(v!=null),e(S!=null),e(4294967288>U),v.Sb=U,v.Ra=0,v.u=0,v.h=0,4<U&&(U=4),G=0;G<U;++G)Y+=S[F+G]<<8*G;v.Ra=Y,v.bb=U,v.oa=S,v.pa=F}function fe(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<Bu-8>>>0,++v.bb,v.u-=8;de(v)&&(v.h=1,v.u=0)}function Q(v,S){if(e(0<=S),!v.h&&S<=ws){var F=te(v)&ys[S];return v.u+=S,fe(v),F}return v.h=1,v.u=0}function W(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function J(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function te(v){return v.Ra>>>(v.u&Bu-1)>>>0}function de(v){return e(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>Bu}function ve(v,S){v.u=S,v.h=de(v)}function we(v){v.u>=Ra&&(e(v.u>=Ra),fe(v))}function Se(v){e(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(e(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function Ie(v){return ce(v,1)}function Fe(v,S){var F=v.Ca;0>v.b&&Se(v);var U=v.b,G=F*S>>>8,Y=(v.I>>>U>G)+0;for(Y?(F-=G,v.I-=G+1<<U>>>0):F=G+1,U=F,G=0;256<=U;)G+=8,U>>=8;return U=7^G+tu[U],v.b-=U,v.Ca=(F<<U)-1,Y}function Ae(v,S,F){v[S+0]=F>>24&255,v[S+1]=F>>16&255,v[S+2]=F>>8&255,v[S+3]=255&F}function Be(v,S){return v[S+0]|v[S+1]<<8}function Le(v,S){return Be(v,S)|v[S+2]<<16}function tt(v,S){return Be(v,S)|Be(v,S+2)<<16}function re(v,S){var F=1<<S;return e(v!=null),e(0<S),v.X=o(F),v.X==null?0:(v.Mb=32-S,v.Xa=S,1)}function rt(v,S){e(v!=null),e(S!=null),e(v.Xa==S.Xa),r(S.X,0,v.X,0,1<<S.Xa)}function zt(){this.X=[],this.Xa=this.Mb=0}function gt(v,S,F,U){e(F!=null),e(U!=null);var G=F[0],Y=U[0];return G==0&&(G=(v*Y+S/2)/S),Y==0&&(Y=(S*G+v/2)/v),0>=G||0>=Y?0:(F[0]=G,U[0]=Y,1)}function He(v,S){return v+(1<<S)-1>>>S}function ft(v,S){return((4278255360&v)+(4278255360&S)>>>0&4278255360)+((16711935&v)+(16711935&S)>>>0&16711935)>>>0}function lt(v,S){A[S]=function(F,U,G,Y,Z,ee,ie){var le;for(le=0;le<Z;++le){var _e=A[v](ee[ie+le-1],G,Y+le);ee[ie+le]=ft(F[U+le],_e)}}}function Et(){this.ud=this.hd=this.jd=0}function pt(v,S){return((4278124286&(v^S))>>>1)+(v&S)>>>0}function En(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function $t(v,S){return En(v+(v-S+.5>>1))}function Qt(v,S,F){return Math.abs(S-F)-Math.abs(v-F)}function an(v,S,F,U,G,Y,Z){for(U=Y[Z-1],F=0;F<G;++F)Y[Z+F]=U=ft(v[S+F],U)}function qt(v,S,F,U,G){var Y;for(Y=0;Y<F;++Y){var Z=v[S+Y],ee=Z>>8&255,ie=16711935&(ie=(ie=16711935&Z)+((ee<<16)+ee));U[G+Y]=(4278255360&Z)+ie>>>0}}function vt(v,S){S.jd=255&v,S.hd=v>>8&255,S.ud=v>>16&255}function en(v,S,F,U,G,Y){var Z;for(Z=0;Z<U;++Z){var ee=S[F+Z],ie=ee>>>8,le=ee,_e=255&(_e=(_e=ee>>>16)+((v.jd<<24>>24)*(ie<<24>>24)>>>5));le=255&(le=(le+=(v.hd<<24>>24)*(ie<<24>>24)>>>5)+((v.ud<<24>>24)*(_e<<24>>24)>>>5)),G[Y+Z]=(4278255360&ee)+(_e<<16)+le}}function yt(v,S,F,U,G){A[S]=function(Y,Z,ee,ie,le,_e,De,he,Ce){for(ie=De;ie<he;++ie)for(De=0;De<Ce;++De)le[_e++]=G(ee[U(Y[Z++])])},A[v]=function(Y,Z,ee,ie,le,_e,De){var he=8>>Y.b,Ce=Y.Ea,Pe=Y.K[0],$e=Y.w;if(8>he)for(Y=(1<<Y.b)-1,$e=(1<<he)-1;Z<ee;++Z){var Oe,qe=0;for(Oe=0;Oe<Ce;++Oe)Oe&Y||(qe=U(ie[le++])),_e[De++]=G(Pe[qe&$e]),qe>>=he}else A["VP8LMapColor"+F](ie,le,Pe,$e,_e,De,Z,ee,Ce)}}function dr(v,S,F,U,G){for(F=S+F;S<F;){var Y=v[S++];U[G++]=Y>>16&255,U[G++]=Y>>8&255,U[G++]=255&Y}}function mn(v,S,F,U,G){for(F=S+F;S<F;){var Y=v[S++];U[G++]=Y>>16&255,U[G++]=Y>>8&255,U[G++]=255&Y,U[G++]=Y>>24&255}}function rn(v,S,F,U,G){for(F=S+F;S<F;){var Y=(Z=v[S++])>>16&240|Z>>12&15,Z=240&Z|Z>>28&15;U[G++]=Y,U[G++]=Z}}function un(v,S,F,U,G){for(F=S+F;S<F;){var Y=(Z=v[S++])>>16&248|Z>>13&7,Z=Z>>5&224|Z>>3&31;U[G++]=Y,U[G++]=Z}}function On(v,S,F,U,G){for(F=S+F;S<F;){var Y=v[S++];U[G++]=255&Y,U[G++]=Y>>8&255,U[G++]=Y>>16&255}}function Ot(v,S,F,U,G,Y){if(Y==0)for(F=S+F;S<F;)Ae(U,((Y=v[S++])[0]>>24|Y[1]>>8&65280|Y[2]<<8&16711680|Y[3]<<24)>>>0),G+=32;else r(U,G,v,S,F)}function Bn(v,S){A[S][0]=A[v+"0"],A[S][1]=A[v+"1"],A[S][2]=A[v+"2"],A[S][3]=A[v+"3"],A[S][4]=A[v+"4"],A[S][5]=A[v+"5"],A[S][6]=A[v+"6"],A[S][7]=A[v+"7"],A[S][8]=A[v+"8"],A[S][9]=A[v+"9"],A[S][10]=A[v+"10"],A[S][11]=A[v+"11"],A[S][12]=A[v+"12"],A[S][13]=A[v+"13"],A[S][14]=A[v+"0"],A[S][15]=A[v+"0"]}function Ht(v){return v==wc||v==Ll||v==Th||v==kh}function Jt(){this.eb=[],this.size=this.A=this.fb=0}function jn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Dt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Jt,this.f.kb=new jn,this.sd=null}function Gt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Cn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Mo(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function ai(v,S){var F=v.T,U=S.ba.f.RGBA,G=U.eb,Y=U.fb+v.ka*U.A,Z=Wo[S.ba.S],ee=v.y,ie=v.O,le=v.f,_e=v.N,De=v.ea,he=v.W,Ce=S.cc,Pe=S.dc,$e=S.Mc,Oe=S.Nc,qe=v.ka,Ge=v.ka+v.T,Qe=v.U,Je=Qe+1>>1;for(qe==0?Z(ee,ie,null,null,le,_e,De,he,le,_e,De,he,G,Y,null,null,Qe):(Z(S.ec,S.fc,ee,ie,Ce,Pe,$e,Oe,le,_e,De,he,G,Y-U.A,G,Y,Qe),++F);qe+2<Ge;qe+=2)Ce=le,Pe=_e,$e=De,Oe=he,_e+=v.Rc,he+=v.Rc,Y+=2*U.A,Z(ee,(ie+=2*v.fa)-v.fa,ee,ie,Ce,Pe,$e,Oe,le,_e,De,he,G,Y-U.A,G,Y,Qe);return ie+=v.fa,v.j+Ge<v.o?(r(S.ec,S.fc,ee,ie,Qe),r(S.cc,S.dc,le,_e,Je),r(S.Mc,S.Nc,De,he,Je),F--):1&Ge||Z(ee,ie,null,null,le,_e,De,he,le,_e,De,he,G,Y+U.A,null,null,Qe),F}function As(v,S,F){var U=v.F,G=[v.J];if(U!=null){var Y=v.U,Z=S.ba.S,ee=Z==Ih||Z==Th;S=S.ba.f.RGBA;var ie=[0],le=v.ka;ie[0]=v.T,v.Kb&&(le==0?--ie[0]:(--le,G[0]-=v.width),v.j+v.ka+v.T==v.o&&(ie[0]=v.o-v.j-le));var _e=S.eb;le=S.fb+le*S.A,v=Ah(U,G[0],v.width,Y,ie,_e,le+(ee?0:3),S.A),e(F==ie),v&&Ht(Z)&&Dl(_e,le,ee,Y,ie,S.A)}return 0}function ui(v){var S=v.ma,F=S.ba.S,U=11>F,G=F==zu||F==Ch||F==Ih||F==ar||F==12||Ht(F);if(S.memory=null,S.Ib=null,S.Jb=null,S.Nd=null,!fc(S.Oa,v,G?11:12))return 0;if(G&&Ht(F)&&on(),v.da)alert("todo:use_scaling");else{if(U){if(S.Ib=Mo,v.Kb){if(F=v.U+1>>1,S.memory=o(v.U+2*F),S.memory==null)return 0;S.ec=S.memory,S.fc=0,S.cc=S.ec,S.dc=S.fc+v.U,S.Mc=S.cc,S.Nc=S.dc+F,S.Ib=ai,on()}}else alert("todo:EmitYUV");G&&(S.Jb=As,U&&je())}if(U&&!Vi){for(v=0;256>v;++v)qo[v]=89858*(v-128)+ia>>ou,Ho[v]=-22014*(v-128)+ia,Ec[v]=-45773*(v-128),Bl[v]=113618*(v-128)+ia>>ou;for(v=Zn;v<nr;++v)S=76283*(v-16)+ia>>ou,Lf[v-Zn]=Pr(S,255),pg[v-Zn]=Pr(S+8>>4,15);Vi=1}return 1}function Kt(v){var S=v.ma,F=v.U,U=v.T;return e(!(1&v.ka)),0>=F||0>=U?0:(F=S.Ib(v,S),S.Jb!=null&&S.Jb(v,S,F),S.Dc+=F,1)}function go(v){v.ma.memory=null}function Yi(v,S,F,U){return Q(v,8)!=47?0:(S[0]=Q(v,14)+1,F[0]=Q(v,14)+1,U[0]=Q(v,1),Q(v,3)!=0?0:!v.h)}function li(v,S){if(4>v)return v+1;var F=v-2>>1;return(2+(1&v)<<F)+Q(S,F)+1}function vo(v,S){return 120<S?S-120:1<=(F=((F=A1[S-1])>>4)*v+(8-(15&F)))?F:1;var F}function Xn(v,S,F){var U=te(F),G=v[S+=255&U].g-8;return 0<G&&(ve(F,F.u+8),U=te(F),S+=v[S].value,S+=U&(1<<G)-1),ve(F,F.u+v[S].g),v[S].value}function or(v,S,F){return F.g+=v.g,F.value+=v.value<<S>>>0,e(8>=F.g),v.g}function Rr(v,S,F){var U=v.xc;return e((S=U==0?0:v.vc[v.md*(F>>U)+(S>>U)])<v.Wb),v.Ya[S]}function Ei(v,S,F,U){var G=v.ab,Y=v.c*S,Z=v.C;S=Z+S;var ee=F,ie=U;for(U=v.Ta,F=v.Ua;0<G--;){var le=v.gc[G],_e=Z,De=S,he=ee,Ce=ie,Pe=(ie=U,ee=F,le.Ea);switch(e(_e<De),e(De<=le.nc),le.hc){case 2:Ur(he,Ce,(De-_e)*Pe,ie,ee);break;case 0:var $e=_e,Oe=De,qe=ie,Ge=ee,Qe=(Ct=le).Ea;$e==0&&(nu(he,Ce,null,null,1,qe,Ge),an(he,Ce+1,0,0,Qe-1,qe,Ge+1),Ce+=Qe,Ge+=Qe,++$e);for(var Je=1<<Ct.b,Lt=Je-1,bt=He(Qe,Ct.b),gn=Ct.K,Ct=Ct.w+($e>>Ct.b)*bt;$e<Oe;){var Rn=gn,Mr=Ct,yn=1;for(Pa(he,Ce,qe,Ge-Qe,1,qe,Ge);yn<Qe;){var xt=(yn&~Lt)+Je;xt>Qe&&(xt=Qe),(0,kl[Rn[Mr++]>>8&15])(he,Ce+ +yn,qe,Ge+yn-Qe,xt-yn,qe,Ge+yn),yn=xt}Ce+=Qe,Ge+=Qe,++$e&Lt||(Ct+=bt)}De!=le.nc&&r(ie,ee-Pe,ie,ee+(De-_e-1)*Pe,Pe);break;case 1:for(Pe=he,Oe=Ce,Qe=(he=le.Ea)-(Ge=he&~(qe=(Ce=1<<le.b)-1)),$e=He(he,le.b),Je=le.K,le=le.w+(_e>>le.b)*$e;_e<De;){for(Lt=Je,bt=le,gn=new Et,Ct=Oe+Ge,Rn=Oe+he;Oe<Ct;)vt(Lt[bt++],gn),pc(gn,Pe,Oe,Ce,ie,ee),Oe+=Ce,ee+=Ce;Oe<Rn&&(vt(Lt[bt++],gn),pc(gn,Pe,Oe,Qe,ie,ee),Oe+=Qe,ee+=Qe),++_e&qe||(le+=$e)}break;case 3:if(he==ie&&Ce==ee&&0<le.b){for(Oe=ie,he=Pe=ee+(De-_e)*Pe-(Ge=(De-_e)*He(le.Ea,le.b)),Ce=ie,qe=ee,$e=[],Ge=(Qe=Ge)-1;0<=Ge;--Ge)$e[Ge]=Ce[qe+Ge];for(Ge=Qe-1;0<=Ge;--Ge)Oe[he+Ge]=$e[Ge];Il(le,_e,De,ie,Pe,ie,ee)}else Il(le,_e,De,he,Ce,ie,ee)}ee=U,ie=F}ie!=F&&r(U,F,ee,ie,Y)}function Ks(v,S){var F=v.V,U=v.Ba+v.c*v.C,G=S-v.C;if(e(S<=v.l.o),e(16>=G),0<G){var Y=v.l,Z=v.Ta,ee=v.Ua,ie=Y.width;if(Ei(v,G,F,U),G=ee=[ee],e((F=v.C)<(U=S)),e(Y.v<Y.va),U>Y.o&&(U=Y.o),F<Y.j){var le=Y.j-F;F=Y.j,G[0]+=le*ie}if(F>=U?F=0:(G[0]+=4*Y.v,Y.ka=F-Y.j,Y.U=Y.va-Y.v,Y.T=U-F,F=1),F){if(ee=ee[0],11>(F=v.ca).S){var _e=F.f.RGBA,De=(U=F.S,G=Y.U,Y=Y.T,le=_e.eb,_e.A),he=Y;for(_e=_e.fb+v.Ma*_e.A;0<he--;){var Ce=Z,Pe=ee,$e=G,Oe=le,qe=_e;switch(U){case Nf:mc(Ce,Pe,$e,Oe,qe);break;case zu:ru(Ce,Pe,$e,Oe,qe);break;case wc:ru(Ce,Pe,$e,Oe,qe),Dl(Oe,qe,0,$e,1,0);break;case lg:Nl(Ce,Pe,$e,Oe,qe);break;case Ch:Ot(Ce,Pe,$e,Oe,qe,1);break;case Ll:Ot(Ce,Pe,$e,Oe,qe,1),Dl(Oe,qe,0,$e,1,0);break;case Ih:Ot(Ce,Pe,$e,Oe,qe,0);break;case Th:Ot(Ce,Pe,$e,Oe,qe,0),Dl(Oe,qe,1,$e,1,0);break;case ar:Vu(Ce,Pe,$e,Oe,qe);break;case kh:Vu(Ce,Pe,$e,Oe,qe),dp(Oe,qe,$e,1,0);break;case Rf:ju(Ce,Pe,$e,Oe,qe);break;default:e(0)}ee+=ie,_e+=De}v.Ma+=Y}else alert("todo:EmitRescaledRowsYUVA");e(v.Ma<=F.height)}}v.C=S,e(v.C<=v.i)}function Oo(v){var S;if(0<v.ua)return 0;for(S=0;S<v.Wb;++S){var F=v.Ya[S].G,U=v.Ya[S].H;if(0<F[1][U[1]+0].g||0<F[2][U[2]+0].g||0<F[3][U[3]+0].g)return 0}return 1}function Fo(v,S,F,U,G,Y){if(v.Z!=0){var Z=v.qd,ee=v.rd;for(e(io[v.Z]!=null);S<F;++S)io[v.Z](Z,ee,U,G,U,G,Y),Z=U,ee=G,G+=Y;v.qd=Z,v.rd=ee}}function Vr(v,S){var F=v.l.ma,U=F.Z==0||F.Z==1?v.l.j:v.C;if(U=v.C<U?U:v.C,e(S<=v.l.o),S>U){var G=v.l.width,Y=F.ca,Z=F.tb+G*U,ee=v.V,ie=v.Ba+v.c*U,le=v.gc;e(v.ab==1),e(le[0].hc==3),na(le[0],U,S,ee,ie,Y,Z),Fo(F,U,S,Y,Z,G)}v.C=v.Ma=S}function yo(v,S,F,U,G,Y,Z){var ee=v.$/U,ie=v.$%U,le=v.m,_e=v.s,De=F+v.$,he=De;G=F+U*G;var Ce=F+U*Y,Pe=280+_e.ua,$e=v.Pb?ee:16777216,Oe=0<_e.ua?_e.Wa:null,qe=_e.wc,Ge=De<Ce?Rr(_e,ie,ee):null;e(v.C<Y),e(Ce<=G);var Qe=!1;e:for(;;){for(;Qe||De<Ce;){var Je=0;if(ee>=$e){var Lt=De-F;e(($e=v).Pb),$e.wd=$e.m,$e.xd=Lt,0<$e.s.ua&&rt($e.s.Wa,$e.s.vb),$e=ee+Df}if(ie&qe||(Ge=Rr(_e,ie,ee)),e(Ge!=null),Ge.Qb&&(S[De]=Ge.qb,Qe=!0),!Qe)if(we(le),Ge.jc){Je=le,Lt=S;var bt=De,gn=Ge.pd[te(Je)&Ds-1];e(Ge.jc),256>gn.g?(ve(Je,Je.u+gn.g),Lt[bt]=gn.value,Je=0):(ve(Je,Je.u+gn.g-256),e(256<=gn.value),Je=gn.value),Je==0&&(Qe=!0)}else Je=Xn(Ge.G[0],Ge.H[0],le);if(le.h)break;if(Qe||256>Je){if(!Qe)if(Ge.nd)S[De]=(Ge.qb|Je<<8)>>>0;else{if(we(le),Qe=Xn(Ge.G[1],Ge.H[1],le),we(le),Lt=Xn(Ge.G[2],Ge.H[2],le),bt=Xn(Ge.G[3],Ge.H[3],le),le.h)break;S[De]=(bt<<24|Qe<<16|Je<<8|Lt)>>>0}if(Qe=!1,++De,++ie>=U&&(ie=0,++ee,Z!=null&&ee<=Y&&!(ee%16)&&Z(v,ee),Oe!=null))for(;he<De;)Je=S[he++],Oe.X[(506832829*Je&4294967295)>>>Oe.Mb]=Je}else if(280>Je){if(Je=li(Je-256,le),Lt=Xn(Ge.G[4],Ge.H[4],le),we(le),Lt=vo(U,Lt=li(Lt,le)),le.h)break;if(De-F<Lt||G-De<Je)break e;for(bt=0;bt<Je;++bt)S[De+bt]=S[De+bt-Lt];for(De+=Je,ie+=Je;ie>=U;)ie-=U,++ee,Z!=null&&ee<=Y&&!(ee%16)&&Z(v,ee);if(e(De<=G),ie&qe&&(Ge=Rr(_e,ie,ee)),Oe!=null)for(;he<De;)Je=S[he++],Oe.X[(506832829*Je&4294967295)>>>Oe.Mb]=Je}else{if(!(Je<Pe))break e;for(Qe=Je-280,e(Oe!=null);he<De;)Je=S[he++],Oe.X[(506832829*Je&4294967295)>>>Oe.Mb]=Je;Je=De,e(!(Qe>>>(Lt=Oe).Xa)),S[Je]=Lt.X[Qe],Qe=!0}Qe||e(le.h==de(le))}if(v.Pb&&le.h&&De<G)e(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&rt(v.s.vb,v.s.Wa);else{if(le.h)break e;Z!=null&&Z(v,ee>Y?Y:ee),v.a=0,v.$=De-F}return 1}return v.a=3,0}function wo(v){e(v!=null),v.vc=null,v.yc=null,v.Ya=null;var S=v.Wa;S!=null&&(S.X=null),v.vb=null,e(v!=null)}function xa(){var v=new Zt;return v==null?null:(v.a=0,v.xb=xc,Bn("Predictor","VP8LPredictors"),Bn("Predictor","VP8LPredictors_C"),Bn("PredictorAdd","VP8LPredictorsAdd"),Bn("PredictorAdd","VP8LPredictorsAdd_C"),Ur=qt,pc=en,mc=dr,ru=mn,Vu=rn,ju=un,Nl=On,A.VP8LMapColor32b=Da,A.VP8LMapColor8b=Tl,v)}function cs(v,S,F,U,G){var Y=1,Z=[v],ee=[S],ie=U.m,le=U.s,_e=null,De=0;e:for(;;){if(F)for(;Y&&Q(ie,1);){var he=Z,Ce=ee,Pe=U,$e=1,Oe=Pe.m,qe=Pe.gc[Pe.ab],Ge=Q(Oe,2);if(Pe.Oc&1<<Ge)Y=0;else{switch(Pe.Oc|=1<<Ge,qe.hc=Ge,qe.Ea=he[0],qe.nc=Ce[0],qe.K=[null],++Pe.ab,e(4>=Pe.ab),Ge){case 0:case 1:qe.b=Q(Oe,3)+2,$e=cs(He(qe.Ea,qe.b),He(qe.nc,qe.b),0,Pe,qe.K),qe.K=qe.K[0];break;case 3:var Qe,Je=Q(Oe,8)+1,Lt=16<Je?0:4<Je?1:2<Je?2:3;if(he[0]=He(qe.Ea,Lt),qe.b=Lt,Qe=$e=cs(Je,1,0,Pe,qe.K)){var bt,gn=Je,Ct=qe,Rn=1<<(8>>Ct.b),Mr=o(Rn);if(Mr==null)Qe=0;else{var yn=Ct.K[0],xt=Ct.w;for(Mr[0]=Ct.K[0][0],bt=1;bt<1*gn;++bt)Mr[bt]=ft(yn[xt+bt],Mr[bt-1]);for(;bt<4*Rn;++bt)Mr[bt]=0;Ct.K[0]=null,Ct.K[0]=Mr,Qe=1}}$e=Qe;break;case 2:break;default:e(0)}Y=$e}}if(Z=Z[0],ee=ee[0],Y&&Q(ie,1)&&!(Y=1<=(De=Q(ie,4))&&11>=De)){U.a=3;break e}var ct;if(ct=Y)t:{var zr,ln,In,wr=U,Ii=Z,ei=ee,Ir=De,di=F,Ti=wr.m,Er=wr.s,Ln=[null],Hn=1,Sr=0,Gn=hg[Ir];n:for(;;){if(di&&Q(Ti,1)){var Or=Q(Ti,3)+2,Fr=He(Ii,Or),ur=He(ei,Or),oo=Fr*ur;if(!cs(Fr,ur,0,wr,Ln))break n;for(Ln=Ln[0],Er.xc=Or,zr=0;zr<oo;++zr){var rr=Ln[zr]>>8&65535;Ln[zr]=rr,rr>=Hn&&(Hn=rr+1)}}if(Ti.h)break n;for(ln=0;5>ln;++ln){var lr=Ml[ln];!ln&&0<Ir&&(lr+=1<<Ir),Sr<lr&&(Sr=lr)}var ti=s(Hn*Gn,j),ji=Hn,Go=s(ji,ue);if(Go==null)var Wr=null;else e(65536>=ji),Wr=Go;var qr=o(Sr);if(Wr==null||qr==null||ti==null){wr.a=1;break n}var so=ti;for(zr=In=0;zr<Hn;++zr){var cr=Wr[zr],ao=cr.G,Os=cr.H,oa=0,ki=1,Hr=0;for(ln=0;5>ln;++ln){lr=Ml[ln],ao[ln]=so,Os[ln]=In,!ln&&0<Ir&&(lr+=1<<Ir);i:{var Hu,au=lr,Sc=wr,Oa=qr,gg=so,Ap=In,xr=0,sa=Sc.m,Cp=Q(sa,1);if(i(Oa,0,0,au),Cp){var Ip=Q(sa,1)+1,Mf=Q(sa,1),Of=Q(sa,Mf==0?1:8);Oa[Of]=1,Ip==2&&(Oa[Of=Q(sa,8)]=1);var Fa=1}else{var Ar=o(19),ni=Q(sa,4)+4;if(19<ni){Sc.a=3;var Gr=0;break i}for(Hu=0;Hu<ni;++Hu)Ar[S1[Hu]]=Q(sa,3);var Ac=void 0,uu=void 0,Cc=Sc,N1=Ar,pi=au,Ff=Oa,Lh=0,Ba=Cc.m,aa=8,bs=s(128,j);r:for(;M(bs,0,7,N1,19);){if(Q(Ba,1)){var Mh=2+2*Q(Ba,3);if((Ac=2+Q(Ba,Mh))>pi)break r}else Ac=pi;for(uu=0;uu<pi&&Ac--;){we(Ba);var Bf=bs[0+(127&te(Ba))];ve(Ba,Ba.u+Bf.g);var Gu=Bf.value;if(16>Gu)Ff[uu++]=Gu,Gu!=0&&(aa=Gu);else{var vg=Gu==16,Tp=Gu-16,yg=Pf[Tp],kp=Q(Ba,Nh[Tp])+yg;if(uu+kp>pi)break r;for(var wg=vg?aa:0;0<kp--;)Ff[uu++]=wg}}Lh=1;break r}Lh||(Cc.a=3),Fa=Lh}(Fa=Fa&&!sa.h)&&(xr=M(gg,Ap,8,Oa,au)),Fa&&xr!=0?Gr=xr:(Sc.a=3,Gr=0)}if(Gr==0)break n;if(ki&&cg[ln]==1&&(ki=so[In].g==0),oa+=so[In].g,In+=Gr,3>=ln){var Ic,Vf=qr[0];for(Ic=1;Ic<lr;++Ic)qr[Ic]>Vf&&(Vf=qr[Ic]);Hr+=Vf}}if(cr.nd=ki,cr.Qb=0,ki&&(cr.qb=(ao[3][Os[3]+0].value<<24|ao[1][Os[1]+0].value<<16|ao[2][Os[2]+0].value)>>>0,oa==0&&256>ao[0][Os[0]+0].value&&(cr.Qb=1,cr.qb+=ao[0][Os[0]+0].value<<8)),cr.jc=!cr.Qb&&6>Hr,cr.jc){var Oh,xs=cr;for(Oh=0;Oh<Ds;++Oh){var lu=Oh,ua=xs.pd[lu],jl=xs.G[0][xs.H[0]+lu];256<=jl.value?(ua.g=jl.g+256,ua.value=jl.value):(ua.g=0,ua.value=0,lu>>=or(jl,8,ua),lu>>=or(xs.G[1][xs.H[1]+lu],16,ua),lu>>=or(xs.G[2][xs.H[2]+lu],0,ua),or(xs.G[3][xs.H[3]+lu],24,ua))}}}Er.vc=Ln,Er.Wb=Hn,Er.Ya=Wr,Er.yc=ti,ct=1;break t}ct=0}if(!(Y=ct)){U.a=3;break e}if(0<De){if(le.ua=1<<De,!re(le.Wa,De)){U.a=1,Y=0;break e}}else le.ua=0;var jf=U,Uf=Z,bg=ee,zf=jf.s,Wf=zf.xc;if(jf.c=Uf,jf.i=bg,zf.md=He(Uf,Wf),zf.wc=Wf==0?-1:(1<<Wf)-1,F){U.xb=Ma;break e}if((_e=o(Z*ee))==null){U.a=1,Y=0;break e}Y=(Y=yo(U,_e,0,Z,ee,ee,null))&&!ie.h;break e}return Y?(G!=null?G[0]=_e:(e(_e==null),e(F)),U.$=0,F||wo(le)):wo(le),Y}function hs(v,S){var F=v.c*v.i,U=F+S+16*S;return e(v.c<=S),v.V=o(U),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+F+S,1)}function _a(v,S){var F=v.C,U=S-F,G=v.V,Y=v.Ba+v.c*F;for(e(S<=v.l.o);0<U;){var Z=16<U?16:U,ee=v.l.ma,ie=v.l.width,le=ie*Z,_e=ee.ca,De=ee.tb+ie*F,he=v.Ta,Ce=v.Ua;Ei(v,Z,G,Y),pp(he,Ce,_e,De,le),Fo(ee,F,F+Z,_e,De,ie),U-=Z,G+=Z*v.c,F+=Z}e(F==S),v.C=v.Ma=S}function Xs(){this.ub=this.yd=this.td=this.Rb=0}function Cs(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ys(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Qn(){this.Yb=(function(){var v=[];return(function S(F,U,G){for(var Y=G[U],Z=0;Z<Y&&(F.push(G.length>U+1?[]:0),!(G.length<U+1));Z++)S(F[Z],U+1,G)})(v,0,[3,11]),v})()}function cc(){this.jb=o(3),this.Wc=a([4,8],Qn),this.Xc=a([4,17],Qn)}function Ka(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function Qi(){this.ld=this.La=this.dd=this.tc=0}function Qs(){this.Na=this.la=0}function Nu(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ea(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Sa(){this.uc=this.M=this.Nb=0,this.wa=Array(new Qi),this.Y=0,this.ya=Array(new Ea),this.aa=0,this.l=new bo}function Ji(){this.y=o(16),this.f=o(8),this.ea=o(8)}function xl(){this.cb=this.a=0,this.sc="",this.m=new W,this.Od=new Xs,this.Kc=new Cs,this.ed=new Ka,this.Qa=new Ys,this.Ic=this.$c=this.Aa=0,this.D=new Sa,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,W),this.ia=0,this.pb=s(4,Nu),this.Pa=new cc,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ji),this.Hd=0,this.rb=Array(new Qs),this.sb=0,this.wa=Array(new Qi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ea),this.L=this.aa=0,this.gd=a([4,2],Qi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Pr(v,S){return 0>v?0:v>S?S:v}function bo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Bo(){var v=new xl;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,Ol||(Ol=Tn)),v}function pr(v,S,F){return v.a==0&&(v.a=S,v.sc=F,v.cb=0),0}function fs(v,S,F){return 3<=F&&v[S+0]==157&&v[S+1]==1&&v[S+2]==42}function Oi(v,S){if(v==null)return 0;if(v.a=0,v.sc="OK",S==null)return pr(v,2,"null VP8Io passed to VP8GetHeaders()");var F=S.data,U=S.w,G=S.ha;if(4>G)return pr(v,7,"Truncated header.");var Y=F[U+0]|F[U+1]<<8|F[U+2]<<16,Z=v.Od;if(Z.Rb=!(1&Y),Z.td=Y>>1&7,Z.yd=Y>>4&1,Z.ub=Y>>5,3<Z.td)return pr(v,3,"Incorrect keyframe parameters.");if(!Z.yd)return pr(v,4,"Frame not displayable.");U+=3,G-=3;var ee=v.Kc;if(Z.Rb){if(7>G)return pr(v,7,"cannot parse picture header");if(!fs(F,U,G))return pr(v,3,"Bad code word");ee.c=16383&(F[U+4]<<8|F[U+3]),ee.Td=F[U+4]>>6,ee.i=16383&(F[U+6]<<8|F[U+5]),ee.Ud=F[U+6]>>6,U+=7,G-=7,v.za=ee.c+15>>4,v.Ub=ee.i+15>>4,S.width=ee.c,S.height=ee.i,S.Da=0,S.j=0,S.v=0,S.va=S.width,S.o=S.height,S.da=0,S.ib=S.width,S.hb=S.height,S.U=S.width,S.T=S.height,i((Y=v.Pa).jb,0,255,Y.jb.length),e((Y=v.Qa)!=null),Y.Cb=0,Y.Bb=0,Y.Fb=1,i(Y.Zb,0,0,Y.Zb.length),i(Y.Lb,0,0,Y.Lb)}if(Z.ub>G)return pr(v,7,"bad partition length");ge(Y=v.m,F,U,Z.ub),U+=Z.ub,G-=Z.ub,Z.Rb&&(ee.Ld=Ie(Y),ee.Kd=Ie(Y)),ee=v.Qa;var ie,le=v.Pa;if(e(Y!=null),e(ee!=null),ee.Cb=Ie(Y),ee.Cb){if(ee.Bb=Ie(Y),Ie(Y)){for(ee.Fb=Ie(Y),ie=0;4>ie;++ie)ee.Zb[ie]=Ie(Y)?$(Y,7):0;for(ie=0;4>ie;++ie)ee.Lb[ie]=Ie(Y)?$(Y,6):0}if(ee.Bb)for(ie=0;3>ie;++ie)le.jb[ie]=Ie(Y)?ce(Y,8):255}else ee.Bb=0;if(Y.Ka)return pr(v,3,"cannot parse segment header");if((ee=v.ed).zd=Ie(Y),ee.Tb=ce(Y,6),ee.wb=ce(Y,3),ee.Pc=Ie(Y),ee.Pc&&Ie(Y)){for(le=0;4>le;++le)Ie(Y)&&(ee.vd[le]=$(Y,6));for(le=0;4>le;++le)Ie(Y)&&(ee.od[le]=$(Y,6))}if(v.L=ee.Tb==0?0:ee.zd?1:2,Y.Ka)return pr(v,3,"cannot parse filter header");var _e=G;if(G=ie=U,U=ie+_e,ee=_e,v.Xb=(1<<ce(v.m,2))-1,_e<3*(le=v.Xb))F=7;else{for(ie+=3*le,ee-=3*le,_e=0;_e<le;++_e){var De=F[G+0]|F[G+1]<<8|F[G+2]<<16;De>ee&&(De=ee),ge(v.Jc[+_e],F,ie,De),ie+=De,ee-=De,G+=3}ge(v.Jc[+le],F,ie,ee),F=ie<U?0:5}if(F!=0)return pr(v,F,"cannot parse partitions");for(F=ce(ie=v.m,7),G=Ie(ie)?$(ie,4):0,U=Ie(ie)?$(ie,4):0,ee=Ie(ie)?$(ie,4):0,le=Ie(ie)?$(ie,4):0,ie=Ie(ie)?$(ie,4):0,_e=v.Qa,De=0;4>De;++De){if(_e.Cb){var he=_e.Zb[De];_e.Fb||(he+=F)}else{if(0<De){v.pb[De]=v.pb[0];continue}he=F}var Ce=v.pb[De];Ce.Sc[0]=bc[Pr(he+G,127)],Ce.Sc[1]=Rh[Pr(he+0,127)],Ce.Eb[0]=2*bc[Pr(he+U,127)],Ce.Eb[1]=101581*Rh[Pr(he+ee,127)]>>16,8>Ce.Eb[1]&&(Ce.Eb[1]=8),Ce.Qc[0]=bc[Pr(he+le,117)],Ce.Qc[1]=Rh[Pr(he+ie,127)],Ce.lc=he+ie}if(!Z.Rb)return pr(v,4,"Not a key frame.");for(Ie(Y),Z=v.Pa,F=0;4>F;++F){for(G=0;8>G;++G)for(U=0;3>U;++U)for(ee=0;11>ee;++ee)le=Fe(Y,I1[F][G][U][ee])?ce(Y,8):dg[F][G][U][ee],Z.Wc[F][G].Yb[U][ee]=le;for(G=0;17>G;++G)Z.Xc[F][G]=Z.Wc[F][_p[G]]}return v.kc=Ie(Y),v.kc&&(v.Bd=ce(Y,8)),v.cb=1}function Tn(v,S,F,U,G,Y,Z){var ee=S[G].Yb[F];for(F=0;16>G;++G){if(!Fe(v,ee[F+0]))return G;for(;!Fe(v,ee[F+1]);)if(ee=S[++G].Yb[0],F=0,G==16)return 16;var ie=S[G+1].Yb;if(Fe(v,ee[F+2])){var le=v,_e=0;if(Fe(le,(he=ee)[(De=F)+3]))if(Fe(le,he[De+6])){for(ee=0,De=2*(_e=Fe(le,he[De+8]))+(he=Fe(le,he[De+9+_e])),_e=0,he=bp[De];he[ee];++ee)_e+=_e+Fe(le,he[ee]);_e+=3+(8<<De)}else Fe(le,he[De+7])?(_e=7+2*Fe(le,165),_e+=Fe(le,145)):_e=5+Fe(le,159);else _e=Fe(le,he[De+4])?3+Fe(le,he[De+5]):2;ee=ie[2]}else _e=1,ee=ie[1];ie=Z+xp[G],0>(le=v).b&&Se(le);var De,he=le.b,Ce=(De=le.Ca>>1)-(le.I>>he)>>31;--le.b,le.Ca+=Ce,le.Ca|=1,le.I-=(De+1&Ce)<<he,Y[ie]=((_e^Ce)-Ce)*U[(0<G)+0]}return 16}function Is(v){var S=v.rb[v.sb-1];S.la=0,S.Na=0,i(v.zc,0,0,v.zc.length),v.ja=0}function Si(v,S,F,U,G){G=v[S+F+32*U]+(G>>3),v[S+F+32*U]=-256&G?0>G?0:255:G}function br(v,S,F,U,G,Y){Si(v,S,0,F,U+G),Si(v,S,1,F,U+Y),Si(v,S,2,F,U-Y),Si(v,S,3,F,U-G)}function ds(v){return(20091*v>>16)+v}function Ru(v,S,F,U){var G,Y=0,Z=o(16);for(G=0;4>G;++G){var ee=v[S+0]+v[S+8],ie=v[S+0]-v[S+8],le=(35468*v[S+4]>>16)-ds(v[S+12]),_e=ds(v[S+4])+(35468*v[S+12]>>16);Z[Y+0]=ee+_e,Z[Y+1]=ie+le,Z[Y+2]=ie-le,Z[Y+3]=ee-_e,Y+=4,S++}for(G=Y=0;4>G;++G)ee=(v=Z[Y+0]+4)+Z[Y+8],ie=v-Z[Y+8],le=(35468*Z[Y+4]>>16)-ds(Z[Y+12]),Si(F,U,0,0,ee+(_e=ds(Z[Y+4])+(35468*Z[Y+12]>>16))),Si(F,U,1,0,ie+le),Si(F,U,2,0,ie-le),Si(F,U,3,0,ee-_e),Y++,U+=32}function _l(v,S,F,U){var G=v[S+0]+4,Y=35468*v[S+4]>>16,Z=ds(v[S+4]),ee=35468*v[S+1]>>16;br(F,U,0,G+Z,v=ds(v[S+1]),ee),br(F,U,1,G+Y,v,ee),br(F,U,2,G-Y,v,ee),br(F,U,3,G-Z,v,ee)}function Xa(v,S,F,U,G){Ru(v,S,F,U),G&&Ru(v,S+16,F,U+4)}function Ts(v,S,F,U){Rl(v,S+0,F,U,1),Rl(v,S+32,F,U+128,1)}function Pu(v,S,F,U){var G;for(v=v[S+0]+4,G=0;4>G;++G)for(S=0;4>S;++S)Si(F,U,S,G,v)}function An(v,S,F,U){v[S+0]&&qn(v,S+0,F,U),v[S+16]&&qn(v,S+16,F,U+4),v[S+32]&&qn(v,S+32,F,U+128),v[S+48]&&qn(v,S+48,F,U+128+4)}function xo(v,S,F,U){var G,Y=o(16);for(G=0;4>G;++G){var Z=v[S+0+G]+v[S+12+G],ee=v[S+4+G]+v[S+8+G],ie=v[S+4+G]-v[S+8+G],le=v[S+0+G]-v[S+12+G];Y[0+G]=Z+ee,Y[8+G]=Z-ee,Y[4+G]=le+ie,Y[12+G]=le-ie}for(G=0;4>G;++G)Z=(v=Y[0+4*G]+3)+Y[3+4*G],ee=Y[1+4*G]+Y[2+4*G],ie=Y[1+4*G]-Y[2+4*G],le=v-Y[3+4*G],F[U+0]=Z+ee>>3,F[U+16]=le+ie>>3,F[U+32]=Z-ee>>3,F[U+48]=le-ie>>3,U+=64}function Js(v,S,F){var U,G=S-32,Y=So,Z=255-v[G-1];for(U=0;U<F;++U){var ee,ie=Y,le=Z+v[S-1];for(ee=0;ee<F;++ee)v[S+ee]=ie[le+v[G+ee]];S+=32}}function Du(v,S){Js(v,S,4)}function El(v,S){Js(v,S,8)}function Sl(v,S){Js(v,S,16)}function Ya(v,S){var F;for(F=0;16>F;++F)r(v,S+32*F,v,S-32,16)}function ps(v,S){var F;for(F=16;0<F;--F)i(v,S,v[S-1],16),S+=32}function Zi(v,S,F){var U;for(U=0;16>U;++U)i(S,F+32*U,v,16)}function ks(v,S){var F,U=16;for(F=0;16>F;++F)U+=v[S-1+32*F]+v[S+F-32];Zi(U>>5,v,S)}function eo(v,S){var F,U=8;for(F=0;16>F;++F)U+=v[S-1+32*F];Zi(U>>4,v,S)}function jr(v,S){var F,U=8;for(F=0;16>F;++F)U+=v[S+F-32];Zi(U>>4,v,S)}function Qa(v,S){Zi(128,v,S)}function Xt(v,S,F){return v+2*S+F+2>>2}function _o(v,S){var F,U=S-32;for(U=new Uint8Array([Xt(v[U-1],v[U+0],v[U+1]),Xt(v[U+0],v[U+1],v[U+2]),Xt(v[U+1],v[U+2],v[U+3]),Xt(v[U+2],v[U+3],v[U+4])]),F=0;4>F;++F)r(v,S+32*F,U,0,U.length)}function hc(v,S){var F=v[S-1],U=v[S-1+32],G=v[S-1+64],Y=v[S-1+96];Ae(v,S+0,16843009*Xt(v[S-1-32],F,U)),Ae(v,S+32,16843009*Xt(F,U,G)),Ae(v,S+64,16843009*Xt(U,G,Y)),Ae(v,S+96,16843009*Xt(G,Y,Y))}function Aa(v,S){var F,U=4;for(F=0;4>F;++F)U+=v[S+F-32]+v[S-1+32*F];for(U>>=3,F=0;4>F;++F)i(v,S+32*F,U,4)}function ci(v,S){var F=v[S-1+0],U=v[S-1+32],G=v[S-1+64],Y=v[S-1-32],Z=v[S+0-32],ee=v[S+1-32],ie=v[S+2-32],le=v[S+3-32];v[S+0+96]=Xt(U,G,v[S-1+96]),v[S+1+96]=v[S+0+64]=Xt(F,U,G),v[S+2+96]=v[S+1+64]=v[S+0+32]=Xt(Y,F,U),v[S+3+96]=v[S+2+64]=v[S+1+32]=v[S+0+0]=Xt(Z,Y,F),v[S+3+64]=v[S+2+32]=v[S+1+0]=Xt(ee,Z,Y),v[S+3+32]=v[S+2+0]=Xt(ie,ee,Z),v[S+3+0]=Xt(le,ie,ee)}function Ns(v,S){var F=v[S+1-32],U=v[S+2-32],G=v[S+3-32],Y=v[S+4-32],Z=v[S+5-32],ee=v[S+6-32],ie=v[S+7-32];v[S+0+0]=Xt(v[S+0-32],F,U),v[S+1+0]=v[S+0+32]=Xt(F,U,G),v[S+2+0]=v[S+1+32]=v[S+0+64]=Xt(U,G,Y),v[S+3+0]=v[S+2+32]=v[S+1+64]=v[S+0+96]=Xt(G,Y,Z),v[S+3+32]=v[S+2+64]=v[S+1+96]=Xt(Y,Z,ee),v[S+3+64]=v[S+2+96]=Xt(Z,ee,ie),v[S+3+96]=Xt(ee,ie,ie)}function Lu(v,S){var F=v[S-1+0],U=v[S-1+32],G=v[S-1+64],Y=v[S-1-32],Z=v[S+0-32],ee=v[S+1-32],ie=v[S+2-32],le=v[S+3-32];v[S+0+0]=v[S+1+64]=Y+Z+1>>1,v[S+1+0]=v[S+2+64]=Z+ee+1>>1,v[S+2+0]=v[S+3+64]=ee+ie+1>>1,v[S+3+0]=ie+le+1>>1,v[S+0+96]=Xt(G,U,F),v[S+0+64]=Xt(U,F,Y),v[S+0+32]=v[S+1+96]=Xt(F,Y,Z),v[S+1+32]=v[S+2+96]=Xt(Y,Z,ee),v[S+2+32]=v[S+3+96]=Xt(Z,ee,ie),v[S+3+32]=Xt(ee,ie,le)}function Jn(v,S){var F=v[S+0-32],U=v[S+1-32],G=v[S+2-32],Y=v[S+3-32],Z=v[S+4-32],ee=v[S+5-32],ie=v[S+6-32],le=v[S+7-32];v[S+0+0]=F+U+1>>1,v[S+1+0]=v[S+0+64]=U+G+1>>1,v[S+2+0]=v[S+1+64]=G+Y+1>>1,v[S+3+0]=v[S+2+64]=Y+Z+1>>1,v[S+0+32]=Xt(F,U,G),v[S+1+32]=v[S+0+96]=Xt(U,G,Y),v[S+2+32]=v[S+1+96]=Xt(G,Y,Z),v[S+3+32]=v[S+2+96]=Xt(Y,Z,ee),v[S+3+64]=Xt(Z,ee,ie),v[S+3+96]=Xt(ee,ie,le)}function Ja(v,S){var F=v[S-1+0],U=v[S-1+32],G=v[S-1+64],Y=v[S-1+96];v[S+0+0]=F+U+1>>1,v[S+2+0]=v[S+0+32]=U+G+1>>1,v[S+2+32]=v[S+0+64]=G+Y+1>>1,v[S+1+0]=Xt(F,U,G),v[S+3+0]=v[S+1+32]=Xt(U,G,Y),v[S+3+32]=v[S+1+64]=Xt(G,Y,Y),v[S+3+64]=v[S+2+64]=v[S+0+96]=v[S+1+96]=v[S+2+96]=v[S+3+96]=Y}function Al(v,S){var F=v[S-1+0],U=v[S-1+32],G=v[S-1+64],Y=v[S-1+96],Z=v[S-1-32],ee=v[S+0-32],ie=v[S+1-32],le=v[S+2-32];v[S+0+0]=v[S+2+32]=F+Z+1>>1,v[S+0+32]=v[S+2+64]=U+F+1>>1,v[S+0+64]=v[S+2+96]=G+U+1>>1,v[S+0+96]=Y+G+1>>1,v[S+3+0]=Xt(ee,ie,le),v[S+2+0]=Xt(Z,ee,ie),v[S+1+0]=v[S+3+32]=Xt(F,Z,ee),v[S+1+32]=v[S+3+64]=Xt(U,F,Z),v[S+1+64]=v[S+3+96]=Xt(G,U,F),v[S+1+96]=Xt(Y,G,U)}function Vo(v,S){var F;for(F=0;8>F;++F)r(v,S+32*F,v,S-32,8)}function Ca(v,S){var F;for(F=0;8>F;++F)i(v,S,v[S-1],8),S+=32}function Fi(v,S,F){var U;for(U=0;8>U;++U)i(S,F+32*U,v,8)}function Zs(v,S){var F,U=8;for(F=0;8>F;++F)U+=v[S+F-32]+v[S-1+32*F];Fi(U>>4,v,S)}function jo(v,S){var F,U=4;for(F=0;8>F;++F)U+=v[S+F-32];Fi(U>>3,v,S)}function Mu(v,S){var F,U=4;for(F=0;8>F;++F)U+=v[S-1+32*F];Fi(U>>3,v,S)}function Ou(v,S){Fi(128,v,S)}function Ai(v,S,F){var U=v[S-F],G=v[S+0],Y=3*(G-U)+La[1020+v[S-2*F]-v[S+F]],Z=yc[112+(Y+4>>3)];v[S-F]=So[255+U+yc[112+(Y+3>>3)]],v[S+0]=So[255+G-Z]}function Ia(v,S,F,U){var G=v[S+0],Y=v[S+F];return Ls[255+v[S-2*F]-v[S-F]]>U||Ls[255+Y-G]>U}function ea(v,S,F,U){return 4*Ls[255+v[S-F]-v[S+0]]+Ls[255+v[S-2*F]-v[S+F]]<=U}function Bi(v,S,F,U,G){var Y=v[S-3*F],Z=v[S-2*F],ee=v[S-F],ie=v[S+0],le=v[S+F],_e=v[S+2*F],De=v[S+3*F];return 4*Ls[255+ee-ie]+Ls[255+Z-le]>U?0:Ls[255+v[S-4*F]-Y]<=G&&Ls[255+Y-Z]<=G&&Ls[255+Z-ee]<=G&&Ls[255+De-_e]<=G&&Ls[255+_e-le]<=G&&Ls[255+le-ie]<=G}function Rs(v,S,F,U){var G=2*U+1;for(U=0;16>U;++U)ea(v,S+U,F,G)&&Ai(v,S+U,F)}function ms(v,S,F,U){var G=2*U+1;for(U=0;16>U;++U)ea(v,S+U*F,1,G)&&Ai(v,S+U*F,1)}function Cl(v,S,F,U){var G;for(G=3;0<G;--G)Rs(v,S+=4*F,F,U)}function Ta(v,S,F,U){var G;for(G=3;0<G;--G)ms(v,S+=4,F,U)}function Ci(v,S,F,U,G,Y,Z,ee){for(Y=2*Y+1;0<G--;){if(Bi(v,S,F,Y,Z))if(Ia(v,S,F,ee))Ai(v,S,F);else{var ie=v,le=S,_e=F,De=ie[le-2*_e],he=ie[le-_e],Ce=ie[le+0],Pe=ie[le+_e],$e=ie[le+2*_e],Oe=27*(Ge=La[1020+3*(Ce-he)+La[1020+De-Pe]])+63>>7,qe=18*Ge+63>>7,Ge=9*Ge+63>>7;ie[le-3*_e]=So[255+ie[le-3*_e]+Ge],ie[le-2*_e]=So[255+De+qe],ie[le-_e]=So[255+he+Oe],ie[le+0]=So[255+Ce-Oe],ie[le+_e]=So[255+Pe-qe],ie[le+2*_e]=So[255+$e-Ge]}S+=U}}function gs(v,S,F,U,G,Y,Z,ee){for(Y=2*Y+1;0<G--;){if(Bi(v,S,F,Y,Z))if(Ia(v,S,F,ee))Ai(v,S,F);else{var ie=v,le=S,_e=F,De=ie[le-_e],he=ie[le+0],Ce=ie[le+_e],Pe=yc[112+(4+($e=3*(he-De))>>3)],$e=yc[112+($e+3>>3)],Oe=Pe+1>>1;ie[le-2*_e]=So[255+ie[le-2*_e]+Oe],ie[le-_e]=So[255+De+$e],ie[le+0]=So[255+he-Pe],ie[le+_e]=So[255+Ce-Oe]}S+=U}}function hi(v,S,F,U,G,Y){Ci(v,S,F,1,16,U,G,Y)}function to(v,S,F,U,G,Y){Ci(v,S,1,F,16,U,G,Y)}function ka(v,S,F,U,G,Y){var Z;for(Z=3;0<Z;--Z)gs(v,S+=4*F,F,1,16,U,G,Y)}function N(v,S,F,U,G,Y){var Z;for(Z=3;0<Z;--Z)gs(v,S+=4,1,F,16,U,G,Y)}function H(v,S,F,U,G,Y,Z,ee){Ci(v,S,G,1,8,Y,Z,ee),Ci(F,U,G,1,8,Y,Z,ee)}function pe(v,S,F,U,G,Y,Z,ee){Ci(v,S,1,G,8,Y,Z,ee),Ci(F,U,1,G,8,Y,Z,ee)}function be(v,S,F,U,G,Y,Z,ee){gs(v,S+4*G,G,1,8,Y,Z,ee),gs(F,U+4*G,G,1,8,Y,Z,ee)}function Ne(v,S,F,U,G,Y,Z,ee){gs(v,S+4,1,G,8,Y,Z,ee),gs(F,U+4,1,G,8,Y,Z,ee)}function Xe(){this.ba=new Dt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Cn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ze(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function wt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function It(){this.ua=0,this.Wa=new zt,this.vb=new zt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ue,this.yc=new j}function Zt(){this.xb=this.a=0,this.l=new bo,this.ca=new Dt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new J,this.Pb=0,this.wd=new J,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new It,this.ab=0,this.gc=s(4,wt),this.Oc=0}function Ft(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new bo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function kn(v,S,F,U,G,Y,Z){for(v=v==null?0:v[S+0],S=0;S<Z;++S)G[Y+S]=v+F[U+S]&255,v=G[Y+S]}function mr(v,S,F,U,G,Y,Z){var ee;if(v==null)kn(null,null,F,U,G,Y,Z);else for(ee=0;ee<Z;++ee)G[Y+ee]=v[S+ee]+F[U+ee]&255}function sr(v,S,F,U,G,Y,Z){if(v==null)kn(null,null,F,U,G,Y,Z);else{var ee,ie=v[S+0],le=ie,_e=ie;for(ee=0;ee<Z;++ee)le=_e+(ie=v[S+ee])-le,_e=F[U+ee]+(-256&le?0>le?0:255:le)&255,le=ie,G[Y+ee]=_e}}function w(v,S,F,U){var G=S.width,Y=S.o;if(e(v!=null&&S!=null),0>F||0>=U||F+U>Y)return null;if(!v.Cc){if(v.ga==null){var Z;if(v.ga=new Ft,(Z=v.ga==null)||(Z=S.width*S.o,e(v.Gb.length==0),v.Gb=o(Z),v.Uc=0,v.Gb==null?Z=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,Z=1),Z=!Z),!Z){Z=v.ga;var ee=v.Fa,ie=v.P,le=v.qc,_e=v.mb,De=v.nb,he=ie+1,Ce=le-1,Pe=Z.l;if(e(ee!=null&&_e!=null&&S!=null),io[0]=null,io[1]=kn,io[2]=mr,io[3]=sr,Z.ca=_e,Z.tb=De,Z.c=S.width,Z.i=S.height,e(0<Z.c&&0<Z.i),1>=le)S=0;else if(Z.$a=3&ee[ie+0],Z.Z=ee[ie+0]>>2&3,Z.Lc=ee[ie+0]>>4&3,ie=ee[ie+0]>>6&3,0>Z.$a||1<Z.$a||4<=Z.Z||1<Z.Lc||ie)S=0;else if(Pe.put=Kt,Pe.ac=ui,Pe.bc=go,Pe.ma=Z,Pe.width=S.width,Pe.height=S.height,Pe.Da=S.Da,Pe.v=S.v,Pe.va=S.va,Pe.j=S.j,Pe.o=S.o,Z.$a)e:{e(Z.$a==1),S=xa();t:for(;;){if(S==null){S=0;break e}if(e(Z!=null),Z.mc=S,S.c=Z.c,S.i=Z.i,S.l=Z.l,S.l.ma=Z,S.l.width=Z.c,S.l.height=Z.i,S.a=0,ae(S.m,ee,he,Ce),!cs(Z.c,Z.i,1,S,null)||(S.ab==1&&S.gc[0].hc==3&&Oo(S.s)?(Z.ic=1,ee=S.c*S.i,S.Ta=null,S.Ua=0,S.V=o(ee),S.Ba=0,S.V==null?(S.a=1,S=0):S=1):(Z.ic=0,S=hs(S,Z.c)),!S))break t;S=1;break e}Z.mc=null,S=0}else S=Ce>=Z.c*Z.i;Z=!S}if(Z)return null;v.ga.Lc!=1?v.Ga=0:U=Y-F}e(v.ga!=null),e(F+U<=Y);e:{if(S=(ee=v.ga).c,Y=ee.l.o,ee.$a==0){if(he=v.rc,Ce=v.Vc,Pe=v.Fa,ie=v.P+1+F*S,le=v.mb,_e=v.nb+F*S,e(ie<=v.P+v.qc),ee.Z!=0)for(e(io[ee.Z]!=null),Z=0;Z<U;++Z)io[ee.Z](he,Ce,Pe,ie,le,_e,S),he=le,Ce=_e,_e+=S,ie+=S;else for(Z=0;Z<U;++Z)r(le,_e,Pe,ie,S),he=le,Ce=_e,_e+=S,ie+=S;v.rc=he,v.Vc=Ce}else{if(e(ee.mc!=null),S=F+U,e((Z=ee.mc)!=null),e(S<=Z.i),Z.C>=S)S=1;else if(ee.ic||je(),ee.ic){ee=Z.V,he=Z.Ba,Ce=Z.c;var $e=Z.i,Oe=(Pe=1,ie=Z.$/Ce,le=Z.$%Ce,_e=Z.m,De=Z.s,Z.$),qe=Ce*$e,Ge=Ce*S,Qe=De.wc,Je=Oe<Ge?Rr(De,le,ie):null;e(Oe<=qe),e(S<=$e),e(Oo(De));t:for(;;){for(;!_e.h&&Oe<Ge;){if(le&Qe||(Je=Rr(De,le,ie)),e(Je!=null),we(_e),256>($e=Xn(Je.G[0],Je.H[0],_e)))ee[he+Oe]=$e,++Oe,++le>=Ce&&(le=0,++ie<=S&&!(ie%16)&&Vr(Z,ie));else{if(!(280>$e)){Pe=0;break t}$e=li($e-256,_e);var Lt,bt=Xn(Je.G[4],Je.H[4],_e);if(we(_e),!(Oe>=(bt=vo(Ce,bt=li(bt,_e)))&&qe-Oe>=$e)){Pe=0;break t}for(Lt=0;Lt<$e;++Lt)ee[he+Oe+Lt]=ee[he+Oe+Lt-bt];for(Oe+=$e,le+=$e;le>=Ce;)le-=Ce,++ie<=S&&!(ie%16)&&Vr(Z,ie);Oe<Ge&&le&Qe&&(Je=Rr(De,le,ie))}e(_e.h==de(_e))}Vr(Z,ie>S?S:ie);break t}!Pe||_e.h&&Oe<qe?(Pe=0,Z.a=_e.h?5:3):Z.$=Oe,S=Pe}else S=yo(Z,Z.V,Z.Ba,Z.c,Z.i,S,_a);if(!S){U=0;break e}}F+U>=Y&&(v.Cc=1),U=1}if(!U)return null;if(v.Cc&&((U=v.ga)!=null&&(U.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+F*G}function B(v,S,F,U,G,Y){for(;0<G--;){var Z,ee=v,ie=S+(F?1:0),le=v,_e=S+(F?0:3);for(Z=0;Z<U;++Z){var De=le[_e+4*Z];De!=255&&(De*=32897,ee[ie+4*Z+0]=ee[ie+4*Z+0]*De>>23,ee[ie+4*Z+1]=ee[ie+4*Z+1]*De>>23,ee[ie+4*Z+2]=ee[ie+4*Z+2]*De>>23)}S+=Y}}function q(v,S,F,U,G){for(;0<U--;){var Y;for(Y=0;Y<F;++Y){var Z=v[S+2*Y+0],ee=15&(le=v[S+2*Y+1]),ie=4369*ee,le=(240&le|le>>4)*ie>>16;v[S+2*Y+0]=(240&Z|Z>>4)*ie>>16&240|(15&Z|Z<<4)*ie>>16>>4&15,v[S+2*Y+1]=240&le|ee}S+=G}}function ne(v,S,F,U,G,Y,Z,ee){var ie,le,_e=255;for(le=0;le<G;++le){for(ie=0;ie<U;++ie){var De=v[S+ie];Y[Z+4*ie]=De,_e&=De}S+=F,Z+=ee}return _e!=255}function Re(v,S,F,U,G){var Y;for(Y=0;Y<G;++Y)F[U+Y]=v[S+Y]>>8}function je(){Dl=B,dp=q,Ah=ne,pp=Re}function at(v,S,F){A[v]=function(U,G,Y,Z,ee,ie,le,_e,De,he,Ce,Pe,$e,Oe,qe,Ge,Qe){var Je,Lt=Qe-1>>1,bt=ee[ie+0]|le[_e+0]<<16,gn=De[he+0]|Ce[Pe+0]<<16;e(U!=null);var Ct=3*bt+gn+131074>>2;for(S(U[G+0],255&Ct,Ct>>16,$e,Oe),Y!=null&&(Ct=3*gn+bt+131074>>2,S(Y[Z+0],255&Ct,Ct>>16,qe,Ge)),Je=1;Je<=Lt;++Je){var Rn=ee[ie+Je]|le[_e+Je]<<16,Mr=De[he+Je]|Ce[Pe+Je]<<16,yn=bt+Rn+gn+Mr+524296,xt=yn+2*(Rn+gn)>>3;Ct=xt+bt>>1,bt=(yn=yn+2*(bt+Mr)>>3)+Rn>>1,S(U[G+2*Je-1],255&Ct,Ct>>16,$e,Oe+(2*Je-1)*F),S(U[G+2*Je-0],255&bt,bt>>16,$e,Oe+(2*Je-0)*F),Y!=null&&(Ct=yn+gn>>1,bt=xt+Mr>>1,S(Y[Z+2*Je-1],255&Ct,Ct>>16,qe,Ge+(2*Je-1)*F),S(Y[Z+2*Je+0],255&bt,bt>>16,qe,Ge+(2*Je+0)*F)),bt=Rn,gn=Mr}1&Qe||(Ct=3*bt+gn+131074>>2,S(U[G+Qe-1],255&Ct,Ct>>16,$e,Oe+(Qe-1)*F),Y!=null&&(Ct=3*gn+bt+131074>>2,S(Y[Z+Qe-1],255&Ct,Ct>>16,qe,Ge+(Qe-1)*F)))}}function on(){Wo[Nf]=T1,Wo[zu]=Wu,Wo[lg]=k1,Wo[Ch]=_c,Wo[Ih]=Fl,Wo[ar]=Ph,Wo[Rf]=Ep,Wo[wc]=Wu,Wo[Ll]=_c,Wo[Th]=Fl,Wo[kh]=Ph}function gr(v){return v&-16384?0>v?0:255:v>>qu}function Nn(v,S){return gr((19077*v>>8)+(26149*S>>8)-14234)}function vr(v,S,F){return gr((19077*v>>8)-(6419*S>>8)-(13320*F>>8)+8708)}function fi(v,S){return gr((19077*v>>8)+(33050*S>>8)-17685)}function no(v,S,F,U,G){U[G+0]=Nn(v,F),U[G+1]=vr(v,S,F),U[G+2]=fi(v,S)}function yr(v,S,F,U,G){U[G+0]=fi(v,S),U[G+1]=vr(v,S,F),U[G+2]=Nn(v,F)}function ro(v,S,F,U,G){var Y=vr(v,S,F);S=Y<<3&224|fi(v,S)>>3,U[G+0]=248&Nn(v,F)|Y>>5,U[G+1]=S}function Ps(v,S,F,U,G){var Y=240&fi(v,S)|15;U[G+0]=240&Nn(v,F)|vr(v,S,F)>>4,U[G+1]=Y}function Za(v,S,F,U,G){U[G+0]=255,no(v,S,F,U,G+1)}function _h(v,S,F,U,G){yr(v,S,F,U,G),U[G+3]=255}function Eo(v,S,F,U,G){no(v,S,F,U,G),U[G+3]=255}function ta(v,S,F){A[v]=function(U,G,Y,Z,ee,ie,le,_e,De){for(var he=_e+(-2&De)*F;_e!=he;)S(U[G+0],Y[Z+0],ee[ie+0],le,_e),S(U[G+1],Y[Z+0],ee[ie+0],le,_e+F),G+=2,++Z,++ie,_e+=2*F;1&De&&S(U[G+0],Y[Z+0],ee[ie+0],le,_e)}}function Na(v,S,F){return F==0?v==0?S==0?6:5:S==0?4:0:F}function If(v,S,F,U,G){switch(v>>>30){case 3:Rl(S,F,U,G,0);break;case 2:Dr(S,F,U,G);break;case 1:qn(S,F,U,G)}}function vs(v,S){var F,U,G=S.M,Y=S.Nb,Z=v.oc,ee=v.pc+40,ie=v.oc,le=v.pc+584,_e=v.oc,De=v.pc+600;for(F=0;16>F;++F)Z[ee+32*F-1]=129;for(F=0;8>F;++F)ie[le+32*F-1]=129,_e[De+32*F-1]=129;for(0<G?Z[ee-1-32]=ie[le-1-32]=_e[De-1-32]=129:(i(Z,ee-32-1,127,21),i(ie,le-32-1,127,9),i(_e,De-32-1,127,9)),U=0;U<v.za;++U){var he=S.ya[S.aa+U];if(0<U){for(F=-1;16>F;++F)r(Z,ee+32*F-4,Z,ee+32*F+12,4);for(F=-1;8>F;++F)r(ie,le+32*F-4,ie,le+32*F+4,4),r(_e,De+32*F-4,_e,De+32*F+4,4)}var Ce=v.Gd,Pe=v.Hd+U,$e=he.ad,Oe=he.Hc;if(0<G&&(r(Z,ee-32,Ce[Pe].y,0,16),r(ie,le-32,Ce[Pe].f,0,8),r(_e,De-32,Ce[Pe].ea,0,8)),he.Za){var qe=Z,Ge=ee-32+16;for(0<G&&(U>=v.za-1?i(qe,Ge,Ce[Pe].y[15],4):r(qe,Ge,Ce[Pe+1].y,0,4)),F=0;4>F;F++)qe[Ge+128+F]=qe[Ge+256+F]=qe[Ge+384+F]=qe[Ge+0+F];for(F=0;16>F;++F,Oe<<=2)qe=Z,Ge=ee+Sp[F],Ms[he.Ob[F]](qe,Ge),If(Oe,$e,16*+F,qe,Ge)}else if(qe=Na(U,G,he.Ob[0]),Ao[qe](Z,ee),Oe!=0)for(F=0;16>F;++F,Oe<<=2)If(Oe,$e,16*+F,Z,ee+Sp[F]);for(F=he.Gc,qe=Na(U,G,he.Dd),zo[qe](ie,le),zo[qe](_e,De),Oe=$e,qe=ie,Ge=le,255&(he=0|F)&&(170&he?Uo(Oe,256,qe,Ge):tr(Oe,256,qe,Ge)),he=_e,Oe=De,255&(F>>=8)&&(170&F?Uo($e,320,he,Oe):tr($e,320,he,Oe)),G<v.Ub-1&&(r(Ce[Pe].y,0,Z,ee+480,16),r(Ce[Pe].f,0,ie,le+224,8),r(Ce[Pe].ea,0,_e,De+224,8)),F=8*Y*v.B,Ce=v.sa,Pe=v.ta+16*U+16*Y*v.R,$e=v.qa,he=v.ra+8*U+F,Oe=v.Ha,qe=v.Ia+8*U+F,F=0;16>F;++F)r(Ce,Pe+F*v.R,Z,ee+32*F,16);for(F=0;8>F;++F)r($e,he+F*v.B,ie,le+32*F,8),r(Oe,qe+F*v.B,_e,De+32*F,8)}}function Fu(v,S,F,U,G,Y,Z,ee,ie){var le=[0],_e=[0],De=0,he=ie!=null?ie.kd:0,Ce=ie??new Ze;if(v==null||12>F)return 7;Ce.data=v,Ce.w=S,Ce.ha=F,S=[S],F=[F],Ce.gb=[Ce.gb];e:{var Pe=S,$e=F,Oe=Ce.gb;if(e(v!=null),e($e!=null),e(Oe!=null),Oe[0]=0,12<=$e[0]&&!t(v,Pe[0],"RIFF")){if(t(v,Pe[0]+8,"WEBP")){Oe=3;break e}var qe=tt(v,Pe[0]+4);if(12>qe||4294967286<qe){Oe=3;break e}if(he&&qe>$e[0]-8){Oe=7;break e}Oe[0]=qe,Pe[0]+=12,$e[0]-=12}Oe=0}if(Oe!=0)return Oe;for(qe=0<Ce.gb[0],F=F[0];;){e:{var Ge=v;$e=S,Oe=F;var Qe=le,Je=_e,Lt=Pe=[0];if((Ct=De=[De])[0]=0,8>Oe[0])Oe=7;else{if(!t(Ge,$e[0],"VP8X")){if(tt(Ge,$e[0]+4)!=10){Oe=3;break e}if(18>Oe[0]){Oe=7;break e}var bt=tt(Ge,$e[0]+8),gn=1+Le(Ge,$e[0]+12);if(2147483648<=gn*(Ge=1+Le(Ge,$e[0]+15))){Oe=3;break e}Lt!=null&&(Lt[0]=bt),Qe!=null&&(Qe[0]=gn),Je!=null&&(Je[0]=Ge),$e[0]+=18,Oe[0]-=18,Ct[0]=1}Oe=0}}if(De=De[0],Pe=Pe[0],Oe!=0)return Oe;if($e=!!(2&Pe),!qe&&De)return 3;if(Y!=null&&(Y[0]=!!(16&Pe)),Z!=null&&(Z[0]=$e),ee!=null&&(ee[0]=0),Z=le[0],Pe=_e[0],De&&$e&&ie==null){Oe=0;break}if(4>F){Oe=7;break}if(qe&&De||!qe&&!De&&!t(v,S[0],"ALPH")){F=[F],Ce.na=[Ce.na],Ce.P=[Ce.P],Ce.Sa=[Ce.Sa];e:{bt=v,Oe=S,qe=F;var Ct=Ce.gb;Qe=Ce.na,Je=Ce.P,Lt=Ce.Sa,gn=22,e(bt!=null),e(qe!=null),Ge=Oe[0];var Rn=qe[0];for(e(Qe!=null),e(Lt!=null),Qe[0]=null,Je[0]=null,Lt[0]=0;;){if(Oe[0]=Ge,qe[0]=Rn,8>Rn){Oe=7;break e}var Mr=tt(bt,Ge+4);if(4294967286<Mr){Oe=3;break e}var yn=8+Mr+1&-2;if(gn+=yn,0<Ct&&gn>Ct){Oe=3;break e}if(!t(bt,Ge,"VP8 ")||!t(bt,Ge,"VP8L")){Oe=0;break e}if(Rn[0]<yn){Oe=7;break e}t(bt,Ge,"ALPH")||(Qe[0]=bt,Je[0]=Ge+8,Lt[0]=Mr),Ge+=yn,Rn-=yn}}if(F=F[0],Ce.na=Ce.na[0],Ce.P=Ce.P[0],Ce.Sa=Ce.Sa[0],Oe!=0)break}F=[F],Ce.Ja=[Ce.Ja],Ce.xa=[Ce.xa];e:if(Ct=v,Oe=S,qe=F,Qe=Ce.gb[0],Je=Ce.Ja,Lt=Ce.xa,bt=Oe[0],Ge=!t(Ct,bt,"VP8 "),gn=!t(Ct,bt,"VP8L"),e(Ct!=null),e(qe!=null),e(Je!=null),e(Lt!=null),8>qe[0])Oe=7;else{if(Ge||gn){if(Ct=tt(Ct,bt+4),12<=Qe&&Ct>Qe-12){Oe=3;break e}if(he&&Ct>qe[0]-8){Oe=7;break e}Je[0]=Ct,Oe[0]+=8,qe[0]-=8,Lt[0]=gn}else Lt[0]=5<=qe[0]&&Ct[bt+0]==47&&!(Ct[bt+4]>>5),Je[0]=qe[0];Oe=0}if(F=F[0],Ce.Ja=Ce.Ja[0],Ce.xa=Ce.xa[0],S=S[0],Oe!=0)break;if(4294967286<Ce.Ja)return 3;if(ee==null||$e||(ee[0]=Ce.xa?2:1),Z=[Z],Pe=[Pe],Ce.xa){if(5>F){Oe=7;break}ee=Z,he=Pe,$e=Y,v==null||5>F?v=0:5<=F&&v[S+0]==47&&!(v[S+4]>>5)?(qe=[0],Ct=[0],Qe=[0],ae(Je=new J,v,S,F),Yi(Je,qe,Ct,Qe)?(ee!=null&&(ee[0]=qe[0]),he!=null&&(he[0]=Ct[0]),$e!=null&&($e[0]=Qe[0]),v=1):v=0):v=0}else{if(10>F){Oe=7;break}ee=Pe,v==null||10>F||!fs(v,S+3,F-3)?v=0:(he=v[S+0]|v[S+1]<<8|v[S+2]<<16,$e=16383&(v[S+7]<<8|v[S+6]),v=16383&(v[S+9]<<8|v[S+8]),1&he||3<(he>>1&7)||!(he>>4&1)||he>>5>=Ce.Ja||!$e||!v?v=0:(Z&&(Z[0]=$e),ee&&(ee[0]=v),v=1))}if(!v||(Z=Z[0],Pe=Pe[0],De&&(le[0]!=Z||_e[0]!=Pe)))return 3;ie!=null&&(ie[0]=Ce,ie.offset=S-ie.w,e(4294967286>S-ie.w),e(ie.offset==ie.ha-F));break}return Oe==0||Oe==7&&De&&ie==null?(Y!=null&&(Y[0]|=Ce.na!=null&&0<Ce.na.length),U!=null&&(U[0]=Z),G!=null&&(G[0]=Pe),0):Oe}function fc(v,S,F){var U=S.width,G=S.height,Y=0,Z=0,ee=U,ie=G;if(S.Da=v!=null&&0<v.Da,S.Da&&(ee=v.cd,ie=v.bd,Y=v.v,Z=v.j,11>F||(Y&=-2,Z&=-2),0>Y||0>Z||0>=ee||0>=ie||Y+ee>U||Z+ie>G))return 0;if(S.v=Y,S.j=Z,S.va=Y+ee,S.o=Z+ie,S.U=ee,S.T=ie,S.da=v!=null&&0<v.da,S.da){if(!gt(ee,ie,F=[v.ib],Y=[v.hb]))return 0;S.ib=F[0],S.hb=Y[0]}return S.ob=v!=null&&v.ob,S.Kb=v==null||!v.Sd,S.da&&(S.ob=S.ib<3*U/4&&S.hb<3*G/4,S.Kb=0),1}function dc(v){if(v==null)return 2;if(11>v.S){var S=v.f.RGBA;S.fb+=(v.height-1)*S.A,S.A=-S.A}else S=v.f.kb,v=v.height,S.O+=(v-1)*S.fa,S.fa=-S.fa,S.N+=(v-1>>1)*S.Ab,S.Ab=-S.Ab,S.W+=(v-1>>1)*S.Db,S.Db=-S.Db,S.F!=null&&(S.J+=(v-1)*S.lb,S.lb=-S.lb);return 0}function eu(v,S,F,U){if(U==null||0>=v||0>=S)return 2;if(F!=null){if(F.Da){var G=F.cd,Y=F.bd,Z=-2&F.v,ee=-2&F.j;if(0>Z||0>ee||0>=G||0>=Y||Z+G>v||ee+Y>S)return 2;v=G,S=Y}if(F.da){if(!gt(v,S,G=[F.ib],Y=[F.hb]))return 2;v=G[0],S=Y[0]}}U.width=v,U.height=S;e:{var ie=U.width,le=U.height;if(v=U.S,0>=ie||0>=le||!(v>=Nf&&13>v))v=2;else{if(0>=U.Rd&&U.sd==null){Z=Y=G=S=0;var _e=(ee=ie*Dh[v])*le;if(11>v||(Y=(le+1)/2*(S=(ie+1)/2),v==12&&(Z=(G=ie)*le)),(le=o(_e+2*Y+Z))==null){v=1;break e}U.sd=le,11>v?((ie=U.f.RGBA).eb=le,ie.fb=0,ie.A=ee,ie.size=_e):((ie=U.f.kb).y=le,ie.O=0,ie.fa=ee,ie.Fd=_e,ie.f=le,ie.N=0+_e,ie.Ab=S,ie.Cd=Y,ie.ea=le,ie.W=0+_e+Y,ie.Db=S,ie.Ed=Y,v==12&&(ie.F=le,ie.J=0+_e+2*Y),ie.Tc=Z,ie.lb=G)}if(S=1,G=U.S,Y=U.width,Z=U.height,G>=Nf&&13>G)if(11>G)v=U.f.RGBA,S&=(ee=Math.abs(v.A))*(Z-1)+Y<=v.size,S&=ee>=Y*Dh[G],S&=v.eb!=null;else{v=U.f.kb,ee=(Y+1)/2,_e=(Z+1)/2,ie=Math.abs(v.fa),le=Math.abs(v.Ab);var De=Math.abs(v.Db),he=Math.abs(v.lb),Ce=he*(Z-1)+Y;S&=ie*(Z-1)+Y<=v.Fd,S&=le*(_e-1)+ee<=v.Cd,S=(S&=De*(_e-1)+ee<=v.Ed)&ie>=Y&le>=ee&De>=ee,S&=v.y!=null,S&=v.f!=null,S&=v.ea!=null,G==12&&(S&=he>=Y,S&=Ce<=v.Tc,S&=v.F!=null)}else S=0;v=S?0:2}}return v!=0||F!=null&&F.fd&&(v=dc(U)),v}var Ds=64,ys=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ws=24,Bu=32,Ra=8,tu=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];lt("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(v){return v},A.Predictor2=function(v,S,F){return S[F+0]},A.Predictor3=function(v,S,F){return S[F+1]},A.Predictor4=function(v,S,F){return S[F-1]},A.Predictor5=function(v,S,F){return pt(pt(v,S[F+1]),S[F+0])},A.Predictor6=function(v,S,F){return pt(v,S[F-1])},A.Predictor7=function(v,S,F){return pt(v,S[F+0])},A.Predictor8=function(v,S,F){return pt(S[F-1],S[F+0])},A.Predictor9=function(v,S,F){return pt(S[F+0],S[F+1])},A.Predictor10=function(v,S,F){return pt(pt(v,S[F-1]),pt(S[F+0],S[F+1]))},A.Predictor11=function(v,S,F){var U=S[F+0];return 0>=Qt(U>>24&255,v>>24&255,(S=S[F-1])>>24&255)+Qt(U>>16&255,v>>16&255,S>>16&255)+Qt(U>>8&255,v>>8&255,S>>8&255)+Qt(255&U,255&v,255&S)?U:v},A.Predictor12=function(v,S,F){var U=S[F+0];return(En((v>>24&255)+(U>>24&255)-((S=S[F-1])>>24&255))<<24|En((v>>16&255)+(U>>16&255)-(S>>16&255))<<16|En((v>>8&255)+(U>>8&255)-(S>>8&255))<<8|En((255&v)+(255&U)-(255&S)))>>>0},A.Predictor13=function(v,S,F){var U=S[F-1];return($t((v=pt(v,S[F+0]))>>24&255,U>>24&255)<<24|$t(v>>16&255,U>>16&255)<<16|$t(v>>8&255,U>>8&255)<<8|$t(255&v,255&U))>>>0};var nu=A.PredictorAdd0;A.PredictorAdd1=an,lt("Predictor2","PredictorAdd2"),lt("Predictor3","PredictorAdd3"),lt("Predictor4","PredictorAdd4"),lt("Predictor5","PredictorAdd5"),lt("Predictor6","PredictorAdd6"),lt("Predictor7","PredictorAdd7"),lt("Predictor8","PredictorAdd8"),lt("Predictor9","PredictorAdd9"),lt("Predictor10","PredictorAdd10"),lt("Predictor11","PredictorAdd11"),lt("Predictor12","PredictorAdd12"),lt("Predictor13","PredictorAdd13");var Pa=A.PredictorAdd2;yt("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),yt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var Ur,Il=A.ColorIndexInverseTransform,Da=A.MapARGB,na=A.VP8LColorIndexInverseTransformAlpha,Tl=A.MapAlpha,kl=A.VP8LPredictorsAdd=[];kl.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var pc,mc,ru,Vu,ju,Nl,Uu,Rl,Dr,Uo,qn,tr,Lr,Zr,ra,Eh,gc,iu,Tf,vc,kf,fp,Sh,Pl,Dl,dp,Ah,pp,mp=o(511),gp=o(2041),vp=o(225),yp=o(767),wp=0,La=gp,yc=vp,So=yp,Ls=mp,Nf=0,zu=1,lg=2,Ch=3,Ih=4,ar=5,Rf=6,wc=7,Ll=8,Th=9,kh=10,Nh=[2,3,7],Pf=[3,3,11],Ml=[280,256,256,256,40],cg=[0,1,1,1,0],S1=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],A1=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],hg=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Df=8,bc=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Rh=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ol=null,bp=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],xp=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],fg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],dg=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],C1=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],I1=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],_p=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ao=[],Ms=[],zo=[],Ma=1,xc=2,io=[],Wo=[];at("UpsampleRgbLinePair",no,3),at("UpsampleBgrLinePair",yr,3),at("UpsampleRgbaLinePair",Eo,4),at("UpsampleBgraLinePair",_h,4),at("UpsampleArgbLinePair",Za,4),at("UpsampleRgba4444LinePair",Ps,2),at("UpsampleRgb565LinePair",ro,2);var T1=A.UpsampleRgbLinePair,k1=A.UpsampleBgrLinePair,Wu=A.UpsampleRgbaLinePair,_c=A.UpsampleBgraLinePair,Fl=A.UpsampleArgbLinePair,Ph=A.UpsampleRgba4444LinePair,Ep=A.UpsampleRgb565LinePair,ou=16,ia=1<<ou-1,Zn=-227,nr=482,qu=6,Vi=0,qo=o(256),Bl=o(256),Ec=o(256),Ho=o(256),Lf=o(nr-Zn),pg=o(nr-Zn);ta("YuvToRgbRow",no,3),ta("YuvToBgrRow",yr,3),ta("YuvToRgbaRow",Eo,4),ta("YuvToBgraRow",_h,4),ta("YuvToArgbRow",Za,4),ta("YuvToRgba4444Row",Ps,2),ta("YuvToRgb565Row",ro,2);var Sp=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Vl=[0,2,8],mg=[8,7,6,4,4,2,2,2,1,1,1,1],su=1;this.WebPDecodeRGBA=function(v,S,F,U,G){var Y=zu,Z=new Xe,ee=new Dt;Z.ba=ee,ee.S=Y,ee.width=[ee.width],ee.height=[ee.height];var ie=ee.width,le=ee.height,_e=new Gt;if(_e==null||v==null)var De=2;else e(_e!=null),De=Fu(v,S,F,_e.width,_e.height,_e.Pd,_e.Qd,_e.format,null);if(De!=0?ie=0:(ie!=null&&(ie[0]=_e.width[0]),le!=null&&(le[0]=_e.height[0]),ie=1),ie){ee.width=ee.width[0],ee.height=ee.height[0],U!=null&&(U[0]=ee.width),G!=null&&(G[0]=ee.height);e:{if(U=new bo,(G=new Ze).data=v,G.w=S,G.ha=F,G.kd=1,S=[0],e(G!=null),((v=Fu(G.data,G.w,G.ha,null,null,null,S,null,G))==0||v==7)&&S[0]&&(v=4),(S=v)==0){if(e(Z!=null),U.data=G.data,U.w=G.w+G.offset,U.ha=G.ha-G.offset,U.put=Kt,U.ac=ui,U.bc=go,U.ma=Z,G.xa){if((v=xa())==null){Z=1;break e}if((function(he,Ce){var Pe=[0],$e=[0],Oe=[0];t:for(;;){if(he==null)return 0;if(Ce==null)return he.a=2,0;if(he.l=Ce,he.a=0,ae(he.m,Ce.data,Ce.w,Ce.ha),!Yi(he.m,Pe,$e,Oe)){he.a=3;break t}if(he.xb=xc,Ce.width=Pe[0],Ce.height=$e[0],!cs(Pe[0],$e[0],1,he,null))break t;return 1}return e(he.a!=0),0})(v,U)){if(U=(S=eu(U.width,U.height,Z.Oa,Z.ba))==0){t:{U=v;n:for(;;){if(U==null){U=0;break t}if(e(U.s.yc!=null),e(U.s.Ya!=null),e(0<U.s.Wb),e((F=U.l)!=null),e((G=F.ma)!=null),U.xb!=0){if(U.ca=G.ba,U.tb=G.tb,e(U.ca!=null),!fc(G.Oa,F,Ch)){U.a=2;break n}if(!hs(U,F.width)||F.da)break n;if((F.da||Ht(U.ca.S))&&je(),11>U.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),U.ca.f.kb.F!=null&&je()),U.Pb&&0<U.s.ua&&U.s.vb.X==null&&!re(U.s.vb,U.s.Wa.Xa)){U.a=1;break n}U.xb=0}if(!yo(U,U.V,U.Ba,U.c,U.i,F.o,Ks))break n;G.Dc=U.Ma,U=1;break t}e(U.a!=0),U=0}U=!U}U&&(S=v.a)}else S=v.a}else{if((v=new Bo)==null){Z=1;break e}if(v.Fa=G.na,v.P=G.P,v.qc=G.Sa,Oi(v,U)){if((S=eu(U.width,U.height,Z.Oa,Z.ba))==0){if(v.Aa=0,F=Z.Oa,e((G=v)!=null),F!=null){if(0<(ie=0>(ie=F.Md)?0:100<ie?255:255*ie/100)){for(le=_e=0;4>le;++le)12>(De=G.pb[le]).lc&&(De.ia=ie*mg[0>De.lc?0:De.lc]>>3),_e|=De.ia;_e&&(alert("todo:VP8InitRandom"),G.ia=1)}G.Ga=F.Id,100<G.Ga?G.Ga=100:0>G.Ga&&(G.Ga=0)}(function(he,Ce){if(he==null)return 0;if(Ce==null)return pr(he,2,"NULL VP8Io parameter in VP8Decode().");if(!he.cb&&!Oi(he,Ce))return 0;if(e(he.cb),Ce.ac==null||Ce.ac(Ce)){Ce.ob&&(he.L=0);var Pe=Vl[he.L];if(he.L==2?(he.yb=0,he.zb=0):(he.yb=Ce.v-Pe>>4,he.zb=Ce.j-Pe>>4,0>he.yb&&(he.yb=0),0>he.zb&&(he.zb=0)),he.Va=Ce.o+15+Pe>>4,he.Hb=Ce.va+15+Pe>>4,he.Hb>he.za&&(he.Hb=he.za),he.Va>he.Ub&&(he.Va=he.Ub),0<he.L){var $e=he.ed;for(Pe=0;4>Pe;++Pe){var Oe;if(he.Qa.Cb){var qe=he.Qa.Lb[Pe];he.Qa.Fb||(qe+=$e.Tb)}else qe=$e.Tb;for(Oe=0;1>=Oe;++Oe){var Ge=he.gd[Pe][Oe],Qe=qe;if($e.Pc&&(Qe+=$e.vd[0],Oe&&(Qe+=$e.od[0])),0<(Qe=0>Qe?0:63<Qe?63:Qe)){var Je=Qe;0<$e.wb&&(Je=4<$e.wb?Je>>2:Je>>1)>9-$e.wb&&(Je=9-$e.wb),1>Je&&(Je=1),Ge.dd=Je,Ge.tc=2*Qe+Je,Ge.ld=40<=Qe?2:15<=Qe?1:0}else Ge.tc=0;Ge.La=Oe}}}Pe=0}else pr(he,6,"Frame setup failed"),Pe=he.a;if(Pe=Pe==0){if(Pe){he.$c=0,0<he.Aa||(he.Ic=su);t:{Pe=he.Ic,$e=4*(Je=he.za);var Lt=32*Je,bt=Je+1,gn=0<he.L?Je*(0<he.Aa?2:1):0,Ct=(he.Aa==2?2:1)*Je;if((Ge=$e+832+(Oe=3*(16*Pe+Vl[he.L])/2*Lt)+(qe=he.Fa!=null&&0<he.Fa.length?he.Kc.c*he.Kc.i:0))!=Ge)Pe=0;else{if(Ge>he.Vb){if(he.Vb=0,he.Ec=o(Ge),he.Fc=0,he.Ec==null){Pe=pr(he,1,"no memory during frame initialization.");break t}he.Vb=Ge}Ge=he.Ec,Qe=he.Fc,he.Ac=Ge,he.Bc=Qe,Qe+=$e,he.Gd=s(Lt,Ji),he.Hd=0,he.rb=s(bt+1,Qs),he.sb=1,he.wa=gn?s(gn,Qi):null,he.Y=0,he.D.Nb=0,he.D.wa=he.wa,he.D.Y=he.Y,0<he.Aa&&(he.D.Y+=Je),e(!0),he.oc=Ge,he.pc=Qe,Qe+=832,he.ya=s(Ct,Ea),he.aa=0,he.D.ya=he.ya,he.D.aa=he.aa,he.Aa==2&&(he.D.aa+=Je),he.R=16*Je,he.B=8*Je,Je=(Lt=Vl[he.L])*he.R,Lt=Lt/2*he.B,he.sa=Ge,he.ta=Qe+Je,he.qa=he.sa,he.ra=he.ta+16*Pe*he.R+Lt,he.Ha=he.qa,he.Ia=he.ra+8*Pe*he.B+Lt,he.$c=0,Qe+=Oe,he.mb=qe?Ge:null,he.nb=qe?Qe:null,e(Qe+qe<=he.Fc+he.Vb),Is(he),i(he.Ac,he.Bc,0,$e),Pe=1}}if(Pe){if(Ce.ka=0,Ce.y=he.sa,Ce.O=he.ta,Ce.f=he.qa,Ce.N=he.ra,Ce.ea=he.Ha,Ce.Vd=he.Ia,Ce.fa=he.R,Ce.Rc=he.B,Ce.F=null,Ce.J=0,!wp){for(Pe=-255;255>=Pe;++Pe)mp[255+Pe]=0>Pe?-Pe:Pe;for(Pe=-1020;1020>=Pe;++Pe)gp[1020+Pe]=-128>Pe?-128:127<Pe?127:Pe;for(Pe=-112;112>=Pe;++Pe)vp[112+Pe]=-16>Pe?-16:15<Pe?15:Pe;for(Pe=-255;510>=Pe;++Pe)yp[255+Pe]=0>Pe?0:255<Pe?255:Pe;wp=1}Uu=xo,Rl=Xa,Uo=Ts,qn=Pu,tr=An,Dr=_l,Lr=hi,Zr=to,ra=H,Eh=pe,gc=ka,iu=N,Tf=be,vc=Ne,kf=Rs,fp=ms,Sh=Cl,Pl=Ta,Ms[0]=Aa,Ms[1]=Du,Ms[2]=_o,Ms[3]=hc,Ms[4]=ci,Ms[5]=Lu,Ms[6]=Ns,Ms[7]=Jn,Ms[8]=Al,Ms[9]=Ja,Ao[0]=ks,Ao[1]=Sl,Ao[2]=Ya,Ao[3]=ps,Ao[4]=eo,Ao[5]=jr,Ao[6]=Qa,zo[0]=Zs,zo[1]=El,zo[2]=Vo,zo[3]=Ca,zo[4]=Mu,zo[5]=jo,zo[6]=Ou,Pe=1}else Pe=0}Pe&&(Pe=(function(Rn,Mr){for(Rn.M=0;Rn.M<Rn.Va;++Rn.M){var yn,xt=Rn.Jc[Rn.M&Rn.Xb],ct=Rn.m,zr=Rn;for(yn=0;yn<zr.za;++yn){var ln=ct,In=zr,wr=In.Ac,Ii=In.Bc+4*yn,ei=In.zc,Ir=In.ya[In.aa+yn];if(In.Qa.Bb?Ir.$b=Fe(ln,In.Pa.jb[0])?2+Fe(ln,In.Pa.jb[2]):Fe(ln,In.Pa.jb[1]):Ir.$b=0,In.kc&&(Ir.Ad=Fe(ln,In.Bd)),Ir.Za=!Fe(ln,145)+0,Ir.Za){var di=Ir.Ob,Ti=0;for(In=0;4>In;++In){var Er,Ln=ei[0+In];for(Er=0;4>Er;++Er){Ln=C1[wr[Ii+Er]][Ln];for(var Hn=fg[Fe(ln,Ln[0])];0<Hn;)Hn=fg[2*Hn+Fe(ln,Ln[Hn])];Ln=-Hn,wr[Ii+Er]=Ln}r(di,Ti,wr,Ii,4),Ti+=4,ei[0+In]=Ln}}else Ln=Fe(ln,156)?Fe(ln,128)?1:3:Fe(ln,163)?2:0,Ir.Ob[0]=Ln,i(wr,Ii,Ln,4),i(ei,0,Ln,4);Ir.Dd=Fe(ln,142)?Fe(ln,114)?Fe(ln,183)?1:3:2:0}if(zr.m.Ka)return pr(Rn,7,"Premature end-of-partition0 encountered.");for(;Rn.ja<Rn.za;++Rn.ja){if(zr=xt,ln=(ct=Rn).rb[ct.sb-1],wr=ct.rb[ct.sb+ct.ja],yn=ct.ya[ct.aa+ct.ja],Ii=ct.kc?yn.Ad:0)ln.la=wr.la=0,yn.Za||(ln.Na=wr.Na=0),yn.Hc=0,yn.Gc=0,yn.ia=0;else{var Sr,Gn;if(ln=wr,wr=zr,Ii=ct.Pa.Xc,ei=ct.ya[ct.aa+ct.ja],Ir=ct.pb[ei.$b],In=ei.ad,di=0,Ti=ct.rb[ct.sb-1],Ln=Er=0,i(In,di,0,384),ei.Za)var Or=0,Fr=Ii[3];else{Hn=o(16);var ur=ln.Na+Ti.Na;if(ur=Ol(wr,Ii[1],ur,Ir.Eb,0,Hn,0),ln.Na=Ti.Na=(0<ur)+0,1<ur)Uu(Hn,0,In,di);else{var oo=Hn[0]+3>>3;for(Hn=0;256>Hn;Hn+=16)In[di+Hn]=oo}Or=1,Fr=Ii[0]}var rr=15&ln.la,lr=15&Ti.la;for(Hn=0;4>Hn;++Hn){var ti=1&lr;for(oo=Gn=0;4>oo;++oo)rr=rr>>1|(ti=(ur=Ol(wr,Fr,ur=ti+(1&rr),Ir.Sc,Or,In,di))>Or)<<7,Gn=Gn<<2|(3<ur?3:1<ur?2:In[di+0]!=0),di+=16;rr>>=4,lr=lr>>1|ti<<7,Er=(Er<<8|Gn)>>>0}for(Fr=rr,Or=lr>>4,Sr=0;4>Sr;Sr+=2){for(Gn=0,rr=ln.la>>4+Sr,lr=Ti.la>>4+Sr,Hn=0;2>Hn;++Hn){for(ti=1&lr,oo=0;2>oo;++oo)ur=ti+(1&rr),rr=rr>>1|(ti=0<(ur=Ol(wr,Ii[2],ur,Ir.Qc,0,In,di)))<<3,Gn=Gn<<2|(3<ur?3:1<ur?2:In[di+0]!=0),di+=16;rr>>=2,lr=lr>>1|ti<<5}Ln|=Gn<<4*Sr,Fr|=rr<<4<<Sr,Or|=(240&lr)<<Sr}ln.la=Fr,Ti.la=Or,ei.Hc=Er,ei.Gc=Ln,ei.ia=43690&Ln?0:Ir.ia,Ii=!(Er|Ln)}if(0<ct.L&&(ct.wa[ct.Y+ct.ja]=ct.gd[yn.$b][yn.Za],ct.wa[ct.Y+ct.ja].La|=!Ii),zr.Ka)return pr(Rn,7,"Premature end-of-file encountered.")}if(Is(Rn),ct=Mr,zr=1,yn=(xt=Rn).D,ln=0<xt.L&&xt.M>=xt.zb&&xt.M<=xt.Va,xt.Aa==0)t:{if(yn.M=xt.M,yn.uc=ln,vs(xt,yn),zr=1,yn=(Gn=xt.D).Nb,ln=(Ln=Vl[xt.L])*xt.R,wr=Ln/2*xt.B,Hn=16*yn*xt.R,oo=8*yn*xt.B,Ii=xt.sa,ei=xt.ta-ln+Hn,Ir=xt.qa,In=xt.ra-wr+oo,di=xt.Ha,Ti=xt.Ia-wr+oo,lr=(rr=Gn.M)==0,Er=rr>=xt.Va-1,xt.Aa==2&&vs(xt,Gn),Gn.uc)for(ti=(ur=xt).D.M,e(ur.D.uc),Gn=ur.yb;Gn<ur.Hb;++Gn){Or=Gn,Fr=ti;var ji=(Go=(Hr=ur).D).Nb;Sr=Hr.R;var Go=Go.wa[Go.Y+Or],Wr=Hr.sa,qr=Hr.ta+16*ji*Sr+16*Or,so=Go.dd,cr=Go.tc;if(cr!=0)if(e(3<=cr),Hr.L==1)0<Or&&fp(Wr,qr,Sr,cr+4),Go.La&&Pl(Wr,qr,Sr,cr),0<Fr&&kf(Wr,qr,Sr,cr+4),Go.La&&Sh(Wr,qr,Sr,cr);else{var ao=Hr.B,Os=Hr.qa,oa=Hr.ra+8*ji*ao+8*Or,ki=Hr.Ha,Hr=Hr.Ia+8*ji*ao+8*Or;ji=Go.ld,0<Or&&(Zr(Wr,qr,Sr,cr+4,so,ji),Eh(Os,oa,ki,Hr,ao,cr+4,so,ji)),Go.La&&(iu(Wr,qr,Sr,cr,so,ji),vc(Os,oa,ki,Hr,ao,cr,so,ji)),0<Fr&&(Lr(Wr,qr,Sr,cr+4,so,ji),ra(Os,oa,ki,Hr,ao,cr+4,so,ji)),Go.La&&(gc(Wr,qr,Sr,cr,so,ji),Tf(Os,oa,ki,Hr,ao,cr,so,ji))}}if(xt.ia&&alert("todo:DitherRow"),ct.put!=null){if(Gn=16*rr,rr=16*(rr+1),lr?(ct.y=xt.sa,ct.O=xt.ta+Hn,ct.f=xt.qa,ct.N=xt.ra+oo,ct.ea=xt.Ha,ct.W=xt.Ia+oo):(Gn-=Ln,ct.y=Ii,ct.O=ei,ct.f=Ir,ct.N=In,ct.ea=di,ct.W=Ti),Er||(rr-=Ln),rr>ct.o&&(rr=ct.o),ct.F=null,ct.J=null,xt.Fa!=null&&0<xt.Fa.length&&Gn<rr&&(ct.J=w(xt,ct,Gn,rr-Gn),ct.F=xt.mb,ct.F==null&&ct.F.length==0)){zr=pr(xt,3,"Could not decode alpha data.");break t}Gn<ct.j&&(Ln=ct.j-Gn,Gn=ct.j,e(!(1&Ln)),ct.O+=xt.R*Ln,ct.N+=xt.B*(Ln>>1),ct.W+=xt.B*(Ln>>1),ct.F!=null&&(ct.J+=ct.width*Ln)),Gn<rr&&(ct.O+=ct.v,ct.N+=ct.v>>1,ct.W+=ct.v>>1,ct.F!=null&&(ct.J+=ct.v),ct.ka=Gn-ct.j,ct.U=ct.va-ct.v,ct.T=rr-Gn,zr=ct.put(ct))}yn+1!=xt.Ic||Er||(r(xt.sa,xt.ta-ln,Ii,ei+16*xt.R,ln),r(xt.qa,xt.ra-wr,Ir,In+8*xt.B,wr),r(xt.Ha,xt.Ia-wr,di,Ti+8*xt.B,wr))}if(!zr)return pr(Rn,6,"Output aborted.")}return 1})(he,Ce)),Ce.bc!=null&&Ce.bc(Ce),Pe&=1}return Pe?(he.cb=0,Pe):0})(v,U)||(S=v.a)}}else S=v.a}S==0&&Z.Oa!=null&&Z.Oa.fd&&(S=dc(Z.ba))}Z=S}Y=Z!=0?null:11>Y?ee.f.RGBA.eb:ee.f.kb.y}else Y=null;return Y};var Dh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function l(A,O){for(var k="",M=0;M<4;M++)k+=String.fromCharCode(A[O++]);return k}function h(A,O){return A[O+0]|A[O+1]<<8}function d(A,O){return(A[O+0]|A[O+1]<<8|A[O+2]<<16)>>>0}function m(A,O){return(A[O+0]|A[O+1]<<8|A[O+2]<<16|A[O+3]<<24)>>>0}new u;var p=[0],y=[0],b=[],x=new u,E=n,T=(function(A,O){var k={},M=0,j=!1,X=0,ue=0;if(k.frames=[],!(function(W,J){for(var te=0;te<4;te++)if(W[J+te]!="RIFF".charCodeAt(te))return!0;return!1})(A,O)){for(m(A,O+=4),O+=8;O<A.length;){var ge=l(A,O),ce=m(A,O+=4);O+=4;var $=ce+(1&ce);switch(ge){case"VP8 ":case"VP8L":k.frames[M]===void 0&&(k.frames[M]={}),(Q=k.frames[M]).src_off=j?ue:O-8,Q.src_size=X+ce+8,M++,j&&(j=!1,X=0,ue=0);break;case"VP8X":(Q=k.header={}).feature_flags=A[O];var ae=O+4;Q.canvas_width=1+d(A,ae),ae+=3,Q.canvas_height=1+d(A,ae),ae+=3;break;case"ALPH":j=!0,X=$+8,ue=O-8;break;case"ANIM":(Q=k.header).bgcolor=m(A,O),ae=O+4,Q.loop_count=h(A,ae),ae+=2;break;case"ANMF":var fe,Q;(Q=k.frames[M]={}).offset_x=2*d(A,O),O+=3,Q.offset_y=2*d(A,O),O+=3,Q.width=1+d(A,O),O+=3,Q.height=1+d(A,O),O+=3,Q.duration=d(A,O),O+=3,fe=A[O++],Q.dispose=1&fe,Q.blend=fe>>1&1}ge!="ANMF"&&(O+=$)}return k}})(E,0);T.response=E,T.rgbaoutput=!0,T.dataurl=!1;var P=T.header?T.header:null,C=T.frames?T.frames:null;if(P){P.loop_counter=P.loop_count,p=[P.canvas_height],y=[P.canvas_width];for(var D=0;D<C.length&&C[D].blend!=0;D++);}var z=C[0],L=x.WebPDecodeRGBA(E,z.src_off,z.src_size,y,p);z.rgba=L,z.imgwidth=y[0],z.imgheight=p[0];for(var I=0;I<y[0]*p[0]*4;I++)b[I]=L[I];return this.width=y,this.height=p,this.data=b,this}(function(n){var e,t,r,i,o,s,a,u,l,h=function(W){return W=W||{},this.isStrokeTransparent=W.isStrokeTransparent||!1,this.strokeOpacity=W.strokeOpacity||1,this.strokeStyle=W.strokeStyle||"#000000",this.fillStyle=W.fillStyle||"#000000",this.isFillTransparent=W.isFillTransparent||!1,this.fillOpacity=W.fillOpacity||1,this.font=W.font||"10px sans-serif",this.textBaseline=W.textBaseline||"alphabetic",this.textAlign=W.textAlign||"left",this.lineWidth=W.lineWidth||1,this.lineJoin=W.lineJoin||"miter",this.lineCap=W.lineCap||"butt",this.path=W.path||[],this.transform=W.transform!==void 0?W.transform.clone():new u,this.globalCompositeOperation=W.globalCompositeOperation||"normal",this.globalAlpha=W.globalAlpha||1,this.clip_path=W.clip_path||[],this.currentPoint=W.currentPoint||new s,this.miterLimit=W.miterLimit||10,this.lastPoint=W.lastPoint||new s,this.lineDashOffset=W.lineDashOffset||0,this.lineDash=W.lineDash||[],this.margin=W.margin||[0,0,0,0],this.prevPageLastElemOffset=W.prevPageLastElemOffset||0,this.ignoreClearRect=typeof W.ignoreClearRect!="boolean"||W.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,a=this.internal.Rectangle,u=this.internal.Matrix,l=new h}]);var d=function(W){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var J=W;Object.defineProperty(this,"pdf",{get:function(){return J}});var te=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return te},set:function(re){te=!!re}});var de=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return de},set:function(re){de=!!re}});var ve=0;Object.defineProperty(this,"posX",{get:function(){return ve},set:function(re){isNaN(re)||(ve=re)}});var we=0;Object.defineProperty(this,"posY",{get:function(){return we},set:function(re){isNaN(re)||(we=re)}}),Object.defineProperty(this,"margin",{get:function(){return l.margin},set:function(re){var rt;typeof re=="number"?rt=[re,re,re,re]:((rt=new Array(4))[0]=re[0],rt[1]=re.length>=2?re[1]:rt[0],rt[2]=re.length>=3?re[2]:rt[0],rt[3]=re.length>=4?re[3]:rt[1]),l.margin=rt}});var Se=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Se},set:function(re){Se=re}});var Ie=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ie},set:function(re){Ie=re}});var Fe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Fe},set:function(re){Fe=re}}),Object.defineProperty(this,"ctx",{get:function(){return l},set:function(re){re instanceof h&&(l=re)}}),Object.defineProperty(this,"path",{get:function(){return l.path},set:function(re){l.path=re}});var Ae=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ae},set:function(re){Ae=re}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(re){var rt;rt=m(re),this.ctx.fillStyle=rt.style,this.ctx.isFillTransparent=rt.a===0,this.ctx.fillOpacity=rt.a,this.pdf.setFillColor(rt.r,rt.g,rt.b,{a:rt.a}),this.pdf.setTextColor(rt.r,rt.g,rt.b,{a:rt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(re){var rt=m(re);this.ctx.strokeStyle=rt.style,this.ctx.isStrokeTransparent=rt.a===0,this.ctx.strokeOpacity=rt.a,rt.a===0?this.pdf.setDrawColor(255,255,255):(rt.a,this.pdf.setDrawColor(rt.r,rt.g,rt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(re){["butt","round","square"].indexOf(re)!==-1&&(this.ctx.lineCap=re,this.pdf.setLineCap(re))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(re){isNaN(re)||(this.ctx.lineWidth=re,this.pdf.setLineWidth(re))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(re){["bevel","round","miter"].indexOf(re)!==-1&&(this.ctx.lineJoin=re,this.pdf.setLineJoin(re))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(re){isNaN(re)||(this.ctx.miterLimit=re,this.pdf.setMiterLimit(re))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(re){this.ctx.textBaseline=re}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(re){["right","end","center","left","start"].indexOf(re)!==-1&&(this.ctx.textAlign=re)}});var Be=null,Le=null,tt=null;Object.defineProperty(this,"fontFaces",{get:function(){return tt},set:function(re){Be=null,Le=null,tt=re}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(re){var rt;if(this.ctx.font=re,(rt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(re))!==null){var zt=rt[1];rt[2];var gt=rt[3],He=rt[4];rt[5];var ft=rt[6],lt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(He)[2];He=Math.floor(lt==="px"?parseFloat(He)*this.pdf.internal.scaleFactor:lt==="em"?parseFloat(He)*this.pdf.getFontSize():parseFloat(He)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(He);var Et=(function(yt){var dr,mn,rn=[],un=yt.trim();if(un==="")return b2;if(un in JA)return[JA[un]];for(;un!=="";){switch(mn=null,dr=(un=eC(un)).charAt(0)){case'"':case"'":mn=Zq(un.substring(1),dr);break;default:mn=eH(un)}if(mn===null||(rn.push(mn[0]),(un=eC(mn[1]))!==""&&un.charAt(0)!==","))return b2;un=un.replace(/^,/,"")}return rn})(ft);if(this.fontFaces){var pt=(function(yt,dr){var mn=yt.getFontList(),rn=JSON.stringify(mn);if(Be===null||Le!==rn){var un=(function(On){var Ot=[];return Object.keys(On).forEach(function(Bn){On[Bn].forEach(function(Ht){var Jt=null;switch(Ht){case"bold":Jt={family:Bn,weight:"bold"};break;case"italic":Jt={family:Bn,style:"italic"};break;case"bolditalic":Jt={family:Bn,weight:"bold",style:"italic"};break;case"":case"normal":Jt={family:Bn}}Jt!==null&&(Jt.ref={name:Bn,style:Ht},Ot.push(Jt))})}),Ot})(mn);Be=(function(On){for(var Ot={},Bn=0;Bn<On.length;++Bn){var Ht=w2(On[Bn]),Jt=Ht.family,jn=Ht.stretch,Dt=Ht.style,Gt=Ht.weight;Ot[Jt]=Ot[Jt]||{},Ot[Jt][jn]=Ot[Jt][jn]||{},Ot[Jt][jn][Dt]=Ot[Jt][jn][Dt]||{},Ot[Jt][jn][Dt][Gt]=Ht}return Ot})(un.concat(dr)),Le=rn}return Be})(this.pdf,this.fontFaces),En=Et.map(function(yt){return{family:yt,stretch:"normal",weight:gt,style:zt}}),$t=(function(yt,dr,mn){for(var rn=(mn=mn||{}).defaultFontFamily||"times",un=Object.assign({},Jq,mn.genericFontFamilies||{}),On=null,Ot=null,Bn=0;Bn<dr.length;++Bn)if(un[(On=w2(dr[Bn])).family]&&(On.family=un[On.family]),yt.hasOwnProperty(On.family)){Ot=yt[On.family];break}if(!(Ot=Ot||yt[rn]))throw new Error("Could not find a font-family for the rule '"+ZA(On)+"' and default family '"+rn+"'.");if(Ot=(function(Ht,Jt){if(Jt[Ht])return Jt[Ht];var jn=Pw[Ht],Dt=jn<=Pw.normal?-1:1,Gt=QA(Jt,PN,jn,Dt);if(!Gt)throw new Error("Could not find a matching font-stretch value for "+Ht);return Gt})(On.stretch,Ot),Ot=(function(Ht,Jt){if(Jt[Ht])return Jt[Ht];for(var jn=RN[Ht],Dt=0;Dt<jn.length;++Dt)if(Jt[jn[Dt]])return Jt[jn[Dt]];throw new Error("Could not find a matching font-style for "+Ht)})(On.style,Ot),!(Ot=(function(Ht,Jt){if(Jt[Ht])return Jt[Ht];if(Ht===400&&Jt[500])return Jt[500];if(Ht===500&&Jt[400])return Jt[400];var jn=Qq[Ht],Dt=QA(Jt,DN,jn,Ht<400?-1:1);if(!Dt)throw new Error("Could not find a matching font-weight for value "+Ht);return Dt})(On.weight,Ot)))throw new Error("Failed to resolve a font for the rule '"+ZA(On)+"'.");return Ot})(pt,En);this.pdf.setFont($t.ref.name,$t.ref.style)}else{var Qt="";(gt==="bold"||parseInt(gt,10)>=700||zt==="bold")&&(Qt="bold"),zt==="italic"&&(Qt+="italic"),Qt.length===0&&(Qt="normal");for(var an="",qt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},vt=0;vt<Et.length;vt++){if(this.pdf.internal.getFont(Et[vt],Qt,{noFallback:!0,disableWarning:!0})!==void 0){an=Et[vt];break}if(Qt==="bolditalic"&&this.pdf.internal.getFont(Et[vt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)an=Et[vt],Qt="bold";else if(this.pdf.internal.getFont(Et[vt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){an=Et[vt],Qt="normal";break}}if(an===""){for(var en=0;en<Et.length;en++)if(qt[Et[en]]){an=qt[Et[en]];break}}an=an===""?"Times":an,this.pdf.setFont(an,Qt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(re){this.ctx.globalCompositeOperation=re}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(re){this.ctx.globalAlpha=re}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(re){this.ctx.lineDashOffset=re,Q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(re){this.ctx.lineDash=re,Q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(re){this.ctx.ignoreClearRect=!!re}})};d.prototype.setLineDash=function(W){this.lineDash=W},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){C.call(this,"fill",!1)},d.prototype.stroke=function(){C.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(W,J){if(isNaN(W)||isNaN(J))throw _r.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var te=this.ctx.transform.applyToPoint(new s(W,J));this.path.push({type:"mt",x:te.x,y:te.y}),this.ctx.lastPoint=new s(W,J)},d.prototype.closePath=function(){var W=new s(0,0),J=0;for(J=this.path.length-1;J!==-1;J--)if(this.path[J].type==="begin"&&fr(this.path[J+1])==="object"&&typeof this.path[J+1].x=="number"){W=new s(this.path[J+1].x,this.path[J+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(W.x,W.y)},d.prototype.lineTo=function(W,J){if(isNaN(W)||isNaN(J))throw _r.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var te=this.ctx.transform.applyToPoint(new s(W,J));this.path.push({type:"lt",x:te.x,y:te.y}),this.ctx.lastPoint=new s(te.x,te.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),C.call(this,null,!0)},d.prototype.quadraticCurveTo=function(W,J,te,de){if(isNaN(te)||isNaN(de)||isNaN(W)||isNaN(J))throw _r.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ve=this.ctx.transform.applyToPoint(new s(te,de)),we=this.ctx.transform.applyToPoint(new s(W,J));this.path.push({type:"qct",x1:we.x,y1:we.y,x:ve.x,y:ve.y}),this.ctx.lastPoint=new s(ve.x,ve.y)},d.prototype.bezierCurveTo=function(W,J,te,de,ve,we){if(isNaN(ve)||isNaN(we)||isNaN(W)||isNaN(J)||isNaN(te)||isNaN(de))throw _r.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Se=this.ctx.transform.applyToPoint(new s(ve,we)),Ie=this.ctx.transform.applyToPoint(new s(W,J)),Fe=this.ctx.transform.applyToPoint(new s(te,de));this.path.push({type:"bct",x1:Ie.x,y1:Ie.y,x2:Fe.x,y2:Fe.y,x:Se.x,y:Se.y}),this.ctx.lastPoint=new s(Se.x,Se.y)},d.prototype.arc=function(W,J,te,de,ve,we){if(isNaN(W)||isNaN(J)||isNaN(te)||isNaN(de)||isNaN(ve))throw _r.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(we=!!we,!this.ctx.transform.isIdentity){var Se=this.ctx.transform.applyToPoint(new s(W,J));W=Se.x,J=Se.y;var Ie=this.ctx.transform.applyToPoint(new s(0,te)),Fe=this.ctx.transform.applyToPoint(new s(0,0));te=Math.sqrt(Math.pow(Ie.x-Fe.x,2)+Math.pow(Ie.y-Fe.y,2))}Math.abs(ve-de)>=2*Math.PI&&(de=0,ve=2*Math.PI),this.path.push({type:"arc",x:W,y:J,radius:te,startAngle:de,endAngle:ve,counterclockwise:we})},d.prototype.arcTo=function(W,J,te,de,ve){throw new Error("arcTo not implemented.")},d.prototype.rect=function(W,J,te,de){if(isNaN(W)||isNaN(J)||isNaN(te)||isNaN(de))throw _r.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(W,J),this.lineTo(W+te,J),this.lineTo(W+te,J+de),this.lineTo(W,J+de),this.lineTo(W,J),this.lineTo(W+te,J),this.lineTo(W,J)},d.prototype.fillRect=function(W,J,te,de){if(isNaN(W)||isNaN(J)||isNaN(te)||isNaN(de))throw _r.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var ve={};this.lineCap!=="butt"&&(ve.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ve.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(W,J,te,de),this.fill(),ve.hasOwnProperty("lineCap")&&(this.lineCap=ve.lineCap),ve.hasOwnProperty("lineJoin")&&(this.lineJoin=ve.lineJoin)}},d.prototype.strokeRect=function(W,J,te,de){if(isNaN(W)||isNaN(J)||isNaN(te)||isNaN(de))throw _r.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(W,J,te,de),this.stroke())},d.prototype.clearRect=function(W,J,te,de){if(isNaN(W)||isNaN(J)||isNaN(te)||isNaN(de))throw _r.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(W,J,te,de))},d.prototype.save=function(W){W=typeof W!="boolean"||W;for(var J=this.pdf.internal.getCurrentPageInfo().pageNumber,te=0;te<this.pdf.internal.getNumberOfPages();te++)this.pdf.setPage(te+1),this.pdf.internal.out("q");if(this.pdf.setPage(J),W){this.ctx.fontSize=this.pdf.internal.getFontSize();var de=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=de}},d.prototype.restore=function(W){W=typeof W!="boolean"||W;for(var J=this.pdf.internal.getCurrentPageInfo().pageNumber,te=0;te<this.pdf.internal.getNumberOfPages();te++)this.pdf.setPage(te+1),this.pdf.internal.out("Q");this.pdf.setPage(J),W&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(W){var J,te,de,ve;if(W.isCanvasGradient===!0&&(W=W.getColor()),!W)return{r:0,g:0,b:0,a:0,style:W};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(W))J=0,te=0,de=0,ve=0;else{var we=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(W);if(we!==null)J=parseInt(we[1]),te=parseInt(we[2]),de=parseInt(we[3]),ve=1;else if((we=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(W))!==null)J=parseInt(we[1]),te=parseInt(we[2]),de=parseInt(we[3]),ve=parseFloat(we[4]);else{if(ve=1,typeof W=="string"&&W.charAt(0)!=="#"){var Se=new SN(W);W=Se.ok?Se.toHex():"#000000"}W.length===4?(J=W.substring(1,2),J+=J,te=W.substring(2,3),te+=te,de=W.substring(3,4),de+=de):(J=W.substring(1,3),te=W.substring(3,5),de=W.substring(5,7)),J=parseInt(J,16),te=parseInt(te,16),de=parseInt(de,16)}}return{r:J,g:te,b:de,a:ve,style:W}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(W,J,te,de){if(isNaN(J)||isNaN(te)||typeof W!="string")throw _r.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(de=isNaN(de)?void 0:de,!p.call(this)){var ve=$(this.ctx.transform.rotation),we=this.ctx.transform.scaleX;M.call(this,{text:W,x:J,y:te,scale:we,angle:ve,align:this.textAlign,maxWidth:de})}},d.prototype.strokeText=function(W,J,te,de){if(isNaN(J)||isNaN(te)||typeof W!="string")throw _r.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){de=isNaN(de)?void 0:de;var ve=$(this.ctx.transform.rotation),we=this.ctx.transform.scaleX;M.call(this,{text:W,x:J,y:te,scale:we,renderingMode:"stroke",angle:ve,align:this.textAlign,maxWidth:de})}},d.prototype.measureText=function(W){if(typeof W!="string")throw _r.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var J=this.pdf,te=this.pdf.internal.scaleFactor,de=J.internal.getFontSize(),ve=J.getStringUnitWidth(W)*de/J.internal.scaleFactor;return new function(we){var Se=(we=we||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Se}}),this}({width:ve*=Math.round(96*te/72*1e4)/1e4})},d.prototype.scale=function(W,J){if(isNaN(W)||isNaN(J))throw _r.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var te=new u(W,0,0,J,0,0);this.ctx.transform=this.ctx.transform.multiply(te)},d.prototype.rotate=function(W){if(isNaN(W))throw _r.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var J=new u(Math.cos(W),Math.sin(W),-Math.sin(W),Math.cos(W),0,0);this.ctx.transform=this.ctx.transform.multiply(J)},d.prototype.translate=function(W,J){if(isNaN(W)||isNaN(J))throw _r.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var te=new u(1,0,0,1,W,J);this.ctx.transform=this.ctx.transform.multiply(te)},d.prototype.transform=function(W,J,te,de,ve,we){if(isNaN(W)||isNaN(J)||isNaN(te)||isNaN(de)||isNaN(ve)||isNaN(we))throw _r.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Se=new u(W,J,te,de,ve,we);this.ctx.transform=this.ctx.transform.multiply(Se)},d.prototype.setTransform=function(W,J,te,de,ve,we){W=isNaN(W)?1:W,J=isNaN(J)?0:J,te=isNaN(te)?0:te,de=isNaN(de)?1:de,ve=isNaN(ve)?0:ve,we=isNaN(we)?0:we,this.ctx.transform=new u(W,J,te,de,ve,we)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(W,J,te,de,ve,we,Se,Ie,Fe){var Ae=this.pdf.getImageProperties(W),Be=1,Le=1,tt=1,re=1;de!==void 0&&Ie!==void 0&&(tt=Ie/de,re=Fe/ve,Be=Ae.width/de*Ie/de,Le=Ae.height/ve*Fe/ve),we===void 0&&(we=J,Se=te,J=0,te=0),de!==void 0&&Ie===void 0&&(Ie=de,Fe=ve),de===void 0&&Ie===void 0&&(Ie=Ae.width,Fe=Ae.height);var rt=this.ctx.transform.decompose(),zt=$(rt.rotate.shx),gt=new u,He=(gt=(gt=(gt=gt.multiply(rt.translate)).multiply(rt.skew)).multiply(rt.scale)).applyToRectangle(new a(we-J*tt,Se-te*re,de*Be,ve*Le));if(this.autoPaging){for(var ft,lt=x.call(this,He),Et=[],pt=0;pt<lt.length;pt+=1)Et.indexOf(lt[pt])===-1&&Et.push(lt[pt]);P(Et);for(var En=Et[0],$t=Et[Et.length-1],Qt=En;Qt<$t+1;Qt++){this.pdf.setPage(Qt);var an=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],qt=Qt===1?this.posY+this.margin[0]:this.margin[0],vt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],en=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],yt=Qt===1?0:vt+(Qt-2)*en;if(this.ctx.clip_path.length!==0){var dr=this.path;ft=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(ft,this.posX+this.margin[3],-yt+qt+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=dr}var mn=JSON.parse(JSON.stringify(He));mn=T([mn],this.posX+this.margin[3],-yt+qt+this.ctx.prevPageLastElemOffset)[0];var rn=(Qt>En||Qt<$t)&&b.call(this);rn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],an,en,null).clip().discardPath()),this.pdf.addImage(W,"JPEG",mn.x,mn.y,mn.w,mn.h,null,null,zt),rn&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(W,"JPEG",He.x,He.y,He.w,He.h,null,null,zt)};var x=function(W,J,te){var de=[];J=J||this.pdf.internal.pageSize.width,te=te||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ve=this.posY+this.ctx.prevPageLastElemOffset;switch(W.type){default:case"mt":case"lt":de.push(Math.floor((W.y+ve)/te)+1);break;case"arc":de.push(Math.floor((W.y+ve-W.radius)/te)+1),de.push(Math.floor((W.y+ve+W.radius)/te)+1);break;case"qct":var we=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,W.x1,W.y1,W.x,W.y);de.push(Math.floor((we.y+ve)/te)+1),de.push(Math.floor((we.y+we.h+ve)/te)+1);break;case"bct":var Se=fe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,W.x1,W.y1,W.x2,W.y2,W.x,W.y);de.push(Math.floor((Se.y+ve)/te)+1),de.push(Math.floor((Se.y+Se.h+ve)/te)+1);break;case"rect":de.push(Math.floor((W.y+ve)/te)+1),de.push(Math.floor((W.y+W.h+ve)/te)+1)}for(var Ie=0;Ie<de.length;Ie+=1)for(;this.pdf.internal.getNumberOfPages()<de[Ie];)E.call(this);return de},E=function(){var W=this.fillStyle,J=this.strokeStyle,te=this.font,de=this.lineCap,ve=this.lineWidth,we=this.lineJoin;this.pdf.addPage(),this.fillStyle=W,this.strokeStyle=J,this.font=te,this.lineCap=de,this.lineWidth=ve,this.lineJoin=we},T=function(W,J,te){for(var de=0;de<W.length;de++)switch(W[de].type){case"bct":W[de].x2+=J,W[de].y2+=te;case"qct":W[de].x1+=J,W[de].y1+=te;default:W[de].x+=J,W[de].y+=te}return W},P=function(W){return W.sort(function(J,te){return J-te})},C=function(W,J){var te=this.fillStyle,de=this.strokeStyle,ve=this.lineCap,we=this.lineWidth,Se=Math.abs(we*this.ctx.transform.scaleX),Ie=this.lineJoin;if(this.autoPaging){for(var Fe,Ae,Be=JSON.parse(JSON.stringify(this.path)),Le=JSON.parse(JSON.stringify(this.path)),tt=[],re=0;re<Le.length;re++)if(Le[re].x!==void 0)for(var rt=x.call(this,Le[re]),zt=0;zt<rt.length;zt+=1)tt.indexOf(rt[zt])===-1&&tt.push(rt[zt]);for(var gt=0;gt<tt.length;gt++)for(;this.pdf.internal.getNumberOfPages()<tt[gt];)E.call(this);P(tt);for(var He=tt[0],ft=tt[tt.length-1],lt=He;lt<ft+1;lt++){this.pdf.setPage(lt),this.fillStyle=te,this.strokeStyle=de,this.lineCap=ve,this.lineWidth=Se,this.lineJoin=Ie;var Et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],pt=lt===1?this.posY+this.margin[0]:this.margin[0],En=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Qt=lt===1?0:En+(lt-2)*$t;if(this.ctx.clip_path.length!==0){var an=this.path;Fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(Fe,this.posX+this.margin[3],-Qt+pt+this.ctx.prevPageLastElemOffset),D.call(this,W,!0),this.path=an}if(Ae=JSON.parse(JSON.stringify(Be)),this.path=T(Ae,this.posX+this.margin[3],-Qt+pt+this.ctx.prevPageLastElemOffset),J===!1||lt===0){var qt=(lt>He||lt<ft)&&b.call(this);qt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,$t,null).clip().discardPath()),D.call(this,W,J),qt&&this.pdf.restoreGraphicsState()}this.lineWidth=we}this.path=Be}else this.lineWidth=Se,D.call(this,W,J),this.lineWidth=we},D=function(W,J){if((W!=="stroke"||J||!y.call(this))&&(W==="stroke"||J||!p.call(this))){for(var te,de,ve=[],we=this.path,Se=0;Se<we.length;Se++){var Ie=we[Se];switch(Ie.type){case"begin":ve.push({begin:!0});break;case"close":ve.push({close:!0});break;case"mt":ve.push({start:Ie,deltas:[],abs:[]});break;case"lt":var Fe=ve.length;if(we[Se-1]&&!isNaN(we[Se-1].x)&&(te=[Ie.x-we[Se-1].x,Ie.y-we[Se-1].y],Fe>0)){for(;Fe>=0;Fe--)if(ve[Fe-1].close!==!0&&ve[Fe-1].begin!==!0){ve[Fe-1].deltas.push(te),ve[Fe-1].abs.push(Ie);break}}break;case"bct":te=[Ie.x1-we[Se-1].x,Ie.y1-we[Se-1].y,Ie.x2-we[Se-1].x,Ie.y2-we[Se-1].y,Ie.x-we[Se-1].x,Ie.y-we[Se-1].y],ve[ve.length-1].deltas.push(te);break;case"qct":var Ae=we[Se-1].x+2/3*(Ie.x1-we[Se-1].x),Be=we[Se-1].y+2/3*(Ie.y1-we[Se-1].y),Le=Ie.x+2/3*(Ie.x1-Ie.x),tt=Ie.y+2/3*(Ie.y1-Ie.y),re=Ie.x,rt=Ie.y;te=[Ae-we[Se-1].x,Be-we[Se-1].y,Le-we[Se-1].x,tt-we[Se-1].y,re-we[Se-1].x,rt-we[Se-1].y],ve[ve.length-1].deltas.push(te);break;case"arc":ve.push({deltas:[],abs:[],arc:!0}),Array.isArray(ve[ve.length-1].abs)&&ve[ve.length-1].abs.push(Ie)}}de=J?null:W==="stroke"?"stroke":"fill";for(var zt=!1,gt=0;gt<ve.length;gt++)if(ve[gt].arc)for(var He=ve[gt].abs,ft=0;ft<He.length;ft++){var lt=He[ft];lt.type==="arc"?I.call(this,lt.x,lt.y,lt.radius,lt.startAngle,lt.endAngle,lt.counterclockwise,void 0,J,!zt):j.call(this,lt.x,lt.y),zt=!0}else if(ve[gt].close===!0)this.pdf.internal.out("h"),zt=!1;else if(ve[gt].begin!==!0){var Et=ve[gt].start.x,pt=ve[gt].start.y;X.call(this,ve[gt].deltas,Et,pt),zt=!0}de&&A.call(this,de),J&&O.call(this)}},z=function(W){var J=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,te=J*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return W-te;case"top":return W+J-te;case"hanging":return W+J-2*te;case"middle":return W+J/2-te;default:return W}},L=function(W){return W+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var W=function(){};return W.colorStops=[],W.addColorStop=function(J,te){this.colorStops.push([J,te])},W.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},W.isCanvasGradient=!0,W},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var I=function(W,J,te,de,ve,we,Se,Ie,Fe){for(var Ae=ge.call(this,te,de,ve,we),Be=0;Be<Ae.length;Be++){var Le=Ae[Be];Be===0&&(Fe?k.call(this,Le.x1+W,Le.y1+J):j.call(this,Le.x1+W,Le.y1+J)),ue.call(this,W,J,Le.x2,Le.y2,Le.x3,Le.y3,Le.x4,Le.y4)}Ie?O.call(this):A.call(this,Se)},A=function(W){switch(W){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},O=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(W,J){this.pdf.internal.out(t(W)+" "+r(J)+" m")},M=function(W){var J;switch(W.align){case"right":case"end":J="right";break;case"center":J="center";break;default:J="left"}var te,de,ve,we=this.pdf.getTextDimensions(W.text),Se=z.call(this,W.y),Ie=L.call(this,Se)-we.h,Fe=this.ctx.transform.applyToPoint(new s(W.x,Se));if(this.autoPaging){var Ae=this.ctx.transform.decompose(),Be=new u;Be=(Be=(Be=Be.multiply(Ae.translate)).multiply(Ae.skew)).multiply(Ae.scale);for(var Le=this.ctx.transform.applyToRectangle(new a(W.x,Se,we.w,we.h)),tt=Be.applyToRectangle(new a(W.x,Ie,we.w,we.h)),re=x.call(this,tt),rt=[],zt=0;zt<re.length;zt+=1)rt.indexOf(re[zt])===-1&&rt.push(re[zt]);P(rt);for(var gt=rt[0],He=rt[rt.length-1],ft=gt;ft<He+1;ft++){this.pdf.setPage(ft);var lt=ft===1?this.posY+this.margin[0]:this.margin[0],Et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],pt=this.pdf.internal.pageSize.height-this.margin[2],En=pt-this.margin[0],$t=this.pdf.internal.pageSize.width-this.margin[1],Qt=$t-this.margin[3],an=ft===1?0:Et+(ft-2)*En;if(this.ctx.clip_path.length!==0){var qt=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(te,this.posX+this.margin[3],-1*an+lt),D.call(this,"fill",!0),this.path=qt}var vt=T([JSON.parse(JSON.stringify(tt))],this.posX+this.margin[3],-an+lt+this.ctx.prevPageLastElemOffset)[0];W.scale>=.01&&(de=this.pdf.internal.getFontSize(),this.pdf.setFontSize(de*W.scale),ve=this.lineWidth,this.lineWidth=ve*W.scale);var en=this.autoPaging!=="text";if(en||vt.y+vt.h<=pt){if(en||vt.y>=lt&&vt.x<=$t){var yt=en?W.text:this.pdf.splitTextToSize(W.text,W.maxWidth||$t-vt.x)[0],dr=T([JSON.parse(JSON.stringify(Le))],this.posX+this.margin[3],-an+lt+this.ctx.prevPageLastElemOffset)[0],mn=en&&(ft>gt||ft<He)&&b.call(this);mn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Qt,En,null).clip().discardPath()),this.pdf.text(yt,dr.x,dr.y,{angle:W.angle,align:J,renderingMode:W.renderingMode}),mn&&this.pdf.restoreGraphicsState()}}else vt.y<pt&&(this.ctx.prevPageLastElemOffset+=pt-vt.y);W.scale>=.01&&(this.pdf.setFontSize(de),this.lineWidth=ve)}}else W.scale>=.01&&(de=this.pdf.internal.getFontSize(),this.pdf.setFontSize(de*W.scale),ve=this.lineWidth,this.lineWidth=ve*W.scale),this.pdf.text(W.text,Fe.x+this.posX,Fe.y+this.posY,{angle:W.angle,align:J,renderingMode:W.renderingMode,maxWidth:W.maxWidth}),W.scale>=.01&&(this.pdf.setFontSize(de),this.lineWidth=ve)},j=function(W,J,te,de){te=te||0,de=de||0,this.pdf.internal.out(t(W+te)+" "+r(J+de)+" l")},X=function(W,J,te){return this.pdf.lines(W,J,te,null,null)},ue=function(W,J,te,de,ve,we,Se,Ie){this.pdf.internal.out([e(i(te+W)),e(o(de+J)),e(i(ve+W)),e(o(we+J)),e(i(Se+W)),e(o(Ie+J)),"c"].join(" "))},ge=function(W,J,te,de){for(var ve=2*Math.PI,we=Math.PI/2;J>te;)J-=ve;var Se=Math.abs(te-J);Se<ve&&de&&(Se=ve-Se);for(var Ie=[],Fe=de?-1:1,Ae=J;Se>1e-5;){var Be=Ae+Fe*Math.min(Se,we);Ie.push(ce.call(this,W,Ae,Be)),Se-=Math.abs(Be-Ae),Ae=Be}return Ie},ce=function(W,J,te){var de=(te-J)/2,ve=W*Math.cos(de),we=W*Math.sin(de),Se=ve,Ie=-we,Fe=Se*Se+Ie*Ie,Ae=Fe+Se*ve+Ie*we,Be=4/3*(Math.sqrt(2*Fe*Ae)-Ae)/(Se*we-Ie*ve),Le=Se-Be*Ie,tt=Ie+Be*Se,re=Le,rt=-tt,zt=de+J,gt=Math.cos(zt),He=Math.sin(zt);return{x1:W*Math.cos(J),y1:W*Math.sin(J),x2:Le*gt-tt*He,y2:Le*He+tt*gt,x3:re*gt-rt*He,y3:re*He+rt*gt,x4:W*Math.cos(te),y4:W*Math.sin(te)}},$=function(W){return 180*W/Math.PI},ae=function(W,J,te,de,ve,we){var Se=W+.5*(te-W),Ie=J+.5*(de-J),Fe=ve+.5*(te-ve),Ae=we+.5*(de-we),Be=Math.min(W,ve,Se,Fe),Le=Math.max(W,ve,Se,Fe),tt=Math.min(J,we,Ie,Ae),re=Math.max(J,we,Ie,Ae);return new a(Be,tt,Le-Be,re-tt)},fe=function(W,J,te,de,ve,we,Se,Ie){var Fe,Ae,Be,Le,tt,re,rt,zt,gt,He,ft,lt,Et,pt,En=te-W,$t=de-J,Qt=ve-te,an=we-de,qt=Se-ve,vt=Ie-we;for(Ae=0;Ae<41;Ae++)gt=(rt=(Be=W+(Fe=Ae/40)*En)+Fe*((tt=te+Fe*Qt)-Be))+Fe*(tt+Fe*(ve+Fe*qt-tt)-rt),He=(zt=(Le=J+Fe*$t)+Fe*((re=de+Fe*an)-Le))+Fe*(re+Fe*(we+Fe*vt-re)-zt),Ae==0?(ft=gt,lt=He,Et=gt,pt=He):(ft=Math.min(ft,gt),lt=Math.min(lt,He),Et=Math.max(Et,gt),pt=Math.max(pt,He));return new a(Math.round(ft),Math.round(lt),Math.round(Et-ft),Math.round(pt-lt))},Q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var W,J,te=(W=this.ctx.lineDash,J=this.ctx.lineDashOffset,JSON.stringify({lineDash:W,lineDashOffset:J}));this.prevLineDash!==te&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=te)}}})(Wt.API),(function(n){var e=function(s){var a,u,l,h,d,m,p,y,b,x;for(u=[],l=0,h=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;h>l;l+=4)(d=(s.charCodeAt(l)<<24)+(s.charCodeAt(l+1)<<16)+(s.charCodeAt(l+2)<<8)+s.charCodeAt(l+3))!==0?(m=(d=((d=((d=((d=(d-(x=d%85))/85)-(b=d%85))/85)-(y=d%85))/85)-(p=d%85))/85)%85,u.push(m+33,p+33,y+33,b+33,x+33)):u.push(122);return(function(E,T){for(var P=T;P>0;P--)E.pop()})(u,a.length),String.fromCharCode.apply(String,u)+"~>"},t=function(s){var a,u,l,h,d,m=String,p="length",y=255,b="charCodeAt",x="slice",E="replace";for(s[x](-2),s=s[x](0,-2)[E](/\s/g,"")[E]("z","!!!!!"),l=[],h=0,d=(s+=a="uuuuu"[x](s[p]%5||5))[p];d>h;h+=5)u=52200625*(s[b](h)-33)+614125*(s[b](h+1)-33)+7225*(s[b](h+2)-33)+85*(s[b](h+3)-33)+(s[b](h+4)-33),l.push(y&u>>24,y&u>>16,y&u>>8,y&u);return(function(T,P){for(var C=P;C>0;C--)T.pop()})(l,a[p]),m.fromCharCode.apply(m,l)},r=function(s){return s.split("").map(function(a){return("0"+a.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var u="",l=0;l<s.length;l+=2)u+=String.fromCharCode("0x"+(s[l]+s[l+1]));return u},o=function(s){for(var a=new Uint8Array(s.length),u=s.length;u--;)a[u]=s.charCodeAt(u);return(a=Aw(a)).reduce(function(l,h){return l+String.fromCharCode(h)},"")};n.processDataByFilters=function(s,a){var u=0,l=s||"",h=[];for(typeof(a=a||[])=="string"&&(a=[a]),u=0;u<a.length;u+=1)switch(a[u]){case"ASCII85Decode":case"/ASCII85Decode":l=t(l),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=i(l),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=r(l),h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=o(l),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[u]+'" is not implemented')}return{data:l,reverseChain:h.reverse().join(" ")}}})(Wt.API),(function(n){n.loadFile=function(e,t,r){return(function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var a=void 0;try{a=(function(u,l,h){var d=new XMLHttpRequest,m=0,p=function(y){var b=y.length,x=[],E=String.fromCharCode;for(m=0;m<b;m+=1)x.push(E(255&y.charCodeAt(m)));return x.join("")};if(d.open("GET",u,!l),d.overrideMimeType("text/plain; charset=x-user-defined"),l===!1&&(d.onload=function(){d.status===200?h(p(this.responseText)):h(void 0)}),d.send(null),l&&d.status===200)return p(d.responseText)})(i,o,s)}catch{}return a})(e,t,r)},n.loadImageFile=n.loadFile})(Wt.API),(function(n){function e(){return(pn.html2canvas?Promise.resolve(pn.html2canvas):t2(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function t(){return(pn.DOMPurify?Promise.resolve(pn.DOMPurify):t2(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var r=function(a){var u=fr(a);return u==="undefined"?"undefined":u==="string"||a instanceof String?"string":u==="number"||a instanceof Number?"number":u==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":u==="object"?"object":"unknown"},i=function(a,u){var l=document.createElement(a);for(var h in u.className&&(l.className=u.className),u.innerHTML&&u.dompurify&&(l.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)l.style[h]=u.style[h];return l},o=function a(u,l){for(var h=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),d=u.firstChild;d;d=d.nextSibling)l!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||h.appendChild(a(d,l));return u.nodeType===1&&(u.nodeName==="CANVAS"?(h.width=u.width,h.height=u.height,h.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(h.value=u.value),h.addEventListener("load",function(){h.scrollTop=u.scrollTop,h.scrollLeft=u.scrollLeft},!0)),h},s=function a(u){var l=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),h=a.convert(Promise.resolve(),l);return(h=h.setProgress(1,a,1,[a])).set(u)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,u){return a.__proto__=u||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,u){return this.then(function(){switch(u=u||(function(l){switch(r(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(a),u){case"string":return this.then(t).then(function(l){return this.set({src:i("div",{innerHTML:a,dompurify:l})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=o(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(u){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,u(this.prop.container,l)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(u){var l=this.opt.jsPDF,h=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=h,h)for(var p=0;p<h.length;++p){var y=h[p],b=y.src.find(function(x){return x.format==="truetype"});b&&l.addFont(b.url,y.ref.name,y.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,l.context2d.save(!0),u(this.prop.container,m)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,u,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(a,u):this.outputPdf(a,u)},s.prototype.outputPdf=function(a,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,u)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(r(a)!=="object")return this;var u=Object.keys(a||{}).map(function(l){if(l in s.template.prop)return function(){this.prop[l]=a[l]};switch(l){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[l]=a[l]}}},this);return this.then(function(){return this.thenList(u)})},s.prototype.get=function(a,u){return this.then(function(){var l=a in s.template.prop?this.prop[a]:this.opt[a];return u?u(l):l})},s.prototype.setMargin=function(a){return this.then(function(){switch(r(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function u(l,h){return Math.floor(l*h/72*96)}return this.then(function(){(a=a||Wt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:u(a.inner.width,a.k),height:u(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,u,l,h){return a!=null&&(this.progress.val=a),u!=null&&(this.progress.state=u),l!=null&&(this.progress.n=l),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,u,l,h){return this.setProgress(a?this.progress.val+a:null,u||null,l?this.progress.n+l:null,h?this.progress.stack.concat(h):null)},s.prototype.then=function(a,u){var l=this;return this.thenCore(a,u,function(h,d){return l.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(m){return l.updateProgress(null,h),m}).then(h,d).then(function(m){return l.updateProgress(1),m})})},s.prototype.thenCore=function(a,u,l){l=l||Promise.prototype.then;var h=this;a&&(a=a.bind(h)),u&&(u=u.bind(h));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?h:s.convert(Object.assign({},h),Promise.prototype),m=l.call(d,a,u);return s.convert(m,h.__proto__)},s.prototype.thenExternal=function(a,u){return Promise.prototype.then.call(this,a,u)},s.prototype.thenList=function(a){var u=this;return a.forEach(function(l){u=u.thenCore(l)}),u},s.prototype.catch=function(a){a&&(a=a.bind(this));var u=Promise.prototype.catch.call(this,a);return s.convert(u,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Wt.getPageSize=function(a,u,l){if(fr(a)==="object"){var h=a;a=h.orientation,u=h.unit||u,l=h.format||l}u=u||"mm",l=l||"a4",a=(""+(a||"P")).toLowerCase();var d,m=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+u}var y,b=0,x=0;if(p.hasOwnProperty(m))b=p[m][1]/d,x=p[m][0]/d;else try{b=l[1],x=l[0]}catch{throw new Error("Invalid format: "+l)}if(a==="p"||a==="portrait")a="p",x>b&&(y=x,x=b,b=y);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",b>x&&(y=x,x=b,b=y)}return{width:x,height:b,unit:u,k:d,orientation:a}},n.html=function(a,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(w2):null;var l=new s(u);return u.worker?l:l.from(a).doCallback()}})(Wt.API),Wt.API.addJS=function(n){return nC=n,this.internal.events.subscribe("postPutResources",function(){mv=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(mv+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),tC=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+nC+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){mv!==void 0&&tC!==void 0&&this.internal.out("/Names <</JavaScript "+mv+" 0 R>>")}),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=t.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],a=r.exec(s);if(a!=null){var u=a[1];t.internal.newObjectDeferredBegin(u,!1)}t.internal.write(s)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,h=[];for(o=0;o<l;o++){var d=t.internal.newObject();h.push(d);var m=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<h.length;o++)t.internal.write("(page_"+(o+1)+")"+h[o]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,i,o){var s={title:i,options:o,children:[]};return r==null&&(r=this.root),r.children.push(s),s},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<r.children.length;o++){var s=r.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(r)),o>0&&this.line("/Prev "+this.makeRef(r.children[o-1])),o<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var a=this.count=this.count_r({count:0},s);if(a>0&&this.line("/Count "+a),s.options&&s.options.pageNumber){var u=t.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var l=0;l<r.children.length;l++)this.renderItems(r.children[l])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,i){for(var o=0;o<i.children.length;o++)r.count++,this.count_r(r,i.children[o]);return r.count}}])})(Wt.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,r,i,o,s,a){var u,l=this.decode.DCT_DECODE,h=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=s||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,u=(function(d){for(var m,p=256*d.charCodeAt(4)+d.charCodeAt(5),y=d.length,b={width:0,height:0,numcomponents:1},x=4;x<y;x+=2){if(x+=p,e.indexOf(d.charCodeAt(x+1))!==-1){m=256*d.charCodeAt(x+5)+d.charCodeAt(x+6),b={width:256*d.charCodeAt(x+7)+d.charCodeAt(x+8),height:m,numcomponents:d.charCodeAt(x+9)};break}p=256*d.charCodeAt(x+2)+d.charCodeAt(x+3)}return b})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),u.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}h={data:t,width:u.width,height:u.height,colorSpace:a,bitsPerComponent:8,filter:l,index:r,alias:i}}return h}})(Wt.API),Wt.API.processPNG=function(n,e,t,r){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var i,o=Fq(n,{checkCrc:!0}),s=o.width,a=o.height,u=o.channels,l=o.palette,h=o.depth;i=l&&u===1?(function(I){for(var A=I.width,O=I.height,k=I.data,M=I.palette,j=I.depth,X=!1,ue=[],ge=[],ce=void 0,$=!1,ae=0,fe=0;fe<M.length;fe++){var Q=sA(M[fe],4),W=Q[0],J=Q[1],te=Q[2],de=Q[3];ue.push(W,J,te),de!=null&&(de===0?(ae++,ge.length<1&&ge.push(fe)):de<255&&($=!0))}if($||ae>1){X=!0,ge=void 0;var ve=A*O;ce=new Uint8Array(ve);for(var we=new DataView(k.buffer),Se=0;Se<ve;Se++){var Ie=x2(we,Se,j),Fe=sA(M[Ie],4)[3];ce[Se]=Fe}}else ae===0&&(ge=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:X?8:void 0,colorBytes:k,alphaBytes:ce,needSMask:X,palette:ue,mask:ge}})(o):u===2||u===4?(function(I){for(var A=I.data,O=I.width,k=I.height,M=I.channels,j=I.depth,X=M===2?"DeviceGray":"DeviceRGB",ue=M-1,ge=O*k,ce=ue,$=ge*ce,ae=1*ge,fe=Math.ceil($*j/8),Q=Math.ceil(ae*j/8),W=new Uint8Array(fe),J=new Uint8Array(Q),te=new DataView(A.buffer),de=new DataView(W.buffer),ve=new DataView(J.buffer),we=!1,Se=0;Se<ge;Se++){for(var Ie=Se*M,Fe=0;Fe<ce;Fe++)hC(de,x2(te,Ie+Fe,j),Se*ce+Fe,j);var Ae=x2(te,Ie+ce,j);Ae<(1<<j)-1&&(we=!0),hC(ve,Ae,1*Se,j)}return{colorSpace:X,colorsPerPixel:ue,sMaskBitsPerComponent:we?j:void 0,colorBytes:W,alphaBytes:J,needSMask:we}})(o):(function(I){var A=I.data,O=I.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:O,colorsPerPixel:O==="DeviceGray"?1:3,colorBytes:A instanceof Uint16Array?(function(k){for(var M=k.length,j=new Uint8Array(2*M),X=new DataView(j.buffer,j.byteOffset,j.byteLength),ue=0;ue<M;ue++)X.setUint16(2*ue,k[ue],!1);return j})(A):A,needSMask:!1}})(o);var d,m,p,y=i,b=y.colorSpace,x=y.colorsPerPixel,E=y.sMaskBitsPerComponent,T=y.colorBytes,P=y.alphaBytes,C=y.needSMask,D=y.palette,z=y.mask,L=null;return r!==Wt.API.image_compression.NONE&&typeof Aw=="function"?(L=(function(I){var A;switch(I){case Wt.API.image_compression.FAST:A=11;break;case Wt.API.image_compression.MEDIUM:A=13;break;case Wt.API.image_compression.SLOW:A=14;break;default:A=12}return A})(r),d=this.decode.FLATE_DECODE,m="/Predictor ".concat(L," /Colors ").concat(x," /BitsPerComponent ").concat(h," /Columns ").concat(s),n=sC(T,Math.ceil(s*x*h/8),x,h,r),C&&(p=sC(P,Math.ceil(s*E/8),1,E,r))):(d=void 0,m=void 0,n=T,C&&(p=P)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:t,data:n,index:e,filter:d,decodeParameters:m,transparency:z,palette:D,sMask:p,predictor:L,width:s,height:a,bitsPerComponent:h,sMaskBitsPerComponent:E,colorSpace:b}}},(function(n){n.processGIF89A=function(e,t,r,i){var o=new iH(e),s=o.width,a=o.height,u=[];o.decodeAndBlitFrameRGBA(0,u);var l={data:u,width:s,height:a},h=new _2(100).encode(l,100);return n.processJPEG.call(this,h,t,r,i)},n.processGIF87A=n.processGIF89A})(Wt.API),pu.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},pu.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){_r.log("bit decode error:"+t)}},pu.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+8*i*4,a=0;a<8&&8*i+a<this.width;a++){var u=this.palette[o>>7-a&1];this.data[s+4*a]=u.blue,this.data[s+4*a+1]=u.green,this.data[s+4*a+2]=u.red,this.data[s+4*a+3]=255}t!==0&&(this.pos+=4-t)}},pu.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<n;i++){var o=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+2*i*4,a=o>>4,u=15&o,l=this.palette[a];if(this.data[s]=l.blue,this.data[s+1]=l.green,this.data[s+2]=l.red,this.data[s+3]=255,2*i+1>=this.width)break;l=this.palette[u],this.data[s+4]=l.blue,this.data[s+4+1]=l.green,this.data[s+4+2]=l.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},pu.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}n!==0&&(this.pos+=4-n)}},pu.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,a=(o>>5&e)/e*255|0,u=(o>>10&e)/e*255|0,l=o>>15?255:0,h=r*this.width*4+4*i;this.data[h]=u,this.data[h+1]=a,this.data[h+2]=s,this.data[h+3]=l}this.pos+=n}},pu.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,u=(s>>5&t)/t*255|0,l=(s>>11)/e*255|0,h=i*this.width*4+4*o;this.data[h]=l,this.data[h+1]=u,this.data[h+2]=a,this.data[h+3]=255}this.pos+=n}},pu.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*t;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=r,this.data[s+3]=255}this.pos+=this.width%4}},pu.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=o,this.data[a+1]=i,this.data[a+2]=r,this.data[a+3]=s}},pu.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,r,i){var o=new pu(e,!1),s=o.width,a=o.height,u={data:o.getData(),width:s,height:a},l=new _2(100).encode(u,100);return n.processJPEG.call(this,l,t,r,i)}})(Wt.API),dC.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,r,i){var o=new dC(e),s=o.width,a=o.height,u={data:o.getData(),width:s,height:a},l=new _2(100).encode(u,100);return n.processJPEG.call(this,l,t,r,i)}})(Wt.API),Wt.API.processRGBA=function(n,e,t){for(var r=n.data,i=r.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),a=0,u=0,l=0;l<i;l+=4){var h=r[l],d=r[l+1],m=r[l+2],p=r[l+3];o[a++]=h,o[a++]=d,o[a++]=m,s[u++]=p}var y=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:y,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},Wt.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},td=Wt.API,gv=td.getCharWidthsArray=function(n,e){var t,r,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:i.metadata.Unicode.widths,u=a.fof?a.fof:1,l=e.kerning?e.kerning:i.metadata.Unicode.kerning,h=l.fof?l.fof:1,d=e.doKerning!==!1,m=0,p=n.length,y=0,b=a[0]||u,x=[];for(t=0;t<p;t++)r=n.charCodeAt(t),typeof i.metadata.widthOfString=="function"?x.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+s*(1e3/o)||0)/1e3):(m=d&&fr(l[r])==="object"&&!isNaN(parseInt(l[r][y],10))?l[r][y]/h:0,x.push((a[r]||b)/u+m)),y=r;return x},rC=td.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return td.processArabic&&(n=td.processArabic(n)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(n,t,i)/t:gv.apply(this,arguments).reduce(function(o,s){return o+s},0)},iC=function(n,e,t,r){for(var i=[],o=0,s=n.length,a=0;o!==s&&a+e[o]<t;)a+=e[o],o++;i.push(n.slice(0,o));var u=o;for(a=0;o!==s;)a+e[o]>r&&(i.push(n.slice(u,o)),a=0,u=o),a+=e[o],o++;return u!==o&&i.push(n.slice(u,o)),i},oC=function(n,e,t){t||(t={});var r,i,o,s,a,u,l,h=[],d=[h],m=t.textIndent||0,p=0,y=0,b=n.split(" "),x=gv.apply(this,[" ",t])[0];if(u=t.lineIndent===-1?b[0].length+2:t.lineIndent||0){var E=Array(u).join(" "),T=[];b.map(function(C){(C=C.split(/\s*\n/)).length>1?T=T.concat(C.map(function(D,z){return(z&&D.length?`
`:"")+D})):T.push(C[0])}),b=T,u=rC.apply(this,[E,t])}for(o=0,s=b.length;o<s;o++){var P=0;if(r=b[o],u&&r[0]==`
`&&(r=r.substr(1),P=1),m+p+(y=(i=gv.apply(this,[r,t])).reduce(function(C,D){return C+D},0))>e||P){if(y>e){for(a=iC.apply(this,[r,i,e-(m+p),e]),h.push(a.shift()),h=[a.pop()];a.length;)d.push([a.shift()]);y=i.slice(r.length-(h[0]?h[0].length:0)).reduce(function(C,D){return C+D},0)}else h=[r];d.push(h),m=y+u,p=x}else h.push(r),m+=p+y,p=x}return l=u?function(C,D){return(D?E:"")+C.join(" ")}:function(C){return C.join(" ")},d.map(l)},td.splitTextToSize=function(n,e,t){var r,i=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var d=this.internal.getFont(h.fontName,h.fontStyle),m="Unicode";return d.metadata[m]?{widths:d.metadata[m].widths||{0:1},kerning:d.metadata[m].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(n)?n:String(n).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=t.lineIndent;var a,u,l=[];for(a=0,u=r.length;a<u;a++)l=l.concat(oC.apply(this,[r[a],s,o]));return l},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",r={},i={},o=0;o<16;o++)r[t[o]]=e[o],i[e[o]]=t[o];var s=function(m){return"0x"+parseInt(m,10).toString(16)},a=n.__fontmetrics__.compress=function(m){var p,y,b,x,E=["{"];for(var T in m){if(p=m[T],isNaN(parseInt(T,10))?y="'"+T+"'":(T=parseInt(T,10),y=(y=s(T).slice(2)).slice(0,-1)+i[y.slice(-1)]),typeof p=="number")p<0?(b=s(p).slice(3),x="-"):(b=s(p).slice(2),x=""),b=x+b.slice(0,-1)+i[b.slice(-1)];else{if(fr(p)!=="object")throw new Error("Don't know what to do with value type "+fr(p)+".");b=a(p)}E.push(y+b)}return E.push("}"),E.join("")},u=n.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,y,b,x,E={},T=1,P=E,C=[],D="",z="",L=m.length-1,I=1;I<L;I+=1)(x=m[I])=="'"?p?(b=p.join(""),p=void 0):p=[]:p?p.push(x):x=="{"?(C.push([P,b]),P={},b=void 0):x=="}"?((y=C.pop())[0][y[1]]=P,b=void 0,P=y[0]):x=="-"?T=-1:b===void 0?r.hasOwnProperty(x)?(D+=r[x],b=parseInt(D,16)*T,T=1,D=""):D+=x:r.hasOwnProperty(x)?(z+=r[x],P[b]=parseInt(z,16)*T,T=1,b=void 0,z=""):z+=x;return E},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},d={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(m){var p=m.font,y=d.Unicode[p.postScriptName];y&&(p.metadata.Unicode={},p.metadata.Unicode.widths=y.widths,p.metadata.Unicode.kerning=y.kerning);var b=h.Unicode[p.postScriptName];b&&(p.metadata.Unicode.encoding=b,p.encoding=b.codePages[0])}])})(Wt.API),(function(n){var e=function(t){for(var r=t.length,i=new Uint8Array(r),o=0;o<r;o++)i[o]=t.charCodeAt(o);return i};n.API.events.push(["addFont",function(t){var r=void 0,i=t.font,o=t.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(Tv(a)),s.metadata=n.API.TTFFont.open(a),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,r)}}])})(Wt),Wt.API.addSvgAsImage=function(n,e,t,r,i,o,s,a){if(isNaN(e)||isNaN(t))throw _r.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(i))throw _r.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=r,u.height=i;var l=u.getContext("2d");l.fillStyle="#fff",l.fillRect(0,0,u.width,u.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(pn.canvg?Promise.resolve(pn.canvg):t2(()=>import("./index.es-BQ0gMQoM.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(l,n,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(h)}).then(function(){d.addImage(u.toDataURL("image/jpeg",1),e,t,r,i,s,a)})},Wt.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,t);return this},Wt.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var r,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(s),u=[],l=0,h=0,d=0;function m(y,b){var x,E=!1;for(x=0;x<y.length;x+=1)y[x]===b&&(E=!0);return E}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var p=a.length;for(d=0;d<p;d+=1)t[a[d]].value=t[a[d]].defaultValue,t[a[d]].explicitSet=!1}if(fr(n)==="object"){for(i in n)if(o=n[i],m(a,i)&&o!==void 0){if(t[i].type==="boolean"&&typeof o=="boolean")t[i].value=o;else if(t[i].type==="name"&&m(t[i].valueSet,o))t[i].value=o;else if(t[i].type==="integer"&&Number.isInteger(o))t[i].value=o;else if(t[i].type==="array"){for(l=0;l<o.length;l+=1)if(r=!0,o[l].length===1&&typeof o[l][0]=="number")u.push(String(o[l]-1));else if(o[l].length>1){for(h=0;h<o[l].length;h+=1)typeof o[l][h]!="number"&&(r=!1);r===!0&&u.push([o[l][0]-1,o[l][1]-1].join(" "))}t[i].value="["+u.join(" ")+"]"}else t[i].value=t[i].defaultValue;t[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,b=[];for(y in t)t[y].explicitSet===!0&&(t[y].type==="name"?b.push("/"+y+" /"+t[y].value):b.push("/"+y+" "+t[y].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(r)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),l=o.length+s.length+a.length+i.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+a+u),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(Wt.API),(function(n){var e=n.API,t=e.pdfEscape16=function(o,s){for(var a,u=s.metadata.Unicode.widths,l=["","0","00","000","0000"],h=[""],d=0,m=o.length;d<m;++d){if(a=s.metadata.characterToGlyph(o.charCodeAt(d)),s.metadata.glyIdsUsed.push(a),s.metadata.toUnicode[a]=o.charCodeAt(d),u.indexOf(a)==-1&&(u.push(a),u.push([parseInt(s.metadata.widthOfGlyph(a),10)])),a=="0")return h.join("");a=a.toString(16),h.push(l[4-a.length],a)}return h.join("")},r=function(o){var s,a,u,l,h,d,m;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],d=0,m=(a=Object.keys(o).sort(function(p,y){return p-y})).length;d<m;d++)s=a[d],u.length>=100&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(l=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),u.push("<"+s+"><"+l+">"));return u.length&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),h+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var a=s.font,u=s.out,l=s.newObject,h=s.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="Identity-H"){for(var d=a.metadata.Unicode.widths,m=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),p="",y=0;y<m.length;y++)p+=String.fromCharCode(m[y]);var b=l();h({data:p,addLength1:!0,objectId:b}),u("endobj");var x=l();h({data:r(a.metadata.toUnicode),addLength1:!0,objectId:x}),u("endobj");var E=l();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+ad(a.fontName)),u("/FontFile2 "+b+" 0 R"),u("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),u("/Flags "+a.metadata.flags),u("/StemV "+a.metadata.stemV),u("/ItalicAngle "+a.metadata.italicAngle),u("/Ascent "+a.metadata.ascender),u("/Descent "+a.metadata.decender),u("/CapHeight "+a.metadata.capHeight),u(">>"),u("endobj");var T=l();u("<<"),u("/Type /Font"),u("/BaseFont /"+ad(a.fontName)),u("/FontDescriptor "+E+" 0 R"),u("/W "+n.API.PDFObject.convert(d)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+a.encoding+")"),u(">>"),u(">>"),u("endobj"),a.objectNumber=l(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+x+" 0 R"),u("/BaseFont /"+ad(a.fontName)),u("/Encoding /"+a.encoding),u("/DescendantFonts ["+T+" 0 R]"),u(">>"),u("endobj"),a.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var a=s.font,u=s.out,l=s.newObject,h=s.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var d=a.metadata.rawData,m="",p=0;p<d.length;p++)m+=String.fromCharCode(d[p]);var y=l();h({data:m,addLength1:!0,objectId:y}),u("endobj");var b=l();h({data:r(a.metadata.toUnicode),addLength1:!0,objectId:b}),u("endobj");var x=l();u("<<"),u("/Descent "+a.metadata.decender),u("/CapHeight "+a.metadata.capHeight),u("/StemV "+a.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+y+" 0 R"),u("/Flags 96"),u("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),u("/FontName /"+ad(a.fontName)),u("/ItalicAngle "+a.metadata.italicAngle),u("/Ascent "+a.metadata.ascender),u(">>"),u("endobj"),a.objectNumber=l();for(var E=0;E<a.metadata.hmtx.widths.length;E++)a.metadata.hmtx.widths[E]=parseInt(a.metadata.hmtx.widths[E]*(1e3/a.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+ad(a.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),u("endobj"),a.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,a=o.text||"",u=o.x,l=o.y,h=o.options||{},d=o.mutex||{},m=d.pdfEscape,p=d.activeFontKey,y=d.fonts,b=p,x="",E=0,T="",P=y[b].encoding;if(y[b].encoding!=="Identity-H")return{text:a,x:u,y:l,options:h,mutex:d};for(T=a,b=p,Array.isArray(a)&&(T=a[0]),E=0;E<T.length;E+=1)y[b].metadata.hasOwnProperty("cmap")&&(s=y[b].metadata.cmap.unicode.codeMap[T[E].charCodeAt(0)]),s||T[E].charCodeAt(0)<256&&y[b].metadata.hasOwnProperty("Unicode")?x+=T[E]:x+="";var C="";return parseInt(b.slice(1))<14||P==="WinAnsiEncoding"?C=m(x,b).split("").map(function(D){return D.charCodeAt(0).toString(16)}).join(""):P==="Identity-H"&&(C=t(x,y[b])),d.isHex=!0,{text:C,x:u,y:l,options:h,mutex:d}};e.events.push(["postProcessText",function(o){var s=o.text||"",a=[],u={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var l=0;for(l=0;l<s.length;l+=1)Array.isArray(s[l])&&s[l].length===3?a.push([i(Object.assign({},u,{text:s[l][0]})).text,s[l][1],s[l][2]]):a.push(i(Object.assign({},u,{text:s[l]})).text);o.text=a}else o.text=i(Object.assign({},u,{text:s})).text}])})(Wt),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,r){return e.call(this),this.internal.vFS[t]=r,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(Wt.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(r){var i,o,s,a,u,l,h,d=e,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],E=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),T=!1,P=0;this.__bidiEngine__={};var C=function(k){var M=k.charCodeAt(),j=M>>8,X=b[j];return X!==void 0?d[256*X+(255&M)]:j===252||j===253?"AL":E.test(j)?"L":j===8?"R":"N"},D=function(k){for(var M,j=0;j<k.length;j++){if((M=C(k.charAt(j)))==="L")return!1;if(M==="R")return!0}return!1},z=function(k,M,j,X){var ue,ge,ce,$,ae=M[X];switch(ae){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":T=!1;break;case"N":case"AN":break;case"EN":T&&(ae="AN");break;case"AL":T=!0,ae="R";break;case"WS":case"BN":ae="N";break;case"CS":X<1||X+1>=M.length||(ue=j[X-1])!=="EN"&&ue!=="AN"||(ge=M[X+1])!=="EN"&&ge!=="AN"?ae="N":T&&(ge="AN"),ae=ge===ue?ge:"N";break;case"ES":ae=(ue=X>0?j[X-1]:"B")==="EN"&&X+1<M.length&&M[X+1]==="EN"?"EN":"N";break;case"ET":if(X>0&&j[X-1]==="EN"){ae="EN";break}if(T){ae="N";break}for(ce=X+1,$=M.length;ce<$&&M[ce]==="ET";)ce++;ae=ce<$&&M[ce]==="EN"?"EN":"N";break;case"NSM":if(s&&!a){for($=M.length,ce=X+1;ce<$&&M[ce]==="NSM";)ce++;if(ce<$){var fe=k[X],Q=fe>=1425&&fe<=2303||fe===64286;if(ue=M[ce],Q&&(ue==="R"||ue==="AL")){ae="R";break}}}ae=X<1||(ue=M[X-1])==="B"?"N":j[X-1];break;case"B":T=!1,i=!0,ae=P;break;case"S":o=!0,ae="N"}return ae},L=function(k,M,j){var X=k.split("");return j&&I(X,j,{hiLevel:P}),X.reverse(),M&&M.reverse(),X.join("")},I=function(k,M,j){var X,ue,ge,ce,$,ae=-1,fe=k.length,Q=0,W=[],J=P?p:m,te=[];for(T=!1,i=!1,o=!1,ue=0;ue<fe;ue++)te[ue]=C(k[ue]);for(ge=0;ge<fe;ge++){if($=Q,W[ge]=z(k,te,W,ge),X=240&(Q=J[$][y[W[ge]]]),Q&=15,M[ge]=ce=J[Q][5],X>0)if(X===16){for(ue=ae;ue<ge;ue++)M[ue]=1;ae=-1}else ae=-1;if(J[Q][6])ae===-1&&(ae=ge);else if(ae>-1){for(ue=ae;ue<ge;ue++)M[ue]=ce;ae=-1}te[ge]==="B"&&(M[ge]=0),j.hiLevel|=ce}o&&(function(de,ve,we){for(var Se=0;Se<we;Se++)if(de[Se]==="S"){ve[Se]=P;for(var Ie=Se-1;Ie>=0&&de[Ie]==="WS";Ie--)ve[Ie]=P}})(te,M,fe)},A=function(k,M,j,X,ue){if(!(ue.hiLevel<k)){if(k===1&&P===1&&!i)return M.reverse(),void(j&&j.reverse());for(var ge,ce,$,ae,fe=M.length,Q=0;Q<fe;){if(X[Q]>=k){for($=Q+1;$<fe&&X[$]>=k;)$++;for(ae=Q,ce=$-1;ae<ce;ae++,ce--)ge=M[ae],M[ae]=M[ce],M[ce]=ge,j&&(ge=j[ae],j[ae]=j[ce],j[ce]=ge);Q=$}Q++}}},O=function(k,M,j){var X=k.split(""),ue={hiLevel:P};return j||(j=[]),I(X,j,ue),(function(ge,ce,$){if($.hiLevel!==0&&h)for(var ae,fe=0;fe<ge.length;fe++)ce[fe]===1&&(ae=x.indexOf(ge[fe]))>=0&&(ge[fe]=x[ae+1])})(X,j,ue),A(2,X,M,j,ue),A(1,X,M,j,ue),X.join("")};return this.__bidiEngine__.doBidiReorder=function(k,M,j){if((function(ue,ge){if(ge)for(var ce=0;ce<ue.length;ce++)ge[ce]=ce;a===void 0&&(a=D(ue)),l===void 0&&(l=D(ue))})(k,M),s||!u||l)if(s&&u&&a^l)P=a?1:0,k=L(k,M,j);else if(!s&&u&&l)P=a?1:0,k=O(k,M,j),k=L(k,M);else if(!s||a||u||l){if(s&&!u&&a^l)k=L(k,M),a?(P=0,k=O(k,M,j)):(P=1,k=O(k,M,j),k=L(k,M));else if(s&&a&&!u&&l)P=1,k=O(k,M,j),k=L(k,M);else if(!s&&!u&&a^l){var X=h;a?(P=1,k=O(k,M,j),P=0,h=!1,k=O(k,M,j),h=X):(P=0,k=O(k,M,j),k=L(k,M),P=1,h=!1,k=O(k,M,j),h=X,k=L(k,M))}}else P=0,k=O(k,M,j);else P=a?1:0,k=O(k,M,j);return k},this.__bidiEngine__.setOptions=function(k){k&&(s=k.isInputVisual,u=k.isOutputVisual,a=k.isInputRtl,l=k.isOutputRtl,h=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(r){var i=r.text;r.x,r.y;var o=r.options||{};r.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var a=0;for(s=[],a=0;a<i.length;a+=1)Object.prototype.toString.call(i[a])==="[object Array]"?s.push([t.doBidiReorder(i[a][0]),i[a][1],i[a][2]]):s.push([t.doBidiReorder(i[a])]);r.text=s}else r.text=t.doBidiReorder(i);t.setOptions({isInputVisual:!0})}])})(Wt),Wt.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new ch(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new wH(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new oH(this.contents),this.head=new aH(this),this.name=new fH(this),this.cmap=new MN(this),this.toUnicode={},this.hhea=new uH(this),this.maxp=new dH(this),this.hmtx=new pH(this),this.post=new cH(this),this.os2=new lH(this),this.loca=new yH(this),this.glyf=new mH(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,r,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,a,u,l;for(l=[],s=0,a=(u=this.bbox).length;s<a;s++)e=u[s],l.push(Math.round(e*this.scaleFactor));return l}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(t=i>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,r){var i,o,s,a;for(s=0,o=0,a=(e=""+e).length;0<=a?o<a:o>a;o=0<=a?++o:--o)i=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/t)||0;return s*(t/1e3)},n.prototype.lineHeight=function(e,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},n})();var Tu,ch=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},n.prototype.writeString=function(e){var t,r,i;for(i=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)i.push(this.writeByte(e.charCodeAt(t)));return i},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,r,i,o,s,a,u;return e=this.readByte(),t=this.readByte(),r=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),a=this.readByte(),u=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^a)+(255^u)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*i+16777216*o+65536*s+256*a+u},n.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},n.prototype.write=function(e){var t,r,i,o;for(o=[],r=0,i=e.length;r<i;r++)t=e[r],o.push(this.writeByte(t));return o},n})(),oH=(function(){var n;function e(t){var r,i,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(t){var r,i,o,s,a,u,l,h,d,m,p,y,b;for(b in p=Object.keys(t).length,u=Math.log(2),d=16*Math.floor(Math.log(p)/u),s=Math.floor(d/u),h=16*p-d,(i=new ch).writeInt(this.scalarType),i.writeShort(p),i.writeShort(d),i.writeShort(s),i.writeShort(h),o=16*p,l=i.pos+o,a=null,y=[],t)for(m=t[b],i.writeString(b),i.writeInt(n(m)),i.writeInt(l),i.writeInt(m.length),y=y.concat(m),b==="head"&&(a=l),l+=m.length;l%4;)y.push(0),l++;return i.write(y),r=2981146554-n(i.data),i.pos=a+8,i.writeUInt32(r),i.data},n=function(t){var r,i,o,s;for(t=ON.call(t);t.length%4;)t.push(0);for(o=new ch(t),i=0,r=0,s=t.length;r<s;r=r+=4)i+=o.readUInt32();return 4294967295&i},e})(),sH={}.hasOwnProperty,bl=function(n,e){for(var t in e)sH.call(e,t)&&(n[t]=e[t]);function r(){this.constructor=n}return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};Tu=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var aH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var t;return(t=new ch).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},n})(),pC=(function(){function n(e,t){var r,i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=e.readByte();break;case 4:for(p=e.readUInt16(),m=p/2,e.pos+=6,o=(function(){var C,D;for(D=[],u=C=0;0<=m?C<m:C>m;u=0<=m?++C:--C)D.push(e.readUInt16());return D})(),e.pos+=2,b=(function(){var C,D;for(D=[],u=C=0;0<=m?C<m:C>m;u=0<=m?++C:--C)D.push(e.readUInt16());return D})(),l=(function(){var C,D;for(D=[],u=C=0;0<=m?C<m:C>m;u=0<=m?++C:--C)D.push(e.readUInt16());return D})(),h=(function(){var C,D;for(D=[],u=C=0;0<=m?C<m:C>m;u=0<=m?++C:--C)D.push(e.readUInt16());return D})(),i=(this.length-e.pos+this.offset)/2,a=(function(){var C,D;for(D=[],u=C=0;0<=i?C<i:C>i;u=0<=i?++C:--C)D.push(e.readUInt16());return D})(),u=E=0,P=o.length;E<P;u=++E)for(x=o[u],r=T=y=b[u];y<=x?T<=x:T>=x;r=y<=x?++T:--T)h[u]===0?s=r+l[u]:(s=a[h[u]/2+(r-y)-(m-u)]||0)!==0&&(s+=l[u]),this.codeMap[r]=65535&s}e.pos=d}return n.encode=function(e,t){var r,i,o,s,a,u,l,h,d,m,p,y,b,x,E,T,P,C,D,z,L,I,A,O,k,M,j,X,ue,ge,ce,$,ae,fe,Q,W,J,te,de,ve,we,Se,Ie,Fe,Ae,Be;switch(X=new ch,s=Object.keys(e).sort(function(Le,tt){return Le-tt}),t){case"macroman":for(b=0,x=(function(){var Le=[];for(y=0;y<256;++y)Le.push(0);return Le})(),T={0:0},o={},ue=0,ae=s.length;ue<ae;ue++)T[Ie=e[i=s[ue]]]==null&&(T[Ie]=++b),o[i]={old:e[i],new:T[e[i]]},x[i]=T[e[i]];return X.writeUInt16(1),X.writeUInt16(0),X.writeUInt32(12),X.writeUInt16(0),X.writeUInt16(262),X.writeUInt16(0),X.write(x),{charMap:o,subtable:X.data,maxGlyphID:b+1};case"unicode":for(M=[],d=[],P=0,T={},r={},E=l=null,ge=0,fe=s.length;ge<fe;ge++)T[D=e[i=s[ge]]]==null&&(T[D]=++P),r[i]={old:D,new:T[D]},a=T[D]-i,E!=null&&a===l||(E&&d.push(E),M.push(i),l=a),E=i;for(E&&d.push(E),d.push(65535),M.push(65535),O=2*(A=M.length),I=2*Math.pow(Math.log(A)/Math.LN2,2),m=Math.log(I/2)/Math.LN2,L=2*A-I,u=[],z=[],p=[],y=ce=0,Q=M.length;ce<Q;y=++ce){if(k=M[y],h=d[y],k===65535){u.push(0),z.push(0);break}if(k-(j=r[k].new)>=32768)for(u.push(0),z.push(2*(p.length+A-y)),i=$=k;k<=h?$<=h:$>=h;i=k<=h?++$:--$)p.push(r[i].new);else u.push(j-k),z.push(0)}for(X.writeUInt16(3),X.writeUInt16(1),X.writeUInt32(12),X.writeUInt16(4),X.writeUInt16(16+8*A+2*p.length),X.writeUInt16(0),X.writeUInt16(O),X.writeUInt16(I),X.writeUInt16(m),X.writeUInt16(L),we=0,W=d.length;we<W;we++)i=d[we],X.writeUInt16(i);for(X.writeUInt16(0),Se=0,J=M.length;Se<J;Se++)i=M[Se],X.writeUInt16(i);for(Fe=0,te=u.length;Fe<te;Fe++)a=u[Fe],X.writeUInt16(a);for(Ae=0,de=z.length;Ae<de;Ae++)C=z[Ae],X.writeUInt16(C);for(Be=0,ve=p.length;Be<ve;Be++)b=p[Be],X.writeUInt16(b);return{charMap:r,subtable:X.data,maxGlyphID:P+1}}},n})(),MN=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="cmap",n.prototype.parse=function(e){var t,r,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)t=new pC(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(e,t){var r,i;return t==null&&(t="macroman"),r=pC.encode(e,t),(i=new ch).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},n})(),uH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n})(),lH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,r;for(r=[],t=0;t<10;++t)r.push(e.readByte());return r})(),this.charRange=(function(){var t,r;for(r=[],t=0;t<4;++t)r.push(e.readInt());return r})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,r;for(r=[],t=0;t<2;t=++t)r.push(e.readInt());return r})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n})(),cH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="post",n.prototype.parse=function(e){var t,r,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var o;for(r=e.readUInt16(),this.glyphNameIndex=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)t=e.readByte(),i.push(this.names.push(e.readString(t)));return i;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var s,a,u;for(u=[],o=s=0,a=this.file.maxp.numGlyphs;0<=a?s<a:s>a;o=0<=a?++s:--s)u.push(e.readUInt32());return u}).call(this)}},n})(),hH=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},fH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="name",n.prototype.parse=function(e){var t,r,i,o,s,a,u,l,h,d,m;for(e.pos=this.offset,e.readShort(),t=e.readShort(),a=e.readShort(),r=[],o=0;0<=t?o<t:o>t;o=0<=t?++o:--o)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+a+e.readShort()});for(u={},o=h=0,d=r.length;h<d;o=++h)i=r[o],e.pos=i.offset,l=e.readString(i.length),s=new hH(l,i),u[m=i.nameID]==null&&(u[m]=[]),u[i.nameID].push(s);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},n})(),dH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n})(),pH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="hmtx",n.prototype.parse=function(e){var t,r,i,o,s,a,u;for(e.pos=this.offset,this.metrics=[],t=0,a=this.file.hhea.numberOfMetrics;0<=a?t<a:t>a;t=0<=a?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var l,h;for(h=[],t=l=0;0<=i?l<i:l>i;t=0<=i?++l:--l)h.push(e.readInt16());return h})(),this.widths=(function(){var l,h,d,m;for(m=[],l=0,h=(d=this.metrics).length;l<h;l++)o=d[l],m.push(o.advance);return m}).call(this),r=this.widths[this.widths.length-1],u=[],t=s=0;0<=i?s<i:s>i;t=0<=i?++s:--s)u.push(this.widths.push(r));return u},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n})(),ON=[].slice,mH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var t,r,i,o,s,a,u,l,h,d;return e in this.cache?this.cache[e]:(o=this.file.loca,t=this.file.contents,r=o.indexOf(e),(i=o.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+r,s=(a=new ch(t.read(i))).readShort(),l=a.readShort(),d=a.readShort(),u=a.readShort(),h=a.readShort(),this.cache[e]=s===-1?new vH(a,l,d,u,h):new gH(a,s,l,d,u,h),this.cache[e]))},n.prototype.encode=function(e,t,r){var i,o,s,a,u;for(s=[],o=[],a=0,u=t.length;a<u;a++)i=e[t[a]],o.push(s.length),i&&(s=s.concat(i.encode(r)));return o.push(s.length),{table:s,offsets:o}},n})(),gH=(function(){function n(e,t,r,i,o,s){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),vH=(function(){function n(e,t,r,i,o){var s,a;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;a=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&a;)s.pos+=1&a?4:2,128&a?s.pos+=8:64&a?s.pos+=4:8&a&&(s.pos+=2)}return n.prototype.encode=function(){var e,t,r;for(t=new ch(ON.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),yH=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bl(n,Tu),n.prototype.tag="loca",n.prototype.parse=function(e){var t,r;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var i,o;for(o=[],r=0,i=this.length;r<i;r+=2)o.push(2*e.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],r=0,i=this.length;r<i;r+=4)o.push(e.readUInt32());return o}).call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,t){for(var r=new Uint32Array(this.offsets.length),i=0,o=0,s=0;s<r.length;++s)if(r[s]=i,o<t.length&&t[o]==s){++o,r[s]=i;var a=this.offsets[s],u=this.offsets[s+1]-a;u>0&&(i+=u)}for(var l=new Array(4*r.length),h=0;h<r.length;++h)l[4*h+3]=255&r[h],l[4*h+2]=(65280&r[h])>>8,l[4*h+1]=(16711680&r[h])>>16,l[4*h]=(4278190080&r[h])>>24;return l},n})(),wH=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,r,i,o;for(t in i=this.font.cmap.tables[0].codeMap,e={},o=this.subset)r=o[t],e[t]=i[r];return e},n.prototype.glyphsFor=function(e){var t,r,i,o,s,a,u;for(i={},s=0,a=e.length;s<a;s++)i[o=e[s]]=this.font.glyf.glyphFor(o);for(o in t=[],i)(r=i[o])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(o in u=this.glyphsFor(t))r=u[o],i[o]=r;return i},n.prototype.encode=function(e,t){var r,i,o,s,a,u,l,h,d,m,p,y,b,x,E;for(i in r=MN.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),p={0:0},E=r.charMap)p[(u=E[i]).old]=u.new;for(y in m=r.maxGlyphID,s)y in p||(p[y]=m++);return h=(function(T){var P,C;for(P in C={},T)C[T[P]]=P;return C})(p),d=Object.keys(h).sort(function(T,P){return T-P}),b=(function(){var T,P,C;for(C=[],T=0,P=d.length;T<P;T++)a=d[T],C.push(h[a]);return C})(),o=this.font.glyf.encode(s,b,p),l=this.font.loca.encode(o.offsets,b),x={cmap:this.font.cmap.raw(),glyf:o.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},n})();Wt.API.PDFObject=(function(){var n;function e(){}return n=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},e.convert=function(t){var r,i,o,s;if(Array.isArray(t))return"["+(function(){var a,u,l;for(l=[],a=0,u=t.length;a<u;a++)r=t[a],l.push(e.convert(r));return l})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(i in o=["<<"],t)s=t[i],o.push("/"+i+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+t},e})();const bH=()=>{const{incidentLog:n,addIncident:e,deleteIncident:t,setActiveMode:r,playSound:i,speak:o}=Eu(),[s,a]=Ke.useState({title:"",location:"",details:"",severity:"Low"}),[u,l]=Ke.useState(null),h=y=>{const b=y.toLowerCase();let x=[];(b.includes("fight")||b.includes("brawl"))&&x.push(" Increase security presence in sector."),(b.includes("weapon")||b.includes("gun")||b.includes("knife"))&&x.push(" CRITICAL: Contact Police immediately. Lockdown perimeter."),(b.includes("iron")||b.includes("knuckle"))&&x.push(" MANDATORY: Metal detector wands at entry."),(b.includes("drug")||b.includes("pill"))&&x.push(" Search bathrooms and VIP areas."),(b.includes("overcrowd")||b.includes("full"))&&x.push(" Halt entry. Check fire exits."),x.length>0?(l(x),b.includes("weapon")&&o("High alert. Weapon protocol suggested.")):l(null)},d=y=>{a({...s,details:y.target.value}),h(y.target.value)},m=()=>{s.title&&(e(s),a({title:"",location:"",details:"",severity:"Low"}),l(null))},p=y=>{const b=new Wt;b.setFillColor(0,0,0),b.rect(0,0,210,40,"F"),b.setTextColor(0,229,255),b.setFont("helvetica","bold"),b.setFontSize(22),b.text("T-FORCE SECURITY SITREP",15,20),b.setFontSize(10),b.text("INTERNAL CLASSIFIED REPORT",15,30),b.setTextColor(0,0,0),b.setFontSize(14),b.text(`INCIDENT: ${y.title}`,15,60),b.setFontSize(12),b.text(`DATE: ${y.date}`,15,70),b.text(`LOCATION: ${y.location}`,15,80),b.text(`SEVERITY: ${y.severity.toUpperCase()}`,15,90),b.line(15,95,195,95),b.setFont("helvetica","normal"),b.text("DETAILS:",15,110);const x=b.splitTextToSize(y.details,180);b.text(x,15,120),b.setTextColor(150),b.setFontSize(10),b.text("Generated by JARVIS Operational Unit",15,280),b.save(`T-Force_Report_${y.id}.pdf`),o("Report compiled and downloaded.")};return oe.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[oe.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[oe.jsxs("div",{className:"flex items-center gap-3",children:[oe.jsx("i",{className:"fas fa-file-alt text-cyan text-xl animate-pulse"}),oe.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"INCIDENT LOG"})]}),oe.jsx("button",{onClick:()=>{i("click"),r("HOME")},className:"text-cyan hover:text-white",children:oe.jsx("i",{className:"fas fa-times text-2xl"})})]}),oe.jsxs("div",{className:"flex-1 overflow-y-auto p-6 no-scrollbar",children:[oe.jsxs("div",{className:"bg-cyan/5 border border-cyan/30 p-4 rounded mb-6",children:[oe.jsxs("div",{className:"mb-4",children:[oe.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"INCIDENT TYPE"}),oe.jsx("input",{type:"text",value:s.title,onChange:y=>a({...s,title:y.target.value}),className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none focus:border-cyan",placeholder:"E.g., Fight at Bar"})]}),oe.jsxs("div",{className:"flex gap-4 mb-4",children:[oe.jsxs("div",{className:"flex-1",children:[oe.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"LOCATION"}),oe.jsx("input",{type:"text",value:s.location,onChange:y=>a({...s,location:y.target.value}),className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Mykonos Club"})]}),oe.jsxs("div",{children:[oe.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"SEVERITY"}),oe.jsxs("select",{value:s.severity,onChange:y=>a({...s,severity:y.target.value}),className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none",children:[oe.jsx("option",{children:"Low"}),oe.jsx("option",{children:"Medium"}),oe.jsx("option",{children:"High"}),oe.jsx("option",{children:"Critical"})]})]})]}),oe.jsxs("div",{className:"mb-4",children:[oe.jsx("label",{className:"text-cyan-dim text-xs font-mono",children:"DETAILS"}),oe.jsx("textarea",{value:s.details,onChange:d,rows:"4",className:"w-full bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Describe the situation..."})]}),u&&oe.jsxs("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-500/50 rounded",children:[oe.jsx("div",{className:"text-red-500 font-orbitron text-xs mb-2",children:" TACTICAL ANALYSIS:"}),u.map((y,b)=>oe.jsx("div",{className:"text-red-300 text-xs font-mono",children:y},b))]}),oe.jsx("button",{onClick:m,className:"w-full py-3 bg-cyan/20 border border-cyan text-cyan font-orbitron tracking-widest hover:bg-cyan/40",children:"LOG INCIDENT"})]}),oe.jsx("div",{className:"space-y-4",children:n.map(y=>oe.jsxs("div",{className:"border border-white/10 p-4 rounded bg-white/5 flex justify-between items-start",children:[oe.jsxs("div",{children:[oe.jsx("div",{className:"text-cyan font-bold font-orbitron",children:y.title}),oe.jsxs("div",{className:"text-xs text-gray-400 font-mono mb-2",children:[y.date," | ",y.location]}),oe.jsx("div",{className:"text-sm text-gray-300",children:y.details}),oe.jsxs("div",{className:`mt-2 text-xs font-bold ${y.severity==="Critical"?"text-red-500":"text-cyan-dim"}`,children:["LEVEL: ",y.severity.toUpperCase()]})]}),oe.jsxs("div",{className:"flex flex-col gap-2",children:[oe.jsx("button",{onClick:()=>p(y),className:"p-2 border border-cyan/30 text-cyan rounded hover:bg-cyan/10",title:"Download PDF",children:oe.jsx("i",{className:"fas fa-file-pdf"})}),oe.jsx("button",{onClick:()=>t(y.id),className:"p-2 border border-red-500/30 text-red-500 rounded hover:bg-red-500/10",title:"Delete",children:oe.jsx("i",{className:"fas fa-trash"})})]})]},y.id))})]})]})},xH=()=>{const{leadsLog:n,addLead:e,updateLeadStatus:t,deleteLead:r,setActiveMode:i,playSound:o,speak:s}=Eu(),[a,u]=Ke.useState({name:"",location:"",type:"Factory"}),l=m=>{o("click"),s(`Initiating reconnaissance for ${m}.`),window.open(`https://www.google.com/maps/search/${m}+near+me`,"_blank")},h=()=>{a.name&&(e(a),u({name:"",location:"",type:"Factory"}))},d=m=>m==="Potential"?"text-gray-400 border-gray-500":m==="Contacted"?"text-orange-400 border-orange-500":m==="Contracted"?"text-green-400 border-green-500":"text-red-400 border-red-500";return oe.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up",children:[oe.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-cyan/30",children:[oe.jsxs("div",{className:"flex items-center gap-3",children:[oe.jsx("i",{className:"fas fa-satellite-dish text-cyan text-xl animate-pulse"}),oe.jsx("h2",{className:"text-cyan font-orbitron text-xl tracking-widest",children:"RECON / SALES"})]}),oe.jsx("button",{onClick:()=>{o("click"),i("HOME")},className:"text-cyan hover:text-white",children:oe.jsx("i",{className:"fas fa-times text-2xl"})})]}),oe.jsxs("div",{className:"flex-1 overflow-y-auto p-6 no-scrollbar",children:[oe.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[oe.jsxs("button",{onClick:()=>l("Factories"),className:"p-4 border border-cyan/30 rounded bg-cyan/5 text-cyan hover:bg-cyan/20",children:[oe.jsx("i",{className:"fas fa-industry text-2xl mb-2"}),oe.jsx("div",{className:"font-orbitron text-xs",children:"FIND FACTORIES"})]}),oe.jsxs("button",{onClick:()=>l("Hotels"),className:"p-4 border border-cyan/30 rounded bg-cyan/5 text-cyan hover:bg-cyan/20",children:[oe.jsx("i",{className:"fas fa-hotel text-2xl mb-2"}),oe.jsx("div",{className:"font-orbitron text-xs",children:"FIND HOTELS"})]})]}),oe.jsxs("div",{className:"mb-6 border-t border-cyan/10 pt-4",children:[oe.jsx("div",{className:"text-cyan-dim font-mono text-xs mb-2",children:"MANUAL LEAD ENTRY"}),oe.jsxs("div",{className:"flex flex-col gap-3",children:[oe.jsx("input",{type:"text",value:a.name,onChange:m=>u({...a,name:m.target.value}),className:"bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Business Name"}),oe.jsx("input",{type:"text",value:a.location,onChange:m=>u({...a,location:m.target.value}),className:"bg-black border border-cyan/30 p-2 text-cyan outline-none",placeholder:"Location"}),oe.jsx("button",{onClick:h,className:"bg-cyan text-black font-bold py-2 rounded hover:bg-cyan/80",children:"ADD TARGET"})]})]}),oe.jsx("div",{className:"space-y-3",children:n.map(m=>oe.jsxs("div",{className:`border p-4 rounded flex justify-between items-center ${d(m.status)} bg-black`,children:[oe.jsxs("div",{children:[oe.jsx("div",{className:"font-bold font-orbitron",children:m.name}),oe.jsxs("div",{className:"text-xs opacity-70",children:[m.location," | ",m.dateAdded]})]}),oe.jsxs("div",{className:"flex flex-col items-end gap-2",children:[oe.jsxs("select",{value:m.status,onChange:p=>t(m.id,p.target.value),className:"bg-black border border-white/20 text-xs p-1 outline-none rounded text-white",children:[oe.jsx("option",{children:"Potential"}),oe.jsx("option",{children:"Contacted"}),oe.jsx("option",{children:"Meeting Set"}),oe.jsx("option",{children:"Contracted"}),oe.jsx("option",{children:"Dead Lead"})]}),oe.jsx("button",{onClick:()=>r(m.id),className:"text-xs text-red-500 hover:text-red-300",children:"REMOVE"})]})]},m.id))})]})]})},_H=()=>{};var mC={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},EH=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[t++],s=n[t++],a=n[t++],u=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const o=n[t++],s=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},BN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const o=n[i],s=i+1<n.length,a=s?n[i+1]:0,u=i+2<n.length,l=u?n[i+2]:0,h=o>>2,d=(o&3)<<4|a>>4;let m=(a&15)<<2|l>>6,p=l&63;u||(p=64,s||(m=64)),r.push(t[h],t[d],t[m],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(FN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):EH(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const o=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const l=i<n.length?t[n.charAt(i)]:64;++i;const d=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||a==null||l==null||d==null)throw new SH;const m=o<<2|a>>4;if(r.push(m),l!==64){const p=a<<4&240|l>>2;if(r.push(p),d!==64){const y=l<<6&192|d;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class SH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AH=function(n){const e=FN(n);return BN.encodeByteArray(e,!0)},_0=function(n){return AH(n).replace(/\./g,"")},VN=function(n){try{return BN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CH(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IH=()=>CH().__FIREBASE_DEFAULTS__,TH=()=>{if(typeof process>"u"||typeof mC>"u")return;const n=mC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},kH=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&VN(n[1]);return e&&JSON.parse(e)},a1=()=>{try{return _H()||IH()||TH()||kH()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},jN=n=>{var e,t;return(t=(e=a1())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},NH=n=>{const e=jN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},UN=()=>{var n;return(n=a1())==null?void 0:n.config},zN=n=>{var e;return(e=a1())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RH{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function WN(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PH(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[_0(JSON.stringify(t)),_0(JSON.stringify(s)),""].join(".")}const um={};function DH(){const n={prod:[],emulator:[]};for(const e of Object.keys(um))um[e]?n.emulator.push(e):n.prod.push(e);return n}function LH(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let gC=!1;function qN(n,e){if(typeof window>"u"||typeof document>"u"||!op(window.location.host)||um[n]===e||um[n]||gC)return;um[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",o=DH().prod.length>0;function s(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function l(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{gC=!0,s()},m}function h(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function d(){const m=LH(r),p=t("text"),y=document.getElementById(p)||document.createElement("span"),b=t("learnmore"),x=document.getElementById(b)||document.createElement("a"),E=t("preprendIcon"),T=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const P=m.element;a(P),h(x,b);const C=l();u(T,E),P.append(T,y,x,C),document.body.appendChild(P)}o?(y.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function MH(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ls())}function OH(){var e;const n=(e=a1())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function FH(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function BH(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function VH(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jH(){const n=ls();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function UH(){return!OH()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zH(){try{return typeof indexedDB=="object"}catch{return!1}}function WH(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qH="FirebaseError";class lc extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=qH,Object.setPrototypeOf(this,lc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zm.prototype.create)}}class Zm{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?HH(o,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new lc(i,a,r)}}function HH(n,e){return n.replace(GH,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const GH=/\{\$([^}]+)}/g;function $H(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function df(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const o=n[i],s=e[i];if(vC(o)&&vC(s)){if(!df(o,s))return!1}else if(o!==s)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function vC(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function $p(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Kp(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function KH(n,e){const t=new XH(n,e);return t.subscribe.bind(t)}class XH{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");YH(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=E2),i.error===void 0&&(i.error=E2),i.complete===void 0&&(i.complete=E2);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function YH(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function E2(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(n){return n&&n._delegate?n._delegate:n}class pf{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xh="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QH{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new RH;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ZH(e))try{this.getOrInitializeService({instanceIdentifier:Xh})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Xh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xh){return this.instances.has(e)}getOptions(e=Xh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&s.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:JH(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xh){return this.component?this.component.multipleInstances?e:Xh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function JH(n){return n===Xh?void 0:n}function ZH(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eG{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new QH(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Fn||(Fn={}));const tG={debug:Fn.DEBUG,verbose:Fn.VERBOSE,info:Fn.INFO,warn:Fn.WARN,error:Fn.ERROR,silent:Fn.SILENT},nG=Fn.INFO,rG={[Fn.DEBUG]:"log",[Fn.VERBOSE]:"log",[Fn.INFO]:"info",[Fn.WARN]:"warn",[Fn.ERROR]:"error"},iG=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=rG[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $x{constructor(e){this.name=e,this._logLevel=nG,this._logHandler=iG,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tG[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fn.DEBUG,...e),this._logHandler(this,Fn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fn.VERBOSE,...e),this._logHandler(this,Fn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fn.INFO,...e),this._logHandler(this,Fn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fn.WARN,...e),this._logHandler(this,Fn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fn.ERROR,...e),this._logHandler(this,Fn.ERROR,...e)}}const oG=(n,e)=>e.some(t=>n instanceof t);let yC,wC;function sG(){return yC||(yC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function aG(){return wC||(wC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const HN=new WeakMap,Dw=new WeakMap,GN=new WeakMap,S2=new WeakMap,Kx=new WeakMap;function uG(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Zc(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&HN.set(t,n)}).catch(()=>{}),Kx.set(e,n),e}function lG(n){if(Dw.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Dw.set(n,e)}let Lw={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Dw.get(n);if(e==="objectStoreNames")return n.objectStoreNames||GN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zc(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function cG(n){Lw=n(Lw)}function hG(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(A2(this),e,...t);return GN.set(r,e.sort?e.sort():[e]),Zc(r)}:aG().includes(n)?function(...e){return n.apply(A2(this),e),Zc(HN.get(this))}:function(...e){return Zc(n.apply(A2(this),e))}}function fG(n){return typeof n=="function"?hG(n):(n instanceof IDBTransaction&&lG(n),oG(n,sG())?new Proxy(n,Lw):n)}function Zc(n){if(n instanceof IDBRequest)return uG(n);if(S2.has(n))return S2.get(n);const e=fG(n);return e!==n&&(S2.set(n,e),Kx.set(e,n)),e}const A2=n=>Kx.get(n);function dG(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(n,e),a=Zc(s);return r&&s.addEventListener("upgradeneeded",u=>{r(Zc(s.result),u.oldVersion,u.newVersion,Zc(s.transaction),u)}),t&&s.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const pG=["get","getKey","getAll","getAllKeys","count"],mG=["put","add","delete","clear"],C2=new Map;function bC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(C2.get(e))return C2.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=mG.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||pG.includes(t)))return;const o=async function(s,...a){const u=this.transaction(s,i?"readwrite":"readonly");let l=u.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[t](...a),i&&u.done]))[0]};return C2.set(e,o),o}cG(n=>({...n,get:(e,t,r)=>bC(e,t)||n.get(e,t,r),has:(e,t)=>!!bC(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gG{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(vG(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function vG(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mw="@firebase/app",xC="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ec=new $x("@firebase/app"),yG="@firebase/app-compat",wG="@firebase/analytics-compat",bG="@firebase/analytics",xG="@firebase/app-check-compat",_G="@firebase/app-check",EG="@firebase/auth",SG="@firebase/auth-compat",AG="@firebase/database",CG="@firebase/data-connect",IG="@firebase/database-compat",TG="@firebase/functions",kG="@firebase/functions-compat",NG="@firebase/installations",RG="@firebase/installations-compat",PG="@firebase/messaging",DG="@firebase/messaging-compat",LG="@firebase/performance",MG="@firebase/performance-compat",OG="@firebase/remote-config",FG="@firebase/remote-config-compat",BG="@firebase/storage",VG="@firebase/storage-compat",jG="@firebase/firestore",UG="@firebase/ai",zG="@firebase/firestore-compat",WG="firebase",qG="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow="[DEFAULT]",HG={[Mw]:"fire-core",[yG]:"fire-core-compat",[bG]:"fire-analytics",[wG]:"fire-analytics-compat",[_G]:"fire-app-check",[xG]:"fire-app-check-compat",[EG]:"fire-auth",[SG]:"fire-auth-compat",[AG]:"fire-rtdb",[CG]:"fire-data-connect",[IG]:"fire-rtdb-compat",[TG]:"fire-fn",[kG]:"fire-fn-compat",[NG]:"fire-iid",[RG]:"fire-iid-compat",[PG]:"fire-fcm",[DG]:"fire-fcm-compat",[LG]:"fire-perf",[MG]:"fire-perf-compat",[OG]:"fire-rc",[FG]:"fire-rc-compat",[BG]:"fire-gcs",[VG]:"fire-gcs-compat",[jG]:"fire-fst",[zG]:"fire-fst-compat",[UG]:"fire-vertex","fire-js":"fire-js",[WG]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0=new Map,GG=new Map,Fw=new Map;function _C(n,e){try{n.container.addComponent(e)}catch(t){ec.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Hd(n){const e=n.name;if(Fw.has(e))return ec.debug(`There were multiple attempts to register component ${e}.`),!1;Fw.set(e,n);for(const t of E0.values())_C(t,n);for(const t of GG.values())_C(t,n);return!0}function Xx(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function vu(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $G={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},eh=new Zm("app","Firebase",$G);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KG{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new pf("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw eh.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp=qG;function $N(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Ow,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw eh.create("bad-app-name",{appName:String(i)});if(t||(t=UN()),!t)throw eh.create("no-options");const o=E0.get(i);if(o){if(df(t,o.options)&&df(r,o.config))return o;throw eh.create("duplicate-app",{appName:i})}const s=new eG(i);for(const u of Fw.values())s.addComponent(u);const a=new KG(t,r,s);return E0.set(i,a),a}function KN(n=Ow){const e=E0.get(n);if(!e&&n===Ow&&UN())return $N();if(!e)throw eh.create("no-app",{appName:n});return e}function th(n,e,t){let r=HG[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const s=[`Unable to register library "${r}" with version "${e}":`];i&&s.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ec.warn(s.join(" "));return}Hd(new pf(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XG="firebase-heartbeat-database",YG=1,Nm="firebase-heartbeat-store";let I2=null;function XN(){return I2||(I2=dG(XG,YG,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Nm)}catch(t){console.warn(t)}}}}).catch(n=>{throw eh.create("idb-open",{originalErrorMessage:n.message})})),I2}async function QG(n){try{const t=(await XN()).transaction(Nm),r=await t.objectStore(Nm).get(YN(n));return await t.done,r}catch(e){if(e instanceof lc)ec.warn(e.message);else{const t=eh.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ec.warn(t.message)}}}async function EC(n,e){try{const r=(await XN()).transaction(Nm,"readwrite");await r.objectStore(Nm).put(e,YN(n)),await r.done}catch(t){if(t instanceof lc)ec.warn(t.message);else{const r=eh.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ec.warn(r.message)}}}function YN(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JG=1024,ZG=30;class e${constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new n$(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=SC();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>ZG){const s=r$(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ec.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=SC(),{heartbeatsToSend:r,unsentEntries:i}=t$(this._heartbeatsCache.heartbeats),o=_0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ec.warn(t),""}}}function SC(){return new Date().toISOString().substring(0,10)}function t$(n,e=JG){const t=[];let r=n.slice();for(const i of n){const o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),AC(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),AC(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class n${constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zH()?WH().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await QG(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return EC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return EC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function AC(n){return _0(JSON.stringify({version:2,heartbeats:n})).length}function r$(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i$(n){Hd(new pf("platform-logger",e=>new gG(e),"PRIVATE")),Hd(new pf("heartbeat",e=>new e$(e),"PRIVATE")),th(Mw,xC,n),th(Mw,xC,"esm2020"),th("fire-js","")}i$("");var o$="firebase",s$="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */th(o$,s$,"app");function QN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const a$=QN,JN=new Zm("auth","Firebase",QN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0=new $x("@firebase/auth");function u$(n,...e){S0.logLevel<=Fn.WARN&&S0.warn(`Auth (${sp}): ${n}`,...e)}function Dv(n,...e){S0.logLevel<=Fn.ERROR&&S0.error(`Auth (${sp}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(n,...e){throw Yx(n,...e)}function hl(n,...e){return Yx(n,...e)}function ZN(n,e,t){const r={...a$(),[e]:t};return new Zm("auth","Firebase",r).create(e,{appName:n.name})}function nh(n){return ZN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Yx(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return JN.create(n,...e)}function cn(n,e,...t){if(!n)throw Yx(e,...t)}function Xl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Dv(e),new Error(e)}function tc(n,e){n||Xl(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bw(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function l$(){return CC()==="http:"||CC()==="https:"}function CC(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c$(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(l$()||BH()||"connection"in navigator)?navigator.onLine:!0}function h$(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(e,t){this.shortDelay=e,this.longDelay=t,tc(t>e,"Short delay should be less than long delay!"),this.isMobile=MH()||VH()}get(){return c$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(n,e){tc(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Xl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Xl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Xl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d$=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],p$=new tg(3e4,6e4);function Af(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function xh(n,e,t,r,i={}){return tR(n,i,async()=>{let o={},s={};r&&(e==="GET"?s=r:o={body:JSON.stringify(r)});const a=eg({key:n.config.apiKey,...s}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const l={method:e,headers:u,...o};return FH()||(l.referrerPolicy="no-referrer"),n.emulatorConfig&&op(n.emulatorConfig.host)&&(l.credentials="include"),eR.fetch()(await nR(n,n.config.apiHost,t,a),l)})}async function tR(n,e,t){n._canInitEmulator=!1;const r={...f$,...e};try{const i=new g$(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw vv(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[u,l]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw vv(n,"credential-already-in-use",s);if(u==="EMAIL_EXISTS")throw vv(n,"email-already-in-use",s);if(u==="USER_DISABLED")throw vv(n,"user-disabled",s);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw ZN(n,h,l);_u(n,h)}}catch(i){if(i instanceof lc)throw i;_u(n,"network-request-failed",{message:String(i)})}}async function u1(n,e,t,r,i={}){const o=await xh(n,e,t,r,i);return"mfaPendingCredential"in o&&_u(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function nR(n,e,t,r){const i=`${e}${t}?${r}`,o=n,s=o.config.emulator?Qx(n.config,i):`${n.config.apiScheme}://${i}`;return d$.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}function m$(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class g${clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(hl(this.auth,"network-request-failed")),p$.get())})}}function vv(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=hl(n,e,r);return i.customData._tokenResponse=t,i}function IC(n){return n!==void 0&&n.enterprise!==void 0}class v${constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return m$(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function y$(n,e){return xh(n,"GET","/v2/recaptchaConfig",Af(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w$(n,e){return xh(n,"POST","/v1/accounts:delete",e)}async function A0(n,e){return xh(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function b$(n,e=!1){const t=ku(n),r=await t.getIdToken(e),i=Jx(r);cn(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:lm(T2(i.auth_time)),issuedAtTime:lm(T2(i.iat)),expirationTime:lm(T2(i.exp)),signInProvider:s||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function T2(n){return Number(n)*1e3}function Jx(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Dv("JWT malformed, contained fewer than 3 sections"),null;try{const i=VN(t);return i?JSON.parse(i):(Dv("Failed to decode base64 JWT payload"),null)}catch(i){return Dv("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function TC(n){const e=Jx(n);return cn(e,"internal-error"),cn(typeof e.exp<"u","internal-error"),cn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rm(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof lc&&x$(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function x$({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=lm(this.lastLoginAt),this.creationTime=lm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C0(n){var d;const e=n.auth,t=await n.getIdToken(),r=await Rm(n,A0(e,{idToken:t}));cn(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const o=(d=i.providerUserInfo)!=null&&d.length?rR(i.providerUserInfo):[],s=S$(n.providerData,o),a=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!(s!=null&&s.length),l=a?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Vw(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(n,h)}async function E$(n){const e=ku(n);await C0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function S$(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function rR(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A$(n,e){const t=await tR(n,{},async()=>{const r=eg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=await nR(n,i,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:a,body:r};return n.emulatorConfig&&op(n.emulatorConfig.host)&&(u.credentials="include"),eR.fetch()(s,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function C$(n,e){return xh(n,"POST","/v2/accounts:revokeToken",Af(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){cn(e.idToken,"internal-error"),cn(typeof e.idToken<"u","internal-error"),cn(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):TC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){cn(e.length!==0,"internal-error");const t=TC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(cn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:o}=await A$(e,t);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:o}=t,s=new Nd;return r&&(cn(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(cn(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(cn(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Nd,this.toJSON())}_performRefresh(){return Xl("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(n,e){cn(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class wu{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new _$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Vw(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Rm(this,this.stsTokenManager.getToken(this.auth,e));return cn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return b$(this,e)}reload(){return E$(this)}_assign(e){this!==e&&(cn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new wu({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){cn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await C0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vu(this.auth.app))return Promise.reject(nh(this.auth));const e=await this.getIdToken();return await Rm(this,w$(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,u=t._redirectEventId??void 0,l=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:d,emailVerified:m,isAnonymous:p,providerData:y,stsTokenManager:b}=t;cn(d&&b,e,"internal-error");const x=Nd.fromJSON(this.name,b);cn(typeof d=="string",e,"internal-error"),Vc(r,e.name),Vc(i,e.name),cn(typeof m=="boolean",e,"internal-error"),cn(typeof p=="boolean",e,"internal-error"),Vc(o,e.name),Vc(s,e.name),Vc(a,e.name),Vc(u,e.name),Vc(l,e.name),Vc(h,e.name);const E=new wu({uid:d,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:p,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:x,createdAt:l,lastLoginAt:h});return y&&Array.isArray(y)&&(E.providerData=y.map(T=>({...T}))),u&&(E._redirectEventId=u),E}static async _fromIdTokenResponse(e,t,r=!1){const i=new Nd;i.updateFromServerResponse(t);const o=new wu({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await C0(o),o}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];cn(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?rR(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),a=new Nd;a.updateFromIdToken(r);const u=new wu({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Vw(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(u,l),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC=new Map;function Yl(n){tc(n instanceof Function,"Expected a class definition");let e=kC.get(n);return e?(tc(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,kC.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}iR.type="NONE";const NC=iR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(n,e,t){return`firebase:${n}:${e}:${t}`}class Rd{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=Lv(this.userKey,i.apiKey,o),this.fullPersistenceKey=Lv("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await A0(this.auth,{idToken:e}).catch(()=>{});return t?wu._fromGetAccountInfoResponse(this.auth,t,e):null}return wu._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Rd(Yl(NC),e,r);const i=(await Promise.all(t.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let o=i[0]||Yl(NC);const s=Lv(r,e.config.apiKey,e.name);let a=null;for(const l of t)try{const h=await l._get(s);if(h){let d;if(typeof h=="string"){const m=await A0(e,{idToken:h}).catch(()=>{});if(!m)break;d=await wu._fromGetAccountInfoResponse(e,m,h)}else d=wu._fromJSON(e,h);l!==o&&(a=d),o=l;break}}catch{}const u=i.filter(l=>l._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new Rd(o,e,r):(o=u[0],a&&await o._set(s,a.toJSON()),await Promise.all(t.map(async l=>{if(l!==o)try{await l._remove(s)}catch{}})),new Rd(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(uR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(oR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(cR(e))return"Blackberry";if(hR(e))return"Webos";if(sR(e))return"Safari";if((e.includes("chrome/")||aR(e))&&!e.includes("edge/"))return"Chrome";if(lR(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function oR(n=ls()){return/firefox\//i.test(n)}function sR(n=ls()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function aR(n=ls()){return/crios\//i.test(n)}function uR(n=ls()){return/iemobile/i.test(n)}function lR(n=ls()){return/android/i.test(n)}function cR(n=ls()){return/blackberry/i.test(n)}function hR(n=ls()){return/webos/i.test(n)}function Zx(n=ls()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function I$(n=ls()){var e;return Zx(n)&&!!((e=window.navigator)!=null&&e.standalone)}function T$(){return jH()&&document.documentMode===10}function fR(n=ls()){return Zx(n)||lR(n)||hR(n)||cR(n)||/windows phone/i.test(n)||uR(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dR(n,e=[]){let t;switch(n){case"Browser":t=RC(ls());break;case"Worker":t=`${RC(ls())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${sp}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k${constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=o=>new Promise((s,a)=>{try{const u=e(o);s(u)}catch(u){a(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N$(n,e={}){return xh(n,"GET","/v2/passwordPolicy",Af(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R$=6;class P${constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??R$,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D${constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new PC(this),this.idTokenSubscription=new PC(this),this.beforeStateQueue=new k$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=JN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yl(t)),this._initializationPromise=this.queue(async()=>{var r,i,o;if(!this._deleted&&(this.persistenceManager=await Rd.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await A0(this,{idToken:e}),r=await wu._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(vu(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=(o=this.redirectUser)==null?void 0:o._redirectEventId,a=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!s||s===a)&&(u!=null&&u.user)&&(r=u.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return cn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await C0(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=h$()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vu(this.app))return Promise.reject(nh(this));const t=e?ku(e):null;return t&&cn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&cn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vu(this.app)?Promise.reject(nh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vu(this.app)?Promise.reject(nh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Yl(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await N$(this),t=new P$(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Zm("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await C$(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Yl(e)||this._popupRedirectResolver;cn(t,this,"argument-error"),this.redirectPersistenceManager=await Rd.create(this,[Yl(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(cn(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{s=!0,u()}}else{const u=e.addObserver(t);return()=>{s=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return cn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=dR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(vu(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&u$(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ap(n){return ku(n)}class PC{constructor(e){this.auth=e,this.observer=null,this.addObserver=KH(t=>this.observer=t)}get next(){return cn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function L$(n){l1=n}function pR(n){return l1.loadJS(n)}function M$(){return l1.recaptchaEnterpriseScript}function O$(){return l1.gapiScript}function F$(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class B${constructor(){this.enterprise=new V$}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class V${ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const j$="recaptcha-enterprise",mR="NO_RECAPTCHA";class U${constructor(e){this.type=j$,this.auth=ap(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(s,a)=>{y$(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const l=new v$(u);return o.tenantId==null?o._agentRecaptchaConfig=l:o._tenantRecaptchaConfigs[o.tenantId]=l,s(l.siteKey)}}).catch(u=>{a(u)})})}function i(o,s,a){const u=window.grecaptcha;IC(u)?u.enterprise.ready(()=>{u.enterprise.execute(o,{action:e}).then(l=>{s(l)}).catch(()=>{s(mR)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new B$().execute("siteKey",{action:"verify"}):new Promise((o,s)=>{r(this.auth).then(a=>{if(!t&&IC(window.grecaptcha))i(a,o,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let u=M$();u.length!==0&&(u+=a),pR(u).then(()=>{i(a,o,s)}).catch(l=>{s(l)})}}).catch(a=>{s(a)})})}}async function DC(n,e,t,r=!1,i=!1){const o=new U$(n);let s;if(i)s=mR;else try{s=await o.verify(t)}catch{s=await o.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const u=a.phoneEnrollmentInfo.phoneNumber,l=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:l,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const u=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function LC(n,e,t,r,i){var o;if((o=n._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await DC(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await DC(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z$(n,e){const t=Xx(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),o=t.getOptions();if(df(o,e??{}))return i;_u(i,"already-initialized")}return t.initialize({options:e})}function W$(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Yl);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function q$(n,e,t){const r=ap(n);cn(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,o=gR(e),{host:s,port:a}=H$(e),u=a===null?"":`:${a}`,l={url:`${o}//${s}${u}/`},h=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){cn(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),cn(df(l,r.config.emulator)&&df(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=l,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,op(s)?(WN(`${o}//${s}${u}`),qN("Auth",!0)):G$()}function gR(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function H$(n){const e=gR(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:MC(r.substr(o.length+1))}}else{const[o,s]=r.split(":");return{host:o,port:MC(s)}}}function MC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function G$(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Xl("not implemented")}_getIdTokenResponse(e){return Xl("not implemented")}_linkToIdToken(e,t){return Xl("not implemented")}_getReauthenticationResolver(e){return Xl("not implemented")}}async function $$(n,e){return xh(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K$(n,e){return u1(n,"POST","/v1/accounts:signInWithPassword",Af(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X$(n,e){return u1(n,"POST","/v1/accounts:signInWithEmailLink",Af(n,e))}async function Y$(n,e){return u1(n,"POST","/v1/accounts:signInWithEmailLink",Af(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm extends e_{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Pm(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Pm(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return LC(e,t,"signInWithPassword",K$);case"emailLink":return X$(e,{email:this._email,oobCode:this._password});default:_u(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return LC(e,r,"signUpPassword",$$);case"emailLink":return Y$(e,{idToken:t,email:this._email,oobCode:this._password});default:_u(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pd(n,e){return u1(n,"POST","/v1/accounts:signInWithIdp",Af(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q$="http://localhost";class mf extends e_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new mf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_u("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...o}=t;if(!r||!i)return null;const s=new mf(r,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const t=this.buildRequest();return Pd(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Pd(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Pd(e,t)}buildRequest(){const e={requestUri:Q$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=eg(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J$(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Z$(n){const e=$p(Kp(n)).link,t=e?$p(Kp(e)).deep_link_id:null,r=$p(Kp(n)).deep_link_id;return(r?$p(Kp(r)).link:null)||r||t||e||n}class t_{constructor(e){const t=$p(Kp(e)),r=t.apiKey??null,i=t.oobCode??null,o=J$(t.mode??null);cn(r&&i&&o,"argument-error"),this.apiKey=r,this.operation=o,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=Z$(e);try{return new t_(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(){this.providerId=up.PROVIDER_ID}static credential(e,t){return Pm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=t_.parseLink(t);return cn(r,"argument-error"),Pm._fromEmailAndCode(e,r.code,r.tenantId)}}up.PROVIDER_ID="password";up.EMAIL_PASSWORD_SIGN_IN_METHOD="password";up.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng extends vR{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc extends ng{constructor(){super("facebook.com")}static credential(e){return mf._fromParams({providerId:Uc.PROVIDER_ID,signInMethod:Uc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uc.credentialFromTaggedObject(e)}static credentialFromError(e){return Uc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uc.credential(e.oauthAccessToken)}catch{return null}}}Uc.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uc.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc extends ng{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return mf._fromParams({providerId:zc.PROVIDER_ID,signInMethod:zc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return zc.credentialFromTaggedObject(e)}static credentialFromError(e){return zc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return zc.credential(t,r)}catch{return null}}}zc.GOOGLE_SIGN_IN_METHOD="google.com";zc.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc extends ng{constructor(){super("github.com")}static credential(e){return mf._fromParams({providerId:Wc.PROVIDER_ID,signInMethod:Wc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wc.credentialFromTaggedObject(e)}static credentialFromError(e){return Wc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wc.credential(e.oauthAccessToken)}catch{return null}}}Wc.GITHUB_SIGN_IN_METHOD="github.com";Wc.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc extends ng{constructor(){super("twitter.com")}static credential(e,t){return mf._fromParams({providerId:qc.PROVIDER_ID,signInMethod:qc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return qc.credentialFromTaggedObject(e)}static credentialFromError(e){return qc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return qc.credential(t,r)}catch{return null}}}qc.TWITTER_SIGN_IN_METHOD="twitter.com";qc.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const o=await wu._fromIdTokenResponse(e,r,i),s=OC(r);return new Gd({user:o,providerId:s,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=OC(r);return new Gd({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function OC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0 extends lc{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,I0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new I0(e,t,r,i)}}function yR(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?I0._fromErrorAndOperation(n,o,e,r):o})}async function eK(n,e,t=!1){const r=await Rm(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Gd._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tK(n,e,t=!1){const{auth:r}=n;if(vu(r.app))return Promise.reject(nh(r));const i="reauthenticate";try{const o=await Rm(n,yR(r,i,e,n),t);cn(o.idToken,r,"internal-error");const s=Jx(o.idToken);cn(s,r,"internal-error");const{sub:a}=s;return cn(n.uid===a,r,"user-mismatch"),Gd._forOperation(n,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&_u(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wR(n,e,t=!1){if(vu(n.app))return Promise.reject(nh(n));const r="signIn",i=await yR(n,r,e),o=await Gd._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(o.user),o}async function nK(n,e){return wR(ap(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rK(n){const e=ap(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function iK(n,e,t){return vu(n.app)?Promise.reject(nh(n)):nK(ku(n),up.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&rK(n),r})}function oK(n,e,t,r){return ku(n).onIdTokenChanged(e,t,r)}function sK(n,e,t){return ku(n).beforeAuthStateChanged(e,t)}function aK(n,e,t,r){return ku(n).onAuthStateChanged(e,t,r)}function uK(n){return ku(n).signOut()}const T0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(T0,"1"),this.storage.removeItem(T0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lK=1e3,cK=10;class xR extends bR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=fR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((s,a,u)=>{this.notifyListeners(s,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(r);!t&&this.localCache[r]===s||this.notifyListeners(r,s)},o=this.storage.getItem(r);T$()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,cK):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},lK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xR.type="LOCAL";const hK=xR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R extends bR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}_R.type="SESSION";const ER=_R;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fK(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new c1(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:o}=t.data,s=this.handlersMap[i];if(!(s!=null&&s.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(s).map(async l=>l(t.origin,o)),u=await fK(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}c1.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dK{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,u)=>{const l=n_("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(d){const m=d;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(m.data.response);break;default:clearTimeout(h),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fl(){return window}function pK(n){fl().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SR(){return typeof fl().WorkerGlobalScope<"u"&&typeof fl().importScripts=="function"}async function mK(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function gK(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function vK(){return SR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AR="firebaseLocalStorageDb",yK=1,k0="firebaseLocalStorage",CR="fbase_key";class rg{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function h1(n,e){return n.transaction([k0],e?"readwrite":"readonly").objectStore(k0)}function wK(){const n=indexedDB.deleteDatabase(AR);return new rg(n).toPromise()}function jw(){const n=indexedDB.open(AR,yK);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(k0,{keyPath:CR})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(k0)?e(r):(r.close(),await wK(),e(await jw()))})})}async function FC(n,e,t){const r=h1(n,!0).put({[CR]:e,value:t});return new rg(r).toPromise()}async function bK(n,e){const t=h1(n,!1).get(e),r=await new rg(t).toPromise();return r===void 0?null:r.value}function BC(n,e){const t=h1(n,!0).delete(e);return new rg(t).toPromise()}const xK=800,_K=3;class IR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await jw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>_K)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return SR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=c1._getInstance(vK()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await mK(),!this.activeServiceWorker)return;this.sender=new dK(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||gK()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jw();return await FC(e,T0,"1"),await BC(e,T0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>FC(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>bK(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>BC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=h1(i,!1).getAll();return new rg(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),xK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IR.type="LOCAL";const EK=IR;new tg(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SK(n,e){return e?Yl(e):(cn(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_ extends e_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Pd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Pd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Pd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function AK(n){return wR(n.auth,new r_(n),n.bypassAuthState)}function CK(n){const{auth:e,user:t}=n;return cn(t,e,"internal-error"),tK(t,new r_(n),n.bypassAuthState)}async function IK(n){const{auth:e,user:t}=n;return cn(t,e,"internal-error"),eK(t,new r_(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return AK;case"linkViaPopup":case"linkViaRedirect":return IK;case"reauthViaPopup":case"reauthViaRedirect":return CK;default:_u(this.auth,"internal-error")}}resolve(e){tc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){tc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TK=new tg(2e3,1e4);class yd extends TR{constructor(e,t,r,i,o){super(e,t,i,o),this.provider=r,this.authWindow=null,this.pollId=null,yd.currentPopupAction&&yd.currentPopupAction.cancel(),yd.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return cn(e,this.auth,"internal-error"),e}async onExecution(){tc(this.filter.length===1,"Popup operations only handle one event");const e=n_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(hl(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(hl(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,yd.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(hl(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,TK.get())};e()}}yd.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kK="pendingRedirect",Mv=new Map;class NK extends TR{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Mv.get(this.auth._key());if(!e){try{const r=await RK(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Mv.set(this.auth._key(),e)}return this.bypassAuthState||Mv.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function RK(n,e){const t=LK(e),r=DK(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function PK(n,e){Mv.set(n._key(),e)}function DK(n){return Yl(n._redirectPersistence)}function LK(n){return Lv(kK,n.config.apiKey,n.name)}async function MK(n,e,t=!1){if(vu(n.app))return Promise.reject(nh(n));const r=ap(n),i=SK(r,e),s=await new NK(r,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OK=600*1e3;class FK{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!BK(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!kR(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(hl(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=OK&&this.cachedEventUids.clear(),this.cachedEventUids.has(VC(e))}saveEventToCache(e){this.cachedEventUids.add(VC(e)),this.lastProcessedEventTime=Date.now()}}function VC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function kR({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function BK(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return kR(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VK(n,e={}){return xh(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jK=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,UK=/^https?/;async function zK(n){if(n.config.emulator)return;const{authorizedDomains:e}=await VK(n);for(const t of e)try{if(WK(t))return}catch{}_u(n,"unauthorized-domain")}function WK(n){const e=Bw(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!UK.test(t))return!1;if(jK.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qK=new tg(3e4,6e4);function jC(){const n=fl().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function HK(n){return new Promise((e,t)=>{var i,o,s;function r(){jC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{jC(),t(hl(n,"network-request-failed"))},timeout:qK.get()})}if((o=(i=fl().gapi)==null?void 0:i.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((s=fl().gapi)!=null&&s.load)r();else{const a=F$("iframefcb");return fl()[a]=()=>{gapi.load?r():t(hl(n,"network-request-failed"))},pR(`${O$()}?onload=${a}`).catch(u=>t(u))}}).catch(e=>{throw Ov=null,e})}let Ov=null;function GK(n){return Ov=Ov||HK(n),Ov}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $K=new tg(5e3,15e3),KK="__/auth/iframe",XK="emulator/auth/iframe",YK={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},QK=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function JK(n){const e=n.config;cn(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qx(e,XK):`https://${n.config.authDomain}/${KK}`,r={apiKey:e.apiKey,appName:n.name,v:sp},i=QK.get(n.config.apiHost);i&&(r.eid=i);const o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${eg(r).slice(1)}`}async function ZK(n){const e=await GK(n),t=fl().gapi;return cn(t,n,"internal-error"),e.open({where:document.body,url:JK(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:YK,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const s=hl(n,"network-request-failed"),a=fl().setTimeout(()=>{o(s)},$K.get());function u(){fl().clearTimeout(a),i(r)}r.ping(u).then(u,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eX={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},tX=500,nX=600,rX="_blank",iX="http://localhost";class UC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oX(n,e,t,r=tX,i=nX){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u={...eX,width:r.toString(),height:i.toString(),top:o,left:s},l=ls().toLowerCase();t&&(a=aR(l)?rX:t),oR(l)&&(e=e||iX,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[p,y])=>`${m}${p}=${y},`,"");if(I$(l)&&a!=="_self")return sX(e||"",a),new UC(null);const d=window.open(e||"",a,h);cn(d,n,"popup-blocked");try{d.focus()}catch{}return new UC(d)}function sX(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aX="__/auth/handler",uX="emulator/auth/handler",lX=encodeURIComponent("fac");async function zC(n,e,t,r,i,o){cn(n.config.authDomain,n,"auth-domain-config-required"),cn(n.config.apiKey,n,"invalid-api-key");const s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:sp,eventId:i};if(e instanceof vR){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",$H(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries({}))s[h]=d}if(e instanceof ng){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(s.scopes=h.join(","))}n.tenantId&&(s.tid=n.tenantId);const a=s;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const u=await n._getAppCheckToken(),l=u?`#${lX}=${encodeURIComponent(u)}`:"";return`${cX(n)}?${eg(a).slice(1)}${l}`}function cX({config:n}){return n.emulator?Qx(n,uX):`https://${n.authDomain}/${aX}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2="webStorageSupport";class hX{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ER,this._completeRedirectFn=MK,this._overrideRedirectResult=PK}async _openPopup(e,t,r,i){var s;tc((s=this.eventManagers[e._key()])==null?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await zC(e,t,r,Bw(),i);return oX(e,o,n_())}async _openRedirect(e,t,r,i){await this._originValidation(e);const o=await zC(e,t,r,Bw(),i);return pK(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(tc(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await ZK(e),r=new FK(e);return t.register("authEvent",i=>(cn(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(k2,{type:k2},i=>{var s;const o=(s=i==null?void 0:i[0])==null?void 0:s[k2];o!==void 0&&t(!!o),_u(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=zK(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return fR()||sR()||Zx()}}const fX=hX;var WC="@firebase/auth",qC="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dX{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){cn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pX(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mX(n){Hd(new pf("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;cn(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:dR(n)},l=new D$(r,i,o,u);return W$(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Hd(new pf("auth-internal",e=>{const t=ap(e.getProvider("auth").getImmediate());return(r=>new dX(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),th(WC,qC,pX(n)),th(WC,qC,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gX=300,vX=zN("authIdTokenMaxAge")||gX;let HC=null;const yX=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>vX)return;const i=t==null?void 0:t.token;HC!==i&&(HC=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function wX(n=KN()){const e=Xx(n,"auth");if(e.isInitialized())return e.getImmediate();const t=z$(n,{popupRedirectResolver:fX,persistence:[EK,hK,ER]}),r=zN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const s=yX(o.toString());sK(t,s,()=>s(t.currentUser)),oK(t,a=>s(a))}}const i=jN("auth");return i&&q$(t,`http://${i}`),t}function bX(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}L$({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const o=hl("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",bX().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mX("Browser");var GC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rh,NR;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(L,I){function A(){}A.prototype=I.prototype,L.F=I.prototype,L.prototype=new A,L.prototype.constructor=L,L.D=function(O,k,M){for(var j=Array(arguments.length-2),X=2;X<arguments.length;X++)j[X-2]=arguments[X];return I.prototype[k].apply(O,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(L,I,A){A||(A=0);const O=Array(16);if(typeof I=="string")for(var k=0;k<16;++k)O[k]=I.charCodeAt(A++)|I.charCodeAt(A++)<<8|I.charCodeAt(A++)<<16|I.charCodeAt(A++)<<24;else for(k=0;k<16;++k)O[k]=I[A++]|I[A++]<<8|I[A++]<<16|I[A++]<<24;I=L.g[0],A=L.g[1],k=L.g[2];let M=L.g[3],j;j=I+(M^A&(k^M))+O[0]+3614090360&4294967295,I=A+(j<<7&4294967295|j>>>25),j=M+(k^I&(A^k))+O[1]+3905402710&4294967295,M=I+(j<<12&4294967295|j>>>20),j=k+(A^M&(I^A))+O[2]+606105819&4294967295,k=M+(j<<17&4294967295|j>>>15),j=A+(I^k&(M^I))+O[3]+3250441966&4294967295,A=k+(j<<22&4294967295|j>>>10),j=I+(M^A&(k^M))+O[4]+4118548399&4294967295,I=A+(j<<7&4294967295|j>>>25),j=M+(k^I&(A^k))+O[5]+1200080426&4294967295,M=I+(j<<12&4294967295|j>>>20),j=k+(A^M&(I^A))+O[6]+2821735955&4294967295,k=M+(j<<17&4294967295|j>>>15),j=A+(I^k&(M^I))+O[7]+4249261313&4294967295,A=k+(j<<22&4294967295|j>>>10),j=I+(M^A&(k^M))+O[8]+1770035416&4294967295,I=A+(j<<7&4294967295|j>>>25),j=M+(k^I&(A^k))+O[9]+2336552879&4294967295,M=I+(j<<12&4294967295|j>>>20),j=k+(A^M&(I^A))+O[10]+4294925233&4294967295,k=M+(j<<17&4294967295|j>>>15),j=A+(I^k&(M^I))+O[11]+2304563134&4294967295,A=k+(j<<22&4294967295|j>>>10),j=I+(M^A&(k^M))+O[12]+1804603682&4294967295,I=A+(j<<7&4294967295|j>>>25),j=M+(k^I&(A^k))+O[13]+4254626195&4294967295,M=I+(j<<12&4294967295|j>>>20),j=k+(A^M&(I^A))+O[14]+2792965006&4294967295,k=M+(j<<17&4294967295|j>>>15),j=A+(I^k&(M^I))+O[15]+1236535329&4294967295,A=k+(j<<22&4294967295|j>>>10),j=I+(k^M&(A^k))+O[1]+4129170786&4294967295,I=A+(j<<5&4294967295|j>>>27),j=M+(A^k&(I^A))+O[6]+3225465664&4294967295,M=I+(j<<9&4294967295|j>>>23),j=k+(I^A&(M^I))+O[11]+643717713&4294967295,k=M+(j<<14&4294967295|j>>>18),j=A+(M^I&(k^M))+O[0]+3921069994&4294967295,A=k+(j<<20&4294967295|j>>>12),j=I+(k^M&(A^k))+O[5]+3593408605&4294967295,I=A+(j<<5&4294967295|j>>>27),j=M+(A^k&(I^A))+O[10]+38016083&4294967295,M=I+(j<<9&4294967295|j>>>23),j=k+(I^A&(M^I))+O[15]+3634488961&4294967295,k=M+(j<<14&4294967295|j>>>18),j=A+(M^I&(k^M))+O[4]+3889429448&4294967295,A=k+(j<<20&4294967295|j>>>12),j=I+(k^M&(A^k))+O[9]+568446438&4294967295,I=A+(j<<5&4294967295|j>>>27),j=M+(A^k&(I^A))+O[14]+3275163606&4294967295,M=I+(j<<9&4294967295|j>>>23),j=k+(I^A&(M^I))+O[3]+4107603335&4294967295,k=M+(j<<14&4294967295|j>>>18),j=A+(M^I&(k^M))+O[8]+1163531501&4294967295,A=k+(j<<20&4294967295|j>>>12),j=I+(k^M&(A^k))+O[13]+2850285829&4294967295,I=A+(j<<5&4294967295|j>>>27),j=M+(A^k&(I^A))+O[2]+4243563512&4294967295,M=I+(j<<9&4294967295|j>>>23),j=k+(I^A&(M^I))+O[7]+1735328473&4294967295,k=M+(j<<14&4294967295|j>>>18),j=A+(M^I&(k^M))+O[12]+2368359562&4294967295,A=k+(j<<20&4294967295|j>>>12),j=I+(A^k^M)+O[5]+4294588738&4294967295,I=A+(j<<4&4294967295|j>>>28),j=M+(I^A^k)+O[8]+2272392833&4294967295,M=I+(j<<11&4294967295|j>>>21),j=k+(M^I^A)+O[11]+1839030562&4294967295,k=M+(j<<16&4294967295|j>>>16),j=A+(k^M^I)+O[14]+4259657740&4294967295,A=k+(j<<23&4294967295|j>>>9),j=I+(A^k^M)+O[1]+2763975236&4294967295,I=A+(j<<4&4294967295|j>>>28),j=M+(I^A^k)+O[4]+1272893353&4294967295,M=I+(j<<11&4294967295|j>>>21),j=k+(M^I^A)+O[7]+4139469664&4294967295,k=M+(j<<16&4294967295|j>>>16),j=A+(k^M^I)+O[10]+3200236656&4294967295,A=k+(j<<23&4294967295|j>>>9),j=I+(A^k^M)+O[13]+681279174&4294967295,I=A+(j<<4&4294967295|j>>>28),j=M+(I^A^k)+O[0]+3936430074&4294967295,M=I+(j<<11&4294967295|j>>>21),j=k+(M^I^A)+O[3]+3572445317&4294967295,k=M+(j<<16&4294967295|j>>>16),j=A+(k^M^I)+O[6]+76029189&4294967295,A=k+(j<<23&4294967295|j>>>9),j=I+(A^k^M)+O[9]+3654602809&4294967295,I=A+(j<<4&4294967295|j>>>28),j=M+(I^A^k)+O[12]+3873151461&4294967295,M=I+(j<<11&4294967295|j>>>21),j=k+(M^I^A)+O[15]+530742520&4294967295,k=M+(j<<16&4294967295|j>>>16),j=A+(k^M^I)+O[2]+3299628645&4294967295,A=k+(j<<23&4294967295|j>>>9),j=I+(k^(A|~M))+O[0]+4096336452&4294967295,I=A+(j<<6&4294967295|j>>>26),j=M+(A^(I|~k))+O[7]+1126891415&4294967295,M=I+(j<<10&4294967295|j>>>22),j=k+(I^(M|~A))+O[14]+2878612391&4294967295,k=M+(j<<15&4294967295|j>>>17),j=A+(M^(k|~I))+O[5]+4237533241&4294967295,A=k+(j<<21&4294967295|j>>>11),j=I+(k^(A|~M))+O[12]+1700485571&4294967295,I=A+(j<<6&4294967295|j>>>26),j=M+(A^(I|~k))+O[3]+2399980690&4294967295,M=I+(j<<10&4294967295|j>>>22),j=k+(I^(M|~A))+O[10]+4293915773&4294967295,k=M+(j<<15&4294967295|j>>>17),j=A+(M^(k|~I))+O[1]+2240044497&4294967295,A=k+(j<<21&4294967295|j>>>11),j=I+(k^(A|~M))+O[8]+1873313359&4294967295,I=A+(j<<6&4294967295|j>>>26),j=M+(A^(I|~k))+O[15]+4264355552&4294967295,M=I+(j<<10&4294967295|j>>>22),j=k+(I^(M|~A))+O[6]+2734768916&4294967295,k=M+(j<<15&4294967295|j>>>17),j=A+(M^(k|~I))+O[13]+1309151649&4294967295,A=k+(j<<21&4294967295|j>>>11),j=I+(k^(A|~M))+O[4]+4149444226&4294967295,I=A+(j<<6&4294967295|j>>>26),j=M+(A^(I|~k))+O[11]+3174756917&4294967295,M=I+(j<<10&4294967295|j>>>22),j=k+(I^(M|~A))+O[2]+718787259&4294967295,k=M+(j<<15&4294967295|j>>>17),j=A+(M^(k|~I))+O[9]+3951481745&4294967295,L.g[0]=L.g[0]+I&4294967295,L.g[1]=L.g[1]+(k+(j<<21&4294967295|j>>>11))&4294967295,L.g[2]=L.g[2]+k&4294967295,L.g[3]=L.g[3]+M&4294967295}r.prototype.v=function(L,I){I===void 0&&(I=L.length);const A=I-this.blockSize,O=this.C;let k=this.h,M=0;for(;M<I;){if(k==0)for(;M<=A;)i(this,L,M),M+=this.blockSize;if(typeof L=="string"){for(;M<I;)if(O[k++]=L.charCodeAt(M++),k==this.blockSize){i(this,O),k=0;break}}else for(;M<I;)if(O[k++]=L[M++],k==this.blockSize){i(this,O),k=0;break}}this.h=k,this.o+=I},r.prototype.A=function(){var L=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);L[0]=128;for(var I=1;I<L.length-8;++I)L[I]=0;I=this.o*8;for(var A=L.length-8;A<L.length;++A)L[A]=I&255,I/=256;for(this.v(L),L=Array(16),I=0,A=0;A<4;++A)for(let O=0;O<32;O+=8)L[I++]=this.g[A]>>>O&255;return L};function o(L,I){var A=a;return Object.prototype.hasOwnProperty.call(A,L)?A[L]:A[L]=I(L)}function s(L,I){this.h=I;const A=[];let O=!0;for(let k=L.length-1;k>=0;k--){const M=L[k]|0;O&&M==I||(A[k]=M,O=!1)}this.g=A}var a={};function u(L){return-128<=L&&L<128?o(L,function(I){return new s([I|0],I<0?-1:0)}):new s([L|0],L<0?-1:0)}function l(L){if(isNaN(L)||!isFinite(L))return d;if(L<0)return x(l(-L));const I=[];let A=1;for(let O=0;L>=A;O++)I[O]=L/A|0,A*=4294967296;return new s(I,0)}function h(L,I){if(L.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(L.charAt(0)=="-")return x(h(L.substring(1),I));if(L.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=l(Math.pow(I,8));let O=d;for(let M=0;M<L.length;M+=8){var k=Math.min(8,L.length-M);const j=parseInt(L.substring(M,M+k),I);k<8?(k=l(Math.pow(I,k)),O=O.j(k).add(l(j))):(O=O.j(A),O=O.add(l(j)))}return O}var d=u(0),m=u(1),p=u(16777216);n=s.prototype,n.m=function(){if(b(this))return-x(this).m();let L=0,I=1;for(let A=0;A<this.g.length;A++){const O=this.i(A);L+=(O>=0?O:4294967296+O)*I,I*=4294967296}return L},n.toString=function(L){if(L=L||10,L<2||36<L)throw Error("radix out of range: "+L);if(y(this))return"0";if(b(this))return"-"+x(this).toString(L);const I=l(Math.pow(L,6));var A=this;let O="";for(;;){const k=C(A,I).g;A=E(A,k.j(I));let M=((A.g.length>0?A.g[0]:A.h)>>>0).toString(L);if(A=k,y(A))return M+O;for(;M.length<6;)M="0"+M;O=M+O}},n.i=function(L){return L<0?0:L<this.g.length?this.g[L]:this.h};function y(L){if(L.h!=0)return!1;for(let I=0;I<L.g.length;I++)if(L.g[I]!=0)return!1;return!0}function b(L){return L.h==-1}n.l=function(L){return L=E(this,L),b(L)?-1:y(L)?0:1};function x(L){const I=L.g.length,A=[];for(let O=0;O<I;O++)A[O]=~L.g[O];return new s(A,~L.h).add(m)}n.abs=function(){return b(this)?x(this):this},n.add=function(L){const I=Math.max(this.g.length,L.g.length),A=[];let O=0;for(let k=0;k<=I;k++){let M=O+(this.i(k)&65535)+(L.i(k)&65535),j=(M>>>16)+(this.i(k)>>>16)+(L.i(k)>>>16);O=j>>>16,M&=65535,j&=65535,A[k]=j<<16|M}return new s(A,A[A.length-1]&-2147483648?-1:0)};function E(L,I){return L.add(x(I))}n.j=function(L){if(y(this)||y(L))return d;if(b(this))return b(L)?x(this).j(x(L)):x(x(this).j(L));if(b(L))return x(this.j(x(L)));if(this.l(p)<0&&L.l(p)<0)return l(this.m()*L.m());const I=this.g.length+L.g.length,A=[];for(var O=0;O<2*I;O++)A[O]=0;for(O=0;O<this.g.length;O++)for(let k=0;k<L.g.length;k++){const M=this.i(O)>>>16,j=this.i(O)&65535,X=L.i(k)>>>16,ue=L.i(k)&65535;A[2*O+2*k]+=j*ue,T(A,2*O+2*k),A[2*O+2*k+1]+=M*ue,T(A,2*O+2*k+1),A[2*O+2*k+1]+=j*X,T(A,2*O+2*k+1),A[2*O+2*k+2]+=M*X,T(A,2*O+2*k+2)}for(L=0;L<I;L++)A[L]=A[2*L+1]<<16|A[2*L];for(L=I;L<2*I;L++)A[L]=0;return new s(A,0)};function T(L,I){for(;(L[I]&65535)!=L[I];)L[I+1]+=L[I]>>>16,L[I]&=65535,I++}function P(L,I){this.g=L,this.h=I}function C(L,I){if(y(I))throw Error("division by zero");if(y(L))return new P(d,d);if(b(L))return I=C(x(L),I),new P(x(I.g),x(I.h));if(b(I))return I=C(L,x(I)),new P(x(I.g),I.h);if(L.g.length>30){if(b(L)||b(I))throw Error("slowDivide_ only works with positive integers.");for(var A=m,O=I;O.l(L)<=0;)A=D(A),O=D(O);var k=z(A,1),M=z(O,1);for(O=z(O,2),A=z(A,2);!y(O);){var j=M.add(O);j.l(L)<=0&&(k=k.add(A),M=j),O=z(O,1),A=z(A,1)}return I=E(L,k.j(I)),new P(k,I)}for(k=d;L.l(I)>=0;){for(A=Math.max(1,Math.floor(L.m()/I.m())),O=Math.ceil(Math.log(A)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),M=l(A),j=M.j(I);b(j)||j.l(L)>0;)A-=O,M=l(A),j=M.j(I);y(M)&&(M=m),k=k.add(M),L=E(L,j)}return new P(k,L)}n.B=function(L){return C(this,L).h},n.and=function(L){const I=Math.max(this.g.length,L.g.length),A=[];for(let O=0;O<I;O++)A[O]=this.i(O)&L.i(O);return new s(A,this.h&L.h)},n.or=function(L){const I=Math.max(this.g.length,L.g.length),A=[];for(let O=0;O<I;O++)A[O]=this.i(O)|L.i(O);return new s(A,this.h|L.h)},n.xor=function(L){const I=Math.max(this.g.length,L.g.length),A=[];for(let O=0;O<I;O++)A[O]=this.i(O)^L.i(O);return new s(A,this.h^L.h)};function D(L){const I=L.g.length+1,A=[];for(let O=0;O<I;O++)A[O]=L.i(O)<<1|L.i(O-1)>>>31;return new s(A,L.h)}function z(L,I){const A=I>>5;I%=32;const O=L.g.length-A,k=[];for(let M=0;M<O;M++)k[M]=I>0?L.i(M+A)>>>I|L.i(M+A+1)<<32-I:L.i(M+A);return new s(k,L.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,NR=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,rh=s}).apply(typeof GC<"u"?GC:typeof self<"u"?self:typeof window<"u"?window:{});var yv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var RR,Xp,PR,Fv,Uw,DR,LR,MR;(function(){var n,e=Object.defineProperty;function t(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof yv=="object"&&yv];for(var B=0;B<w.length;++B){var q=w[B];if(q&&q.Math==Math)return q}throw Error("Cannot find global object")}var r=t(this);function i(w,B){if(B)e:{var q=r;w=w.split(".");for(var ne=0;ne<w.length-1;ne++){var Re=w[ne];if(!(Re in q))break e;q=q[Re]}w=w[w.length-1],ne=q[w],B=B(ne),B!=ne&&B!=null&&e(q,w,{configurable:!0,writable:!0,value:B})}}i("Symbol.dispose",function(w){return w||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(w){return w||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(w){return w||function(B){var q=[],ne;for(ne in B)Object.prototype.hasOwnProperty.call(B,ne)&&q.push([ne,B[ne]]);return q}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},s=this||self;function a(w){var B=typeof w;return B=="object"&&w!=null||B=="function"}function u(w,B,q){return w.call.apply(w.bind,arguments)}function l(w,B,q){return l=u,l.apply(null,arguments)}function h(w,B){var q=Array.prototype.slice.call(arguments,1);return function(){var ne=q.slice();return ne.push.apply(ne,arguments),w.apply(this,ne)}}function d(w,B){function q(){}q.prototype=B.prototype,w.Z=B.prototype,w.prototype=new q,w.prototype.constructor=w,w.Ob=function(ne,Re,je){for(var at=Array(arguments.length-2),on=2;on<arguments.length;on++)at[on-2]=arguments[on];return B.prototype[Re].apply(ne,at)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?w=>w&&AsyncContext.Snapshot.wrap(w):w=>w;function p(w){const B=w.length;if(B>0){const q=Array(B);for(let ne=0;ne<B;ne++)q[ne]=w[ne];return q}return[]}function y(w,B){for(let ne=1;ne<arguments.length;ne++){const Re=arguments[ne];var q=typeof Re;if(q=q!="object"?q:Re?Array.isArray(Re)?"array":q:"null",q=="array"||q=="object"&&typeof Re.length=="number"){q=w.length||0;const je=Re.length||0;w.length=q+je;for(let at=0;at<je;at++)w[q+at]=Re[at]}else w.push(Re)}}class b{constructor(B,q){this.i=B,this.j=q,this.h=0,this.g=null}get(){let B;return this.h>0?(this.h--,B=this.g,this.g=B.next,B.next=null):B=this.i(),B}}function x(w){s.setTimeout(()=>{throw w},0)}function E(){var w=L;let B=null;return w.g&&(B=w.g,w.g=w.g.next,w.g||(w.h=null),B.next=null),B}class T{constructor(){this.h=this.g=null}add(B,q){const ne=P.get();ne.set(B,q),this.h?this.h.next=ne:this.g=ne,this.h=ne}}var P=new b(()=>new C,w=>w.reset());class C{constructor(){this.next=this.g=this.h=null}set(B,q){this.h=B,this.g=q,this.next=null}reset(){this.next=this.g=this.h=null}}let D,z=!1,L=new T,I=()=>{const w=Promise.resolve(void 0);D=()=>{w.then(A)}};function A(){for(var w;w=E();){try{w.h.call(w.g)}catch(q){x(q)}var B=P;B.j(w),B.h<100&&(B.h++,w.next=B.g,B.g=w)}z=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(w,B){this.type=w,this.g=this.target=B,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var w=!1,B=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const q=()=>{};s.addEventListener("test",q,B),s.removeEventListener("test",q,B)}catch{}return w})();function j(w){return/^[\s\xa0]*$/.test(w)}function X(w,B){k.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w&&this.init(w,B)}d(X,k),X.prototype.init=function(w,B){const q=this.type=w.type,ne=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;this.target=w.target||w.srcElement,this.g=B,B=w.relatedTarget,B||(q=="mouseover"?B=w.fromElement:q=="mouseout"&&(B=w.toElement)),this.relatedTarget=B,ne?(this.clientX=ne.clientX!==void 0?ne.clientX:ne.pageX,this.clientY=ne.clientY!==void 0?ne.clientY:ne.pageY,this.screenX=ne.screenX||0,this.screenY=ne.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=w.pointerType,this.state=w.state,this.i=w,w.defaultPrevented&&X.Z.h.call(this)},X.prototype.h=function(){X.Z.h.call(this);const w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var ue="closure_listenable_"+(Math.random()*1e6|0),ge=0;function ce(w,B,q,ne,Re){this.listener=w,this.proxy=null,this.src=B,this.type=q,this.capture=!!ne,this.ha=Re,this.key=++ge,this.da=this.fa=!1}function $(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function ae(w,B,q){for(const ne in w)B.call(q,w[ne],ne,w)}function fe(w,B){for(const q in w)B.call(void 0,w[q],q,w)}function Q(w){const B={};for(const q in w)B[q]=w[q];return B}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(w,B){let q,ne;for(let Re=1;Re<arguments.length;Re++){ne=arguments[Re];for(q in ne)w[q]=ne[q];for(let je=0;je<W.length;je++)q=W[je],Object.prototype.hasOwnProperty.call(ne,q)&&(w[q]=ne[q])}}function te(w){this.src=w,this.g={},this.h=0}te.prototype.add=function(w,B,q,ne,Re){const je=w.toString();w=this.g[je],w||(w=this.g[je]=[],this.h++);const at=ve(w,B,ne,Re);return at>-1?(B=w[at],q||(B.fa=!1)):(B=new ce(B,this.src,je,!!ne,Re),B.fa=q,w.push(B)),B};function de(w,B){const q=B.type;if(q in w.g){var ne=w.g[q],Re=Array.prototype.indexOf.call(ne,B,void 0),je;(je=Re>=0)&&Array.prototype.splice.call(ne,Re,1),je&&($(B),w.g[q].length==0&&(delete w.g[q],w.h--))}}function ve(w,B,q,ne){for(let Re=0;Re<w.length;++Re){const je=w[Re];if(!je.da&&je.listener==B&&je.capture==!!q&&je.ha==ne)return Re}return-1}var we="closure_lm_"+(Math.random()*1e6|0),Se={};function Ie(w,B,q,ne,Re){if(Array.isArray(B)){for(let je=0;je<B.length;je++)Ie(w,B[je],q,ne,Re);return null}return q=gt(q),w&&w[ue]?w.J(B,q,a(ne)?!!ne.capture:!1,Re):Fe(w,B,q,!1,ne,Re)}function Fe(w,B,q,ne,Re,je){if(!B)throw Error("Invalid event type");const at=a(Re)?!!Re.capture:!!Re;let on=rt(w);if(on||(w[we]=on=new te(w)),q=on.add(B,q,ne,at,je),q.proxy)return q;if(ne=Ae(),q.proxy=ne,ne.src=w,ne.listener=q,w.addEventListener)M||(Re=at),Re===void 0&&(Re=!1),w.addEventListener(B.toString(),ne,Re);else if(w.attachEvent)w.attachEvent(tt(B.toString()),ne);else if(w.addListener&&w.removeListener)w.addListener(ne);else throw Error("addEventListener and attachEvent are unavailable.");return q}function Ae(){function w(q){return B.call(w.src,w.listener,q)}const B=re;return w}function Be(w,B,q,ne,Re){if(Array.isArray(B))for(var je=0;je<B.length;je++)Be(w,B[je],q,ne,Re);else ne=a(ne)?!!ne.capture:!!ne,q=gt(q),w&&w[ue]?(w=w.i,je=String(B).toString(),je in w.g&&(B=w.g[je],q=ve(B,q,ne,Re),q>-1&&($(B[q]),Array.prototype.splice.call(B,q,1),B.length==0&&(delete w.g[je],w.h--)))):w&&(w=rt(w))&&(B=w.g[B.toString()],w=-1,B&&(w=ve(B,q,ne,Re)),(q=w>-1?B[w]:null)&&Le(q))}function Le(w){if(typeof w!="number"&&w&&!w.da){var B=w.src;if(B&&B[ue])de(B.i,w);else{var q=w.type,ne=w.proxy;B.removeEventListener?B.removeEventListener(q,ne,w.capture):B.detachEvent?B.detachEvent(tt(q),ne):B.addListener&&B.removeListener&&B.removeListener(ne),(q=rt(B))?(de(q,w),q.h==0&&(q.src=null,B[we]=null)):$(w)}}}function tt(w){return w in Se?Se[w]:Se[w]="on"+w}function re(w,B){if(w.da)w=!0;else{B=new X(B,this);const q=w.listener,ne=w.ha||w.src;w.fa&&Le(w),w=q.call(ne,B)}return w}function rt(w){return w=w[we],w instanceof te?w:null}var zt="__closure_events_fn_"+(Math.random()*1e9>>>0);function gt(w){return typeof w=="function"?w:(w[zt]||(w[zt]=function(B){return w.handleEvent(B)}),w[zt])}function He(){O.call(this),this.i=new te(this),this.M=this,this.G=null}d(He,O),He.prototype[ue]=!0,He.prototype.removeEventListener=function(w,B,q,ne){Be(this,w,B,q,ne)};function ft(w,B){var q,ne=w.G;if(ne)for(q=[];ne;ne=ne.G)q.push(ne);if(w=w.M,ne=B.type||B,typeof B=="string")B=new k(B,w);else if(B instanceof k)B.target=B.target||w;else{var Re=B;B=new k(ne,w),J(B,Re)}Re=!0;let je,at;if(q)for(at=q.length-1;at>=0;at--)je=B.g=q[at],Re=lt(je,ne,!0,B)&&Re;if(je=B.g=w,Re=lt(je,ne,!0,B)&&Re,Re=lt(je,ne,!1,B)&&Re,q)for(at=0;at<q.length;at++)je=B.g=q[at],Re=lt(je,ne,!1,B)&&Re}He.prototype.N=function(){if(He.Z.N.call(this),this.i){var w=this.i;for(const B in w.g){const q=w.g[B];for(let ne=0;ne<q.length;ne++)$(q[ne]);delete w.g[B],w.h--}}this.G=null},He.prototype.J=function(w,B,q,ne){return this.i.add(String(w),B,!1,q,ne)},He.prototype.K=function(w,B,q,ne){return this.i.add(String(w),B,!0,q,ne)};function lt(w,B,q,ne){if(B=w.i.g[String(B)],!B)return!0;B=B.concat();let Re=!0;for(let je=0;je<B.length;++je){const at=B[je];if(at&&!at.da&&at.capture==q){const on=at.listener,gr=at.ha||at.src;at.fa&&de(w.i,at),Re=on.call(gr,ne)!==!1&&Re}}return Re&&!ne.defaultPrevented}function Et(w,B){if(typeof w!="function")if(w&&typeof w.handleEvent=="function")w=l(w.handleEvent,w);else throw Error("Invalid listener argument");return Number(B)>2147483647?-1:s.setTimeout(w,B||0)}function pt(w){w.g=Et(()=>{w.g=null,w.i&&(w.i=!1,pt(w))},w.l);const B=w.h;w.h=null,w.m.apply(null,B)}class En extends O{constructor(B,q){super(),this.m=B,this.l=q,this.h=null,this.i=!1,this.g=null}j(B){this.h=arguments,this.g?this.i=!0:pt(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $t(w){O.call(this),this.h=w,this.g={}}d($t,O);var Qt=[];function an(w){ae(w.g,function(B,q){this.g.hasOwnProperty(q)&&Le(B)},w),w.g={}}$t.prototype.N=function(){$t.Z.N.call(this),an(this)},$t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qt=s.JSON.stringify,vt=s.JSON.parse,en=class{stringify(w){return s.JSON.stringify(w,void 0)}parse(w){return s.JSON.parse(w,void 0)}};function yt(){}function dr(){}var mn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function rn(){k.call(this,"d")}d(rn,k);function un(){k.call(this,"c")}d(un,k);var On={},Ot=null;function Bn(){return Ot=Ot||new He}On.Ia="serverreachability";function Ht(w){k.call(this,On.Ia,w)}d(Ht,k);function Jt(w){const B=Bn();ft(B,new Ht(B))}On.STAT_EVENT="statevent";function jn(w,B){k.call(this,On.STAT_EVENT,w),this.stat=B}d(jn,k);function Dt(w){const B=Bn();ft(B,new jn(B,w))}On.Ja="timingevent";function Gt(w,B){k.call(this,On.Ja,w),this.size=B}d(Gt,k);function Cn(w,B){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){w()},B)}function Mo(){this.g=!0}Mo.prototype.ua=function(){this.g=!1};function ai(w,B,q,ne,Re,je){w.info(function(){if(w.g)if(je){var at="",on=je.split("&");for(let Nn=0;Nn<on.length;Nn++){var gr=on[Nn].split("=");if(gr.length>1){const vr=gr[0];gr=gr[1];const fi=vr.split("_");at=fi.length>=2&&fi[1]=="type"?at+(vr+"="+gr+"&"):at+(vr+"=redacted&")}}}else at=null;else at=je;return"XMLHTTP REQ ("+ne+") [attempt "+Re+"]: "+B+`
`+q+`
`+at})}function As(w,B,q,ne,Re,je,at){w.info(function(){return"XMLHTTP RESP ("+ne+") [ attempt "+Re+"]: "+B+`
`+q+`
`+je+" "+at})}function ui(w,B,q,ne){w.info(function(){return"XMLHTTP TEXT ("+B+"): "+go(w,q)+(ne?" "+ne:"")})}function Kt(w,B){w.info(function(){return"TIMEOUT: "+B})}Mo.prototype.info=function(){};function go(w,B){if(!w.g)return B;if(!B)return null;try{const je=JSON.parse(B);if(je){for(w=0;w<je.length;w++)if(Array.isArray(je[w])){var q=je[w];if(!(q.length<2)){var ne=q[1];if(Array.isArray(ne)&&!(ne.length<1)){var Re=ne[0];if(Re!="noop"&&Re!="stop"&&Re!="close")for(let at=1;at<ne.length;at++)ne[at]=""}}}}return qt(je)}catch{return B}}var Yi={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},li={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},vo;function Xn(){}d(Xn,yt),Xn.prototype.g=function(){return new XMLHttpRequest},vo=new Xn;function or(w){return encodeURIComponent(String(w))}function Rr(w){var B=1;w=w.split(":");const q=[];for(;B>0&&w.length;)q.push(w.shift()),B--;return w.length&&q.push(w.join(":")),q}function Ei(w,B,q,ne){this.j=w,this.i=B,this.l=q,this.S=ne||1,this.V=new $t(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ks}function Ks(){this.i=null,this.g="",this.h=!1}var Oo={},Fo={};function Vr(w,B,q){w.M=1,w.A=Is(Bo(B)),w.u=q,w.R=!0,yo(w,null)}function yo(w,B){w.F=Date.now(),hs(w),w.B=Bo(w.A);var q=w.B,ne=w.S;Array.isArray(ne)||(ne=[String(ne)]),Sl(q.i,"t",ne),w.C=0,q=w.j.L,w.h=new Ks,w.g=wt(w.j,q?B:null,!w.u),w.P>0&&(w.O=new En(l(w.Y,w,w.g),w.P)),B=w.V,q=w.g,ne=w.ba;var Re="readystatechange";Array.isArray(Re)||(Re&&(Qt[0]=Re.toString()),Re=Qt);for(let je=0;je<Re.length;je++){const at=Ie(q,Re[je],ne||B.handleEvent,!1,B.h||B);if(!at)break;B.g[at.key]=at}B=w.J?Q(w.J):{},w.u?(w.v||(w.v="POST"),B["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.B,w.v,w.u,B)):(w.v="GET",w.g.ea(w.B,w.v,null,B)),Jt(),ai(w.i,w.v,w.B,w.l,w.S,w.u)}Ei.prototype.ba=function(w){w=w.target;const B=this.O;B&&jo(w)==3?B.j():this.Y(w)},Ei.prototype.Y=function(w){try{if(w==this.g)e:{const on=jo(this.g),gr=this.g.ya(),Nn=this.g.ca();if(!(on<3)&&(on!=3||this.g&&(this.h.h||this.g.la()||Mu(this.g)))){this.K||on!=4||gr==7||(gr==8||Nn<=0?Jt(3):Jt(2)),Xs(this);var B=this.g.ca();this.X=B;var q=wo(this);if(this.o=B==200,As(this.i,this.v,this.B,this.l,this.S,on,B),this.o){if(this.U&&!this.L){t:{if(this.g){var ne,Re=this.g;if((ne=Re.g?Re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(ne)){var je=ne;break t}}je=null}if(w=je)ui(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Qn(this,w);else{this.o=!1,this.m=3,Dt(12),Ys(this),Cs(this);break e}}if(this.R){w=!0;let vr;for(;!this.K&&this.C<q.length;)if(vr=cs(this,q),vr==Fo){on==4&&(this.m=4,Dt(14),w=!1),ui(this.i,this.l,null,"[Incomplete Response]");break}else if(vr==Oo){this.m=4,Dt(15),ui(this.i,this.l,q,"[Invalid Chunk]"),w=!1;break}else ui(this.i,this.l,vr,null),Qn(this,vr);if(xa(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),on!=4||q.length!=0||this.h.h||(this.m=1,Dt(16),w=!1),this.o=this.o&&w,!w)ui(this.i,this.l,q,"[Invalid Chunked Response]"),Ys(this),Cs(this);else if(q.length>0&&!this.W){this.W=!0;var at=this.j;at.g==this&&at.aa&&!at.P&&(at.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),ka(at),at.P=!0,Dt(11))}}else ui(this.i,this.l,q,null),Qn(this,q);on==4&&Ys(this),this.o&&!this.K&&(on==4?pe(this.j,this):(this.o=!1,hs(this)))}else Ou(this.g),B==400&&q.indexOf("Unknown SID")>0?(this.m=3,Dt(12)):(this.m=0,Dt(13)),Ys(this),Cs(this)}}}catch{}finally{}};function wo(w){if(!xa(w))return w.g.la();const B=Mu(w.g);if(B==="")return"";let q="";const ne=B.length,Re=jo(w.g)==4;if(!w.h.i){if(typeof TextDecoder>"u")return Ys(w),Cs(w),"";w.h.i=new s.TextDecoder}for(let je=0;je<ne;je++)w.h.h=!0,q+=w.h.i.decode(B[je],{stream:!(Re&&je==ne-1)});return B.length=0,w.h.g+=q,w.C=0,w.h.g}function xa(w){return w.g?w.v=="GET"&&w.M!=2&&w.j.Aa:!1}function cs(w,B){var q=w.C,ne=B.indexOf(`
`,q);return ne==-1?Fo:(q=Number(B.substring(q,ne)),isNaN(q)?Oo:(ne+=1,ne+q>B.length?Fo:(B=B.slice(ne,ne+q),w.C=ne+q,B)))}Ei.prototype.cancel=function(){this.K=!0,Ys(this)};function hs(w){w.T=Date.now()+w.H,_a(w,w.H)}function _a(w,B){if(w.D!=null)throw Error("WatchDog timer not null");w.D=Cn(l(w.aa,w),B)}function Xs(w){w.D&&(s.clearTimeout(w.D),w.D=null)}Ei.prototype.aa=function(){this.D=null;const w=Date.now();w-this.T>=0?(Kt(this.i,this.B),this.M!=2&&(Jt(),Dt(17)),Ys(this),this.m=2,Cs(this)):_a(this,this.T-w)};function Cs(w){w.j.I==0||w.K||pe(w.j,w)}function Ys(w){Xs(w);var B=w.O;B&&typeof B.dispose=="function"&&B.dispose(),w.O=null,an(w.V),w.g&&(B=w.g,w.g=null,B.abort(),B.dispose())}function Qn(w,B){try{var q=w.j;if(q.I!=0&&(q.g==w||Nu(q.h,w))){if(!w.L&&Nu(q.h,w)&&q.I==3){try{var ne=q.Ba.g.parse(B)}catch{ne=null}if(Array.isArray(ne)&&ne.length==3){var Re=ne;if(Re[0]==0){e:if(!q.v){if(q.g)if(q.g.F+3e3<w.F)H(q),Bi(q);else break e;to(q),Dt(18)}}else q.xa=Re[1],0<q.xa-q.K&&Re[2]<37500&&q.F&&q.A==0&&!q.C&&(q.C=Cn(l(q.Va,q),6e3));Qs(q.h)<=1&&q.ta&&(q.ta=void 0)}else Ne(q,11)}else if((w.L||q.g==w)&&H(q),!j(B))for(Re=q.Ba.g.parse(B),B=0;B<Re.length;B++){let Nn=Re[B];const vr=Nn[0];if(!(vr<=q.K))if(q.K=vr,Nn=Nn[1],q.I==2)if(Nn[0]=="c"){q.M=Nn[1],q.ba=Nn[2];const fi=Nn[3];fi!=null&&(q.ka=fi,q.j.info("VER="+q.ka));const no=Nn[4];no!=null&&(q.za=no,q.j.info("SVER="+q.za));const yr=Nn[5];yr!=null&&typeof yr=="number"&&yr>0&&(ne=1.5*yr,q.O=ne,q.j.info("backChannelRequestTimeoutMs_="+ne)),ne=q;const ro=w.g;if(ro){const Ps=ro.g?ro.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ps){var je=ne.h;je.g||Ps.indexOf("spdy")==-1&&Ps.indexOf("quic")==-1&&Ps.indexOf("h2")==-1||(je.j=je.l,je.g=new Set,je.h&&(Ea(je,je.h),je.h=null))}if(ne.G){const Za=ro.g?ro.g.getResponseHeader("X-HTTP-Session-Id"):null;Za&&(ne.wa=Za,Tn(ne.J,ne.G,Za))}}q.I=3,q.l&&q.l.ra(),q.aa&&(q.T=Date.now()-w.F,q.j.info("Handshake RTT: "+q.T+"ms")),ne=q;var at=w;if(ne.na=Ze(ne,ne.L?ne.ba:null,ne.W),at.L){Sa(ne.h,at);var on=at,gr=ne.O;gr&&(on.H=gr),on.D&&(Xs(on),hs(on)),ne.g=at}else hi(ne);q.i.length>0&&ms(q)}else Nn[0]!="stop"&&Nn[0]!="close"||Ne(q,7);else q.I==3&&(Nn[0]=="stop"||Nn[0]=="close"?Nn[0]=="stop"?Ne(q,7):ea(q):Nn[0]!="noop"&&q.l&&q.l.qa(Nn),q.A=0)}}Jt(4)}catch{}}var cc=class{constructor(w,B){this.g=w,this.map=B}};function Ka(w){this.l=w||10,s.PerformanceNavigationTiming?(w=s.performance.getEntriesByType("navigation"),w=w.length>0&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qi(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function Qs(w){return w.h?1:w.g?w.g.size:0}function Nu(w,B){return w.h?w.h==B:w.g?w.g.has(B):!1}function Ea(w,B){w.g?w.g.add(B):w.h=B}function Sa(w,B){w.h&&w.h==B?w.h=null:w.g&&w.g.has(B)&&w.g.delete(B)}Ka.prototype.cancel=function(){if(this.i=Ji(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function Ji(w){if(w.h!=null)return w.i.concat(w.h.G);if(w.g!=null&&w.g.size!==0){let B=w.i;for(const q of w.g.values())B=B.concat(q.G);return B}return p(w.i)}var xl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pr(w,B){if(w){w=w.split("&");for(let q=0;q<w.length;q++){const ne=w[q].indexOf("=");let Re,je=null;ne>=0?(Re=w[q].substring(0,ne),je=w[q].substring(ne+1)):Re=w[q],B(Re,je?decodeURIComponent(je.replace(/\+/g," ")):"")}}}function bo(w){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let B;w instanceof bo?(this.l=w.l,pr(this,w.j),this.o=w.o,this.g=w.g,fs(this,w.u),this.h=w.h,Oi(this,Ya(w.i)),this.m=w.m):w&&(B=String(w).match(xl))?(this.l=!1,pr(this,B[1]||"",!0),this.o=Si(B[2]||""),this.g=Si(B[3]||"",!0),fs(this,B[4]),this.h=Si(B[5]||"",!0),Oi(this,B[6]||"",!0),this.m=Si(B[7]||"")):(this.l=!1,this.i=new An(null,this.l))}bo.prototype.toString=function(){const w=[];var B=this.j;B&&w.push(br(B,Ru,!0),":");var q=this.g;return(q||B=="file")&&(w.push("//"),(B=this.o)&&w.push(br(B,Ru,!0),"@"),w.push(or(q).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),q=this.u,q!=null&&w.push(":",String(q))),(q=this.h)&&(this.g&&q.charAt(0)!="/"&&w.push("/"),w.push(br(q,q.charAt(0)=="/"?Xa:_l,!0))),(q=this.i.toString())&&w.push("?",q),(q=this.m)&&w.push("#",br(q,Pu)),w.join("")},bo.prototype.resolve=function(w){const B=Bo(this);let q=!!w.j;q?pr(B,w.j):q=!!w.o,q?B.o=w.o:q=!!w.g,q?B.g=w.g:q=w.u!=null;var ne=w.h;if(q)fs(B,w.u);else if(q=!!w.h){if(ne.charAt(0)!="/")if(this.g&&!this.h)ne="/"+ne;else{var Re=B.h.lastIndexOf("/");Re!=-1&&(ne=B.h.slice(0,Re+1)+ne)}if(Re=ne,Re==".."||Re==".")ne="";else if(Re.indexOf("./")!=-1||Re.indexOf("/.")!=-1){ne=Re.lastIndexOf("/",0)==0,Re=Re.split("/");const je=[];for(let at=0;at<Re.length;){const on=Re[at++];on=="."?ne&&at==Re.length&&je.push(""):on==".."?((je.length>1||je.length==1&&je[0]!="")&&je.pop(),ne&&at==Re.length&&je.push("")):(je.push(on),ne=!0)}ne=je.join("/")}else ne=Re}return q?B.h=ne:q=w.i.toString()!=="",q?Oi(B,Ya(w.i)):q=!!w.m,q&&(B.m=w.m),B};function Bo(w){return new bo(w)}function pr(w,B,q){w.j=q?Si(B,!0):B,w.j&&(w.j=w.j.replace(/:$/,""))}function fs(w,B){if(B){if(B=Number(B),isNaN(B)||B<0)throw Error("Bad port number "+B);w.u=B}else w.u=null}function Oi(w,B,q){B instanceof An?(w.i=B,Zi(w.i,w.l)):(q||(B=br(B,Ts)),w.i=new An(B,w.l))}function Tn(w,B,q){w.i.set(B,q)}function Is(w){return Tn(w,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),w}function Si(w,B){return w?B?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function br(w,B,q){return typeof w=="string"?(w=encodeURI(w).replace(B,ds),q&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function ds(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var Ru=/[#\/\?@]/g,_l=/[#\?:]/g,Xa=/[#\?]/g,Ts=/[#\?@]/g,Pu=/#/g;function An(w,B){this.h=this.g=null,this.i=w||null,this.j=!!B}function xo(w){w.g||(w.g=new Map,w.h=0,w.i&&Pr(w.i,function(B,q){w.add(decodeURIComponent(B.replace(/\+/g," ")),q)}))}n=An.prototype,n.add=function(w,B){xo(this),this.i=null,w=ps(this,w);let q=this.g.get(w);return q||this.g.set(w,q=[]),q.push(B),this.h+=1,this};function Js(w,B){xo(w),B=ps(w,B),w.g.has(B)&&(w.i=null,w.h-=w.g.get(B).length,w.g.delete(B))}function Du(w,B){return xo(w),B=ps(w,B),w.g.has(B)}n.forEach=function(w,B){xo(this),this.g.forEach(function(q,ne){q.forEach(function(Re){w.call(B,Re,ne,this)},this)},this)};function El(w,B){xo(w);let q=[];if(typeof B=="string")Du(w,B)&&(q=q.concat(w.g.get(ps(w,B))));else for(w=Array.from(w.g.values()),B=0;B<w.length;B++)q=q.concat(w[B]);return q}n.set=function(w,B){return xo(this),this.i=null,w=ps(this,w),Du(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[B]),this.h+=1,this},n.get=function(w,B){return w?(w=El(this,w),w.length>0?String(w[0]):B):B};function Sl(w,B,q){Js(w,B),q.length>0&&(w.i=null,w.g.set(ps(w,B),p(q)),w.h+=q.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],B=Array.from(this.g.keys());for(let ne=0;ne<B.length;ne++){var q=B[ne];const Re=or(q);q=El(this,q);for(let je=0;je<q.length;je++){let at=Re;q[je]!==""&&(at+="="+or(q[je])),w.push(at)}}return this.i=w.join("&")};function Ya(w){const B=new An;return B.i=w.i,w.g&&(B.g=new Map(w.g),B.h=w.h),B}function ps(w,B){return B=String(B),w.j&&(B=B.toLowerCase()),B}function Zi(w,B){B&&!w.j&&(xo(w),w.i=null,w.g.forEach(function(q,ne){const Re=ne.toLowerCase();ne!=Re&&(Js(this,ne),Sl(this,Re,q))},w)),w.j=B}function ks(w,B){const q=new Mo;if(s.Image){const ne=new Image;ne.onload=h(jr,q,"TestLoadImage: loaded",!0,B,ne),ne.onerror=h(jr,q,"TestLoadImage: error",!1,B,ne),ne.onabort=h(jr,q,"TestLoadImage: abort",!1,B,ne),ne.ontimeout=h(jr,q,"TestLoadImage: timeout",!1,B,ne),s.setTimeout(function(){ne.ontimeout&&ne.ontimeout()},1e4),ne.src=w}else B(!1)}function eo(w,B){const q=new Mo,ne=new AbortController,Re=setTimeout(()=>{ne.abort(),jr(q,"TestPingServer: timeout",!1,B)},1e4);fetch(w,{signal:ne.signal}).then(je=>{clearTimeout(Re),je.ok?jr(q,"TestPingServer: ok",!0,B):jr(q,"TestPingServer: server error",!1,B)}).catch(()=>{clearTimeout(Re),jr(q,"TestPingServer: error",!1,B)})}function jr(w,B,q,ne,Re){try{Re&&(Re.onload=null,Re.onerror=null,Re.onabort=null,Re.ontimeout=null),ne(q)}catch{}}function Qa(){this.g=new en}function Xt(w){this.i=w.Sb||null,this.h=w.ab||!1}d(Xt,yt),Xt.prototype.g=function(){return new _o(this.i,this.h)};function _o(w,B){He.call(this),this.H=w,this.o=B,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(_o,He),n=_o.prototype,n.open=function(w,B){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=w,this.D=B,this.readyState=1,ci(this)},n.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const B={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};w&&(B.body=w),(this.H||s).fetch(new Request(this.D,B)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Aa(this)),this.readyState=0},n.Pa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,ci(this)),this.g&&(this.readyState=3,ci(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;hc(this)}else w.text().then(this.Oa.bind(this),this.ga.bind(this))};function hc(w){w.j.read().then(w.Ma.bind(w)).catch(w.ga.bind(w))}n.Ma=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var B=w.value?w.value:new Uint8Array(0);(B=this.B.decode(B,{stream:!w.done}))&&(this.response=this.responseText+=B)}w.done?Aa(this):ci(this),this.readyState==3&&hc(this)}},n.Oa=function(w){this.g&&(this.response=this.responseText=w,Aa(this))},n.Na=function(w){this.g&&(this.response=w,Aa(this))},n.ga=function(){this.g&&Aa(this)};function Aa(w){w.readyState=4,w.l=null,w.j=null,w.B=null,ci(w)}n.setRequestHeader=function(w,B){this.A.append(w,B)},n.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],B=this.h.entries();for(var q=B.next();!q.done;)q=q.value,w.push(q[0]+": "+q[1]),q=B.next();return w.join(`\r
`)};function ci(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(_o.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function Ns(w){let B="";return ae(w,function(q,ne){B+=ne,B+=":",B+=q,B+=`\r
`}),B}function Lu(w,B,q){e:{for(ne in q){var ne=!1;break e}ne=!0}ne||(q=Ns(q),typeof w=="string"?q!=null&&or(q):Tn(w,B,q))}function Jn(w){He.call(this),this.headers=new Map,this.L=w||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(Jn,He);var Ja=/^https?$/i,Al=["POST","PUT"];n=Jn.prototype,n.Fa=function(w){this.H=w},n.ea=function(w,B,q,ne){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);B=B?B.toUpperCase():"GET",this.D=w,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():vo.g(),this.g.onreadystatechange=m(l(this.Ca,this));try{this.B=!0,this.g.open(B,String(w),!0),this.B=!1}catch(je){Vo(this,je);return}if(w=q||"",q=new Map(this.headers),ne)if(Object.getPrototypeOf(ne)===Object.prototype)for(var Re in ne)q.set(Re,ne[Re]);else if(typeof ne.keys=="function"&&typeof ne.get=="function")for(const je of ne.keys())q.set(je,ne.get(je));else throw Error("Unknown input type for opt_headers: "+String(ne));ne=Array.from(q.keys()).find(je=>je.toLowerCase()=="content-type"),Re=s.FormData&&w instanceof s.FormData,!(Array.prototype.indexOf.call(Al,B,void 0)>=0)||ne||Re||q.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[je,at]of q)this.g.setRequestHeader(je,at);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(w),this.v=!1}catch(je){Vo(this,je)}};function Vo(w,B){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=B,w.o=5,Ca(w),Zs(w)}function Ca(w){w.A||(w.A=!0,ft(w,"complete"),ft(w,"error"))}n.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=w||7,ft(this,"complete"),ft(this,"abort"),Zs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zs(this,!0)),Jn.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Fi(this):this.Xa())},n.Xa=function(){Fi(this)};function Fi(w){if(w.h&&typeof o<"u"){if(w.v&&jo(w)==4)setTimeout(w.Ca.bind(w),0);else if(ft(w,"readystatechange"),jo(w)==4){w.h=!1;try{const je=w.ca();e:switch(je){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var B=!0;break e;default:B=!1}var q;if(!(q=B)){var ne;if(ne=je===0){let at=String(w.D).match(xl)[1]||null;!at&&s.self&&s.self.location&&(at=s.self.location.protocol.slice(0,-1)),ne=!Ja.test(at?at.toLowerCase():"")}q=ne}if(q)ft(w,"complete"),ft(w,"success");else{w.o=6;try{var Re=jo(w)>2?w.g.statusText:""}catch{Re=""}w.l=Re+" ["+w.ca()+"]",Ca(w)}}finally{Zs(w)}}}}function Zs(w,B){if(w.g){w.m&&(clearTimeout(w.m),w.m=null);const q=w.g;w.g=null,B||ft(w,"ready");try{q.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function jo(w){return w.g?w.g.readyState:0}n.ca=function(){try{return jo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(w){if(this.g){var B=this.g.responseText;return w&&B.indexOf(w)==0&&(B=B.substring(w.length)),vt(B)}};function Mu(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.F){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch{return null}}function Ou(w){const B={};w=(w.g&&jo(w)>=2&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let ne=0;ne<w.length;ne++){if(j(w[ne]))continue;var q=Rr(w[ne]);const Re=q[0];if(q=q[1],typeof q!="string")continue;q=q.trim();const je=B[Re]||[];B[Re]=je,je.push(q)}fe(B,function(ne){return ne.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ai(w,B,q){return q&&q.internalChannelParams&&q.internalChannelParams[w]||B}function Ia(w){this.za=0,this.i=[],this.j=new Mo,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ai("failFast",!1,w),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ai("baseRetryDelayMs",5e3,w),this.Za=Ai("retryDelaySeedMs",1e4,w),this.Ta=Ai("forwardChannelMaxRetries",2,w),this.va=Ai("forwardChannelRequestTimeoutMs",2e4,w),this.ma=w&&w.xmlHttpFactory||void 0,this.Ua=w&&w.Rb||void 0,this.Aa=w&&w.useFetchStreams||!1,this.O=void 0,this.L=w&&w.supportsCrossDomainXhr||!1,this.M="",this.h=new Ka(w&&w.concurrentRequestLimit),this.Ba=new Qa,this.S=w&&w.fastHandshake||!1,this.R=w&&w.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=w&&w.Pb||!1,w&&w.ua&&this.j.ua(),w&&w.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&w&&w.detectBufferingProxy||!1,this.ia=void 0,w&&w.longPollingTimeout&&w.longPollingTimeout>0&&(this.ia=w.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ia.prototype,n.ka=8,n.I=1,n.connect=function(w,B,q,ne){Dt(0),this.W=w,this.H=B||{},q&&ne!==void 0&&(this.H.OSID=q,this.H.OAID=ne),this.F=this.X,this.J=Ze(this,null,this.W),ms(this)};function ea(w){if(Rs(w),w.I==3){var B=w.V++,q=Bo(w.J);if(Tn(q,"SID",w.M),Tn(q,"RID",B),Tn(q,"TYPE","terminate"),Ci(w,q),B=new Ei(w,w.j,B),B.M=2,B.A=Is(Bo(q)),q=!1,s.navigator&&s.navigator.sendBeacon)try{q=s.navigator.sendBeacon(B.A.toString(),"")}catch{}!q&&s.Image&&(new Image().src=B.A,q=!0),q||(B.g=wt(B.j,null),B.g.ea(B.A)),B.F=Date.now(),hs(B)}Xe(w)}function Bi(w){w.g&&(ka(w),w.g.cancel(),w.g=null)}function Rs(w){Bi(w),w.v&&(s.clearTimeout(w.v),w.v=null),H(w),w.h.cancel(),w.m&&(typeof w.m=="number"&&s.clearTimeout(w.m),w.m=null)}function ms(w){if(!Qi(w.h)&&!w.m){w.m=!0;var B=w.Ea;D||I(),z||(D(),z=!0),L.add(B,w),w.D=0}}function Cl(w,B){return Qs(w.h)>=w.h.j-(w.m?1:0)?!1:w.m?(w.i=B.G.concat(w.i),!0):w.I==1||w.I==2||w.D>=(w.Sa?0:w.Ta)?!1:(w.m=Cn(l(w.Ea,w,B),be(w,w.D)),w.D++,!0)}n.Ea=function(w){if(this.m)if(this.m=null,this.I==1){if(!w){this.V=Math.floor(Math.random()*1e5),w=this.V++;const Re=new Ei(this,this.j,w);let je=this.o;if(this.U&&(je?(je=Q(je),J(je,this.U)):je=this.U),this.u!==null||this.R||(Re.J=je,je=null),this.S)e:{for(var B=0,q=0;q<this.i.length;q++){t:{var ne=this.i[q];if("__data__"in ne.map&&(ne=ne.map.__data__,typeof ne=="string")){ne=ne.length;break t}ne=void 0}if(ne===void 0)break;if(B+=ne,B>4096){B=q;break e}if(B===4096||q===this.i.length-1){B=q+1;break e}}B=1e3}else B=1e3;B=gs(this,Re,B),q=Bo(this.J),Tn(q,"RID",w),Tn(q,"CVER",22),this.G&&Tn(q,"X-HTTP-Session-Id",this.G),Ci(this,q),je&&(this.R?B="headers="+or(Ns(je))+"&"+B:this.u&&Lu(q,this.u,je)),Ea(this.h,Re),this.Ra&&Tn(q,"TYPE","init"),this.S?(Tn(q,"$req",B),Tn(q,"SID","null"),Re.U=!0,Vr(Re,q,null)):Vr(Re,q,B),this.I=2}}else this.I==3&&(w?Ta(this,w):this.i.length==0||Qi(this.h)||Ta(this))};function Ta(w,B){var q;B?q=B.l:q=w.V++;const ne=Bo(w.J);Tn(ne,"SID",w.M),Tn(ne,"RID",q),Tn(ne,"AID",w.K),Ci(w,ne),w.u&&w.o&&Lu(ne,w.u,w.o),q=new Ei(w,w.j,q,w.D+1),w.u===null&&(q.J=w.o),B&&(w.i=B.G.concat(w.i)),B=gs(w,q,1e3),q.H=Math.round(w.va*.5)+Math.round(w.va*.5*Math.random()),Ea(w.h,q),Vr(q,ne,B)}function Ci(w,B){w.H&&ae(w.H,function(q,ne){Tn(B,ne,q)}),w.l&&ae({},function(q,ne){Tn(B,ne,q)})}function gs(w,B,q){q=Math.min(w.i.length,q);const ne=w.l?l(w.l.Ka,w.l,w):null;e:{var Re=w.i;let on=-1;for(;;){const gr=["count="+q];on==-1?q>0?(on=Re[0].g,gr.push("ofs="+on)):on=0:gr.push("ofs="+on);let Nn=!0;for(let vr=0;vr<q;vr++){var je=Re[vr].g;const fi=Re[vr].map;if(je-=on,je<0)on=Math.max(0,Re[vr].g-100),Nn=!1;else try{je="req"+je+"_"||"";try{var at=fi instanceof Map?fi:Object.entries(fi);for(const[no,yr]of at){let ro=yr;a(yr)&&(ro=qt(yr)),gr.push(je+no+"="+encodeURIComponent(ro))}}catch(no){throw gr.push(je+"type="+encodeURIComponent("_badmap")),no}}catch{ne&&ne(fi)}}if(Nn){at=gr.join("&");break e}}at=void 0}return w=w.i.splice(0,q),B.G=w,at}function hi(w){if(!w.g&&!w.v){w.Y=1;var B=w.Da;D||I(),z||(D(),z=!0),L.add(B,w),w.A=0}}function to(w){return w.g||w.v||w.A>=3?!1:(w.Y++,w.v=Cn(l(w.Da,w),be(w,w.A)),w.A++,!0)}n.Da=function(){if(this.v=null,N(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var w=4*this.T;this.j.info("BP detection timer enabled: "+w),this.B=Cn(l(this.Wa,this),w)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Dt(10),Bi(this),N(this))};function ka(w){w.B!=null&&(s.clearTimeout(w.B),w.B=null)}function N(w){w.g=new Ei(w,w.j,"rpc",w.Y),w.u===null&&(w.g.J=w.o),w.g.P=0;var B=Bo(w.na);Tn(B,"RID","rpc"),Tn(B,"SID",w.M),Tn(B,"AID",w.K),Tn(B,"CI",w.F?"0":"1"),!w.F&&w.ia&&Tn(B,"TO",w.ia),Tn(B,"TYPE","xmlhttp"),Ci(w,B),w.u&&w.o&&Lu(B,w.u,w.o),w.O&&(w.g.H=w.O);var q=w.g;w=w.ba,q.M=1,q.A=Is(Bo(B)),q.u=null,q.R=!0,yo(q,w)}n.Va=function(){this.C!=null&&(this.C=null,Bi(this),to(this),Dt(19))};function H(w){w.C!=null&&(s.clearTimeout(w.C),w.C=null)}function pe(w,B){var q=null;if(w.g==B){H(w),ka(w),w.g=null;var ne=2}else if(Nu(w.h,B))q=B.G,Sa(w.h,B),ne=1;else return;if(w.I!=0){if(B.o)if(ne==1){q=B.u?B.u.length:0,B=Date.now()-B.F;var Re=w.D;ne=Bn(),ft(ne,new Gt(ne,q)),ms(w)}else hi(w);else if(Re=B.m,Re==3||Re==0&&B.X>0||!(ne==1&&Cl(w,B)||ne==2&&to(w)))switch(q&&q.length>0&&(B=w.h,B.i=B.i.concat(q)),Re){case 1:Ne(w,5);break;case 4:Ne(w,10);break;case 3:Ne(w,6);break;default:Ne(w,2)}}}function be(w,B){let q=w.Qa+Math.floor(Math.random()*w.Za);return w.isActive()||(q*=2),q*B}function Ne(w,B){if(w.j.info("Error code "+B),B==2){var q=l(w.bb,w),ne=w.Ua;const Re=!ne;ne=new bo(ne||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||pr(ne,"https"),Is(ne),Re?ks(ne.toString(),q):eo(ne.toString(),q)}else Dt(2);w.I=0,w.l&&w.l.pa(B),Xe(w),Rs(w)}n.bb=function(w){w?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function Xe(w){if(w.I=0,w.ja=[],w.l){const B=Ji(w.h);(B.length!=0||w.i.length!=0)&&(y(w.ja,B),y(w.ja,w.i),w.h.i.length=0,p(w.i),w.i.length=0),w.l.oa()}}function Ze(w,B,q){var ne=q instanceof bo?Bo(q):new bo(q);if(ne.g!="")B&&(ne.g=B+"."+ne.g),fs(ne,ne.u);else{var Re=s.location;ne=Re.protocol,B=B?B+"."+Re.hostname:Re.hostname,Re=+Re.port;const je=new bo(null);ne&&pr(je,ne),B&&(je.g=B),Re&&fs(je,Re),q&&(je.h=q),ne=je}return q=w.G,B=w.wa,q&&B&&Tn(ne,q,B),Tn(ne,"VER",w.ka),Ci(w,ne),ne}function wt(w,B,q){if(B&&!w.L)throw Error("Can't create secondary domain capable XhrIo object.");return B=w.Aa&&!w.ma?new Jn(new Xt({ab:q})):new Jn(w.ma),B.Fa(w.L),B}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function It(){}n=It.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Zt(){}Zt.prototype.g=function(w,B){return new Ft(w,B)};function Ft(w,B){He.call(this),this.g=new Ia(B),this.l=w,this.h=B&&B.messageUrlParams||null,w=B&&B.messageHeaders||null,B&&B.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=B&&B.initMessageHeaders||null,B&&B.messageContentType&&(w?w["X-WebChannel-Content-Type"]=B.messageContentType:w={"X-WebChannel-Content-Type":B.messageContentType}),B&&B.sa&&(w?w["X-WebChannel-Client-Profile"]=B.sa:w={"X-WebChannel-Client-Profile":B.sa}),this.g.U=w,(w=B&&B.Qb)&&!j(w)&&(this.g.u=w),this.A=B&&B.supportsCrossDomainXhr||!1,this.v=B&&B.sendRawJson||!1,(B=B&&B.httpSessionIdParam)&&!j(B)&&(this.g.G=B,w=this.h,w!==null&&B in w&&(w=this.h,B in w&&delete w[B])),this.j=new sr(this)}d(Ft,He),Ft.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ft.prototype.close=function(){ea(this.g)},Ft.prototype.o=function(w){var B=this.g;if(typeof w=="string"){var q={};q.__data__=w,w=q}else this.v&&(q={},q.__data__=qt(w),w=q);B.i.push(new cc(B.Ya++,w)),B.I==3&&ms(B)},Ft.prototype.N=function(){this.g.l=null,delete this.j,ea(this.g),delete this.g,Ft.Z.N.call(this)};function kn(w){rn.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var B=w.__sm__;if(B){e:{for(const q in B){w=q;break e}w=void 0}(this.i=w)&&(w=this.i,B=B!==null&&w in B?B[w]:void 0),this.data=B}else this.data=w}d(kn,rn);function mr(){un.call(this),this.status=1}d(mr,un);function sr(w){this.g=w}d(sr,It),sr.prototype.ra=function(){ft(this.g,"a")},sr.prototype.qa=function(w){ft(this.g,new kn(w))},sr.prototype.pa=function(w){ft(this.g,new mr)},sr.prototype.oa=function(){ft(this.g,"b")},Zt.prototype.createWebChannel=Zt.prototype.g,Ft.prototype.send=Ft.prototype.o,Ft.prototype.open=Ft.prototype.m,Ft.prototype.close=Ft.prototype.close,MR=function(){return new Zt},LR=function(){return Bn()},DR=On,Uw={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Yi.NO_ERROR=0,Yi.TIMEOUT=8,Yi.HTTP_ERROR=6,Fv=Yi,li.COMPLETE="complete",PR=li,dr.EventType=mn,mn.OPEN="a",mn.CLOSE="b",mn.ERROR="c",mn.MESSAGE="d",He.prototype.listen=He.prototype.J,Xp=dr,Jn.prototype.listenOnce=Jn.prototype.K,Jn.prototype.getLastError=Jn.prototype.Ha,Jn.prototype.getLastErrorCode=Jn.prototype.ya,Jn.prototype.getStatus=Jn.prototype.ca,Jn.prototype.getResponseJson=Jn.prototype.La,Jn.prototype.getResponseText=Jn.prototype.la,Jn.prototype.send=Jn.prototype.ea,Jn.prototype.setWithCredentials=Jn.prototype.Fa,RR=Jn}).apply(typeof yv<"u"?yv:typeof self<"u"?self:typeof window<"u"?window:{});const $C="@firebase/firestore",KC="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ns.UNAUTHENTICATED=new ns(null),ns.GOOGLE_CREDENTIALS=new ns("google-credentials-uid"),ns.FIRST_PARTY=new ns("first-party-uid"),ns.MOCK_USER=new ns("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lp="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gf=new $x("@firebase/firestore");function ud(){return gf.logLevel}function St(n,...e){if(gf.logLevel<=Fn.DEBUG){const t=e.map(i_);gf.debug(`Firestore (${lp}): ${n}`,...t)}}function nc(n,...e){if(gf.logLevel<=Fn.ERROR){const t=e.map(i_);gf.error(`Firestore (${lp}): ${n}`,...t)}}function $d(n,...e){if(gf.logLevel<=Fn.WARN){const t=e.map(i_);gf.warn(`Firestore (${lp}): ${n}`,...t)}}function i_(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,OR(n,r,t)}function OR(n,e,t){let r=`FIRESTORE (${lp}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw nc(r),new Error(r)}function Qr(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||OR(e,i,r)}function Wn(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ht={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Yt extends lc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xX{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ns.UNAUTHENTICATED)))}shutdown(){}}class _X{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class EX{constructor(e){this.t=e,this.currentUser=ns.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Qr(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let o=new Dd;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Dd,e.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const u=o;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},a=u=>{St("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((u=>a(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(St("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Dd)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(St("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Qr(typeof r.accessToken=="string",31837,{l:r}),new FR(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Qr(e===null||typeof e=="string",2055,{h:e}),new ns(e)}}class SX{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=ns.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class AX{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new SX(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ns.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class XC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class CX{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vu(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Qr(this.o===void 0,3512);const r=o=>{o.error!=null&&St("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.m;return this.m=o.token,St("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>r(o)))};const i=o=>{St("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):St("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new XC(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Qr(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new XC(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IX(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=IX(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}}function Vn(n,e){return n<e?-1:n>e?1:0}function zw(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),o=e.charAt(r);if(i!==o)return N2(i)===N2(o)?Vn(i,o):N2(i)?1:-1}return Vn(n.length,e.length)}const TX=55296,kX=57343;function N2(n){const e=n.charCodeAt(0);return e>=TX&&e<=kX}function Kd(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC="__name__";class Ju{constructor(e,t,r){t===void 0?t=0:t>e.length&&_n(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&_n(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ju.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ju?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const o=Ju.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Vn(e.length,t.length)}static compareSegments(e,t){const r=Ju.isNumericId(e),i=Ju.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Ju.extractNumericId(e).compare(Ju.extractNumericId(t)):zw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return rh.fromString(e.substring(4,e.length-2))}}class Kr extends Ju{construct(e,t,r){return new Kr(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Yt(ht.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Kr(t)}static emptyPath(){return new Kr([])}}const NX=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ss extends Ju{construct(e,t,r){return new Ss(e,t,r)}static isValidIdentifier(e){return NX.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ss.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===YC}static keyField(){return new Ss([YC])}static fromServerFormat(e){const t=[];let r="",i=0;const o=()=>{if(r.length===0)throw new Yt(ht.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let s=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Yt(ht.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Yt(ht.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Yt(ht.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ss(t)}static emptyPath(){return new Ss([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.path=e}static fromPath(e){return new hn(Kr.fromString(e))}static fromName(e){return new hn(Kr.fromString(e).popFirst(5))}static empty(){return new hn(Kr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Kr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Kr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new hn(new Kr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RX(n,e,t){if(!t)throw new Yt(ht.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function PX(n,e,t,r){if(e===!0&&r===!0)throw new Yt(ht.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function QC(n){if(hn.isDocumentKey(n))throw new Yt(ht.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function DX(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function LX(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":_n(12329,{type:typeof n})}function Bv(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Yt(ht.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=LX(n);throw new Yt(ht.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(n,e){const t={typeString:n};return e&&(t.value=e),t}function ig(n,e){if(!DX(n))throw new Yt(ht.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const s=n[r];if(i&&typeof s!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new Yt(ht.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC=-62135596800,ZC=1e6;class Pi{static now(){return Pi.fromMillis(Date.now())}static fromDate(e){return Pi.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*ZC);return new Pi(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Yt(ht.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Yt(ht.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<JC)throw new Yt(ht.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Yt(ht.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ZC}_compareTo(e){return this.seconds===e.seconds?Vn(this.nanoseconds,e.nanoseconds):Vn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Pi._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ig(e,Pi._jsonSchema))return new Pi(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-JC;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Pi._jsonSchemaVersion="firestore/timestamp/1.0",Pi._jsonSchema={type:Mi("string",Pi._jsonSchemaVersion),seconds:Mi("number"),nanoseconds:Mi("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{static fromTimestamp(e){return new xn(e)}static min(){return new xn(new Pi(0,0))}static max(){return new xn(new Pi(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dm=-1;function MX(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=xn.fromTimestamp(r===1e9?new Pi(t+1,0):new Pi(t,r));return new hh(i,hn.empty(),e)}function OX(n){return new hh(n.readTime,n.key,Dm)}class hh{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new hh(xn.min(),hn.empty(),Dm)}static max(){return new hh(xn.max(),hn.empty(),Dm)}}function FX(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=hn.comparator(n.documentKey,e.documentKey),t!==0?t:Vn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BX="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class VX{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f1(n){if(n.code!==ht.FAILED_PRECONDITION||n.message!==BX)throw n;St("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_n(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new et(((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof et?t:et.resolve(t)}catch(t){return et.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):et.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):et.reject(t)}static resolve(e){return new et(((t,r)=>{t(e)}))}static reject(e){return new et(((t,r)=>{r(e)}))}static waitFor(e){return new et(((t,r)=>{let i=0,o=0,s=!1;e.forEach((a=>{++i,a.next((()=>{++o,s&&o===i&&t()}),(u=>r(u)))})),s=!0,o===i&&t()}))}static or(e){let t=et.resolve(!1);for(const r of e)t=t.next((i=>i?et.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,o)=>{r.push(t.call(this,i,o))})),this.waitFor(r)}static mapArray(e,t){return new et(((r,i)=>{const o=e.length,s=new Array(o);let a=0;for(let u=0;u<o;u++){const l=u;t(e[l]).next((h=>{s[l]=h,++a,a===o&&r(s)}),(h=>i(h)))}}))}static doWhile(e,t){return new et(((r,i)=>{const o=()=>{e()===!0?t().next((()=>{o()}),i):r()};o()}))}}function jX(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function cp(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}d1.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UX=-1;function p1(n){return n==null}function Ww(n){return n===0&&1/n==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR="";function zX(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=e4(e)),e=WX(n.get(t),e);return e4(e)}function WX(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const o=n.charAt(i);switch(o){case"\0":t+="";break;case VR:t+="";break;default:t+=o}}return t}function e4(n){return n+VR+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t4(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function og(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function qX(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,t){this.comparator=e,this.root=t||Ro.EMPTY}insert(e,t){return new _i(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ro.BLACK,null,null))}remove(e){return new _i(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ro.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wv(this.root,e,this.comparator,!1)}getReverseIterator(){return new wv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wv(this.root,e,this.comparator,!0)}}class wv{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ro{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??Ro.RED,this.left=i??Ro.EMPTY,this.right=o??Ro.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new Ro(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ro.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ro.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ro.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ro.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _n(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _n(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _n(27949);return e+(this.isRed()?0:1)}}Ro.EMPTY=null,Ro.RED=!0,Ro.BLACK=!1;Ro.EMPTY=new class{constructor(){this.size=0}get key(){throw _n(57766)}get value(){throw _n(16141)}get color(){throw _n(16727)}get left(){throw _n(29726)}get right(){throw _n(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new Ro(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e){this.comparator=e,this.data=new _i(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new n4(this.data.getIterator())}getIteratorFrom(e){return new n4(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Gi)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Gi(this.comparator);return t.data=e,t}}class n4{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e){this.fields=e,e.sort(Ss.comparator)}static empty(){return new Kc([])}unionWith(e){let t=new Gi(Ss.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Kc(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Kd(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new jR("Invalid base64 string: "+o):o}})(e);return new Lo(t)}static fromUint8Array(e){const t=(function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o})(e);return new Lo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Vn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Lo.EMPTY_BYTE_STRING=new Lo("");const HX=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fh(n){if(Qr(!!n,39018),typeof n=="string"){let e=0;const t=HX.exec(n);if(Qr(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vi(n.seconds),nanos:vi(n.nanos)}}function vi(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function dh(n){return typeof n=="string"?Lo.fromBase64String(n):Lo.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR="server_timestamp",zR="__type__",WR="__previous_value__",qR="__local_write_time__";function o_(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[zR])==null?void 0:r.stringValue)===UR}function m1(n){const e=n.mapValue.fields[WR];return o_(e)?m1(e):e}function Lm(n){const e=fh(n.mapValue.fields[qR].timestampValue);return new Pi(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GX{constructor(e,t,r,i,o,s,a,u,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l,this.isUsingEmulator=h}}const N0="(default)";class Mm{constructor(e,t){this.projectId=e,this.database=t||N0}static empty(){return new Mm("","")}get isDefaultDatabase(){return this.database===N0}isEqual(e){return e instanceof Mm&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $X="__type__",KX="__max__",bv={mapValue:{}},XX="__vector__",qw="value";function ph(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?o_(n)?4:QX(n)?9007199254740991:YX(n)?10:11:_n(28295,{value:n})}function ml(n,e){if(n===e)return!0;const t=ph(n);if(t!==ph(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Lm(n).isEqual(Lm(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=fh(i.timestampValue),a=fh(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return dh(i.bytesValue).isEqual(dh(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return vi(i.geoPointValue.latitude)===vi(o.geoPointValue.latitude)&&vi(i.geoPointValue.longitude)===vi(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return vi(i.integerValue)===vi(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=vi(i.doubleValue),a=vi(o.doubleValue);return s===a?Ww(s)===Ww(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return Kd(n.arrayValue.values||[],e.arrayValue.values||[],ml);case 10:case 11:return(function(i,o){const s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(t4(s)!==t4(a))return!1;for(const u in s)if(s.hasOwnProperty(u)&&(a[u]===void 0||!ml(s[u],a[u])))return!1;return!0})(n,e);default:return _n(52216,{left:n})}}function Om(n,e){return(n.values||[]).find((t=>ml(t,e)))!==void 0}function Xd(n,e){if(n===e)return 0;const t=ph(n),r=ph(e);if(t!==r)return Vn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Vn(n.booleanValue,e.booleanValue);case 2:return(function(o,s){const a=vi(o.integerValue||o.doubleValue),u=vi(s.integerValue||s.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1})(n,e);case 3:return r4(n.timestampValue,e.timestampValue);case 4:return r4(Lm(n),Lm(e));case 5:return zw(n.stringValue,e.stringValue);case 6:return(function(o,s){const a=dh(o),u=dh(s);return a.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){const a=o.split("/"),u=s.split("/");for(let l=0;l<a.length&&l<u.length;l++){const h=Vn(a[l],u[l]);if(h!==0)return h}return Vn(a.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){const a=Vn(vi(o.latitude),vi(s.latitude));return a!==0?a:Vn(vi(o.longitude),vi(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return i4(n.arrayValue,e.arrayValue);case 10:return(function(o,s){var m,p,y,b;const a=o.fields||{},u=s.fields||{},l=(m=a[qw])==null?void 0:m.arrayValue,h=(p=u[qw])==null?void 0:p.arrayValue,d=Vn(((y=l==null?void 0:l.values)==null?void 0:y.length)||0,((b=h==null?void 0:h.values)==null?void 0:b.length)||0);return d!==0?d:i4(l,h)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===bv.mapValue&&s===bv.mapValue)return 0;if(o===bv.mapValue)return 1;if(s===bv.mapValue)return-1;const a=o.fields||{},u=Object.keys(a),l=s.fields||{},h=Object.keys(l);u.sort(),h.sort();for(let d=0;d<u.length&&d<h.length;++d){const m=zw(u[d],h[d]);if(m!==0)return m;const p=Xd(a[u[d]],l[h[d]]);if(p!==0)return p}return Vn(u.length,h.length)})(n.mapValue,e.mapValue);default:throw _n(23264,{he:t})}}function r4(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Vn(n,e);const t=fh(n),r=fh(e),i=Vn(t.seconds,r.seconds);return i!==0?i:Vn(t.nanos,r.nanos)}function i4(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const o=Xd(t[i],r[i]);if(o)return o}return Vn(t.length,r.length)}function Yd(n){return Hw(n)}function Hw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=fh(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return dh(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return hn.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const o of t.values||[])i?i=!1:r+=",",r+=Hw(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const s of r)o?o=!1:i+=",",i+=`${s}:${Hw(t.fields[s])}`;return i+"}"})(n.mapValue):_n(61005,{value:n})}function Vv(n){switch(ph(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=m1(n);return e?16+Vv(e):16;case 5:return 2*n.stringValue.length;case 6:return dh(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,o)=>i+Vv(o)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return og(r.fields,((o,s)=>{i+=o.length+Vv(s)})),i})(n.mapValue);default:throw _n(13486,{value:n})}}function Gw(n){return!!n&&"integerValue"in n}function s_(n){return!!n&&"arrayValue"in n}function o4(n){return!!n&&"nullValue"in n}function s4(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function R2(n){return!!n&&"mapValue"in n}function YX(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[$X])==null?void 0:r.stringValue)===XX}function cm(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return og(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=cm(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cm(n.arrayValue.values[t]);return e}return{...n}}function QX(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===KX}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e){this.value=e}static empty(){return new nl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!R2(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cm(t)}setAll(e){let t=Ss.emptyPath(),r={},i=[];e.forEach(((s,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=cm(s):i.push(a.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){const t=this.field(e.popLast());R2(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ml(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];R2(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){og(t,((i,o)=>e[i]=o));for(const i of r)delete e[i]}clone(){return new nl(cm(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new is(e,0,xn.min(),xn.min(),xn.min(),nl.empty(),0)}static newFoundDocument(e,t,r,i){return new is(e,1,t,xn.min(),r,i,0)}static newNoDocument(e,t){return new is(e,2,t,xn.min(),xn.min(),nl.empty(),0)}static newUnknownDocument(e,t){return new is(e,3,t,xn.min(),xn.min(),nl.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(xn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof is&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new is(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e,t){this.position=e,this.inclusive=t}}function a4(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const o=e[i],s=n.position[i];if(o.field.isKeyField()?r=hn.comparator(hn.fromName(s.referenceValue),t.key):r=Xd(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function u4(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ml(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,t="asc"){this.field=e,this.dir=t}}function JX(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{}class Wi extends HR{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new eY(e,t,r):t==="array-contains"?new rY(e,r):t==="in"?new iY(e,r):t==="not-in"?new oY(e,r):t==="array-contains-any"?new sY(e,r):new Wi(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new tY(e,r):new nY(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Xd(t,this.value)):t!==null&&ph(this.value)===ph(t)&&this.matchesComparison(Xd(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _n(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gl extends HR{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gl(e,t)}matches(e){return GR(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function GR(n){return n.op==="and"}function $R(n){return ZX(n)&&GR(n)}function ZX(n){for(const e of n.filters)if(e instanceof gl)return!1;return!0}function $w(n){if(n instanceof Wi)return n.field.canonicalString()+n.op.toString()+Yd(n.value);if($R(n))return n.filters.map((e=>$w(e))).join(",");{const e=n.filters.map((t=>$w(t))).join(",");return`${n.op}(${e})`}}function KR(n,e){return n instanceof Wi?(function(r,i){return i instanceof Wi&&r.op===i.op&&r.field.isEqual(i.field)&&ml(r.value,i.value)})(n,e):n instanceof gl?(function(r,i){return i instanceof gl&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((o,s,a)=>o&&KR(s,i.filters[a])),!0):!1})(n,e):void _n(19439)}function XR(n){return n instanceof Wi?(function(t){return`${t.field.canonicalString()} ${t.op} ${Yd(t.value)}`})(n):n instanceof gl?(function(t){return t.op.toString()+" {"+t.getFilters().map(XR).join(" ,")+"}"})(n):"Filter"}class eY extends Wi{constructor(e,t,r){super(e,t,r),this.key=hn.fromName(r.referenceValue)}matches(e){const t=hn.comparator(e.key,this.key);return this.matchesComparison(t)}}class tY extends Wi{constructor(e,t){super(e,"in",t),this.keys=YR("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class nY extends Wi{constructor(e,t){super(e,"not-in",t),this.keys=YR("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function YR(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((r=>hn.fromName(r.referenceValue)))}class rY extends Wi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return s_(t)&&Om(t.arrayValue,this.value)}}class iY extends Wi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Om(this.value.arrayValue,t)}}class oY extends Wi{constructor(e,t){super(e,"not-in",t)}matches(e){if(Om(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Om(this.value.arrayValue,t)}}class sY extends Wi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!s_(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Om(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aY{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}}function l4(n,e=null,t=[],r=[],i=null,o=null,s=null){return new aY(n,e,t,r,i,o,s)}function a_(n){const e=Wn(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>$w(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),p1(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Yd(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Yd(r))).join(",")),e.Te=t}return e.Te}function u_(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!JX(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!KR(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!u4(n.startAt,e.startAt)&&u4(n.endAt,e.endAt)}function Kw(n){return hn.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function uY(n,e,t,r,i,o,s,a){return new g1(n,e,t,r,i,o,s,a)}function l_(n){return new g1(n)}function c4(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lY(n){return n.collectionGroup!==null}function hm(n){const e=Wn(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Gi(Ss.comparator);return s.filters.forEach((u=>{u.getFlattenedFilters().forEach((l=>{l.isInequality()&&(a=a.add(l.field))}))})),a})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new P0(o,r))})),t.has(Ss.keyField().canonicalString())||e.Ie.push(new P0(Ss.keyField(),r))}return e.Ie}function dl(n){const e=Wn(n);return e.Ee||(e.Ee=cY(e,hm(n))),e.Ee}function cY(n,e){if(n.limitType==="F")return l4(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new P0(i.field,o)}));const t=n.endAt?new R0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new R0(n.startAt.position,n.startAt.inclusive):null;return l4(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Xw(n,e,t){return new g1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function v1(n,e){return u_(dl(n),dl(e))&&n.limitType===e.limitType}function QR(n){return`${a_(dl(n))}|lt:${n.limitType}`}function ld(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>XR(i))).join(", ")}]`),p1(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Yd(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Yd(i))).join(",")),`Target(${r})`})(dl(n))}; limitType=${n.limitType})`}function y1(n,e){return e.isFoundDocument()&&(function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):hn.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(const o of hm(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(s,a,u){const l=a4(s,a,u);return s.inclusive?l<=0:l<0})(r.startAt,hm(r),i)||r.endAt&&!(function(s,a,u){const l=a4(s,a,u);return s.inclusive?l>=0:l>0})(r.endAt,hm(r),i))})(n,e)}function hY(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function JR(n){return(e,t)=>{let r=!1;for(const i of hm(n)){const o=fY(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function fY(n,e,t){const r=n.field.isKeyField()?hn.comparator(e.key,t.key):(function(o,s,a){const u=s.data.field(o),l=a.data.field(o);return u!==null&&l!==null?Xd(u,l):_n(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return _n(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){og(this.inner,((t,r)=>{for(const[i,o]of r)e(i,o)}))}isEmpty(){return qX(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dY=new _i(hn.comparator);function mh(){return dY}const ZR=new _i(hn.comparator);function Yp(...n){let e=ZR;for(const t of n)e=e.insert(t.key,t);return e}function pY(n){let e=ZR;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function tf(){return fm()}function eP(){return fm()}function fm(){return new Cf((n=>n.toString()),((n,e)=>n.isEqual(e)))}const mY=new Gi(hn.comparator);function Kn(...n){let e=mY;for(const t of n)e=e.add(t);return e}const gY=new Gi(Vn);function vY(){return gY}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yY(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ww(e)?"-0":e}}function wY(n){return{integerValue:""+n}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(){this._=void 0}}function bY(n,e,t){return n instanceof Yw?(function(i,o){const s={fields:{[zR]:{stringValue:UR},[qR]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&o_(o)&&(o=m1(o)),o&&(s.fields[WR]=o),{mapValue:s}})(t,e):n instanceof D0?tP(n,e):n instanceof L0?nP(n,e):(function(i,o){const s=_Y(i,o),a=h4(s)+h4(i.Ae);return Gw(s)&&Gw(i.Ae)?wY(a):yY(i.serializer,a)})(n,e)}function xY(n,e,t){return n instanceof D0?tP(n,e):n instanceof L0?nP(n,e):t}function _Y(n,e){return n instanceof Qw?(function(r){return Gw(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}class Yw extends w1{}class D0 extends w1{constructor(e){super(),this.elements=e}}function tP(n,e){const t=rP(e);for(const r of n.elements)t.some((i=>ml(i,r)))||t.push(r);return{arrayValue:{values:t}}}class L0 extends w1{constructor(e){super(),this.elements=e}}function nP(n,e){let t=rP(e);for(const r of n.elements)t=t.filter((i=>!ml(i,r)));return{arrayValue:{values:t}}}class Qw extends w1{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function h4(n){return vi(n.integerValue||n.doubleValue)}function rP(n){return s_(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function EY(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof D0&&i instanceof D0||r instanceof L0&&i instanceof L0?Kd(r.elements,i.elements,ml):r instanceof Qw&&i instanceof Qw?ml(r.Ae,i.Ae):r instanceof Yw&&i instanceof Yw})(n.transform,e.transform)}class af{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new af}static exists(e){return new af(void 0,e)}static updateTime(e){return new af(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jv(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class c_{}function iP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new AY(n.key,af.none()):new h_(n.key,n.data,af.none());{const t=n.data,r=nl.empty();let i=new Gi(Ss.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new b1(n.key,r,new Kc(i.toArray()),af.none())}}function SY(n,e,t){n instanceof h_?(function(i,o,s){const a=i.value.clone(),u=d4(i.fieldTransforms,o,s.transformResults);a.setAll(u),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof b1?(function(i,o,s){if(!jv(i.precondition,o))return void o.convertToUnknownDocument(s.version);const a=d4(i.fieldTransforms,o,s.transformResults),u=o.data;u.setAll(oP(i)),u.setAll(a),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()})(n,e,t):(function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function dm(n,e,t,r){return n instanceof h_?(function(o,s,a,u){if(!jv(o.precondition,s))return a;const l=o.value.clone(),h=p4(o.fieldTransforms,u,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null})(n,e,t,r):n instanceof b1?(function(o,s,a,u){if(!jv(o.precondition,s))return a;const l=p4(o.fieldTransforms,u,s),h=s.data;return h.setAll(oP(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((d=>d.field)))})(n,e,t,r):(function(o,s,a){return jv(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function f4(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Kd(r,i,((o,s)=>EY(o,s)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class h_ extends c_{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class b1 extends c_{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function oP(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function d4(n,e,t){const r=new Map;Qr(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,xY(s,a,t[i]))}return r}function p4(n,e,t){const r=new Map;for(const i of n){const o=i.transform,s=t.data.field(i.field);r.set(i.field,bY(o,s,e))}return r}class AY extends c_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CY{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&SY(o,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=dm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=dm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=eP();return this.mutations.forEach((i=>{const o=e.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;const u=iP(s,a);u!==null&&r.set(i.key,u),s.isValidDocument()||s.convertToNoDocument(xn.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Kn())}isEqual(e){return this.batchId===e.batchId&&Kd(this.mutations,e.mutations,((t,r)=>f4(t,r)))&&Kd(this.baseMutations,e.baseMutations,((t,r)=>f4(t,r)))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IY{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TY{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ri,Un;function sP(n){if(n===void 0)return nc("GRPC error has no .code"),ht.UNKNOWN;switch(n){case Ri.OK:return ht.OK;case Ri.CANCELLED:return ht.CANCELLED;case Ri.UNKNOWN:return ht.UNKNOWN;case Ri.DEADLINE_EXCEEDED:return ht.DEADLINE_EXCEEDED;case Ri.RESOURCE_EXHAUSTED:return ht.RESOURCE_EXHAUSTED;case Ri.INTERNAL:return ht.INTERNAL;case Ri.UNAVAILABLE:return ht.UNAVAILABLE;case Ri.UNAUTHENTICATED:return ht.UNAUTHENTICATED;case Ri.INVALID_ARGUMENT:return ht.INVALID_ARGUMENT;case Ri.NOT_FOUND:return ht.NOT_FOUND;case Ri.ALREADY_EXISTS:return ht.ALREADY_EXISTS;case Ri.PERMISSION_DENIED:return ht.PERMISSION_DENIED;case Ri.FAILED_PRECONDITION:return ht.FAILED_PRECONDITION;case Ri.ABORTED:return ht.ABORTED;case Ri.OUT_OF_RANGE:return ht.OUT_OF_RANGE;case Ri.UNIMPLEMENTED:return ht.UNIMPLEMENTED;case Ri.DATA_LOSS:return ht.DATA_LOSS;default:return _n(39323,{code:n})}}(Un=Ri||(Ri={}))[Un.OK=0]="OK",Un[Un.CANCELLED=1]="CANCELLED",Un[Un.UNKNOWN=2]="UNKNOWN",Un[Un.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Un[Un.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Un[Un.NOT_FOUND=5]="NOT_FOUND",Un[Un.ALREADY_EXISTS=6]="ALREADY_EXISTS",Un[Un.PERMISSION_DENIED=7]="PERMISSION_DENIED",Un[Un.UNAUTHENTICATED=16]="UNAUTHENTICATED",Un[Un.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Un[Un.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Un[Un.ABORTED=10]="ABORTED",Un[Un.OUT_OF_RANGE=11]="OUT_OF_RANGE",Un[Un.UNIMPLEMENTED=12]="UNIMPLEMENTED",Un[Un.INTERNAL=13]="INTERNAL",Un[Un.UNAVAILABLE=14]="UNAVAILABLE",Un[Un.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kY(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NY=new rh([4294967295,4294967295],0);function m4(n){const e=kY().encode(n),t=new NR;return t.update(e),new Uint8Array(t.digest())}function g4(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new rh([t,r],0),new rh([i,o],0)]}class f_{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Qp(`Invalid padding: ${t}`);if(r<0)throw new Qp(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Qp(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Qp(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=rh.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(rh.fromNumber(r)));return i.compare(NY)===1&&(i=new rh([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=m4(e),[r,i]=g4(t);for(let o=0;o<this.hashCount;o++){const s=this.ye(r,i,o);if(!this.we(s))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new f_(o,i,t);return r.forEach((a=>s.insert(a))),s}insert(e){if(this.ge===0)return;const t=m4(e),[r,i]=g4(t);for(let o=0;o<this.hashCount;o++){const s=this.ye(r,i,o);this.Se(s)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Qp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,sg.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new x1(xn.min(),i,new _i(Vn),mh(),Kn())}}class sg{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new sg(r,t,Kn(),Kn(),Kn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class aP{constructor(e,t){this.targetId=e,this.Ce=t}}class uP{constructor(e,t,r=Lo.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class v4{constructor(){this.ve=0,this.Fe=y4(),this.Me=Lo.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Kn(),t=Kn(),r=Kn();return this.Fe.forEach(((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:_n(38017,{changeType:o})}})),new sg(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=y4()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Qr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class RY{constructor(e){this.Ge=e,this.ze=new Map,this.je=mh(),this.Je=xv(),this.He=xv(),this.Ye=new _i(Vn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:_n(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const o=i.target;if(Kw(o))if(r===0){const s=new hn(o.path);this.et(t,s,is.newNoDocument(s,xn.min()))}else Qr(r===1,20013,{expectedCount:r});else{const s=this._t(t);if(s!==r){const a=this.ut(e),u=a?this.ct(a,e,s):1;if(u!==0){this.it(t);const l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,l)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t;let s,a;try{s=dh(r).toUint8Array()}catch(u){if(u instanceof jR)return $d("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new f_(s,i,o)}catch(u){return $d(u instanceof Qp?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((o=>{const s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(t,o,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((o,s)=>{const a=this.ot(s);if(a){if(o.current&&Kw(a.target)){const u=new hn(a.target.path);this.It(u).has(s)||this.Et(s,u)||this.et(s,u,is.newNoDocument(u,e))}o.Be&&(t.set(s,o.ke()),o.qe())}}));let r=Kn();this.He.forEach(((o,s)=>{let a=!0;s.forEachWhile((u=>{const l=this.ot(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(r=r.add(o))})),this.je.forEach(((o,s)=>s.setReadTime(e)));const i=new x1(e,t,this.Ye,this.je,r);return this.je=mh(),this.Je=xv(),this.He=xv(),this.Ye=new _i(Vn),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new v4,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Gi(Vn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Gi(Vn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||St("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new v4),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function xv(){return new _i(hn.comparator)}function y4(){return new _i(hn.comparator)}const PY={asc:"ASCENDING",desc:"DESCENDING"},DY={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LY={and:"AND",or:"OR"};class MY{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Jw(n,e){return n.useProto3Json||p1(e)?e:{value:e}}function OY(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function FY(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Ld(n){return Qr(!!n,49232),xn.fromTimestamp((function(t){const r=fh(t);return new Pi(r.seconds,r.nanos)})(n))}function BY(n,e){return Zw(n,e).canonicalString()}function Zw(n,e){const t=(function(i){return new Kr(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function lP(n){const e=Kr.fromString(n);return Qr(pP(e),10190,{key:e.toString()}),e}function P2(n,e){const t=lP(e);if(t.get(1)!==n.databaseId.projectId)throw new Yt(ht.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Yt(ht.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new hn(hP(t))}function cP(n,e){return BY(n.databaseId,e)}function VY(n){const e=lP(n);return e.length===4?Kr.emptyPath():hP(e)}function w4(n){return new Kr(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function hP(n){return Qr(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function jY(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:_n(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(l,h){return l.useProto3Json?(Qr(h===void 0||typeof h=="string",58123),Lo.fromBase64String(h||"")):(Qr(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Lo.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(l){const h=l.code===void 0?ht.UNKNOWN:sP(l.code);return new Yt(h,l.message||"")})(s);t=new uP(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=P2(n,r.document.name),o=Ld(r.document.updateTime),s=r.document.createTime?Ld(r.document.createTime):xn.min(),a=new nl({mapValue:{fields:r.document.fields}}),u=is.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new Uv(l,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=P2(n,r.document),o=r.readTime?Ld(r.readTime):xn.min(),s=is.newNoDocument(i,o),a=r.removedTargetIds||[];t=new Uv([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=P2(n,r.document),o=r.removedTargetIds||[];t=new Uv([],o,i,null)}else{if(!("filter"in e))return _n(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,s=new TY(i,o),a=r.targetId;t=new aP(a,s)}}return t}function UY(n,e){return{documents:[cP(n,e.path)]}}function zY(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=cP(n,i);const o=(function(l){if(l.length!==0)return dP(gl.create(l,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const s=(function(l){if(l.length!==0)return l.map((h=>(function(m){return{field:cd(m.field),direction:HY(m.dir)}})(h)))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=Jw(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{ft:t,parent:i}}function WY(n){let e=VY(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Qr(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=(function(d){const m=fP(d);return m instanceof gl&&$R(m)?m.getFilters():[m]})(t.where));let s=[];t.orderBy&&(s=(function(d){return d.map((m=>(function(y){return new P0(hd(y.field),(function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(m)))})(t.orderBy));let a=null;t.limit&&(a=(function(d){let m;return m=typeof d=="object"?d.value:d,p1(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(d){const m=!!d.before,p=d.values||[];return new R0(p,m)})(t.startAt));let l=null;return t.endAt&&(l=(function(d){const m=!d.before,p=d.values||[];return new R0(p,m)})(t.endAt)),uY(e,i,s,o,a,"F",u,l)}function qY(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _n(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function fP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=hd(t.unaryFilter.field);return Wi.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=hd(t.unaryFilter.field);return Wi.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=hd(t.unaryFilter.field);return Wi.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=hd(t.unaryFilter.field);return Wi.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _n(61313);default:return _n(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Wi.create(hd(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _n(58110);default:return _n(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return gl.create(t.compositeFilter.filters.map((r=>fP(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return _n(1026)}})(t.compositeFilter.op))})(n):_n(30097,{filter:n})}function HY(n){return PY[n]}function GY(n){return DY[n]}function $Y(n){return LY[n]}function cd(n){return{fieldPath:n.canonicalString()}}function hd(n){return Ss.fromServerFormat(n.fieldPath)}function dP(n){return n instanceof Wi?(function(t){if(t.op==="=="){if(s4(t.value))return{unaryFilter:{field:cd(t.field),op:"IS_NAN"}};if(o4(t.value))return{unaryFilter:{field:cd(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(s4(t.value))return{unaryFilter:{field:cd(t.field),op:"IS_NOT_NAN"}};if(o4(t.value))return{unaryFilter:{field:cd(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cd(t.field),op:GY(t.op),value:t.value}}})(n):n instanceof gl?(function(t){const r=t.getFilters().map((i=>dP(i)));return r.length===1?r[0]:{compositeFilter:{op:$Y(t.op),filters:r}}})(n):_n(54877,{filter:n})}function pP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,t,r,i,o=xn.min(),s=xn.min(),a=Lo.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Xc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Xc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KY{constructor(e){this.yt=e}}function XY(n){const e=WY({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xw(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YY{constructor(){this.Cn=new QY}addToCollectionParentIndex(e,t){return this.Cn.add(t),et.resolve()}getCollectionParents(e,t){return et.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return et.resolve()}deleteFieldIndex(e,t){return et.resolve()}deleteAllFieldIndexes(e){return et.resolve()}createTargetIndexes(e,t){return et.resolve()}getDocumentsMatchingTarget(e,t){return et.resolve(null)}getIndexType(e,t){return et.resolve(0)}getFieldIndexes(e,t){return et.resolve([])}getNextCollectionGroupToUpdate(e){return et.resolve(null)}getMinOffset(e,t){return et.resolve(hh.min())}getMinOffsetFromCollectionGroup(e,t){return et.resolve(hh.min())}updateCollectionGroup(e,t,r){return et.resolve()}updateIndexEntries(e,t){return et.resolve()}}class QY{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Gi(Kr.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Gi(Kr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b4={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mP=41943040;class Us{static withCacheSize(e){return new Us(e,Us.DEFAULT_COLLECTION_PERCENTILE,Us.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Us.DEFAULT_COLLECTION_PERCENTILE=10,Us.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Us.DEFAULT=new Us(mP,Us.DEFAULT_COLLECTION_PERCENTILE,Us.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Us.DISABLED=new Us(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Qd(0)}static cr(){return new Qd(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4="LruGarbageCollector",JY=1048576;function _4([n,e],[t,r]){const i=Vn(n,t);return i===0?Vn(e,r):i}class ZY{constructor(e){this.Ir=e,this.buffer=new Gi(_4),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();_4(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class eQ{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){St(x4,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){cp(t)?St(x4,"Ignoring IndexedDB error during garbage collection: ",t):await f1(t)}await this.Vr(3e5)}))}}class tQ{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return et.resolve(d1.ce);const r=new ZY(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(St("LruGarbageCollector","Garbage collection skipped; disabled"),et.resolve(b4)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(St("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),b4):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,o,s,a,u,l;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(St("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,s=Date.now(),this.nthSequenceNumber(e,i)))).next((d=>(r=d,a=Date.now(),this.removeTargets(e,r,t)))).next((d=>(o=d,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((d=>(l=Date.now(),ud()<=Fn.DEBUG&&St("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(l-u)+`ms
Total Duration: ${l-h}ms`),et.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:d}))))}}function nQ(n,e){return new tQ(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rQ{constructor(){this.changes=new Cf((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,is.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?et.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iQ{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oQ{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&dm(r.mutation,i,Kc.empty(),Pi.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Kn()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Kn()){const i=tf();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((o=>{let s=Yp();return o.forEach(((a,u)=>{s=s.insert(a,u.overlayedDocument)})),s}))))}getOverlayedDocuments(e,t){const r=tf();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Kn())))}populateOverlays(e,t,r){const i=[];return r.forEach((o=>{t.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(e,i).next((o=>{o.forEach(((s,a)=>{t.set(s,a)}))}))}computeViews(e,t,r,i){let o=mh();const s=fm(),a=(function(){return fm()})();return t.forEach(((u,l)=>{const h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof b1)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),dm(h.mutation,l,h.mutation.getFieldMask(),Pi.now())):s.set(l.key,Kc.empty())})),this.recalculateAndSaveOverlays(e,o).next((u=>(u.forEach(((l,h)=>s.set(l,h))),t.forEach(((l,h)=>a.set(l,new iQ(h,s.get(l)??null)))),a)))}recalculateAndSaveOverlays(e,t){const r=fm();let i=new _i(((s,a)=>s-a)),o=Kn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((s=>{for(const a of s)a.keys().forEach((u=>{const l=t.get(u);if(l===null)return;let h=r.get(u)||Kc.empty();h=a.applyToLocalView(l,h),r.set(u,h);const d=(i.get(a.batchId)||Kn()).add(u);i=i.insert(a.batchId,d)}))})).next((()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),l=u.key,h=u.value,d=eP();h.forEach((m=>{if(!o.has(m)){const p=iP(t.get(m),r.get(m));p!==null&&d.set(m,p),o=o.add(m)}})),s.push(this.documentOverlayCache.saveOverlays(e,l,d))}return et.waitFor(s)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(s){return hn.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lY(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):et.resolve(tf());let a=Dm,u=o;return s.next((l=>et.forEach(l,((h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),o.get(h)?et.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,l,o))).next((()=>this.computeViews(e,u,l,Kn()))).next((h=>({batchId:a,changes:pY(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new hn(t)).next((r=>{let i=Yp();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const o=t.collectionGroup;let s=Yp();return this.indexManager.getCollectionParents(e,o).next((a=>et.forEach(a,(u=>{const l=(function(d,m){return new g1(m,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(t,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next((h=>{h.forEach(((d,m)=>{s=s.insert(d,m)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i)))).next((s=>{o.forEach(((u,l)=>{const h=l.getKey();s.get(h)===null&&(s=s.insert(h,is.newInvalidDocument(h)))}));let a=Yp();return s.forEach(((u,l)=>{const h=o.get(u);h!==void 0&&dm(h.mutation,l,Kc.empty(),Pi.now()),y1(t,l)&&(a=a.insert(u,l))})),a}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sQ{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return et.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Ld(i.createTime)}})(t)),et.resolve()}getNamedQuery(e,t){return et.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:XY(i.bundledQuery),readTime:Ld(i.readTime)}})(t)),et.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aQ{constructor(){this.overlays=new _i(hn.comparator),this.qr=new Map}getOverlay(e,t){return et.resolve(this.overlays.get(t))}getOverlays(e,t){const r=tf();return et.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&r.set(i,o)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,o)=>{this.St(e,t,o)})),et.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(r)),et.resolve()}getOverlaysForCollection(e,t,r){const i=tf(),o=t.length+1,s=new hn(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&u.largestBatchId>r&&i.set(u.getKey(),u)}return et.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new _i(((l,h)=>l-h));const s=this.overlays.getIterator();for(;s.hasNext();){const l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=tf(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const a=tf(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((l,h)=>a.set(l,h))),!(a.size()>=i)););return et.resolve(a)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new IY(t,r));let o=this.qr.get(t);o===void 0&&(o=Kn(),this.qr.set(t,o)),this.qr.set(t,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uQ{constructor(){this.sessionToken=Lo.EMPTY_BYTE_STRING}getSessionToken(e){return et.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,et.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(){this.Qr=new Gi(ho.$r),this.Ur=new Gi(ho.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new ho(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new ho(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new hn(new Kr([])),r=new ho(t,e),i=new ho(t,e+1),o=[];return this.Ur.forEachInRange([r,i],(s=>{this.Gr(s),o.push(s.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new hn(new Kr([])),r=new ho(t,e),i=new ho(t,e+1);let o=Kn();return this.Ur.forEachInRange([r,i],(s=>{o=o.add(s.key)})),o}containsKey(e){const t=new ho(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ho{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return hn.comparator(e.key,t.key)||Vn(e.Yr,t.Yr)}static Kr(e,t){return Vn(e.Yr,t.Yr)||hn.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lQ{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Gi(ho.$r)}checkEmpty(e){return et.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new CY(o,t,r,i);this.mutationQueue.push(s);for(const a of i)this.Zr=this.Zr.add(new ho(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return et.resolve(s)}lookupMutationBatch(e,t){return et.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),o=i<0?0:i;return et.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return et.resolve(this.mutationQueue.length===0?UX:this.tr-1)}getAllMutationBatches(e){return et.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ho(t,0),i=new ho(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,i],(s=>{const a=this.Xr(s.Yr);o.push(a)})),et.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Gi(Vn);return t.forEach((i=>{const o=new ho(i,0),s=new ho(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,s],(a=>{r=r.add(a.Yr)}))})),et.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let o=r;hn.isDocumentKey(o)||(o=o.child(""));const s=new ho(new hn(o),0);let a=new Gi(Vn);return this.Zr.forEachWhile((u=>{const l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.Yr)),!0)}),s),et.resolve(this.ti(a))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Qr(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return et.forEach(t.mutations,(i=>{const o=new ho(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new ho(t,0),i=this.Zr.firstAfterOrEqual(r);return et.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,et.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cQ{constructor(e){this.ri=e,this.docs=(function(){return new _i(hn.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return et.resolve(r?r.document.mutableCopy():is.newInvalidDocument(t))}getEntries(e,t){let r=mh();return t.forEach((i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():is.newInvalidDocument(i))})),et.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=mh();const s=t.path,a=new hn(s.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:l,value:{document:h}}=u.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||FX(OX(h),r)<=0||(i.has(h.key)||y1(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return et.resolve(o)}getAllFromCollectionGroup(e,t,r,i){_n(9500)}ii(e,t){return et.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new hQ(this)}getSize(e){return et.resolve(this.size)}}class hQ extends rQ{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),et.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fQ{constructor(e){this.persistence=e,this.si=new Cf((t=>a_(t)),u_),this.lastRemoteSnapshotVersion=xn.min(),this.highestTargetId=0,this.oi=0,this._i=new d_,this.targetCount=0,this.ai=Qd.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),et.resolve()}getLastRemoteSnapshotVersion(e){return et.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return et.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),et.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),et.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Qd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,et.resolve()}updateTargetData(e,t){return this.Pr(t),et.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,et.resolve()}removeTargets(e,t,r){let i=0;const o=[];return this.si.forEach(((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.si.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)})),et.waitFor(o).next((()=>i))}getTargetCount(e){return et.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return et.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),et.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach((s=>{o.push(i.markPotentiallyOrphaned(e,s))})),et.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),et.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return et.resolve(r)}containsKey(e,t){return et.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(e,t){this.ui={},this.overlays={},this.ci=new d1(0),this.li=!1,this.li=!0,this.hi=new uQ,this.referenceDelegate=e(this),this.Pi=new fQ(this),this.indexManager=new YY,this.remoteDocumentCache=(function(i){return new cQ(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new KY(t),this.Ii=new sQ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new aQ,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new lQ(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){St("MemoryPersistence","Starting transaction:",e);const i=new dQ(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((o=>this.referenceDelegate.di(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ai(e,t){return et.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class dQ extends VX{constructor(e){super(),this.currentSequenceNumber=e}}class p_{constructor(e){this.persistence=e,this.Ri=new d_,this.Vi=null}static mi(e){return new p_(e)}get fi(){if(this.Vi)return this.Vi;throw _n(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),et.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),et.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),et.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((o=>this.fi.add(o.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return et.forEach(this.fi,(r=>{const i=hn.fromPath(r);return this.gi(e,i).next((o=>{o||t.removeEntry(i,xn.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return et.or([()=>et.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class M0{constructor(e,t){this.persistence=e,this.pi=new Cf((r=>zX(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=nQ(this,t)}static mi(e,t){return new M0(e,t)}Ei(){}di(e){return et.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return et.forEach(this.pi,((r,i)=>this.br(e,r,i).next((o=>o?et.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,(s=>this.br(e,s,t).next((a=>{a||(r++,o.removeEntry(s,xn.min()))})))).next((()=>o.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),et.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),et.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),et.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),et.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Vv(e.data.value)),t}br(e,t,r){return et.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return et.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=Kn(),i=Kn();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new m_(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pQ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mQ{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return UH()?8:jX(ls())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const o={result:null};return this.ys(e,t).next((s=>{o.result=s})).next((()=>{if(!o.result)return this.ws(e,t,i,r).next((s=>{o.result=s}))})).next((()=>{if(o.result)return;const s=new pQ;return this.Ss(e,t,s).next((a=>{if(o.result=a,this.Vs)return this.bs(e,t,s,a.size)}))})).next((()=>o.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(ud()<=Fn.DEBUG&&St("QueryEngine","SDK will not create cache indexes for query:",ld(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),et.resolve()):(ud()<=Fn.DEBUG&&St("QueryEngine","Query:",ld(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(ud()<=Fn.DEBUG&&St("QueryEngine","The SDK decides to create cache indexes for query:",ld(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dl(t))):et.resolve())}ys(e,t){if(c4(t))return et.resolve(null);let r=dl(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Xw(t,null,"F"),r=dl(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((o=>{const s=Kn(...o);return this.ps.getDocuments(e,s).next((a=>this.indexManager.getMinOffset(e,r).next((u=>{const l=this.Ds(t,a);return this.Cs(t,l,s,u.readTime)?this.ys(e,Xw(t,null,"F")):this.vs(e,l,t,u)}))))})))))}ws(e,t,r,i){return c4(t)||i.isEqual(xn.min())?et.resolve(null):this.ps.getDocuments(e,r).next((o=>{const s=this.Ds(t,o);return this.Cs(t,s,r,i)?et.resolve(null):(ud()<=Fn.DEBUG&&St("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ld(t)),this.vs(e,s,t,MX(i,Dm)).next((a=>a)))}))}Ds(e,t){let r=new Gi(JR(e));return t.forEach(((i,o)=>{y1(e,o)&&(r=r.add(o))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,t,r){return ud()<=Fn.DEBUG&&St("QueryEngine","Using full collection scan to execute query:",ld(t)),this.ps.getDocumentsMatchingQuery(e,t,hh.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((o=>(t.forEach((s=>{o=o.insert(s.key,s)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g_="LocalStore",gQ=3e8;class vQ{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new _i(Vn),this.xs=new Cf((o=>a_(o)),u_),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oQ(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function yQ(n,e,t,r){return new vQ(n,e,t,r)}async function vP(n,e){const t=Wn(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((o=>(i=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((o=>{const s=[],a=[];let u=Kn();for(const l of i){s.push(l.batchId);for(const h of l.mutations)u=u.add(h.key)}for(const l of o){a.push(l.batchId);for(const h of l.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((l=>({Ls:l,removedBatchIds:s,addedBatchIds:a})))}))}))}function yP(n){const e=Wn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function wQ(n,e){const t=Wn(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const s=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const a=[];e.targetChanges.forEach(((h,d)=>{const m=i.get(d);if(!m)return;a.push(t.Pi.removeMatchingKeys(o,h.removedDocuments,d).next((()=>t.Pi.addMatchingKeys(o,h.addedDocuments,d))));let p=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(Lo.EMPTY_BYTE_STRING,xn.min()).withLastLimboFreeSnapshotVersion(xn.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,r)),i=i.insert(d,p),(function(b,x,E){return b.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=gQ?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0})(m,p,h)&&a.push(t.Pi.updateTargetData(o,p))}));let u=mh(),l=Kn();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))})),a.push(bQ(o,s,e.documentUpdates).next((h=>{u=h.ks,l=h.qs}))),!r.isEqual(xn.min())){const h=t.Pi.getLastRemoteSnapshotVersion(o).next((d=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r)));a.push(h)}return et.waitFor(a).next((()=>s.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,u,l))).next((()=>u))})).then((o=>(t.Ms=i,o)))}function bQ(n,e,t){let r=Kn(),i=Kn();return t.forEach((o=>r=r.add(o))),e.getEntries(n,r).next((o=>{let s=mh();return t.forEach(((a,u)=>{const l=o.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(xn.min())?(e.removeEntry(a,u.readTime),s=s.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),s=s.insert(a,u)):St(g_,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)})),{ks:s,qs:i}}))}function xQ(n,e){const t=Wn(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((o=>o?(i=o,et.resolve(i)):t.Pi.allocateTargetId(r).next((s=>(i=new Xc(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function eb(n,e,t){const r=Wn(n),i=r.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,(s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!cp(s))throw s;St(g_,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function E4(n,e,t){const r=Wn(n);let i=xn.min(),o=Kn();return r.persistence.runTransaction("Execute query","readwrite",(s=>(function(u,l,h){const d=Wn(u),m=d.xs.get(h);return m!==void 0?et.resolve(d.Ms.get(m)):d.Pi.getTargetData(l,h)})(r,s,dl(e)).next((a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(s,a.targetId).next((u=>{o=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(s,e,t?i:xn.min(),t?o:Kn()))).next((a=>(_Q(r,hY(e),a),{documents:a,Qs:o})))))}function _Q(n,e,t){let r=n.Os.get(e)||xn.min();t.forEach(((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),n.Os.set(e,r)}class S4{constructor(){this.activeTargetIds=vY()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class EQ{constructor(){this.Mo=new S4,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new S4,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SQ{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4="ConnectivityMonitor";class C4{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){St(A4,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){St(A4,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _v=null;function tb(){return _v===null?_v=(function(){return 268435456+Math.round(2147483648*Math.random())})():_v++,"0x"+_v.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D2="RestConnection",AQ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class CQ{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===N0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,o){const s=tb(),a=this.zo(e,t.toUriEncodedString());St(D2,`Sending RPC '${e}' ${s}:`,a,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,o);const{host:l}=new URL(a),h=op(l);return this.Jo(e,a,u,r,h).then((d=>(St(D2,`Received RPC '${e}' ${s}: `,d),d)),(d=>{throw $d(D2,`RPC '${e}' ${s} failed with error: `,d,"url: ",a,"request:",r),d}))}Ho(e,t,r,i,o,s){return this.Go(e,t,r,i,o)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+lp})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,o)=>e[o]=i)),r&&r.headers.forEach(((i,o)=>e[o]=i))}zo(e,t){const r=AQ[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IQ{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo="WebChannelConnection";class TQ extends CQ{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,o){const s=tb();return new Promise(((a,u)=>{const l=new RR;l.setWithCredentials(!0),l.listenOnce(PR.COMPLETE,(()=>{try{switch(l.getLastErrorCode()){case Fv.NO_ERROR:const d=l.getResponseJson();St(Zo,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),a(d);break;case Fv.TIMEOUT:St(Zo,`RPC '${e}' ${s} timed out`),u(new Yt(ht.DEADLINE_EXCEEDED,"Request time out"));break;case Fv.HTTP_ERROR:const m=l.getStatus();if(St(Zo,`RPC '${e}' ${s} failed with status:`,m,"response text:",l.getResponseText()),m>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const y=p==null?void 0:p.error;if(y&&y.status&&y.message){const b=(function(E){const T=E.toLowerCase().replace(/_/g,"-");return Object.values(ht).indexOf(T)>=0?T:ht.UNKNOWN})(y.status);u(new Yt(b,y.message))}else u(new Yt(ht.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new Yt(ht.UNAVAILABLE,"Connection failed."));break;default:_n(9055,{l_:e,streamId:s,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{St(Zo,`RPC '${e}' ${s} completed.`)}}));const h=JSON.stringify(i);St(Zo,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=tb(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=MR(),a=LR(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=o.join("");St(Zo,`Creating RPC '${e}' stream ${i}: ${h}`,u);const d=s.createWebChannel(h,u);this.I_(d);let m=!1,p=!1;const y=new IQ({Yo:x=>{p?St(Zo,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(m||(St(Zo,`Opening RPC '${e}' stream ${i} transport.`),d.open(),m=!0),St(Zo,`RPC '${e}' stream ${i} sending:`,x),d.send(x))},Zo:()=>d.close()}),b=(x,E,T)=>{x.listen(E,(P=>{try{T(P)}catch(C){setTimeout((()=>{throw C}),0)}}))};return b(d,Xp.EventType.OPEN,(()=>{p||(St(Zo,`RPC '${e}' stream ${i} transport opened.`),y.o_())})),b(d,Xp.EventType.CLOSE,(()=>{p||(p=!0,St(Zo,`RPC '${e}' stream ${i} transport closed`),y.a_(),this.E_(d))})),b(d,Xp.EventType.ERROR,(x=>{p||(p=!0,$d(Zo,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),y.a_(new Yt(ht.UNAVAILABLE,"The operation could not be completed")))})),b(d,Xp.EventType.MESSAGE,(x=>{var E;if(!p){const T=x.data[0];Qr(!!T,16349);const P=T,C=(P==null?void 0:P.error)||((E=P[0])==null?void 0:E.error);if(C){St(Zo,`RPC '${e}' stream ${i} received error:`,C);const D=C.status;let z=(function(A){const O=Ri[A];if(O!==void 0)return sP(O)})(D),L=C.message;z===void 0&&(z=ht.INTERNAL,L="Unknown error status: "+D+" with message "+C.message),p=!0,y.a_(new Yt(z,L)),d.close()}else St(Zo,`RPC '${e}' stream ${i} received:`,T),y.u_(T)}})),b(a,DR.STAT_EVENT,(x=>{x.stat===Uw.PROXY?St(Zo,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===Uw.NOPROXY&&St(Zo,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function L2(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(n){return new MY(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&St("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4="PersistentStream";class kQ{constructor(e,t,r,i,o,s,a,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new bP(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ht.RESOURCE_EXHAUSTED?(nc(t.toString()),nc("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ht.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Yt(ht.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return St(I4,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(St(I4,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class NQ extends kQ{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=jY(this.serializer,e),r=(function(o){if(!("targetChange"in o))return xn.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?xn.min():s.readTime?Ld(s.readTime):xn.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=w4(this.serializer),t.addTarget=(function(o,s){let a;const u=s.target;if(a=Kw(u)?{documents:UY(o,u)}:{query:zY(o,u).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=FY(o,s.resumeToken);const l=Jw(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(xn.min())>0){a.readTime=OY(o,s.snapshotVersion.toTimestamp());const l=Jw(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a})(this.serializer,e);const r=qY(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=w4(this.serializer),t.removeTarget=e,this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RQ{}class PQ extends RQ{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Yt(ht.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,s])=>this.connection.Go(e,Zw(t,r),i,o,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ht.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Yt(ht.UNKNOWN,o.toString())}))}Ho(e,t,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Ho(e,Zw(t,r),i,s,a,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ht.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Yt(ht.UNKNOWN,s.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class DQ{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(nc(t),this.aa=!1):St("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd="RemoteStore";class LQ{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((s=>{r.enqueueAndForget((async()=>{ug(this)&&(St(Jd,"Restarting streams for network reachability change."),await(async function(u){const l=Wn(u);l.Ea.add(4),await ag(l),l.Ra.set("Unknown"),l.Ea.delete(4),await _1(l)})(this))}))})),this.Ra=new DQ(r,i)}}async function _1(n){if(ug(n))for(const e of n.da)await e(!0)}async function ag(n){for(const e of n.da)await e(!1)}function xP(n,e){const t=Wn(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),b_(t)?w_(t):hp(t).O_()&&y_(t,e))}function v_(n,e){const t=Wn(n),r=hp(t);t.Ia.delete(e),r.O_()&&_P(t,e),t.Ia.size===0&&(r.O_()?r.L_():ug(t)&&t.Ra.set("Unknown"))}function y_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(xn.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}hp(n).Y_(e)}function _P(n,e){n.Va.Ue(e),hp(n).Z_(e)}function w_(n){n.Va=new RY({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),hp(n).start(),n.Ra.ua()}function b_(n){return ug(n)&&!hp(n).x_()&&n.Ia.size>0}function ug(n){return Wn(n).Ea.size===0}function EP(n){n.Va=void 0}async function MQ(n){n.Ra.set("Online")}async function OQ(n){n.Ia.forEach(((e,t)=>{y_(n,e)}))}async function FQ(n,e){EP(n),b_(n)?(n.Ra.ha(e),w_(n)):n.Ra.set("Unknown")}async function BQ(n,e,t){if(n.Ra.set("Online"),e instanceof uP&&e.state===2&&e.cause)try{await(async function(i,o){const s=o.cause;for(const a of o.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,s),i.Ia.delete(a),i.Va.removeTarget(a))})(n,e)}catch(r){St(Jd,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await T4(n,r)}else if(e instanceof Uv?n.Va.Ze(e):e instanceof aP?n.Va.st(e):n.Va.tt(e),!t.isEqual(xn.min()))try{const r=await yP(n.localStore);t.compareTo(r)>=0&&await(function(o,s){const a=o.Va.Tt(s);return a.targetChanges.forEach(((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const h=o.Ia.get(l);h&&o.Ia.set(l,h.withResumeToken(u.resumeToken,s))}})),a.targetMismatches.forEach(((u,l)=>{const h=o.Ia.get(u);if(!h)return;o.Ia.set(u,h.withResumeToken(Lo.EMPTY_BYTE_STRING,h.snapshotVersion)),_P(o,u);const d=new Xc(h.target,u,l,h.sequenceNumber);y_(o,d)})),o.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){St(Jd,"Failed to raise snapshot:",r),await T4(n,r)}}async function T4(n,e,t){if(!cp(e))throw e;n.Ea.add(1),await ag(n),n.Ra.set("Offline"),t||(t=()=>yP(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{St(Jd,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await _1(n)}))}async function k4(n,e){const t=Wn(n);t.asyncQueue.verifyOperationInProgress(),St(Jd,"RemoteStore received new credentials");const r=ug(t);t.Ea.add(3),await ag(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await _1(t)}async function VQ(n,e){const t=Wn(n);e?(t.Ea.delete(2),await _1(t)):e||(t.Ea.add(2),await ag(t),t.Ra.set("Unknown"))}function hp(n){return n.ma||(n.ma=(function(t,r,i){const o=Wn(t);return o.sa(),new NQ(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Xo:MQ.bind(null,n),t_:OQ.bind(null,n),r_:FQ.bind(null,n),H_:BQ.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),b_(n)?w_(n):n.Ra.set("Unknown")):(await n.ma.stop(),EP(n))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Dd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((s=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){const s=Date.now()+r,a=new x_(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Yt(ht.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function SP(n,e){if(nc("AsyncQueue",`${e}: ${n}`),cp(n))return new Yt(ht.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{static emptySet(e){return new Md(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||hn.comparator(t.key,r.key):(t,r)=>hn.comparator(t.key,r.key),this.keyedMap=Yp(),this.sortedSet=new _i(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Md)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Md;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(){this.ga=new _i(hn.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):_n(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Zd{constructor(e,t,r,i,o,s,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){const s=[];return t.forEach((a=>{s.push({type:0,doc:a})})),new Zd(e,t,Md.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&v1(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jQ{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class UQ{constructor(){this.queries=R4(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Wn(t),o=i.queries;i.queries=R4(),o.forEach(((s,a)=>{for(const u of a.Sa)u.onError(r)}))})(this,new Yt(ht.ABORTED,"Firestore shutting down"))}}function R4(){return new Cf((n=>QR(n)),v1)}async function zQ(n,e){const t=Wn(n);let r=3;const i=e.query;let o=t.queries.get(i);o?!o.ba()&&e.Da()&&(r=2):(o=new jQ,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(s){const a=SP(s,`Initialization of query '${ld(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&__(t)}async function WQ(n,e){const t=Wn(n),r=e.query;let i=3;const o=t.queries.get(r);if(o){const s=o.Sa.indexOf(e);s>=0&&(o.Sa.splice(s,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function qQ(n,e){const t=Wn(n);let r=!1;for(const i of e){const o=i.query,s=t.queries.get(o);if(s){for(const a of s.Sa)a.Fa(i)&&(r=!0);s.wa=i}}r&&__(t)}function HQ(n,e,t){const r=Wn(n),i=r.queries.get(e);if(i)for(const o of i.Sa)o.onError(t);r.queries.delete(e)}function __(n){n.Ca.forEach((e=>{e.next()}))}var nb,P4;(P4=nb||(nb={})).Ma="default",P4.Cache="cache";class GQ{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Zd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Zd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==nb.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e){this.key=e}}class CP{constructor(e){this.key=e}}class $Q{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Kn(),this.mutatedKeys=Kn(),this.eu=JR(e),this.tu=new Md(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new N4,i=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,d)=>{const m=i.get(h),p=y1(this.query,d)?d:null,y=!!m&&this.mutatedKeys.has(m.key),b=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let x=!1;m&&p?m.data.isEqual(p.data)?y!==b&&(r.track({type:3,doc:p}),x=!0):this.su(m,p)||(r.track({type:2,doc:p}),x=!0,(u&&this.eu(p,u)>0||l&&this.eu(p,l)<0)&&(a=!0)):!m&&p?(r.track({type:0,doc:p}),x=!0):m&&!p&&(r.track({type:1,doc:m}),x=!0,(u||l)&&(a=!0)),x&&(p?(s=s.add(p),o=b?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))})),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{tu:s,iu:r,Cs:a,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort(((h,d)=>(function(p,y){const b=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _n(20277,{Rt:x})}};return b(p)-b(y)})(h.type,d.type)||this.eu(h.doc,d.doc))),this.ou(r),i=i??!1;const a=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,l=u!==this.Za;return this.Za=u,s.length!==0||l?{snapshot:new Zd(this.query,e.tu,o,s,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new N4,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Kn(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new CP(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new AP(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Kn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Zd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const E_="SyncEngine";class KQ{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class XQ{constructor(e){this.key=e,this.hu=!1}}class YQ{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Cf((a=>QR(a)),v1),this.Iu=new Map,this.Eu=new Set,this.du=new _i(hn.comparator),this.Au=new Map,this.Ru=new d_,this.Vu={},this.mu=new Map,this.fu=Qd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function QQ(n,e,t=!0){const r=RP(n);let i;const o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await IP(r,e,t,!0),i}async function JQ(n,e){const t=RP(n);await IP(t,e,!0,!1)}async function IP(n,e,t,r){const i=await xQ(n.localStore,dl(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t);let a;return r&&(a=await ZQ(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&xP(n.remoteStore,i),a}async function ZQ(n,e,t,r,i){n.pu=(d,m,p)=>(async function(b,x,E,T){let P=x.view.ru(E);P.Cs&&(P=await E4(b.localStore,x.query,!1).then((({documents:L})=>x.view.ru(L,P))));const C=T&&T.targetChanges.get(x.targetId),D=T&&T.targetMismatches.get(x.targetId)!=null,z=x.view.applyChanges(P,b.isPrimaryClient,C,D);return L4(b,x.targetId,z.au),z.snapshot})(n,d,m,p);const o=await E4(n.localStore,e,!0),s=new $Q(e,o.Qs),a=s.ru(o.documents),u=sg.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,u);L4(n,t,l.au);const h=new KQ(e,t,s);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),l.snapshot}async function eJ(n,e,t){const r=Wn(n),i=r.Tu.get(e),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter((s=>!v1(s,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await eb(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&v_(r.remoteStore,i.targetId),rb(r,i.targetId)})).catch(f1)):(rb(r,i.targetId),await eb(r.localStore,i.targetId,!0))}async function tJ(n,e){const t=Wn(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),v_(t.remoteStore,r.targetId))}async function TP(n,e){const t=Wn(n);try{const r=await wQ(t.localStore,e);e.targetChanges.forEach(((i,o)=>{const s=t.Au.get(o);s&&(Qr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Qr(s.hu,14607):i.removedDocuments.size>0&&(Qr(s.hu,42227),s.hu=!1))})),await NP(t,r,e)}catch(r){await f1(r)}}function D4(n,e,t){const r=Wn(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((o,s)=>{const a=s.view.va(e);a.snapshot&&i.push(a.snapshot)})),(function(s,a){const u=Wn(s);u.onlineState=a;let l=!1;u.queries.forEach(((h,d)=>{for(const m of d.Sa)m.va(a)&&(l=!0)})),l&&__(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function nJ(n,e,t){const r=Wn(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),o=i&&i.key;if(o){let s=new _i(hn.comparator);s=s.insert(o,is.newNoDocument(o,xn.min()));const a=Kn().add(o),u=new x1(xn.min(),new Map,new _i(Vn),s,a);await TP(r,u),r.du=r.du.remove(o),r.Au.delete(e),S_(r)}else await eb(r.localStore,e,!1).then((()=>rb(r,e,t))).catch(f1)}function rb(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||kP(n,r)}))}function kP(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(v_(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),S_(n))}function L4(n,e,t){for(const r of t)r instanceof AP?(n.Ru.addReference(r.key,e),rJ(n,r)):r instanceof CP?(St(E_,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||kP(n,r.key)):_n(19791,{wu:r})}function rJ(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(St(E_,"New document in limbo: "+t),n.Eu.add(r),S_(n))}function S_(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new hn(Kr.fromString(e)),r=n.fu.next();n.Au.set(r,new XQ(t)),n.du=n.du.insert(t,r),xP(n.remoteStore,new Xc(dl(l_(t.path)),r,"TargetPurposeLimboResolution",d1.ce))}}async function NP(n,e,t){const r=Wn(n),i=[],o=[],s=[];r.Tu.isEmpty()||(r.Tu.forEach(((a,u)=>{s.push(r.pu(u,e,t).then((l=>{var h;if((l||t)&&r.isPrimaryClient){const d=l?!l.fromCache:(h=t==null?void 0:t.targetChanges.get(u.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(l){i.push(l);const d=m_.As(u.targetId,l);o.push(d)}})))})),await Promise.all(s),r.Pu.H_(i),await(async function(u,l){const h=Wn(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>et.forEach(l,(m=>et.forEach(m.Es,(p=>h.persistence.referenceDelegate.addReference(d,m.targetId,p))).next((()=>et.forEach(m.ds,(p=>h.persistence.referenceDelegate.removeReference(d,m.targetId,p)))))))))}catch(d){if(!cp(d))throw d;St(g_,"Failed to update sequence numbers: "+d)}for(const d of l){const m=d.targetId;if(!d.fromCache){const p=h.Ms.get(m),y=p.snapshotVersion,b=p.withLastLimboFreeSnapshotVersion(y);h.Ms=h.Ms.insert(m,b)}}})(r.localStore,o))}async function iJ(n,e){const t=Wn(n);if(!t.currentUser.isEqual(e)){St(E_,"User change. New user:",e.toKey());const r=await vP(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach((a=>{a.forEach((u=>{u.reject(new Yt(ht.CANCELLED,s))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await NP(t,r.Ls)}}function oJ(n,e){const t=Wn(n),r=t.Au.get(e);if(r&&r.hu)return Kn().add(r.key);{let i=Kn();const o=t.Iu.get(e);if(!o)return i;for(const s of o){const a=t.Tu.get(s);i=i.unionWith(a.view.nu)}return i}}function RP(n){const e=Wn(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=TP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oJ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nJ.bind(null,e),e.Pu.H_=qQ.bind(null,e.eventManager),e.Pu.yu=HQ.bind(null,e.eventManager),e}class O0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wP(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return yQ(this.persistence,new mQ,e.initialUser,this.serializer)}Cu(e){return new gP(p_.mi,this.serializer)}Du(e){return new EQ}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}O0.provider={build:()=>new O0};class sJ extends O0{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Qr(this.persistence.referenceDelegate instanceof M0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new eQ(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Us.withCacheSize(this.cacheSizeBytes):Us.DEFAULT;return new gP((r=>M0.mi(r,t)),this.serializer)}}class ib{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>D4(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=iJ.bind(null,this.syncEngine),await VQ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new UQ})()}createDatastore(e){const t=wP(e.databaseInfo.databaseId),r=(function(o){return new TQ(o)})(e.databaseInfo);return(function(o,s,a,u){return new PQ(o,s,a,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,o,s,a){return new LQ(r,i,o,s,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>D4(this.syncEngine,t,0)),(function(){return C4.v()?new C4:new SQ})())}createSyncEngine(e,t){return(function(i,o,s,a,u,l,h){const d=new YQ(i,o,s,a,u,l);return h&&(d.gu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const o=Wn(i);St(Jd,"RemoteStore shutting down."),o.Ea.add(5),await ag(o),o.Aa.shutdown(),o.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}ib.provider={build:()=>new ib};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aJ{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):nc("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh="FirestoreClient";class uJ{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ns.UNAUTHENTICATED,this.clientId=BR.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async s=>{St(gh,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,(s=>(St(gh,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dd;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=SP(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function M2(n,e){n.asyncQueue.verifyOperationInProgress(),St(gh,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await vP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function M4(n,e){n.asyncQueue.verifyOperationInProgress();const t=await lJ(n);St(gh,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>k4(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>k4(e.remoteStore,i))),n._onlineComponents=e}async function lJ(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){St(gh,"Using user provided OfflineComponentProvider");try{await M2(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ht.FAILED_PRECONDITION||i.code===ht.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;$d("Error using user provided cache. Falling back to memory cache: "+t),await M2(n,new O0)}}else St(gh,"Using default OfflineComponentProvider"),await M2(n,new sJ(void 0));return n._offlineComponents}async function cJ(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(St(gh,"Using user provided OnlineComponentProvider"),await M4(n,n._uninitializedComponentsProvider._online)):(St(gh,"Using default OnlineComponentProvider"),await M4(n,new ib))),n._onlineComponents}async function O4(n){const e=await cJ(n),t=e.eventManager;return t.onListen=QQ.bind(null,e.syncEngine),t.onUnlisten=eJ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=JQ.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=tJ.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PP(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F4=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP="firestore.googleapis.com",B4=!0;class V4{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Yt(ht.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=DP,this.ssl=B4}else this.host=e.host,this.ssl=e.ssl??B4;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=mP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<JY)throw new Yt(ht.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}PX("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=PP(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Yt(ht.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Yt(ht.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Yt(ht.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class A_{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new V4({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Yt(ht.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Yt(ht.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new V4(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new xX;switch(r.type){case"firstParty":return new AX(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Yt(ht.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=F4.get(t);r&&(St("ComponentProvider","Removing Datastore"),F4.delete(t),r.terminate())})(this),Promise.resolve()}}function hJ(n,e,t,r={}){var l;n=Bv(n,A_);const i=op(e),o=n._getSettings(),s={...o,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;i&&(WN(`https://${a}`),qN("Firestore",!0)),o.host!==DP&&o.host!==a&&$d("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...o,host:a,ssl:i,emulatorOptions:r};if(!df(u,s)&&(n._setSettings(u),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=ns.MOCK_USER;else{h=PH(r.mockUserToken,(l=n._app)==null?void 0:l.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Yt(ht.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new ns(m)}n._authCredentials=new _X(new FR(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new E1(this.firestore,e,this._query)}}class va{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Od(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new va(this.firestore,e,this._key)}toJSON(){return{type:va._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(ig(t,va._jsonSchema))return new va(e,r||null,new hn(Kr.fromString(t.referencePath)))}}va._jsonSchemaVersion="firestore/documentReference/1.0",va._jsonSchema={type:Mi("string",va._jsonSchemaVersion),referencePath:Mi("string")};class Od extends E1{constructor(e,t,r){super(e,t,l_(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new va(this.firestore,null,new hn(e))}withConverter(e){return new Od(this.firestore,e,this._path)}}function j4(n,e,...t){if(n=ku(n),RX("collection","path",e),n instanceof A_){const r=Kr.fromString(e,...t);return QC(r),new Od(n,null,r)}{if(!(n instanceof va||n instanceof Od))throw new Yt(ht.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Kr.fromString(e,...t));return QC(r),new Od(n.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U4="AsyncQueue";class z4{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new bP(this,"async_queue_retry"),this._c=()=>{const r=L2();r&&St(U4,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=L2();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=L2();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Dd;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!cp(e))throw e;St(U4,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,nc("INTERNAL UNHANDLED ERROR: ",W4(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=x_.createAndSchedule(this,e,t,r,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&_n(47125,{Pc:W4(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function W4(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q4(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const o of r)if(o in i&&typeof i[o]=="function")return!0;return!1})(n,["next","error","complete"])}class ob extends A_{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new z4,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new z4(e),this._firestoreClient=void 0,await e}}}function fJ(n,e){const t=typeof n=="object"?n:KN(),r=typeof n=="string"?n:N0,i=Xx(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const o=NH("firestore");o&&hJ(i,...o)}return i}function dJ(n){if(n._terminated)throw new Yt(ht.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||pJ(n),n._firestoreClient}function pJ(n){var r,i,o;const e=n._freezeSettings(),t=(function(a,u,l,h){return new GX(a,u,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,PP(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new uJ(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new rl(Lo.fromBase64String(e))}catch(t){throw new Yt(ht.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new rl(Lo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:rl._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ig(e,rl._jsonSchema))return rl.fromBase64String(e.bytes)}}rl._jsonSchemaVersion="firestore/bytes/1.0",rl._jsonSchema={type:Mi("string",rl._jsonSchemaVersion),bytes:Mi("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Yt(ht.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ss(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Yt(ht.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Yt(ht.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Vn(this._lat,e._lat)||Vn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ih._jsonSchemaVersion}}static fromJSON(e){if(ig(e,ih._jsonSchema))return new ih(e.latitude,e.longitude)}}ih._jsonSchemaVersion="firestore/geoPoint/1.0",ih._jsonSchema={type:Mi("string",ih._jsonSchemaVersion),latitude:Mi("number"),longitude:Mi("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:oh._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ig(e,oh._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new oh(e.vectorValues);throw new Yt(ht.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}oh._jsonSchemaVersion="firestore/vectorValue/1.0",oh._jsonSchema={type:Mi("string",oh._jsonSchemaVersion),vectorValues:Mi("object")};const mJ=new RegExp("[~\\*/\\[\\]]");function gJ(n,e,t){if(e.search(mJ)>=0)throw H4(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new LP(...e.split("."))._internalPath}catch{throw H4(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function H4(n,e,t,r,i){let o=`Function ${e}() called with invalid data`;o+=". ";let s="";return new Yt(ht.INVALID_ARGUMENT,o+n+s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new va(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vJ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(OP("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class vJ extends MP{data(){return super.data()}}function OP(n,e){return typeof e=="string"?gJ(n,e):e instanceof LP?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yJ(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Yt(ht.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wJ{convertValue(e,t="none"){switch(ph(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(dh(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _n(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return og(e,((i,o)=>{r[i]=this.convertValue(o,t)})),r}convertVectorValue(e){var r,i,o;const t=(o=(i=(r=e.fields)==null?void 0:r[qw].arrayValue)==null?void 0:i.values)==null?void 0:o.map((s=>vi(s.doubleValue)));return new oh(t)}convertGeoPoint(e){return new ih(vi(e.latitude),vi(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=m1(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Lm(e));default:return null}}convertTimestamp(e){const t=fh(e);return new Pi(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Kr.fromString(e);Qr(pP(r),9688,{name:e});const i=new Mm(r.get(1),r.get(3)),o=new hn(r.popFirst(5));return i.isEqual(t)||nc(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}class Jp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class uf extends MP{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new zv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(OP("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Yt(ht.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=uf._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}uf._jsonSchemaVersion="firestore/documentSnapshot/1.0",uf._jsonSchema={type:Mi("string",uf._jsonSchemaVersion),bundleSource:Mi("string","DocumentSnapshot"),bundleName:Mi("string"),bundle:Mi("string")};class zv extends uf{data(e={}){return super.data(e)}}class Fd{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Jp(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new zv(this._firestore,this._userDataWriter,r.key,r,new Jp(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Yt(ht.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map((a=>{const u=new zv(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Jp(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((a=>o||a.type!==3)).map((a=>{const u=new zv(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Jp(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:bJ(a.type),doc:u,oldIndex:l,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Yt(ht.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Fd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=BR.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function bJ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _n(61501,{type:n})}}Fd._jsonSchemaVersion="firestore/querySnapshot/1.0",Fd._jsonSchema={type:Mi("string",Fd._jsonSchemaVersion),bundleSource:Mi("string","QuerySnapshot"),bundleName:Mi("string"),bundle:Mi("string")};class FP extends wJ{constructor(e){super(),this.firestore=e}convertBytes(e){return new rl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new va(this.firestore,null,t)}}function G4(n,...e){var u,l,h;n=ku(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||q4(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(q4(e[r])){const d=e[r];e[r]=(u=d.next)==null?void 0:u.bind(d),e[r+1]=(l=d.error)==null?void 0:l.bind(d),e[r+2]=(h=d.complete)==null?void 0:h.bind(d)}let o,s,a;if(n instanceof va)s=Bv(n.firestore,ob),a=l_(n._key.path),o={next:d=>{e[r]&&e[r](xJ(s,n,d))},error:e[r+1],complete:e[r+2]};else{const d=Bv(n,E1);s=Bv(d.firestore,ob),a=d._query;const m=new FP(s);o={next:p=>{e[r]&&e[r](new Fd(s,m,d,p))},error:e[r+1],complete:e[r+2]},yJ(n._query)}return(function(m,p,y,b){const x=new aJ(b),E=new GQ(p,x,y);return m.asyncQueue.enqueueAndForget((async()=>zQ(await O4(m),E))),()=>{x.Nu(),m.asyncQueue.enqueueAndForget((async()=>WQ(await O4(m),E)))}})(dJ(s),a,i,o)}function xJ(n,e,t){const r=t.docs.get(e._key),i=new FP(n);return new uf(n,i,e._key,r,new Jp(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){lp=i})(sp),Hd(new pf("firestore",((r,{instanceIdentifier:i,options:o})=>{const s=r.getProvider("app").getImmediate(),a=new ob(new EX(r.getProvider("auth-internal")),new CX(s,r.getProvider("app-check-internal")),(function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Yt(ht.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mm(l.options.projectId,h)})(s,i),s);return o={useFetchStreams:t,...o},a._setSettings(o),a}),"PUBLIC").setMultipleInstances(!0)),th($C,KC,e),th($C,KC,"esm2020")})();const _J={apiKey:"AIzaSyBwhzGsK-ah7ObMOgpRDlzGghycLNinm6g",authDomain:"tforce-guardian-system.firebaseapp.com",projectId:"tforce-guardian-system",storageBucket:"tforce-guardian-system.firebasestorage.app",messagingSenderId:"194168927826",appId:"1:194168927826:web:18073e1a188b8e4408118b"},BP=$N(_J),O2=wX(BP),$4=fJ(BP),EJ=()=>{const{setActiveMode:n,playSound:e,speak:t}=Eu(),[r,i]=Ke.useState(null),[o,s]=Ke.useState(!0),[a,u]=Ke.useState("live"),[l,h]=Ke.useState([]),[d,m]=Ke.useState([]),[p,y]=Ke.useState(""),[b,x]=Ke.useState(""),[E,T]=Ke.useState(""),P=Ke.useRef(!1);Ke.useEffect(()=>{const L=aK(O2,I=>{i(I),s(!1),I&&!P.current&&(P.current=!0,setTimeout(()=>{t("Guardian uplink established.")},500))});return()=>L()},[]),Ke.useEffect(()=>{if(!r||a!=="live")return;const L=G4(j4($4,"locations"),I=>{const A=I.docs.map(M=>({id:M.id,...M.data()})),O=new Date,k=A.filter(M=>{if(!M.timestamp||!M.timestamp.toDate)return!1;const j=(O-M.timestamp.toDate())/1e3/60;return M.onDuty&&j<60});h(k)});return()=>L()},[r,a]),Ke.useEffect(()=>{if(!r||a!=="logs")return;const L=G4(j4($4,"scan_logs"),I=>{let A=I.docs.map(O=>({id:O.id,...O.data()}));A.sort((O,k)=>{var M,j;return(((M=k.timestamp)==null?void 0:M.seconds)||0)-(((j=O.timestamp)==null?void 0:j.seconds)||0)}),m(A.slice(0,50))});return()=>L()},[r,a]);const C=async L=>{L.preventDefault();try{await iK(O2,p,b)}catch(I){T("Access Denied: "+I.message),e("error")}},D=()=>{uK(O2),e("click"),P.current=!1},z=L=>{if(!L||!L.toDate)return"PENDING...";try{return L.toDate().toLocaleTimeString()}catch{return"ERR"}};return oe.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex flex-col animate-slide-up font-mono",children:[oe.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-red-600/30",children:[oe.jsxs("div",{className:"flex items-center gap-3",children:[oe.jsx("i",{className:"fas fa-shield-alt text-red-600 text-xl animate-pulse"}),oe.jsx("h2",{className:"text-red-600 font-bold text-xl tracking-widest",children:"GUARDIAN COMMAND"})]}),oe.jsx("button",{onClick:()=>{e("click"),n("HOME")},className:"text-red-600 hover:text-white",children:oe.jsx("i",{className:"fas fa-times text-2xl"})})]}),oe.jsx("div",{className:"flex-1 overflow-y-auto p-6 no-scrollbar",children:o?oe.jsx("div",{className:"text-center text-red-600 mt-20 animate-pulse",children:"ESTABLISHING SECURE CONNECTION..."}):r?oe.jsxs(oe.Fragment,{children:[oe.jsxs("div",{className:"flex gap-4 mb-6 border-b border-white/10 pb-4",children:[oe.jsx("button",{onClick:()=>u("live"),className:`px-4 py-2 border ${a==="live"?"border-red-600 bg-red-600/20 text-red-500":"border-gray-700 text-gray-500"}`,children:"ACTIVE UNITS"}),oe.jsx("button",{onClick:()=>u("logs"),className:`px-4 py-2 border ${a==="logs"?"border-red-600 bg-red-600/20 text-red-500":"border-gray-700 text-gray-500"}`,children:"SCAN LOGS"}),oe.jsx("button",{onClick:D,className:"ml-auto text-xs text-gray-500 hover:text-white",children:"SIGN OUT"})]}),a==="live"&&oe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.length===0&&oe.jsx("div",{className:"col-span-full text-center text-gray-500",children:"NO ACTIVE UNITS DETECTED"}),l.map(L=>{var I,A;return oe.jsxs("div",{className:"border border-white/20 border-l-4 border-l-green-500 p-4 bg-white/5",children:[oe.jsxs("div",{className:"flex justify-between items-start",children:[oe.jsx("h3",{className:"font-bold text-lg text-white",children:L.username}),oe.jsx("span",{className:"text-green-500 text-xs font-bold animate-pulse",children:" ON DUTY"})]}),oe.jsxs("div",{className:"text-gray-400 text-xs mt-1",children:["LAST SIGNAL: ",z(L.timestamp)]}),oe.jsxs("div",{className:"bg-black p-2 mt-3 font-mono text-xs text-red-400 border border-white/10 flex justify-between items-center",children:[oe.jsxs("span",{children:[(I=L.latitude)==null?void 0:I.toFixed(4),", ",(A=L.longitude)==null?void 0:A.toFixed(4)]}),oe.jsxs("a",{href:`http://googleusercontent.com/maps.google.com/6{u.latitude},${L.longitude}`,target:"_blank",rel:"noreferrer",className:"text-white hover:text-red-500",children:[oe.jsx("i",{className:"fas fa-map-marker-alt"})," MAP"]})]})]},L.id)})]}),a==="logs"&&oe.jsxs("div",{className:"space-y-2",children:[oe.jsx("div",{className:"flex justify-between items-center mb-2",children:oe.jsx("span",{className:"text-xs text-gray-500",children:"RECENT ACTIVITY"})}),d.map(L=>oe.jsxs("div",{className:"border-b border-white/10 p-3 flex justify-between items-center hover:bg-white/5",children:[oe.jsxs("div",{children:[oe.jsx("div",{className:"font-bold text-white text-sm",children:L.username}),oe.jsx("div",{className:"text-gray-500 text-xs",children:z(L.timestamp)})]}),oe.jsx("div",{className:"text-right",children:oe.jsx("div",{className:"text-red-400 text-sm",children:L.checkpointData||"SCAN"})})]},L.id))]})]}):oe.jsxs("div",{className:"max-w-sm mx-auto mt-10 p-6 border border-red-600/50 rounded bg-red-900/10",children:[oe.jsx("h3",{className:"text-red-600 text-center text-lg font-bold mb-6",children:"RESTRICTED ACCESS"}),oe.jsxs("form",{onSubmit:C,className:"flex flex-col gap-4",children:[oe.jsx("input",{type:"email",placeholder:"OFFICER EMAIL",value:p,onChange:L=>y(L.target.value),className:"bg-black border border-red-600/30 p-3 text-white outline-none focus:border-red-600"}),oe.jsx("input",{type:"password",placeholder:"ACCESS CODE",value:b,onChange:L=>x(L.target.value),className:"bg-black border border-red-600/30 p-3 text-white outline-none focus:border-red-600"}),E&&oe.jsx("div",{className:"text-xs text-red-500 text-center",children:E}),oe.jsx("button",{type:"submit",className:"bg-red-600 text-white font-bold py-3 hover:bg-red-700 transition-all",children:"AUTHENTICATE"})]})]})})]})},SJ=()=>{const{systemStatus:n,setSystemStatus:e,playSound:t,speak:r,user:i,battery:o,isListening:s,toggleListening:a,activeMode:u}=Eu(),[l,h]=Ke.useState(!1),[d,m]=Ke.useState(!1),[p,y]=Ke.useState(!1),b=()=>{t("startup"),h(!0),e("ONLINE"),setTimeout(()=>{r(`Welcome back, ${i.name}. System secure. Battery at ${o} percent.`)},1e3)};return l?oe.jsxs("div",{className:"relative w-screen h-screen bg-black overflow-hidden",children:[oe.jsx(kD,{}),u==="HOME"&&oe.jsx("div",{onClick:()=>{t("click"),y(!0)},className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-48 h-48 rounded-full z-10 cursor-pointer",title:"Access Main Menu"}),oe.jsxs("div",{className:"absolute top-0 left-0 w-full p-4 flex justify-between items-start z-20 pointer-events-none",children:[oe.jsxs("div",{className:"text-cyan-dim font-mono text-xs",children:[oe.jsx("div",{className:"border-b border-cyan w-20 mb-1",children:"T-FORCE"}),oe.jsxs("div",{children:["OP: ",i.name.toUpperCase()]}),oe.jsxs("div",{children:["ACC: ",i.access.toUpperCase()]})]}),oe.jsxs("div",{className:"text-right",children:[oe.jsxs("div",{className:`text-xl font-orbitron font-bold ${o<20?"text-red-500":"text-cyan"}`,children:[o,"%"]}),oe.jsx("div",{className:"text-cyan-dim font-mono text-[10px]",children:"PWR LEVEL"})]})]}),u==="HOME"&&oe.jsx("div",{className:"absolute bottom-24 left-1/2 transform -translate-x-1/2 z-20",children:oe.jsx("button",{onClick:a,className:`
              w-16 h-16 rounded-full border border-cyan flex items-center justify-center
              transition-all duration-300 backdrop-blur-sm
              ${s?"bg-red-500/20 shadow-[0_0_30px_rgba(255,0,0,0.5)] border-red-500 scale-110":"bg-black/50 hover:bg-cyan/20 shadow-[0_0_15px_rgba(0,229,255,0.3)]"}
            `,children:oe.jsx("i",{className:`fas fa-microphone text-2xl ${s?"text-red-500 animate-pulse":"text-cyan"}`})})}),oe.jsxs("div",{className:"absolute bottom-8 w-full text-center z-20 pointer-events-none",children:[oe.jsx("div",{className:"text-cyan font-orbitron tracking-[4px] text-sm animate-pulse",children:n}),oe.jsx("div",{className:"text-cyan-dim text-[10px] mt-1 font-mono",children:u==="HOME"?s?"LISTENING...":"AWAITING COMMAND":u})]}),oe.jsx(iF,{isOpen:p,onClose:()=>y(!1),onOpenSettings:()=>{y(!1),m(!0)}}),d&&oe.jsx(ND,{onClose:()=>m(!1)}),u==="VISION"&&oe.jsx(Cz,{}),u==="MEDIA"&&oe.jsx(Iz,{}),u==="DATABASE"&&oe.jsx(Tz,{}),u==="HUD"&&oe.jsx(kz,{}),u==="OPS"&&oe.jsx(bH,{}),u==="RECON"&&oe.jsx(xH,{}),u==="GUARDIAN"&&oe.jsx(EJ,{})," "]}):oe.jsxs("div",{onClick:b,className:"w-screen h-screen bg-black flex flex-col items-center justify-center cursor-pointer select-none",children:[oe.jsx("div",{className:"text-cyan text-6xl animate-pulse mb-4",children:oe.jsx("i",{className:"fas fa-fingerprint"})}),oe.jsx("div",{className:"text-cyan font-orbitron font-bold text-xl tracking-widest",children:"INITIALIZE JARVIS"}),oe.jsx("div",{className:"text-cyan-dim font-mono text-xs mt-2",children:"TOUCH TO AUTHENTICATE"})]})};function AJ(){return oe.jsx(TD,{children:oe.jsx(SJ,{})})}ID.createRoot(document.getElementById("root")).render(oe.jsx(Ke.StrictMode,{children:oe.jsx(AJ,{})}));export{fr as _};
